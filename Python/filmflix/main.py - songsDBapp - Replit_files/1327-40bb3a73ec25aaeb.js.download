!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6ebb9387-9bc9-4229-979d-e7c9472105eb",e._sentryDebugIdIdentifier="sentry-dbid-6ebb9387-9bc9-4229-979d-e7c9472105eb")}catch(e){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"1582e009"};"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1327],{35105:function(e,t,n){n.d(t,{Dz:function(){return C},HC:function(){return Z},M8:function(){return b},NK:function(){return v},Pr:function(){return S},gg:function(){return g}});var r=n(41733),i=n(30509),o=n(74985),a=n(19408),l=n(12880),c=n(68934),s=n(2454),u=n(27173),d=n(56596),f=n(93918),h=n(29287),p=n(74833),m=new Map([[u.BY.BASIC,s.Z],[u.BY.ADVANCED,c.Z]]),v=new Map([[u.BY.BASIC,"Basic"],[u.BY.ADVANCED,"Advanced"]]);function g(e){var t=e.model,n=e.icon,a=e.text,l=m.get("string"==typeof t?u.BY.ADVANCED:t),c="string"==typeof t?t:v.get(t);return l&&c?(0,o.BX)(d.G,{css:x.iconLabel,children:[(0,o.tZ)(l,(0,r._)({},n)),(0,o.tZ)(p.xv,(0,i._)((0,r._)({},a),{children:c}))]}):null}var y=new Map([[u.$h.GENERATE,l.Z],[u.$h.TRANSFORM,l.Z],[u.$h.EXPLAIN,a.Z],[u.$h.REPLIT_DOCS,a.Z]]),b=new Map([[u.$h.GENERATE,"Generate"],[u.$h.TRANSFORM,"Modify"],[u.$h.EXPLAIN,"Explain"],[u.$h.REPLIT_DOCS,"Ask replit.com"]]),w=new Map([[u.G_.GENERATE_CODE,l.Z],[u.G_.TRANSFORM_CODE,l.Z],[u.G_.EXPLAIN_CODE,a.Z],[u.G_.DEBUGGER,a.Z]]),Z=new Map([[u.G_.GENERATE_CODE,"Generate"],[u.G_.TRANSFORM_CODE,"Modify"],[u.G_.EXPLAIN_CODE,"Explain"],[u.G_.DEBUGGER,"Debug"]]),x=(0,f.X)({iconLabel:[h.l0.rowWithGap(4),h.l0.align.center]});function C(e){var t=e.intent,n=e.icon,a=e.text,l=y.get(t),c=b.get(t);return l&&c?(0,o.BX)(d.G,{css:x.iconLabel,children:[(0,o.tZ)(l,(0,r._)({},n)),(0,o.tZ)(p.xv,(0,i._)((0,r._)({},a),{children:c}))]}):null}function S(e){var t=e.type,n=e.icon,a=e.text,l=w.get(t),c=Z.get(t);return l&&c?(0,o.BX)(d.G,{css:x.iconLabel,children:[(0,o.tZ)(l,(0,r._)({},n)),(0,o.tZ)(p.xv,(0,i._)((0,r._)({},a),{children:c}))]}):null}},57679:function(e,t,n){n.d(t,{s:function(){return P},_:function(){return G}});var r=n(41733),i=n(66626),o=n(74985),a=n(73164),l=n(53326),c=n(57468),s=n(38080),u=n(74833),d=n(56596),f=n(93918),h=n(29287),p=n(43312),m=n(10041),v=n(59868),g=n(1498),y=n(30983),b=n(41859),w=n(64992),Z=n(2532),x=n(50959),C=(0,p.F4)({"0%":{opacity:0,transform:"translateX(8px)"},"10%":{opacity:1,transform:"translateX(0)"},"95%":{opacity:1},"100%":{opacity:0}}),S=(0,f.X)({buttonContainer:[h.l0.position.relative,{transition:"opacity 75ms linear",opacity:1}],buttonWrapper:[h.l0.flex.row],button:[h.l0.backgroundColor.backgroundDefault],buttonToast:{position:"absolute",display:"block",bottom:"100%",paddingBottom:h.TV.space4,paddingRight:h.TV.space8,animation:"".concat(C," 3s"),fontFamily:h.TV.fontFamilyDefault,fontSize:h.TV.fontSizeDefault,whiteSpace:"nowrap",userSelect:"none"}}),k=function(e){var t=e.code,n=e.language,r=(0,i._)((0,x.useState)(!1),2),a=r[0],l=r[1];return(0,o.BX)("div",{css:S.buttonContainer,children:[a?(0,o.tZ)("span",{css:S.buttonToast,onAnimationEnd:function(){requestAnimationFrame(function(){l(!1)})},"aria-hidden":!0,children:"Copied!"}):null,(0,o.tZ)(g.zx,{css:S.button,text:"Copy",size:"small",iconLeft:(0,o.tZ)(b.Z,{}),onClick:function(){(0,v.j)(v.U3.GHOSTWRITER_CHAT_CODE_COPIED,{language:n}),(0,m.Z)(t),l(!0)}})]})},_=function(e){var t=e.code,n=e.disabled,r=e.insertCode,a=(0,i._)((0,x.useState)(!1),2),l=a[0],c=a[1],s=(0,o.tZ)(g.zx,{css:S.button,text:"Insert",disabled:n,size:"small",iconLeft:(0,o.tZ)(Z.Z,{}),onClick:function(){r&&(r(t),c(!0))}});return(0,o.BX)("div",{css:S.buttonContainer,children:[l?(0,o.tZ)("span",{css:S.buttonToast,onAnimationEnd:function(){requestAnimationFrame(function(){c(!1)})},"aria-hidden":!0,children:"Inserted!"}):null,(0,o.tZ)(y.u,{placement:"bottom",tooltip:n?"Place cursor in a file to insert code":"Insert code at cursor position",children:s})]})},E=function(e){var t=e.revertCodeInsert,n=(0,i._)((0,x.useState)(!1),2),r=n[0],a=n[1],l=(0,o.tZ)(g.zx,{css:S.button,text:"Revert",size:"small",iconLeft:(0,o.tZ)(w.Z,{}),onClick:function(){t(),a(!0)}});return(0,o.BX)("div",{css:S.buttonContainer,children:[r?(0,o.tZ)("span",{css:S.buttonToast,onAnimationEnd:function(){requestAnimationFrame(function(){a(!1)})},"aria-hidden":!0,children:"Reverting..."}):null,(0,o.tZ)(y.u,{placement:"bottom",tooltip:"Revert code insertion",children:l})]})};n(29217),n(3947),n(58091),n(76568),n(34581),(0,f.X)({root:[h.l0.borderRadius(4),h.l0.border({color:h.TV.outlineDimmest})],header:[h.l0.rowWithGap(8),h.l0.border({color:h.TV.outlineDimmest,direction:"bottom"}),{fontFamily:h.TV.fontFamilyDefault}],headerLeft:[h.l0.rowWithGap(0),h.l0.pl(4),h.l0.flex.growAndShrink(1),h.l0.align.center],headerRight:[h.l0.rowWithGap(0),{"& button":{borderRadius:0},"& > div:last-of-type button":{borderTopRightRadius:4}}],blockStyles:{backgroundColor:"transparent"}});var T=n(59173),R=n(16643),I=(0,f.X)({styles0:[h.l0.pl(4),h.l0.fontSize(12),h.l0.color.foregroundDimmer]}),D=(0,f.X)({root:[h.l0.borderRadius(4),h.l0.border({color:h.TV.outlineDimmest})],header:[h.l0.rowWithGap(8),h.l0.border({color:h.TV.outlineDimmest,direction:"bottom"}),{fontFamily:h.TV.fontFamilyDefault}],headerLeft:[h.l0.rowWithGap(0),h.l0.pl(4),h.l0.flex.growAndShrink(1),h.l0.align.center],headerRight:[h.l0.rowWithGap(0),{"& button":{borderRadius:0},"& > div:last-of-type button":{borderTopRightRadius:4}}],blockStyles:{backgroundColor:"transparent"}}),G=function(e){if(e.inline)return(0,o.tZ)(l.Z,(0,r._)({},e));var t=(0,l.F)(e.className),n=t&&function(e){switch(e){case"crystal":return"main.cr";case"python":case"py":return"main.py";case"sh":case"fish":case"zsh":case"bash":return"main.sh";case"javascript":case"js":return"index.js";case"typescript":case"ts":return"index.ts";case"csharp":case"cs":return"main.cs";case"java":return"Main.java";case"go":return"main.go";case"ruby":case"rb":return"main.rb";case"php":return"main.php";case"rust":return"main.rs";case"swift":return"main.swift";case"kotlin":return"main.kt";case"scala":return"main.scala";case"c":return"main.c";case"cpp":case"c++":return"main.cpp";case"dart":return"main.dart";case"elixir":return"main.ex";case"haskell":return"Main.hs";case"lua":return"main.lua";case"perl":return"main.pl";case"r":return"main.r";case"sql":return"main.sql";case"ocaml":return"main.ml";case"html":return"index.html";case"json":return"main.json";case"css":return"main.css";default:return}}(t),i=n?a.$R.from(n):void 0,f=null==i?void 0:i.name,h=String(e.children);return(0,o.BX)(s.Tg,{css:D.root,children:[(0,o.BX)(d.G,{css:D.header,children:[(0,o.BX)(d.G,{css:D.headerLeft,children:[n?(0,o.tZ)(c.Z,{size:12,path:n}):null,f?(0,o.tZ)(u.xv,{multiline:!1,css:I.styles0,children:f}):null]}),(0,o.BX)(d.G,{css:D.headerRight,children:[(0,o.tZ)(k,{code:h,language:t}),(0,o.tZ)(A,{code:h})]})]}),(0,o.tZ)(l.Z,(0,r._)({blockStyles:D.blockStyles,disableCopy:!0},e))]})},B=(0,x.createContext)((0,T.u)(null)),P=B.Provider,A=function(e){var t=e.code,n=(0,i._)((0,x.useState)(!1),2),r=n[0],a=n[1],l=(0,R.Z)((0,x.useContext)(B));if(!l)return null;var c=l.insert,s=l.revert;return r?r&&s?(0,o.tZ)(E,{revertCodeInsert:function(){a(!1),s()}}):null:(0,o.tZ)(_,{disabled:!1,code:t,insertCode:function(){a(!0),null==c||c(t)}})}},29970:function(e,t,n){n.d(t,{k:function(){return D}});var r=n(27387),i=n(66626),o=n(96583),a=n(74985),l=n(19713),c=n(50959),s=n(61610),u=n(41772),d=n(34091),f=n(12285),h=n(86583),p=n(90926),m=n(48308),v=n(22281),g=n(85234),y=n.n(g),b=n(65047),w=n(49500);function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"debug";(0,b.nb)(function(e){for(var t=0,n=["received msg:","sending"];t<n.length;t++){var r=n[t],i="-- ".concat(r," "),o=e.indexOf(i);if(-1!==o){var a=e.slice(0,o),l=e.slice(o+i.length),c=void 0;try{c=JSON.parse(l)}catch(e){w.error(e)}if(!c)break;w.log(a,i,c);return}}w.log(e)}),(0,b.uR)(e)}var x=n(99149),C=n(12639),S=n(6636),k=n(47611),_=n(7444);function E(){return(E=(0,r._)(function(e){var t;return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,fetch("/ai/auth",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({replId:e})})];case 1:return[4,n.sent().json()];case 2:if(t=n.sent(),!x.B4.Check(C.v,t))throw(0,S.o)("Authentication to chat service failed",{detail:t});return[2,t.token]}})})).apply(this,arguments)}window.__enableAiChatServiceLogs=Z,window.location.search.includes("aiChatDebug")&&Z();var T=function(){"use strict";function e(t){(0,f._)(this,e),this.n=1,this.cleanup=t}var t=e.prototype;return t.ref=function(){this.n+=1},t.unref=function(){this.n-=1,0===this.n&&this.cleanup()},e}(),R=void 0,I=n(25632);function D(e){var t,n,d,f,g,b,w,Z,x,C,S,D,B,P,A,N,L,U,O,M,X,F,W,H,V,z,j,q,Y=e.replId,J=e.currentUserId,K=e.endpoint,$=e.hasAccessToAdvancedModel,Q=e.children,ee=(n=(t={replId:Y,currentUserId:J,endpoint:K,hasAccessToAdvancedModel:$,testStore:e.testStore}).replId,d=t.currentUserId,f=t.endpoint,g=t.hasAccessToAdvancedModel,b=t.testStore,H=(Z=(w={replId:n,currentUserId:d,endpoint:f,hasAccessToAdvancedModel:g}).replId,x=w.endpoint,C=w.currentUserId,S=w.hasAccessToAdvancedModel,D=(0,k.useRouter)(),(0,c.useEffect)(function(){var e=function(){R=void 0};return D.events.on("beforeHistoryChange",e),function(){D.events.off("beforeHistoryChange",e)}}),P=(B=(0,i._)((0,c.useState)(1),2))[0],A=B[1],N="".concat(Z,"-").concat(S?"advanced":"basic","-").concat(P),U=(L=(0,c.useMemo)(function(){return function(e){var t=e.currentUserId,n=e.replId,i=e.endpoint,a=e.clientId;function l(){return(l=(0,r._)(function(){var e,t;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,function(e){return E.apply(this,arguments)}(n)];case 1:return e=r.sent(),(t=new URL(i)).searchParams.set("auth_token",e),[2,new h.Z(t.toString())]}})})).apply(this,arguments)}if(R&&R.clientId===a)R.refcount.ref();else{var c="".concat(t,"-").concat(y()()),s=new v.k(function(){return l.apply(this,arguments)},c,"SERVER",{codec:m.f,retryAttemptsMax:10,retryIntervalMs:1e3}),u=new T(function(){s.close()}),d=null==R?void 0:R.ctx;R={ctx:{client:(0,p.eI)(s),transport:s,cleanup:function(){return null==R?void 0:R.refcount.unref()}},clientId:a,refcount:u},null==d||d.transport.close()}return R.ctx}({currentUserId:C,replId:Z,endpoint:x,clientId:N})},[C,Z,x,N])).client,O=L.transport,M=L.cleanup,X=(0,c.useCallback)(function(){A(function(e){return e+1})},[]),(0,c.useEffect)(function(){return window.addEventListener("online",X),window.addEventListener("offline",M),function(){window.removeEventListener("online",X),window.removeEventListener("offline",M)}},[M,X]),F=(0,_.Z)(M),(0,c.useEffect)(function(){var e=F.current;return function(){e()}},[F]),W={client:U,transport:O,reconnect:X}).client,V=W.transport,z=W.reconnect,j=(0,I.Gn)("chatEngine").preferences.chatEngine,q=(0,i._)((0,c.useState)(function(){if(b)throw Error("testStore in only meant for tests");var e=null!=b?b:(0,l.MT)();return e.set(u.aN,{client:H}),e.set(u.Uk,{replId:n,currentUserId:d,hasAccessToAdvancedModel:g,advancedChatEngineOverride:j}),e}),1)[0],(0,c.useEffect)(function(){q.set(u.aN,{client:H})},[q,H]),(0,c.useEffect)(function(){q.set(u.Uk,{replId:n,currentUserId:d,hasAccessToAdvancedModel:g,advancedChatEngineOverride:j})},[q,n,d,g,j]),{transport:V,reconnect:z,store:q}),et=ee.store,en=ee.transport,er=ee.reconnect;return(0,a.BX)(s.g3,{store:et,children:[Q,(0,a.tZ)(G,{replId:Y,transport:en,reconnect:er})]})}function G(e){var t=e.replId,n=e.transport,a=e.reconnect,l=(0,i._)((0,u.eP)(),2),s=l[0],f=l[1],h=(0,u.m8)(),p=(0,u.Bh)();(0,c.useEffect)(function(){var e=function(e){f("connect"===e.status)};return n.connections.size&&f(!0),n.addEventListener("connectionStatus",e),function(){n.removeEventListener("connectionStatus",e)}},[n,f]);var m=(0,u.ww)();return(0,c.useEffect)(function(){s&&m()},[h,s,m]),(0,c.useEffect)(function(){if(s)return(0,d.NO)(h,t,p)},[h,t,p,s]),(0,c.useEffect)(function(){var e=function(){return i.apply(this,arguments)};if(s){var t=!1,n=null;return e(),function(){t=!0,n&&clearTimeout(n)}}function i(){return(i=(0,r._)(function(){var r,i,l;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return[4,Promise.race([h.chatService.pingPong.rpc({}),new Promise(function(e){return setTimeout(e,2e3)})])];case 1:if(r=o.sent(),t)return[2];if(i=!r,l=r&&!r.ok&&"UNEXPECTED_DISCONNECT"===r.payload.code,i||l)return a(),[2];return n=setTimeout(e,5e3),[2]}})})).apply(this,arguments)}},[h,s,a]),null}},96748:function(e,t,n){n.d(t,{v:function(){return u}});var r=n(66626),i=n(87722),o=n(25632),a=n(1228),l=n(41772),c=n(90719),s=n(45434);function u(){var e,t,n=(0,o.Gn)("chatEngine").preferences,u=(0,i.hG)().data,d=(0,r._)((0,c.Ni)(),1)[0],f=(0,l.ll)(),h=null==u?void 0:null===(e=u.currentUser)||void 0===e?void 0:e.hasOverride,p=null==n?void 0:n.chatEngine,m=null==u?void 0:null===(t=u.currentUser)||void 0===t?void 0:t.defaultEngine;return h&&p&&(0,s.uL)(p)?p:(0,s.uL)(m)?"advanced"===d&&f?s.hf.model:m:a.Fp}},11134:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(74985),i=n(76999),o=n.n(i),a=n(97754),l=n.n(a);function c(e){var t=e.unreadDot,n=e.size,i=void 0===n?12:n,a=e.count,c=void 0===a?null:a,s=c&&c>99,u=s?"99+":null==c?void 0:c.toString();return(0,r.BX)("span",{className:"jsx-1c7f3b9066c4c334",children:[(0,r.tZ)("svg",{width:i,height:i,viewBox:"0 0 24 24",fill:"none",style:{color:"currentColor"},xmlns:"http://www.w3.org/2000/svg",className:"jsx-1c7f3b9066c4c334",children:(0,r.tZ)("path",{d:"M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",className:"jsx-1c7f3b9066c4c334"})}),t?(0,r.tZ)("div",{className:"jsx-1c7f3b9066c4c334 unread-indicator"}):null,!!c&&(0,r.tZ)("div",{className:"jsx-1c7f3b9066c4c334 "+(l()("count",{overflow:s})||""),children:u}),(0,r.tZ)(o(),{id:"1c7f3b9066c4c334",children:"span.jsx-1c7f3b9066c4c334{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex}.unread-indicator.jsx-1c7f3b9066c4c334{width:5px;height:5px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;background-color:var(--accent-red-default);-webkit-transform:translate(8px,-1px);-moz-transform:translate(8px,-1px);-ms-transform:translate(8px,-1px);-o-transform:translate(8px,-1px);transform:translate(8px,-1px);position:absolute}.count.jsx-1c7f3b9066c4c334{-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;background-color:var(--accent-negative-default);-webkit-transform:translate(50%,-50%);-moz-transform:translate(50%,-50%);-ms-transform:translate(50%,-50%);-o-transform:translate(50%,-50%);transform:translate(50%,-50%);position:absolute;min-width:16px;padding:2px 3px;height:16px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;color:white;font-size:var(--font-size-small)}.overflow.jsx-1c7f3b9066c4c334{-webkit-transform:translate(25%,-50%);-moz-transform:translate(25%,-50%);-ms-transform:translate(25%,-50%);-o-transform:translate(25%,-50%);transform:translate(25%,-50%)}"})]})}},55846:function(e,t,n){n.d(t,{AS:function(){return T},Hj:function(){return P},Rp:function(){return I},Tt:function(){return N},gE:function(){return G},j7:function(){return S},xT:function(){return _},yi:function(){return k}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995),l=n(99165),c=n(293);function s(){var e=(0,i._)(["\n  fragment AnnotationsUser on User {\n    id\n    username\n    fullName\n    image\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  fragment AnnotationMessageContent on MessageContentType {\n    __typename\n    ... on TextMessageContentType {\n      text\n    }\n    ... on PreviewMessageContentType {\n      preview\n    }\n    ... on StatusMessageContentType {\n      status\n    }\n  }\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  fragment AnnotationsUIMessage on AnnotationMessage {\n    id\n    user {\n      id\n      ...AnnotationsUser\n    }\n    anchor {\n      id\n    }\n    timeCreated\n    content {\n      __typename\n      ...AnnotationMessageContent\n    }\n    currentUserIsAuthor\n    seen\n  }\n  ","\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  fragment AnnotationsUIAnchor on AnnotationAnchor {\n    id\n    user {\n      id\n      ...AnnotationsUser\n    }\n    path\n    otVersion\n    indexStart\n    indexEnd\n    isResolved\n    isGeneral\n    messages {\n      id\n      ...AnnotationsUIMessage\n    }\n  }\n  ","\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  query AnnotationAnchorsByRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        annotationAnchors {\n          id\n          ...AnnotationsUIAnchor\n        }\n      }\n    }\n    currentUser {\n      id\n      username\n      fullName\n      image\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation CreateAnnotationAnchor(\n    $annotationAnchor: AnnotationAnchorInput!\n    $annotationMessage: AnnotationMessageInput\n    $highlight: AnnotationHighlightInput\n  ) {\n    createAnnotationAnchor(\n      annotationAnchor: $annotationAnchor\n      annotationMessage: $annotationMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}function m(){var e=(0,i._)(["\n  mutation UpdateAnnotationAnchor(\n    $id: String!\n    $changes: AnnotationAnchorChangesInput!\n  ) {\n    updateAnnotationAnchor(id: $id, changes: $changes) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return m=function(){return e},e}function v(){var e=(0,i._)(["\n  mutation CreateAnnotationMessage(\n    $replId: String!\n    $anchorId: String!\n    $annotationMessage: AnnotationMessageInput!\n    $highlight: AnnotationHighlightInput\n  ) {\n    createAnnotationMessage(\n      replId: $replId\n      anchorId: $anchorId\n      annotationMessage: $annotationMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return v=function(){return e},e}function g(){var e=(0,i._)(["\n  mutation updateThreadPreview(\n    $threadId: String!\n    $messageId: String!\n    $message: String\n  ) {\n    updateThreadPreview(\n      threadId: $threadId\n      messageId: $messageId\n      message: $message\n    )\n  }\n"]);return g=function(){return e},e}function y(){var e=(0,i._)(["\n  subscription AnnotationUpdates($replId: String!) {\n    updatedAnnotation: annotationUpdatesByRepl(replId: $replId) {\n      id\n      ...AnnotationsUIAnchor\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function b(){var e=(0,i._)(["\n  subscription MessagePreview($threadId: String!) {\n    threadPreview(threadId: $threadId) {\n      userId\n      messageId\n      message\n    }\n  }\n"]);return b=function(){return e},e}var w={},Z=(0,o.Ps)(s()),x=(0,o.Ps)(u()),C=(0,o.Ps)(d(),Z,x),S=(0,o.Ps)(f(),Z,C),k=(0,o.Ps)(h(),S);function _(e){var t=(0,r._)({},w,e);return a.a(k,t)}var E=(0,o.Ps)(p(),S);function T(e){var t=(0,r._)({},w,e);return l.D(E,t)}var R=(0,o.Ps)(m(),S);function I(e){var t=(0,r._)({},w,e);return l.D(R,t)}var D=(0,o.Ps)(v(),S);function G(e){var t=(0,r._)({},w,e);return l.D(D,t)}var B=(0,o.Ps)(g());function P(e){var t=(0,r._)({},w,e);return l.D(B,t)}var A=(0,o.Ps)(y(),S);function N(e){var t=(0,r._)({},w,e);return c.m(A,t)}b()},8482:function(e,t,n){n.d(t,{Ft:function(){return d},Vy:function(){return m},kL:function(){return p}});var r=n(27387),i=n(66626),o=n(96583),a=n(75533),l=n(43182);function c(){return(c=(0,r._)(function(e,t,n){var r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(!e.path||"number"!=typeof e.indexStart||"number"!=typeof e.indexEnd||!e.otVersion)return[2];if(n===e.otVersion)return[2,{path:e.path,indexStart:e.indexStart,indexEnd:e.indexEnd,otVersion:e.otVersion}];return[4,t({indexStart:e.indexStart,indexEnd:e.indexEnd,versionFrom:e.otVersion,versionTo:n})];case 1:return r=i.sent(),[2,{path:e.path,indexStart:r.indexStart,indexEnd:r.indexEnd,otVersion:n}]}})})).apply(this,arguments)}var s=n(54916),u=n(50959);function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e){var t,n,r,i,s,u,d;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(t=e.anchor,n=e.version,r=e.transformSelection,i=e.content,!t.path)return[2,null];return[4,function(e,t,n){return c.apply(this,arguments)}(t,r,n)];case 1:if(!(s=o.sent()))return[2,null];return d=function(){if(s){var e=s.indexStart,t=s.indexEnd;try{var n=a.xv.of(i.split("\n")),r=n.lineAt(e),o=n.lineAt(t),c=n.sliceString(n.line(Math.max(r.number-2,1)).from,e),u=n.sliceString(t,n.line(Math.min(o.number+2,n.lines)).to);return{precode:c,code:n.sliceString(e,t),postcode:u}}catch(e){l.Tb(e)}}},[2,{anchor:t,newSelection:s,newPosition:u,getHighlight:d,snippet:h(i,s)}]}})})).apply(this,arguments)}var h=function(e,t){var n=a.xv.of(e.split("\n")),r=n.lineAt(t.indexStart).number,i=n.lineAt(t.indexEnd).number,o=[];r===i&&(r=Math.max(1,r-1),i=Math.min(n.lines,i+1));for(var l=r;l<=i;l++)o.push(n.line(l).text);return{startLineNumber:r,lines:o}};function p(e){var t=(0,s.Z)().fs,n=(0,u.useRef)(null),r=(0,u.useRef)(null),o=(0,i._)((0,u.useState)(!1),2),a=o[0],l=o[1];return(0,u.useEffect)(function(){if(e){var i=function(){r.current=null,l(!1)},o=t.watchTextFile(e,{onReady:function(e){var t=e.transformSelection,i=e.initialContent;n.current=i.toString(),r.current=t,l(!0)},onMoveOrDelete:function(){i()},onError:function(){i()},onChange:function(e){var t=e.latestContent;n.current=t}});return function(){i(),o()}}},[e,t]),{contentRef:n,transformSelectionRef:r,loadedFile:a}}function m(e){var t=(0,s.Z)().fs,n=(0,i._)((0,u.useState)(null),2),r=n[0],o=n[1],a=p(null==e?void 0:e.path),c=a.contentRef,f=a.loadedFile,h=a.transformSelectionRef;return(0,u.useEffect)(function(){(null==e?void 0:e.path)&&f&&h.current&&null!==c.current&&d({anchor:e,version:t.getOTVersion(e.path),transformSelection:h.current,content:c.current}).then(function(e){o(e)}).catch(function(e){o(null),l.Tb(e)})},[t,e,f,h,c]),r}},19229:function(e,t,n){n.d(t,{n:function(){return u}});var r=n(41733),i=n(21262),o=n(71440),a=n(99165);function l(){var e=(0,i._)(["\n  mutation MarkMessagesAsSeen(\n    $replId: String!\n    $threadId: String\n    $messageIds: [String!]\n  ) {\n    markMessagesAsSeen(\n      replId: $replId\n      threadId: $threadId\n      messageIds: $messageIds\n    ) {\n      ... on AnnotationMessageList {\n        messages {\n          id\n          seen\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l());function u(e){var t=(0,r._)({},c,e);return a.D(s,t)}},59725:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(66626),i=n(50959),o=n(50782),a=n(19229);function l(e){var t=(0,o.Z)(),n=(0,r._)((0,a.n)(),1)[0];(0,i.useEffect)(function(){if(e){var r=e.messages.filter(function(e){return!e.seen}).map(function(e){return e.id});0!==r.length&&n({variables:{replId:t,threadId:e.id,messageIds:r},optimisticResponse:{__typename:"RootMutationType",markMessagesAsSeen:{messages:r.map(function(e){return{id:e,seen:!0,__typename:"AnnotationMessage"}}),__typename:"AnnotationMessageList"}}})}},[t,e,n])}},30456:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(50782),i=n(41733),o=n(21262),a=n(71440),l=n(58995);function c(){var e=(0,o._)(["\n  query ThreadReplCollaborators($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          ... on User {\n            id\n            username\n            image\n            fullName\n          }\n          ... on Team {\n            id\n            username\n            image\n          }\n        }\n        permissions {\n          id\n          user {\n            id\n            username\n            image\n            fullName\n          }\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},u=(0,a.Ps)(c());function d(){var e=(c={variables:{replId:(0,r.Z)()}},d=(0,i._)({},s,c),l.a(u,d)).data;if((null==e?void 0:e.repl.__typename)!=="Repl")return[];var t=[];(null===(f=e.repl.owner)||void 0===f?void 0:f.username)&&"User"===e.repl.owner.__typename&&t.push(e.repl.owner);var n=!0,o=!1,a=void 0;try{for(var c,d,f,h,p=e.repl.permissions[Symbol.iterator]();!(n=(h=p.next()).done);n=!0){var m,v=h.value;(null===(m=v.user)||void 0===m?void 0:m.username)&&t.push(v.user)}}catch(e){o=!0,a=e}finally{try{n||null==p.return||p.return()}finally{if(o)throw a}}return t}},58626:function(e,t,n){n.d(t,{q:function(){return G},J:function(){return D}});var r,i,o,a=n(41733),l=n(30509),c=n(98924),s=n(66626),u=n(74985),d=n(12285),f=n(4955),h=n(9670),p=n(75533),m=n(4687),v=n(54340),g=m.tk.baseTheme({".cm-diff-inserted":{backgroundColor:"#0053A644",borderLeft:"#0053A6 solid 3px"},".cm-diff-deleted":{backgroundColor:"#c93c3733",borderLeft:"#c93c37 solid 3px"}}),y=m.p.line({attributes:{class:"cm-diff-inserted"}}),b=m.p.line({attributes:{class:"cm-diff-deleted"}}),w=p.Py.define({map:function(e,t){return e.map(t)}}),Z=function(e){"use strict";(0,f._)(n,e);var t=(0,h._)(n);function n(){return(0,d._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-alignment cm-line",e.innerHTML="&nbsp;",e},r.ignoreEvent=function(){return!1},n}(m.l9);function x(e){var t=new p.f_,n=new Z;e.sort(function(e,t){return e.character-t.character});var r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0)for(var c=a.value,s=c.character,u=c.padding,d=0;d<u;d++)t.add(s,s,m.p.widget({widget:n,side:-1,block:!0}))}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return t.finish()}function C(e){var t=e.coloredLines,n=e.colorDecoration;return[g,m.lg.fromClass(function e(r){"use strict";(0,d._)(this,e);var i=new p.f_,o=!0,a=!1,l=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,f=r.state.doc.line(u);i.add(f.from,f.from,n)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}this.decorations=i.finish()},{decorations:function(e){return e.decorations}}),p.QQ.define({create:function(){return m.p.none},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.is(w))return l.value}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t.docChanged?e.map(t.changes):e},provide:function(e){return m.tk.decorations.from(e)}})]}var S=n(20142),k=n(81013),_=n(50959),E=n(4498),T=(r=function(e,t){return m.tk.domEventHandlers({scroll:function(n,r){if(r===e&&n.target){var i=n.target;if(i.scrollTop){var o=i.scrollTop;t.scrollDOM.scrollTo({top:o})}}}})},i=new p.F6,o=new p.F6,{extensions:function(){return{right:i.of([]),left:o.of([])}},setup:function(e,t){e.dispatch({effects:o.reconfigure(r(e,t))}),t.dispatch({effects:i.reconfigure(r(t,e))})}}),R=T.extensions,I=T.setup;function D(e){var t=e.left,n=e.right,r=e.showDiffDecorations,i=void 0===r||r,o=t.code,u=(0,c._)(t,["code"]),d=n.code,f=(0,c._)(n,["code"]),h=(0,k.Z)(),m=h.ref,g=h.view,Z=(0,k.Z)(),S=Z.ref,E=Z.view,T=(0,_.useMemo)(function(){var e=R().left;return u.extensions?[u.extensions,e]:e},[u.extensions]),D=(0,_.useMemo)(function(){var e=R().right;return f.extensions?[f.extensions,e]:e},[f.extensions]);u=(0,l._)((0,a._)({},u),{extensions:T}),f=(0,l._)((0,a._)({},f),{extensions:D});var G=(0,s._)((0,_.useState)(!1),2),B=G[0],P=G[1],A=(0,s._)((0,_.useState)(!1),2),N=A[0],L=A[1];return(0,_.useEffect)(function(){if(g&&E&&B&&N&&i){var e=setTimeout(function(){var e;I(g,E),e=(0,v.Bz)(g.state.doc.sliceString(0),E.state.doc.sliceString(0)),g.dispatch({effects:[p.Py.appendConfig.of(C({coloredLines:e.leftColored.sort(function(e,t){return e-t}),colorDecoration:b})),w.of(x(e.leftPadded))]}),E.dispatch({effects:[p.Py.appendConfig.of(C({coloredLines:e.rightColored.sort(function(e,t){return e-t}),colorDecoration:y})),w.of(x(e.rightPadded))]})});return function(){return clearTimeout(e)}}},[g,E,B,N,i]),(0,_.useEffect)(function(){g&&(g.dispatch({changes:{from:0,to:g.state.doc.length,insert:o}}),P(!0))},[o,g]),(0,_.useEffect)(function(){E&&(E.dispatch({changes:{from:0,to:E.state.doc.length,insert:d}}),L(!0))},[d,E]),{left:{view:g,ref:m,code:o,options:u,ready:B},right:{view:E,ref:S,code:d,options:f,ready:N}}}function G(e){var t=e.diffViewer,n=(0,c._)(e,["diffViewer"]),r=(0,a._)({},t.options,n);return(0,u.BX)(u.HY,{children:[(0,u.tZ)(S.ZP,(0,a._)({ref:t.ref,css:{height:t.ready?0:"auto"},initialDoc:t.code,lineWrapping:!1,readOnly:!0},r)),!t.ready&&(0,u.tZ)(E.Z,{code:t.code,language:r.language,filePath:r.filePath,lineNumbers:!r.hideGutter,fontSize:r.fontSize})]})}},54340:function(e,t,n){n.d(t,{Bz:function(){return p},PO:function(){return m}});var r=n(12285),i=n(66626),o=n(96583),a=n(85386),l=n.n(a),c=l().DIFF_DELETE,s=l().DIFF_INSERT,u=l().DIFF_EQUAL;function d(e,t){var n=new(l()),r=n.diff_linesToChars_(e,t),i=r.chars1,o=r.chars2,a=r.lineArray,c=n.diff_main(i,o,!1);return n.diff_charsToLines_(c,a),c}function f(e){return e.split("\n").length-1}function h(e,t,n){if(e>0){var r=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0===n)return 0;var i=t.indexOf("\n",r);return -1===i?null:1===n?i+1:e(t,n-1,i+1)}(n,t);if(null!==r)return{lineNumber:t,character:r,padding:e}}return null}function p(e,t){var n=!1,r=!1;n="\n"===e[e.length-1],r="\n"===t[t.length-1];for(var o=d(e+(n?"":"\n"),t+(r?"":"\n")),a=0,l=0,p=[],m=[],v=[],g=[],y=0,b=0,w=0;w<o.length;w++){var Z=(0,i._)(o[w],2),x=Z[0],C=f(Z[1]);switch(x){case c:var S,k=(0,i._)(null!==(S=o[w+1])&&void 0!==S?S:[],2),_=k[0],E=k[1];a+=C;for(var T=0;T<C;T++)p.push(a-T);var R=C;_===s&&(R-=f(E));var I=h(R,l,t);I&&g.push(I);break;case s:var D,G=(0,i._)(null!==(D=o[w-1])&&void 0!==D?D:[],2),B=G[0],P=G[1];l+=C;for(var A=0;A<C;A++)m.push(l-A);var N=C;B===c&&(N-=f(P));var L=h(N,a,e);L&&v.push(L);break;case u:l>b&&(b=l),a>y&&(y=a),a+=C,l+=C}}return{leftPadded:v.filter(function(e){return e.lineNumber<b}),rightPadded:g.filter(function(e){return e.lineNumber<y}),leftColored:p,rightColored:m,changedTrailingNewline:n!==r,leftTrailingNewline:n,rightTrailingNewline:r}}var m=function(){"use strict";function e(t,n){(0,r._)(this,e),this.deleted=new Set,this.inserted=new Map,this.linePositions=new Map,this.lineLengths=new Map,this.currentTrailingNewline="\n"===t[t.length-1],this.otherTrailingNewline="\n"===n[n.length-1],this.changedTrailingNewline=this.currentTrailingNewline!==this.otherTrailingNewline;var o=d(t,n),a=[],l=!0,f=!1,h=void 0;try{for(var p,m=o[Symbol.iterator]();!(l=(p=m.next()).done);l=!0){var v=(0,i._)(p.value,2),g=v[0],y=v[1].split("\n");""===y[y.length-1]&&y.pop();var b=!0,w=!1,Z=void 0;try{for(var x,C=y[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var S=x.value;a.push([g,S])}}catch(e){w=!0,Z=e}finally{try{b||null==C.return||C.return()}finally{if(w)throw Z}}}}catch(e){f=!0,h=e}finally{try{l||null==m.return||m.return()}finally{if(f)throw h}}this.currentTrailingNewline&&!this.otherTrailingNewline?a.push([c,""]):!this.currentTrailingNewline&&this.otherTrailingNewline?a.push([s,""]):this.currentTrailingNewline&&this.otherTrailingNewline&&a.push([u,""]);var k=1,_=0,E=1,T=!0,R=!1,I=void 0;try{for(var D,G=a[Symbol.iterator]();!(T=(D=G.next()).done);T=!0){var B=(0,i._)(D.value,2),P=B[0],A=B[1];switch(P){case c:this.linePositions.set(k,_),this.lineLengths.set(k,A.length),this.deleted.add(k),_+=A.length+1,k++;break;case s:var N=k-1,L=this.inserted.get(N);L||(L=[],this.inserted.set(N,L)),L.push({number:E,content:A}),E++;break;case u:this.linePositions.set(k,_),this.lineLengths.set(k,A.length),_+=A.length+1,k++,E++}}}catch(e){R=!0,I=e}finally{try{T||null==G.return||G.return()}finally{if(R)throw I}}}var t=e.prototype;return t.startInsertions=function(){var e=this.inserted.get(0);return e&&0!==e.length?e:null},t.lineIsDeleted=function(e){return this.deleted.has(e)},t.lineInsertions=function(e){var t=this.inserted.get(e);return t&&0!==t.length?t:null},t.lineInsertedContent=function(e){var t=this.lineInsertions(e);return t?t.map(function(e){return e.content}).join("\n"):null},t.offsetFor=function(e){var t,n,r;r=0+(null!==(n=null===(t=this.inserted.get(0))||void 0===t?void 0:t.length)&&void 0!==n?n:0);for(var i=1;i<e;i++){this.lineIsDeleted(i)&&r--;var o=this.lineInsertions(i);o&&(r+=o.length)}return r},t.linePosition=function(e){var t;return null!==(t=this.linePositions.get(e))&&void 0!==t?t:null},t.lineLength=function(e){var t;return null!==(t=this.lineLengths.get(e))&&void 0!==t?t:null},t.line=function(e){var t=this.linePosition(e),n=this.lineLength(e);if(null===t||null===n)return null;var r=this.offsetFor(e),i=this.lineIsDeleted(e),o=this.lineInsertions(e);return{number:e,from:t,to:t+n,length:n,offset:r,isDeleted:i,insertions:o}},t.lines=function(){var e,t,n,r,a,l,c,s;return(0,o.Jh)(this,function(o){switch(o.label){case 0:e=!0,t=!1,n=void 0,o.label=1;case 1:o.trys.push([1,6,7,8]),r=this.linePositions[Symbol.iterator](),o.label=2;case 2:if(e=(a=r.next()).done)return[3,5];if(l=(0,i._)(a.value,1)[0],!(c=this.line(l)))throw Error("line should not be null");return[4,c];case 3:o.sent(),o.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return s=o.sent(),t=!0,n=s,[3,8];case 7:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 8:return[2]}})},e}()},51384:function(e,t,n){n.d(t,{z:function(){return a}});var r=n(12285),i=n(96583),o=n(31157),a=function(){"use strict";function e(t,n,i,o){(0,r._)(this,e),this.a=t,this.b=n,this.chunks=i,this.map=o}var t=e.prototype;return t.line=function(e,t){return t===o.MF.A?this.a.line(e):this.b.line(e)},t.bounds=function(e){if(0===this.chunks.length)return null;var t=(0,o.Cf)(this.chunks[0],e),n=(0,o.Cf)(this.chunks[this.chunks.length-1],e),r=e===o.MF.A?this.a.length:this.b.length,i=Math.min(n.to,r);return{from:t.from,to:i}},t.hasChanges=function(){return this.chunks.length>0},t.updateA=function(t,n){var r=this.b,i=(0,o.U_)(t,r,{chunks:this.chunks,changesA:n}),a=(0,o.XW)(t,r,i);return new e(t,r,i,a)},t.updateB=function(t,n){var r=this.a,i=(0,o.U_)(r,t,{chunks:this.chunks,changesB:n}),a=(0,o.XW)(r,t,i);return new e(r,t,i,a)},t.getContainingChunk=function(e,t){for(var n=0,r=this.chunks.length-1;n<=r;){var i=n+r>>>1,a=this.chunks[i],l=(0,o.Cf)(a,t);if(e>=l.from&&e<=l.to)return a;e<l.from?r=i-1:e>l.to&&(n=i+1)}return null},t.getCorrespondingLine=function(e,t){var n=this.map.get(t===o.MF.A?-e:e);return n?this.line(n,(0,o.rN)(t)):null},t.getLineChangeType=function(e,t){if(this.map.get(t===o.MF.A?-e:e))return o.dQ.UNCHANGED;var n=this.line(e,t),r=this.getContainingChunk(n.from,t);return r?(0,o.dx)(n,t,r.changes,r):o.dQ.UNCHANGED},t.iterLines=function(e){var t,n,r,a;return(0,i.Jh)(this,function(i){switch(i.label){case 0:t=e===o.MF.A?this.a:this.b,n=1,i.label=1;case 1:if(!(n<=t.lines))return[3,4];return r=t.line(n),a=this.getCorrespondingLine(r.number,e),[4,{line:r,correspondingLine:a}];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}})},t.iterRanges=function(){var e,t,n,r,o;return(0,i.Jh)(this,function(i){switch(i.label){case 0:e=0,i.label=1;case 1:if(!(e<this.chunks.length))return[3,6];t=this.chunks[e].fromA,n=this.chunks[e].fromB,r=0,i.label=2;case 2:if(!(r<this.chunks[e].changes.length))return[3,5];return o=this.chunks[e].changes[r],[4,{fromA:t+o.fromA,toA:t+o.toA,fromB:n+o.fromB,toB:n+o.toB}];case 3:i.sent(),i.label=4;case 4:return r++,[3,2];case 5:return e++,[3,1];case 6:return[2]}})},e.create=function(t,n){var r=(0,o.U_)(t,n),i=(0,o.XW)(t,n,r);return new e(t,n,r,i)},e}()},10814:function(e,t,n){n.d(t,{p:function(){return q}});var r,i=n(75533),o=n(12285),a=n(4384),l=n(4955),c=n(9670),s=n(4687),u=n(99517),d=n(99415),f=n(51384),h=n(67075),p=i.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),m=i.QQ.define({create:function(){return{diff:null,tree:d.mp.empty}},update:function(e,t){var n,r,i=t.state.facet(p),o=null===(n=t.state.facet(u.dK))||void 0===n?void 0:n.parser;if(!i)return null===e.diff&&e.tree===d.mp.empty?e:{diff:null,tree:d.mp.empty};var a=e.diff,l=e.tree;return(a&&a.a.eq(i)?t.docChanged&&(a=a.updateB(t.newDoc,t.changes)):(a=f.z.create(i,t.newDoc),l=d.mp.empty),(null===(r=t.startState.facet(u.dK))||void 0===r?void 0:r.parser)!==o&&(l=d.mp.empty),o&&l.length!==a.a.length)?(l=(0,h.p)({parser:o,text:a.a,maxTime:16,base:l}),{diff:a,tree:l}):e.diff===a&&e.tree===l?e:{diff:a,tree:l}}}),v=n(42516),g=n(29287),y="cm-inline-diff-line-deletion-base",b="cm-inline-diff-line-deletion",w="cm-inline-diff-text-deletion",Z="cm-inline-diff-line-insertion-base",x="cm-inline-diff-line-insertion",C="cm-inline-diff-text-insertion",S="rgba(180, 0, 0, 0.075)",k="rgba(180, 0, 0, 0.125)",_="rgba(0, 180, 0, 0.075)",E="rgba(0, 180, 0, 0.125)",T="cm-inline-diff-marker",R="cm-inline-diff-marker-left",I="cm-inline-diff-marker-right";function D(e,t){var n="linear-gradient(to right, ".concat(e,", ").concat(e,")");return t&&(n+=", linear-gradient(to right, ".concat(t,", ").concat(t,")")),n}var G=s.tk.theme((r={},(0,v._)(r,".".concat(y,", .").concat(b),{cursor:"text","&.cm-line ::selection":{backgroundColor:"".concat(g.TV.accentPrimaryDimmest," !important")}}),(0,v._)(r,".".concat(y),{background:D(S)}),(0,v._)(r,".".concat(b),{background:D(S,k)}),(0,v._)(r,".".concat(Z),{background:D(_)}),(0,v._)(r,".".concat(x),{background:D(_,E)}),(0,v._)(r,".".concat(C),{display:"inline-block",background:E,"&:first-of-type":{backgroundClip:"padding-box",borderLeft:"3px solid ".concat(E),paddingLeft:"3px",marginLeft:"-6px"}}),(0,v._)(r,".".concat(w),{display:"inline-block",background:k,"&:first-of-type":{backgroundClip:"padding-box",borderLeft:"3px solid ".concat(k),paddingLeft:"3px",marginLeft:"-6px"}}),(0,v._)(r,".".concat(T),{display:"flex",width:"100%",justifyContent:"space-between"}),(0,v._)(r,".".concat(R),{width:"calc(50% - 1ch)",textAlign:"right"}),(0,v._)(r,".".concat(I),{width:"50%",textAlign:"right"}),r)),B=n(31157),P=n(15658),A=n(3341),N=n.n(A),L=function(e){"use strict";(0,l._)(n,e);var t=(0,c._)(n);function n(e,r,i){var a;return(0,o._)(this,n),(a=t.call(this)).line=e,a.index=r,a.changed=i,a}var r=n.prototype;return r.toDOM=function(){var e=this,t=document.createElement("div");if(t.className=this.changed?"cm-line ".concat(y):"cm-line ".concat(b),!this.changed||!this.changed.length){var n=!0,r=!1,i=void 0;try{for(var o,a=this.line[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=l.text,s=l.tags,u=document.createElement("span");u.textContent=c||"\xa0",u.className=null!=s?s:"",t.appendChild(u)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}for(var d=0,f=0,h=null,p=null,m=function(t,n){if(!h)throw Error("range is null");var r=e.line[f],i=r.text,o=r.tags,a=i.slice(d-h.from,n-h.from),l=document.createElement("span");l.textContent=a||"\xa0",l.className=null!=o?o:"",t.appendChild(l),d+=a.length};f<this.line.length;){if(!h){var v=this.line[f].text;h={from:d,to:d+v.length}}if(!p){var g=!0,Z=!1,x=void 0;try{for(var C,S=this.changed[Symbol.iterator]();!(g=(C=S.next()).done);g=!0){var k=C.value;if(!(k.from>=h.to)&&!(k.to<=d)){var _=document.createElement("span");_.className=w,p={from:k.from,to:k.to,dom:_},d<p.from&&m(t,p.from),t.appendChild(_);break}}}catch(e){Z=!0,x=e}finally{try{g||null==S.return||S.return()}finally{if(Z)throw x}}}p?(d<p.to&&m(p.dom,p.to),d>=p.to&&(p=null)):m(t,h.to),d>=h.to&&(h=null,f++)}return t},r.eq=function(e){var t,r;return e instanceof n&&this.index===e.index&&this.line.length===e.line.length&&(null===(t=this.changed)||void 0===t?void 0:t.length)===(null===(r=e.changed)||void 0===r?void 0:r.length)&&N()(this.line,e.line)&&N()(this.changed,e.changed)},r.ignoreEvent=function(e){return e.stopImmediatePropagation(),!0},(0,a._)(n,[{key:"estimatedHeight",get:function(){return 21}}]),n}(s.l9),U=s.p.line({class:Z}),O=s.p.line({class:x}),M=s.p.mark({class:C}),X=s.tk.decorations.compute([m],function(e){var t=function(e,t){if(r.getLineChangeType(e.number,B.MF.B)===B.dQ.COVERED)o.push(O.range(e.from));else{o.push(U.range(e.from));var n=!0,i=!1,a=void 0;try{for(var l,c=(0,B.Po)(e,t,B.MF.B,!1)[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=l.value;o.push(M.range(s.from,s.to))}}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}}},n=e.field(m,!1);if(!n||!n.diff)return s.p.none;var r=n.diff,i=n.tree,o=[],a=!0,l=!1,c=void 0;try{for(var u,d=r.chunks[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var f=u.value;if(f.fromB!==f.endB)for(var h=r.b.lineAt(f.fromB),p=r.b.lineAt(f.endB),v=h.number;v<=p.number;v++)t(r.b.line(v),f);else f.fromA===f.endA&&t(r.b.lineAt(f.fromB),f);if(f.fromA!==f.toA)for(var g=r.a.lineAt(f.fromA),y=(0,P.CT)(i,r.a,e,f.fromA,f.endA),b=0;b<y.length;b++){var w=y[b],Z=r.a.line(g.number+b),x=r.getLineChangeType(Z.number,B.MF.A)===B.dQ.COVERED?null:(0,B.Po)(Z,f,B.MF.A,!0),C=s.p.widget({widget:new L(w,Z.number,x),block:!0,side:-(y.length-b)});o.push(C.range(f.fromB))}}}catch(e){l=!0,c=e}finally{try{a||null==d.return||d.return()}finally{if(l)throw c}}return s.p.set(o,!0)}),F=n(92708),W=(0,s.v5)({class:F.Tr,renderEmptyElements:!0,lineMarker:function(e,t){var n=e.state.field(m,!1);if(!n||!n.diff||!n.diff.hasChanges())return null;if(0===n.diff.a.length)return F.vP;var r=e.state.doc.lineAt(t.from);switch(n.diff.getLineChangeType(r.number,B.MF.B)){case B.dQ.COVERED:case B.dQ.MODIFIED:return F.vP;default:return null}},widgetMarker:function(e,t){if(!(t instanceof L))return null;var n=e.state.field(m,!1);if(!n||!n.diff||!n.diff.hasChanges())return null;switch(n.diff.getLineChangeType(t.index,B.MF.A)){case B.dQ.COVERED:case B.dQ.MODIFIED:return F.We;default:return null}},initialSpacer:function(e){var t=e.state.field(m,!1);return(null==t?void 0:t.diff)?F.vP:F.Do},updateSpacer:function(e,t){var n=t.state.field(m,!1),r=(null==n?void 0:n.diff)?F.vP:F.Do;return e===r?e:r}}),H=n(3917),V=function(e){"use strict";(0,l._)(n,e);var t=(0,c._)(n);function n(e,r){var i;return(0,o._)(this,n),(i=t.call(this)).left=e,i.right=r,i}var r=n.prototype;return r.toDOM=function(e){var t=e.state.doc.lines.toString().length,n=document.createElement("div"),r=document.createElement("span"),i=document.createElement("span");return n.className=T,r.className=R,i.className=I,n.style.width="".concat(2*t+1,"ch"),null!==this.left&&(r.textContent=this.left.toString()),null!==this.right&&(i.textContent=this.right.toString()),n.appendChild(r),n.appendChild(i),n},r.eq=function(e){return e instanceof n&&this.left===e.left&&this.right===e.right},n}(s.SJ),z=H.X4.of(function(e,t){if(t instanceof L)return new V(t.index,null)}),j=[H.gy.of(function(e,t){var n,r=e.state.field(m,!1);if(r&&r.diff&&r.diff.hasChanges()){var i=e.state.doc.lineAt(t.from),o=r.diff.getCorrespondingLine(i.number,B.MF.B);return new V(null!==(n=null==o?void 0:o.number)&&void 0!==n?n:null,i.number)}}),z],q=i.r$.define({enables:function(e){return[p.computeN([e],function(t){return t.facet(e)}),F.Lw,m,G,X,j,W]}})},92708:function(e,t,n){n.d(t,{Do:function(){return I},Lw:function(){return k},Tr:function(){return d},Vt:function(){return R},We:function(){return E},vP:function(){return _},wp:function(){return T}});var r,i=n(12285),o=n(42516),a=n(4955),l=n(9670),c=n(4687),s=n(29287),u=s.TV.space2,d="cm-diff-gutter",f="".concat(d,"-element"),h="".concat(f,"-insertion"),p="".concat(f,"-modified"),m="".concat(f,"-deleted"),v="".concat(f,"-file-added"),g=s.TV.greenDefault,y=s.TV.greenStronger,b=s.TV.blueDefault,w=s.TV.blueStronger,Z=s.TV.redDefault,x=s.TV.redStronger,C=s.TV.greenDimmer,S=s.TV.greenDefault,k=c.tk.theme((r={},(0,o._)(r,".".concat(d,":first-of-type, .").concat(f),{width:u}),(0,o._)(r,".".concat(h),{backgroundColor:g,"&.cm-activeLineGutter":{backgroundColor:y}}),(0,o._)(r,".".concat(p),{backgroundColor:b,"&.cm-activeLineGutter":{backgroundColor:w}}),(0,o._)(r,".".concat(m),{backgroundColor:Z,"&.cm-activeLineGutter":{backgroundColor:x}}),(0,o._)(r,".".concat(v),{backgroundColor:C,"&.cm-activeLineGutter":{backgroundColor:S}}),r)),_=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(h),e}return n}(c.SJ)),E=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(m),e}return n}(c.SJ)),T=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(p),e}return n}(c.SJ)),R=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,i._)(this,n),e=t.apply(this,arguments),e.elementClass="".concat(f," ").concat(v),e}return n}(c.SJ)),I=new(function(e){"use strict";(0,a._)(n,e);var t=(0,l._)(n);function n(){return(0,i._)(this,n),t.apply(this,arguments)}return n}(c.SJ))},14044:function(e,t,n){n.d(t,{el:function(){return c},er:function(){return u},iG:function(){return s}});var r=n(75533),i=n(43182),o=n(54450),a=r.Py.define(),l=r.Py.define(),c=function(e){var t=e.view,n=e.insert,r=e.scrollIntoView;if(e.overwrite)t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n},effects:a.of(null),scrollIntoView:r,annotations:o.Z.of(!0)});else{var i=t.state.selection.main.head;t.dispatch({changes:{from:t.state.selection.main.from,insert:n},selection:{anchor:i+n.length},effects:a.of(null),scrollIntoView:r,annotations:o.Z.of(!0)})}},s=function(e){var t=e.state.field(u,!1);if(!t){i.Tb(Error("RevetGhostwriterCodeInsertState not found when trying to revert"));return}e.dispatch({changes:t,effects:l.of(null)})},u=r.QQ.define({create:function(){return null},update:function(e,t){e&&(e=e.map(t.changes));var n=!0,r=!1,i=void 0;try{for(var o,c=t.effects[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){var s=o.value;s.is(a)&&(e=t.changes.invert(t.startState.doc)),s.is(l)&&(e=null)}}catch(e){r=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}return e}})},77858:function(e,t,n){n.d(t,{i:function(){return d},o:function(){return u}});var r=n(73367),i=n(64551),o=n(76804),a=n(63185),l=n(54450),c=n(4753),s=n(27783),u=function(e){var t=e.state.field(a.WF,!1),n=e.state.facet(o.t);if(!t||!t.change||!t.timestamp||Date.now()-t.timestamp<150)return!1;var u=e.state.selection.main.head,d=e.state.doc.lineAt(u);if(u<=d.from+d.length-d.text.trimStart().length){var f=t.change.closestRange(u);if(f.value instanceof c.Yf){var h=f.value.unfulfilled.toString(),p=(0,s.L)(h,e.state.tabSize);if(p>0&&p>=e.state.tabSize)return!1}}var m=t.change.asChangeSpec(),v=e.state.changes(m),g=t.change.extendSelection(e.state.selection);return(0,r._B)(e),e.dispatch({changes:v,selection:g,scrollIntoView:!0,effects:a.OK.of(t.dismiss()),annotations:[l.Z.of(!0),i.Iv.of("full")]}),n.onSuggestionAccepted(e,v),!0},d=function(e){var t=e.state.field(a.WF,!1),n=e.state.facet(o.t);return!!t&&!!t.change&&!!t.presented&&(e.dispatch({effects:a.OK.of(t.dismiss())}),n.onSuggestionExplicitlyDismissed(e),!0)}},76804:function(e,t,n){n.d(t,{t:function(){return r}});var r=n(75533).r$.define({combine:function(e){var t=e.filter(Boolean);return{onDismiss:function(e){return t.forEach(function(t){var n;return null===(n=t.onDismiss)||void 0===n?void 0:n.call(t,e)})},onRequestIgnoredBackendOnly:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestIgnoredBackendOnly)||void 0===n?void 0:n.call(t,e)})},onRequestFirstEmit:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestFirstEmit)||void 0===n?void 0:n.call(t,e)})},onRequestEndedWithNoSuggestion:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestEndedWithNoSuggestion)||void 0===n?void 0:n.call(t,e)})},onRequestCompletelyPresented:function(e){return t.forEach(function(t){var n;return null===(n=t.onRequestCompletelyPresented)||void 0===n?void 0:n.call(t,e)})},onSuggestionExplicitlyDismissed:function(e){return t.forEach(function(t){var n;return null===(n=t.onSuggestionExplicitlyDismissed)||void 0===n?void 0:n.call(t,e)})},onSuggestionAccepted:function(e,n){return t.forEach(function(t){var r;return null===(r=t.onSuggestionAccepted)||void 0===r?void 0:r.call(t,e,n)})}}}})},20916:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(25632),i=n(75452),o=n(41733),a=n(21262),l=n(71440),c=n(58995);function s(){var e=(0,a._)(['\n  query CompleteCodeEngine {\n    currentUser {\n      id\n      defaultEngine: gateVariation(feature: "flag-ghostwriter-complete-engine")\n      hasOverride: gate(feature: "flag-code-suggestion-engine")\n    }\n  }\n']);return s=function(){return e},e}var u={},d=(0,l.Ps)(s());function f(){var e,t,n,a,l=(0,r.Gn)("completeCodeEngine").preferences,s=(e=(0,o._)({},u,void 0),c.a(d,e)).data,f=null==l?void 0:l.completeCodeEngine;if(f&&(null==s?void 0:null===(t=s.currentUser)||void 0===t?void 0:t.hasOverride)&&i.vw.has(f))return{engine:f,settings:i.Uw[f]};var h=null!==(a=null==s?void 0:null===(n=s.currentUser)||void 0===n?void 0:n.defaultEngine)&&void 0!==a?a:i.OO;return{engine:h,settings:i.Uw[h]}}},21012:function(e,t,n){n.d(t,{Yy:function(){return i},ZP:function(){return p},G_:function(){return h}});var r,i,o=n(85172),a=n(41733),l=n(21262),c=n(71440),s=n(58995);function u(){var e=(0,l._)(['\n  query CompleteCode {\n    currentUser {\n      id\n      hasAiPro\n      hasKillswitch: gate(feature: "flag-killswitch-ghostwriter")\n    }\n  }\n']);return u=function(){return e},e}var d={},f=(0,c.Ps)(u());function h(e){return"None"!==e&&"BackendOnly"!==e}function p(){var e,t=(e=(0,a._)({},d,void 0),s.a(f,e)).data,n=(0,o.v)().isTeamWithAiDisabled,r=null==t?void 0:t.currentUser;return!r||r.hasKillswitch||n?"None":r.hasAiPro?"Pro":"Basic"}(r=i||(i={})).None="None",r.Basic="Basic",r.Pro="Pro",r.BackendOnly="BackendOnly"},70408:function(e,t,n){n.d(t,{S:function(){return h},t:function(){return f}});var r=n(41733),i=n(30509),o=n(66626),a=n(25425),l=n(11516),c=n(19713),s=n(80703),u=n(50959),d="ai.codecomplete.lastTooltipHintTimestamp",f=(0,c.cn)({tooltipOpen:!1,consecutiveRejections:0});function h(){var e=(0,o._)((0,s.KO)(f),2),t=e[0],n=e[1],c=(0,a.P5)({controlName:"flag-killswitch-pichu",logFlagToAnalytics:!1});return(0,u.useEffect)(function(){if(c&&t.tooltipOpen){var e=setTimeout(function(){return n(function(e){return(0,i._)((0,r._)({},e),{tooltipOpen:!1})})},2500);return function(){return clearTimeout(e)}}},[c,t.tooltipOpen,n]),(0,u.useMemo)(function(){return c?{recordAccept:function(){n(function(e){return(0,i._)((0,r._)({},e),{consecutiveRejections:0})})},recordReject:function(){n(function(e){var t=e.consecutiveRejections+1;if(t>=5){var n=l.Z.get(d,"number");if(!n||Date.now()-n>=432e6)return l.Z.set(d,Date.now()),(0,i._)((0,r._)({},e),{consecutiveRejections:t,tooltipOpen:!0})}return(0,i._)((0,r._)({},e),{consecutiveRejections:t})})}}:null},[c,n])}},54001:function(e,t,n){n.d(t,{Z:function(){return ew}});var r=n(41733),i=n(30509),o=n(43182),a=n(75533),l=n(4687),c=n(77858),s=a.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),u=n(12285),d=n(83684),f=n(63185),h=n(86865),p=n(54450),m=a.QQ.define({create:function(){return null},update:function(e,t){if(t.annotation(p.Z)||!t.state.field(f.WF).stopped)return null;if(!t.docChanged&&!t.selection)return e;var n=t.newDoc,r=t.newSelection.main.head;return t.annotation(a.YW.remote)?null!==e&&(0,d.zV)(n,r)&&(0,d.to)(n,r)?e:null:t.selection&&t.isUserEvent("select")?(0,d.zV)(n,r)&&(0,d.to)(n,r)?Date.now():null:t.docChanged&&null!==e?(0,d.zV)(n,r)&&(0,d.to)(n,r)?e:null:e}}),v=function(){"use strict";function e(t){(0,u._)(this,e),this.view=t,this.timeout=null}var t=e.prototype;return t.update=function(e){var t=this,n=e.startState.field(m),r=e.state.field(m);n!==r&&(null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null),null!==r&&(this.timeout=setTimeout(function(){t.timeout=null,t.view.dispatch({effects:[h.mb.of(h.xz.NOW)]})},2500)))},t.destroy=function(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},e}(),g=l.lg.fromClass(v,{provide:function(){return m}}),y=n(4384),b=n(99517),w=n(43647),Z=n(76804),x=n(31417),C=n(27387),S=n(96583),k=n(16689),_=n.n(k),E=["o17pu","o1gpu","ovgpu","ovgpure","ovgpuref","ovgpurf","ovgpuva","ovgpuvat","o!gpu","pnzfyhg","pnzjuber","puvap","puvax","pbba","pbbaf","phaavr","phag","phagsnpr","phagubyr","phagyvpx","phagyvpx","phagyvpxre","phagyvpxre","phagyvpxvat","phagyvpxvat","phagent","phagf","qnexvr","qngr encr","qngrencr","snt","sntont","sntt","snttvat","snttvg","snttvgg","snttbg","snttf","sntbg","sntbgf","sntf","sntgneq","sngnff","shpxgneq","shpxgneqf","tnat onat","tnatonat","tnatonatrq","tnatonatrq","tnatonatf","tnlgneq","tnljnq","tbngpk","tbngfr","tevatb","ubne","ubner","ubre","ubbxre","wnvy onvg","wnvyonvg","wnc","wvtnobb","wvttnobb","wvttreobb","xhag","y3v+pu","y3vgpu","yrzba cnegl","ybyvgn","a1ttn","a1ttre","anzoyn","arteb","avtt3e","avtt4u","avttn","avttnu","avttnf","avttnm","avttre","avttref","avtyrg","avt abt","dhrreonvg","dhrreubyr","encr","encvat","encvfg","ergneq","ehfxv","furznyr","fubgn","fxnax","fyhg","fyhgont","fyhgf","jrgonpx","juvgr cbjre","juber"],T=E.reduce(function(e,t){return Math.max(e,t.length)},0),R=null,I=function(){"use strict";function e(t){var n=this;(0,u._)(this,e),this.config=t,this.finished=!1,this.abortController=new AbortController,this.suggestion="",this.promise=this.start(),this.abortController.signal.addEventListener("abort",function(){if(!n.finished){var e,t;n.finished=!0,null===(e=(t=n.config).onFinished)||void 0===e||e.call(t,null)}})}var t=e.prototype;return t.start=function(){var e=this;return(0,C._)(function(){var t,n,r,i,o,a,l,c,s,u,f,h,p,m,v,g,y,b,w,Z,C,k,I,D,G,B,P,A,N,L;return(0,S.Jh)(this,function(S){switch(S.label){case 0:S.trys.push([0,13,,14]),r="",i=!0,o=!1,a=void 0;try{for(l=e.config.prefix.iter(-1)[Symbol.iterator]();!(i=(c=l.next()).done)&&(u=(s=c.value).trimEnd(),r=(s?s.slice(u.length):"\n")+r,!(u.length>0));i=!0);}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}f=e.config.prefix.length-r.length,h=r?e.config.prefix.slice(0,f):e.config.prefix,p=e.config.request({language:e.config.language,filePath:e.config.filePath,code:h.toString(),suffix:e.config.suffix?e.config.suffix.toString():void 0,maxTokens:e.config.maxTokens,signal:e.abortController.signal}),m=!0,v=!!r,g="",y=!1,b=!1,S.label=1;case 1:S.trys.push([1,6,7,12]),Z=(0,x._)(p),S.label=2;case 2:return[4,Z.next()];case 3:if(!(y=!(C=S.sent()).done))return[3,5];if(k=C.value,v){if(g+=k,(0,d.xb)(k))return[3,4];if(v=!1,I=(0,d.O8)(g),D=(0,d.O8)(r),!I.indentation.startsWith(D.indentation)||!!D.newlines!=!!I.newlines)return e.abort(),[3,5];k=I.indentation.slice(D.indentation.length)+I.content}if(function(e,t){if(t&&("string"!=typeof(t=t.slice(Math.max(0,t.length-T)))&&(t=t.toString()),e=t+e),null===R){var n=E.map(function(e){return e.replace(/[a-zA-Z]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+("n">e.toLowerCase()?13:-13))})}).map(function(e){return _()(e.toLowerCase().trim())}).sort(function(e,t){return t.length-e.length}).join("|"),r="\\b|\\d|_";R=RegExp("(?:".concat(r,")(?:").concat(n,")(?:").concat(r,")"),"i")}return R.test(e)}(k,m?h:e.suggestion))return e.abort(),null===(G=(B=e.config).onError)||void 0===G||G.call(B,Error("Slur detected in output")),[3,5];if(e.suggestion+=k,e.config.onTextReceived&&!1===e.config.onTextReceived(e.suggestion,m))return e.abort(),[3,5];m=!1,S.label=4;case 4:return y=!1,[3,2];case 5:return[3,12];case 6:return P=S.sent(),b=!0,w=P,[3,12];case 7:if(S.trys.push([7,,10,11]),!(y&&null!=Z.return))return[3,9];return[4,Z.return()];case 8:S.sent(),S.label=9;case 9:return[3,11];case 10:if(b)throw w;return[7];case 11:return[7];case 12:return[3,14];case 13:return A=S.sent(),e.aborted||e.abort(),A instanceof DOMException&&"AbortError"===A.name||null===(N=(L=e.config).onError)||void 0===N||N.call(L,A),[3,14];case 14:if(e.aborted)return[2,null];return e.finished=!0,null===(t=(n=e.config).onFinished)||void 0===t||t.call(n,e.suggestion),[2,e.suggestion]}})})()},t.abort=function(){this.aborted||this.abortController.abort()},t.then=function(e,t){return this.promise.then(e,t)},(0,y._)(e,[{key:"aborted",get:function(){return this.abortController.signal.aborted}}]),e}(),D=n(17925),G=n(66899),B=n(89798),P=n(7612),A=n(73164),N=function(){"use strict";function e(t){(0,u._)(this,e),this.view=t,this.destroyed=!1,this.stream=null,this.debounceTimeout=null,this.queued=!1,this.lastPrefixLength=0}var t=e.prototype;return t.dispatchSuggestion=function(e){this.view.dispatch({effects:f.OK.of(e)})},t.dismiss=function(){this.queued=!1,null!==this.debounceTimeout&&(clearTimeout(this.debounceTimeout),this.debounceTimeout=null),!this.stream||this.stream.finished||this.stream.aborted||this.stream.abort(),this.destroyed||this.suggestion.stopped||this.dispatchSuggestion(this.suggestion.dismiss()),this.listeners.onDismiss(this.view)},t.requestSuggestion=function(e){var t,n,r=this;if(null!==this.config&&null!==this.fileTypeConfig){if(null!==this.debounceTimeout&&(clearTimeout(this.debounceTimeout),this.debounceTimeout=null),!this.config.debounceAlways&&e===h.xz.NOW){this.requestSuggestionImmediately();return}var i=this.view.state.selection.main.head,o=this.view.state.wordAt(i),a=o&&o.from!==i?null!==(n=this.config.debounceTimeInsideWord)&&void 0!==n?n:0:null!==(t=this.config.debounceTimeOutsideWord)&&void 0!==t?t:0;0===a?this.requestSuggestionImmediately():this.debounceTimeout=setTimeout(function(){r.debounceTimeout=null,r.requestSuggestionImmediately()},a)}},t.requestSuggestionImmediately=function(){var e,t,n,r,i=this;if(this.dismiss(),null!==this.config&&null!==this.fileTypeConfig&&!this.destroyed&&this.view.hasFocus&&(0,d.zV)(this.view.state.doc,this.view.state.selection.main.head)){var a=this.config,l=this.view.state,c=l.selection.main.head,s=l.doc,u=(0,b.qz)(l),f=null!==(t=null===(e=l.facet(b.dK))||void 0===e?void 0:e.parser)&&void 0!==t?t:null,p=this.fileTypeConfig,m=null!==(n=p.excludeLastIndent)&&void 0!==n&&n,v=null!==(r=p.skipComplexProcessing)&&void 0!==r&&r,g=l.facet(D.r),y=(0,d.$j)(s,l.facet(b.c),c),Z=a.infill?(0,d.WN)(s,c,m):null,x=w.uV.DEFAULT;(0,G.ib)(s,u,c)&&(x=a.supportsExpandedMaximumTokens?w.uV.EMPTY_BLOCK_EXPANDED:w.uV.EMPTY_BLOCK),this.lastPrefixLength=y.length,a.backendOnly||this.dispatchSuggestion(this.suggestion.start());var C=D.q.create("",c,s,u,f);this.stream=new I({request:a.request,language:p.id,filePath:p.path,maxTokens:x,prefix:y,suffix:Z,onTextReceived:function(e,t){if(t&&i.listeners.onRequestFirstEmit(i.view),a.backendOnly){i.listeners.onRequestIgnoredBackendOnly(i.view);return}if(i.suggestion.stopped||(C=C.with({source:e}).process({excludeLastIndent:m,skipComplexProcessing:v,syntaxBasedCutting:g})).empty)return!1;var n=i.suggestion.merge(C.insertions);if(n.stopped)return!1;i.dispatchSuggestion(n)},onFinished:function(e){var t=i.queued;if(i.queued=!1,!a.backendOnly){if(e&&!i.suggestion.stopped&&!(C=C.with({source:e}).process({excludeLastIndent:m,skipComplexProcessing:v,syntaxBasedCutting:g})).empty){var n=i.suggestion.merge(C.insertions);if(!n.stopped){i.dispatchSuggestion(n.present()),i.listeners.onRequestCompletelyPresented(i.view);return}}i.dismiss(),t&&i.requestSuggestion(h.xz.ENQUEUE),""===e&&i.listeners.onRequestEndedWithNoSuggestion(i.view)}},onError:function(e){o.$e(function(t){t.setExtra("prefix",y.toString()),t.setExtra("maxTokens",x),t.setExtra("language",p.id),t.setExtra("selection-head",c),t.setExtra("previous-character",s.sliceString(c-1,c)),a.onErrorExtras&&t.setExtras(a.onErrorExtras(i)),t.setTag("ghostwriter",!0),o.Tb(e)})}})}},t.postUpdate=function(e){(0,P.a)(e,s,B.Yp)&&this.dismiss(),(0,P.a)(e,f.WF)&&this.suggestion.stopped&&this.streaming&&this.dismiss();var t=(0,h.Io)(e.transactions);switch(t){case h.xz.STOP:this.active&&this.dismiss();break;case h.xz.ENQUEUE:case h.xz.NOW:this.active?this.queued=!0:this.requestSuggestion(t)}},t.destroy=function(){this.destroyed=!0,this.dismiss()},(0,y._)(e,[{key:"config",get:function(){return this.view.state.facet(s)}},{key:"listeners",get:function(){return this.view.state.facet(Z.t)}},{key:"suggestion",get:function(){return this.view.state.field(f.WF)}},{key:"fileTypeConfig",get:function(){var e,t=this.view.state.facet(B.Yp);if(!t)return null;var n=A.$R.from(t);if(!n)return null;var o=null===(e=n.getFeature("ai"))||void 0===e?void 0:e.complete;return(null==o?void 0:o.enabled)?(0,i._)((0,r._)({},o),{id:n.id,path:null!=t?t:""}):null}},{key:"streaming",get:function(){return null!==this.debounceTimeout||null!==this.stream&&!this.stream.finished}},{key:"active",get:function(){return this.streaming||!this.suggestion.stopped}}]),e}(),L=l.lg.fromClass(N,{provide:function(e){return l.tk.updateListener.of(function(t){var n;null===(n=t.view.plugin(e))||void 0===n||n.postUpdate(t)})}}),U=function(){"use strict";function e(t){(0,u._)(this,e),this.view=t,this.gesture=null,this.touchstart=this.touchstart.bind(this),this.touchmove=this.touchmove.bind(this),this.touchend=this.touchend.bind(this),this.touchcancel=this.touchcancel.bind(this),t.dom.addEventListener("touchstart",this.touchstart)}var t=e.prototype;return t.shouldAllowSwiping=function(){if(!this.view.hasFocus)return!1;var e=this.view.state.selection.main.head,t=this.view.viewport;if(t.from>e||t.to<e)return!1;var n=this.view.state.field(f.WF,!1);return!!n&&!!n.change&&!!n.presented},t.stop=function(){this.gesture&&(this.gesture=null,document.removeEventListener("touchmove",this.touchmove),document.removeEventListener("touchend",this.touchend),document.removeEventListener("touchcancel",this.touchcancel))},t.touchFor=function(e){if(!this.gesture)return null;var t=!0,n=!1,r=void 0;try{for(var i,o=e.changedTouches[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.identifier===this.gesture.id)return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return null},t.touchstart=function(e){if(this.gesture&&!this.gesture.time)return this.stop();if(!this.gesture&&this.shouldAllowSwiping()&&1===e.changedTouches.length){var t=e.changedTouches[0];this.gesture={id:t.identifier,start:{x:t.clientX,y:t.clientY},end:{x:t.clientX,y:t.clientY},time:null},document.addEventListener("touchmove",this.touchmove,{passive:!1}),document.addEventListener("touchend",this.touchend,{passive:!1}),document.addEventListener("touchcancel",this.touchcancel)}},t.touchmove=function(e){var t=this.touchFor(e);if(this.gesture&&t){if(this.gesture.end.x=t.clientX,this.gesture.end.y=t.clientY,this.gesture.time&&Date.now()-this.gesture.time>500)return this.stop();var n=Math.abs(this.gesture.start.y-this.gesture.end.y),r=Math.abs(this.gesture.start.x-this.gesture.end.x);if(n>20)return this.stop();if(r>10){if(this.gesture.start.x>this.gesture.end.x)return this.stop();this.gesture.time||(this.gesture.time=Date.now()),e.preventDefault()}}},t.touchend=function(e){var t=this.touchFor(e);if(this.gesture&&t){this.gesture.end.x=t.clientX,this.gesture.end.y=t.clientY;var n=Math.abs(this.gesture.start.y-this.gesture.end.y),r=Math.abs(this.gesture.start.x-this.gesture.end.x);n<=20&&r>75&&this.gesture.start.x<this.gesture.end.x&&(!this.gesture.time||Date.now()-this.gesture.time<500)&&((0,c.o)(this.view),e.preventDefault()),this.stop()}},t.touchcancel=function(e){this.touchFor(e)&&this.stop()},t.update=function(){this.gesture&&!this.shouldAllowSwiping()&&this.stop()},t.destroy=function(){this.view.dom.removeEventListener("touchstart",this.touchstart),document.removeEventListener("touchmove",this.touchmove),document.removeEventListener("touchend",this.touchend),document.removeEventListener("touchcancel",this.touchcancel)},e}(),O=l.lg.fromClass(U),M=n(27308),X=a.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null},enables:function(e){return[s.compute([e],function(t){return t.facet(e)}),f.WF,h._v,L,O,g,a.Wl.high(l.$f.compute([e],function(t){var n=t.facet(e),r=[];return(null==n?void 0:n.keyAcceptSuggestion)&&r.push({key:(0,M.cU)(n.keyAcceptSuggestion),run:c.o}),(null==n?void 0:n.keyDismissSuggestion)&&r.push({key:(0,M.cU)(n.keyDismissSuggestion),run:c.i}),r}))]}}),F=n(17528),W=n(2178),H=n(50959),V=n(12338);function z(){return(z=(0,W._)(function(e){var t,n,r,i;return(0,S.Jh)(this,function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:return[4,(0,F._)(t.read())];case 2:if(r=(n=o.sent()).done,i=n.value,r)return[3,4];return[4,i];case 3:return o.sent(),[3,1];case 4:return t.releaseLock(),[2]}})})).apply(this,arguments)}function j(){return(j=(0,W._)(function(e){var t,n,r,i,o,a,l,c;return(0,S.Jh)(this,function(s){switch(s.label){case 0:t=new TextDecoder("utf-8"),n=!1,r=!1,s.label=1;case 1:s.trys.push([1,7,8,13]),o=(0,x._)(function(e){return z.apply(this,arguments)}(e)),s.label=2;case 2:return[4,(0,F._)(o.next())];case 3:if(!(n=!(a=s.sent()).done))return[3,6];return l=a.value,[4,t.decode(l,{stream:!0})];case 4:s.sent(),s.label=5;case 5:return n=!1,[3,2];case 6:return[3,13];case 7:return c=s.sent(),r=!0,i=c,[3,13];case 8:if(s.trys.push([8,,11,12]),!(n&&null!=o.return))return[3,10];return[4,o.return()];case 9:s.sent(),s.label=10;case 10:return[3,12];case 11:if(r)throw i;return[7];case 12:return[7];case 13:return[2]}})})).apply(this,arguments)}var q=n(21012),Y=n(2689),J=n(12621),K=new Map,$={beforeCompletion:function(e){o.n_({category:"ghostwriter",message:"Called completeCode: "+e.engine,level:"debug"});var t=J.YX.add(e),n=Y.kg.timeStart({language:e.language,engine:e.engine,replid:e.replId,codeLength:e.code.length});return K.set(t,n),t},afterCompletion:function(e,t,n,r){switch(e){case"aborted":J.YX.abort(r),K.delete(r);break;case"success":o.n_({category:"ghostwriter",message:"Suggestion emitted: "+n.partialSuggestion,level:"debug"});var i=K.get(r);if(!i)throw Error("No latency logger found for handle: "+JSON.stringify(r));i("code suggestion",{type:"success"}),K.delete(r);break;case"finished":J.YX.complete(r,{__typename:"CompleteCodeResult",id:Date.now().toString(),code:n.completeSuggestion});break;default:throw Error("Unknown completion kind: "+e)}},erroredCompletion:function(e,t){t&&(J.YX.abort(t),K.delete(t)),Y.kg.error("CompleteCode: error in completion provider",{err:String(e)})}},Q=n(59868),ee=n(93748),et=n(75023),en=n(25632),er=n(25425),ei=n(50782),eo=n(50199),ea=n(96003),el=n(95683);function ec(e){return JSON.stringify({text:e})+"\n"}var es=function(){"use strict";function e(){(0,u._)(this,e),this.list=[]}var t=e.prototype;return t.add=function(e,t,n){this.list.push({prefix:e,suggestion:t,tokens:n}),this.list.length>25&&this.list.pop(),this.list.sort(function(e,t){return t.suggestion.length-e.suggestion.length})},t.retrieve=function(e,t){for(var n=0;n<this.list.length;n++){var r=this.list[n],i=r.prefix,o=r.suggestion,a=r.tokens;if(!(2*a<t)){if(e===i)return ec(o);if(!(i.length>e.length||i.length+o.length<=e.length||2*Math.floor((i.length+o.length-e.length)/(o.length/a))<t)){var l=o.lastIndexOf("\n");if(-1===l||!(l<=e.length-i.length)){var c=i+o;if(c.startsWith(e)){var s=c.slice(e.length);if(s.trim().length)return ec(s)}}}}}return null},e}(),eu=n(66626),ed=n(54916),ef=n(58091),eh=n(19659),ep={javascript:["javascript","typescript"],python:["python","python3"],python3:["python","python3"],typescript:["javascript","typescript"]},em=["json"],ev=n(20916),eg=n(70408),ey=new et.j(function(e,t,n,r,i,o,a,l,c,s,u,d){var f,p;return e?(n===q.Yy.Pro?(f=w.Dz,p=s?w.Dd:w.Dz):(f=c,p=s?w.VF:c),[X.of({request:a,infill:o,backendOnly:n===q.Yy.BackendOnly,debounceTimeOutsideWord:f,debounceTimeInsideWord:p,debounceAlways:n!==q.Yy.Pro,supportsExpandedMaximumTokens:"replit-v1-5-3b"===t||"replit-repltuned-v1-5-3b"===t,keyAcceptSuggestion:r,keyDismissSuggestion:i,onErrorExtras:function(){return l}}),h._b.of(u),D.r.of(d)]):null}),eb=new et.j(function(e,t,n){if(!e)return null;var a,l,c=(a=null,l=function(){},{queue:function(e){if(!(Math.random()>.1)){a&&clearTimeout(a);var t=function(){(0,Q.j)(Q.U3.CODE_SUGGESTION_USED,(0,r._)({type:"suggestionPresented"},e))};a=setTimeout(t,500),l=t}},flush:function(){a&&clearTimeout(a),l()},cancel:function(){a&&clearTimeout(a)}});return Z.t.of({onDismiss:function(){c.cancel()},onRequestIgnoredBackendOnly:function(){o.n_({category:"ghostwriter",message:"called completeCode for free user but did not show the ghost text.",level:"info"}),(0,Q.j)(Q.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionNotPresented"},t),{reason:"ghostTextNotEnabledForFreeUser"}))},onRequestFirstEmit:function(e){var n=e.plugin(L);n&&(o.n_({category:"ghostwriter",message:"Suggestion presented",level:"debug"}),c.queue((0,i._)((0,r._)({},t),{prefixLength:n.lastPrefixLength})))},onRequestEndedWithNoSuggestion:function(){o.n_({category:"ghostwriter",message:"Exited completeCode iteration with no suggestion.",level:"info"}),(0,Q.j)(Q.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionNotPresented"},t),{reason:"noSuggestion"}))},onSuggestionAccepted:function(e,a){var l=e.plugin(L);if(l){c.flush();var s=Math.abs(a.newLength-a.length);(0,Q.j)(Q.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionAccepted"},t),{prefixLength:l.lastPrefixLength,suggestionLength:s})),o.n_({category:"ghostwriter",message:"Suggestion accepted",level:"info"}),null==n||n.recordAccept()}},onSuggestionExplicitlyDismissed:function(e){var a=e.plugin(L);a&&(c.flush(),(0,Q.j)(Q.U3.CODE_SUGGESTION_USED,(0,i._)((0,r._)({type:"suggestionDismissed"},t),{prefixLength:a.lastPrefixLength})),o.n_({category:"ghostwriter",message:"Suggestion explicitly dismissed",level:"info"}),null==n||n.recordReject())}})});function ew(e){var t,n,i,o,a,l,c,s,u,d,f,h=e.filePath,p=(0,ei.Z)(),m=(0,en.Gn)("codeSuggestion").preferences,v=(0,q.ZP)(),g=m.codeSuggestion&&v!==q.Yy.None;(0,H.useEffect)(function(){J.YX.toggle(g)},[g]);var y=(0,ev.Z)(),b=y.engine,Z=y.settings,k=(0,ea.gf)(ee.CN.acceptPrimaryCompletion.id),_=(0,ea.gf)(ee.CN.cancelCompletion.id),E=null!==(f=null==Z?void 0:Z.infill)&&void 0!==f&&f,T=(0,el.S)(h),R=function(e,t){var n,r,i,o,a,l,c,s,u,d,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,p=(0,ed.Z)().fs,m=(r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,r=(0,er.P5)({controlName:"flag-ghostwriter-neighboring-context",logFlagToAnalytics:!0}),i=(0,ef.Bx)(),o=(0,eu._)((0,H.useState)(null),2),a=o[0],l=o[1];return(0,H.useEffect)(function(){l(r?i.filter(function(n){var r,i;return(!!((r=(0,el.S)(n).toLowerCase())===(i=e.toLowerCase())||em.includes(r))||!!ep[r]&&ep[r].includes(i))&&n!==t&&(0,eh.Mb)(n)}).slice(0,n):null)},[e,t,r,n,i]),a}(e,t,h),i=(0,H.useCallback)(function(e,t){var n;return{type:"file",code:(n=e.split("\n")).slice(Math.max(0,n.length-f)).join("\n"),path:t}},[f]),o=(0,H.useCallback)((n=(0,C._)(function(e){return(0,S.Jh)(this,function(t){switch(t.label){case 0:return[4,p.readFile(e)];case 1:return[2,t.sent()]}})}),function(e){return n.apply(this,arguments)}),[p]),l=(a=(0,eu._)((0,H.useState)([]),2))[0],c=a[1],u=(s=(0,eu._)((0,H.useState)(!1),2))[0],d=s[1],(0,H.useEffect)(function(){r&&(d(!0),(0,C._)(function(){var e;return(0,S.Jh)(this,function(t){switch(t.label){case 0:var n;return[4,Promise.all(r.map((n=(0,C._)(function(e){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,o(e)];case 1:if((t=n.sent()).error)return[2,!1];return[2,i(t.content.toString(),e)];case 2:return n.sent(),[2,!1];case 3:return[2]}})}),function(e){return n.apply(this,arguments)})))];case 1:return e=t.sent().filter(Boolean),d(!1),c(e),[2]}})})())},[r,o,i]),{cachedFiles:l,loading:u}).cachedFiles;return null!=m?m:[]}(T,h),I=(0,eo.Z)(function(){return new es},[T,h,p,b]),D=(n=(t={engine:b,replId:p,context:R,settings:{infill:E},provider:(0,eo.Z)(function(){var e;return e=(0,C._)(function(e,t){var n,r,i,o,a,l;return(0,S.Jh)(this,function(c){switch(c.label){case 0:return[4,fetch("/ai/complete",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},signal:t,body:JSON.stringify(e)})];case 1:if(r=(n=c.sent()).body,!(200!==(i=n.status)))return[3,3];return o=Error.bind,l=(a="Error (".concat(i,") response from /ai/complete: ")).concat,[4,n.text()];case 2:throw new(o.apply(Error,[void 0,l.apply(a,[c.sent()])]));case 3:if(!r)throw Error("No body in response");return[2,function(){return function(e){return j.apply(this,arguments)}(r)}]}})}),function(t,n){return e.apply(this,arguments)}},[]),cache:I,hooks:$}).engine,i=t.replId,o=t.context,a=t.settings,l=t.provider,c=t.cache,s=t.hooks,u=a.infill,(0,H.useCallback)((d=(0,W._)(function(e){var t,a,d,f,h,p,m,v,g,y,b,w,Z,C,k,_,E,T,R,I,D,G,B,P,A,N;return(0,S.Jh)(this,function(L){switch(L.label){case 0:if(t=e.language,a=e.filePath,d=e.code,f=e.suffix,h=e.signal,p=e.maxTokens,!d)return[2];if(m="markdown"===t?{maxTokens:75,stop:[]}:{},v=(0,r._)({language:t,code:d,suffix:u?f:void 0,replId:i,filePath:a,engine:n,maxTokens:p,context:o,stop:["\n\n","```"]},m),g=null==s?void 0:s.beforeCompletion(v),!(null!==(b=c.retrieve(d,p))))return[3,1];return y=(0,W._)(function(){return(0,S.Jh)(this,function(e){switch(e.label){case 0:return[4,b];case 1:return e.sent(),[2]}})}),[3,4];case 1:return L.trys.push([1,3,,4]),[4,(0,F._)(l(v,h))];case 2:return y=L.sent(),[3,4];case 3:if((null==(w=L.sent())?void 0:w.name)==="AbortError")return[2];return null==s||s.erroredCompletion(w instanceof Error?w:Error("Unknown error"),g),[2];case 4:Z="",C="",k=!0,_=!1,h.addEventListener("abort",function(){g&&(null==s||s.afterCompletion("aborted",v,{},g)),_=!0}),E=!1,T=!1,L.label=5;case 5:L.trys.push([5,13,14,19]),I=(0,x._)(y()),L.label=6;case 6:return[4,(0,F._)(I.next())];case 7:if(!(E=!(D=L.sent()).done))return[3,12];G=D.value,C+=G,B=void 0,L.label=8;case 8:if(!(-1!==(B=C.indexOf("\n"))))return[3,11];if(P=JSON.parse(C.substring(0,B)).text,C=C.substring(B+1),A=(0,V.Hy)(P,t).replacementSuggestion,Z+=A,_)return[3,10];return[4,A];case 9:L.sent(),L.label=10;case 10:return!_&&k&&g&&(null==s||s.afterCompletion("success",v,{fromCache:!!b,partialSuggestion:A},g)),k=!1,(0,V.cx)(Z).haltAfter&&(_=!0),[3,8];case 11:return E=!1,[3,6];case 12:return[3,19];case 13:return N=L.sent(),T=!0,R=N,[3,19];case 14:if(L.trys.push([14,,17,18]),!(E&&null!=I.return))return[3,16];return[4,I.return()];case 15:L.sent(),L.label=16;case 16:return[3,18];case 17:if(T)throw R;return[7];case 18:return[7];case 19:if(null===b&&Z.trim().length&&c.add(d,Z,p),!(!_&&C))return[3,21];return[4,C];case 20:L.sent(),L.label=21;case 21:return g&&(null==s||s.afterCompletion("finished",v,{completeSuggestion:Z,fromCache:!!b},g)),[2]}})}),function(e){return d.apply(this,arguments)}),[n,i,o,u,c,s,l])),G=(0,eg.S)(),B=(0,H.useMemo)(function(){return{filePath:h,language:T,engine:b,additionalContextCount:R.length,additionalContextLength:R.reduce(function(e,t){return e+t.code.length},0)}},[h,T,b,R]),P=(0,er.P5)({controlName:"flag-gw-magikarp-bounce-time",logFlagToAnalytics:!1,default:w.yr,type:"number"}),A=(0,er.P5)({controlName:"flag-ghostwriter-alternate-debounce",logFlagToAnalytics:!0}),N=(0,er.P5)({controlName:"flag-completely-different-tree-trigger",logFlagToAnalytics:!0}),L=(0,er.P5)({controlName:"flag-completely-different-tree-cutting",logFlagToAnalytics:!0}),U=[ey.use(g,b,v,k,_,E,D,B,P,A,N,L),eb.use(g,B,G)];return(0,H.useMemo)(function(){return U},U)}},71749:function(e,t,n){n.d(t,{$_:function(){return P},II:function(){return R},If:function(){return T},U1:function(){return B},Xs:function(){return D},fL:function(){return E},k4:function(){return G}});var r=n(66626),i=n(63257),o=n(74985),a=n(43704),l=n(26508),c=n(87659),s=n(93496),u=n(74833),d=n(30983),f=n(56596),h=n(93918),p=n(12880),m=n(88936),v=n(39511),g=n(25753),y=n(29287),b=n(80431),w=n(50959),Z=n(37951),x=n(20573),C=[y.l0.p(4),y.l0.center,y.l0.borderRadius(4)],S=(0,h.X)({root:(0,i._)(C).concat([y.l0.cursor.pointer,(0,c.ec)("blurple")]),disabled:(0,i._)(C).concat([(0,c.ec)("grey")])});function k(e){return e.disabled||e.connecting?(0,o.tZ)(f.G,{css:S.disabled,tag:"button","data-cy":"ghostwriter-inline-submit",children:e.connecting?(0,o.tZ)(m.Z,{size:12}):(0,o.tZ)(v.Z,{size:12})}):(0,o.tZ)(f.G,{"data-cy":"ghostwriter-inline-submit",css:S.root,tag:"button",onClick:e.onClick,children:e.loading?(0,o.tZ)(g.Z,{size:12}):(0,o.tZ)(v.Z,{size:12})})}var _=(0,h.X)({root:[y.l0.py(8),y.l0.pr(8),y.l0.maxWidth(800),y.l0.colWithGap(4),{fontFamily:y.TV.fontFamilyDefault}],container:[y.l0.position.relative,y.l0.backgroundColor.backgroundDefault],input:[s.gU.outlined,y.l0.borderRadius(4),{paddingBottom:36,"@media (hover: hover)":{":not([disabled]):hover":{backgroundColor:"transparent"}}}],textarea:[y.l0.p(8),y.l0.pb(0),{caretColor:"initial",fontFamily:y.TV.fontFamilyDefault,border:"0 none",resize:"none",height:"1em",backgroundColor:"transparent","@media (hover: hover)":{":not([disabled]):focus":{outline:"0 none"}},"::placeholder":{color:y.TV.foregroundDimmest}}],footer:[y.l0.px(8),y.l0.pr(6),y.l0.rowWithGap(8),y.l0.align.center,y.l0.position.absolute,y.l0.bottom(0),y.l0.left(0),y.l0.width("100%"),{height:36}],footerLeft:[y.l0.rowWithGap(8),y.l0.flex.growAndShrink(1),y.l0.align.center],iconText:[y.l0.rowWithGap(4),y.l0.align.center],footerRight:[y.l0.rowWithGap(4),y.l0.align.center,{"& button":[y.l0.height(22),y.l0.py(6),y.l0.py(4),y.l0.borderRadius(4)]}],error:[y.l0.color.accentNegativeStronger]}),E=function(e){var t=e.requestMeasure,n=e.type,r=e.children,i=e.isCodeMirrorPocket,a=(0,l.Z)(t);return(0,o.tZ)(b.Z,{bsod:!0,tags:{ai:!0},extras:{type:n},origin:"ErrorBoundary: InlineAiWidget",children:(0,o.tZ)(f.G,{css:_.root,innerRef:a,className:void 0===i||i?"cm-pocket-widget":void 0,children:r})})},T=function(e){var t=e.requestMeasure,n=e.type,r=e.children,i=e.isCodeMirrorPocket,a=e.error,l=e.clearError;return(0,o.BX)(E,{type:n,requestMeasure:t,isCodeMirrorPocket:void 0===i||i,children:[(0,o.tZ)(f.G,{css:_.container,children:r}),a?(0,o.tZ)(Z.E,{icon:(0,o.tZ)(x.Z,{color:y.TV.accentNegativeDefault}),text:a,closable:!0,closeAction:l}):null]})};function R(e){var t=(0,a.Z)();return(0,o.tZ)(f.G,{css:_.input,children:(0,o.tZ)("textarea",{value:e.value,onChange:e.onChange,placeholder:e.placeholder,css:_.textarea,ref:t.ref,onKeyDown:e.onKeyDown,autoFocus:e.autoFocus,"data-cy":"ghostwriter-inline-input"})})}var I={generateCode:"Generate new code based on this file.",transformCode:"Modify selected code based on the context of this file."};function D(e){var t=e.type;return(0,o.tZ)(d.u,{tooltip:I[t],children:(0,o.BX)(f.G,{css:_.iconText,children:[(0,o.tZ)(p.Z,{size:12,color:y.TV.foregroundDimmest}),(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"transformCode"===t?"Modify":"Generate"})]})})}function G(e){var t=e.loading,n=e.disabled,r=e.onClick,i=e.connecting;return(0,o.BX)(o.HY,{children:[t?(0,o.BX)(f.G,{css:_.iconText,children:[(0,o.tZ)(m.Z,{size:12,color:y.TV.blurpleDefault}),(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"AI is writing"})]}):(0,o.tZ)(u.xv,{variant:"small",color:"dimmest",children:"Esc to close, Enter to submit"}),(0,o.tZ)(k,{connecting:i,loading:t,disabled:n,onClick:r})]})}function B(e){var t=e.onClose,n=e.loading,i=e.onSubmit,o=(0,r._)((0,w.useState)(""),2),a=o[0],l=o[1];return{value:a,setValue:l,onKeyDown:function(e){switch(e.key){case"Escape":e.preventDefault(),t();break;case"Enter":if(e.preventDefault(),n)break;e.shiftKey?l(function(e){return e+"\n"}):e.metaKey||i()}}}}var P=function(e){var t=(0,r._)(e.children,2),n=t[0],i=t[1];return(0,o.BX)(f.G,{css:_.footer,children:[(0,o.tZ)(f.G,{css:_.footerLeft,children:n}),(0,o.tZ)(f.G,{css:_.footerRight,children:i})]})}},12448:function(e,t,n){n.d(t,{W:function(){return tf}});var r,i,o,a=n(75533),l=n(4687),c=n(60417),s=n(12285),u=n(4384),d=n(4955),f=n(9670),h=n(99517),p=n(99415),m=n(51384),v=n(67075),g=a.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),y=a.QQ.define({create:function(){return{diff:null,tree:p.mp.empty}},update:function(e,t){var n,r,i=t.state.facet(g),o=null===(n=t.state.facet(h.dK))||void 0===n?void 0:n.parser;if(!i)return null===e.diff&&e.tree===p.mp.empty?e:{diff:null,tree:p.mp.empty};var a=e.diff,l=e.tree;return(a&&a.b.eq(i)?t.docChanged&&(a=a.updateA(t.newDoc,t.changes)):(a=m.z.create(t.newDoc,i),l=p.mp.empty),(null===(r=t.startState.facet(h.dK))||void 0===r?void 0:r.parser)!==o&&(l=p.mp.empty),o&&l.length!==a.b.length)?(l=(0,v.p)({parser:o,text:a.b,maxTime:16,base:l}),{diff:a,tree:l}):e.diff===a&&e.tree===l?e:{diff:a,tree:l}}}),b=n(42516),w=n(29287),Z="cm-transform-diff-line-deletion-base",x="cm-transform-diff-line-deletion",C="cm-transform-diff-text-deletion",S="cm-transform-diff-line-insertion-base",k="cm-transform-diff-line-insertion",_="cm-transform-diff-text-insertion",E="cm-transform-diff-number-marker",T="rgba(180, 0, 0, 0.1)",R="rgba(180, 0, 0, 0.125)",I="rgba(0, 180, 0, 0.1)",D="rgba(0, 180, 0, 0.125)";function G(e,t){var n="linear-gradient(to right, ".concat(e,", ").concat(e,")");return t&&(n+=", linear-gradient(to right, ".concat(t,", ").concat(t,")")),n}var B=l.tk.theme((i={},(0,b._)(i,".".concat(S,", .").concat(k),{cursor:"text","&.cm-line ::selection":{backgroundColor:"".concat(w.TV.accentPrimaryDimmest," !important")}}),(0,b._)(i,".".concat(Z),{background:G(T),backgroundClip:"content-box"}),(0,b._)(i,".".concat(x),{background:G(T,R),backgroundClip:"content-box"}),(0,b._)(i,".".concat(S),{background:G(I),backgroundClip:"content-box"}),(0,b._)(i,".".concat(k),{background:G(I,D),backgroundClip:"content-box"}),(0,b._)(i,".".concat(_),{display:"inline-block",background:D}),(0,b._)(i,".".concat(C),{display:"inline-block",background:R}),(0,b._)(i,".".concat(E),{opacity:.5}),i)),P=n(31157),A=n(15658),N=n(3341),L=n.n(N),U=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e,r,i){var o;return(0,s._)(this,n),(o=t.call(this)).line=e,o.index=r,o.changed=i,o}var r=n.prototype;return r.toDOM=function(){var e=this,t=document.createElement("div");if(t.className=this.changed?"cm-line ".concat(S):"cm-line ".concat(k),!this.changed||!this.changed.length){var n=!0,r=!1,i=void 0;try{for(var o,a=this.line[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=l.text,s=l.tags,u=document.createElement("span");u.textContent=c||"\xa0",u.className=null!=s?s:"",t.appendChild(u)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}for(var d=0,f=0,h=null,p=null,m=function(t,n){if(!h)throw Error("range is null");var r=e.line[f],i=r.text,o=r.tags,a=i.slice(d-h.from,n-h.from),l=document.createElement("span");l.textContent=a||"\xa0",l.className=null!=o?o:"",t.appendChild(l),d+=a.length};f<this.line.length;){if(!h){var v=this.line[f].text;h={from:d,to:d+v.length}}if(!p){var g=!0,y=!1,b=void 0;try{for(var w,Z=this.changed[Symbol.iterator]();!(g=(w=Z.next()).done);g=!0){var x=w.value;if(!(x.from>=h.to)&&!(x.to<=d)){var C=document.createElement("span");C.className=_,p={from:x.from,to:x.to,dom:C},d<p.from&&m(t,p.from),t.appendChild(C);break}}}catch(e){y=!0,b=e}finally{try{g||null==Z.return||Z.return()}finally{if(y)throw b}}}p?(d<p.to&&m(p.dom,p.to),d>=p.to&&(p=null)):m(t,h.to),d>=h.to&&(h=null,f++)}return t},r.eq=function(e){var t,r;return e instanceof n&&this.index===e.index&&this.line.length===e.line.length&&(null===(t=this.changed)||void 0===t?void 0:t.length)===(null===(r=e.changed)||void 0===r?void 0:r.length)&&L()(this.line,e.line)&&L()(this.changed,e.changed)},r.ignoreEvent=function(e){return e.stopImmediatePropagation(),!0},(0,u._)(n,[{key:"estimatedHeight",get:function(){return 21}}]),n}(l.l9),O=l.p.line({class:Z}),M=l.p.line({class:x}),X=l.p.mark({class:C}),F=l.tk.decorations.compute([y],function(e){var t=function(e,t){if(r.getLineChangeType(e.number,P.MF.A)===P.dQ.COVERED)o.push(M.range(e.from));else{o.push(O.range(e.from));var n=!0,i=!1,a=void 0;try{for(var l,c=(0,P.Po)(e,t,P.MF.A,!1)[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=l.value;o.push(X.range(s.from,s.to))}}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}}},n=e.field(y,!1);if(!n||!n.diff)return l.p.none;var r=n.diff,i=n.tree,o=[],a=!0,c=!1,s=void 0;try{for(var u,d=r.chunks[Symbol.iterator]();!(a=(u=d.next()).done);a=!0){var f=u.value;if(f.fromA!==f.endA)for(var h=r.a.lineAt(f.fromA),p=r.a.lineAt(f.endA),m=h.number;m<=p.number;m++)t(r.a.line(m),f);else f.fromB===f.endB&&t(r.a.lineAt(f.fromA),f);if(f.fromB!==f.toB)for(var v=r.b.lineAt(f.fromB),g=(0,A.CT)(i,r.b,e,f.fromB,f.endB),b=0;b<g.length;b++){var w=g[b],Z=r.b.line(v.number+b),x=r.getLineChangeType(Z.number,P.MF.B)===P.dQ.COVERED?null:(0,P.Po)(Z,f,P.MF.B,!0),C=l.p.widget({widget:new U(w,Z.number,x),block:!0,side:b+1}),S=Math.min(f.endA,r.a.length);o.push(C.range(S))}}}catch(e){c=!0,s=e}finally{try{a||null==d.return||d.return()}finally{if(c)throw s}}return l.p.set(o,!0)}),W=n(3917),H=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r;return(0,s._)(this,n),(r=t.call(this)).index=e,r}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("span");return e.className=E,e.textContent=String(this.index),e},r.eq=function(e){return this.index===e.index},n}(l.SJ),V=W.X4.of(function(e,t){if(t instanceof U)return new H(t.index)}),z=a.r$.define({enables:function(e){return[g.computeN([e],function(t){return t.facet(e)}),y,B,F,V]}}),j=n(53466),q=n(51944);(r=o||(o={}))[r.Compare=0]="Compare",r[r.Original=1]="Original",r[r.Suggestion=2]="Suggestion";var Y=a.Py.define(),J=a.QQ.define({create:function(){return o.Suggestion},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,l=t.effects[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;if(c.is(Y))e=c.value;else if(c.is(q.Q))e=null;else if(c.is(q.h)){var s=t.state.field(j.$);if((null==s?void 0:s.type)==="transformCode"&&c.value){var u=t.startState.field(j.u),d=c.value;!u&&d&&(e=o.Suggestion)}}}}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return e}}),K=n(89798),$=n(7612),Q=a.QQ.define({create:function(){return null},update:function(e,t){if(!(0,$.a)(t,"doc",j.$,K.Yp,J,j.u))return e;var n,r=t.state.field(j.$),i=t.state.facet(K.Yp),a=t.state.field(J);if(!r||!i||r.codeReference.filePath!==i||a!==o.Suggestion)return null;var l=r.codeReference.range.indexFrom,c=r.codeReference.range.indexTo,s=t.state.doc.slice(l,c),u=null!==(n=t.state.field(j.u))&&void 0!==n?n:"",d=s.lines,f=u.split(t.state.lineBreak).length-d;return e&&e.after===l&&e.offset===f?e:{after:l,offset:f}}}),ee=W.gy.of(function(e,t){var n=e.state.doc.lineAt(t.from),r=e.state.field(Q);if(r&&!(n.from<=r.after))return new W.un(n.number+r.offset)}),et=W.X4.of(function(e,t){if(t instanceof en)return new W.un(t.index)}),en=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e,r,i){var o;return(0,s._)(this,n),(o=t.call(this)).line=e,o.block=r,o.index=i,o}var r=n.prototype;return r.toDOM=function(){var e=document.createElement(this.block?"div":"span");e.className=this.block?"cm-line":"";var t=!0,n=!1,r=void 0;try{for(var i,o=this.line[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=a.text,c=a.tags,s=document.createElement("span");s.textContent=l||"\xa0",c&&(s.className=c),e.appendChild(s)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e},r.eq=function(e){return this.index===e.index&&(0,A.gj)(this.line,e.line)},r.ignoreEvent=function(){return!1},(0,u._)(n,[{key:"estimatedHeight",get:function(){return 21}}]),n}(l.l9),er=[Q,ee,et,l.tk.decorations.compute([h.dK,j.$,j.u,J,y,K.Yp,a.yy.lineSeparator],function(e){var t=e.field(j.$),n=e.facet(K.Yp),r=e.field(J);if(!t||"transformCode"!==t.type||!n||t.codeReference.filePath!==n||r!==o.Suggestion)return l.p.none;var i=t.codeReference.range.indexFrom,a=t.codeReference.range.indexTo,c=e.doc.lineAt(i),s=e.doc.lineAt(a),u=e.toText(null!==(x=e.field(j.u))&&void 0!==x?x:""),d=e.changes({from:i,to:a,insert:u}),f=d.apply(e.doc),p=i+u.length,m=null===(Z=e.facet(h.dK))||void 0===Z?void 0:Z.parser,g=null;if(m)g=(0,v.p)({parser:m,text:f,changes:d,base:e,upTo:p}),C=(0,A.CT)(g,f,e,i,p);else{C=[];var y=!0,b=!1,w=void 0;try{for(var Z,x,C,S,k=u.iterLines()[Symbol.iterator]();!(y=(S=k.next()).done);y=!0){var _=S.value;C.push([{text:_}])}}catch(e){b=!0,w=e}finally{try{y||null==k.return||k.return()}finally{if(b)throw w}}}var E=[];C.length>1&&i!==a&&0!==s.length&&a===s.to&&a<e.doc.length?E.push(l.p.replace({inclusive:!1,block:!0}).range(i,a)):E.push(l.p.replace({inclusiveStart:!1,block:!0}).range(i,a));for(var T=0;T<C.length;T++){var R=C[T],I=c.number+T,D=l.p.widget({widget:new en(R,T>0,I),inlineOrder:!0,side:T+1,block:T>0});E.push(D.range(i))}return l.p.set(E,!0)})],ei=n(74985),eo=n(63185),ea=n(69543),el=n(54472),ec=n(75023),es=n(2038),eu=n(59868),ed=n(74833),ef=n(56596),eh=n(93918),ep=n(50586),em=n(74652),ev=n(25961),eg=n(59510),ey=n.n(eg),eb=n(67795),ew=(0,eh.X)({container:[w.l0.flex.row,w.l0.align.center,w.l0.cursor.pointer,w.l0.height("100%"),{opacity:.6},w.l0.hover({opacity:1}),{fontFamily:w.TV.fontFamilyDefault,"*":{borderColor:w.TV.foregroundDimmest,color:w.TV.foregroundDimmest},":hover *":{borderColor:w.TV.foregroundDefault,color:w.TV.foregroundDefault}}],shortcut:[w.l0.justify.center]}),eZ=new el.J(function(e){var t=e.onGenerateCode,n=e.height,r=(0,es.T3)(),i=(0,em.gf)(ep.x.id),o=Math.round(.6*n);return(0,ei.BX)(ef.G,{css:ew.container,onClick:function(){(0,eu.j)(eb.U3.GHOSTWRITER_CHAT_INLINE_HINT_CLICKED,{action:"generate"}),t()},children:[(0,ei.tZ)(ed.xv,{style:{fontSize:o},children:"Generate"}),!r&&i?(0,ei.tZ)(ef.G,{style:{marginLeft:Math.round(.3*o)},css:ew.shortcut,children:(0,ei.tZ)(ev.bM,{fontSize:.8*o,keyCombo:i})}):null]})}),ex=l.tk.theme({".cm-ghostwriter-hint-layer":{width:"100%"}}),eC=function(e){var t=e.selection.main.head;return e.doc.lineAt(t)},eS=new ec.j(function(e){return a.QQ.define({create:function(e){return eC(e)},compare:ey(),update:function(e,t){return eC(t.state)},provide:function(t){return[ex,a.Wl.high((0,l.EY)({above:!0,class:"cm-ghostwriter-hint-layer",update:function(e){return(0,$.a)(e,t,j.$,eo.WF)},markers:function(n){var r=n.state.field(t,!1);if(!r||!n.state.selection.main.empty)return[];var i=n.state.field(j.$,!1),o=0===n.state.doc.length,a=(0,ea.o)(n.state);if(r.length>0||i||a||o)return[];var l=n.dom.querySelector(".cm-minimap-gutter"),c=(null==l?void 0:l.clientWidth)||0,s=r.to,u=n.lineBlockAt(s),d=u.top,f=u.height;return[new ek({top:d+n.documentPadding.top,height:f,right:c,pocketOpen:null!==i,activeEditor:n.hasFocus,onGenerateCode:e})]}}))]}})}),ek=function(){"use strict";function e(t){(0,s._)(this,e),this.options=t}var t=e.prototype;return t.position=function(e){e.style.top=this.options.top+"px",e.style.height=this.options.height+"px",e.style.right=this.options.right+"px",e.style.paddingRight=Math.round(.2*this.options.height)+"px"},t.draw=function(){var e=eZ.create({onGenerateCode:this.options.onGenerateCode,height:this.options.height});return e.className="cm-ghostwriter-hint-marker",this.options.activeEditor||(e.style.visibility="hidden"),this.position(e),e},t.eq=function(e){return this.options.top===e.options.top&&this.options.pocketOpen===e.options.pocketOpen&&this.options.activeEditor===e.options.activeEditor},e}(),e_=n(50959),eE=n(49932),eT=n(15146),eR=n(58719),eI=n(24796),eD=n(71749),eG=n(64551),eB=n(14044),eP=n(54450);function eA(e,t){e.dispatch({effects:q.Q.of(null),selection:{anchor:t.range.indexTo,head:t.range.indexTo}}),e.hasFocus||e.focus()}function eN(e,t){(0,eB.el)({view:e,insert:t,scrollIntoView:!0}),e.dispatch({effects:q.Q.of(null)}),e.hasFocus||e.focus()}function eL(e,t){e.dispatch({effects:q.h.of(t)})}function eU(e,t,n){e.dispatch({changes:{from:n.range.indexFrom,to:n.range.indexTo,insert:t},scrollIntoView:!0,effects:q.Q.of(null),annotations:[eP.Z.of(!0),eG.Iv.of("full")]}),e.hasFocus||e.focus()}function eO(e,t){return e.range.indexFrom===t.range.indexFrom&&e.range.indexTo===t.range.indexTo&&e.filePath===t.filePath&&e.fileVersion===t.fileVersion}var eM=(0,eh.X)({root:[w.l0.rowWithGap(8),w.l0.border({color:w.TV.outlineDimmest}),w.l0.p(8),w.l0.borderRadius(4)],text:[w.l0.flex.growAndShrink(1)]}),eX=new el.J(function(e){var t=e.onClose,n=e.requestMeasure;return(0,ei.tZ)(eD.fL,{requestMeasure:n,type:"ghostwriterKillswitch",children:(0,ei.BX)(ef.G,{css:eM.root,children:[(0,ei.tZ)(ef.G,{css:eM.text,children:(0,ei.tZ)(eI.r,{textVariant:"text"})}),(0,ei.tZ)(eT.hU,{alt:"Close",onClick:t,type:"button",children:(0,ei.tZ)(eR.Z,{})})]})})}),eF=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}return n.prototype.toDOM=function(e){var t=this;return eX.create({onClose:function(){return eA(e,t.codeReference)},requestMeasure:function(){return e.requestMeasure()}})},n}(l.l9),eW=n(62507),eH=n(1498),eV=n(73722),ez=n(27173),ej=n(64461),eq=n(83801),eY=n(41772),eJ=new el.J(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.updateCodeBlock,i=e.acceptSuggestion,o=e.onClose,a=e.autoFocus,l=function(){var e=h();(null==e?void 0:e.code)?(i(e.code),(0,eu.j)(eu.U3.GHOSTWRITER_CHAT_INLINE_ACCEPTED,{action:"GENERATE"})):y()},c=function(){var e,t;w.current=x,d({message:x,type:ez.G_.GENERATE_CODE,codeReference:{code:n.code,range:n.range,filePath:n.filePath,fileContent:null!==(e=n.fileContent)&&void 0!==e?e:"",fileVersion:n.fileVersion,language:null!==(t=n.language)&&void 0!==t?t:"",referenceType:ez.MD.INLINE}})},s=(0,eq.G)(),u=(0,eW.XW)({onCode:r,getFileContext:s}),d=u.sendMessage,f=u.stopMessage,h=u.getCode,p=u.loading,m=u.completed,v=u.error,g=u.clearError,y=(0,e_.useCallback)(function(){f(),o()},[f,o]),b=(0,e_.useCallback)(function(){(0,eu.j)(eu.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"GENERATE"}),y()},[y]),w=(0,e_.useRef)(null),Z=(0,eD.U1)({loading:p,onSubmit:function(){_?l():c()},onClose:b}),x=Z.value,C=Z.setValue,S=Z.onKeyDown,k=(0,eY.Un)(),_=k&&m&&w.current===x;return(0,ei.BX)(eD.If,{requestMeasure:t,type:"generateCode",error:v,clearError:g,children:[(0,ei.tZ)(eD.II,{value:x,onChange:function(e){return C(e.currentTarget.value)},placeholder:"Enter a prompt to generate new code",onKeyDown:S,autoFocus:a}),(0,ei.BX)(eD.$_,{children:[(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(eD.Xs,{type:"generateCode"}),m?(0,ei.tZ)(eT.hU,{disabled:!k,alt:"Rerun the same prompt",onClick:function(){return c()},size:12,colorway:"grey",children:(0,ei.tZ)(eV.Z,{})}):null]}),_?(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(eH.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,eu.j)(eu.U3.GHOSTWRITER_CHAT_INLINE_DISCARDED,{action:"GENERATE"}),b()}}),(0,ei.tZ)(eH.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:l,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,ei.tZ)(eD.k4,{connecting:!k,loading:p,disabled:!x,onClick:function(){p?f():c()}})]})]})}),eK=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return eJ.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return eA(e,t)},acceptSuggestion:function(t){return eN(e,t)},updateCodeBlock:function(t){return eL(e,t)},autoFocus:!0})},r.updateDOM=function(e,t){var n=this.codeReference;return eJ.update(e,function(e){return(0,ej.Uy)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return eA(t,n)},e.acceptSuggestion=function(e){return eN(t,e)},e.updateCodeBlock=function(e){return eL(t,e)},e.autoFocus=!1})}),!0},r.eq=function(e){return eO(this.codeReference,e.codeReference)},n}(l.l9),e$=n(7444),eQ=new el.J(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.updateCodeBlock,i=e.acceptSuggestion,a=e.onClose,l=e.autoFocus,c=e.updateDiffSelection,s=function(){var e=m();(null==e?void 0:e.code)?((0,eu.j)(eu.U3.GHOSTWRITER_CHAT_INLINE_ACCEPTED,{action:"TRANSFORM"}),i(e.code)):Z()},u=function(){var e,t;C.current=k,h({message:k,type:ez.G_.TRANSFORM_CODE,codeReference:{code:n.code,range:n.range,filePath:n.filePath,fileContent:null!==(e=n.fileContent)&&void 0!==e?e:"",fileVersion:n.fileVersion,language:null!==(t=n.language)&&void 0!==t?t:"",referenceType:ez.MD.INLINE}})},d=(0,eq.G)(),f=(0,eW.XW)({onCode:r,getFileContext:d}),h=f.sendMessage,p=f.stopMessage,m=f.getCode,v=f.loading,g=f.completed,y=f.error,b=f.clearError,w=(0,e$.Z)(c);(0,e_.useEffect)(function(){if(v){w.current(o.Suggestion);return}g&&w.current(y?o.Original:o.Compare)},[w,g,y,v]);var Z=(0,e_.useCallback)(function(){p(),a()},[p,a]),x=(0,e_.useCallback)(function(){(0,eu.j)(eu.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"TRANSFORM"}),Z()},[Z]),C=(0,e_.useRef)(null),S=(0,eD.U1)({loading:v,onSubmit:function(){R?s():u()},onClose:x}),k=S.value,_=S.setValue,E=S.onKeyDown,T=(0,eY.Un)(),R=T&&!y&&g&&C.current===k;return(0,ei.BX)(eD.If,{requestMeasure:t,type:"generateCode",error:y,clearError:b,children:[(0,ei.tZ)(eD.II,{value:k,onChange:function(e){return _(e.currentTarget.value)},placeholder:"Enter a prompt to modify selection",onKeyDown:E,autoFocus:l}),(0,ei.BX)(eD.$_,{children:[(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(eD.Xs,{type:"transformCode"}),g?(0,ei.tZ)(eT.hU,{alt:"Rerun the same prompt",onClick:function(){return u()},size:12,colorway:"grey",disabled:!T,children:(0,ei.tZ)(eV.Z,{})}):null]}),R?(0,ei.BX)(ei.HY,{children:[(0,ei.tZ)(eH.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,eu.j)(eu.U3.GHOSTWRITER_CHAT_INLINE_DISCARDED,{action:"TRANSFORM"}),x()}}),(0,ei.tZ)(eH.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:s,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,ei.tZ)(eD.k4,{connecting:!T,loading:v,disabled:!k,onClick:function(){v?p():u()}})]})]})}),e0=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return eQ.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return eA(e,t)},acceptSuggestion:function(n){return eU(e,n,t)},updateCodeBlock:function(t){eL(e,t)},updateDiffSelection:function(t){e.dispatch({effects:Y.of(t)})},autoFocus:!0})},r.updateDOM=function(e,t){var n=this.codeReference;return eQ.update(e,function(e){return(0,ej.Uy)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return eA(t,n)},e.acceptSuggestion=function(e){return eU(t,e,n)},e.updateCodeBlock=function(e){return eL(t,e)},e.updateDiffSelection=function(e){t.dispatch({effects:Y.of(e)})},e.autoFocus=!1})}),!0},r.eq=function(e){return eO(this.codeReference,e.codeReference)},n}(l.l9),e1=n(57679),e2=n(74883),e8=n(88936),e4=n(39469),e3=n(475),e5=n(19615),e6=n(22580),e9=n(5018),e7=n(35105),te=a.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:function(){}}});new ec.j(function(e){return te.of(e)});var tt=(0,eh.X)({root:[w.l0.colWithGap(8),w.l0.border({color:w.TV.outlineDimmest}),w.l0.p(8),w.l0.borderRadius(4)],header:[w.l0.rowWithGap(8),w.l0.align.center,w.l0.justify.spaceBetween,w.l0.minHeight(28)],headerLeft:[w.l0.flex.growAndShrink(1),w.l0.rowWithGap(8),w.l0.align.center],footer:[w.l0.rowWithGap(8),w.l0.align.center,w.l0.justify.end]}),tn=new el.J(function(e){var t=e.requestMeasure,n=e.codeReference,r=e.onClose,i=e.openAiChatPane,o=(0,eq.G)(),a=(0,eW.gS)({getFileContext:o}),l=a.sessionId,c=a.sendMessage,s=a.stopMessage,u=a.model,d=a.loading,f=a.completed,h=a.message,p=a.retry,m=(0,eY.Ud)(),v=(0,e_.useCallback)(function(){var e,t;c({codeReference:{code:n.code,range:n.range,filePath:n.filePath,fileContent:null!==(e=n.fileContent)&&void 0!==e?e:"",fileVersion:n.fileVersion,language:null!==(t=n.language)&&void 0!==t?t:"",referenceType:ez.MD.INLINE}})},[c,n]),g=(0,e$.Z)(v),y=(0,e$.Z)(s);(0,e_.useEffect)(function(){g.current();var e=y.current;return function(){e()}},[g,y]);var b=(0,eY.Un)();return(0,ei.tZ)(eD.fL,{requestMeasure:t,type:"explainCode",children:(0,ei.BX)(ef.G,{css:tt.root,dataCy:"ghostwriter-inline-explain-content",children:[h||d?(0,ei.BX)(ef.G,{css:tt.header,children:[(0,ei.BX)(ef.G,{css:tt.headerLeft,children:[(0,ei.tZ)(e5.R,{advanced:"advanced"===u}),(0,ei.tZ)(e7.Dz,{intent:ez.$h.EXPLAIN,text:{color:"dimmest",variant:"small"},icon:{color:w.TV.foregroundDimmest}})]}),f?(0,ei.tZ)(eT.hU,{alt:"Close",dataCy:"ghostwriter-inline-close",children:(0,ei.tZ)(eR.Z,{onClick:function(){return r()}})}):(0,ei.tZ)(eH.zx,{iconLeft:(0,ei.tZ)(e3.Z,{}),size:"small",text:"Stop",onClick:function(){return s()}})]}):null,d&&!h?(0,ei.tZ)(e8.Z,{}):null,h?(0,ei.tZ)(e6.J,{text:h,codeComponent:e1._}):null,f?(0,ei.BX)(ef.G,{css:tt.footer,children:[(0,ei.tZ)(ed.xv,{variant:"small",color:"dimmer",children:"Esc to close"}),(0,ei.tZ)(eH.zx,{iconLeft:(0,ei.tZ)(e4.Z,{}),variant:"outlined",size:"small",text:"Retry",disabled:!b,onClick:function(){p(),(0,eu.j)(eu.U3.GHOSTWRITER_CHAT_INLINE_REGENERATED,{action:"EXPLAIN"})}}),l?(0,ei.tZ)(eH.zx,{dataCy:"ghostwriter-inline-reply-in-chat",iconLeft:b?(0,ei.tZ)(e2.Z,{}):(0,ei.tZ)(e8.Z,{}),disabled:!b,size:"small",text:"Reply in Chat",colorway:b?"blurple":void 0,onClick:function(){(0,eu.j)(eu.U3.GHOSTWRITER_CHAT_INLINE_REPLY_IN_CHAT),m(l,{sessionType:ez.FF.CHAT}),i(l)}}):null]}):null]})})}),tr=function(e){"use strict";(0,d._)(n,e);var t=(0,f._)(n);function n(e){var r,i=e.codeReference;return(0,s._)(this,n),(r=t.call(this)).codeReference=i,r}var r=n.prototype;return r.toDOM=function(e){var t=this.codeReference;return tn.create({requestMeasure:function(){return e.requestMeasure()},codeReference:t,onClose:function(){return eA(e,t)},openAiChatPane:function(t){return(0,e9.ZM)(e.state,{pane:{type:"ghostwriterChat",data:{sessionId:t}}})}})},r.updateDOM=function(e,t){var n=this.codeReference;return tn.update(e,function(e){return(0,ej.Uy)(e,function(e){e.requestMeasure=function(){return t.requestMeasure()},e.codeReference=n,e.onClose=function(){return eA(t,n)}})}),!0},r.eq=function(e){return eO(this.codeReference,e.codeReference)},n}(l.l9),ti=n(85172),to=eE.TV.blurpleDimmest,ta=eE.TV.accentPrimaryDimmest,tl=l.tk.theme({".cm-pocket-highlight":{backgroundColor:"rgba(120, 95, 255, 0.2)"},"@keyframes moveGradient":{"0%":{backgroundPositionX:"100%"},"100%":{backgroundPositionX:"0%"}},".cm-pocket-highlight-loading":{background:"linear-gradient(90deg, ".concat(eE.TV.blurpleDimmest,", ").concat(ta,", ").concat(to,", ").concat(ta,")"),backgroundSize:"300% 100%",backgroundPositionX:"0%",animation:"moveGradient 2s linear infinite"}}),tc=l.tk.decorations.compute([j.$,J,K.Yp],function(e){var t=e.field(j.$),n=e.facet(K.Yp);if(!t||!n||t.codeReference.filePath!==n)return l.p.none;var r=e.doc.lineAt(t.codeReference.range.indexFrom).from,i={generateCode:eK,transformCode:e0,explainCode:tr,ghostwriterKillswitch:eF}[t.type],o=l.p.widget({widget:new i({codeReference:t.codeReference}),block:!0,side:0}).range(r);return l.p.set(o)}),ts=(0,l.EY)({above:!1,update:function(e){return(0,$.a)(e,j.$)},markers:function(e){var t=e.state.field(j.$),n=e.state.facet(K.Yp);if(!t||!n||t.codeReference.filePath!==n)return[];var r=t.codeReference.range.indexFrom,i=t.codeReference.range.indexTo,o=e.state.doc.lineAt(i);o.from>=r&&o.to===i&&i<e.state.doc.length&&(i+=1);var c=a.jT.range(r,i),s=t.loading&&t.codeReference.range.indexFrom<t.codeReference.range.indexTo?"cm-pocket-highlight-loading":"cm-pocket-highlight";return l.dc.forRange(e,s,c)}}),tu=z.compute([j.$,j.u,K.Yp,J],function(e){var t=e.field(j.$),n=e.field(j.u),r=e.facet(K.Yp),i=e.field(J);return t&&n&&r&&t.codeReference.filePath===r&&"transformCode"===t.type&&i===o.Compare?a.as.of({from:t.codeReference.range.indexFrom,to:t.codeReference.range.indexTo,insert:n},e.doc.length).apply(e.doc):null}),td=c.V.compute([j.$,j.u,K.Yp],function(e){var t=e.field(j.$),n=e.field(j.u),r=e.facet(K.Yp);return t&&n&&r&&t.codeReference.filePath===r&&"generateCode"===t.type?a.as.of({from:t.codeReference.range.indexTo,to:t.codeReference.range.indexTo,insert:n},e.doc.length):null});function tf(e){var t=e.onGenerateCode,n=(0,ti.v)().isTeamWithAiDisabled,r=eS.use(t);return(0,e_.useMemo)(function(){var e=[tl,j.$,j.u,tc,ts,J,tu,er,td,r];return n||e.push(r),e},[r,n])}},51944:function(e,t,n){n.d(t,{Q:function(){return i},h:function(){return o}});var r=n(75533),i=r.Py.define(),o=r.Py.define()},53466:function(e,t,n){n.d(t,{$:function(){return f},u:function(){return h}});var r=n(41733),i=n(30509),o=n(75533),a=n(4687),l=n(51944),c=n(82200),s=n(40497),u=n(59868);function d(e){var t=e.state.field(f);if(t){var n=t.type;return"explainCode"===n?(0,u.j)(u.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"EXPLAIN"}):"generateCode"===n?(0,u.j)(u.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"GENERATE"}):"transformCode"===n&&(0,u.j)(u.U3.GHOSTWRITER_CHAT_INLINE_CLOSED,{action:"TRANSFORM"}),e.dispatch({effects:l.Q.of(null)}),!0}return!1}var f=o.QQ.define({create:function(){return null},update:function(e,t){if((0,s.j)(t,l.Q,function(t){e=t.value?{codeReference:t.value.codeReference,type:t.value.type,loading:t.value.loading,data:t.value.data}:null}),!e||t.changes.empty)return e;var n=e.codeReference.range.indexFrom>t.newDoc.length?t.newDoc.length:t.changes.mapPos(e.codeReference.range.indexFrom),o=e.codeReference.range.indexTo>t.newDoc.length?t.newDoc.length:t.changes.mapPos(e.codeReference.range.indexTo);return n>=o?null:e=(0,i._)((0,r._)({},e),{codeReference:(0,i._)((0,r._)({},e.codeReference),{range:{indexFrom:n,indexTo:o,lineFrom:t.newDoc.lineAt(n).number,lineTo:t.newDoc.lineAt(o).number}})})},provide:function(e){return[o.Wl.highest(a.$f.of([{key:"Escape",run:d}])),c.gb.from(e,function(e){var t;return null!==(t=(null==e?void 0:e.loading)&&e.codeReference.range.indexFrom===e.codeReference.range.indexTo)&&void 0!==t?t:null})]}}),h=o.QQ.define({create:function(){return null},update:function(e,t){if(!t.state.field(f))return null;var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value;c.is(l.Q)&&(e=null),c.is(l.h)&&(e=c.value)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}})},54450:function(e,t,n){var r=n(75533).q6.define();t.Z=r},92994:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(50959),i=n(75533);function o(e){var t=e.view,n=e.initialExtension,o=void 0===n?[]:n,a=(0,r.useRef)();return a.current||(a.current=new i.F6),(0,r.useEffect)(function(){if(t){var e=a.current;if(void 0===e.get(t.state))t.dispatch({effects:i.Py.appendConfig.of(e.of(o))});else throw Error("Did not expect useEffect hook to rerun in useCompartment");return function(){t.dispatch({effects:e.reconfigure([])})}}},[t]),a.current}},13358:function(e,t,n){n.d(t,{Z:function(){return U},f:function(){return M}});var r=n(27387),i=n(41733),o=n(30509),a=n(96583),l=n(75533),c=n(4687),s=n(89798),u=n(82200),d=n(92631),f=n(74985),h=n(22487),p=n(72310),m=n(1498),v=n(15146),g=n(74833),y=n(56596),b=n(93918),w=n(32377),Z=n(58719),x=n(29287),C=n(29358),S=n(50959),k=n(61694),_=(0,b.X)({styles0:[x.l0.p(4),x.l0.pl(8)],styles1:[x.l0.maxWidth(100),x.l0.overflow("hidden"),{whiteSpace:"nowrap",textOverflow:"ellipsis"}],styles2:[x.l0.position.absolute,x.l0.top(4),x.l0.right(4)],styles3:[x.l0.flex.rowReverse,x.l0.p(8),x.l0.pt(0)]}),E=(0,b.X)({headerContainer:[x.l0.flex.row,x.l0.align.center,x.l0.pr(4)],bodyContainer:[x.l0.justify.center,x.l0.align.center,x.l0.p(8),x.l0.pt(4)],input:[x.l0.p(4),x.l0.borderRadius(4)],wrapper:[x.l0.flex.column,x.l0.justify.center,x.l0.borderRadius(4),x.l0.shadow(2),x.l0.width(200)]});function T(e){var t=(0,h.Z)(e.onClose,[e.onClose]),n=(0,S.useRef)(null),r=(0,p.Y)(e.currentValue,function(t){return t?t===e.currentValue?{message:"Must pick a new name"}:void 0:{message:"New name can't be empty"}});return(0,f.tZ)(k.ZP,{children:(0,f.tZ)(y.G,{"data-testid":"RenameInput",innerRef:t,css:E.wrapper,onKeyDown:function(t){"Escape"===t.key&&e.onClose(),t.stopPropagation()},children:(0,f.BX)("form",{onSubmit:function(t){t.preventDefault(),r.error||e.onRename(r.value)},children:[(0,f.BX)(y.G,{css:E.headerContainer,children:[(0,f.tZ)(g.h4,{level:2,variant:"subheadDefault",css:_.styles0,children:"Rename"}),(0,f.tZ)(g.h4,{level:2,variant:"subheadDefault",color:"dimmer",css:_.styles1,children:e.currentValue}),(0,f.tZ)(v.hU,{alt:"Close rename input",tooltipHidden:!0,onClick:e.onClose,css:_.styles2,children:(0,f.tZ)(Z.Z,{})})]}),(0,f.tZ)(y.G,{css:E.bodyContainer,children:(0,f.tZ)(C.ZP,{css:E.input,name:"rename",ref:n,onBlur:r.handleBlur,onChange:function(e){r.setValue(e.target.value)},value:r.value,placeholder:"New name",autoFocus:!0,autoCorrect:"off",autoCapitalize:"off",autoComplete:"off",validationResults:r.error?[{message:r.error.message,state:"error"}]:void 0})}),(0,f.tZ)(y.G,{css:_.styles3,children:(0,f.tZ)(m.zx,{type:"submit",text:"Rename",colorway:"primary",iconLeft:(0,f.tZ)(w.Z,{}),disabled:!!r.error||!r.value})})]})})})}var R=n(23758),I=n(54472),D=n(40497),G=n(74106),B=n(72526),P=n(69521),A=l.Py.define(),N=l.Py.define();function L(e){var t,n;return null!==(n=null===(t=e.facet(d.N))||void 0===t?void 0:t.isRenameSupported)&&void 0!==n&&n}var U=function(e){if(!L(e.state))return!1;var t=e.state.selection.main.head;return e.state.wordAt(t)?(e.dispatch({effects:A.of(t)}),!0):((0,R.J)(e,{message:"You cannot rename this element",offset:t}),!1)},O=l.QQ.define({create:function(){return null},update:function(e,t){return(null!==e&&(e=t.changes.mapPos(e,-1,l.gc.TrackDel)),(0,D.j)(t,A,function(t){e=t.value}),e&&(e>t.state.doc.length||!t.state.wordAt(e)||!L(t.state)))?null:e},provide:function(e){var t=new I.J(T),n=function(t){var n=t.field(e);if(null==n)throw Error("Expected non-null offset");var r=t.wordAt(n);if(!r)throw Error("Expected non-null range");return t.sliceDoc(r.from,r.to)},r=function(r){var a=r.state.field(e);if(null==a)throw Error("Expected non-null offset");if(!r.state.wordAt(a))throw Error("Expected non-null range");var l=t.create({currentValue:n(r.state),onClose:function(){r.dispatch({effects:A.of(null)}),r.focus()},onRename:function(e){r.dispatch({effects:N.of(e)})}});return l.classList.add("replit-tooltip"),l.style.padding="0",{dom:l,update:function(e){t.update(l,function(t){var r=n(e.state);return r!==t.currentValue?(0,o._)((0,i._)({},t),{currentValue:r}):t})}}};return c.hJ.from(e,function(e){return null===e?null:{pos:e,create:r}})}});function M(e,t){return[O,c.lg.define(function(n){var i=null;return{onRename:function(t,o){return(0,r._)(function(){var r,l,c,d;return(0,a.Jh)(this,function(a){switch(a.label){case 0:if(!L(n.state))return[2,this.cancelInflightRequest()];if(this.cancelInflightRequest(),!(r=n.state.facet(s.Yp)))throw Error("Expected non-null file path");if(!(l=n.state.field(O)))return[2];return i={clientId:t.clientId,requestId:t.generateId()},[4,t.request.rename(r,(0,G.sg)(n.state.doc,l),o,{id:i.requestId,tap:function(e){return(0,u.SC)(n,e)}})];case 1:if((c=a.sent()).cancelled)return[2];if("error"in c)throw Error("Something went wrong renaming ".concat(c.error.message));if(!(d=c.result))return[2];return(0,B.w)({edit:d,fs:e,client:t}),n.dispatch({effects:A.of(null)}),[2]}})}).apply(this)},cancelInflightRequest:function(){if(i){var e=!0,n=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var l=o.value;if(l.clientId===i.clientId){l.notify.cancelRequest(i.requestId);break}}}catch(e){n=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(n)throw r}}i=null}},update:function(e){var n=!0,r=!1,i=void 0;try{for(var o,a=e.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=!0,s=!1,u=void 0;try{for(var d,f=l.effects[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value;if(h.is(N)){var p=!0,m=!1,v=void 0;try{for(var g,y=t[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var b=g.value;if((0,P.Z)(b).isRenameSupported){this.onRename(b,h.value);return}}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}}}}catch(e){s=!0,u=e}finally{try{c||null==f.return||f.return()}finally{if(s)throw u}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}},destroy:function(){this.cancelInflightRequest()}}})]}},61018:function(e,t,n){n.d(t,{hx:function(){return p},l:function(){return f},sy:function(){return h}});var r=n(75533),i=n(4687),o=n(89798),a=n(75023),l=n(89446),c=n(38041),s=n(19659),u=n(32508),d=n.n(u);function f(e){var t=e.view,n=e.event,i=e.clipboardText,o=e.filePath,a=t.state.selection;if(!o||!(0,s.gK)(o)||a.ranges.length>1||a.main.from===a.main.to||!i||!d()(i)){!function(){if(!n){var e=i||"";if(a.main.empty){var o=a.main.from+e.length;t.dispatch({changes:[{from:a.main.from,insert:e}],selection:r.jT.range(o,o)})}else t.dispatch(t.state.replaceSelection(e))}}();return}n&&n.preventDefault();var l=t.state.sliceDoc(a.main.from,a.main.to),c="[".concat(l,"](").concat(i,")"),u=a.main.from+c.length;t.dispatch({changes:{from:a.main.from,to:a.main.to,insert:c},selection:r.jT.range(u,u)})}var h=i.tk.domEventHandlers({paste:function(e,t){var n;f({filePath:t.state.facet(o.Yp),view:t,event:e,clipboardText:null===(n=e.clipboardData)||void 0===n?void 0:n.getData("Text")})}}),p=new a.j(function(e,t){return i.tk.domEventHandlers({paste:function(n,r){var i=r.state.facet(o.Yp),a=null==n?void 0:null===(p=n.clipboardData)||void 0===p?void 0:p.files,u=function(e){var t=r.state.selection.main.head;r.dispatch({changes:{from:t,insert:e},selection:{anchor:t,head:t+e.length}})};if(a){var d=!0,f=!1,h=void 0;try{for(var p,m,v=a[Symbol.iterator]();!(d=(m=v.next()).done);d=!0){var g=m.value;e?(0,l.L0)(g).then(function(e){return u('"'+e+'"')}):i&&(0,s.gK)(i)&&(0,c.r)(g,t,i).then(u)}}catch(e){f=!0,h=e}finally{try{d||null==v.return||v.return()}finally{if(f)throw h}}}}})})},35895:function(e,t,n){n.d(t,{ZB:function(){return w},qs:function(){return x},Lo:function(){return b},xv:function(){return R},xg:function(){return I},uh:function(){return y},Do:function(){return T},$X:function(){return D},Yt:function(){return Z},Gv:function(){return G},Pz:function(){return C}});var r=n(12285),i=n(4955),o=n(41733),a=n(30509),l=n(9670),c=n(75533),s=n(4687),u=n(86865),d=n(59868),f=n(66626),h={"AWS API Key":/AKIA[0-9A-Z]{16}/g,"AWS AppSync GraphQL Key":/da2-[a-z0-9]{26}/g,"AWS MWS ID":/mzn\.mws\.[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/g,"AWS client ID":/(A3T[A-Z0-9]|AKIA|AGPA|AIDA|AROA|AIPA|ANPA|ANVA|ASIA)[A-Z0-9]{16}/g,"Discord Bot Token":/(?:N|M|O)[a-zA-Z0-9]{23}\\.[a-zA-Z0-9-_]{6}\\.[a-zA-Z0-9-_]{27}/g,"Discord Webhook Url":/https?:\/\/(?:ptb\.|canary\.)?discord\.com\/api(?:\/v\d{1,2})?\/webhooks\/(\d{17,19})\/([\w-]{68})/gi,"Dynatrace Token":/dt0[a-zA-Z]{1}[0-9]{2}\\.[A-Z0-9]{24}\\.[A-Z0-9]{64}/gi,"Facebook Access Token":/EAACEdEose0cBA[0-9A-Za-z]+/g,"Facebook OAuth":/[fF][aA][cC][eE][bB][oO][oO][kK].*['|"][0-9a-f]{32}['|"]/g,"Github Personal Access Token":/ghp_[0-9a-zA-Z]{36}/g,"Github OAuth Access Token":/gho_[0-9a-zA-Z]{36}/g,"Github App Installation Access Token":/(ghu|ghs)_[0-9a-zA-Z]{36}/g,"Github App Refresh Token":/ghr_[0-9a-zA-Z]{76}/g,"Generic API Key":/[aA][pP][iI]_?[kK][eE][yY].*['|"][0-9a-zA-Z]{32,45}['|"]/g,"Generic Secret":/[sS][eE][cC][rR][eE][tT].*['|"][0-9a-zA-Z]{32,45}['|"]/g,"Google API Key":/AIza[0-9A-Za-z\\-_]{35}/g,"Google Gmail API Key":/AIza[0-9A-Za-z\\-_]{35}/g,"Google OAuth Access Token":/ya29\\.[0-9A-Za-z\\-_]+/g,"Google YouTube API Key":/AIza[0-9A-Za-z\\-_]{35}/g,"Heroku API Key":/[hH][eE][rR][oO][kK][uU].*[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}/g,"MailChimp API Key":/[0-9a-f]{32}-us[0-9]{1,2}/g,"Mailgun API Key":/key-[0-9a-zA-Z]{32}/g,"Mapbox, Public Key":/([s,p]k.eyJ1Ijoi[\w.-]+)/g,"Mapbox, Secret Key":/([s,p]k.eyJ1Ijoi[\w.-]+)/g,"npm Access Token":/npm_[0-9a-zA-Z]{36}/g,"NuGet API Key":/oy2[a-z0-9]{43}/g,"OpenAI API Key":/sk-[a-zA-Z0-9]{48}/g,"PGP private key block":/-----BEGIN PGP PRIVATE KEY BLOCK-----/g,"Picatic API Key":/sk_live_[0-9a-z]{32}/g,"PyPI API Token":/pypi-AgEIcHlwaS5vcmc[A-Za-z0-9-_]{50,1000}/g,"SSH (DSA) private key":/-----BEGIN DSA PRIVATE KEY-----/g,"SSH (EC) private key":/-----BEGIN EC PRIVATE KEY-----/g,"SSH (RSA) private key":/-----BEGIN RSA PRIVATE KEY-----/g,"SendGrid API Key":/SG\\.[0-9A-Za-z\\-_]{22}\\.[0-9A-Za-z-_]{43}/g,"Shopify Access Token":/shpat_[a-fA-F0-9]{32}/g,"Shopify App Shared Secret":/shpss_[a-fA-F0-9]{32}/g,"Shopify Custom App Access Token":/shpca_[a-fA-F0-9]{32}/g,"Shopify Private App Password":/shppa_[a-fA-F0-9]{32}/g,"Slack Token":/(xox[pborsa]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})/g,"Slack API Token":/xox[baprs]-([0-9a-zA-Z]{10,48})?/g,"Slack Live API Key":/(?:r|s)k_live_[0-9a-zA-Z]{24}/g,"Slack Test API Key":/(?:r|s)k_test_[0-9a-zA-Z]{24}/g,"Slack, OAuth v2 Bot Access Token":/xoxb-[0-9]{11}-[0-9]{11}-[0-9a-zA-Z]{24}/g,"Slack, OAuth v2 Configuration Token":/xoxe.xoxp-1-[0-9a-zA-Z]{166}/g,"Slack, OAuth v2 Refresh Token":/xoxe-1-[0-9a-zA-Z]{147}/g,"Slack, OAuth v2 User Access Token":/xoxp-[0-9]{11}-[0-9]{11}-[0-9a-zA-Z]{24}/g,"Slack Webhook":/https:\/\/hooks.slack.com\/services\/T[a-zA-Z0-9_]{10}\/B[a-zA-Z0-9_]{10}\/[a-zA-Z0-9_]{24}/g,"Square Access Token":/sq0atp-[0-9A-Za-z\\-_]{22}/g,"Square OAuth Secret":/sq0csp-[0-9A-Za-z\\-_]{43}/g,"Stripe API Key":/sk_live_[0-9a-zA-Z]{24}/g,"Stripe Restricted API Key":/rk_live_[0-9a-zA-Z]{24}/g,"Twilio API Key":/SK[0-9a-fA-F]{32}/g,"Twitter Access Token":/[tT][wW][iI][tT][tT][eE][rR].*[1-9][0-9]+-[0-9a-zA-Z]{40}/g,"Twitter OAuth":/[tT][wW][iI][tT][tT][eE][rR].*['|"][0-9a-zA-Z]{35,44}['|"]/g,"Vault Token":/([sb]\.[a-zA-Z0-9]{24})/g},p={"Instagram oauth":/[0-9a-fA-F]{7}.[0-9a-fA-F]{32}/g},m=function(e){"use strict";(0,i._)(n,e);var t=(0,l._)(n);function n(e,i){var o;return(0,r._)(this,n),(o=t.call(this)).id=e,o.result=i,o}return n.range=function(e,t,n){return new this(e,n).range(t.from,t.to)},n.generateId=function(){return this.secretId++},n}(c.uU);m.secretId=0;var v=function(e){"use strict";(0,i._)(n,e);var t=(0,l._)(n);function n(e){var i;return(0,r._)(this,n),(i=t.call(this)).key=e,i}return n.from=function(e){return new this(e)},n}(c.uU),g=c.Py.define({map:function(e,t){var n=c.Xs.of(e).map(t).iter(),r=n.from,i=n.to;return m.range(e.value.id,c.jT.cursor(r,i),e.value.result)}}),y=c.Py.define(),b=c.Py.define(),w=c.Py.define(),Z=c.Py.define(),x=c.Py.define(),C=function(e){var t=e.state.field(I);if(!t.size)return!1;for(var n=t.iter(),r=[];n.value;){var i=n.from,o=n.to,a=n.value;r.push({from:i,to:o,value:a}),n.next()}var l=e.state.doc.length,s=c.as.empty(l),u=[],f=[],h=!0,p=!1,m=void 0;try{for(var v,g=r[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)!function(){var e=v.value,t=e.from,n=e.to,r=e.value,i=r.result.secret,o=c.as.of({from:t,to:n,insert:i},l).map(s,!0);u=u.map(function(e){return e.map(o)});var a=(s=s.compose(o)).mapPos(t)+i.length;u.push(c.jT.cursor(a)),f.push(y.of(r.id)),(0,d.j)(d.U3.PASTE_SCANNER_USED,{action:"original_accepted",provider:r.result.provider})}()}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}return e.dispatch({changes:s,effects:f,selection:c.jT.create(u)}),!0},S=function(e){return!!e.state.facet(D)&&!!e.state.field(I).size&&(e.dispatch({effects:e.state.selection.ranges.map(function(e){return b.of(e)})}),!0)},k=function(e){return!e.state.facet(D)&&_(e)},_=function(e){return!!e.state.field(I).size&&(e.dispatch({effects:e.state.selection.ranges.map(function(e){return y.of(e)})}),!0)};function E(e,t){var n,r=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/plain");if(!r)return!1;var i=function(e){if(e.length>2e3)return!1;var t=!0,n=!1,r=void 0;try{for(var i,o=[h,p][Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=!0,c=!1,s=void 0;try{for(var u,d=Object.entries(a)[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var m=(0,f._)(u.value,2),v=m[0],g=m[1],y=e.search(g);if(!(y<0)){var b=e.match(g);if(b){var w=y+b[0].length;return{start:y,end:w,secret:e.slice(y,w),provider:v}}}}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!1}(r);if(!i)return!1;e.preventDefault(),e.stopPropagation();var l=r.slice(0,i.start)+r.slice(i.end),s=m.generateId();return t.dispatch((0,a._)((0,o._)({},t.state.changeByRange(function(e){var t=e.from,n=e.to,r=c.jT.cursor(t+i.start);return{range:r,changes:{from:t,to:n,insert:l},effects:g.of(m.range(s,r,i))}})),{scrollIntoView:!0})),(0,d.j)(d.U3.PASTE_SCANNER_USED,{action:"secret_detected",provider:i.provider}),!0}var T=c.QQ.define({create:function(){return c.Xs.empty},update:function(e,t){e=e.map(t.changes);var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.is(Z)){var s=l.value,u=s.from,d=s.to,f=s.secret;e=e.update({add:[v.from(f).range(u,d)],filter:function(){return!1}})}l.is(x)&&(e=c.Xs.empty)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}}),R=c.QQ.define({create:function(){return null},update:function(e,t){var n=t.state.field(I,!1),r=!0,i=!1,o=void 0;try{for(var a,l=t.effects[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var s=a.value;n&&s.is(b)&&(s.value instanceof c.xm?n.between(s.value.from,s.value.to,function(t,n,r){e=r}):e=s.value),s.is(w)&&(e=null)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return e}}),I=c.QQ.define({create:function(){return c.Xs.empty},update:function(e,t){e=e.map(t.changes);var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)!function(){var t=o.value;t.is(g)&&(e=e.update({add:[t.value],sort:!0})),t.is(y)&&(e=t.value instanceof c.xm?e.update({filter:function(){return!1},filterFrom:t.value.from,filterTo:t.value.to}):e.update({filter:function(e,n,r){return r.id!==t.value}}))}()}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e},provide:function(){return[s.tk.domEventHandlers({paste:E}),c.Wl.highest(s.$f.of([{key:"Mod-z",run:_},{key:"Enter",run:C},{key:"Tab",run:S,stopPropagation:!0},{key:"Escape",run:k}]))]}}),D=c.r$.define({combine:function(e){return e.some(Boolean)}}),G=u.RR.of(function(e){var t=e.state.field(I,!1);if(!t||!t.size)return!1;var n=!1;return t.between(e.newSelection.main.from,e.newSelection.main.to,function(){return n=!0,!1}),n})},81031:function(e,t,n){n.d(t,{F:function(){return C},V:function(){return S}});var r=n(66626),i=n(74985),o=n(4687),a=n(43312),l=n(20142),c=n(81013),s=n(75023),u=n(73157),d=n(15146),f=n(57468),h=n(74833),p=n(56596),m=n(99741),v=n(29287),g=n(50959),y=n(74106),b=(0,a.iv)({scrollbarWidth:"thin",outline:"none",overflow:"auto",".cm-content":{paddingBottom:0},"::-webkit-scrollbar":{width:4},".cm-gutters":{minWidth:"unset"}}),w=(0,a.iv)({overflow:"hidden",".cm-scroller":{overflow:"hidden"}}),Z={root:v.l0.backgroundColor.backgroundRoot,higher:v.l0.backgroundColor.backgroundHigher,highest:v.l0.backgroundColor.backgroundHighest,default:v.l0.backgroundColor.backgroundDefault},x=new s.j(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(0,o.Eu)({formatNumber:function(t,n){for(var r=String(n.doc.lines).length,i=String(t+e-1);r>i.length;)i="\xa0"+i;return i}})});function C(e){var t=e.path,n=e.initialDoc,r=e.maxHeight,o=e.minHeight,s=e.extensions,u=e.allowScroll,d=e.fontSize,f=e.hideGutter,h=e.startLineNumber,p=e.style,m=e.elevation,v=e.onNavigateToCode,C=(0,c.Z)(),S=C.ref,k=C.view,_=(0,g.useMemo)(function(){var e;return e=Z[null!=m?m:"default"],(0,a.iv)({".cm-editor":e,".cm-gutters":e})},[m]),E=x.use(h);return(0,i.tZ)("div",{style:p,children:(0,i.tZ)(l.ZP,{ref:S,initialDoc:n,css:[b,_,void 0===u||u?null:w],extensions:[E,void 0===s?[]:s],style:{minHeight:o,maxHeight:null!=r?r:"10em"},hideGutter:f,filePath:t,fontSize:d,readOnly:!0,onClick:function(e){if(v&&k){var t=e.clientX,n=e.clientY,r=k.posAtCoords({x:t,y:n});v(null!==r?(0,y.sg)(k.state.doc,r):null)}}})})}function S(e){var t=e.path,n=e.doc,o=e.extensions,a=e.numMatches,l=e.onNavigateToCode,c=e.initiallyExpanded,s=(0,r._)((0,g.useState)(c),2),y=s[0],b=s[1];return(0,i.BX)(p.G,{children:[(0,i.BX)(p.G,{css:[v.l0.width("100%"),v.l0.p(4),v.l0.rowWithGap(8),{alignItems:"center"}],children:[(0,i.tZ)(f.Z,{path:t}),(0,i.tZ)(h.xv,{multiline:!1,title:t,css:[v.l0.flex.shrink(1),{textOverflow:"ellipsis"}],children:t}),(0,i.tZ)(h.xv,{color:"dimmest",multiline:!1,children:(0,u.Z)("match",a,!0)}),(0,i.tZ)(p.G,{css:v.l0.flex.grow(1)}),(0,i.tZ)(d.hU,{alt:y?"Collapse snippet":"Expand snippet",tooltipHidden:!0,onClick:function(){return b(function(e){return!e})},children:(0,i.tZ)(m.Z,{rotate:y?180:0,style:{transition:"200ms ease"}})})]}),(0,i.tZ)(p.G,{css:[v.l0.p(4),{display:y?"block":"none"}],children:(0,i.tZ)(C,{path:t,initialDoc:n,extensions:void 0===o?[]:o,maxHeight:"max-content",allowScroll:!0,hideGutter:!0,onNavigateToCode:l})})]})}},95032:function(e,t,n){n.d(t,{Z:function(){return p}});var r=n(12285),i=n(4955),o=n(9670),a=n(75533),l=n(4687),c=n(73157),s=n(29287),u=new(function(e){"use strict";(0,i._)(n,e);var t=(0,o._)(n);function n(){var e;return(0,r._)(this,n),(e=t.call(this)).elementClass="cm-gutterElement-hidden",e}return n.prototype.toDOM=function(){var e=document.createElement("span");e.classList.add("cm-hidden-lines-gutter");var t=document.createElement("span");return t.classList.add("cm-dot"),e.appendChild(t),e},n}(l.SJ)),d=function(e){"use strict";(0,i._)(n,e);var t=(0,o._)(n);function n(e){var i;return(0,r._)(this,n),(i=t.call(this)).numLines=e,i}var a=n.prototype;return a.eq=function(e){return e.numLines===this.numLines},a.toDOM=function(){var e=document.createElement("span");return e.textContent="".concat(this.numLines," hidden ").concat((0,c.Z)("line",this.numLines)),e.className="cm-hidden-lines",e},n}(l.l9),f=l.p.mark({class:"cm-searchResultMatch"}),h=l.tk.baseTheme({".cm-hidden-lines":{color:"var(--foreground-dimmer)",backgroundColor:"var(--background-highest)",display:"inline-block",width:"100%"},".cm-gutterElement-hidden":{backgroundColor:"var(--background-highest)"},".cm-hidden-lines-gutter":{backgroundColor:"var(--background-highest)",display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},".cm-dot":{height:"5px",width:"5px",backgroundColor:"var(--foreground-dimmest)",borderRadius:"50%",display:"inline-block"},".cm-tooltip .cm-scroller":{border:"2px solid var(--background-highest)",borderRadius:"var(--border-radius-4)"},".cm-tooltip .cm-scroller:hover":{border:"2px solid var(--accent-primary-dimmest)",boxShadow:"var(--shadow-1)",cursor:"pointer"},".cm-searchResultMatch":{color:s.TV.foregroundDefault,backgroundColor:s.TV.accentPrimaryDimmest,outline:s.TV.accentPrimaryDimmer+" solid 1px"},".cm-searchResultMatch span":{color:s.TV.foregroundDefault},".cm-tooltip .cm-searchResultMatch:hover":{opacity:.8},".cm-tooltip .cm-gutterElement":{display:"flex",marginTop:0,textAlign:"center",alignItems:"center",justifyContent:"center",lineHeight:"21px"},".cm-tooltip .cm-line":{padding:0},".cm-tooltip .cm-gutters":{padding:0},".cm-tooltip .cm-content":{paddingTop:0},".cm-tooltip .cm-lineWrapping":{whiteSpace:"pre"},".cm-tooltip .cm-cursor":{display:"none"},".cm-tooltip .cm-selectionBackground":{display:"none"}});function p(e,t){var n=e.sort(function(e,t){return e.from-t.from}),r=n.map(function(e){var t=e.from,n=e.to;return f.range(t,n)});return[l.lg.define(function(){return{}},{decorations:function(){return l.p.set(r)}}),function(e,t){var n=[],r=1;e.forEach(function(i,o){var a=t.lineAt(i.from),l=t.lineAt(i.to);r<a.number-2&&n.push({startLine:r,endLine:a.number-2}),r=l.number+2,o===e.length-1&&r<t.lines&&n.push({startLine:r,endLine:t.lines})});var i=n.map(function(e){var n=t.line(e.startLine),r=t.line(e.endLine);return l.p.replace({widget:new d(e.endLine-e.startLine+1)}).range(n.from,r.to)}),o=n.map(function(e){var n=t.line(e.startLine);return l.p.line({class:"cm-line-hidden"}).range(n.from)}),c=a.QQ.define({create:function(){return l.p.set(i)},update:function(e){return e},provide:function(e){return l.tk.decorations.from(e)}}),s=a.QQ.define({create:function(){return l.p.set(o)},update:function(e){return e},provide:function(e){return l.tk.decorations.from(e)}}),f=n.map(function(e){var n=t.line(e.startLine);return u.range(n.from)});return[c,s,h,l.p2.of(a.Xs.of(f))]}(n,t)]}},11570:function(e,t,n){n.d(t,{d:function(){return d},z:function(){return u}});var r=n(12285),i=n(66626),o=n(50959),a=n(11516),l=n(86763),c=n.n(l),s=n(22470),u=function(){"use strict";function e(t){var n=this;if((0,r._)(this,e),this.saveToLocalStorage=c()(function(){a.Z.set("stateCache",{version:2,entries:Array.from(n.map.entries())})},500,{leading:!1,trailing:!0,maxWait:1e3}),this.map=new s.L(20),t){if("object"!=typeof t||null===t||!Object.prototype.hasOwnProperty.call(t,"version")||!Object.prototype.hasOwnProperty.call(t,"entries")||"number"!=typeof t.version||2!==t.version)return;var o=t.entries,l=!0,u=!1,d=void 0;try{for(var f,h=o[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var p=(0,i._)(f.value,2),m=p[0],v=p[1];this.map.set(m,v)}}catch(e){u=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(u)throw d}}}}var t=e.prototype;return t.set=function(e,t){this.map.set(e,t),this.saveToLocalStorage()},t.get=function(e){return this.map.get(e)},e}(),d=(0,o.createContext)(null)},91433:function(e,t,n){n.d(t,{AL:function(){return Z},GD:function(){return m},VO:function(){return p},Y:function(){return b},tT:function(){return g}});var r=n(41733),i=n(21262),o=n(71440),a=n(55846),l=n(58995),c=n(99165);function s(){var e=(0,i._)(["\n  query CodemirrorThread($id: String!) {\n    thread: annotationAnchor(id: $id) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n    currentUser {\n      id\n      username\n      fullName\n      image\n    }\n  }\n  ","\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  mutation CreateThread(\n    $thread: AnnotationAnchorInput!\n    $message: AnnotationMessageInput\n    $highlight: AnnotationHighlightInput\n  ) {\n    createThread: createAnnotationAnchor(\n      annotationAnchor: $thread\n      annotationMessage: $message\n      highlight: $highlight\n    ) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation UpdateThread($id: String!, $changes: AnnotationAnchorChangesInput!) {\n    updateThread: updateAnnotationAnchor(id: $id, changes: $changes) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation CreateThreadMessage(\n    $replId: String!\n    $threadId: String!\n    $threadMessage: AnnotationMessageInput!\n    $highlight: AnnotationHighlightInput\n  ) {\n    createThreadMessage: createAnnotationMessage(\n      replId: $replId\n      anchorId: $threadId\n      annotationMessage: $threadMessage\n      highlight: $highlight\n    ) {\n      ... on UserError {\n        message\n      }\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}var h={},p=(0,o.Ps)(s(),a.j7);function m(e){var t=(0,r._)({},h,e);return l.a(p,t)}var v=(0,o.Ps)(u(),a.j7);function g(e){var t=(0,r._)({},h,e);return c.D(v,t)}var y=(0,o.Ps)(d(),a.j7);function b(e){var t=(0,r._)({},h,e);return c.D(y,t)}var w=(0,o.Ps)(f(),a.j7);function Z(e){var t=(0,r._)({},h,e);return c.D(w,t)}},66610:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(41733),i=n(30509),o=n(66626),a=n(63257),l=n(55846),c=n(30456),s=n(91433),u=n(17491),d=n(55534),f=n(50782),h=n(50199),p=n(54916),m=n(66959),v=n(30826),g=n.n(v),y=n(50959),b=n(50220);function w(e,t){if(!e)return null;var n,r=e.state.field(b.OQ),i=e.state.field(b.ZS);return(null!==(n=r[t])&&void 0!==n?n:(null==i?void 0:i.id)===t?i:null)||null}function Z(e,t){if(!e)return null;var n=w(e,t);if(!n)return null;var r=Math.min(n.indexStart,n.indexEnd),i=Math.max(n.indexStart,n.indexEnd),o=e.state.doc.lineAt(r),a=e.state.doc.lineAt(i),l=e.state.doc.sliceString(e.state.doc.line(Math.max(o.number-2,1)).from,r),c=e.state.doc.sliceString(i,e.state.doc.line(Math.min(a.number+2,e.state.doc.lines)).to);return{precode:l,code:e.state.doc.sliceString(r,i),postcode:c}}function x(e,t,n){var v=(0,d.Z)().showError,x=(0,f.Z)(),C=(0,c.Z)().map(function(e){return e.username}),S=(0,p.Z)().fs,k=(0,s.GD)({variables:{id:e}}),_=k.data,E=k.error,T=k.loading,R=k.client,I=function(){if(T||!_){var n;return!!t&&(null===(n=t.state.field(b.ZS))||void 0===n?void 0:n.id)===e}return"AnnotationAnchor"!==_.thread.__typename}(),D=(0,y.useMemo)(function(){return T||!_?null:"UserError"===_.thread.__typename?{id:e,__typename:"AnnotationAnchor",messages:[],isGeneral:!1,isResolved:!1}:"AnnotationAnchor"===_.thread.__typename?_.thread:null},[_,e,T]),G=(0,o._)((0,s.tT)({onError:function(e){return v(e.message)},update:function(e,t){var n,r;if(t.errors){t.errors.forEach(function(e){return v(e.message)});return}if((null===(r=t.data)||void 0===r?void 0:null===(n=r.createThread)||void 0===n?void 0:n.__typename)==="UserError"){v(t.data.createThread.message);return}}}),1)[0],B=(0,o._)((0,s.AL)({onError:function(e){return v(e.message)},update:function(e,t){if(t.errors){t.errors.forEach(function(e){return v(e.message)});return}var n,r=null===(n=t.data)||void 0===n?void 0:n.createThreadMessage;r&&"UserError"===r.__typename&&v(r.message)}}),1)[0],P=(0,o._)((0,s.Y)({onError:function(e){return v(e.message)},update:function(e,t){if(t.errors){t.errors.forEach(function(e){return v(e.message)});return}var n,r=null===(n=t.data)||void 0===n?void 0:n.updateThread;r&&"UserError"===r.__typename&&v(r.message)}}),1)[0],A=(0,o._)((0,l.Hj)(),1)[0],N=(0,h.Z)(function(){return g()(A,1e3,{trailing:!1})},[A]),L=function(){var e=null==_?void 0:_.currentUser;return e?{user:{__typename:"User",id:e.id,username:e.username,fullName:e.fullName,image:e.image}}:{}};return{thread:D,isPlaceholder:I,error:E,loading:T,getHighlight:Z,getLatestAnchor:function(){return w(t,e)},updateThread:function(e){var t,n=e.changes,o=(null==_?void 0:null===(t=_.thread)||void 0===t?void 0:t.__typename)==="AnnotationAnchor"?_.thread:null;if(!o)throw Error("expected thread");P({variables:{id:o.id,changes:n},optimisticResponse:{__typename:"RootMutationType",updateThread:(0,i._)((0,r._)({},o,n),{isResolved:"boolean"==typeof n.isResolved?n.isResolved:o.isResolved})}})},finalizeThreadMessage:function(o){var l=o.message,c=o.messageId,d=(0,m.kW)(l,{users:(0,a._)(C).concat(["everyone"])}),f={id:c,text:l,mentions:d.mentions};if(I&&t&&n){var h=t.state.field(b.ZS),p={id:e,replId:x,indexStart:null==h?void 0:h.indexStart,indexEnd:null==h?void 0:h.indexEnd,otVersion:S.getOTVersion(n),path:n};G({variables:{thread:p,message:f,highlight:Z(t,e)},optimisticResponse:{__typename:"RootMutationType",createThread:(0,i._)((0,r._)({__typename:"AnnotationAnchor"},p,L()),{messages:[(0,i._)((0,r._)({id:c,timeCreated:new Date().toISOString(),currentUserIsAuthor:!0},L()),{content:{text:l,__typename:"TextMessageContentType"},anchor:{id:p.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],isResolved:!1,isGeneral:!1})}}),R.writeQuery({query:s.VO,variables:{id:e},data:{__typename:"RootQueryType",thread:(0,i._)((0,r._)((0,i._)((0,r._)({},p),{isResolved:!1,isGeneral:!1}),L()),{messages:[(0,i._)((0,r._)({id:c,timeCreated:new Date().toISOString(),currentUserIsAuthor:!0},L()),{content:{text:l,__typename:"TextMessageContentType"},anchor:{id:p.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",seen:!0})],__typename:"AnnotationAnchor"}),currentUser:null==_?void 0:_.currentUser}});var v=R.readQuery({query:u.Jq,variables:{replId:x,path:n}});if(v){var g,y,w=(null===(y=v.threadsByFile)||void 0===y?void 0:y.__typename)==="ThreadsByFileResult"?v.threadsByFile.threads:[],k=L().user;R.writeQuery({query:u.Jq,variables:{replId:x,path:n},data:{__typename:"RootQueryType",threadsByFile:{__typename:"ThreadsByFileResult",threads:(0,a._)(w).concat([(0,r._)({messageCount:1,unreadCount:0,__typename:"AnnotationAnchor",isGeneral:!1,user:k,isResolved:!1,participants:[k]},p)])}}})}return}var E=(null==_?void 0:null===(g=_.thread)||void 0===g?void 0:g.__typename)==="AnnotationAnchor"?_.thread:null;if(!E)throw Error("expected thread");B({variables:{replId:x,threadId:E.id,threadMessage:f,highlight:Z(t,E.id)},optimisticResponse:{__typename:"RootMutationType",createThreadMessage:(0,i._)((0,r._)({},E),{messages:(0,a._)(E.messages.filter(function(e){return!e.id.startsWith("chat-")})).concat([(0,i._)((0,r._)({},L(),f),{content:{text:f.text,__typename:"TextMessageContentType"},anchor:{id:E.id,__typename:"AnnotationAnchor"},__typename:"AnnotationMessage",timeCreated:new Date().toISOString(),currentUserIsAuthor:!0,seen:!0})])})}})},changeThreadMessage:function(t){N({variables:{threadId:e,messageId:t.messageId,message:null}})}}}},17491:function(e,t,n){n.d(t,{Jq:function(){return s},eR:function(){return u}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995);function l(){var e=(0,i._)(["\n  query ThreadsByFileHook($replId: String!, $path: String!) {\n    threadsByFile(replId: $replId, path: $path) {\n      ... on ThreadsByFileResult {\n        threads {\n          id\n          path\n          otVersion\n          indexStart\n          indexEnd\n          messageCount\n          unreadCount\n          user {\n            id\n            image\n            username\n          }\n          participants {\n            id\n            image\n            username\n          }\n          isGeneral\n          isResolved\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l());function u(e){var t=(0,r._)({},c,e);return a.a(s,t)}},62609:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(75533),i=n(40497);function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=r.Py.define(),o=r.QQ.define({create:function(){return t},update:function(t,r){return(0,i.j)(r,n,function(n){t=e(n.value,t)}),t}});return{effect:n,state:o}}},97703:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(74985),i=n(4498),o=n(50959);function a(e){var t=e.json,n=(0,o.useMemo)(function(){return JSON.stringify(t,null,2)},[t]);return(0,r.tZ)(i.Z,{language:"json",code:n})}},38003:function(e,t,n){n.d(t,{X:function(){return th}});var r,i=n(42516),o=n(41733),a=n(74985),l=n(74652),c=n(7444),s=n(26508),u=n(50199),d=n(93496),f=n(8279),h=n(37951),p=n(56596),m=n(93918),v=n(88936),g=n(29287),y=n(50959),b=n(27387),w=n(66626),Z=n(96583),x=n(10981),C=n(64461),S=n(19713),k=n(69852),_=n(63257);function E(e,t){for(var n=e.indexPath,r=t.indexPath,i=Math.min(n.length,r.length),o=0;o<i;o++){if(n[o]>r[o])return 1;if(n[o]<r[o])return -1}return n.length-r.length}function T(e){return e.map(function(e){return"group"===e.data.type?e.data.key:e.data.key||e.data.label}).join(":")}function R(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=e.slice(t)[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;"group"!==c.data.type&&n.push(c.data.label)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return(0,_._)(new Set(n))}var I=n(66368),D=n(80703),G=n(65381),B=(0,y.createContext)(void 0);function P(){var e=(0,y.useContext)(B);if(!e)throw Error("Expected store in context");return e}function A(e){var t=P();return(0,D.Dv)(e,{store:t})}function N(e){return(0,G.lV)((0,y.useCallback)(function(t){return t(e)},[e]),{store:P()})}var L=function(e){var t=P();return(0,D.b9)(e,{store:t})};function U(e){return(0,I.b)(e,P())}var O=function(e){return"item-"+e},M=(0,S.cn)(0),X=(0,S.cn)(0),F=(0,S.cn)(0),W=(0,S.cn)(function(e){return e(M)+e(X)+e(F)}),H=(0,S.cn)({path:[],rows:[],items:[],placeholder:"",isLoading:!1}),V=(0,S.cn)(!0),z=(0,S.cn)(!1),j=(0,S.cn)(null),q=(0,S.cn)({}),Y=(0,k.kv)(q,function(e){return!!e.openOnInput}),J=(0,k.kv)(q,function(e){return!!e.autoFocus}),K=(0,k.kv)(q,function(e){return e.keyboardShortcut}),$=(0,k.kv)(q,function(e){return e.command}),Q=(0,k.kv)(q,function(e){return e.overscan}),ee=(0,k.kv)(q,function(e){return e.footer}),et=(0,k.kv)(q,function(e){return e.focusRef}),en=(0,k.kv)(q,function(e){var t;return null!==(t=e.fontSize)&&void 0!==t?t:14}),er=(0,k.kv)(q,function(e){return!!e.compact}),ei=(0,k.kv)(q,function(e){var t;return null!==(t=e.minItemHeight)&&void 0!==t?t:32}),eo=(0,S.cn)(function(e){return!e(Y)}),ea=(0,k.kv)(q,function(e){return!!e.iconBreadcrumbs}),el=(0,S.cn)(null),ec=(0,S.cn)(function(e){return e(ep)>-1}),es=(0,S.cn)(function(e){var t=e(H);return!t.isLoading&&0===t.rows.length}),eu=(0,S.cn)({label:"",input:"",menu:""}),ed=(0,S.cn)(""),ef=(0,S.cn)(""),eh=(0,S.cn)(""),ep=(0,S.cn)(-1),em=(0,S.cn)(function(e){var t=e(ep);return e(ev).findIndex(function(e){return"item"===e.type&&e.index===t})}),ev=(0,S.cn)(function(e){return e(H).rows}),eg=(0,S.cn)(function(e){return e(H).items}),ey=(0,S.cn)(function(e){return e(eg).length}),eb=(0,S.cn)(function(e){return e(eT).filter(function(e){return"context"===e.data.type&&!!e.match})}),ew=(0,S.cn)(function(e){return e(eb).length>0}),eZ=(0,S.cn)(!1),ex=(0,S.cn)(null,function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t(eZ,!0),t(H,function(e){return(0,C.Uy)(e,function(e){e.path=[e.path[0]]})}),e(eM).setPath(e(eT)),t(ep,-1),t(ed,""),t(ef,""),t(eh,""),e(Y)&&t(V,!1),r.focus&&(null===(n=e(eN))||void 0===n||n.focus())}),eC=(0,S.cn)(function(e){return e(H).placeholder}),eS=(0,S.cn)(function(e){return e(H).isLoading}),ek=(0,S.cn)(function(e){return e(H).path.length}),e_=(0,S.cn)(function(e){return e(ew)||!!e(ed)}),eE=(0,S.cn)(null,(r=(0,b._)(function(e,t,n,r){var i,o,a,l,c,s;function u(n){var r;t(eB,null!=n?n:"Something went wrong"),null===(r=e(eN))||void 0===r||r.focus()}return(0,Z.Jh)(this,function(d){switch(d.label){case 0:if("group"===n.data.type)return[2];if(t(el,n),o=e(q),"context"===n.data.type)return t(eA,l=n.path),t(ep,-1),e(eM).setPath(l),null===(a=e(eN))||void 0===a||a.focus(),[2];switch(n.data.type){case"output":case"error":return t(ex),null===(c=o.onSelect)||void 0===c||c.call(o,n),[2]}t(z,!0),s=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Promise.resolve(n.data.run(r.nativeEvent))];case 2:return s=d.sent(),[3,4];case 3:return d.sent(),t(z,!1),u(),[2];case 4:if(t(z,!1),(null==s?void 0:s.type)==="error")return u(s.message),[2];return t(ex),null===(i=o.onAction)||void 0===i||i.call(o),[2]}})}),function(e,t,n,i){return r.apply(this,arguments)})),eT=(0,S.cn)(function(e){return e(H).path}),eR=(0,S.cn)(function(e){return 1===e(eT).length}),eI=(0,S.cn)(null,function(e,t,n){var r=e(eT),i=r.indexOf(n);-1!==i&&(r=r.slice(0,i+1),t(ep,0),e(eM).setPath(r),t(ed,""))});function eD(e,t){return t.match.score-e.match.score}var eG=(0,S.cn)(null,function(e,t,n){var r,i=e(eh);if(i===e(eh)){var o=n.items.sort(eD),a=n.path.length?n.path[n.path.length-1]:null,l=function(e,t){var n=new Map;e.forEach(function(e){var t=e.path.slice(0,-1),r="section:"+T(t),i=n.get(r);if(i)i.items.push(e);else{var o=t[t.length-1],a=(null==o?void 0:o.data.type)==="group";n.set(r,{type:"section",path:t,score:e.match.score,items:[e],unlabeled:a,key:r})}});var r=(0,_._)(n.entries()).sort(function(e,n){var r=(0,w._)(e,2),i=r[0],o=r[1],a=(0,w._)(n,2),l=a[0],c=a[1];if(!t||!t.includes(i)&&!t.includes(l))return c.score-o.score;var s=t.indexOf(i),u=t.indexOf(l);return s>-1&&u>-1?s-u:-1===s?1:-1}),i={items:[],rows:[]},o=0;return r.forEach(function(e){var t=(0,w._)(e,2),n=t[0],r=t[1];i.rows.push({type:r.type,key:n,path:r.path,unlabeled:r.unlabeled}),r.items.forEach(function(e){i.items.push(e),i.rows.push({type:"item",item:e,index:o++})})}),i}(o,i?e(H).rows.filter(function(e){return"section"===e.type}).map(function(e){return e.key}):void 0),c=l.items,s=l.rows,u=null!==(r=null==a?void 0:a.data)&&void 0!==r?r:null,d=null==u?void 0:u.description;e(ea)&&(null==u?void 0:u.type)!=="group"&&(d=null==u?void 0:u.label),t(H,function(e){return{items:c,rows:s,isLoading:!!n.partial,path:n.path,placeholder:d||e.placeholder}}),s.length&&-1===e(ep)&&t(ep,0)}}),eB=(0,S.cn)(null,function(e,t,n){t(j,n),t(H,function(e){return{items:[],rows:[],isLoading:!1,path:e.path,placeholder:e.placeholder}})}),eP=(0,S.cn)(null,function(e,t,n){t(ed,n),t(ep,n?0:-1),t(j,null),t(H,function(e){return(0,C.Uy)(e,function(e){e.isLoading=!!n})}),e(Y)&&t(V,!!n)}),eA=(0,S.cn)(null,function(e,t,n){t(H,function(e){return(0,C.Uy)(e,function(e){e.items=[],e.rows=[],e.path=n})}),t(eP,""),t(ef,""),t(eh,"")}),eN=(0,S.cn)(null),eL=(0,S.cn)(null,function(e,t,n){var r=e(ep);if(!(r<0)){var i=e(eg)[r];i&&t(eE,i,n)}}),eU=(0,S.cn)(null,function(e,t,n){var r=e(V),i=e(ey),o=e(ep);switch(n.key){case"ArrowDown":n.preventDefault();var a=o+1;t(ep,a<i?a:0),t(V,!0);return;case"ArrowUp":n.preventDefault(),t(ep,Math.max(-1,o-1));return;case"Home":n.preventDefault(),n.shiftKey?n.currentTarget.selectionStart=0:n.currentTarget.setSelectionRange(0,0);return;case"End":n.preventDefault();var l=n.currentTarget.value.length;n.shiftKey?n.currentTarget.selectionEnd=l:n.currentTarget.setSelectionRange(l,l);return;case"Escape":if(!e(ed)||(n.preventDefault(),t(eP,""),t(ef,""),e(eo)))return;t(V,!1);return;case"Enter":if(!r)return;n.preventDefault(),t(eL,n);return;case"PageUp":case"PageDown":if(!r)return;n.preventDefault();var c="PageUp"===n.key?-10:10;t(ep,function(e){return Math.max(Math.min(e+c,i-1),0)});return}}),eO=(0,S.cn)(null,function(e,t,n){var r=Array.isArray(n)?n:[n];e(eZ)&&(r=[r[0]]);var i=e(ef);t(eh,i),e(eM).setPath(r,i)}),eM=(0,S.cn)({}),eX=(0,S.cn)(null,function(e,t){var n=e(eT),r=e(eb);if(r.pop()){var i=r.pop();if(!i){t(ex);return}var o=n.indexOf(i);n=n.slice(0,o+1),t(ep,0),t(eA,n),e(eM).setPath(n)}}),eF=n(38080),eW=n(9331),eH=n(1643),eV=(0,m.X)({root:[g.l0.reset.button,g.l0.viewStyle,g.l0.flex.row,g.l0.align.center,g.l0.borderRadius(0),g.l0.cursor.pointer,g.l0.color.foregroundDimmer,{gap:(0,eH.fP)(4),paddingLeft:(0,eH.fP)(4),paddingRight:(0,eH.fP)(4),"&:hover":{color:g.TV.foregroundDefault}}],icon:[g.l0.position.relative,(0,eH.D$)(16),{width:(0,eH.fP)(16),height:(0,eH.fP)(16)}],iconRight:[(0,eH.D$)(12),{width:(0,eH.fP)(12),height:(0,eH.fP)(12)}],text:[g.l0.truncate,g.l0.flex.shrink(1),{fontSize:"1em"}]}),ez=(0,y.memo)(function(){var e={iconOnly:A(ea),breadcrumbs:A(eb),onClick:L(eI)},t=e.breadcrumbs,n=e.iconOnly,r=e.onClick;return t.length?(0,a.tZ)(a.HY,{children:t.map(function(e,t){if(!e.data||!("label"in e.data))return null;var i=e.data,o=i.label,l=i.icon;return(0,a.BX)("button",{css:eV.root,onClick:function(){return r(e)},children:[(0,a.tZ)(p.G,{css:eV.icon,children:l}),n?null:(0,a.tZ)(p.G,{css:eV.text,children:o}),(0,a.tZ)(p.G,{css:eV.iconRight,children:(0,a.tZ)(eW.Z,{})})]},o+t)})}):null}),ej=n(43312),eq=n(58719),eY=(0,ej.iv)([g.l0.reset.button,g.l0.viewStyle,g.l0.center,g.l0.height("100%"),g.l0.cursor.pointer,g.l0.color.foregroundDimmest,{paddingLeft:(0,eH.fP)(4),paddingRight:(0,eH.fP)(4),"&:hover":{color:g.TV.foregroundDefault}},(0,eH.D$)(16)]);function eJ(e){return(0,a.tZ)("button",{css:eY,onClick:e.onClick,title:e.isLoading?"Loading":"Clear",children:e.isLoading?(0,a.tZ)(v.Z,{}):(0,a.tZ)(eq.Z,{})})}var eK=n(30509),e$=n(47357),eQ=n(69119),e0=function(e){return Math.round(e.value/14*e.fontSize)},e1=[g.l0.position.absolute,g.l0.top(0),g.l0.left(0),g.l0.width("100%")],e2=(0,m.X)({item:[e1,{userSelect:"none",cursor:"pointer","&:hover > div":{backgroundColor:"var(".concat(d.dj.interactiveBackground,")")}}],divider:[e1,g.l0.justify.center,{padding:"0 ".concat((0,eH.fP)(8))}]}),e8=(0,y.memo)(function(e){var t,n,r,i,l,c,s,u,d=(t=e.index,n=L(eE),r=(0,y.useRef)(null),l="item"===(i=A((0,y.useMemo)(function(){return(0,k.kv)(ev,function(e){return e[t]})},[t]))).type?i.index:null,c=A((0,y.useMemo)(function(){return(0,S.cn)(function(e){return null!==l&&e(ep)===l})},[l])),s=(null==i?void 0:i.type)==="item"?function(e){return n(i.item,e)}:void 0,u="item"===i.type?{id:O(t),role:"option","aria-selected":c}:void 0,{row:i,active:c,ref:r,onClick:s,ariaAttrs:u}),f=d.row,h=d.active,m=d.onClick,v=d.ariaAttrs,g=d.ref;if(!f)return null;var b={height:e.height,transform:"translateY(".concat(e.y,"px)")};if("section"===f.type)return(0,a.tZ)(e7,{path:f.path,style:b,border:e.index>0});var w=f.item,Z=w.data,x=w.match;if("group"===Z.type)return null;var C=x.render;if(C&&"content"in C&&C.content)return(0,a.tZ)(p.G,(0,eK._)((0,o._)({innerRef:g,css:e2.item,style:b,onClick:m},v),{children:(0,a.tZ)(eF.Tg,{elevated:h,children:(0,y.cloneElement)(C.content,{active:h})})}));var _=Z.label,E=Z.icon,T=Z.dataCy,R=C&&"ranges"in C?C.ranges:void 0;return(0,a.tZ)(p.G,(0,eK._)((0,o._)({innerRef:g,css:e2.item,style:b,onClick:m,dataCy:T},v),{children:(0,a.tZ)(e5,{active:h,icon:E,text:_,highlight:R,description:Z.description,shortcut:Z.keyboardShortcut,hasChildren:"context"===w.data.type})}))}),e4=[{padding:(0,eH.fP)(8)}],e3=(0,m.X)({root:[e4,g.l0.align.center,g.l0.flex.row,g.l0.height("100%"),{gap:(0,eH.fP)(8),userSelect:"none"}],iconText:[g.l0.align.center,g.l0.flex.row,g.l0.maxWidth("100%"),{gap:(0,eH.fP)(8)}],description:[g.l0.truncate,g.l0.flex.growAndShrink(1),{fontSize:"0.9em"}],right:[g.l0.flex.row,g.l0.align.center,{gap:(0,eH.fP)(4),justifySelf:"end",marginLeft:"auto"}],chevron:(0,eH.D$)(12)});function e5(e){var t=A(en);return(0,a.BX)(eF.Tg,{elevated:e.active,css:e3.root,children:[(0,a.BX)(p.G,{css:e3.iconText,children:[(0,a.tZ)(p.G,{className:"icon",css:e6.root,children:e.icon}),(0,a.tZ)(eQ.x,{dimmed:!e.active,text:e.text,highlight:e.highlight})]}),e.description?(0,a.tZ)(p.G,{css:e3.description,style:{color:e.active?g.TV.foregroundDimmer:g.TV.foregroundDimmest},children:e.description}):null,(0,a.BX)(p.G,{css:e3.right,children:[e.shortcut?(0,a.tZ)(l.bM,{keyCombo:e.shortcut,fontSize:Math.round(.85*t)}):null,e.hasChildren?(0,a.tZ)(p.G,{css:e3.chevron,children:(0,a.tZ)(eW.Z,{size:12,style:{pointerEvents:"none"}})}):null]})]})}var e6=(0,m.X)({root:[g.l0.position.relative,(0,eH.D$)(16),{width:(0,eH.fP)(16),height:(0,eH.fP)(16)}]}),e9=(0,m.X)({borderHeaderWrap:[{userSelect:"none",padding:[8,8,4,8].map(eH.fP).join(" ")},e1,g.l0.colWithGap(0),g.l0.justify.spaceBetween],borderWrap:[{userSelect:"none",paddingLeft:(0,eH.fP)(8),paddingRight:(0,eH.fP)(8)},e1,g.l0.justify.center],headerWrap:[{userSelect:"none",paddingLeft:(0,eH.fP)(8),paddingRight:(0,eH.fP)(8),paddingBottom:(0,eH.fP)(4)},e1,g.l0.justify.end],header:[{userSelect:"none"},g.l0.align.center,g.l0.flex.row,{gap:(0,eH.fP)(4)},(0,eH.D$)(12)],text:[{userSelect:"none"},g.l0.flex.shrink(1),g.l0.color.foregroundDimmest,g.l0.truncate,{fontSize:"0.9em"}],border:[g.l0.height(1),g.l0.width("100%")]}),e7=(0,y.memo)(function(e){var t=A(ek),n=R(e.path,t),r=(0,a.tZ)(eF.Tg,{elevated:!0,css:e9.border}),i=0===n.length;if(e.border&&i)return(0,a.tZ)(p.G,{css:e9.borderWrap,style:e.style,children:r});var o=(0,a.tZ)(p.G,{css:e9.header,children:n.map(function(e,t){return(0,a.BX)(y.Fragment,{children:[t>0?(0,a.tZ)(eW.Z,{color:g.TV.foregroundDimmest}):null,(0,a.tZ)(p.G,{css:e9.text,children:e})]},e+t)})});return e.border||i?(0,a.BX)(p.G,{css:e9.borderHeaderWrap,style:e.style,children:[r,o]}):(0,a.tZ)(p.G,{css:e9.headerWrap,style:e.style,children:o})}),te=(0,m.X)({root:[g.l0.flex.growAndShrink(1),g.l0.overflow("hidden"),{paddingTop:eH.Cn.menuPaddingTop}],scrollParent:[g.l0.height("100%"),g.l0.overflowY("auto"),g.l0.flex.growAndShrink(1)]}),tt=(0,y.memo)(function(e){var t,n,r,i,l=(t=A(ev),n=A(V),{rows:t,isOpen:n,scrollRef:(0,y.useRef)(null),currentPathIndex:A(ek),ariaAttrs:{id:(r=A(eu)).menu,"aria-labelledby":r.label,role:"listbox"}}),c=l.rows,s=l.isOpen,u=l.scrollRef,d=l.currentPathIndex,f=l.ariaAttrs,h=L(X),m=A(en),v=A(er),b=(0,e$.MG)({count:c.length,overscan:null!==(i=e.overscan)&&void 0!==i?i:1,getScrollElement:function(){return u.current},getItemKey:function(e){var t=c[e];return t?"section"===t.type?t.key:T(t.item.path):""},estimateSize:function(t){var n=c[t];return n?function(e){var t,n=e.row,r=e.currentPathIndex,i=e.compact,o=e.isFirst,a=e.fontSize,l=e.minItemHeight;if("section"===n.type){var c=R(n.path,r).length?24:0;if(o){var s=i?c+e0({fontSize:a,value:6}):c;return 0===c?s:e0({fontSize:a,value:c})}return c+e0({fontSize:a,value:16})}var u=n.item.match.render;return u&&"content"in u?Math.max(e0({fontSize:a,value:null!==(t=u.height)&&void 0!==t?t:32}),l):Math.max(e0({fontSize:a,value:32}),l)}({fontSize:m,row:n,currentPathIndex:d,compact:v,isFirst:0===t,minItemHeight:e.minItemHeight}):0},onChange:function(e){h(e.getTotalSize())}}),w={borderRadius:e.hasFooter?void 0:g.TV.space8,display:s?void 0:"none"},Z=b.scrollToIndex,x=b.getVirtualItems,C=A(em);return(0,y.useEffect)(function(){var e=C;!(e<0)&&(1===e&&(e=0),x()[e]&&Z(e,{behavior:"smooth"}))},[Z,x,C]),(0,a.tZ)(p.G,(0,eK._)((0,o._)({css:te.root},f),{style:w,children:(0,a.tZ)(p.G,{innerRef:u,css:te.scrollParent,children:(0,a.tZ)(p.G,{style:{height:"".concat(b.getTotalSize(),"px"),position:"relative",overflow:"hidden"},children:s?b.getVirtualItems().map(function(e){return(0,a.tZ)(e8,{index:e.index,height:e.size,y:e.start},e.key)}):null})})}))}),tn=n(31950),tr=(0,m.X)({root:[g.l0.flex.shrink(1),g.l0.height("100%"),{fontSize:eH.Cn.fontSize}],footer:{paddingTop:(0,eH.fP)(8)},keyComboBlocks:{paddingRight:(0,eH.fP)(8)},menuWrap:[g.l0.flex.shrink(1)],row:[g.l0.position.absolute,g.l0.top(0),g.l0.left(0),g.l0.width("100%")],menu:[g.l0.flex.shrink(1),g.l0.overflow("auto")],running:[g.l0.center,g.l0.flex.growAndShrink(1)],error:{padding:(0,eH.fP)(8)}}),ti=(0,m.X)({root:[g.l0.viewStyle,g.l0.flex.growAndShrink(1),g.l0.height("100%"),{fontSize:"1em",padding:"0 ".concat((0,eH.fP)(8)),backgroundColor:"transparent",border:"0 none",outline:"0 none","::placeholder":{color:g.TV.foregroundDimmest},"&:hover::placeholder":{color:g.TV.foregroundDimmer},"&:focus::placeholder, &:hover:focus::placeholder":{color:g.TV.foregroundDimmest}}]}),to=(0,y.memo)(function(e){var t,n,r,i,l,c,s,u,d,f,h,p,m,v=(t=L(eN),n=A(eC),u=(s=(0,w._)((r=A(ed),i=L(eP),l=L(ef),c=(0,w._)((0,y.useTransition)(),2)[1],[r,(0,y.useCallback)(function(e){var t="string"==typeof e?e:e.currentTarget.value;i(t),c(function(){return l(t)})},[i,c,l])]),2))[0],d=s[1],f=L(ep),h=A(ep),p=A(eu),m=A(V),{onBlur:function(){return f(-1)},onChange:d,placeholder:n,value:u,ref:t,disabled:A(z),ariaAttrs:{id:p.input,role:"combobox",autoComplete:"off","aria-autocomplete":"list","aria-activedescendant":h>-1?O(h):"","aria-controls":p.menu,"aria-expanded":m,"aria-labelledby":p.label}});return(0,a.tZ)("input",(0,o._)({autoFocus:e.autoFocus,onKeyDown:e.onKeyDown,css:ti.root,placeholder:v.placeholder,value:v.value,onChange:v.onChange,ref:v.ref,onBlur:v.onBlur,disabled:v.disabled,autoCorrect:"off",autoComplete:"off",autoCapitalize:"off"},v.ariaAttrs))}),ta=[d.gU.filled,g.l0.viewStyle,g.l0.flex.row,g.l0.align.center,g.l0.flex.growAndShrink(1),{height:(0,eH.fP)(32),borderRadius:(0,eH.fP)(4)}],tl=(0,m.X)({container:[{padding:(0,eH.fP)(8),"& > div > button + input":{paddingLeft:0}},g.l0.pb(0)],surface:ta,surfaceRunning:[ta,f.p.foregroundPulse()]}),tc=[d.gU.nofill,g.l0.flex.row,g.l0.align.center,g.l0.flex.growAndShrink(1),{height:(0,eH.fP)(36),borderRadius:(0,eH.fP)(8),borderBottomLeftRadius:eH.Cn.borderBottomLeftRadius,borderBottomRightRadius:eH.Cn.borderBottomRightRadius}],ts=(0,m.X)({container:[{"& > div > button + input":{paddingLeft:0}},g.l0.pb(0)],surface:tc,surfaceRunning:[tc,f.p.foregroundPulse()],border:[g.l0.height(1),{display:eH.Cn.compactInputBarBorderDisplay}]});function tu(e){var t=A(z),n=U(es),r=L(M),o=(0,s.Z)(function(e){return r(e.height)}),l=A(er),c=l?ts:tl,u=(0,y.useRef)(null);(0,tn.j)(u,n,function(e){var t;return t={},(0,i._)(t,eH.Dq.borderBottomRightRadius,e?(0,eH.fP)(8):"0"),(0,i._)(t,eH.Dq.borderBottomLeftRadius,e?(0,eH.fP)(8):"0"),t});var d=(0,y.useRef)(null);return(0,tn.j)(d,n,function(e){return(0,i._)({},eH.Dq.compactInputBarBorderDisplay,e?"none":"inherit")}),(0,a.BX)(a.HY,{children:[(0,a.tZ)(p.G,{css:c.container,innerRef:o,children:(0,a.tZ)(p.G,{innerRef:u,css:t?c.surfaceRunning:c.surface,children:e.children})}),l?(0,a.tZ)(eF.Tg,{innerRef:d,elevated:!0,css:ts.border}):null]})}var td=(0,y.memo)(function(e){var t=A(e_),n=A(eS);return t?(0,a.tZ)(eJ,{onClick:e.onClick,isLoading:n}):null}),tf=(0,y.memo)(function(){var e,t,n,r,o,d,f,m,b,w,Z,x,C,S,k,_,E,T,R,I,D,G,B,P=(r=A(V),o=A(e_),d=A(ed),f=A(es),m=A(z),b=A(j),w=L(eU),Z=A(ec),x=L(ex),C=N(eN),S=A(eM),k=A($),_=U(eR),E=U(ef),T=L(eh),R=L(eO),I=(0,c.Z)(k),(0,y.useEffect)(function(){_.current&&R(k)},[S,_,k,E,R]),(0,y.useEffect)(function(){return _.subscribe(function(e){e&&R(I.current)})},[S,E,_,R,I]),(0,y.useEffect)(function(){var e=function(e){T(e),S.search(e)};return e(E.current),E.subscribe(e)},[S,E,_,T,I]),D=(0,u.Z)(function(){return function(){var e;return null===(e=C())||void 0===e?void 0:e.focus()}},[C]),G=L(eX),{focus:D,onKeyDown:(0,u.Z)(function(){return function(e){if("Backspace"===e.key&&!e.currentTarget.value){G();return}return w(e)}},[w,G]),inputValue:d,isOpen:r,isClearable:o,noResults:f,hasHighlightedItem:Z,isRunning:m,actionError:b,clearCommands:x}),O=P.isOpen,X=P.focus,H=P.clearCommands,Y=P.isClearable,eo=P.onKeyDown,ea=P.inputValue,el=P.noResults,ep=P.hasHighlightedItem,em=P.isRunning,ev=P.actionError,eg=(0,c.Z)({inputValue:ea,noResults:el,hasHighlightedItem:ep});e=N(q),t=A(M),n=U(W),(0,y.useEffect)(function(){var r=function(t){var n=e().onTotalHeightChange;n&&(0===i&&(i=t),n({initial:i,current:t}))};if(0!==t){var i=0;return r(n.current),n.subscribe(r)}},[t,e,n]);var ey=A(J),eb=A(K),ew=A(Q),eZ=A(ee),eC=A(et),eS=A(ei),ek=N(q),eE=(0,u.Z)(function(){return function(e){var t,n=eg.current,r=ek();if(null===(t=r.onKeyDown)||void 0===t||t.call(r,e,{inputValue:n.inputValue,noResults:n.noResults,hasHighlightedItem:n.hasHighlightedItem}),!e.defaultPrevented){if("Enter"===e.key&&n.inputValue&&n.noResults&&r.onSubmit){r.onSubmit(n.inputValue);return}eo(e)}}},[eg,eo,ek]);(0,y.useEffect)(function(){eC&&(eC.current=X)},[X,eC]);var eT=A(eu),eI=L(F),eD=(0,s.Z)(function(e){return eI(e.height)}),eG=A(en),eB=A(er);return(0,a.BX)(p.G,{css:tr.root,style:(B={},(0,i._)(B,eH.Dq.fontSize,eG+"px"),(0,i._)(B,eH.Dq.menuPaddingTop,eB?"0px":(0,eH.fP)(8)),B),children:[(0,a.tZ)("label",{id:eT.label,htmlFor:eT.input,css:g.l0.visuallyHidden,children:"Commands"}),(0,a.BX)(tu,{children:[(0,a.tZ)(ez,{}),(0,a.tZ)(to,{autoFocus:ey,onKeyDown:eE}),(0,a.tZ)(td,{onClick:function(){return H({focus:!0})}}),eb&&!Y?(0,a.tZ)(p.G,{css:tr.keyComboBlocks,children:(0,a.tZ)(l.bM,{keyCombo:eb,fontSize:.85*eG})}):null]}),ev?(0,a.tZ)(p.G,{css:tr.error,children:(0,a.tZ)(h.E,{colorway:"warning",text:ev})}):null,O&&!em?(0,a.BX)(a.HY,{children:[(0,a.tZ)(tt,{minItemHeight:eS,overscan:ew,hasFooter:!!eZ}),eZ?(0,a.tZ)(p.G,{innerRef:eD,css:tr.footer,children:eZ}):null]}):null,em?(0,a.tZ)(p.G,{css:tr.running,children:(0,a.tZ)(v.Z,{size:24})}):null]})});function th(e){var t,n,r,i=(n={label:(t=(0,x.U)())("label"),input:t("input"),menu:t("menu")},r=(0,w._)((0,y.useState)(function(){var t,r,i=(0,S.MT)();i.set(eu,n),i.set(q,e),i.set(V,!e.openOnInput),i.set(eM,function(e){var t=e.initialPath,n=e.partialUpdateTimeout,r=e.onUpdate,i=t,o=null,a=0;function l(e){o&&clearTimeout(o);var t=++a,l=0,c=[],s=i[i.length-1];if(!s.commands){r({items:c,path:i});return}void 0!==n&&(o=setTimeout(function(){c.length&&r({items:(0,_._)(c).sort(E),partial:!0,path:i})},n)),function n(s,u,d){if(l++,!s.commands)throw Error("Expected commands");var f=(0,_._)(u).concat([s]),h=f.length===i.length;Promise.resolve(s.commands({active:h,search:e,path:f})).then(function(s){if(t!==a){o&&clearTimeout(o);return}l--,s.forEach(function(t,r){var i=(0,_._)(f).concat([t]),o=(0,_._)(d).concat([r]),a=t.match?t.match({search:e,data:t.data,path:i,active:h}):null;a&&c.push({path:i,data:t.data,match:a,indexPath:o}),t.commands&&n(t,f,o)}),l>0||(o&&clearTimeout(o),r({items:(0,_._)(c).sort(E),path:i}))})}(s,i.slice(0,i.length-1),[])}return{search:l,setPath:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";i=e,l(t)},getPath:function(){return i}}}({initialPath:Array.isArray(e.command)?e.command:[e.command],partialUpdateTimeout:30,onUpdate:function(e){return i.set(eG,e)}}));var o=Array.isArray(e.command)?e.command[0]:e.command,a=null!==(r=null==o?void 0:null===(t=o.data)||void 0===t?void 0:t.description)&&void 0!==r?r:null;return a&&i.set(H,function(e){return(0,C.Uy)(e,function(e){e.placeholder=a})}),i}),1)[0],(0,y.useEffect)(function(){r.set(q,e)},[r,e]),r);return(0,a.tZ)(B.Provider,{value:i,children:(0,a.tZ)(tf,{})})}},1643:function(e,t,n){n.d(t,{Cn:function(){return o},D$:function(){return c},Dq:function(){return i},fP:function(){return l}});var r=(0,n(91608).$)(["fontSize","menuPaddingTop","borderBottomLeftRadius","borderBottomRightRadius","compactInputBarBorderDisplay"]),i=r.cssVars,o=r.styleTokens,a=function(e){return Math.round(100*e)/100},l=function(e){return a(e/14)+"em"},c=function(e){var t=a(e/14)+"em";return{"&& svg":{minWidth:t,minHeight:t,width:t,height:t}}}},48528:function(e,t,n){n.d(t,{j:function(){return m},m:function(){return p}});var r=n(41733),i=n(30509),o=n(98924),a=n(66626),l=n(74985),c=n(10041),s=n(1498),u=n(15146),d=n(30983),f=n(50959),h=n(59520);function p(e){var t=e.textToCopy,n=e.tooltip,u=e.timeout,p=void 0===u?4e3:u,m=(0,o._)(e,["textToCopy","tooltip","timeout"]),v=(0,a._)((0,f.useState)(!1),2),g=v[0],y=v[1],b=(0,f.useRef)(null);return(0,f.useEffect)(function(){return function(){b.current&&clearTimeout(b.current)}},[]),(0,l.tZ)(d.u,{isOpen:g,tooltip:null!=n?n:"".concat(t," copied to clipboard"),placement:"bottom-end",children:function(e,n){return(0,l.tZ)(s.zx,(0,i._)((0,r._)({},(0,h.dG)(m,e)),{ref:n,onClick:function(e){(0,c.Z)(t),y(!0),b.current&&clearTimeout(b.current),b.current=setTimeout(function(){return y(!1)},p),m.onClick&&m.onClick(e)}}))}})}function m(e){var t=e.textToCopy,n=e.tooltip,s=e.timeout,p=void 0===s?4e3:s,m=e.children,v=(0,o._)(e,["textToCopy","tooltip","timeout","children"]),g=(0,a._)((0,f.useState)(!1),2),y=g[0],b=g[1],w=(0,f.useRef)(null);return(0,f.useEffect)(function(){return function(){w.current&&clearTimeout(w.current)}},[]),(0,l.tZ)(d.u,{isOpen:y,tooltip:null!=n?n:"".concat(t," copied to clipboard"),placement:"bottom-end",children:function(e,n){return(0,l.tZ)(u.hU,(0,i._)((0,r._)({},(0,h.dG)(e,v)),{ref:n,onClick:function(e){(0,c.Z)(t),b(!0),w.current&&clearTimeout(w.current),w.current=setTimeout(function(){return b(!1)},p),v.onClick&&v.onClick(e)},children:m}))}})}},42098:function(e,t,n){n.d(t,{E:function(){return m}});var r=n(66626),i=n(74985),o=n(59868),a=n(1498),l=n(49344),c=n(74833),s=n(56596),u=n(32377),d=n(29287),f=n(54916),h=n(50959),p=(0,n(93918).X)({styles0:[d.l0.colWithGap(16)],styles1:[d.l0.justify.end,d.l0.rowWithGap(16)]});function m(){var e=(0,f.Z)().replspaceApi,t=(0,r._)((0,h.useState)(null),2),n=t[0],d=t[1];return(0,h.useEffect)(function(){return e.onConfirmSendToken(function(e){e&&(0,o.j)(o.U3.MODAL_VIEWED,{modalName:"git_token_modal"}),d(function(){return e})})},[e]),(0,i.tZ)(l.u,{isOpen:"function"==typeof n,onRequestClose:function(){null==n||n(!1),(0,o.j)(o.U3.GIT_TOKEN_MODAL_ACCEPTED,{response:"close"}),d(null)},children:(0,i.BX)(s.G,{css:p.styles0,children:[(0,i.tZ)(c.h4,{variant:"headerDefault",level:3,children:"Pass GitHub Credentials"}),(0,i.tZ)(c.xv,{children:"It looks like you're trying to connect to your GitHub repository through the shell. Pass your token to the shell?"}),(0,i.tZ)(c.xv,{children:"If you did not initiate a git command, you should deny this."}),(0,i.BX)(s.G,{css:p.styles1,children:[(0,i.tZ)(a.zx,{onClick:function(){null==n||n(!1),(0,o.j)(o.U3.GIT_TOKEN_MODAL_ACCEPTED,{response:"deny"}),d(null)},text:"Deny"}),(0,i.tZ)(a.zx,{onClick:function(){null==n||n(!0),(0,o.j)(o.U3.GIT_TOKEN_MODAL_ACCEPTED,{response:"confirm"}),d(null)},iconLeft:(0,i.tZ)(u.Z,{}),text:"Confirm for this session",colorway:"primary"})]})]})})}},45726:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(66626),i=n(74985),o=n(1498),a=n(18836),l=n(74833),c=n(56596),s=n(29287),u=n(50959),d=(0,n(93918).X)({styles0:[s.l0.colWithGap(24)],styles1:[s.l0.color.accentNegativeStronger],styles2:[s.l0.rowWithGap(12),s.l0.justify.end]});function f(e){var t=e.prompt,n=e.desc,s=e.type,f=e.placeholder,h=e.confirmText,p=e.loading,m=e.errorMessage,v=e.onCancel,g=e.onConfirm,y=e.isDanger,b=e.buttonIcon,w=(0,r._)((0,u.useState)(),2),Z=w[0],x=w[1];return(0,i.BX)(c.G,{css:d.styles0,children:[(0,i.tZ)(l.h4,{variant:"headerDefault",level:2,children:t}),(0,i.tZ)(l.xv,{children:n}),(0,i.tZ)(a.II,{type:s,value:Z,placeholder:f,autoFocus:!0,onChange:function(e){return x(e.target.value)}}),m?(0,i.tZ)(l.xv,{css:d.styles1,multiline:!1,children:m}):null,(0,i.BX)(c.G,{css:d.styles2,children:[(0,i.tZ)(o.zx,{disabled:p,onClick:v,text:"Cancel"}),(0,i.tZ)(o.zx,{colorway:y?"negative":"primary",disabled:p,onClick:function(){return Z&&g(Z)},text:h||"Ok",iconLeft:b,dataCy:"prompt-confirm-button"})]})]})}},96298:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(74985),i=n(10041),o=n(1498),a=n(70002),l=n(15146),c=n(24463),s=n(74833),u=n(30983),d=n(56596),f=n(12874),h=n(48728),p=n(41733),m=n(30509),v=n(26),g=function(e){return(0,r.tZ)(v.Z,(0,m._)((0,p._)({viewBox:"0 0 800.5 907.77"},e),{children:(0,r.tZ)("path",{d:"M303.36,238.61c31.36-21.37,71.76-12.97,65-6.53c-12.89,12.28,4.26,8.65,6.11,31.31 c1.36,16.69-4.09,25.88-8.78,31.11c-9.79,1.28-21.69,3.67-36.02,8.33c-8.48,2.76-15.85,5.82-22.31,8.9 c-1.7-1.11-3.55-2.47-5.74-4.36C279.5,288.19,280.24,254.37,303.36,238.61 M490.68,370.72c5.69-4.41,31.55-12.72,55.49-15.55 c12.57-1.48,30.49-2.34,34.31-0.2c7.59,4.19,7.59,17.16,2.39,29.14c-7.57,17.4-18.27,36.63-30.39,38.21 c-19.77,2.61-38.46-8.09-59.8-24.03C485.06,392.56,480.38,378.68,490.68,370.72 M526.75,201.27c29.19,13.58,25.37,39.42,26.18,54.6 c0.22,4.36,0.15,7.3-0.22,9.32c-4.04-2.19-10.43-3.8-20.56-3.35c-2.96,0.12-5.84,0.47-8.63,0.91c-10.77-5.77-17.21-17.06-23.1-29.06 c-0.54-1.11-0.96-2.1-1.36-3.06c-0.17-0.44-0.35-0.91-0.52-1.31c-0.07-0.22-0.12-0.39-0.2-0.59c-3.23-10.25-1.06-12.3,0.3-15.46 c1.41-3.23,6.68-5.89-1.11-8.58c-0.67-0.25-1.5-0.39-2.44-0.57C500.25,197.72,515.7,196.17,526.75,201.27 M367.62,510.22 c-31.45-20.19-63.99-49.15-78.22-65.18c-2.39-1.8-2-9.79-2-9.79c12.84,9.98,66.11,48.04,122.44,65.42 c19.87,6.14,50.36,8.46,76.81-6.53c20.21-11.46,44.54-31.43,59.06-52.01l2.66,4.61c-0.1,3.06-6.78,17.97-10.18,23.96 c6.14,3.53,10.72,4.49,17.55,6.36l46.64-7.27c16.74-27.04,28.74-70.65,15.95-112.16c-7.3-23.81-45.36-71.22-48.09-73.83 c-9.56-9.19,1.6-44.69-17.35-83.42C532.86,159.41,480.67,116.69,458,98.1c6.68,4.88,47.82,21.47,67,44.62 c1.8-2.39,2.54-14.82,4.19-17.97c-16.47-21.57-17.75-59.95-17.75-70.21c0-18.81-9.56-40.13-9.56-40.13s16.47,13.04,20.73,35.5 c5.03,26.6,15.75,47.55,29.93,65.28c26.84,33.43,51.08,50.58,63.33,38.23C630.53,138.58,601,72.2,563.28,35.15 C519.25-8.09,507.74-2.52,481.91,6.7c-20.61,7.35-31.75,65.87-85.47,64.71c-9.1-1.06-32.54-1.63-44.13-1.53 c6.04-8.43,11.22-14.94,11.22-14.94s-18.02,7.25-33.38,16.44l-1.18-1.77c5.18-10.92,10.75-17.82,10.75-17.82s-14.4,8.65-27.54,19.01 c2.39-13.02,11.44-21.27,11.44-21.27s-18.19,3.28-41.36,28.77c-26.33,7.2-32.66,11.93-53.64,21.22 c-34.12-7.44-50.21-19.45-65.55-41.56c-11.68-16.89-32.47-19.45-53.71-10.72c-30.97,12.8-70.14,30.33-70.14,30.33 s12.77-0.52,26.08,0.05c-18.22,6.9-35.72,16.39-35.72,16.39s8.53-0.3,19.06-0.12c-7.27,6.04-11.29,8.92-18.22,13.51 c-16.66,12.1-30.17,26.08-30.17,26.08s11.31-5.15,21.47-8.04c-7.1,16.27-21.18,28.25-18.59,48.17 c2.49,18.19,24.82,55.66,53.64,78.66c2.49,2,41.86,38.43,71.56,23.47c29.68-14.94,41.39-28.25,46.27-48.66 c5.74-23.44,2.47-41.17-9.79-92.05c-4.04-16.79-14.57-51.37-19.65-67.91l1.13-0.81c9.71,20.49,34.56,74.5,44.57,110.78 c15.63,56.57,10.75,85.27,3.6,95.79c-21.57,31.73-76.84,35.92-101.98,18.34c-3.85,60.91,9.76,87.73,14.37,101.24 c-2.29,15.53,7.77,44.37,7.77,44.37s1.13-13.11,5.74-20.02c1.23,15.41,9,33.72,9,33.72s-0.47-11.31,3.06-21.08 c4.98,8.43,8.63,10.43,13.34,16.76c4.71,16.47,14.15,28.5,14.15,28.5s-1.53-8.83-0.69-18.02c23.05,22.14,27.02,54.45,29.31,79.28 c6.46,68.26-107.63,122.54-129.74,165.24c-16.76,25.29-26.8,65.3,1.58,88.89c68.6,56.97,42.25,72.65,76.59,97.69 c47.11,34.34,106.05,18.96,126.11-8.97c27.93-38.92,20.76-75.63,10.38-109.97c-8.11-26.85-30.15-71.46-57.41-88.72 c-27.86-17.65-54.95-20.95-77.9-18.59l2.12-2.44c33.01-6.56,67.52-2.96,92.49,13.14c28.35,18.22,54.28,49.47,67.84,97.37 c15.38-2.19,17.55-3.18,31.63-5.18l-31.7-246.76L367.62,510.22z M385.94,819.52l-3.65-34.22l71.29-108.74l80.93,23.64l69.59-116.23 L687.52,639l63.38-132.92l22.53,242.07L385.94,819.52z M774.27,456.51l-254.72,46.17c-6.31,8.13-21.91,22.41-29.41,26.13 c-32.17,16.2-53.91,11.51-72.7,6.63c-12.08-3.06-19.08-4.78-29.11-9.29l-62.17,8.53l37.74,314.87l436.35-78.66L774.27,456.51z"})}))},y=n(75875),b=n(29287),w=n(70671),Z=(0,n(93918).X)({styles0:[b.l0.rowWithGap(2),{alignItems:"center"}],styles1:[b.l0.align.center]});function x(e){var t=e.replId,n=e.showFlag,p=e.buttonsOnly,m=(0,w.F)().isDarkColorScheme;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(a.Z,{href:"https://app.datadoghq.com/logs?"+new URLSearchParams({query:"@replid:".concat(t)}).toString(),iconLeft:(0,r.tZ)(g,{color:m?"#FFFFFF":"#632CA6"}),iconRight:(0,r.tZ)(f.Z,{}),target:"_blank",text:"View Datadog Logs by Repl ID"}),(0,r.tZ)(a.Z,{href:"https://app.datadoghq.com/logs?"+new URLSearchParams({query:"@replid:".concat(t),agg_q:"@containerid",agg_q_source:"base",cols:"host,service",messageDisplay:"inline",stream_sort:"desc",top_n:"30",top_o:"top",viz:"transaction",x_missing:"true",live:"true"}).toString(),iconLeft:(0,r.tZ)(g,{color:m?"#FFFFFF":"#632CA6"}),iconRight:(0,r.tZ)(f.Z,{}),target:"_blank",text:"View Datadog Logs by Container ID"}),void 0!==p&&p?(0,r.tZ)(u.u,{maxWidth:300,tooltip:(0,r.tZ)(s.xv,{multiline:!1,children:t}),children:(0,r.tZ)(o.zx,{iconLeft:(0,r.tZ)(h.Z,{}),text:"Copy Repl ID",onClick:function(){return(0,i.Z)(t)}})}):(0,r.BX)(d.G,{css:Z.styles0,children:[void 0!==n&&n?(0,r.BX)(u.u,{tooltip:"You are seeing this functionality because you have special permissions.",children:[(0,r.tZ)(y.Z,{})," "]}):null,(0,r.BX)(s.xv,{css:Z.styles1,multiline:!1,children:["Repl ID: ",(0,r.tZ)(c.Z,{children:t})]}),(0,r.tZ)(l.hU,{alt:"Copy to clipboard",onClick:function(){return(0,i.Z)(t)},children:(0,r.tZ)(h.Z,{})})]})]})}},84096:function(e,t,n){n.d(t,{e:function(){return p}});var r=n(74985),i=n(63388),o=n(7877),a=n(75582),l=n(74833),c=n(30983),s=n(56596),u=n(93918),d=n(29287),f=n(16572),h=(0,u.X)({root:[d.l0.py(4),d.l0.rowWithGap(4),d.l0.align.center]});function p(e){var t=e.deployment,n=e.small,u=t.currentBuild,d=i.VR[u.status],p=d.title,m=d.color,v=(0,f.Z)(new Date(u.timeCreated),Date.now(),{addSuffix:!0}),g="Deployed ".concat(v," by ").concat(u.user.displayName),y=u.status===a.Fe.Success?"Deployed":p;return(0,r.tZ)(c.u,{tooltip:g,children:(0,r.BX)(s.G,{css:h.root,children:[(0,r.tZ)(o.Z,{size:n?12:16,color:m}),(0,r.tZ)(l.xv,{variant:n?"small":void 0,color:"dimmest",multiline:!1,children:y})]})})}},31577:function(e,t,n){n.d(t,{$:function(){return s}});var r=n(66626),i=n(74985),o=n(50959),a=n(19713),l=n(60427),c=n(64420);function s(e){var t=(0,r._)((0,o.useState)(function(){var t,n,r,i,o,c;return n=(t={fs:e.fs,container:e.container,dotReplit:e.dotReplit,ports:e.ports}).container,r=t.fs,i=t.dotReplit,o=t.ports,(c=(0,a.MT)()).set(l.CK,n),c.set(l.bA,r),c.set(l.My,i),c.set(l.l,o),c}),1)[0];return(0,i.BX)(c.aT.Provider,{value:t,children:[e.children,(0,i.tZ)(l.jd,{replId:e.replId})]})}},92977:function(e,t,n){n.d(t,{Gs:function(){return f},Qw:function(){return d},un:function(){return h}});var r=n(41733),i=n(66626),o=n(74985),a=n(43312),l=n(56596),c=n(93918),s=n(50959),u=n(36855),d=(0,c.X)({maxWidth:{width:"100%",maxWidth:600,marginLeft:"auto",marginRight:"auto"}}),f=function(e,t){return(0,a.F4)("\n  0% {\n    opacity: 0;\n    height: ".concat((null==t?void 0:t.from)?t.from:0,"px;\n  }\n  99% {\n    opacity: 1;\n    height: ").concat(e,"px;\n  }\n  ").concat((null==t?void 0:t.noAuto)?"100% {\n        opacity: 1;\n        height: ".concat(e,"px;\n      }"):"100% {\n    height: auto;\n  }","\n"))};function h(e){var t,n,a,c=e.children,d=e.render,f=e.timeout,h=void 0===f?300:f,p=e.initialHeight,m=(0,s.useRef)(null),v=(0,s.useRef)(null),g=(n=(t=(0,i._)((0,s.useState)(0),2))[0],a=t[1],(0,s.useEffect)(function(){if(v.current){var e=new ResizeObserver(function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var l=i.value.borderBoxSize[0].blockSize;a(l)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}});return e.observe(v.current),function(){return e.disconnect()}}},[n,v]),n),y=g>0?g:p,b={transition:h+"ms ease-out",transitionProperty:"height, opacity",opacity:0,height:0,visibility:"hidden"},w={entering:{opacity:1,height:y},entered:{transitionProperty:"opacity",opacity:1,height:y,visibility:"visible"},exiting:{opacity:0,height:0,visibility:"visible"},exited:{opacity:0,height:0,visibility:"hidden"}};return(0,o.tZ)(u.ZP,{nodeRef:m,timeout:h,in:d,children:function(e){return(0,o.tZ)(l.G,{innerRef:m,style:(0,r._)({},b,w[e]),children:(0,o.tZ)(l.G,{innerRef:v,children:c})})}})}},14186:function(e,t,n){var r,i,o,a;n.d(t,{a:function(){return i},k:function(){return r}}),(o=r||(r={})).Intro="intro",o.Deployment="deployment",o.DeploymentInProgress="deployment_in_progress",o.Analytics="analytics",o.Logs="logs",o.Settings="settings",o.ReservedVMTierSelection="reserved_vm_tier_selection",o.AutoscaleMachineConfiguration="autoscale_machine_configuration",(a=i||(i={})).SendDeploymentLifecycleCommand="send_deployment_lifecycle_command",a.ChangeView="change_view",a.OpenPane="open_pane"},59121:function(e,t,n){n.d(t,{E:function(){return r},c:function(){return i}});var r="Procfile";function i(e){var t={};return e.split("\n").forEach(function(e){if(""!==e){var n=e.match(/^([A-Za-z0-9_]+):\s*(.+)$/);if(n){var r=n[2].trim().split(" ");t[n[1]]={command:r[0],options:r.slice(1)}}}}),t}},63385:function(e,t,n){n.d(t,{EC:function(){return p},U4:function(){return d}});var r=n(41733),i=n(21262),o=n(71440),a=n(99165);function l(){var e=(0,i._)(["\n  fragment MultiplayerUser on User {\n    id\n    image\n    username\n    url\n  }\n"]);return l=function(){return e},e}function c(){var e=(0,i._)(["\n  fragment MultiplayerRepl on Repl {\n    id\n    multiplayers {\n      ...MultiplayerUser\n    }\n    multiplayerInvites {\n      email\n      type\n    }\n  }\n  ","\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  mutation AddOrInviteReplMultiplayer(\n    $input: AddOrInviteReplMultiplayerInput!\n  ) {\n    addOrInviteReplMultiplayer(input: $input) {\n      __typename\n      ... on AddOrInviteReplMultiplayerOuput {\n        result {\n          ... on MultiplayerInvite {\n            email\n            repl {\n              ...MultiplayerRepl\n            }\n            invitePermissionType: type\n          }\n          ... on ReplPermission {\n            id\n            repl {\n              ...MultiplayerRepl\n            }\n            user {\n              ...MultiplayerUser\n            }\n            replPermissionType: type\n          }\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n  ","\n"]);return s=function(){return e},e}var u={},d=(0,o.Ps)(l()),f=(0,o.Ps)(c(),d),h=(0,o.Ps)(s(),f,d);function p(e){var t=(0,r._)({},u,e);return a.D(h,t)}},99883:function(e,t,n){var r=n(66626),i=n(43182),o=n(63385),a=n(55534),l=n(59868),c=n(75582),s=n(67795);t.Z=function(e){var t=e.isMobileApp,n=e.isTeam,u=e.handleUpgradeTriggered,d=e.replId,f=(0,a.Z)(),h=f.showConfirm,p=f.showError,m=function(e,t){i.n_({message:t}),i.Tb(Error(e.message)),p("Something unexpected happened, please try again.")},v=(0,r._)((0,o.EC)({onError:function(e){return m(e,"useAddOrInviteReplMultiplayerMutation")},onCompleted:function(e){var r,i,o,a=e.addOrInviteReplMultiplayer;switch(a.__typename){case"NotFoundError":case"UnauthorizedError":p(a.message);return;case"UserError":if(a.message.includes("reached the limit")){if(t&&!n){p("You have reached the invite limit for a free account. Please upgrade to add more collaborators.");return}if(!t&&u){u(!0);return}}p(a.message);return;case"AddOrInviteReplMultiplayerOuput":"MultiplayerInvite"===a.result.__typename?(r=c.ml.Email,i=a.result.email):(r=c.ml.Username,i=(null===(o=a.result.user)||void 0===o?void 0:o.username)?"@".concat(a.result.user.username):"user")}(0,l.j)(s.U3.MULTIPLAYER_INVITED,{replId:d,inviteMethod:r}),h("Added ".concat(i))}}),2);return{addOrInviteReplMultiplayer:v[0],loadingAddMutation:v[1].loading}}},69470:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(50959);function i(){return(0,r.useMemo)(function(){return function(){if("undefined"==typeof document)return!1;var e=document.createElement("input");return"webkitdirectory"in e||"mozdirectory"in e||"msdirectory"in e||"odirectory"in e||"directory"in e}()},[])}},13225:function(e,t,n){var r=n(50959);t.Z=function(e,t,n){(0,r.useEffect)(function(){var t=setTimeout(e,n);return function(){clearTimeout(t)}},t)}},62789:function(e,t,n){n.d(t,{f6:function(){return c},oj:function(){return l},xZ:function(){return u}});var r=n(66626),i=n(54916),o=n(50959);function a(e){var t=(0,r._)((0,o.useState)(!1),2),n=t[0],a=t[1],l=(0,i.Z)().dotReplit;return(0,o.useEffect)(function(){var t=!1;return l.getConfig().then(function(n){t||n.error||n.config.language!==e||a(!0)}),function(){t=!0}},[e,l]),n}function l(){return a("kaboom")}function c(){return a("kaboomdraw")}var s=/^draw.[tj]s$/;function u(e){return c()&&!!(null==e?void 0:e.match(s))}},85172:function(e,t,n){n.d(t,{v:function(){return d}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995);function l(){var e=(0,i._)(["\n  query ReplTeamOrgSettings($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          __typename\n          ... on Team {\n            id\n            organization {\n              id\n              isAiEnabled\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c={},s=(0,o.Ps)(l()),u=n(50782);function d(){var e,t,n,i,o=(n={variables:{replId:(0,u.Z)()}},i=(0,r._)({},c,n),a.a(s,i)).data;return{isTeamWithAiDisabled:(null==o?void 0:o.repl.__typename)==="Repl"&&(null===(e=o.repl.owner)||void 0===e?void 0:e.__typename)==="Team"&&(null===(t=o.repl.owner.organization)||void 0===t?void 0:t.isAiEnabled)===!1}}},62624:function(e,t,n){function r(){return"ontouchstart"in window||navigator.maxTouchPoints>0}function i(){return!!/iPad|iPhone|iPod/.test(navigator.platform)||navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)}n.d(t,{Z:function(){return r},y:function(){return i}})},8123:function(e,t,n){n.d(t,{_:function(){return c}});var r=n(27387),i=n(96583),o=n(2689),a=n(54916),l=n(16643);function c(){var e=(0,a.Z)().toolchain;function t(){return(t=(0,r._)(function(t){return(0,i.Jh)(this,function(n){switch(n.label){case 0:return[4,e.addModule(t).catch(function(e){o.kg.error("Toolchain: failed to add Nix module: "+e.message)})];case 1:return n.sent(),[2]}})})).apply(this,arguments)}function n(){return(n=(0,r._)(function(t){return(0,i.Jh)(this,function(n){switch(n.label){case 0:return[4,e.removeModule(t).catch(function(e){o.kg.error("Toolchain: failed to remove Nix module: "+e.message)})];case 1:return n.sent(),[2]}})})).apply(this,arguments)}function c(){return(c=(0,r._)(function(t,n){return(0,i.Jh)(this,function(r){switch(r.label){case 0:return[4,e.upgradeModule(t,n).catch(function(e){o.kg.error("Toolchain: failed to upgrade Nix module: "+e.message)})];case 1:return r.sent(),[2]}})})).apply(this,arguments)}return{modules:(0,l.Z)(e.modules),configs:(0,l.Z)(e.configs),addModule:function(e){return t.apply(this,arguments)},removeModule:function(e){return n.apply(this,arguments)},upgradeModule:function(e,t){return c.apply(this,arguments)}}}},76433:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(56337),i=n(18059),o=n(54916),a=n(47611),l=n.n(a),c=n(50959),s=n(30084),u="You have unsaved changes";function d(){var e=(0,r.Z)(),t=(0,i.Vm)(),n=(0,o.Z)().fs,d=(0,a.useRouter)(),f=(0,c.useRef)(!1),h=(0,c.useCallback)(function(){if(!e&&!f.current&&n.getStatus()!==s.kO.Clean&&!window.confirm(u))throw l().events.emit("routeChangeError"),Error("Abort route change. Please ignore this error.")},[n,e]);return(0,c.useEffect)(function(){function r(t){if(!e&&!f.current&&n.getStatus()!==s.kO.Clean)return t.preventDefault(),t.returnValue=u,u}return window.addEventListener("beforeunload",r),t||d.events.on("routeChangeStart",h),function(){window.removeEventListener("beforeunload",r),t||d.events.off("routeChangeStart",h)}},[d.events,n,h,e,t]),(0,c.useCallback)(function(e){f.current=e},[])}},78774:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(66626),i=n(66349),o=n(54916),a=n(50959),l=n(25202),c=n(41733),s=n(21262),u=n(71440),d=n(99165);function f(){var e=(0,s._)(["\n  mutation ReplFsUpdated($replId: String!) {\n    updateReplTimeUpdated(id: $replId) {\n      ... on Repl {\n        id\n        timeUpdated\n      }\n    }\n  }\n"]);return f=function(){return e},e}var h={},p=(0,u.Ps)(f());function m(){var e,t=(0,r._)((e=(0,c._)({},h,void 0),d.D(p,e)),1)[0],n=(0,o.Z)().fs,s=(0,i.Z)(),u=null==s?void 0:s.currentUserPermissions.containerWrite,f=null==s?void 0:s.id;(0,a.useEffect)(function(){if(u&&f){var e=(0,l.Z)(function(){return t({variables:{replId:f}})},{wait:6e4,maxWait:6e5}),r=n.onStatusChange(function(){e()});return function(){e.isScheduled()&&e.flush(),r()}}},[n,f,u,t])}},12435:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(66626),i=n(63257),o=n(6187),a=n(50959),l=n(41733),c=n(30509),s=function(e){return/\s/.test(e)};function u(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=(0,r._)((0,a.useState)(null),2),o=i[0],u=i[1],d=(0,a.useCallback)(u,[u]),f=(0,a.useRef)(t);(0,a.useEffect)(function(){f.current=t},[t]);var h=(0,r._)((0,a.useState)(null),2),p=h[0],m=h[1];return(0,a.useEffect)(function(){if(o){var e=function(){var e=o.value,t=o.selectionStart;if(!t){m(null);return}var n=1===t||s(e[t-2]||""),r=e.length?e[t-1]:null;m(function(i){if(i&&(t<i.index||0===t))return null;if(!r||!i&&!n)return i;var o=f.current.includes(r);return i||o?i?s(r)?null:(0,c._)((0,l._)({},i),{text:e.slice(i.index,t)}):{index:t,text:"",match:r}:i})},t=function(){m(null)};return o.addEventListener("focus",e),o.addEventListener("keyup",e),o.addEventListener("blur",t),function(){m(null),o.removeEventListener("focus",e),o.removeEventListener("keyup",e),o.removeEventListener("blur",t)}}},[o,m]),[p,d]}function d(e){var t=(0,a.useRef)(e);(0,a.useEffect)(function(){t.current=e},[e]);var n=(0,r._)((0,a.useState)(!1),2),l=n[0],c=n[1],s=(0,r._)((0,a.useState)(null),2),d=s[0],f=s[1],h=(0,r._)(u.apply(void 0,(0,i._)(Object.keys(e))),2),p=h[0],m=h[1],v=(0,a.useRef)(p);(0,a.useEffect)(function(){v.current=p},[p]);var g=(0,o.Z)(p,100);return(0,a.useEffect)(function(){if(!g){f(null);return}var e=g.match,n=g.text,r=t.current[e]?t.current[e]:null;if(!r){f(null);return}var i=!1;return c(!0),r(n).then(function(e){i||v.current!==g||(c(!1),f({textTrigger:g,results:e,applySuggestion:function(e){var t=e.targetValue,n=e.suggestionValue,r=t.slice(0,g.index),i=n,o=t.slice(g.index+g.text.length);o&&o.startsWith(" ")||(i+=" ");var a=r+i+o;return{cursorIndex:(r+i).length+(o&&o.startsWith(" ")?1:0),fullValue:a}}}))}),function(){i=!0}},[g,f]),[{isLoading:l,suggestions:d},m]}},23896:function(e,t,n){n.d(t,{T:function(){return o}});var r=n(54916),i=n(16643);function o(){var e=(0,r.Z)().toolchain;return(0,i.Z)(e.configs)}},64457:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(66626),i=n(2038),o=n(35614),a=n(50959);function l(){var e=(0,a.useRef)(0),t=(0,r._)((0,a.useState)(!1),2),n=t[0],l=t[1],c=(0,i.T3)(),s=(0,i.rv)(),u=(0,o.u)();return(0,a.useEffect)(function(){var t,n=window.visualViewport;if(n){if(s){l(null!==(t=null==u?void 0:u.isShown)&&void 0!==t&&t);return}if(c){var r=function(){l(n.height<.8*e.current)};return e.current=n.height,n.addEventListener("resize",r),function(){n.removeEventListener("resize",r)}}}},[c,s,null==u?void 0:u.isShown]),n}},99672:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(41733),i=n(30509),o=n(39426),a=n(66626),l=n(58130),c=n(54916),s=n(50959),u=n(2689);function d(e,t){var n,d,f,h,p=(n=(0,c.Z)().container,f=(d=(0,a._)((0,s.useState)(null),2))[0],h=d[1],(0,s.useEffect)(function(){if(n)return n.onConnectionStateChanged(function(){h(n.getConnectionMetadata())})},[n]),(0,s.useMemo)(function(){return f?(0,l.he)(f.token):null},[f]));(0,s.useEffect)(function(){if(e&&t){var n,a,l,c=(null===(n=e.origin)||void 0===n?void 0:n.__typename)==="Repl"?e.origin.id:null,s=(0,o.cR)(e.rootOriginReplUrl);return(0,u.Fy)((0,i._)((0,r._)({id:e.id,slug:e.slug,originId:c,roles:t.roles&&t.roles.map(function(e){return e.name}),rootOriginReplUrl:e.rootOriginReplUrl,rootOriginReplReleaseId:null===(l=e.source)||void 0===l?void 0:null===(a=l.release)||void 0===a?void 0:a.id},0!==s.length&&{languages:s}),{tokenCluster:null==p?void 0:p.cluster})),function(){(0,u.dv)()}}},[e,t,p])}},24227:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(27387),i=n(96583),o=n(19659),a=/\(copy\)( \d+)?$/,l=/\d+$/,c=n(39756);function s(e,t){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e,t){var n,r,s,u,d,f;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return n=(0,o.Il)(e),[4,t.readDir(0===n.length?c.Ql:n)];case 1:if((r=i.sent()).error)throw r.error;return s=new Set(r.children.map(function(e){return e.filename})),u=function(e,t){for(var n=(0,o.r6)(e),r=(0,o.eb)(e),i=a.test(r)?e:"".concat(r," (copy)").concat(n.length>0?".".concat(n):""),c=1;c<=t.size&&t.has(i);c++){var s=(0,o.eb)(i),u=s.split(" ");l.test(s)&&u.pop(),i="".concat(u.join(" ")," ").concat(c),n.length>0&&(i+=".".concat(n))}return i}((0,o.UO)(e),s),d=n?"".concat(n,"/").concat(u):u,[4,t.copyFile(e,d)];case 2:if((f=i.sent()).error)throw f.error;return[2,d]}})})).apply(this,arguments)}},62582:function(e,t){t.Z={sandbox:"allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox allow-modals allow-downloads allow-downloads-without-user-activation allow-presentation allow-orientation-lock allow-scripts",allow:"accelerometer; ambient-light-sensor; autoplay; battery; camera; display-capture; encrypted-media; execution-while-not-rendered; execution-while-out-of-viewport; fullscreen; gamepad; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; navigation-override; oversized-images; payment; picture-in-picture; publickey-credentials; speaker-selection; sync-xhr; unoptimized-images; unsized-media; usb; screen-wake-lock; web-share; xr-spatial-tracking; clipboard-read; clipboard-write",allowFullScreen:!0,allowtransparency:"true",allowpaymentrequest:"true"}},56320:function(e,t,n){n.d(t,{Z:function(){return A}});var r=n(66626),i=n(74985),o=n(48528),a=n(55534),l=n(10041),c=n(59868),s=n(18836),u=n(76566),d=n(38080),f=n(4070),h=n(74833),p=n(56596),m=n(93918),v=n(39390),g=n(8017),y=n(88936),b=n(20573),w=n(29287),Z=n(41733),x=n(21262),C=n(71440),S=n(58995),k=n(99165);function _(){var e=(0,x._)(["\n  query MultiplayerInviteUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n        owner {\n          ... on User {\n            id\n          }\n          ... on Team {\n            id\n            capabilities {\n              isBusinessPlan\n              hasValidSubscription\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return _=function(){return e},e}function E(){var e=(0,x._)(["\n  mutation MultiplayerRefreshInviteUrl($replId: String!) {\n    refreshMultiplayerInviteLink(replId: $replId) {\n      id\n      ... on Repl {\n        id\n        inviteUrl\n      }\n    }\n  }\n"]);return E=function(){return e},e}function T(){var e=(0,x._)(["\n  mutation DeleteMultiplayerInviteUrl($replId: String!) {\n    deleteMultiplayerInviteLink(replId: $replId) {\n      ... on Repl {\n        id\n        inviteUrl\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return T=function(){return e},e}var R={},I=(0,C.Ps)(_()),D=(0,C.Ps)(E()),G=(0,C.Ps)(T()),B=(0,m.X)({container:[w.l0.colWithGap(12),w.l0.px(16),w.l0.pt(12),{borderTop:"solid 1px ".concat(w.TV.outlineDimmest)}],header:[w.l0.flex.row,w.l0.justify.spaceBetween],globeIconContainer:[w.l0.width(40),w.l0.height(40),w.l0.backgroundColor.accentPrimaryDimmer,w.l0.borderRadius("full"),w.l0.align.center,w.l0.justify.center],title:[w.l0.fontWeight.medium],loading:[w.l0.rowWithGap(4),w.l0.align.center],inviteUrlContainer:[w.l0.borderRadius(8),w.l0.flex.row],input:[w.l0.borderRadius(8,0,0,8),w.l0.color.foregroundDimmer],copyToClipboard:[w.l0.borderRadius(0,8,8,0)],titleGroup:[w.l0.rowWithGap(12)]}),P=function(){return(0,i.BX)(p.G,{css:B.titleGroup,children:[(0,i.tZ)(p.G,{css:B.globeIconContainer,children:(0,i.tZ)(v.Z,{color:w.TV.accentPrimaryStrongest,size:20})}),(0,i.BX)(p.G,{children:[(0,i.tZ)(h.xv,{css:B.title,id:"link-switch-label",multiline:!1,children:"Private join link"}),(0,i.tZ)(h.xv,{variant:"small",color:"dimmest",multiline:!1,children:"Anyone with this link can edit files"})]})]})};function A(e){var t,n,m,v,x,C,_,E,T,A,N,L=e.replId,U=(0,a.Z)(),O=U.showConfirm,M=U.showError,X=(t=(0,Z._)({},R,{variables:{replId:L}}),S.a(I,t)),F=X.data,W=X.loading,H=X.error,V=X.refetch,z=(0,r._)((n=(0,Z._)({},R,{variables:{replId:L},onError:function(e){return M(e.message)},onCompleted:function(){return O("Join link created")}}),k.D(D,n)),2),j=z[0],q=z[1],Y=(0,r._)((m=(0,Z._)({},R,{variables:{replId:L},optimisticResponse:{deleteMultiplayerInviteLink:{id:L,inviteUrl:null,__typename:"Repl"},__typename:"RootMutationType"},onError:function(e){return M(e.message)},onCompleted:function(e){if("UserError"===e.deleteMultiplayerInviteLink.__typename){M(e.deleteMultiplayerInviteLink.message);return}"Repl"===e.deleteMultiplayerInviteLink.__typename&&O("Join link deleted")}}),k.D(G,m)),2),J=Y[0],K=Y[1],$=(null==F?void 0:null===(v=F.repl)||void 0===v?void 0:v.__typename)==="Repl"?F.repl:null,Q=q.loading||K.loading,ee=(null==F?void 0:null===(x=F.repl)||void 0===x?void 0:x.__typename)==="Repl"&&(null==$?void 0:null===(C=$.owner)||void 0===C?void 0:C.__typename)==="Team",et=(null==F?void 0:null===(_=F.repl)||void 0===_?void 0:_.__typename)==="Repl"&&(null==$?void 0:null===(E=$.owner)||void 0===E?void 0:E.__typename)==="Team"&&(null==$?void 0:null===(T=$.owner.capabilities)||void 0===T?void 0:T.isBusinessPlan)&&(null==$?void 0:null===(A=$.owner.capabilities)||void 0===A?void 0:A.hasValidSubscription),en=(null==F?void 0:null===(N=F.repl)||void 0===N?void 0:N.__typename)==="Repl"&&(null==$?void 0:$.inviteUrl)?window.location.origin+(null==$?void 0:$.inviteUrl):null;return W||ee&&!et?null:H?(0,i.BX)(p.G,{css:B.container,children:[(0,i.BX)(p.G,{css:B.header,children:[(0,i.tZ)(P,{}),(0,i.tZ)(f.r,{isSelected:!1,isDisabled:!0,"aria-labelledby":"link-switch-label"})]}),(0,i.tZ)(u.u,{css:[w.l0.textAlign.left],icon:(0,i.tZ)(b.Z,{color:w.TV.accentNegativeStrongest}),colorway:"negative",text:"Error loading join link. Click here to try again, or contact support.",onClick:function(){return V({replId:L})}})]}):(0,i.BX)(p.G,{css:B.container,children:[(0,i.BX)(p.G,{css:B.header,children:[(0,i.tZ)(P,{}),W?(0,i.BX)(p.G,{css:B.loading,children:[(0,i.tZ)(y.Z,{color:w.TV.foregroundDimmer}),(0,i.tZ)(h.xv,{color:"dimmer",multiline:!1,children:"Loading..."})]}):(0,i.tZ)(f.r,{isSelected:!!en,isDisabled:Q,onChange:function(e){Q||(e?j():J())},"aria-labelledby":"link-switch-label"})]}),!W&&en?(0,i.BX)(i.HY,{children:[(0,i.BX)(d.Tg,{css:B.inviteUrlContainer,children:[(0,i.tZ)(s.II,{type:"url",readOnly:!0,disabled:!0,value:Q?"Loading...":en,css:B.input}),(0,i.tZ)(o.m,{textToCopy:en,onClick:function(){en?((0,l.Z)(en),(0,c.j)(c.U3.JOIN_LINK_COPIED,{replId:null==$?void 0:$.id,isTeamRepl:ee,source:"replEnvironment"}),O("Link copied")):M("Could not copy link")},tooltip:"Copied to clipboard",text:"Copy join link",iconLeft:(0,i.tZ)(g.Z,{}),css:B.copyToClipboard,colorway:"primary",disabled:Q})]}),(0,i.tZ)(p.G,{children:(0,i.BX)(h.xv,{color:"dimmer",variant:"small",multiline:!1,children:["Want to revoke access to this link?"," ",(0,i.tZ)("a",{css:w.l0.linkStyle,role:"button",tabIndex:0,onKeyDown:function(e){"Enter"!==e.key||(e.preventDefault(),Q||j())},onClick:function(e){e.preventDefault(),Q||j()},children:"Generate a new link"})]})})]}):null]})}},61495:function(e,t,n){n.d(t,{_U:function(){return P},ln:function(){return A},ZP:function(){return N}});var r=n(63257),i=n(74985),o=n(99883),a=n(2038),l=n(3630),c=n(38080),s=n(74833),u=n(30983),d=n(56596),f=n(1128),h=n(97615),p=n(88936),m=n(29287),v=n(4773),g=n(58091),y=n(75582),b=n(47611),w=n(94376),Z=n(14709),x=n.n(Z),C=n(41733),S=n(21262),k=n(71440),_=n(63385),E=n(58995);function T(){var e=(0,S._)(["\n  query MultiplayerManager($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        isOwner\n        multiplayers {\n          ...MultiplayerUser\n        }\n        currentUserPermissions {\n          editMultiplayers\n        }\n        multiplayerInvites {\n          email\n          type\n        }\n      }\n    }\n    currentUser {\n      id\n      isSubscribed\n    }\n  }\n  ","\n"]);return T=function(){return e},e}var R={},I=(0,k.Ps)(T(),_.U4),D=n(91428),G=n(44343);function B(e,t){return t.some(function(t){return t.id===e})}var P={root:[m.l0.color.foregroundDefault,m.l0.flex.column,m.l0.colWithGap(12),m.l0.align.stretch,m.l0.flex.growAndShrink(1)],header:[m.l0.flex.row,m.l0.justify.spaceBetween,m.l0.align.center,m.l0.px(16)],header_mobile:[m.l0.px(0)],titleContainer:[m.l0.flex.row,m.l0.rowWithGap(4),m.l0.align.center],limitsContainer:[m.l0.align.center,m.l0.rowWithGap(8)],loading:[m.l0.rowWithGap(4),m.l0.align.center,m.l0.flex.grow(1),m.l0.justify.center],measureBar:[m.l0.height(8),m.l0.width(60)],searchContainer:[m.l0.px(16),m.l0.position.relative,m.l0.maxHeight(32)],userList:[m.l0.flex.column,m.l0.colWithGap(16),m.l0.scrollbar.thin,m.l0.position.relative,m.l0.overflowY("auto"),m.l0.flex.growAndShrink(1),m.l0.pb(8),{maxHeight:300,"::-webkit-scrollbar-thumb":[m.l0.backgroundColor.backgroundHighest,m.l0.borderRadius(4)],scrollbarColor:"".concat(m.TV.backgroundDefault," ").concat(m.TV.backgroundHighest)}],userGroup:{root:[m.l0.colWithGap(8)],titleContainer:[m.l0.rowWithGap(4),m.l0.align.center,m.l0.px(16)],title:[m.l0.fontWeight.medium]},emptyContainer:[m.l0.position.relative,m.l0.flex.row,m.l0.rowWithGap(12),m.l0.py(64),m.l0.center,m.l0.px(16),{maxHeight:220,borderBottom:"solid 1px ".concat(m.TV.outlineDimmest)}]},A=function(e){var t=e.title,n=e.count,r=e.color,o=e.tooltip;return(0,i.BX)(d.G,{css:P.userGroup.titleContainer,children:[(0,i.tZ)(f.Z,{color:r,size:6}),(0,i.tZ)(s.xv,{variant:"small",css:P.userGroup.title,multiline:!1,children:t}),(0,i.tZ)(s.xv,{multiline:!1,variant:"small",color:"dimmest",css:P.userGroup.title,children:n}),o?(0,i.tZ)(u.u,{tooltip:o,children:(0,i.tZ)(h.Z,{})}):null]})},N=function(e){var t,n=e.replId,u=e.handleUpgradeTriggered,f=(0,b.useRouter)(),h=(0,a.Vg)(f),Z=(0,o.Z)({isMobileApp:h,isTeam:!1,handleUpgradeTriggered:u,replId:n}),S=Z.addOrInviteReplMultiplayer,k=Z.loadingAddMutation,_=(0,g.aG)(),T=(t=(0,C._)({},R,{variables:{replId:n},pollInterval:8e3}),E.a(I,t)),N=T.data,L=T.loading,U=(null==N?void 0:N.repl.__typename)==="Repl"?N.repl:null,O=null==N?void 0:N.currentUser,M=null==U?void 0:U.multiplayers.reduce(function(e,t){return(0,r._)(e).concat([t.username])},[]),X=(null==U?void 0:U.currentUserPermissions.editMultiplayers)||!1,F=!!(U&&!U.multiplayers.length&&!U.multiplayerInvites.length),W=null==U?void 0:U.multiplayers.filter(function(e){return e.id!==(null==O?void 0:O.id)}),H=null==W?void 0:W.filter(function(e){return e&&B(e.id,_)}),V=null==W?void 0:W.filter(function(e){return e&&!B(e.id,_)}),z=W?W.length:null;return(0,i.BX)(c.Tg,{background:"default",css:P.root,children:[(0,i.BX)(d.G,{css:[P.header,h&&P.header_mobile],children:[(0,i.tZ)(d.G,{css:P.titleContainer,children:(0,i.tZ)(s.xv,{variant:"subheadDefault",multiline:!1,children:"Multiplayers"})}),(0,i.BX)(d.G,{css:P.limitsContainer,children:[L?(0,i.BX)(d.G,{css:P.loading,children:[(0,i.tZ)(p.Z,{color:m.TV.foregroundDimmer}),(0,i.tZ)(s.xv,{color:"dimmer",multiline:!1,children:"Loading..."})]}):null,null===z||(null==O?void 0:O.isSubscribed)?null:(0,i.BX)(i.HY,{children:[(0,i.BX)(s.xv,{variant:"small",color:"dimmest","aria-hidden":!0,multiline:!1,children:[z," / ",w.z]}),(0,i.tZ)(l.J,{css:P.measureBar,total:w.z,current:z,tooltip:"".concat(w.z-z," free editors remaining")})]}),L||(null==O?void 0:O.isSubscribed)||h?null:(0,i.tZ)(v.Z,{size:"small",context:"workspace_multiplayer_header",onClickCallback:function(){u&&u(!0)},onCancel:function(){u&&u(!1)}})]})]}),X&&M&&U?(0,i.tZ)(d.G,{css:P.searchContainer,children:(0,i.tZ)(G.Z,{existingUsernames:M,onSubmit:function(e){(!L||(null==O?void 0:O.isSubscribed))&&(k||S({variables:{input:{replId:n,target:{method:x()(e)?y.ml.Email:y.ml.Username,value:e},level:y.gA.Rw}}}))}})}):null,F?(0,i.tZ)(d.G,{css:P.emptyContainer,children:(0,i.tZ)(d.G,{children:(0,i.tZ)(s.xv,{variant:"subheadDefault",color:"dimmer",multiline:!1,children:"No one else is here"})})}):(0,i.BX)(c.Tg,{css:P.userList,children:[(null==H?void 0:H.length)?(0,i.BX)(d.G,{css:P.userGroup.root,children:[(0,i.tZ)(A,{title:"Online",count:H.length||0,color:m.TV.greenStrongest}),H.map(function(e){return e?(0,i.tZ)(D.Z,{isPendingInvitation:!1,replId:n,canEditMultiplayers:X,user:e},e.id):null})]}):null,(null==V?void 0:V.length)?(0,i.BX)(d.G,{css:P.userGroup.root,children:[(0,i.tZ)(A,{title:"Offline",count:V.length||0,color:m.TV.outlineStrongest}),null==V?void 0:V.map(function(e){return e?(0,i.tZ)(D.Z,{canEditMultiplayers:X,isPendingInvitation:!1,user:e,replId:n},e.id):null})]}):null,(null==U?void 0:U.multiplayerInvites.length)?(0,i.BX)(d.G,{css:P.userGroup.root,children:[(0,i.tZ)(A,{title:"Pending Invitations",count:(null==U?void 0:U.multiplayerInvites.length)||0,color:m.TV.outlineStrongest}),U.multiplayerInvites.map(function(e){return(0,i.tZ)(D.Z,{canEditMultiplayers:X,replId:n,isPendingInvitation:!0,email:e.email},e.email)})]}):null]})]})}},91428:function(e,t,n){n.d(t,{Z:function(){return D}});var r=n(74985),i=n(46056),o=n(66626),a=n(43182),l=n(55534),c=n(41733),s=n(21262),u=n(71440),d=n(63385),f=n(99165);function h(){var e=(0,s._)(["\n  mutation RemoveMultiplayerUser($replId: String!, $username: String!) {\n    removeMultiplayerUser(replId: $replId, username: $username) {\n      id\n      user {\n        id\n        ...MultiplayerUser\n      }\n      repl {\n        id\n        multiplayers {\n          ...MultiplayerUser\n        }\n      }\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function p(){var e=(0,s._)(["\n  mutation DeleteMultiplayerInvite($replId: String!, $email: String!) {\n    deleteMultiplayerInvite(replId: $replId, email: $email) {\n      ... on MultiplayerInvite {\n        email\n        type\n        repl {\n          id\n          multiplayers {\n            ...MultiplayerUser\n          }\n          multiplayerInvites {\n            email\n            type\n          }\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}var m={},v=(0,u.Ps)(h(),d.U4),g=(0,u.Ps)(p(),d.U4),y=function(){var e,t,n=(0,l.Z)(),r=n.showConfirm,i=n.showError,s=function(e,t){a.n_({message:t}),a.Tb(Error(e.message)),i("Something unexpected happened, please try again.")},u=(0,o._)((e=(0,c._)({},m,{onError:function(e){return s(e,"useRemoveMultiplayerUser")},onCompleted:function(e){var t,n=null===(t=e.removeMultiplayerUser.user)||void 0===t?void 0:t.username;n?r("@".concat(n," removed")):r("User removed")}}),f.D(v,e)),2),d=u[0],h=u[1].loading,p=(0,o._)((t=(0,c._)({},m,{onError:function(e){return s(e,"useDeleteMultiplayerInviteMutation")},onCompleted:function(e){if("UserError"===e.deleteMultiplayerInvite.__typename){i(e.deleteMultiplayerInvite.message);return}if("MultiplayerInvite"===e.deleteMultiplayerInvite.__typename){var t=e.deleteMultiplayerInvite.email;r("Invite canceled for ".concat(t))}}}),f.D(g,t)),2);return{removeMultiplayerUser:d,loadingRemoveUser:h,deleteMultiplayerInvite:p[0],loadingDeleteInvite:p[1].loading}},b=n(15146),w=n(74833),Z=n(54254),x=n(56596),C=n(93918),S=n(17216),k=n(58719),_=n(29287),E=n(50862),T=n(33988),R=n.n(T),I=(0,C.X)({root:[_.l0.px(16),_.l0.py(4),_.l0.flex.row,_.l0.rowWithGap(8),_.l0.align.center,_.l0.cursor.default,_.l0.justify.spaceBetween],userContainer:_.l0.color.foregroundDefault,userContainer_pending:[_.l0.flex.grow(1),_.l0.flex.row,_.l0.rowWithGap(8),_.l0.align.center,{fontStyle:"italic"}],permissionsContainer:[_.l0.flex.row,_.l0.rowWithGap(8),_.l0.align.center]}),D=function(e){var t,n=e.isPendingInvitation,o=e.canEditMultiplayers,a=e.replId,l=y(),c=l.removeMultiplayerUser,s=l.loadingRemoveUser,u=l.deleteMultiplayerInvite,d=l.loadingDeleteInvite,f=!n,h=f?(0,r.tZ)(i.Z,{size:"m",url:e.user.image,username:e.user.username,fullName:e.user.fullName}):(0,r.tZ)(S.Z,{color:_.TV.outlineDefault,size:32}),p=f?e.user.username:e.email;return(0,r.BX)(x.G,{css:I.root,children:[f?(0,r.tZ)(E.Z,{username:e.user.username,children:(0,r.tZ)(R(),{legacyBehavior:!0,href:"/@".concat(e.user.username),passHref:!0,children:(0,r.tZ)(x.G,{tag:"a",css:I.userContainer,children:(0,r.tZ)(Z.n,{username:e.user.username,src:null!==(t=e.user.image)&&void 0!==t?t:null})})})}):(0,r.BX)(x.G,{css:[I.userContainer_pending],children:[h,(0,r.tZ)(w.xv,{color:f?"default":"dimmest",multiline:!1,children:p})]}),(0,r.BX)(x.G,{css:I.permissionsContainer,children:[(0,r.tZ)(w.xv,{color:"dimmest",variant:"small",multiline:!1,children:e.isPendingInvitation?"Invited":"Can edit"}),o?(0,r.tZ)(b.hU,{alt:f?"Remove member":"Cancel invitation",onClick:function(){!o||s||d||(f?c({variables:{replId:a,username:e.user.username}}):u({variables:{replId:a,email:e.email}}))},children:(0,r.tZ)(k.Z,{size:12})}):null]})]})}},44343:function(e,t,n){n.d(t,{Z:function(){return _}});var r=n(41733),i=n(30509),o=n(66626),a=n(74985),l=n(46056),c=n(6187),s=n(55534),u=n(1498),d=n(18836),f=n(38080),h=n(74833),p=n(56596),m=n(93918),v=n(32377),g=n(88936),y=n(29287),b=n(10981),w=n(21371),Z=n(50959),x=n(14709),C=n.n(x),S=n(57574),k=(0,m.X)({form:[y.l0.align.start,y.l0.display.flex,y.l0.rowWithGap(8),y.l0.width("100%")],searchContainer:[y.l0.position.relative,y.l0.flex.growAndShrink(1)],dropdownMenu:[y.l0.borderRadius(8),y.l0.overflow("hidden"),y.l0.mt(2),y.l0.zIndex(2),y.l0.border({color:y.TV.outlineDimmer,width:1,style:"solid"}),y.l0.maxHeight(280),y.l0.overflowY("auto"),y.l0.scrollbar.thin,{scrollbarColor:y.TV.backgroundHigher+" "+y.TV.backgroundHighest,"&::-webkit-scrollbar-thumb":{backgroundColor:y.TV.backgroundHighest}}],result:[y.l0.p(8),y.l0.rowWithGap(8),y.l0.justify.spaceBetween,y.l0.align.center,y.l0.cursor.pointer],result_active:[y.l0.backgroundColor.accentPrimaryDimmer],userContainer:[y.l0.rowWithGap(8),y.l0.align.center],loadingContainer:[y.l0.align.center,y.l0.m(8),y.l0.rowWithGap(8),y.l0.align.center],emptyText:[y.l0.m(8)]});function _(e){var t=e.onSubmit,n=e.existingUsernames,m=e.isDisabled,x=e.onChange,_=e.placeholder,E=(0,o._)((0,Z.useState)(""),2),T=E[0],R=E[1],I=(0,b.U)(),D=(0,c.Z)(T.trim().replace(/^@/,""),250),G=(0,S.sk)({skip:!D||C()(T),variables:{query:D,limit:6}}),B=G.data,P=G.loading,A=G.error,N=(0,s.Z)().showError;(0,Z.useEffect)(function(){A&&N(A.message)},[A,N]);var L=null==B?void 0:B.usernameSearch,U=function(e){R(e.currentTarget.value),null==x||x(e.currentTarget.value)},O=function(e){"Enter"===e.key&&T.match(/.+@.+/)&&(t(T),R(""),e.currentTarget.blur())};return(0,a.BX)("form",{onSubmit:function(e){e.preventDefault(),t(T),R("")},css:k.form,children:[(0,a.tZ)(w.ZP,{onChange:function(e){e&&R(e.username)},itemToString:function(e){return(null==e?void 0:e.username)||""},initialHighlightedIndex:0,defaultHighlightedIndex:0,children:function(e){var t=e.getInputProps,o=e.getItemProps,c=e.getMenuProps,s=e.isOpen,u=e.highlightedIndex,m=e.getRootProps;return(0,a.BX)(p.G,(0,i._)((0,r._)({css:k.searchContainer},m({refKey:"innerRef"})),{children:[(0,a.tZ)(d.II,(0,r._)({id:I("username-search")},t({ref:null,value:T,onChange:U,placeholder:null!=_?_:"Add people by username or email",autoComplete:"off",onKeyDown:O}))),s?(0,a.BX)(p.G,{children:[L&&L.length?(0,a.tZ)(f.Tg,(0,i._)((0,r._)({elevated:!0,css:k.dropdownMenu,tag:"ul"},c({refKey:"innerRef"})),{children:L.map(function(e,t){return(0,a.BX)(p.G,(0,i._)((0,r._)({tag:"li"},o({item:e,index:t})),{css:[k.result,t===u&&k.result_active],children:[(0,a.BX)(p.G,{css:k.userContainer,children:[(0,a.tZ)(l.Z,{size:"m",url:e.image,username:e.username,fullName:e.fullName}),(0,a.tZ)(h.xv,{multiline:!1,children:e.username})]}),n.includes(e.username)?(0,a.tZ)(p.G,{children:(0,a.tZ)(v.Z,{color:y.TV.accentPositiveStronger})}):null]}),t)})})):null,P?(0,a.tZ)(f.Tg,{elevated:!0,css:k.dropdownMenu,children:(0,a.BX)(p.G,{css:k.loadingContainer,children:[(0,a.tZ)(g.Z,{}),(0,a.tZ)(h.xv,{color:"dimmer",multiline:!1,children:"Loading"})]})}):null,L&&0===L.length?(0,a.tZ)(f.Tg,{elevated:!0,css:k.dropdownMenu,children:(0,a.BX)(h.xv,{css:k.emptyText,color:"dimmer",multiline:!1,children:['No results found for "',T,'"']})}):null]}):null]}))}}),(0,a.tZ)(p.G,{children:(0,a.tZ)(u.zx,{colorway:"primary",type:"submit",disabled:m||!T,text:"Invite"})})]})}},32147:function(e,t,n){n.d(t,{FW:function(){return h},NH:function(){return v}});var r=n(41733),i=n(21262),o=n(71440),a=n(80428),l=n(41538),c=n(58995);function s(){var e=(0,i._)(["\n  fragment PublishReplData on Repl {\n    id\n    url\n    title\n    description\n    iconUrl\n    lastPublishedAt\n    publishedAs\n    imageUrl\n    isRenamed\n    templateInfo {\n      iconUrl\n    }\n    replViewSettings {\n      id\n      defaultView\n      replImage\n      replFile\n    }\n    tags {\n      id\n      isOfficial\n    }\n    currentUserPermissions {\n      containerWrite\n      publish\n      changeIconUrl\n    }\n    ...CrosisContextRepl\n    ...PublishedReplShareInfoReplData\n  }\n  ","\n  ","\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  fragment PublishCurrentUser on CurrentUser {\n    id\n    image\n    isTemplateDeveloper: hasRole(role: TEMPLATE_DEVELOPER)\n    ...CrosisContextCurrentUser\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  query PublishCurrentUser {\n    currentUser {\n      id\n      ...PublishCurrentUser\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var f={},h=(0,o.Ps)(s(),a.C,l.B),p=(0,o.Ps)(u(),a.D),m=(0,o.Ps)(d(),p);function v(e){var t=(0,r._)({},f,e);return c.a(m,t)}},63204:function(e,t,n){n.d(t,{e9:function(){return h},wd:function(){return d}});var r=n(41733),i=n(21262),o=n(71440),a=n(41538),l=n(58995);function c(){var e=(0,i._)(["\n  fragment PublishReleaseFormRepl on Repl {\n    id\n    title\n    description\n    slug\n    user {\n      username\n    }\n    ...PublishedReplShareInfoReplData\n    deployment {\n      id\n      activeRelease {\n        id\n      }\n    }\n    releases {\n      items {\n        id\n        timeCreated\n        description\n      }\n    }\n  }\n  ","\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  query PublishReleaseFormCurrentUser {\n    currentUser {\n      id\n      username\n    }\n  }\n"]);return s=function(){return e},e}var u={},d=(0,o.Ps)(c(),a.B),f=(0,o.Ps)(s());function h(e){var t=(0,r._)({},u,e);return l.a(f,t)}},41538:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(21262);function i(){var e=(0,r._)(["\n  fragment PublishedReplShareInfoReplData on Repl {\n    id\n    url\n    publishedAs\n    title\n  }\n"]);return i=function(){return e},e}var o=(0,n(71440).Ps)(i())},25061:function(e,t,n){n.d(t,{Z:function(){return E}});var r=n(27387),i=n(96583),o=n(74985),a=n(75246),l=n(74833),c=n(56596),s=n(93918),u=n(29287);n(50959);var d=(0,s.X)({styles0:[u.l0.colWithGap(8)],styles1:[u.l0.colWithGap(8)],styles2:[u.l0.colWithGap(8)]}),f=(0,s.X)({content:[u.l0.p(8),u.l0.colWithGap(16)],section:[u.l0.colWithGap(8)]});function h(e){var t=e.header;return(0,o.tZ)(a.Q,{headerContent:t,children:(0,o.BX)(c.G,{css:f.content,children:[(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Bold Text"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"**bold**"})]}),(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Italic Text"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"__italic__"})]}),(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Links"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"[Link Name](https://yourlink.com)"})]}),(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Images"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"![Image alt text](https://linktoyourimage.com)"})]}),(0,o.BX)(c.G,{css:f.section,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Header Text"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"# Header"})]}),(0,o.BX)(c.G,{css:d.styles0,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Code Blocks"}),(0,o.BX)(l.xv,{color:"dimmer",multiline:!1,children:["```",(0,o.tZ)("br",{}),"this is for large, multiline code blocks",(0,o.tZ)("br",{}),"```"]})]}),(0,o.BX)(c.G,{css:d.styles1,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Inline Code"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"`this is for code in the middle of sentences`"})]}),(0,o.BX)(c.G,{css:d.styles2,children:[(0,o.tZ)(l.xv,{multiline:!1,children:"Horizontal Rules"}),(0,o.tZ)(l.xv,{color:"dimmer",multiline:!1,children:"***"})]})]})})}var p=n(72310),m=n(59868),v=n(1498),g=n(18836),y=n(37951),b=n(74883),w=n(20573),Z=n(10981),x=n(75582),C=n(69273),S=c.K.form;function k(e){return 0===e.trim().length?{message:"You cannot leave this empty."}:e.length>100?{message:"The title should not be longer than ".concat(100," characters.")}:void 0}function _(e){return 0===e.trim().length?{message:"You cannot leave this empty."}:e.length>5e3?{message:"The description should not be longer than ".concat(5e3," characters.")}:void 0}function E(e){var t,n,a,s=e.repl,d=e.source,f=e.onDone,E=(0,Z.U)(),T=E("titleIdInput"),R=E("descriptionIdInput"),I=(0,p.Y)("",k),D=(0,p.Y)("",_),G=(0,C.O)();return(0,o.BX)(S,{onSubmit:(t=(0,r._)(function(e){return(0,i.Jh)(this,function(t){switch(t.label){case 0:if(e.preventDefault(),I.validate()||D.validate())return[2];return[4,G.publish({input:{replId:s.id,title:I.value,body:D.value}})];case 1:return t.sent().error||((0,m.j)(m.U3.UPDATE_SHARED,{source:d,replType:s.publishedAs===x.O2.Template?"template_repl":"regular_repl"}),f()),[2]}})}),function(e){return t.apply(this,arguments)}),css:[u.l0.colWithGap(16)],children:[(0,o.tZ)(l.h4,{level:1,variant:"headerDefault",children:"Add an update"}),(0,o.BX)(l.xv,{multiline:!1,children:["Explain what has changed about this"," ",s.publishedAs===x.O2.Template?"Template":"Repl","."]}),(0,o.BX)(c.G,{css:u.l0.colWithGap(8),children:[(0,o.BX)(c.G,{css:u.l0.colWithGap(4),children:[(0,o.tZ)("label",{css:u.l0.color.foregroundDimmer,htmlFor:T,children:"Title"}),(0,o.tZ)(g.II,{id:T,onChange:function(e){I.setValue(e.target.value)},disabled:G.loading,placeholder:"Give your post a title"})]}),I.error?(0,o.tZ)(y.E,{icon:(0,o.tZ)(w.Z,{}),text:null===(n=I.error)||void 0===n?void 0:n.message,colorway:"negative"}):null]}),(0,o.BX)(c.G,{css:u.l0.colWithGap(8),children:[(0,o.BX)(c.G,{css:u.l0.colWithGap(4),children:[(0,o.tZ)("label",{css:u.l0.color.foregroundDimmer,htmlFor:R,children:"Description"}),(0,o.tZ)(g.B,{id:R,onChange:function(e){D.setValue(e.target.value)},css:[u.l0.width("100%"),{minHeight:u.TV.space128,maxHeight:u.TV.space256,resize:"vertical",lineHeight:u.TV.lineHeightDefault}],disabled:G.loading,placeholder:"Write something about this post"})]}),D.error?(0,o.tZ)(y.E,{icon:(0,o.tZ)(w.Z,{}),text:null===(a=D.error)||void 0===a?void 0:a.message,colorway:"negative"}):null]}),(0,o.tZ)(h,{header:"Style your description with Markdown"}),G.error?(0,o.tZ)(y.E,{icon:(0,o.tZ)(w.Z,{}),colorway:"negative",text:G.error}):null,(0,o.tZ)(v.zx,{text:G.loading?"Sharing update...":"Share update",type:"submit",colorway:"primary",disabled:!!(G.loading||I.error||D.error),css:{alignSelf:"end"},iconLeft:(0,o.tZ)(b.Z,{})})]})}},69273:function(e,t,n){n.d(t,{O:function(){return m}});var r=n(27387),i=n(66626),o=n(96583),a=n(41733),l=n(21262),c=n(71440),s=n(32147),u=n(99165);function d(){var e=(0,l._)(["\n  mutation PublishReplCreatePost($input: CreateReplPost2Input!) {\n    createReplPost2(input: $input) {\n      ... on Post {\n        id\n        repl {\n          id\n          ...PublishReplData\n        }\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}var f={},h=(0,c.Ps)(d(),s.FW);function p(e){var t,n,r,i,o,a,l;return e.error?e.error.message||"Something went wrong publishing your Repl":(null===(n=e.data)||void 0===n?void 0:null===(t=n.createReplPost2)||void 0===t?void 0:t.__typename)==="NotFoundError"||(null===(i=e.data)||void 0===i?void 0:null===(r=i.createReplPost2)||void 0===r?void 0:r.__typename)==="UnauthorizedError"||(null===(a=e.data)||void 0===a?void 0:null===(o=a.createReplPost2)||void 0===o?void 0:o.__typename)==="UserError"?e.data.createReplPost2.message:(null===(l=e.data)||void 0===l?void 0:l.createReplPost2)&&"Post"!==e.data.createReplPost2.__typename?"Something went wrong publishing your Repl":void 0}function m(){var e,t,n=(0,i._)((e=(0,a._)({},f,void 0),u.D(h,e)),2),l=n[0],c=n[1];return{publish:(t=(0,r._)(function(e){var t,n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:if(t=e.input,c.loading)return[2,{data:null,error:null}];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,l({variables:{input:t}})];case 2:return[2,{data:(n=r.sent()).data,error:p(n)}];case 3:return r.sent(),[2,{data:null,error:"Something went wrong publishing your Repl"}];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),data:c.data,loading:c.loading,error:p(c)}}},30609:function(e,t,n){n.d(t,{Z:function(){return d},_:function(){return p}});var r=n(66626),i=n(74985),o=n(79217),a=n(29287),l=n(50831),c=n(9617),s=n(35972),u=n(50959);function d(e){var t=(0,r._)((0,u.useState)(!1),2),n=t[0],o=t[1],a=[],d=[];if(e.variables.length>0){var f=e.variables[0].parentVariableReference,h=!0,m=!1,v=void 0;try{for(var g,y=e.variables[Symbol.iterator]();!(h=(g=y.next()).done);h=!0){var b=g.value;b.parentVariableReference===f?a.push(b):d.push(b)}}catch(e){m=!0,v=e}finally{try{h||null==y.return||y.return()}finally{if(m)throw v}}}return(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.Z,{truncate:!0,level:5,children:"Variables"}),(0,i.BX)(s.gC,{align:"stretch",constrainWidth:!0,children:[a.map(function(t){return(0,i.tZ)(p,{depth:0,variable:t,client:e.client},t.parentVariableReference+"/"+t.name)}),d.length>0&&(0,i.BX)(i.HY,{children:[(0,i.BX)(l.Z,{filled:!1,border:!1,onClick:function(){return o(function(e){return!e})},children:["See ",n?"Less":"More"]}),n&&d.map(function(t){return(0,i.tZ)(p,{depth:0,variable:t,client:e.client},t.parentVariableReference+"/"+t.name)})]})]})]})}function f(e){var t=e.variable,n=e.expanded;return t.variablesReference>0?(0,i.tZ)("div",{css:[a.l0.transition.snappy,{transform:"rotate(".concat(n?0:-90,"deg)")}],children:(0,i.tZ)(o.Z,{})}):null}function h(e){var t=e.expanded,n=e.depth,r=e.variable;return 0!==n||"parentVariableReference"in r?(0,i.tZ)("div",{css:[a.l0.flex.grow(0),a.l0.flex.shrink(0),a.l0.width(a.TV.space16),a.l0.display.flex,a.l0.align.center,a.l0.justify.end],children:(0,i.tZ)(f,{expanded:t,variable:r})}):(0,i.tZ)(f,{expanded:t,variable:r})}function p(e){var t=e.depth,n=e.variable,o=e.client,a=(0,r._)((0,u.useState)(!1),2),l=a[0],c=a[1],d=(0,r._)((0,u.useState)([]),2),f=d[0],m=d[1];return(0,u.useEffect)(function(){l&&o.fetchVariables(n.variablesReference).then(function(e){return m(e)},function(){return c(!1)})},[l,o,n.variablesReference]),(0,i.BX)(i.HY,{children:[(0,i.BX)("div",{className:"variable",onClick:function(){n.variablesReference>0&&c(function(e){return!e})},css:{"&":{display:"flex",alignItems:"center",maxWidth:"100%",height:"var(--space-32)",minHeight:"var(--space-32)",cursor:"pointer",color:"var(--foreground-dimmer)",borderRadius:"var(--border-radius-4)",fontSize:"var(--font-size-default)",paddingLeft:"calc(".concat(t," * var(--space-16))"),fontFamily:"var(--font-family-code)"},"&:hover":{backgroundColor:"var(--background-higher)",color:"var(--foreground-default)"},".label":{fontSize:"var(--font-size-default)",paddingLeft:"var(--space-8)",paddingRight:"var(--space-8)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:"1 0 auto"},".type":{opacity:"0.5"},".value":{textAlign:"right",flexShrink:1}},children:[(0,i.tZ)(h,{expanded:l,variable:n,depth:t}),(0,i.BX)("div",{className:"label",children:[n.name,n.type?(0,i.BX)("span",{className:"type",children:[" ",n.type]}):null,""!==n.value&&": "]}),(0,i.tZ)("div",{className:"label value",children:(0,i.tZ)("pre",{children:n.value})})]}),l?(0,i.tZ)(s.gC,{align:"stretch",constrainWidth:!0,children:f.map(function(e){return(0,i.tZ)(p,{depth:t+1,variable:e,client:o},"parentVariableReference"in e?e.parentVariableReference+"/"+e.name:e.name)})}):null]})}},917:function(e,t,n){var r,i;n.d(t,{y:function(){return r}}),(i=r||(r={})).Welcome="Welcome",i.Editor="Editor",i.Examples="Examples",i.Run="Run",i.Output="Output",i.Sidepane="Sidepane",i.Share="Share"},5693:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(66626),i=n(74985),o=n(55534),a=n(59868),l=n(1498),c=n(74833),s=n(56596),u=n(98859),d=n(29287),f=n(75582),h=n(41733),p=n(21262),m=n(71440),v=n(73931),g=n(99165);function y(){var e=(0,p._)(["\n  mutation UnpublishReplUnpublish($input: UnpublishReplFromCommunityInput!) {\n    unpublishReplFromCommunity(input: $input) {\n      ... on Repl {\n        id\n        ...ReplViewReplActionsPermissions\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n  ","\n"]);return y=function(){return e},e}var b={},w=(0,m.Ps)(y(),v.jN),Z=s.K.form;function x(e){var t,n,p=e.repl,m=e.source,v=e.onDone,y=(0,o.Z)(),x=y.showConfirm,C=y.showError,S=(0,r._)((t={variables:{input:{replId:p.id}},onCompleted:function(e){if("Repl"===e.unpublishReplFromCommunity.__typename){var t=e.unpublishReplFromCommunity.likeCount;(0,a.j)(a.U3.REPL_UNPUBLISHED,{source:m,numLikes:t,replType:p.publishedAs===f.O2.Template?"template_repl":"regular_repl"}),x("Repl removed from the community.")}else"NotFoundError"===e.unpublishReplFromCommunity.__typename||"UnauthorizedError"===e.unpublishReplFromCommunity.__typename?C(e.unpublishReplFromCommunity.message):C("An unexpected error occurred.");v()},onError:function(){C("Something went wrong. Please try again.")},update:function(e){e.modify({id:e.identify({__typename:"Repl",id:p.id}),fields:{comments:function(e,t){return t.DELETE},tags:function(e,t){return t.DELETE}}})}},n=(0,h._)({},b,t),g.D(w,n)),2),k=S[0],_=S[1].loading;return(0,i.BX)(s.G,{css:[d.l0.colWithGap(24)],children:[(0,i.tZ)(c.xv,{variant:"subheadBig",children:"Unpublish this Repl from the Community"}),(0,i.BX)(Z,{onSubmit:function(e){e.preventDefault(),k()},css:[d.l0.colWithGap(32)],children:[(0,i.tZ)(c.xv,{children:"Unpublishing a Repl will remove it from the Community. This action will delete all associated posts and tags. The Repl and all its comments will still be visible in your profile, but will not be shown in the Community or Trending views anymore. You can always re-publish the Repl again later."}),(0,i.BX)(s.G,{css:[d.l0.rowWithGap(8),d.l0.justify.end],children:[(0,i.tZ)(s.G,{children:(0,i.tZ)(l.zx,{type:"button",text:"Cancel",onClick:function(){return v()}})}),(0,i.tZ)(s.G,{children:(0,i.tZ)(l.zx,{disabled:_,colorway:"negative",text:_?"Unpublishing...":"Yes, unpublish this Repl",type:"submit",iconLeft:(0,i.tZ)(u.Z,{})})})]})]})]})}},51780:function(e,t,n){n.d(t,{d:function(){return l}});var r=n(21262),i=n(71440),o=n(20708);function a(){var e=(0,r._)(["\n  fragment BulkDeleteConfirmationModalRepl on Repl {\n    id\n    iconUrl\n    title\n    hostingDeployment {\n      ... on HostingDeployment {\n        id\n        replitAppSubdomain\n        ...BuildStatusBadgeHostingDeployment\n      }\n    }\n  }\n  ","\n"]);return a=function(){return e},e}var l=(0,i.Ps)(a(),o.u)},15053:function(e,t,n){var r=n(66626),i=n(74985),o=n(84096),a=n(73157),l=n(2161),c=n(1498),s=n(18836),u=n(49344),d=n(37951),f=n(74833),h=n(56596),p=n(93918),m=n(52682),v=n(20573),g=n(29287),y=n(50959),b=(0,p.X)({wrapper:[g.l0.colWithGap(16)],repls:[g.l0.maxHeight("60vh"),g.l0.overflow("auto"),{"& > div":[g.l0.py(8),{borderTop:"1px solid "+g.TV.outlineDimmest}],"& > div:last-of-type":{borderBottom:"1px solid "+g.TV.outlineDimmest}}],row:[g.l0.colWithGap(8)],replRow:[g.l0.rowWithGap(8),g.l0.align.center],additionalReplsCount:[g.l0.pl(12),g.l0.pt(8)],buttons:[g.l0.rowWithGap(12),g.l0.justify.end]}),w=function(e){var t,n=e.repl,a=e.onConfirmedChange,c=(0,r._)((0,y.useState)(""),2),u=c[0],p=c[1],m=(null===(t=n.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"?n.hostingDeployment:null,g=(0,y.useRef)(!1);return(0,i.BX)(h.G,{css:b.row,children:[(0,i.BX)(h.G,{css:b.replRow,children:[(0,i.tZ)(l.ZP,{size:24,iconUrl:n.iconUrl,alt:""}),(0,i.tZ)(f.xv,{height:"singleLine",multiline:!1,children:n.title}),m?(0,i.tZ)(o.e,{deployment:m}):null]},n.id),m?(0,i.BX)(i.HY,{children:[(0,i.tZ)(d.E,{icon:(0,i.tZ)(v.Z,{}),colorway:"red",text:"This repl has been deployed. If you delete this Repl, the associated\nproduction deployment will also be shut down and deleted. To\nproceed, please type: ".concat(m.replitAppSubdomain)}),(0,i.tZ)(s.II,{placeholder:"Type here",value:u,onChange:function(e){var t=e.currentTarget.value;p(t);var n=t===m.replitAppSubdomain;n!==g.current&&a(n),g.current=n}})]}):null]})};t.Z=function(e){var t=e.selectedRepls,n=e.isOpen,o=e.onClose,l=e.onDelete,s=e.deleting,d=t.length,p=(0,a.Z)("Repl",d),v=t.filter(function(e){var t;return(null===(t=e.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"}).length,g=(0,a.Z)("Deployment",v),Z=v>0?" & ".concat(v>1?v+" ":""," ").concat(g):"",x=(0,r._)((0,y.useState)(0),2),C=x[0],S=x[1];return(0,y.useEffect)(function(){n||S(0)},[n]),(0,i.tZ)(u.u,{isOpen:n,onRequestClose:o,children:(0,i.BX)(h.G,{css:b.wrapper,children:[(0,i.BX)(f.h4,{variant:"subheadBig",level:2,children:["Delete ",p,v>0?" & ".concat(g):"","?"]}),(0,i.tZ)(f.xv,{color:"dimmer",children:"Are you sure? This cannot be undone. Some Repls may take a few minutes to finish deleting."}),(0,i.tZ)(h.G,{css:b.repls,children:t.map(function(e){return(0,i.tZ)(w,{css:b.row,repl:e,onConfirmedChange:function(e){return S(function(t){return t+(e?1:-1)})}},e.id)})}),(0,i.BX)(h.G,{css:b.buttons,children:[(0,i.tZ)(c.zx,{text:"Cancel",onClick:o,disabled:s}),(0,i.tZ)(c.zx,{iconLeft:(0,i.tZ)(m.Z,{}),onClick:l,disabled:s||C<v,text:"Yes, delete ".concat(d>1?d+" ":""," ").concat(p).concat(Z),colorway:"negative"})]})]})})}},51288:function(e,t,n){n.d(t,{Zo:function(){return _},av:function(){return Z},xV:function(){return S}});var r=n(41733),i=n(30509),o=n(98924),a=n(66626),l=n(74985),c=n(50959),s=n(93918),u=n(29287),d=n(1169),f=n(56596),h=n(59520),p=n(93496),m=n(74833),v=n(32883),g=n(27879),y=n(61694),b=n(38080),w=function(){var e=(0,a._)((0,c.useState)(!1),2),t=e[0],n=e[1],r=(0,a._)((0,c.useState)({x:0,y:0}),2);return{clicked:t,setClicked:n,points:r[0],setPoints:r[1]}},Z=function(){var e=w(),t=e.clicked,n=e.setClicked,o=e.points,a=e.setPoints;(0,c.useEffect)(function(){var e=function(){return n(!1)};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}},[n]);var l=(0,c.useCallback)(function(e){var t=e.x,r=e.y;n(!0),a({x:t,y:r})},[n,a]),s=(0,c.useCallback)(function(e){e.preventDefault(),e.stopPropagation(),l({x:e.clientX,y:e.clientY})},[l]),u=(0,c.useCallback)(function(){n(!1)},[n]);return{triggerProps:{onContextMenu:s},menuProps:(0,i._)((0,r._)({},o),{isOpen:t}),onClose:u,open:l}},x=(0,s.X)({menu:[u.l0.position.fixed,u.l0.flex.column,u.l0.borderRadius(8),u.l0.shadow(1),{"& > :first-child":[u.l0.borderRadius(8,8,0,0)],"& > :last-child":[u.l0.borderRadius(0,0,8,8)]}],item:[u.l0.reset.button,{'&:not([disabled]):not([aria-disabled="true"])':[p.gU.listItem],'&[disabled], &[aria-disabled="true"]':[u.l0.color.foregroundDimmest]},u.l0.p(8),u.l0.rowWithGap(8),u.l0.align.center],underlay:[u.l0.position.fixed,{top:0,left:0,bottom:0,right:0}]}),C=function(e){e.preventDefault()},S=function(e){var t=e.children,n=e.isOpen,a=e.defaultOpen,s=e.onOpenChange,u=e.x,f=e.y,h=(0,o._)(e,["children","isOpen","defaultOpen","onOpenChange","x","y"]),p=(0,g.d)({isOpen:n,defaultOpen:a,onOpenChange:s}),m=(0,c.useRef)(null),w=(0,v.NE)({},p,m),Z=w.modalProps,S=w.underlayProps;return n?(0,l.tZ)(v.aV,{portalContainer:document.body,children:(0,l.tZ)("div",(0,i._)((0,r._)({css:x.underlay},S),{onContextMenu:C,children:(0,l.tZ)(y.ZP,{children:(0,l.tZ)(b.Tg,(0,i._)((0,r._)({elevated:!0,css:x.menu},Z,h),{innerRef:m,tag:"ul",role:"menubar","aria-orientation":"vertical","aria-label":"Context",style:{left:u,top:f},children:(0,l.tZ)(d.uP,{options:{direction:"vertical"},children:t})}))})}))}):null},k=f.K.button,_=c.forwardRef(function(e,t){var n=e.children,s=e.iconLeft,u=e.isDisabled,f=void 0!==u&&u,p=e.onClick,v=(0,o._)(e,["children","iconLeft","isDisabled","onClick"]),g=(0,c.useRef)(null),y=(0,a._)((0,d.XZ)(g,f),4),b=y[0],w=y[1],Z=y[2],C=y[3];(0,d.Ym)(w,g);var S=(0,c.useCallback)(function(e){f||(C(),null==p||p(e))},[C,f,p]);return(0,l.BX)(k,(0,i._)((0,r._)({disabled:f,css:x.item,role:"menuitem",ref:(0,h.lq)(t,g),tabIndex:b,onKeyDown:Z,onClick:S},v),{children:[s,(0,l.tZ)(m.xv,{multiline:!1,children:n})]}))})},24463:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(74985);n(50959);var i=n(29287),o=n(38080);function a(e){var t=e.className,n=e.children;return(0,r.tZ)(o.Tg,{elevated:!0,tag:"span",css:[{display:"inline",lineHeight:1},i.l0.fontSize(i.TV.fontSizeSmall),i.l0.borderRadius(4),i.l0.px(4),i.l0.font.code,t],children:n})}},47075:function(e,t,n){var r=n(41733),i=n(30509),o=n(74985),a=n(43312),l=function(e){return{animationDuration:e?"2000ms":"800ms",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out"}},c=(0,a.F4)("\n  0% { transform: translate(0px, 0px) }\n  25% { transform: translate(0px, 80px) }\n  50% { transform: translate(100px, 80px) }\n  75% { transform: translate(100px, 160px) }\n  100% { transform: translate(0px, 160px) }\n"),s=(0,a.F4)("\n  0% { transform: translate(0px, 0px) }\n  25% { transform: translate(0px, -80px) }\n  50% { transform: translate(-100px, -80px) }\n  100% { transform: translate(-100px, -80px) }\n"),u=(0,a.F4)("\n  0% { transform: translate(0px, 0px) }\n  50% { transform: translate(0px, 0px) }\n  75% { transform: translate(0px, -80px) }\n  100% { transform: translate(100px, -80px) }\n");t.Z=function(e){var t=e.height,n=void 0===t?24:t,a=e.color,d=e.slow,f=void 0!==d&&d,h={width:84,height:64,fill:void 0===a?"#F26207":a,rx:12};return(0,o.BX)("svg",{width:n/1.2,height:n,viewBox:"0 0 200 240",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.tZ)("rect",(0,i._)((0,r._)({css:[l(f),{animationName:c}]},h),{x:8,y:8})),(0,o.tZ)("rect",(0,i._)((0,r._)({css:[l(f),{animationName:s}]},h),{x:108,y:88})),(0,o.tZ)("rect",(0,i._)((0,r._)({css:[l(f),{animationName:u}]},h),{x:8,y:168}))]})}},36227:function(e,t,n){n.d(t,{O:function(){return p}});var r=n(74985),i=n(4995),o=n(9331),a=n(58719),l=n(72143),c=n(1498),s=n(87659),u=n(15146),d=n(74833),f=n(56596),h=n(29287);function p(e){var t=e.title,n=e.content,l=e.colorway,p=void 0===l?"primary":l,v=e.totalSteps,g=void 0===v?1:v,y=e.currentStepIndex,b=void 0===y?0:y,w=e.onDismiss,Z=e.onCurrentStepChange,x=e.cypressCloseData;return(0,r.BX)(f.G,{css:[h.l0.p(8),{paddingBottom:12,paddingRight:t?void 0:32,backgroundColor:s.Br[p].dimmest,border:"1px solid "+s.Br[p].dimmer,position:"relative"},h.l0.borderRadius(8),h.l0.shadow(2),h.l0.colWithGap(8)],children:[(0,r.tZ)(u.hU,{alt:"Close",colorway:p,css:{position:"absolute",top:h.TV.space8,right:h.TV.space8},onClick:w,dataCy:x,children:(0,r.tZ)(a.Z,{})}),t?(0,r.tZ)(d.xv,{variant:"subheadBig",multiline:!1,children:t}):null,"function"==typeof n?(0,r.tZ)(n,{}):(0,r.tZ)(d.xv,{children:n}),g>1&&Z?(0,r.BX)(f.G,{css:[h.l0.flex.row,h.l0.align.center,h.l0.justify.spaceBetween],children:[(0,r.tZ)(c.zx,{css:{visibility:b<=0?"hidden":void 0},colorway:p,text:"Back",iconLeft:(0,r.tZ)(i.Z,{}),onClick:function(){return Z(b-1)}}),(0,r.tZ)(m,{colorway:p,total:g,current:b}),(0,r.tZ)(c.zx,{"data-autofocus":!0,colorway:p,text:b>=g-1?"Done":"Next",iconLeft:(0,r.tZ)(o.Z,{}),onClick:function(){return b>=g-1?w():Z(b+1)}})]}):null]})}function m(e){var t=e.total,n=e.current,i=e.colorway;return(0,r.BX)(f.G,{children:[(0,r.tZ)(l.T,{children:(0,r.tZ)("progress",{value:n+1,max:t,"aria-label":"Step"})}),(0,r.tZ)(f.G,{"aria-hidden":!0,css:h.l0.rowWithGap(8),children:Array(t).fill(0).map(function(e,t){return(0,r.tZ)(f.G,{css:[h.l0.borderRadius("full"),{width:h.TV.space8,height:h.TV.space8,backgroundColor:t===n?s.Br[i].stronger:s.Br[i].dimmer}]},t)})})]})}},72067:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(66626),i=n(50959),o={isConnecting:!0,channel:null,context:null};function a(e){var t=e.container,n=e.service,a=e.name,l=e.skip,c=void 0!==l&&l,s=(0,r._)((0,i.useState)(o),2),u=s[0],d=s[1];return(0,i.useEffect)(function(){d(o);var e=!1,r=t.openChannel({service:n,name:a,skip:function(){return c}},function(t){if(!e)return d({context:t.context,channel:t.channel,isConnecting:!1}),function(t){e||d({isConnecting:t.willReconnect,channel:null,context:null})}});return function(){e=!0,r()}},[t,n,a,c]),u}},17867:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(66626),i=n(50959);function o(e){var t=(0,r._)((0,i.useState)(e.getConnectionState()),2),n=t[0],o=t[1];return(0,i.useEffect)(function(){return e.onConnectionStateChanged(o)},[e]),n}},86612:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(66626),i=n(17867),o=n(50959),a=n(82481),l=n(25425);function c(e){var t=(0,i.Z)(e),n=(0,r._)((0,o.useState)(null),2),c=n[0],s=n[1],u=(0,l.P5)({controlName:"flag-webview-fallback-url"});return(0,o.useEffect)(function(){var t=e.getDotdevUrl();if(t){var n=(0,a.bR)();if(!u||!n||n.dotDev){s(t);return}s(t.replace(/.replit.dev$/,".repl.co"))}},[e,t,u]),c}},81106:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(27387),i=n(66626),o=n(96583),a=n(7444),l=n(72067),c=n(50959);function s(e){var t=(0,l.Z)({container:e,service:"exec"}).channel,n=(0,c.useRef)(!1),s=(0,c.useRef)([]),u=(0,a.Z)((0,r._)(function(){var e,r,a,l,c,d,f,h,p,m;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(n.current||!s.current.length||(null==t?void 0:t.status)!=="open")return[2];if(!(e=s.current.pop()))throw Error("Expected request");return l=(a=(r=(0,i._)(e,2))[0]).args,c=a.env,d=r[1],f="",h=t.onCommand(function(e){e.output&&(f+=e.output)}),n.current=!0,[4,t.request({exec:{args:l,env:c}})];case 1:return p=o.sent(),n.current=!1,h(),m=p.channelClosed?"Channel closed":p.error,d(m?{error:m,output:f||null}:{output:f,error:null}),u.current(),[2]}})})),d=null==t?void 0:t.status;return(0,c.useEffect)(function(){"open"===d&&u.current()},[d,u]),(0,c.useCallback)(function(e){var t=e.args,n=e.env;return new Promise(function(e){s.current.push([{args:t,env:n},e]),u.current()})},[u])}},66349:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(66626),i=n(47001),o=n(54916),a=n(50959);function l(){var e,t,n=(0,o.Z)().container,l=(0,r._)((0,a.useState)(null!==(t=null===(e=n.getContext())||void 0===e?void 0:e.repl)&&void 0!==t?t:null),2),c=l[0],s=l[1];return(0,a.useEffect)(function(){return n.onConnectionStateChanged(function(e){var t,r;e===i.em.CONNECTED&&s(null!==(r=null===(t=n.getContext())||void 0===t?void 0:t.repl)&&void 0!==r?r:null)})},[s,n]),c}},3409:function(e,t,n){n.d(t,{J_:function(){return d},O2:function(){return s},hw:function(){return u}});var r=n(56337),i=n(23394),o=n(86612),a=n(37463),l=n(54916),c=n(83436);function s(e){return 80===e||443===e}function u(e,t){var n=new URL(e);return!t||s(t)?n.port&&(n.port=""):n.port=t.toString(),n}function d(e){var t,n,s,d=(0,r.Z)(),f=!(n=(0,a.bg)()).length||n.some(function(e){return 80===e.configuration.externalPort})?80:null!==(t=n[0].configuration.externalPort)&&void 0!==t?t:80,h=(0,l.Z)().container,p=(0,o.Z)(h),m=(0,c.I5)({variables:{id:e}}).data,v=(0,i.Z)();if(!f&&"html"!==v||!((null==m?void 0:m.repl.__typename)==="Repl"?m.repl:null)||!p)return null;var g=u(p,f).toString(),y=u(p+"/__replco/devtools_wrapper.html",f).toString();return{iframeSrc:d?(s=new URL(g)).hostname.endsWith(".localhost")?g:(s.protocol="https:",s.toString()):y,presentationUrl:g}}},87241:function(e,t,n){n.d(t,{H:function(){return nv}});var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b,w=n(27387),Z=n(41733),x=n(30509),C=n(66626),S=n(96583),k=n(51305),_=n(20435),E=n(59868),T=n(35375),R=n(50959),I=n(67795),D=n(30671),G=n(4004),B=n(43182),P=n(83493),A=n(78037);function N(e){return L.apply(this,arguments)}function L(){return(L=(0,w._)(function(e){var t,n;return(0,S.Jh)(this,function(r){return t=e.container,n=e.service,[2,new Promise(function(e){var r=t.openChannel({service:n},function(t){return e([t.channel,r]),r})})]})})).apply(this,arguments)}(r=d||(d={})).OUTPUT="OUTPUT",r.ERROR="ERROR",r.STATE_CHANGED="STATE_CHANGED",r.CHANNEL_OPENED="CHANNEL_OPENED";var U=n(23015);(f||(f={})).MESSAGE_RECEIVED="MESSAGE_RECEIVED";var O=n(47001),M=n(59173),X=n(63257),F=n(91039),W=n(12285),H=n(2689),V=n(91620).lW,z=new TextEncoder,j=new TextDecoder,q=(i=/[a-z\d_-]+: [a-z\d_ :;.,/"'?!(){}[\]@<>=+*#$&`|~^%-]+/.source,RegExp("(".concat(i,"\\r\\n)*(").concat(i,")$"),"i")),Y=function(){"use strict";function e(t){(0,W._)(this,e),this.onMessage=t,this.buffer=new Uint8Array,this.read=this.read.bind(this)}var t=e.prototype;return t.consumeHeaders=function(){var e=function(e){var t=e.findIndex(function(t,n){return 13===t&&10===e[n+1]&&13===e[n+2]&&10===e[n+3]});if(-1!==t){var n=j.decode(e.slice(0,t)),r=n.match(q);if(!r)throw H.kg.error("Failed to parse LSP header, no matches",{fragment:n}),Error("Unable to match header, text: ".concat(n));var i=Object.create(null),o=r[0].split("\r\n"),a=!0,l=!1,c=void 0;try{for(var s,u=o[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value,f=d.indexOf(":");if(-1===f)throw H.kg.error("Failed to parse LSP header, missing colon",{fragment:n}),Error('Message header must separate key and value using ":"');var h=d.substr(0,f),p=d.substr(f+1).trim();if("Content-Length"===h){var m=parseInt(p,10);if(isNaN(m))throw H.kg.error("Failed to parse LSP header, NaN content length",{fragment:n}),Error("Content-Length value must be a number.");i[h]=parseInt(p,10)}else i[h]=p}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}if(null==i["Content-Length"])throw H.kg.error("Failed to parse LSP header, no Content-Length",{fragment:n}),Error("Header must provide a Content-Length property.");return{headerLength:t,value:i}}}(this.buffer);if(e)return this.buffer=this.buffer.slice(e.headerLength+4),e},t.read=function(e){for(this.buffer=(t=this.buffer,n=z.encode(e),(r=new Uint8Array(t.length+n.length)).set(t),r.set(n,t.length),r);null!==(i=this.headers)&&void 0!==i?i:this.headers=this.consumeHeaders();){var t,n,r,i,o=this.headers.value["Content-Length"];if(this.buffer.length<o)return;var a=function(e,t,n){var r=j.decode(e.slice(0,t));try{return{json:JSON.parse(r),buffer:e.slice(t)}}catch(c){var i=V.from(e).toString();if(c instanceof SyntaxError&&"Unexpected end of JSON input"===c.message){H.kg.info("Failed to parse LSP message, falling back to json parsing",{buffer:i,length:t,rpcContent:r,attempt:"original-length",headers:JSON.stringify(n)});var o=function(e,t){for(var n=0,r=0,i=!1,o=t;o<e.length+1;o++){if(o!==t&&!n&&!r&&!i)return o;var a=e[o];switch(a){case 92:o++;continue;case 34:i=!i;continue}if(!i)switch(a){case 123:n++;break;case 125:n--;break;case 91:r++;break;case 93:r--}}return -1}(e,0);if(-1!==o){var a=e.slice(0,o),l=j.decode(a);try{return{json:JSON.parse(l),buffer:e.slice(o)}}catch(e){H.kg.error("Failed to parse LSP message",{givenError:e,buffer:i,length:t,rpcContent:r,attempt:"recomputed-length"})}}}else H.kg.error("Failed to parse LSP message",{givenError:c,buffer:i,length:t,rpcContent:r,attempt:"content-length"});return{json:void 0,buffer:e.slice(t)}}}(this.buffer,o,this.headers),l=a.json,c=a.buffer;if(this.headers=void 0,this.buffer=c,void 0!==l)try{this.onMessage(l)}catch(e){B.Tb(e)}}},e}(),J=n(91620).lW,K=n(33829),$=n(50431);function Q(e,t){return ee.apply(this,arguments)}function ee(){return(ee=(0,w._)(function(e,t){var n,r,i,o;return(0,S.Jh)(this,function(a){switch(a.label){case 0:return n=t.upstream,r=t.branchName,i=["--set-upstream-to",n],r&&i.push((0,$.Gw)(r)),[4,e("git branch ".concat(i.join(" ")),{serviceMethod:"git-set-branch-upstream"})];case 1:if((o=a.sent()).error)return[2,o];return[2,{error:null}]}})})).apply(this,arguments)}var et=["git diff -z --name-only --diff-filter=U","echo -n ".concat("\x1f"),"{ git grep -z -l -E '<{7,}|={7,}|>{7,}' || exit $(( $? == 1 ? 0 : $? )); }"].join(" && ");function en(e){return er.apply(this,arguments)}function er(){return(er=(0,w._)(function(e){var t,n,r,i,o,a,l,c,s,u,d;return(0,S.Jh)(this,function(f){switch(f.label){case 0:return[4,e(et,{serviceMethod:"git-get-conflicting-files"})];case 1:if((t=f.sent()).error)return[2,t];if(r=(n=(0,C._)(t.output.split("\x1f").map(function(e){return(0,$.so)(e,"\x00")}),2))[0],i=n[1],!r.length)return[2,{files:new Map,error:null}];o=new Map,a=!0,l=!1,c=void 0;try{for(s=r[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)d=u.value,o.set(d,!i.includes(d))}catch(e){l=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(l)throw c}}return[2,{files:o,error:null}]}})})).apply(this,arguments)}var ei=n(57369),eo=n(75813);function ea(e){return el.apply(this,arguments)}function el(){return(el=(0,w._)(function(e){var t,n,r,i,o,a;return(0,S.Jh)(this,function(l){switch(l.label){case 0:return[4,(0,ei.ZP)(e)];case 1:if((t=l.sent()).error)return[2,t];if(t.state!==ei.yG.MERGING)return[2,{error:eo.aq.INVALID_STATE}];return[4,e("cat '.git/MERGE_HEAD'",{serviceMethod:"git-get-merging-refs"})];case 2:if((n=l.sent()).error)return[2,n];if(!(r=(0,$.so)(n.output,"\n")).length)return[2,{commits:[],branches:[],error:null}];return i="{ grep -F '".concat(r.join("\n"),"' || exit 0; }"),[4,e("".concat('git for-each-ref --format="%(objectname)	%(refname)" refs/heads/ refs/remotes/'," | ").concat(i),{serviceMethod:"git-get-merging-refs"})];case 3:if((o=l.sent()).error)return[2,o];if(!o.output)return[2,{commits:r,branches:[],error:null}];return a=(0,$.so)(o.output,"\n").map(function(e){return e.split("	")[1]}).map($.C),[2,{commits:r,branches:a,error:null}]}})})).apply(this,arguments)}var ec=n(65307);function es(e){return eu.apply(this,arguments)}function eu(){return(eu=(0,w._)(function(e){var t,n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:return[4,e("if [ -f '.git/FETCH_HEAD' ]; then stat -c %Y '.git/FETCH_HEAD'; fi",{serviceMethod:"git-last-fetched"})];case 1:if((t=r.sent()).error)return[2,t];if(!t.output||isNaN(n=parseInt(t.output,10)))return[2,{lastFetched:null,error:null}];return[2,{lastFetched:new Date(n*=1e3),error:null}]}})})).apply(this,arguments)}var ed=n(21076),ef=n(80433);function eh(e,t){return ep.apply(this,arguments)}function ep(){return(ep=(0,w._)(function(e,t){var n,r,i,o,a,l;return(0,S.Jh)(this,function(c){switch(c.label){case 0:if(n=(t=(0,ed.Qj)(t)).startsWith("refs/heads/"),r=t.startsWith("refs/remotes/"),n)return[3,2];return i=r?t:"refs/remotes/".concat(t),[4,e("git show-ref --verify ".concat(i),{serviceMethod:"git-branch-exists"})];case 1:if(!(o=c.sent()).error)return[2,{exists:!0,ref:(0,ef.L)(i),error:null}];if(o.error!==eo.aq.INVALID_REFERENCE)return[2,o];c.label=2;case 2:if(r)return[3,4];return a=n?t:"refs/heads/".concat(t),[4,e("git show-ref --verify ".concat(a),{serviceMethod:"git-branch-exists"})];case 3:if(!(l=c.sent()).error)return[2,{exists:!0,ref:(0,ef.L)(a),error:null}];if(l.error!==eo.aq.INVALID_REFERENCE)return[2,l];c.label=4;case 4:return[2,{exists:!1,ref:null,error:null}]}})})).apply(this,arguments)}function em(e,t,n){return ev.apply(this,arguments)}function ev(){return(ev=(0,w._)(function(e,t,n){var r,i,o;return(0,S.Jh)(this,function(a){switch(a.label){case 0:if((0,ed.Pi)(t,n)){if(t=(0,ed.bF)(t,!0),n=(0,ed.bF)(n),t===n)return[2,{canMerge:!0,error:null}]}else t=(0,ed.bF)(t),n=(0,ed.bF)(n);return t=(0,$.Gw)(t),n=(0,$.Gw)(n),r="git merge-base ".concat(t," ").concat(n),i='git merge-tree "$('.concat(r,')" ').concat(t," ").concat(n),[4,e("set -eo pipefail; (".concat(i," | ").concat("( (grep -q -e '^+<* \\.our$' && echo '1') || echo '0')",") || test $? -eq 141"),{serviceMethod:"git-can-merge-branches"})];case 1:if((o=a.sent()).error)return[2,o];return[2,{canMerge:"0"===o.output,error:null}]}})})).apply(this,arguments)}function eg(e,t){return ey.apply(this,arguments)}function ey(){return(ey=(0,w._)(function(e,t){var n,r,i,o,a,l,c,s,u;return(0,S.Jh)(this,function(d){switch(d.label){case 0:return n=t.branch,r=t.message,o=void 0!==(i=t.allowConflicts)&&i,[4,(0,ei.ZP)(e)];case 1:if((a=d.sent()).error)return[2,a];if(l=a.state,a.type!==ei.y5.NORMAL||l===ei.yG.DIRTY_WORKTREE||l===ei.yG.DIRTY_INDEX)return[2,{error:eo.aq.INVALID_STATE}];return[4,eh(e,n)];case 2:if((c=d.sent()).error)return[2,c];if(!c.exists)return[2,{error:eo.aq.INVALID_REFERENCE}];if(o)return[3,4];return[4,em(e,n,"HEAD")];case 3:if((s=d.sent()).error)return[2,s];if(!s.canMerge)return[2,{error:eo.aq.MERGE_CONFLICT}];d.label=4;case 4:var f,h,p,m;return h=(f={branch:n,message:r}).branch,p=f.message,h=(0,ed.Qj)(h),m=["--quiet","--no-edit","--no-ff","--overwrite-ignore","--commit"],p&&m.push("-m",(0,$.Gw)(p)),m.push((0,$.Gw)(h)),[4,e("git merge ".concat(m.join(" ")),{serviceMethod:"git-merge"})];case 5:if((u=d.sent()).error!==eo.aq.MERGE_CONFLICT)return[3,8];if(o)return[3,7];return[4,e("git merge --abort")];case 6:return d.sent(),[2,u];case 7:return[2,{hasConflicts:!0,error:null}];case 8:if(u.error)return[2,u];return[2,{hasConflicts:!1,error:null}]}})})).apply(this,arguments)}function eb(e){return ew.apply(this,arguments)}function ew(){return(ew=(0,w._)(function(e){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return[4,e("git merge --abort",{serviceMethod:"git-merge-abort"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{error:null}]}})})).apply(this,arguments)}function eZ(e){return ex.apply(this,arguments)}function ex(){return(ex=(0,w._)(function(e){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return[4,e("GIT_EDITOR=/bin/true git merge --continue",{serviceMethod:"git-merge-continue"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{error:null}]}})})).apply(this,arguments)}var eC=n(55103);function eS(e,t,n){return ek.apply(this,arguments)}function ek(){return(ek=(0,w._)(function(e,t,n){var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g;return(0,S.Jh)(this,function(y){switch(y.label){case 0:if("string"==typeof t){if(""===t)return[2,{error:null}];t=[t]}if(!0!==t&&0===t.length)return[2,{error:null}];if(!(void 0!==n))return[3,2];return r=["--quiet","--no-overlay","--worktree","--source=".concat(n),!0===t?".":"-- ".concat(t.join(" "))],[4,e("git --literal-pathspecs restore ".concat(r.join(" ")),{serviceMethod:"git-restore-files"})];case 1:if((i=y.sent()).error)return[2,i];return[2,{error:null}];case 2:return[4,(0,eC.Z)(e)];case 3:if((o=y.sent()).error)return[2,o];a=[],l=[],c=!0,s=!1,u=void 0;try{for(d=o.changes[Symbol.iterator]();!(c=(f=d.next()).done);c=!0)if(h=f.value,!0===t||t.includes(h.path))switch(h.type.worktree){case eC.h.UNMODIFIED:continue;case eC.h.UNTRACKED:a.push((0,$.Gw)(h.path));break;default:l.push((0,$.Gw)(h.path))}}catch(e){s=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}if(0===a.length&&0===l.length&&void 0===n)return[2,{error:null}];return p=[],a.length&&(m=["--quiet","--force","--",a.join(" ")],p.push("git --literal-pathspecs clean ".concat(m.join(" ")))),l.length&&(v=["--quiet","--no-overlay","--worktree","-- ".concat(l.join(" "))],p.push("git --literal-pathspecs restore ".concat(v.join(" ")))),[4,e(p,{serviceMethod:"git-restore-files"})];case 4:if((g=y.sent()).error)return[2,g];return[2,{error:null}]}})})).apply(this,arguments)}var e_=function(){"use strict";function e(t,n){(0,W._)(this,e),this.cache=new Map,this.lastInvalidation=0,this.ttl=t,this.debounceTime=n}var t=e.prototype;return t.has=function(e){return this.cache.has(e)},t.get=function(e){var t=this.cache.get(e);if(!t)throw Error("No value found for key: ".concat(e));return t.result},t.set=function(e,t){var n=this,r=this.cache.get(e);r&&(clearTimeout(r.timeout),this.cache.delete(e));var i={result:t,timeout:setTimeout(function(){return n.cache.delete(e)},this.ttl),pending:!0};t.finally(function(){return i.pending=!1}),this.cache.set(e,i)},t.invalidate=function(){if(!(Date.now()-this.lastInvalidation<this.debounceTime)){var e=new Map,t=!0,n=!1,r=void 0;try{for(var i,o=this.cache[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=(0,C._)(i.value,2),l=a[0],c=a[1];c.pending?e.set(l,c):clearTimeout(c.timeout)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.cache=e,this.lastInvalidation=Date.now()}},t.clear=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.cache.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;clearTimeout(o.timeout)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.cache.clear(),this.lastInvalidation=0},e}(),eE=n(97631),eT=/^(fatal: |error: |remote: error: |CONFLICT \([^)]+\): )/im,eR=/^cat: .*: No such file or directory$/im;function eI(e){return RegExp("^fatal: ".concat(e.source),"im")}function eD(e){return RegExp("^error: ".concat(e.source),"im")}var eG=[{error:eo.aq.NOT_INITIALIZED,match:[eI(/not a git repository/)]},{error:eo.aq.UNAUTHENTICATED,match:[eI(/Authentication failed/),eI(/unable to access/),eI(/repository \S+ not found/),eI(/could not read Username/),eI(/could not read Password/),eI(/Could not read from remote/)]},{error:eo.aq.INDEX_FILE_CORRUPT,match:[eI(/index file corrupt/),eI(/index file smaller than expected/),eD(/index file .*?\.idx is too small/)]},{error:eo.aq.UNKNOWN_REMOTE,match:[eI(/No such remote/),eD(/No such remote/)]},{error:eo.aq.INDEX_LOCKED,match:[eI(/Unable to create .*?\.git\/index\.lock/),eD(/Unable to create .*?\.git\/index\.lock/)]},{error:eo.aq.NO_COMMITS,match:[eI(/your current branch '.*?' does not have any commits yet/)]},{error:eo.aq.PATH_MATCHED_NO_FILES,match:[eI(/pathspec '.*?' did not match any files/),eI(/pathspec '.*?' did not match any file\(s\) known to git/),eI(/path '.*?' does not exist/),eI(/path '.*?' exists on disk, but not in/)]},{error:eo.aq.USER_NOT_CONFIGURED,match:[eI(/unable to auto-detect email address/),eI(/unable to auto-detect name/),eI(/empty ident name \(for <.*?>\) not allowed/)]},{error:eo.aq.INVALID_REFERENCE,match:[eI(/invalid reference: .*?$/),eI(/'.*?' - not a valid ref/)]},{error:eo.aq.BRANCH_ALREADY_EXISTS,match:[eI(/A branch named '.*?' already exists/)]},{error:eo.aq.MERGE_CONFLICT,match:[eI(/Not possible to fast-forward, aborting/),eI(/refusing to merge unrelated histories/),eI(/Exiting because of an unresolved conflict/),eI(/Exiting because of unfinished merge/),eD(/Failed to merge in the changes/),RegExp("^CONFLICT \\([^\\)]+\\): ".concat(/Merge conflict in/.source),"im")]},{error:eo.aq.UPSTREAM_NOT_SET,match:[eI(/The current branch \S+ has no upstream branch/),eI(/No configured push destination/)]},{error:eo.aq.HEAD_DETACHED,match:[eI(/HEAD does not point to a branch/),eI(/ref HEAD is not a symbolic ref/)]},{error:eo.aq.DIRTY_WORKTREE,match:[eD(/Your local changes to the following files would be overwritten/),eD(/The following untracked working tree files would be overwritten/),eD(/\S+ is not possible because you have unmerged files/),eD(/cannot rebase: You have unstaged changes/)]},{error:eo.aq.PROTECTED_BRANCH,match:[RegExp("^remote: error: ".concat(/.*? Protected branch update failed/.source),"im")]},{error:eo.aq.PUSH_REJECTED,match:[eD(/failed to push some refs to/)]},{error:eo.aq.REMOTE_ALREADY_EXISTS,match:[eI(/remote .*? already exists/),eD(/remote .*? already exists/)]},{error:eo.aq.INVALID_STATE,match:[eI(/There is no merge in progress/),eI(/There is no merge to abort/),eI(/No rebase in progress/)]}],eB=n(26572);function eP(){return(eP=(0,w._)(function(e,t,n,r){var i,o,a,l,c,s,u;return(0,S.Jh)(this,function(d){switch(d.label){case 0:if("open"!==e.status)return[2,{output:"JS Error\nchannel closed before command was run",error:eo.aq.CHANNEL_CLOSED}];d.label=1;case 1:return d.trys.push([1,3,,4]),i="",o=e.onCommand(function(e){null!==e.output&&void 0!==e.output&&(i+=e.output)}),a=void 0,(l=Promise.race([new Promise(function(e){return a=setTimeout(e,9e4)}),e.request({exec:{env:n,args:t,blocking:!0}})])).finally(function(){o(),clearTimeout(a)}),[4,l];case 2:if(void 0===(c=d.sent()))return H.kg.error("Git request timed out.",(0,Z._)({appService:"git",command:t,gitEnv:JSON.stringify(n),TIMEOUT:9e4},r)),[2,{output:i,error:eo.aq.TIMEOUT}];if(!c.ok&&c.channelClosed)return[2,{output:"JS Error\nchannel closed during command execution",error:eo.aq.CHANNEL_CLOSED}];if(c.error||!c.ok)return[2,{output:s="".concat(c.error,"\n").concat(i),error:function(e){if(eT.test(e)){for(var t=0;t<eG.length;t++)for(var n=0;n<eG[t].match.length;n++)if(eG[t].match[n].test(e))return eG[t].error;return eo.aq.UNKNOWN}return eR.test(e)?eo.aq.PATH_MATCHED_NO_FILES:eo.aq.UNKNOWN_NOT_GIT}(s)}];return[2,{output:i,error:null}];case 3:return u=d.sent(),B.$e(function(e){e.setTag("service","git"),e.setExtra("command",t),e.setExtra("env",n),r&&e.setExtra("options",r),B.Tb(u)}),[2,{output:"JS Error\n".concat(String(u)),error:eo.aq.UNKNOWN_NOT_GIT}];case 4:return[2]}})})).apply(this,arguments)}var eA=function(){"use strict";function e(t){var n=t.container,r=t.getEnv,i=t.awaitPromise,o=this;(0,W._)(this,e),this.cache=new e_(3e4,2e3),this.running=(0,M.u)(!1),this.queue=[],n.openChannel({service:"exec"},function(e){var t,n,a=e.channel,l=(t=(0,w._)(function(e,t){var n,o;return(0,S.Jh)(this,function(l){switch(l.label){case 0:if(0===e.length)throw Error("Expected at least one command");if(!i)return[3,2];return[4,i];case 1:l.sent(),l.label=2;case 2:return n=Date.now(),[4,function(e,t,n,r){return eP.apply(this,arguments)}(a,["bash","-c",Array.isArray(e)?e.join(" && "):e],r(),t)];case 3:if(o=l.sent(),(0,eE.J)(e,o,!1,n),o.error)return[2,o];return[2,{output:(null==t?void 0:t.verbatim)?o.output:o.output.trim(),error:null}]}})}),function(e,n){return t.apply(this,arguments)}),c=function(e,t){if(0===e.length)throw Error("Expected at least one command");var n=Array.isArray(e)?e.join(" && "):e;if(o.cache.has(n)){var r=o.cache.get(n);return r.then(function(t){(0,eE.J)(e,t,!0)}),r}var i=l(n,t);return o.cache.set(n,i),i},s=function(e,t){return o.cache.clear(),l(e,t)},u=(n=(0,w._)(function(){var e;return(0,S.Jh)(this,function(t){switch(t.label){case 0:if(!(o.queue.length>0)||"open"!==a.status)return[3,7];if(!(e=o.queue.shift()))return[3,6];if("read"!==e.type)return[3,2];return[4,e.fn(c)];case 1:case 3:return t.sent(),[3,6];case 2:if("write"!==e.type)return[3,4];return[4,e.fn(s)];case 4:return[4,e.fn(l)];case 5:t.sent(),t.label=6;case 6:return[3,0];case 7:return 0===o.queue.length&&o.running.set(!1),[2]}})}),function(){return n.apply(this,arguments)});return o.running.current&&u(),o.running.subscribe(function(e){e&&u()})})}var t=e.prototype;return t.add=function(e,t){var n,r=(0,eB.Z)();return this.queue.push({type:t,fn:(n=(0,w._)(function(t){var n;return(0,S.Jh)(this,function(i){switch(i.label){case 0:return[4,e(t)];case 1:return n=i.sent(),r.resolve(n),[2]}})}),function(e){return n.apply(this,arguments)})}),this.running.current||this.running.set(!0),r.promise},t.wrap=function(e,t){var n=this;if("function"!=typeof e)throw Error("Expected a function");return function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return n.add(function(t){return e.apply(void 0,[t].concat((0,X._)(i)))},t)}},e}(),eN=n(86763),eL=n.n(eN);function eU(e,t){return eO.apply(this,arguments)}function eO(){return(eO=(0,w._)(function(e,t){var n,r,i;return(0,S.Jh)(this,function(o){switch(o.label){case 0:if(n=t.name,r=t.url,n=(0,$.ss)(n),!(0,ed.GE)(n))return[2,{error:eo.aq.INVALID_REFERENCE}];return n=(0,$.Gw)(n),r=(0,$.Gw)(r),[4,e("git remote add ".concat(n," ").concat(r),{serviceMethod:"git-add-remote"})];case 1:if((i=o.sent()).error)return[2,i];return[2,{error:null}]}})})).apply(this,arguments)}function eM(e,t){return eX.apply(this,arguments)}function eX(){return(eX=(0,w._)(function(e,t){var n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:var i,o,a;return[4,e((i=t.message,o=t.files,a=["--allow-empty","--allow-empty-message","--cleanup=whitespace","--no-edit","--quiet","-m ".concat((0,$.Gw)(i))],o&&a.push.apply(a,["--only","--"].concat((0,X._)(o.map($.Gw)))),"git --literal-pathspecs commit ".concat(a.join(" "))),{serviceMethod:"git-commit"})];case 1:if((n=r.sent()).error)return[2,n];return[2,{error:null}]}})})).apply(this,arguments)}function eF(e,t){return eW.apply(this,arguments)}function eW(){return(eW=(0,w._)(function(e,t){var n,r,i,o,a,l;return(0,S.Jh)(this,function(c){switch(c.label){case 0:return[4,eh(e,t=(0,ed.Qj)(t,!0))];case 1:if((n=c.sent()).error)return[2,n];if(!n.exists)return[2,{error:eo.aq.INVALID_REFERENCE}];if(r=["--quiet","--no-guess"],n.ref.type!==ef.l.REMOTE_BRANCH)return[3,3];return i=n.ref.branch,o=n.ref.name,[4,eh(e,"refs/heads/".concat(i))];case 2:if((a=c.sent()).error)return[2,a];return a.exists?r.push((0,$.Gw)(i),"--"):r.push("-t","-b",(0,$.Gw)(i),(0,$.Gw)(o),"--"),[3,4];case 3:r.push((0,$.Gw)(n.ref.name),"--"),c.label=4;case 4:return[4,e("git checkout ".concat(r.join(" ")),{serviceMethod:"git-switch-branch"})];case 5:if((l=c.sent()).error)return[2,l];return[2,{error:null}]}})})).apply(this,arguments)}function eH(e,t){return eV.apply(this,arguments)}function eV(){return(eV=(0,w._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f;return(0,S.Jh)(this,function(h){switch(h.label){case 0:return n=t.name,i=void 0===(r=t.startPoint)?"HEAD":r,o=t.track,l=void 0!==(a=t.checkout)&&a,[4,eh(e,n=(0,$.C)(n))];case 1:if((c=h.sent()).error)return[2,c];if(c.exists)return[2,{error:eo.aq.BRANCH_ALREADY_EXISTS}];if("HEAD"===i){if(!0===o)return[2,{error:eo.aq.INVALID_REFERENCE}];o=!1}if(!(!1!==o))return[3,3];return[4,eh(e,i)];case 2:if((s=h.sent()).error)return[2,s];if(!s.exists&&!0===o)return[2,{error:eo.aq.INVALID_REFERENCE}];s.exists&&s.ref.type===ef.l.REMOTE_BRANCH&&void 0===o&&(o=!0),h.label=3;case 3:return u=["--quiet",o?"--track":"--no-track",(0,$.Gw)(n),(0,$.Gw)(i)],[4,e("git branch ".concat(u.join(" ")),{serviceMethod:"git-create-branch"})];case 4:if((d=h.sent()).error)return[2,d];if(!l)return[3,6];return[4,eF(e,n)];case 5:if((f=h.sent()).error)return[2,f];h.label=6;case 6:return[2,{error:null}]}})})).apply(this,arguments)}function ez(e){return ej.apply(this,arguments)}function ej(){return(ej=(0,w._)(function(e){var t,n,r,i,o=arguments;return(0,S.Jh)(this,function(a){switch(a.label){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:{},n=["--quiet"],t.depth&&(r=t.deepen?"--deepen":"--depth",n.push("".concat(r,"=").concat(t.depth))),t.remote?n.push((0,$.Gw)(t.remote)):n.push("--all"),[4,e("git fetch ".concat(n.join(" ")),{serviceMethod:"git-fetch"})];case 1:if((i=a.sent()).error)return[2,i];return[2,{error:null}]}})})).apply(this,arguments)}var eq=["main","master","trunk","dev","develop","development","staging","prod","production"].map(function(e){return'if [ $(git rev-parse --verify --quiet "heads/'.concat(e,'") ]; then\n      echo "refs/heads/').concat(e,'"\n    fi')}).join("\n"),eY='\ngit remote | while IFS= read -r remote; do\n  if [ -z "$remote" ]; then continue; fi\n  branch="$('.concat('\nif [ -f ".git/refs/remotes/$remote/HEAD" ]; then\n  echo "$(sed -e "s/^ref: refs\\/remotes\\/$remote\\///" < .git/refs/remotes/$remote/HEAD)"\nelse\n  remote_result="$(git ls-remote --symref "$remote" HEAD)"\n  if [ -z "$remote_result" ]; then\n    echo ""\n  else\n    echo "$(\n      echo "$remote_result" | \\\n      head -1 | \\\n      awk \'{print $2}\' | \\\n      sed -e "s/^refs\\/heads\\///"\n    )"\n  fi\nfi\n'.trim(),')"\n  if [ -z "$branch" ]; then continue; fi\n  echo "refs/remotes/$remote/$branch"\n  if [ $(git rev-parse --verify --quiet "heads/$branch") ]; then\n    echo "refs/heads/$branch"\n  fi\ndone\n').concat(eq,"\n").trim();function eJ(e){return eK.apply(this,arguments)}function eK(){return(eK=(0,w._)(function(e){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return[4,e(eY,{serviceMethod:"git-find-default-branches"})];case 1:if((t=n.sent()).error)return[2,t];return[2,{refs:(0,X._)(new Set((0,$.so)(t.output,"\n"))).map(function(e){return(0,ef.L)(e)}),error:null}]}})})).apply(this,arguments)}var e$=n(75647);function eQ(e,t){return e0.apply(this,arguments)}function e0(){return(e0=(0,w._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f,h;return(0,S.Jh)(this,function(p){switch(p.label){case 0:if(t=(0,ed.bF)(t,!0),!(0,ed.Dc)(t))return[2,{error:eo.aq.INVALID_REFERENCE}];return n=(0,$.C)(t),i=(r=(0,C._)((0,$.Tg)(t),2))[0],o=r[1],a=["refs/heads/".concat(n),"refs/remotes/*/".concat(n)],i&&o&&(a.push("refs/heads/".concat(o)),a.push("refs/remotes/".concat(i,"/").concat(o))),[4,(0,e$.ZP)(e,{pattern:a})];case 1:if((l=p.sent()).error)return[2,l];if(0===l.branches.length)return[2,{error:eo.aq.INVALID_REFERENCE}];c=!0,s=!1,u=void 0;try{for(d=l.branches[Symbol.iterator]();!(c=(f=d.next()).done);c=!0)if((h=f.value).type!==e$.HO.REMOTE&&h.name===n||i&&o&&h.type!==e$.HO.LOCAL&&h.remote===i&&h.name===o)return[2,{branch:h,error:null}]}catch(e){s=!0,u=e}finally{try{c||null==d.return||d.return()}finally{if(s)throw u}}return[2,{error:eo.aq.INVALID_REFERENCE}]}})})).apply(this,arguments)}var e1=n(19659);function e2(e,t){return e8.apply(this,arguments)}function e8(){return(e8=(0,w._)(function(e,t){var n,r,i,o,a;return(0,S.Jh)(this,function(l){switch(l.label){case 0:if(n=t.path,i=void 0===(r=t.revision)?"HEAD":r,""===n)return[2,{content:null,error:null}];return o=(0,$.Gw)("".concat(i,":").concat(n)),[4,e((0,e1.T3)(n)?"git --no-pager show ".concat(o," | base64"):"git --no-pager show ".concat(o),{verbatim:!0,serviceMethod:"git-get-file-contents"})];case 1:if((a=l.sent()).error){if(a.error===eo.aq.PATH_MATCHED_NO_FILES)return[2,{content:null,error:null}];return[2,a]}return[2,{content:a.output,error:null}]}})})).apply(this,arguments)}function e4(e){return e3.apply(this,arguments)}function e3(){return(e3=(0,w._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p;return(0,S.Jh)(this,function(m){switch(m.label){case 0:return[4,e("git remote -v",{serviceMethod:"git-get-remotes"})];case 1:if((t=m.sent()).error)return[2,t];if(""===t.output)return[2,{remotes:new Map,error:null}];n=new Map,r=!0,i=!1,o=void 0;try{for(a=(0,$.so)(t.output,"\n")[Symbol.iterator]();!(r=(l=a.next()).done);r=!0)c=l.value,u=(s=(0,C._)(c.split(/\s+/),3))[0],d=s[1],f=s[2],u&&d&&f&&(p=null!==(h=n.get(u))&&void 0!==h?h:{name:u,fetch:"",push:""},"(fetch)"===f?(p.fetch=d,""===p.push&&(p.push=d),n.set(u,p)):"(push)"===f&&(p.push=d,""===p.fetch&&(p.fetch=d),n.set(u,p)))}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return[2,{remotes:n,error:null}]}})})).apply(this,arguments)}var e5='git commit --allow-empty --no-edit --quiet -m "Initial commit"',e6='git add -A && git commit --allow-empty --no-edit --quiet -m "Initial commit"';function e9(e){return e7.apply(this,arguments)}function e7(){return(e7=(0,w._)(function(e){var t,n,r,i,o,a,l,c,s,u=arguments;return(0,S.Jh)(this,function(d){switch(d.label){case 0:return r=void 0===(n=(t=u.length>1&&void 0!==u[1]?u[1]:{}).initialCommit)||n,o=void 0===(i=t.includeAllInitialFiles)||i,[4,(0,ei.ZP)(e)];case 1:if((a=d.sent()).error)return[2,a];if(a.type!==ei.y5.INITIALIZING)return[2,{error:eo.aq.ALREADY_INITIALIZED}];if(a.state!==ei.yG.ON_UNBORN_BRANCH)return[3,4];if(!r)return[3,3];return[4,e(o?e6:e5,{serviceMethod:"git-init"})];case 2:if((l=d.sent()).error)return[2,l];d.label=3;case 3:return[2,{error:null}];case 4:return[4,e(["git init","git checkout -b main"],{serviceMethod:"git-init"})];case 5:if((c=d.sent()).error)return[2,c];if(!r)return[3,7];return[4,e(o?e6:e5,{serviceMethod:"git-init"})];case 6:if((s=d.sent()).error)return[2,s];d.label=7;case 7:return[2,{error:null}]}})})).apply(this,arguments)}function te(e){return tt.apply(this,arguments)}function tt(){return(tt=(0,w._)(function(e){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return[4,e("git rev-parse --is-inside-work-tree",{serviceMethod:"git-is-initialized"})];case 1:if((t=n.sent()).error){if(t.error===eo.aq.NOT_INITIALIZED)return[2,{initialized:!1,error:null}];return[2,t]}return[2,{initialized:"true"===t.output,error:null}]}})})).apply(this,arguments)}function tn(e){var t=(0,C._)(e.trimStart().split("\x1f"),11),n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],l=t[5],c=t[6],s=t[7],u=t[8],d=t[9],f=t[10],h=[],p=i?i.split(" "):null,m=!1,v=!0,g=!1,y=void 0;try{for(var b,w=(0,$.so)(n,",")[Symbol.iterator]();!(v=(b=w.next()).done);v=!0){var Z=b.value;if("grafted"===Z){m=!0;continue}h.push((0,ef.L)(Z))}}catch(e){g=!0,y=e}finally{try{v||null==w.return||w.return()}finally{if(g)throw y}}return{refs:h,hash:r,parents:p,grafted:m,author:{name:o,email:a,date:1e3*parseInt(l,10)},committer:{name:c,email:s,date:1e3*parseInt(u,10)},subject:d?d.trim():"",body:f?f.trim():""}}function tr(e){return ti.apply(this,arguments)}function ti(){return(ti=(0,w._)(function(e){var t,n=arguments;return(0,S.Jh)(this,function(r){switch(r.label){case 0:var i,o,a,l,c,s,u;return[4,e((a=void 0===(o=(i=n.length>1&&void 0!==n[1]?n[1]:{}).max)?25:o,l=i.skip,c=i.revRange,s=i.path,u=["-z","--decorate=full","--full-history",'--format="format:%D%x1f%H%x1f%P%x1f%an%x1f%ae%x1f%at%x1f%cn%x1f%ce%x1f%ct%x1f%s%x1f%b"'],a=Math.max(1,Math.min(a,200)),u.push("-n ".concat(a)),l&&u.push("--skip ".concat(l)),c&&u.push(c),u.push("--"),s&&u.push(s),"git log ".concat(u.join(" "))),{serviceMethod:"git-log"})];case 1:if((t=r.sent()).error){if(t.error===eo.aq.NO_COMMITS)return[2,{commits:[],error:null}];return[2,t]}return[2,{commits:(0,$.so)(t.output,"\x00").map(tn),error:null}]}})})).apply(this,arguments)}function to(e){return ta.apply(this,arguments)}function ta(){return(ta=(0,w._)(function(e){var t,n=arguments;return(0,S.Jh)(this,function(r){switch(r.label){case 0:return[4,e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];return e.cached&&t.push("--cached"),e.deleted&&t.push("--deleted"),e.modified&&t.push("--modified"),e.others&&t.push("--others"),e.ignored&&t.push("--ignored"),e.directory&&t.push("--directory"),e.noEmptyDirectory&&t.push("--no-empty-directory"),"git ls-files ".concat(t.join(" "))}(n.length>1&&void 0!==n[1]?n[1]:{}),{serviceMethod:"git-ls-files"})];case 1:if((t=r.sent()).error)return[2,t];return[2,{files:t.output.split("\n").filter(function(e){return e.length>0}),error:null}]}})})).apply(this,arguments)}var tl=n(91075);function tc(e){return ts.apply(this,arguments)}function ts(){return(ts=(0,w._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f=arguments;return(0,S.Jh)(this,function(h){switch(h.label){case 0:return t=f.length>1&&void 0!==f[1]?f[1]:{},[4,(0,eC.Z)(e)];case 1:if((n=h.sent()).error)return[2,n];if(!n.branch)return[2,{error:eo.aq.HEAD_DETACHED}];if(r=null,i=null,t.publish){if(n.upstream)return[2,{error:eo.aq.BRANCH_ALREADY_EXISTS}];r=t.publish.remote,i=null!==(o=t.publish.name)&&void 0!==o?o:n.branch,r=(0,$.C)(r),i=(0,$.C)(i)}else{if(!n.upstream)return[2,{error:eo.aq.UPSTREAM_NOT_SET}];if(!t.force&&n.upstream.behind>0)return[2,{error:eo.aq.PUSH_REJECTED}];r=(a=(0,C._)((0,$.Tg)(n.upstream.branch),2))[0],i=a[1]}if(!r||!i)return[2,{error:eo.aq.UPSTREAM_NOT_SET}];if(t.force)return[3,3];return[4,ez(e,{remote:r})];case 2:if((l=h.sent()).error)return[2,l];h.label=3;case 3:if(!t.publish)return[3,5];return[4,eh(e,"refs/remotes/".concat(r,"/").concat(i))];case 4:if((c=h.sent()).error)return[2,c];if(c.exists&&c.ref.type===ef.l.REMOTE_BRANCH)return[2,{error:eo.aq.BRANCH_ALREADY_EXISTS}];h.label=5;case 5:return s=["--quiet"],t.force&&!t.publish&&s.push("--force-with-lease"),t.publish&&s.push("--set-upstream"),u="refs/heads/".concat(n.branch,":refs/heads/").concat(i),s.push((0,$.Gw)(r),(0,$.Gw)(u)),[4,e("git push ".concat(s.join(" ")),{serviceMethod:"git-push"})];case 6:if((d=h.sent()).error)return[2,d];return[2,{error:null}]}})})).apply(this,arguments)}function tu(e,t){return td.apply(this,arguments)}function td(){return(td=(0,w._)(function(e,t){var n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:if(t=(0,$.ss)(t),!(0,ed.GE)(t))return[2,{error:eo.aq.INVALID_REFERENCE}];return[4,e("git remote rm ".concat((0,$.Gw)(t)),{serviceMethod:"git-remove-remote"})];case 1:if((n=r.sent()).error)return[2,n];return[2,{error:null}]}})})).apply(this,arguments)}function tf(e,t){return th.apply(this,arguments)}function th(){return(th=(0,w._)(function(e,t){var n,r,i;return(0,S.Jh)(this,function(o){switch(o.label){case 0:if(n=t.remote,r=t.url,n=(0,$.ss)(n),!(0,ed.GE)(n)||!(0,ed.LY)(r))return[2,{error:eo.aq.INVALID_REFERENCE}];return n=(0,$.Gw)(n),r=(0,$.Gw)(r),[4,e("git remote set-url ".concat(n," ").concat(r),{serviceMethod:"git-set-remote-url"})];case 1:if((i=o.sent()).error)return[2,i];return[2,{error:null}]}})})).apply(this,arguments)}function tp(e,t){return tm.apply(this,arguments)}function tm(){return(tm=(0,w._)(function(e,t){var n,r;return(0,S.Jh)(this,function(i){switch(i.label){case 0:if(!(n=function(e){if("all"in e)return e.all?["git add -A"]:["git reset -q -- ."];var t=e.add,n=e.reset;if(!(null==t?void 0:t.length)&&!(null==n?void 0:n.length))return null;var r=[];if(t){var i=t.map($.Gw).join(" ");r.push("git --literal-pathspecs add -- ".concat(i))}if(n){var o=n.map($.Gw).join(" ");r.push("git --literal-pathspecs reset -q -- ".concat(o))}return r}(t)))return[2,{error:null}];return[4,e(n,{serviceMethod:"git-stage-files"})];case 1:if((r=i.sent()).error)return[2,r];return[2,{error:null}]}})})).apply(this,arguments)}var tv=n(3720),tg=n(63043),ty=n(21262),tb=n(71440);function tw(){var e=(0,ty._)(['\n  fragment GitServiceGitHubUser on CurrentUser {\n    image\n    username\n    email\n    gitHubInfo {\n      accessToken\n      userInfo {\n        username\n        email\n        avatarUrl\n      }\n    }\n    repositories(count: 1, after: "0") {\n      ... on RepositoryConnection {\n        items {\n          id\n        }\n      }\n    }\n  }\n']);return tw=function(){return e},e}function tZ(){var e=(0,ty._)(["\n  query GitServiceCurrentUser {\n    currentUser {\n      id\n      ...GitServiceGitHubUser\n    }\n  }\n  ","\n"]);return tZ=function(){return e},e}var tx=(0,tb.Ps)(tw()),tC=(0,tb.Ps)(tZ(),tx);function tS(e){return tk.apply(this,arguments)}function tk(){return(tk=(0,w._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y;return(0,S.Jh)(this,function(b){switch(b.label){case 0:return t=e.defaultUsername,n=e.defaultUserId,r=e.onProfiles,a=new Map,[4,null===tv.l||void 0===tv.l?void 0:tv.l.query({query:tC,fetchPolicy:"network-only",context:{noBatch:!0}})];case 1:var w,Z;return d=(u=null!==(s=null==(c=(null!==(l=b.sent())&&void 0!==l?l:{data:null}).data)?void 0:c.currentUser)&&void 0!==s?s:{username:t,id:n}).id,f=u.username,d&&f&&(m={provider:eo.rG.REPLIT_DEFAULT,email:"".concat(d,"-").concat(f,"@").concat(tg.J),username:f,avatar:null!==(p=null==c?void 0:null===(h=c.currentUser)||void 0===h?void 0:h.image)&&void 0!==p?p:null},a.set(m.provider,m)),(v=null==c?void 0:null===(o=c.currentUser)||void 0===o?void 0:null===(i=o.gitHubInfo)||void 0===i?void 0:i.userInfo)&&v.email&&v.username&&(null==c?void 0:null===(Z=c.currentUser)||void 0===Z?void 0:null===(w=Z.repositories)||void 0===w?void 0:w.__typename)==="RepositoryConnection"&&(y={provider:eo.rG.GITHUB,email:v.email,username:v.username,avatar:null!==(g=v.avatarUrl)&&void 0!==g?g:null},a.set(y.provider,y)),r(a),[2]}})})).apply(this,arguments)}function t_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.author,n=e.committer,r={GIT_AUTHOR_NAME:"",GIT_AUTHOR_EMAIL:"",GIT_COMMITTER_NAME:"",GIT_COMMITTER_EMAIL:"",GIT_ASKPASS:"replit-git-askpass",GIT_PAGER:"",GIT_EDITOR:"",PAGER:"",EDITOR:""};if(t){r.GIT_AUTHOR_NAME=t.username,r.GIT_COMMITTER_NAME=t.username;var i=tE(t);r.GIT_AUTHOR_EMAIL=i,r.GIT_COMMITTER_EMAIL=i,n&&(r.GIT_COMMITTER_NAME=n.username,r.GIT_COMMITTER_EMAIL=tE(n))}return r}function tE(e){if("id"in e)return"".concat(e.id,"-").concat(e.username,"@users.noreply.replit.com");if("email"in e)return e.email;throw Error("Invalid user")}var tT=n(39756),tR=n(30084),tI=".git",tD=n(78104),tG=n(36098),tB=n(16412),tP=n.n(tB),tA=n(15482),tN=n(3341),tL=n.n(tN),tU=n(72526),tO=n(98924),tM=n(59510),tX=n.n(tM),tF=n(35554),tW=n.n(tF),tH=n(74207),tV=n(19012),tz=function(e){var t=e.configurationSupport;return{textDocument:{synchronization:{dynamicRegistration:!0,didSave:!0},signatureHelp:{dynamicRegistration:!0,signatureInformation:{documentationFormat:["markdown","plaintext"]}},publishDiagnostics:{relatedInformation:!0,tagSupport:{valueSet:[1,2]}},formatting:{dynamicRegistration:!0},documentSymbol:{dynamicRegistration:!0,hierarchicalDocumentSymbolSupport:!0,symbolKind:{valueSet:tV.Z}},definition:{dynamicRegistration:!0,linkSupport:!0},typeDefinition:{dynamicRegistration:!0},implementation:{dynamicRegistration:!0},references:{dynamicRegistration:!0},rename:{dynamicRegistration:!0,prepareSupport:!0},completion:{dynamicRegistration:!0,contextSupport:!0,completionItem:{documentationFormat:["markdown","plaintext"],labelDetailsSupport:!0,resolveSupport:{properties:["detail","documentation"]},snippetSupport:!0}},codeAction:{resolveSupport:{properties:["edit"]},dataSupport:!0,dynamicRegistration:!0,isPreferredSupport:!0,codeActionLiteralSupport:{codeActionKind:{valueSet:Object.values(tH.CodeActionKind)}}},hover:{dynamicRegistration:!0,contentFormat:["markdown","plaintext"]}},workspace:{applyEdit:!0,didChangeConfiguration:t.clientToServer||t.serverToClient?{dynamicRegistration:!0}:void 0,configuration:t.serverToClient,executeCommand:{dynamicRegistration:!0},workspaceEdit:{documentChanges:!0,resourceOperations:[tH.ResourceOperationKind.Create,tH.ResourceOperationKind.Delete,tH.ResourceOperationKind.Rename]}}}},tj=n(8701),tq=n(73164),tY=function(){"use strict";function e(){(0,W._)(this,e)}var t=e.prototype;return t.supports=function(e){return e.includes("css-language-server")},t.onResponse=function(e,t){return"textDocument/hover"===e?this.onHover(t):t},t.onHover=function(e){if("error"in e)return e;var t=e.result;return"cancelled"in e&&!1!==e.cancelled||!t?e:(Array.isArray(t.contents)&&(t.contents={kind:"markdown",value:["```html",t.contents[0],"```",t.contents[1],""].join("\n")}),(0,x._)((0,Z._)({},e),{result:t}))},e}(),tJ=[new(function(){"use strict";function e(){(0,W._)(this,e)}var t=e.prototype;return t.supports=function(e){return e.includes("typescript-language-server")},t.onResponse=function(e,t){return"textDocument/completion"===e?this.onCompletion(t):t},t.onCompletion=function(e){if("error"in e||"cancelled"in e&&!1!==e.cancelled)return e;var t=e.result;if(!t)return e;Array.isArray(t)&&(t={isIncomplete:!1,items:t});for(var n=0;n<t.items.length;n++){var r=t.items[n];r.sortText&&r.sortText.startsWith("")&&(r.sortText=r.sortText.replace("",""))}return(0,x._)((0,Z._)({},e),{result:t})},e}()),new tY],tK=function(){"use strict";function e(){(0,W._)(this,e)}var t=e.prototype;return t.supports=function(){return!0},t.onResponse=function(e,t){return t},e}(),t$=n(79543),tQ=n(74106),t0=n(91620).lW;function t1(e,t){var n,r;return null!==(r=null===(n=tq.$R.from(e))||void 0===n?void 0:n.id)&&void 0!==r?r:t}function t2(){return Math.floor(2147483647*Math.random())}function t8(e){var t=JSON.stringify((0,x._)((0,Z._)({},e),{jsonrpc:"2.0"})),n=t0.byteLength(t,"utf8");return"Content-Length: ".concat(n,"\r\n\r\n").concat(t)}function t4(e,t){var n,r,i,o,a,l;return t&&t?!!(tL()(null==e?void 0:e.fileTypeAttrs,t.fileTypeAttrs)&&tL()(null==e?void 0:null===(n=e.config)||void 0===n?void 0:n.startCommand,null===(r=t.config)||void 0===r?void 0:r.startCommand)&&tL()(null==e?void 0:null===(i=e.config)||void 0===i?void 0:i.initializationOptionsJson,null===(o=t.config)||void 0===o?void 0:o.initializationOptionsJson)&&tL()(null==e?void 0:null===(a=e.config)||void 0===a?void 0:a.configurationJson,null===(l=t.config)||void 0===l?void 0:l.configurationJson)):!!t==!!t}function t3(e,t){return t5.apply(this,arguments)}function t5(){return(t5=(0,w._)(function(e,t){var n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:return[4,e.exec("pwd")];case 1:if(null!==(n=r.sent()).error){if(!t())return[2,{error:Error("LSPNix: Could not get working directory "+n.error),workingDirectory:null}];return[2,t3(e,t)]}return[2,{error:null,workingDirectory:n.output.replace("\n","")}]}})})).apply(this,arguments)}(o=h||(h={})).INITIALIZED="INITIALIZED",o.READY="READY",o.DIAGNOSTICS="DIAGNOSTICS",o.SERVER_STATE_CHANGE="SERVER_STATE_CHANGE",o.SERVER_HEALTH_CHANGE="SERVER_HEALTH_CHANGE",o.SERVER_CAPABILITIES_CHANGE="SERVER_CAPABILITIES_CHANGE",o.REQUEST="REQUEST",o.RESPONSE="RESPONSE",o.CANCEL_REQUEST="CANCEL_REQUEST",o.SEND_NOTIFICATION="SEND_NOTIFICATION",o.RECEIVE_NOTIFICATION="RECEIVE_NOTIFICATION",(a=p||(p={})).OUTPUT="OUTPUT",a.ERROR="ERROR",a.STATE_CHANGED="STATE_CHANGED",a.CHANNEL_OPENED="CHANNEL_OPENED";var t6=n(80388);(l=m||(m={})).USER_JOIN="USER_JOIN",l.USER_LEAVE="USER_LEAVE",l.USERS_UPDATE="USERS_UPDATE",l.USER_OPENED_FILE="USER_OPENED_FILE",l.FOLLOWED_USER_CHANGED="FOLLOWED_USER_CHANGED",l.FOLLOWING_USERS_CHANGED="FOLLOWING_USERS_CHANGED";var t9=n(32902),t7=n(1660);function ne(){var e=(0,ty._)(["\n  query GitHubAuth {\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n      }\n    }\n  }\n"]);return ne=function(){return e},e}var nt=(0,tb.Ps)(ne());function nn(){return(nn=(0,w._)(function(){var e;return(0,S.Jh)(this,function(t){switch(t.label){case 0:if(!tv.l)throw Error("Expected apollo");return[4,tv.l.query({query:nt})];case 1:if(!(null==(e=t.sent().data)?void 0:e.currentUser))throw Error("Expected current user");return[2,e.currentUser]}})})).apply(this,arguments)}function nr(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}var ni=n(18107),no=n(12130),na=n(64461),nl=n(92674),nc=n.n(nl);(v||(v={})).MESSAGE="MESSAGE";var ns=function(){"use strict";function e(t){(0,W._)(this,e),this.buffer=Array(t).fill(null),this.start=0,this.end=0,this.isFull=!1}var t=e.prototype;return t.write=function(e){this.buffer[this.end]=e,this.end=(this.end+1)%this.buffer.length,this.isFull&&(this.start=(this.start+1)%this.buffer.length),this.end===this.start&&(this.isFull=!0)},t.readAll=function(){return this.start!==this.end||this.isFull?this.start<this.end?this.buffer.slice(this.start,this.end).join(""):this.buffer.slice(this.start).concat(this.buffer.slice(0,this.end)).join(""):""},e}();function nu(e){var t=new ns(e.maxHistorySize),n=(0,P.ZP)();return{emitMessage:function(e){t.write(e),n.emit("MESSAGE",e)},onMessage:function(e){return n.on("MESSAGE",e),Promise.resolve().then(function(){return e(t.readAll())}),function(){return n.removeListener("MESSAGE",e)}}}}function nd(e){return 1e3*e.seconds+e.nanos/1e6}var nf="\x1b[?25l";(c=g||(g={})).BEFORE_RUN="BEFORE_RUN",c.SERVER="SERVER",c.NONE="NONE",c.STOPPING="STOPPING";var nh=n(17789);(s=y||(y={})).DEEPLINK_CHANGED="DEEPLINK_CHANGED",s.SESSION_STATE_CHANGED="SESSION_STATE_CHANGED";var np=n(42516),nm=n(45077);function nv(e){var t=function(e){var t=k.D.active();if(e.openTelemetryTracing)return(0,D.eh)(t,"workspace.useCreateServices")}(e),n=(0,C._)((0,R.useState)(function(){var n,r,i,o,a,l,c,s,u,h,v,g,R,L,W,V,z,j,q,$,ee,et,er,el,eu,ed,ef,ep,ev,ey,ew,ex,ek,e_,eE,eT,eR,eI,eD,eG,eB,eP,eN,eO,eX,eW,eV,ej,eq,eY,eK,e0,e8,e3,e5,e6,e7,tt,tn,ti,ta,ts,td,th,tm,tv,tg,ty,tb,tw,tZ,tx,tC,tk,tE,tB,tN,tL,tM;return eO=(n=(0,x._)((0,Z._)({},e),{ctx:null==t?void 0:t.childCtx})).riverCtx,eW=void 0===(eX=n.runnerMode)?"outputs":eX,eV=n.onUnrecoverableError,ej=n.openFile,eq=n.openMultipleFiles,eY=n.openMultipleURLs,eK=n.onFirewallDenied,e0=n.channelRequestPriority,e8=n.enableUserEvents,e3=n.enableMultipleLSPClientsPerFile,e5=n.autoUpdateDotReplitOnPortInfo,e6=n.onPresenceCommand,e7=n.getColorForUser,tt=n.openTelemetryTracing,tn=n.ctx,ta=function(e){var t=e.container,n=e.enabled,r=e.onEventSent,i=(0,P.ZP)();r&&i.on(b.EVENT_SENT,r);var o=null;function a(e,t){return l.apply(this,arguments)}function l(){return(l=(0,w._)(function(e,r){var o,a,l,s,u,d,f,h;return(0,S.Jh)(this,function(p){switch(p.label){case 0:if(!n)return[2];return[4,function(){return c.apply(this,arguments)}()];case 1:if(l=p.sent(),u=null==(s=t.getContext())?void 0:null===(o=s.currentUser)||void 0===o?void 0:o.id,d=null==s?void 0:null===(a=s.repl)||void 0===a?void 0:a.id,f=window.location.href,h={userEvent:{eventName:e,eventData:function e(t){if(!("object"==typeof t&&null!==t&&null!==Object.getPrototypeOf(t)))throw Error("encodeBareStruct must be called with a plain object");return{fields:Object.entries(t).reduce(function(t,n){var r=(0,C._)(n,2),i=r[0],o=r[1];return void 0===o||"object"==typeof o&&o&&0===Object.keys(o).length?t:(0,x._)((0,Z._)({},t),(0,np._)({},i,function t(n){switch(void 0===n?"undefined":(0,nm._)(n)){case"string":return{kind:"stringValue",stringValue:n};case"number":return{kind:"numberValue",numberValue:n};case"boolean":return{kind:"boolValue",boolValue:n};case"object":if(null===n)return{kind:"nullValue",nullValue:null};if(Array.isArray(n))return{kind:"listValue",listValue:{values:n.map(t)}};return{kind:"structValue",structValue:e(n)};default:throw Error("Unexpected value: ".concat(n))}}(o)))},{})}}((0,Z._)({userId:u,replId:d,url:f},r))}},"open"!==l.status)return B.$e(function(e){e.setTag("service","user-events"),e.setExtra("command",h),e.setExtra("userId",u),e.setExtra("replId",d),e.setExtra("url",f),e.setExtra("channelId",l.id),B.Tb(Error("UserEvents channel is not open: ".concat(l.status)))}),[2];return i.emit(b.EVENT_SENT,e,r),l.send(h),[2]}})})).apply(this,arguments)}function c(){return(c=(0,w._)(function(){return(0,S.Jh)(this,function(e){return o?[2,o]:[2,new Promise(function(e){i.once(b.CHANNEL_OPENED,function(t){e(t)})})]})})).apply(this,arguments)}return a("meta:start",{}),t.openChannel({service:"null",skip:function(){return!n}},function(e){var t=e.channel;return a("meta:ready",{}),o=t,i.emit(b.CHANNEL_OPENED,t),function(){o=null}}),{emit:a}}({container:ti=(0,O.ZP)({riverCtx:eO,onUnrecoverableError:eV,onFirewallDenied:eK,ctx:tn}),enabled:!!(void 0!==e8&&e8)}),ts=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,P.ZP)();t.setMaxListeners(1e3);var n=null,r={openFiles:[],activeTab:0};function i(e){tX()(r,e)||(r=e,t.emit(y.SESSION_STATE_CHANGED,r))}return{onSessionStateChanged:function(e){return t.on(y.SESSION_STATE_CHANGED,e),function(){t.removeListener(y.SESSION_STATE_CHANGED,e)}},onDeeplinkUpdated:function(e){return t.on(y.DEEPLINK_CHANGED,e),n&&(e(n),n=null),function(){t.removeListener(y.DEEPLINK_CHANGED,e)}},openFile:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e.openFile){e.openFile({path:t,newTab:n.newTab,newPane:n.newPane,newPaneEdge:n.newPaneEdge,col:n.col,line:n.line});return}var o=n.tabIndex,a=n.newTab;if(void 0!==o){!function(e,t){var n=t||r.openFiles.length;if(e<0||e>=n||!Number.isInteger(e))throw Error("Invalid index: ".concat(e,". Index must be an integer between 0 and ").concat(n))}(o,r.openFiles.length+1);var l=r.openFiles.slice(),c=r.openFiles.indexOf(t);if(-1===c){l.splice(o,1,t),i({openFiles:l,activeTab:l.indexOf(t)});return}if(c===o){i((0,x._)((0,Z._)({},r),{activeTab:l.indexOf(t)}));return}l.splice(c,1),l.splice(o,0,t);var s=l.indexOf(t);i({openFiles:l,activeTab:s});return}if(r.openFiles.includes(t)){i((0,x._)((0,Z._)({},r),{activeTab:r.openFiles.indexOf(t)}));return}var u=r.openFiles.slice();if(a){var d=0===u.length?0:r.activeTab+1;u.splice(d,0,t),i({openFiles:u,activeTab:d});return}var f=r.activeTab;u.splice(f,1,t),i({openFiles:u,activeTab:f})},updateDeeplink:function(e){t.emit(y.DEEPLINK_CHANGED,e),n=e},getActiveFile:function(){var e=r.openFiles,t=r.activeTab;if(0!==e.length)return e[t]},getState:function(){return r}}}({openFile:ej}),td=(0,K.Z)({container:ti,channelRequestPriority:null==e0?void 0:e0.fs}),th=function(e){var t=e.container,n=e.onCommand,r=e.getColorForUser,i=(0,P.ZP)();i.setMaxListeners(1/0);var o=[],a=null,l=[],c={},s=null;function u(){return d.apply(this,arguments)}function d(){return(d=(0,w._)(function(){return(0,S.Jh)(this,function(e){return s?[2,s]:[2,new Promise(function(e){i.once(m.USERS_UPDATE,function(){if(!s)throw Error("Expected presenceChannel to be set");e(s)})})]})})).apply(this,arguments)}function f(e){tX()(a,e)||(a=e,i.emit(m.FOLLOWED_USER_CHANGED,e))}function h(){return(h=(0,w._)(function(e){var t,n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:if((null==a?void 0:a.username)===e)throw Error("Already following user with username ".concat(e));if(!a)return[3,2];return[4,p()];case 1:r.sent(),r.label=2;case 2:return[4,u()];case 3:if(t=r.sent(),!(n=o.find(function(t){return t.username===e})))return[2];return f(n),n.sessions.forEach(function(e){t.send({followUser:{session:e.id}})}),[2]}})})).apply(this,arguments)}function p(){return v.apply(this,arguments)}function v(){return(v=(0,w._)(function(){var e,t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:if(!a)throw Error("No user to unfollow");return e=a,f(null),[4,u()];case 1:return t=n.sent(),e.sessions.forEach(function(e){t.send({unfollowUser:{session:e.id}})}),[2]}})})).apply(this,arguments)}return t.openChannel({service:"presence",name:"presencer"},function(e){var t=e.channel;return t.onCommand(function(e){null==n||n(e);var t={cmd:e,emitter:i,activeUsers:o,userIdToFile:c,followedUser:a,setFollowedUser:f,followingUsers:l,getColorForUser:r};switch(e.body){case"roster":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.followedUser,a=e.followingUsers,l=e.setFollowedUser,c=e.getColorForUser,s=t.roster;if(s){var u=s.user,d=s.files;if(u&&d){var f=new Set;if(r.splice(0,r.length),u.forEach(function(e){if(!(!e.id||!e.name||!e.roles||f.has(e.id))){var t=d.filter(function(t){return t.userId===e.id}).map(function(e){if(!e.session||!e.timestamp)throw Error("Expected session and associated with user");return{id:e.session,activeFile:e.file||null,timestamp:(0,t6.gs)(e.timestamp)}}),n=null==c?void 0:c({userId:e.id});r.push({id:e.id,username:e.name,roles:e.roles,color:null!=n?n:(0,t6.i7)(r),sessions:t}),f.add(e.id)}}),r.forEach(function(e){i[e.id]=(0,t6.f0)(e)}),n.emit(m.USERS_UPDATE,(0,X._)(r)),a.filter(function(e){return!r.some(function(t){return t.id===e.id})}).forEach(function(e){var t=a.indexOf(e);-1!==t&&(a.splice(t,1),n.emit(m.FOLLOWING_USERS_CHANGED,{followingUsers:(0,X._)(a),user:e,type:"unfollow"}))}),o){if(!r.some(function(e){return e.id===o.id})){l(null);return}var h=i[o.id];n.emit(m.USER_OPENED_FILE,{user:o,file:h})}}}}(t);break;case"join":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.getColorForUser,a=t.join;if(a.id&&a.name&&a.roles&&a.session){var l=r.find(function(e){return e.id===a.id}),c=Math.floor(Date.now()/1e3),s=_.google.protobuf.Timestamp.create({seconds:c}),u=(0,t6.gs)(s);if(l)l.sessions.push({id:a.session,activeFile:null,timestamp:u});else{var d=null==o?void 0:o({userId:a.id}),f={id:a.id,username:a.name,roles:a.roles,color:null!=d?d:(0,t6.i7)(r),sessions:[{id:a.session,activeFile:null,timestamp:u}]};i[a.id]=null,r.push(f),n.emit(m.USER_JOIN,f),n.emit(m.USERS_UPDATE,(0,X._)(r))}}}(t);break;case"part":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=e.followedUser,a=e.followingUsers,l=e.setFollowedUser;if(t.part&&t.part.id&&t.part.session){var c=t.part,s=c.id,u=c.session,d=r.findIndex(function(e){return e.id===s}),f=r[d];if(1===f.sessions.length){r.splice(d,1),delete i[f.id],n.emit(m.USER_LEAVE,f),n.emit(m.USERS_UPDATE,(0,X._)(r)),o&&l(null);var h=a.findIndex(function(e){return e.id===f.id});-1!==h&&(a.splice(h,1),n.emit(m.FOLLOWING_USERS_CHANGED,{followingUsers:(0,X._)(a),user:f,type:"unfollow"}))}else{f.sessions=f.sessions.filter(function(e){return e.id!==u});var p=(0,t6.f0)(f);i[f.id]!==p&&(i[f.id]=p,n.emit(m.USER_OPENED_FILE,{user:f,file:p}))}}}(t);break;case"fileOpened":!function(e){var t=e.emitter,n=e.cmd,r=e.activeUsers,i=e.userIdToFile;if(n.fileOpened){var o=n.fileOpened,a=o.userId,l=o.file,c=o.timestamp,s=o.session,u=l||null;if(!a||!c)throw Error("Expected userId and timestamp associated with file opened command");var d=r.find(function(e){return e.id===a});if(!d)throw Error("Expected user with ID ".concat(a));var f=d.sessions.find(function(e){return e.id===s});if(!f)throw Error("Expected session with ID ".concat(f));f.activeFile=u,f.timestamp=(0,t6.gs)(c),i[a]=u,t.emit(m.USER_OPENED_FILE,{user:d,file:u})}}(t);break;case"followUser":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.followingUsers,o=t.followUser;if(!o.session)throw Error("Expected session associated with follow user");var a=o.session,l=(0,t6.N5)(a,r);i.some(function(e){return e.id===l.id})||(i.push(l),n.emit(m.FOLLOWING_USERS_CHANGED,{followingUsers:(0,X._)(i),user:l,type:"follow"}))}(t);break;case"unfollowUser":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.followingUsers,o=t.unfollowUser;if(!o.session)throw Error("Expected session associated with follow user");var a=o.session,l=(0,t6.N5)(a,r),c=i.findIndex(function(e){return e.id===l.id});-1!==c&&(i.splice(c,1),n.emit(m.FOLLOWING_USERS_CHANGED,{followingUsers:(0,X._)(i),user:l,type:"unfollow"}))}(t);break;case"sessionTimestampUpdated":!function(e){var t=e.cmd,n=e.emitter,r=e.activeUsers,i=e.userIdToFile,o=t.sessionTimestampUpdated;if(!o.session||!o.timestamp)throw Error("Expected session and tiemstamp associated with update");var a=o.session,l=(0,t6.N5)(a,r),c=i[l.id],s=l.sessions.find(function(e){return e.id===a});if(!s)throw Error("Expected user ".concat(l.id," to have a session with ID ").concat(a));s.timestamp=(0,t6.gs)(o.timestamp);var u=s.activeFile;u!==c&&(i[l.id]=u,n.emit(m.USER_OPENED_FILE,{user:l,file:u}))}(t)}}),s=t,function(){s=null}}),{onUserLeave:function(e){return i.on(m.USER_LEAVE,e),function(){i.removeListener(m.USER_LEAVE,e)}},onUserJoin:function(e){return i.on(m.USER_JOIN,e),function(){i.removeListener(m.USER_LEAVE,e)}},onActiveUsersChange:function(e){return i.on(m.USERS_UPDATE,e),function(){i.removeListener(m.USERS_UPDATE,e)}},onUserOpenedFile:function(e){return i.on(m.USER_OPENED_FILE,e),function(){i.removeListener(m.USER_OPENED_FILE,e)}},onFollowedUserChanged:function(e){return i.on(m.FOLLOWED_USER_CHANGED,e),function(){i.removeListener(m.FOLLOWED_USER_CHANGED,e)}},onFollowingUsersChanged:function(e){return i.on(m.FOLLOWING_USERS_CHANGED,e),function(){i.removeListener(m.FOLLOWING_USERS_CHANGED,e)}},getActiveFileForUser:function(e){var t=c[e];if(void 0===t)throw Error("Expected file for user with ID ".concat(e," to be defined"));return t},updateOpenFile:function(e){return(0,w._)(function(){return(0,S.Jh)(this,function(t){switch(t.label){case 0:return[4,u()];case 1:return t.sent().send({openFile:{file:e}}),[2]}})})()},updateSessionTimestamp:function(){return(0,w._)(function(){return(0,S.Jh)(this,function(e){switch(e.label){case 0:return[4,u()];case 1:return e.sent().send({updateSessionTimestamp:{}}),[2]}})})()},followUser:function(e){return h.apply(this,arguments)},unfollowUser:p,getActiveUsers:function(){return o},getFollowedUser:function(){return a},getFollowingUsers:function(){return l},getUserIdToFile:function(){return c},getPathToUserIds:function(){var e=new Map;return o.forEach(function(t){var n=t.id,r=c[n];r&&function t(n,r){if(""!==n){e.has(n)||e.set(n,[]);var i,o=e.get(n);if(!o)throw Error("Expected user Ids");o.some(function(e){return e===r})||(null===(i=e.get(n))||void 0===i||i.push(r),t((0,e1.Il)(n),r))}}(r,n)}),e}}}({container:ti,onCommand:e6,getColorForUser:e7}),tm=(0,G.Z)({container:ti,fs:td,channelRequestPriority:null==e0?void 0:e0.dotReplit,ctx:tn}),tv=function(e){var t,n,r,i=e.container,o=(0,P.ZP)(),a=null;function l(){return c.apply(this,arguments)}function c(){return(c=(0,w._)(function(){return(0,S.Jh)(this,function(e){return a&&"open"===a.status?[2,a]:[2,new Promise(function(e){o.once(p.CHANNEL_OPENED,function(t){e(t)})})]})})).apply(this,arguments)}function s(){return u.apply(this,arguments)}function u(){return(u=(0,w._)(function(){return(0,S.Jh)(this,function(e){return[2,N({container:i,service:"nix"})]})})).apply(this,arguments)}return i.openChannel({service:"nix"},function(e){var t=e.channel;return a=t,o.emit(p.CHANNEL_OPENED,t),function(){a=null}}),{searchPackages:(t=(0,w._)(function(e){var t,n,r,i;return(0,S.Jh)(this,function(o){switch(o.label){case 0:return[4,s()];case 1:return n=(t=C._.apply(void 0,[o.sent(),2]))[0],r=t[1],[4,n.request({nixPackageSearchRequest:{query:e}})];case 2:if((i=o.sent()).channelClosed)return[2,{error:"Channel closed",packages:null}];if(r(),i.error)return[2,{error:i.error,packages:null}];if(!i.nixPackageSearchResponse)return[2,{error:"Response expected but none received",packages:null}];return[2,{packages:i.nixPackageSearchResponse.packages,error:null}]}})}),function(e){return t.apply(this,arguments)}),listPackages:(0,w._)(function(){var e,t,n,r;return(0,S.Jh)(this,function(i){switch(i.label){case 0:return[4,s()];case 1:return t=(e=C._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixPackageListRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",packages:null}];if(n(),r.error)return[2,{error:r.error,packages:null}];if(!r.nixPackageListResponse)return[2,{error:"Response expected but none received",packages:null}];return[2,{packages:r.nixPackageListResponse.packages,error:null}]}})}),getChannels:(0,w._)(function(){var e,t,n,r;return(0,S.Jh)(this,function(i){switch(i.label){case 0:return[4,s()];case 1:return t=(e=C._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixChannelsRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",channels:null}];if(n(),r.error)return[2,{error:r.error,channels:null}];if(!r.nixChannelsResponse)return[2,{error:"Response expected but none received",channels:null}];return[2,{channels:r.nixChannelsResponse.channels,error:null}]}})}),getLatestStableChannel:(0,w._)(function(){var e,t,n,r;return(0,S.Jh)(this,function(i){switch(i.label){case 0:return[4,s()];case 1:return t=(e=C._.apply(void 0,[i.sent(),2]))[0],n=e[1],[4,t.request({nixChannelLatestStableRequest:{}})];case 2:if((r=i.sent()).channelClosed)return[2,{error:"Channel closed",channel:null}];if(n(),r.error)return[2,{error:r.error,channel:null}];if(!r.nixChannelLatestStableResponse)return[2,{error:"Response expected but none received",channel:null}];return[2,{channel:r.nixChannelLatestStableResponse.channel,error:null}]}})}),addPackages:(n=(0,w._)(function(e){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return[4,l()];case 1:return[4,n.sent().request({nixPackageAddRequest:{packages:e}})];case 2:if((t=n.sent()).channelClosed)return[2,"channel closed"];if(t.error)return[2,t.error];if(!t.nixPackageAddResponse)return[2,"response expected but non received"];return[2,null]}})}),function(e){return n.apply(this,arguments)}),removePackages:(r=(0,w._)(function(e){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return[4,l()];case 1:return[4,n.sent().request({nixPackageRemoveRequest:{packages:e}})];case 2:if((t=n.sent()).channelClosed)return[2,"channel closed"];if(t.error)return[2,t.error];if(!t.nixPackageRemoveResponse)return[2,"response expected but non received"];return[2,null]}})}),function(e){return r.apply(this,arguments)})}}({container:ti}),tg=(0,U.Z)({container:ti,dotReplit:tm}),ty=function(e){var t=e.container,n=e.forceTrace,r=e.track,i=(0,P.ZP)(),o=new Map;function a(e){var t=o.get(e);return t||(t={packagerChannel:null,didCallOpenChannel:!1,closeChannel:null},o.set(e,t)),t}function l(e){return c.apply(this,arguments)}function c(){return(c=(0,w._)(function(e){var n,r,i,o,a=arguments;return(0,S.Jh)(this,function(c){switch(c.label){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:0,[4,N({container:t,service:"packager3"})];case 1:if(i=(r=C._.apply(void 0,[c.sent(),2]))[0],o=r[1],!e)return[3,3];return[4,i.request({packageSetPackagerRequest:{packagerId:e}})];case 2:c.sent(),c.label=3;case 3:if("open"!==i.status){if(n>5)throw Error("Failed to getAnonymousPackagerChannel");return[2,l(e,n+1)]}return[2,[i,o]]}})})).apply(this,arguments)}function s(e){return u.apply(this,arguments)}function u(){return(u=(0,w._)(function(e){var n;return(0,S.Jh)(this,function(r){return((n=a(e)).didCallOpenChannel||function(e){var n=a(e);if(n.didCallOpenChannel)throw Error("Already called open channel");n.didCallOpenChannel=!0,n.closeChannel=t.openChannel({service:"packager3",name:e||"packager",action:_.api.OpenChannel.Action.ATTACH_OR_CREATE},function(t){var r=t.channel;return r.onCommand(function(t){if(null!=t.state){var n=t.state===_.api.State.Running;i.emit(d.STATE_CHANGED,n,e)}else null!=t.output?i.emit(d.OUTPUT,t.output,e):null!=t.error&&i.emit(d.ERROR,t.error,e)}),e?r.request({packageSetPackagerRequest:{packagerId:e}}).then(function(){n.packagerChannel=r,i.emit(d.CHANNEL_OPENED,r,e)}):(n.packagerChannel=r,i.emit(d.CHANNEL_OPENED,r,e)),function(){n.packagerChannel=null}})}(e),n.packagerChannel&&"open"===n.packagerChannel.status)?[2,n.packagerChannel]:[2,new Promise(function(t){i.once(d.CHANNEL_OPENED,function(n,r){r===e&&t(n)})})]})})).apply(this,arguments)}return{addPackages:function(e,t){return(0,w._)(function(){var n,i,o,a;return(0,S.Jh)(this,function(l){switch(l.label){case 0:return[4,s(t)];case 1:if("open"!==(i=l.sent()).status)return[2,!1];return o=e.map(function(e){return{name:e.name,spec:e.version}}),[4,i.request({packageAdd:{pkgs:o,useNewResponse:!0}})];case 2:if((a=l.sent()).channelClosed||a.error)return[2,!1];return(null===(n=a.packageAddResponse)||void 0===n?void 0:n.installedSystemDependencies)&&r&&r(I.U3.PACKAGER_INSTALLED_SYSTEM_DEPENDENCIES,{packagerId:t}),[2,!0]}})})()},removePackages:function(e,t){return(0,w._)(function(){var n,r,i;return(0,S.Jh)(this,function(o){switch(o.label){case 0:return[4,s(t)];case 1:if("open"!==(n=o.sent()).status)return[2,!1];return r=e.map(function(e){return{name:e}}),[4,n.request({packageRemove:{pkgs:r}})];case 2:if((i=o.sent()).channelClosed)return[2,!1];return[2,!!i.ok]}})})()},searchPackages:function(e,t){return(0,w._)(function(){var n,r,i,o;return(0,S.Jh)(this,function(a){switch(a.label){case 0:return[4,l(t)];case 1:return r=(n=C._.apply(void 0,[a.sent(),2]))[0],i=n[1],[4,r.request({packageSearch:{query:e}})];case 2:if((o=a.sent()).channelClosed)return[2,[]];if(i(),"packageSearchResp"===o.body&&o.packageSearchResp)return[2,o.packageSearchResp.results||[]];return B.Tb(Error("Unknown packager3 command ".concat(o.body,". ")+"Expected packageSearchResp. Received error: ".concat(o.error))),[2,[]]}})})()},fetchPackageInfo:function(e,t){return(0,w._)(function(){var n,r,i,o;return(0,S.Jh)(this,function(a){switch(a.label){case 0:return[4,l(t)];case 1:return r=(n=C._.apply(void 0,[a.sent(),2]))[0],i=n[1],[4,r.request({packageInfo:{pkg:{name:e}}})];case 2:if((o=a.sent()).channelClosed)return[2,void 0];if(i(),"packageInfoResp"===o.body&&o.packageInfoResp)return[2,o.packageInfoResp.pkg||void 0];return B.Tb(Error("Unknown packager3 command ".concat(o.body,". ")+"Expected packageInfoResp. Received error: ".concat(o.error))),[2,void 0]}})})()},installPackages:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,w._)(function(){return(0,S.Jh)(this,function(o){var a;return[2,(0,D.nO)(e,"packager.installPackages",(a=(0,w._)(function(e){var o,a,l;return(0,S.Jh)(this,function(c){switch(c.label){case 0:return[4,s(t)];case 1:if("open"!==(o=c.sent()).status)return[2,(0,A.UG)("ChannelClosed")];return[4,o.request({packageInstall:{useNewResponse:!0,disableGuess:i},traceInfo:(0,D.Rg)(e),forceTrace:n})];case 2:if((a=c.sent()).error)return[2,(0,A.UG)(a.error)];if(a.channelClosed)return[2,(0,A.UG)("ChannelClosed")];if(!(l=a.packageInstallResponse))return[2,(0,A.UG)("No package install response found")];return l.installedSystemDependencies&&r&&r(I.U3.PACKAGER_INSTALLED_SYSTEM_DEPENDENCIES,{packagerId:t}),[2,(0,A.Ok)(l)]}})}),function(e){return a.apply(this,arguments)}))]})})()},listSpecfile:function(e){return(0,w._)(function(){var t,n,r,i,o,a,c;return(0,S.Jh)(this,function(s){switch(s.label){case 0:return[4,l(e)];case 1:return n=(t=C._.apply(void 0,[s.sent(),2]))[0],r=t[1],[4,n.request({packageListSpecfile:{}})];case 2:if((i=s.sent()).channelClosed)return[2,{packages:null,error:"channel closed"}];switch(r(),i.body){case"error":return[2,{packages:null,error:"list specfile failed: ".concat(i.error)}];case"packageListSpecfileResp":if(!(a=null===(o=i.packageListSpecfileResp)||void 0===o?void 0:o.pkgs))return[2,{packages:null,error:"list specfile returned an empty response"}];return[2,{packages:a,error:null}];default:return c="Unknown packager3 listSpecFile command ".concat(i.body,". ")+"Expected error or packageListSpecfileResp",B.Tb(Error(c)),[2,{packages:null,error:c}]}return[2]}})})()},getPackagerIds:function(){return Array.from(o.keys())},clearPackager:function(e){var t=o.get(e);(null==t?void 0:t.closeChannel)&&t.closeChannel(),o.delete(e)},onOutput:function(e){return i.on(d.OUTPUT,e),function(){i.removeListener(d.OUTPUT,e)}},onError:function(e){return i.on(d.ERROR,e),function(){i.removeListener(d.ERROR,e)}},onStateChanged:function(e){return i.on(d.STATE_CHANGED,e),function(){i.removeListener(d.STATE_CHANGED,e)}}}}({container:ti,forceTrace:tt,track:E.j}),tb=(i=(r={container:ti,fs:td,openMultipleFiles:eq,openMultipleURLs:eY}).container,o=r.fs,a=r.openMultipleFiles,l=r.openMultipleURLs,c=new Set,s=!1,u=null,i.openChannel({service:"open",name:"open"},function(e){e.channel.onCommand(function(e){if("replspaceApiOpenMultipleFiles"===e.body){if(!e.replspaceApiOpenMultipleFiles)throw Error("Expected replspaceApiOpenMultipleFiles");var t=e.replspaceApiOpenMultipleFiles,n=t.files,r=t.urls;a&&n.length>0&&(nr(),a({paths:n})),l&&r.length>0&&(nr(),l({urls:r}))}})}),i.openChannel({service:"git",name:"git"},function(e){var t,n=e.channel;return n.onCommand((t=(0,w._)(function(e){var t,r,i,l,d,f,h,p,m,v,g,y,b,w,Z,x;return(0,S.Jh)(this,function(C){switch(C.label){case 0:switch(e.body){case"replspaceApiOpenFile":return[3,1];case"replspaceApiGetGitHubToken":return[3,7]}return[3,9];case 1:if(!e.replspaceApiOpenFile)throw Error("Expected replspaceApiOpenFile");if(r=(t=e.replspaceApiOpenFile).file,i=t.waitForClose,l=t.nonce,a)return[3,3];if(!r.endsWith(".git/COMMIT_EDITMSG"))return i&&n.send({replspaceApiCloseFile:{file:r,nonce:l}}),window.alert("tried to open ".concat(r," but failed")),[2];return d=window.prompt("Enter a commit message"),[4,o.writeFile(r,null!=d?d:"")];case 2:if(C.sent(),!i)return[2];return[3,5];case 3:if(nr(),a({paths:[r]}),!i||!u)return[2];return[4,u(r)];case 4:C.sent(),C.label=5;case 5:return[4,o.flush()];case 6:if(C.sent(),"open"!==n.status)return[2];return n.send({replspaceApiCloseFile:{file:r,nonce:l}}),[2];case 7:if(!e.replspaceApiGetGitHubToken)throw Error("Expected replspaceApiGetGitHubToken");return f=function(){var t;"open"===n.status&&n.send({replspaceApiGitHubToken:{token:"",nonce:null===(t=e.replspaceApiGetGitHubToken)||void 0===t?void 0:t.nonce}})},[4,function(){return nn.apply(this,arguments)}()];case 8:if(null==(h=C.sent()).gitHubInfo)return f(),[2];if(!c.size)return f(),H.kg.error("Got a replspaceApiGetGitHubToken command but no confirm listener is set up"),[2];if(p=function(){var t,r;"open"===n.status&&n.send({replspaceApiGitHubToken:{token:null===(t=h.gitHubInfo)||void 0===t?void 0:t.accessToken,nonce:null===(r=e.replspaceApiGetGitHubToken)||void 0===r?void 0:r.nonce}})},s)return p(),[2];m=!1,v=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=c[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)(0,r.value)(null)}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},g=!0,y=!1,b=void 0;try{for(w=c[Symbol.iterator]();!(g=(Z=w.next()).done)&&(x=Z.value,!m);g=!0)x(function(e){var t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!m){if(m=!0,!e){f(),v();return}t&&(s=e),p(),v()}})}catch(e){y=!0,b=e}finally{try{g||null==w.return||w.return()}finally{if(y)throw b}}C.label=9;case 9:return[2]}})}),function(e){return t.apply(this,arguments)})),function(){}}),i.openChannel({service:"shelltracker",name:"shelltracker"},function(e){e.channel.onCommand(function(e){null!=e.replspaceApiShellTracker&&(0,E.j)(E.U3.SHELL_COMMAND_EVALED,{context:e.replspaceApiShellTracker.cmd,api:"replspace",pwd:e.replspaceApiShellTracker.pwd})})}),{onConfirmSendToken:function(e){var t=function(t){return e(t)};return c.add(t),function(){c.delete(t)}},setWaitForFileClose:function(e){u=e}}),tZ=(g=(v={container:ti,beforeRun:tw=(h=(0,w._)(function(e,t){var n;return(0,S.Jh)(this,function(r){var i;return n=(null==t?void 0:t.ctx)||k.D.active(),[2,(0,D.nO)(n,"beforeRun",(i=(0,w._)(function(n){var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y;return(0,S.Jh)(this,function(b){switch(b.label){case 0:return[4,(0,D.nO)(n,"toolchain.getConfigs",function(){return tg.getConfigs()})];case 1:if((r=b.sent()).disableInstallBeforeRun)return[2];return i=(0,Z._)({},t),delete i.ctx,ta.emit("user:run:prerun",(0,Z._)({runnerMode:eW},i)),[4,(0,D.nO)(n,"fs.flush",function(){return td.flush({consistency:_.api.Flush.Consistency.Disk})})];case 2:if(b.sent(),e&&e("prerun flush finished"),!(null==r?void 0:r.packagers))return[3,10];o=!0,a=!1,l=void 0,b.label=3;case 3:b.trys.push([3,8,9,10]),c=r.packagers[Symbol.iterator](),b.label=4;case 4:if(o=(s=c.next()).done)return[3,7];if(!(u=s.value).guessImports)return[3,6];return d=performance.now(),f=r.disableGuessImports,[4,ty.installPackages(n,u.id,f)];case 5:h=b.sent(),p=performance.now()-d,e&&(h.error?e("prerun packager install finished",{packagerId:u.id,language:u.language,errorMessage:h.error,success:!1}):(g=(v=(null==(m=h.value)?void 0:m.guessedPkgs)||[]).length,e("prerun packager install finished",{packagerId:u.id,language:u.language,guessedPkgs:v,guessedPkgsCount:g,guessedAnyPkgs:g>0,upmGuessDurationMs:null==m?void 0:m.upmGuessDurationMs,upmAddDurationMs:null==m?void 0:m.upmAddDurationMs,upmLockDurationMs:null==m?void 0:m.upmLockDurationMs,backendTotalDurationMs:null==m?void 0:m.totalDurationMs,frontendTotalDurationMs:p,success:!0}),g>0&&(0,E.j)(I.U3.PACKAGER_PACKAGES_GUESSED,{packages:v}))),b.label=6;case 6:return o=!0,[3,4];case 7:return[3,10];case 8:return y=b.sent(),a=!0,l=y,[3,10];case 9:try{o||null==c.return||c.return()}finally{if(a)throw l}return[7];case 10:return ta.emit("user:run:initiate",{}),[2]}})}),function(e){return i.apply(this,arguments)}))]})}),function(e,t){return h.apply(this,arguments)})}).container,R=v.beforeRun,{mainClient:L=(0,M.u)(null),connect:function(){return new Promise(function(e){L.current||g.openChannel({service:"debugger"},function(t){return L.current=function(e){var t,n=e.channel,r=e.beforeRun,i=(0,M.u)("terminated"),o=(0,M.u)([]),a=(0,M.u)([]),l=(0,M.u)(new Map),c=(0,M.u)(null),s=(0,P.ZP)(),u=function(e,t){var n=new Map,r=new Map,i=new Map;function o(){return(o=(0,w._)(function(t){var o,a,l,c,s,u,d;return(0,S.Jh)(this,function(f){switch(f.label){case 0:o=!0,a=!1,l=void 0,f.label=1;case 1:f.trys.push([1,6,7,8]),c=function(){var n,o,a,l,c,s,d,f,h,p,m,v,g,y,b,w,x,k,_,E,T,R,I,D,G,B,P,A,N,L,U,O,M,X,F;return(0,S.Jh)(this,function(W){switch(W.label){case 0:if(o=(n=(0,C._)(u.value,2))[0],a=n[1],void 0!==t&&t!==o)return[2,"continue"];return[4,e({command:"setBreakpoints",arguments:{source:{name:o,path:o},breakpoints:a.map(function(e){return{line:e.line,logMessage:e.logMessage||void 0}})}})];case 1:if(!(l=W.sent()).success)return[2,"continue"];c=!0,s=!1,d=void 0;try{for(f=r[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){m=(p=(0,C._)(h.value,2))[0],v=p[1],(null===(g=v.source)||void 0===g?void 0:g.name)===o&&r.delete(m),y=!0,b=!1,w=void 0;try{for(x=i[Symbol.iterator]();!(y=(k=x.next()).done);y=!0)E=(_=(0,C._)(k.value,2))[0],_[1]===m&&i.delete(E)}catch(e){b=!0,w=e}finally{try{y||null==x.return||x.return()}finally{if(b)throw w}}}}catch(e){s=!0,d=e}finally{try{c||null==f.return||f.return()}finally{if(s)throw d}}T=l,R=!0,I=!1,D=void 0;try{for(G=T.body.breakpoints[Symbol.iterator]();!(R=(B=G.next()).done);R=!0)P=B.value,null!=P.id&&r.set(P.id,(0,Z._)({source:{name:o,path:o}},P))}catch(e){I=!0,D=e}finally{try{R||null==G.return||G.return()}finally{if(I)throw D}}A=!0,N=!1,L=void 0;try{for(U=(function(e,t){var n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:if(e.length!==t.length)return[2];n=0,r.label=1;case 1:if(!(n<e.length))return[3,4];return[4,[e[n],t[n]]];case 2:r.sent(),r.label=3;case 3:return n++,[3,1];case 4:return[2]}})})(a,T.body.breakpoints)[Symbol.iterator]();!(A=(O=U.next()).done);A=!0)X=(M=(0,C._)(O.value,2))[0],F=M[1],X.breakpointId&&null!=F.id&&i.set(X.breakpointId,F.id)}catch(e){N=!0,L=e}finally{try{A||null==U.return||U.return()}finally{if(N)throw L}}return[2]}})},s=n.entries()[Symbol.iterator](),f.label=2;case 2:if(o=(u=s.next()).done)return[3,5];return[5,(0,S.XA)(c())];case 3:f.sent(),f.label=4;case 4:return o=!0,[3,2];case 5:return[3,8];case 6:return d=f.sent(),a=!0,l=d,[3,8];case 7:try{o||null==s.return||s.return()}finally{if(a)throw l}return[7];case 8:return[2]}})})).apply(this,arguments)}function a(){var e=new Map,t=new Set,o=!0,a=!1,l=void 0;try{for(var c,s=n.entries()[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=(0,C._)(c.value,2),d=u[0],f=u[1];if(0!==f.length){var h=[],p=!0,m=!1,v=void 0;try{for(var g,y=f[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var b=g.value;if(b.breakpointId&&b.line){var w=i.get(b.breakpointId),Z=void 0===w?void 0:r.get(w);Z&&t.add(w),h.push({dapId:w,pid1Id:b.breakpointId,line:Z&&Z.line||b.line,verified:!!(null==Z?void 0:Z.verified),logMessage:b.logMessage||void 0})}}}catch(e){m=!0,v=e}finally{try{p||null==y.return||y.return()}finally{if(m)throw v}}e.set(d,h)}}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}var x=!0,S=!1,k=void 0;try{for(var _,E=r.entries()[Symbol.iterator]();!(x=(_=E.next()).done);x=!0){var T=(0,C._)(_.value,2),R=T[0],I=T[1];if(!t.has(R)){var D=(0,F.IT)((null===(U=I.source)||void 0===U?void 0:U.path)||(null===(O=I.source)||void 0===O?void 0:O.name)||""),G=I.line;if(D&&G){var B=e.get(D);B||(B=[],e.set(D,B));var P=!1,A=!0,N=!1,L=void 0;try{for(var U,O,M,X=B[Symbol.iterator]();!(A=(M=X.next()).done);A=!0){var W=M.value;if(W.line===I.line){W.dapId=R,W.verified=I.verified,P=!0;break}}}catch(e){N=!0,L=e}finally{try{A||null==X.return||X.return()}finally{if(N)throw L}}P||B.push({dapId:R,line:G,verified:I.verified})}}}}catch(e){S=!0,k=e}finally{try{x||null==E.return||E.return()}finally{if(S)throw k}}return e}return{findPathByBreakpointId:function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=n.entries()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=(0,C._)(o.value,2),c=l[0];if(l[1].some(function(t){return t.breakpointId===e}))return c}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}return null},getBreakpoints:a,flush:function(e){return o.apply(this,arguments)},handleDAPBreakpointEvent:function(e){var n=e.body,i=n.reason,o=n.breakpoint,l=o.id;if(null!=l){switch(i){case"changed":case"new":r.set(l,(0,Z._)({},r.get(l),o));break;case"removed":r.delete(l);break;default:return}t(a())}},handlePID1BreakpointEvent:function(e){var r=e.absolutePath?(0,F.IT)(e.absolutePath):null;r&&(n.set(r,e.breakpoints||[]),t(a()))},handleDebugSessionEnded:function(){r.clear(),i.clear();var e=!0,o=!1,l=void 0;try{for(var c,s=n.entries()[Symbol.iterator]();!(e=(c=s.next()).done);e=!0){var u=(0,C._)(c.value,2),d=u[0],f=u[1];0===f.length&&n.delete(d)}}catch(e){o=!0,l=e}finally{try{e||null==s.return||s.return()}finally{if(o)throw l}}t(a())}}}(y,function(e){l.current=e}),d=(0,M.u)(!1),f=[],h=new Y(function(e){if(f.push({time:Date.now(),direction:"in",data:e}),"event"===e.type)switch(e.event){case"continued":i.current="running";break;case"stopped":var t;i.current="paused",c.current=null!==(t=e.body.threadId)&&void 0!==t?t:null,s.emit("paused",e.body.reason),function(){T.apply(this,arguments)}();break;case"breakpoint":u.handleDAPBreakpointEvent(e)}else if("response"===e.type){var n=p.get(e.request_seq);n&&(p.delete(e.request_seq),n(e))}}),p=new Map,m=100;function v(){i.current="terminated",o.current=[],a.current=[],c.current=null,u.handleDebugSessionEnded(),d.current=!1}var g=!1;function y(e){return b.apply(this,arguments)}function b(){return(b=(0,w._)(function(e){return(0,S.Jh)(this,function(t){return[2,new Promise(function(t){var r,i=m++;p.set(i,t);var o=(0,x._)((0,Z._)({},e),{type:"request",seq:i});f.push({time:Date.now(),direction:"out",data:o});var a={debugInput:{session:"main",adapterInput:(r=JSON.stringify(o),"Content-Length: ".concat(J.byteLength(r),"\r\n\r\n").concat(r))}};f.push({time:Date.now(),direction:"out",data:a}),n.send(a)})]})})).apply(this,arguments)}function k(e){return E.apply(this,arguments)}function E(){return(E=(0,w._)(function(e){var t;return(0,S.Jh)(this,function(r){switch(r.label){case 0:return f.push({time:Date.now(),direction:"out",data:e}),[4,n.request(e)];case 1:if(t=r.sent(),f.push({time:Date.now(),direction:"in",data:t}),t.error)throw t.error;return[2,t]}})})).apply(this,arguments)}function T(){return(T=(0,w._)(function(){var e,t,n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:return o.current=[],a.current=[],[4,y({command:"stackTrace",arguments:{threadId:c.current}})];case 1:if(!(e=r.sent()).success||(o.current=e.body.stackFrames,0===o.current.length))return[2];return[4,y({command:"scopes",arguments:{frameId:o.current[0].id}})];case 2:if(!(t=r.sent()).success)return[2];return[4,Promise.all(t.body.scopes.map(function(e){return y({command:"variables",arguments:{variablesReference:e.variablesReference}}).then(function(t){return{response:t,parentVariableReference:e.variablesReference}})}))];case 3:return n=r.sent(),a.current=n.filter(function(e){return e.response.success}).reduce(function(e,t){var n=t.response,r=t.parentVariableReference;return e.concat(n.body.variables.map(function(e){return(0,x._)((0,Z._)({},e),{parentVariableReference:r})}))},[]),[2]}})})).apply(this,arguments)}function R(e){return I.apply(this,arguments)}function I(){return(I=(0,w._)(function(e){var t,a,l,c,h,p,m;return(0,S.Jh)(this,function(v){switch(v.label){case 0:if("terminated"!==i.current)throw Error("Cant start while debugger is already running");return i.current="preinitializing",o.current=[],[4,r()];case 1:if(v.sent(),"stopping"===i.current)return i.current="terminated",[2];return g=!0,i.current="initializing",l={session:"main",readOnly:!1},e&&(l.debuggerId=e.debuggerOption.id,e.filePath&&(l.filePath=e.filePath)),c={debugMain:l},f.push({time:Date.now(),direction:"out",data:c}),[4,n.request(c)];case 2:if(h=v.sent(),f.push({time:Date.now(),direction:"in",data:h}),h.error)return s.emit("output",h.error),i.current="terminated",[2];return[4,y({command:"initialize",arguments:{clientID:"replit",clientName:"replit.com",adapterID:"cppdbg",pathFormat:"path",linesStartAt1:!0,columnsStartAt1:!0,supportsEvaluateForHovers:!0,supportsVariableType:!0,supportsVariablePaging:!0,supportsRunInTerminalRequest:!1,locale:"en-us",supportsProgressReporting:!0,supportsInvalidatedEvent:!0}})];case 3:if(!(p=v.sent()).success)return i.current="terminated",[2];return d.current=!!(null===(t=p.body)||void 0===t?void 0:t.supportsStepBack),m=!(null===(a=p.body)||void 0===a?void 0:a.supportsConfigurationDoneRequest),[4,u.flush()];case 4:if(v.sent(),m)return[3,6];return[4,y({command:"configurationDone"})];case 5:v.sent(),v.label=6;case 6:return"initializing"===i.current&&(i.current="running"),s.emit("started",m),[2]}})})).apply(this,arguments)}function D(e,t){return G.apply(this,arguments)}function G(){return(G=(0,w._)(function(e,t){var n,r,o,a;return(0,S.Jh)(this,function(l){switch(l.label){case 0:return n=t.line,r=t.otIndex,o=t.otVersion,a=t.logMessage,[4,k({debugAddBreakpointRequest:{path:(0,F.om)(e)||e,line:n,otIndex:r,otVersion:o,logMessage:a}})];case 1:if(l.sent(),!("terminated"!==i.current))return[3,3];return[4,u.flush(e)];case 2:l.sent(),l.label=3;case 3:return s.emit("breakpoint","added"),[2]}})})).apply(this,arguments)}function B(e){return A.apply(this,arguments)}function A(){return(A=(0,w._)(function(e){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return t=u.findPathByBreakpointId(e),[4,k({debugRemoveBreakpointRequest:{breakpointId:e}})];case 1:if(n.sent(),!("terminated"!==i.current&&t))return[3,3];return[4,u.flush(t)];case 2:n.sent(),n.label=3;case 3:return s.emit("breakpoint","removed"),[2]}})})).apply(this,arguments)}function N(){return(N=(0,w._)(function(e,t){var n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:if(!(n=u.findPathByBreakpointId(e)))return[2];return[4,k({debugUpdateBreakpointRequest:{breakpointId:e,logMessage:t.logMessage}})];case 1:if(r.sent(),!("terminated"!==i.current))return[3,3];return[4,u.flush(n)];case 2:r.sent(),r.label=3;case 3:return s.emit("breakpoint","updated"),[2]}})})).apply(this,arguments)}function L(){return(L=(0,w._)(function(e,t){var n,r,i;return(0,S.Jh)(this,function(o){switch(o.label){case 0:if(!(i=null===(r=l.current.get(e))||void 0===r?void 0:null===(n=r.find(function(e){return e.line===t.line&&void 0!==e.pid1Id}))||void 0===n?void 0:n.pid1Id))return[3,2];return[4,B(i)];case 1:return o.sent(),[3,4];case 2:return[4,D(e,t)];case 3:o.sent(),o.label=4;case 4:return[2]}})})).apply(this,arguments)}function U(e){return s.on("started",e),function(){s.removeListener("started",e)}}return n.onCommand(function(e){f.push({time:Date.now(),direction:"in",data:e});var t,n,r=e.debugOutput,o=e.debugState,a=e.debugBreakpointEvent,l=e.debugSessions;if(r){if("main"!==r.session)return;r.adapterOutput&&h.read(r.adapterOutput),r.output&&s.emit("output",r.output)}if(a&&u.handlePID1BreakpointEvent(a),o&&o.state===_.api.State.Stopped&&v(),((null==l?void 0:null===(t=l.sessions)||void 0===t?void 0:t.main)===_.api.State.Running||(null==o?void 0:o.state)===_.api.State.Running)&&"terminated"===i.current&&R(),(null==l?void 0:null===(n=l.sessions)||void 0===n?void 0:n.main)===_.api.State.Stopped||(null==o?void 0:o.state)===_.api.State.Stopped){if(g){g=!1;return}v()}}),{state:i,stackFrames:o,variables:a,breakpoints:l,supportsStepBack:d,onOutput:function(e){return s.on("output",e),function(){s.removeListener("output",e)}},onStarted:U,onPaused:function(e){return s.on("paused",e),function(){s.removeListener("paused",e)}},onBreakpoint:function(e){return s.on("breakpoint",e),function(){s.removeListener("breakpoint",e)}},sendInput:function(e){return(0,w._)(function(){var t,r;return(0,S.Jh)(this,function(i){switch(i.label){case 0:return t={debugInput:{session:"main",input:e}},f.push({time:Date.now(),direction:"out",data:t}),[4,n.request(t)];case 1:if(r=i.sent(),f.push({time:Date.now(),direction:"in",data:r}),r.error)throw r.error;return[2]}})})()},fetchVariables:function(e){return(0,w._)(function(){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return[4,y({command:"variables",arguments:{variablesReference:e}})];case 1:if((t=n.sent()).success)return[2,t.body.variables.map(function(t){return(0,x._)((0,Z._)({},t),{parentVariableReference:e})})];throw Error(t.message)}})})()},evaluate:function(e){var n=e.frameId,r=void 0===n?null===(t=o.current[0])||void 0===t?void 0:t.id:n,i=e.expression,a=e.context;return(0,w._)(function(){return(0,S.Jh)(this,function(e){switch(e.label){case 0:return[4,y({command:"evaluate",arguments:{frameId:r,expression:i,context:a}})];case 1:return[2,e.sent()]}})})()},addBreakpoint:D,removeBreakpoint:B,updateBreakpoint:function(e,t){return N.apply(this,arguments)},toggleBreakpoint:function(e,t){return L.apply(this,arguments)},start:R,continue:function(){return(0,w._)(function(){return(0,S.Jh)(this,function(e){switch(e.label){case 0:return o.current=[],i.current="running",[4,y({command:"continue",arguments:{threadId:c.current}})];case 1:return e.sent(),[2]}})})()},reverseContinue:function(){return(0,w._)(function(){return(0,S.Jh)(this,function(e){switch(e.label){case 0:return o.current=[],i.current="running",[4,y({command:"reverseContinue",arguments:{threadId:c.current}})];case 1:return e.sent(),[2]}})})()},back:function(){return(0,w._)(function(){return(0,S.Jh)(this,function(e){switch(e.label){case 0:return i.current="running",[4,y({command:"stepBack",arguments:{threadId:c.current}})];case 1:return e.sent(),[2]}})})()},next:function(){return(0,w._)(function(){return(0,S.Jh)(this,function(e){switch(e.label){case 0:return i.current="running",[4,y({command:"stepIn",arguments:{threadId:c.current}})];case 1:return e.sent(),[2]}})})()},skip:function(){return(0,w._)(function(){return(0,S.Jh)(this,function(e){switch(e.label){case 0:return i.current="running",[4,y({command:"next",arguments:{threadId:c.current,granularity:"line"}})];case 1:return e.sent(),[2]}})})()},stepOut:function(){return(0,w._)(function(){return(0,S.Jh)(this,function(e){switch(e.label){case 0:return i.current="running",[4,y({command:"stepOut",arguments:{threadId:c.current}})];case 1:return e.sent(),[2]}})})()},stop:function(){return(0,w._)(function(){var e,t,r,o;return(0,S.Jh)(this,function(a){switch(a.label){case 0:if("terminated"===i.current)throw Error("Debugger already terminated");if(e=i.current,i.current="stopping","preinitializing"===e)return[2];if("initializing"!==e)return[3,2];return t=[],[4,Promise.race([new Promise(function(e){t.push(i.subscribe(function(){return e()}))}),new Promise(function(e){t.push(U(function(){return e()}))})])];case 1:if(a.sent(),t.forEach(function(e){return e()}),"terminated"===i.current)return[2];a.label=2;case 2:return r={debugStop:{session:"main"}},f.push({time:Date.now(),direction:"out",data:r}),[4,n.request(r)];case 3:if(o=a.sent(),f.push({time:Date.now(),direction:"in",data:o}),o.error)throw Error("Failed to stop debugger "+o.error);return[2]}})})()},getSource:function(e){return(0,w._)(function(){var t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return[4,y({command:"source",arguments:{source:{path:e}}})];case 1:if(!(t=n.sent()).success)throw Error(t.message);return[2,t.body.content]}})})()},getDebugLogs:function(){return Object.entries({state:i,stackFrames:o,variables:a,breakpoints:l,threadId:c}).map(function(e){var t=(0,C._)(e,2),n=t[0],r=t[1];return"".concat(n," = ").concat(JSON.stringify(r.current instanceof Map?(0,X._)(r.current):r.current,void 0,2))}).join("\n")+"\n\n"+f.map(function(e){return[new Date(e.time).toLocaleString(),"in"===e.direction?"->":"<-",JSON.stringify(e.data)].join(" ")}).join("\n")}}}({channel:t.channel,beforeRun:R}),e(null),function(){L.current=null}})})}}),tx=(0,T.TE)({container:ti,dotReplit:tm,enableBetterPortHandling:void 0!==e5&&e5}),tC=function(e){var t;if("outputs"===e.mode?t=function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y=e.container,b=e.toolchain,x=e.beforeRun,C=e.packager,k=e.debuggest,T=(0,P.ZP)(),R=null,I={runId:nc()(),runState:ni.Ah.OFFLINE,runningStage:"NONE",outputBlocks:[]};function G(e){I=(0,na.Uy)(I,e)}function B(e){var t=I.outputBlocks.find(function(t){return t.id===e});if(!t)throw Error("can't find block for id: ".concat(e));T.emit(ni.zW.BLOCK_CHANGED,t)}function A(){T.emit(ni.zW.ALL_BLOCKS_CHANGED,I.outputBlocks)}function N(e){I.runState!==e&&(G(function(t){t.runState=e}),T.emit(ni.zW.STATE_CHANGE,e))}function L(){if(!R){N(ni.Ah.OFFLINE);return}if("BEFORE_RUN"===I.runningStage){N(ni.Ah.BEFORE_RUN);return}if("STOPPING"===I.runningStage){N(ni.Ah.STOPPING);return}if("NONE"!==I.runningStage){N(ni.Ah.RUNNING);return}N(ni.Ah.IDLE)}function U(e,t){var n=(null!=t?t:I).outputBlocks.filter(function(t){return t.type===e}),r=n[n.length-1];if(r)return r}function O(e,t){var n;G(function(r){var i=U(e,r);i&&(n=i.id,t(i))}),n&&B(n)}function M(){return(M=(0,w._)(function(e){return(0,S.Jh)(this,function(t){var n;return[2,(0,D.GK)("outputs.run",(n=(0,w._)(function(t){var n,r,i,o,a,l,c,s,u,d;return(0,S.Jh)(this,function(f){switch(f.label){case 0:if(I.runState!==ni.Ah.IDLE&&I.runState!==ni.Ah.STOPPING)throw Error("Cannot run while state is not IDLE or STOPPING, got state: "+I.runState);return i=I.outputBlocks.length>1&&I.outputBlocks[I.outputBlocks.length-1],(0,E.j)(E.U3.WS_CONSOLE_OUTPUT_STARTED,{replId:null===(n=y.getContext())||void 0===n?void 0:n.repl.id,runId:I.runId,lastBlock:i?(0,Z._)({type:i.type,isDone:i.isDone,endTime:i.endTime,startTime:i.startTime},i.type===ni.kH.EXECUTION?{executionMode:i.data.executionMode,exitCode:i.data.exitCode,stderr:i.data.stderr}:{},i.type===ni.kH.DEBUGGER?{debugState:i.data.debugState}:{}):void 0,previousBlockNumber:I.outputBlocks.length,previousBlocksAvgTimeMs:I.outputBlocks.length>1?Math.floor(I.outputBlocks.reduce(function(e,t){return t.endTime&&t.startTime?e+(t.endTime-t.startTime):e},0)):void 0}),o=nc()(),G(function(e){e.runId=o,e.runningStage="BEFORE_RUN"}),T.emit(ni.zW.LOCAL_RUN),L(),!e&&(l=(0,no.Z)(b.configs.current,[],null,(null===(a=b.configs.current)||void 0===a?void 0:a.entrypoint)||null)).length>0&&(e=l[0]),[4,x(c=H.kg.timeStart({runnerId:null==e?void 0:e.runner.id,filePath:null==e?void 0:e.filePath,isInterpreter:null==e?void 0:e.runner.interpreter,replLanguage:null===(r=y.getContext())||void 0===r?void 0:r.repl.language}),{runId:o,channelId:null==R?void 0:R.id,type:"outputs",runConfig:e,ctx:t})];case 1:if(f.sent(),I.runId!==o||"NONE"===I.runningStage||"SERVER"===I.runningStage)return[2];if(!R)throw Error("State is RUNNING but outputs is null?");if("open"!==R.status)return[2];return(s=X()).isStopped||s.stop(),u={},e&&(u.runnerId=e.runner.id,u.filePath=e.filePath),d=R,[4,(0,D.nO)(t,"timeToRunning",(0,w._)(function(){var e,t;return(0,S.Jh)(this,function(n){switch(n.label){case 0:return e=performance.now(),d.send({runMain:u}),[4,new Promise(function(e){var t=d.onCommand(function(n){"state"===n.body&&(t(),e())})})];case 1:return n.sent(),t=performance.now()-e,c("run finished",{timeToRunningMs:t}),[2]}})}))];case 2:return f.sent(),[2]}})}),function(e){return n.apply(this,arguments)}))]})})).apply(this,arguments)}function X(){var e=k.mainClient.current,t=null==e?void 0:e.state.current;return{client:e,state:t,sendInput:function(t){return null==e?void 0:e.sendInput(t)},stop:function(){return null==e?void 0:e.stop()},isRunning:"running"===t,isStopped:null==t||"terminated"===t}}function F(){return(F=(0,w._)(function(e){var t,n;return(0,S.Jh)(this,function(r){if(I.runState===ni.Ah.OFFLINE)return[2];if(t=X(),n=I.outputBlocks[I.outputBlocks.length-1].type===ni.kH.DEBUGGER,t.isRunning&&n&&t.sendInput(e),I.runState!==ni.Ah.IDLE&&I.runState!==ni.Ah.RUNNING)throw Error("Can only send input when running or idle");if(!R)throw Error("State is not OFFLINE but outputs is null?");return"open"!==R.status||R.send({input:e}),[2]})})).apply(this,arguments)}return n=(t={packager:C,updateState:G,getRunningBlockOfType:U,updateRunningBlockOfType:O,emitBlockUpdate:B}).packager,r=t.updateState,i=t.getRunningBlockOfType,o=t.updateRunningBlockOfType,a=t.emitBlockUpdate,(l=[]).push(n.onOutput(function(e){var t=i(ni.kH.PACKAGER);null==t||t.data.emitMessage(e.replace(/\n/g,"\n\r"))})),l.push(n.onError(function(e){o(ni.kH.PACKAGER,function(t){t.error?t.error+="\n"+e:t.error=e})})),l.push(n.onStateChanged(function(e){if(e){var t=nc()();r(function(e){e.outputBlocks.push({id:t,localStartTime:Date.now(),isDone:!1,visualState:ni.MZ.EXPANDED,type:ni.kH.PACKAGER,data:(0,Z._)({},nu({maxHistorySize:4e3}))}),e.outputBlocks.length>20&&e.outputBlocks.shift()}),a(t)}else o(ni.kH.PACKAGER,function(e){e.data.emitMessage(nf),e.localEndTime=Date.now(),e.isDone=!0})})),d=(c={debuggest:k,updateState:G,updateRunningBlockOfType:O,getRunningBlockOfType:U,emitRunState:N,emitBlockUpdate:B,stopCurrentRun:function(){G(function(e){e.runningStage="BEFORE_RUN"}),null==R||R.send({clear:{}})}}).debuggest,f=c.updateState,h=c.updateRunningBlockOfType,p=c.getRunningBlockOfType,m=c.emitBlockUpdate,v=c.emitRunState,g=c.stopCurrentRun,d.mainClient.subscribe(function(e){e&&(null==u||u(),null==s||s(),u=e.state.subscribe(function(e){if("initializing"===e){g();var t=nc()();f(function(e){e.outputBlocks.push({id:t,localStartTime:Date.now(),isDone:!1,type:ni.kH.DEBUGGER,visualState:ni.MZ.EXPANDED,data:(0,Z._)({debugState:"paused"},nu({maxHistorySize:4e3}))})}),m(t),v(ni.Ah.RUNNING)}"paused"===e&&h(ni.kH.DEBUGGER,function(e){e.data.debugState="paused"}),"running"===e&&h(ni.kH.DEBUGGER,function(e){e.data.debugState="running"}),"stopping"===e&&v(ni.Ah.STOPPING),"terminated"===e&&(h(ni.kH.DEBUGGER,function(e){e.localEndTime=Date.now(),e.data.emitMessage(nf),e.isDone=!0}),v(ni.Ah.IDLE))}),s=e.onOutput(function(e){var t=p(ni.kH.DEBUGGER);null==t||t.data.emitMessage(e)}))}),y.openChannel({name:"output",service:"output"},function(e){var t=e.channel;return R=t,L(),t.onCommand(function(e){if(null!=e.state){var t=e.state===_.api.State.Stopped;"STOPPING"===I.runningStage&&t&&G(function(e){e.runningStage="NONE"}),t?"SERVER"===I.runningStage&&G(function(e){e.runningStage="NONE"}):G(function(e){e.runningStage="SERVER"}),L();return}if(null!=e.outputBlockStartEvent&&null!=e.outputBlockStartEvent.measureStartTime){if(void 0!==I.outputBlocks.find(function(e){return e.type===ni.kH.EXECUTION&&!e.isDone}))return;var n=e.outputBlockStartEvent,r=n.cgroup,i=n.executionMode,o=nd(n.measureStartTime),a=nc()();G(function(e){e.outputBlocks.push({id:a,localStartTime:Date.now(),startTime:o,isDone:!1,type:ni.kH.EXECUTION,visualState:ni.MZ.EXPANDED,data:(0,Z._)({cgroup:r,executionMode:i===_.api.OutputBlockStartEvent.ExecutionMode.Run?"run":"interpret"},nu({maxHistorySize:4e3}))}),e.outputBlocks.length>20&&e.outputBlocks.shift()}),B(a)}if(null!=e.output){var l=U(ni.kH.EXECUTION);null==l||l.data.emitMessage(e.output)}if(null!=e.hint){var c=U(ni.kH.EXECUTION);null==c||c.data.emitMessage("\r\n\x1b[0m\x1b[33m".concat(e.hint.text,"\x1b[0m\r\n"))}if(null!=e.stderr&&O(ni.kH.EXECUTION,function(t){t.data.stderr=(t.data.stderr||"")+e.stderr}),null!=e.error){var s=e.error;O(ni.kH.EXECUTION,function(e){e.error?e.error+="\n"+s:e.error=s})}if(null!=e.outputBlockEndEvent&&null!=e.outputBlockEndEvent.measureEndTime){var u,d=e.outputBlockEndEvent.exitCode;(0,E.j)(E.U3.WS_CONSOLE_OUTPUT_RAN,{exitCode:d,replId:null===(u=y.getContext())||void 0===u?void 0:u.repl.id,runId:I.runId});var f=nd(e.outputBlockEndEvent.measureEndTime);O(ni.kH.EXECUTION,function(e){e.data.emitMessage(nf),e.data.exitCode=d,e.localEndTime=Date.now(),e.endTime=f,e.isDone=!0})}}),function(){R=null,G(function(e){e.runId=nc()(),e.runState=ni.Ah.OFFLINE,e.runningStage="NONE",e.outputBlocks.forEach(function(e){if(!e.isDone){e.data.emitMessage(nf),e.localEndTime=Date.now(),e.isDone=!0;var t="Connection was lost";e.error?e.error+="\n"+t:e.error=t}})}),L(),A()}}),{mode:"outputs",run:function(e){return M.apply(this,arguments)},stopRun:function(){if(I.runState===ni.Ah.RUNNING){var e=X();if(!e.isStopped){e.stop(),G(function(e){e.runningStage="STOPPING"}),L();return}if("BEFORE_RUN"===I.runningStage){G(function(e){e.runningStage="NONE"}),L();return}G(function(e){e.runningStage="STOPPING"}),L(),null==R||R.send({clear:{}})}},sendInput:function(e){return F.apply(this,arguments)},onLocalRun:function(e){return T.on(ni.zW.LOCAL_RUN,e),function(){T.removeListener(ni.zW.LOCAL_RUN,e)}},onStateChanged:function(e){return T.on(ni.zW.STATE_CHANGE,e),function(){return T.removeListener(ni.zW.STATE_CHANGE,e)}},getRunState:function(){return I.runState},getOutputBlocks:function(){return I.outputBlocks},clearBlockHistory:function(){G(function(e){e.outputBlocks=e.outputBlocks.filter(function(e){return!e.isDone})}),A()},onBlockChanged:function(e){return T.on(ni.zW.BLOCK_CHANGED,e),function(){return T.removeListener(ni.zW.BLOCK_CHANGED,e)}},onAllBlocksChanged:function(e){return T.on(ni.zW.ALL_BLOCKS_CHANGED,e),function(){return T.removeListener(ni.zW.ALL_BLOCKS_CHANGED,e)}},resizeTerminalForBlock:function(e,t){if(R&&"open"===R.status){var n=I.outputBlocks.find(function(t){return t.id===e});if(!n)throw Error("tried to resize terminal of non-existing block");n.isDone||R.send({resizeTerm:t})}},startBlock:function(e){var t=nc()();return G(function(n){n.outputBlocks.push({id:t,localStartTime:Date.now(),isDone:!1,visualState:ni.MZ.EXPANDED,type:e,data:(0,Z._)({},nu({maxHistorySize:4e3}))})}),B(t),{id:t}},endBlock:function(e){G(function(t){var n=t.outputBlocks.find(function(t){return t.id===e});if(!n)throw Error("couldn't find a block");n.data.emitMessage(nf),n.localEndTime=Date.now(),n.isDone=!0}),B(e)},writeOutputToBlock:function(e,t){var n=I.outputBlocks.find(function(t){return t.id===e});n&&n.data.emitMessage(t)},writeErrorToBlock:function(e,t){G(function(n){var r=n.outputBlocks.find(function(t){return t.id===e});if(!r)throw Error("couldn't find a block");r.error?r.error+="\n"+t:r.error=t}),B(e)},setBlockVisualState:function(e,t){G(function(n){var r=n.outputBlocks.find(function(t){return t.id===e});if(!r)throw Error("couldn't find a block");r.visualState=t}),B(e)}}}({container:e.container,toolchain:e.toolchain,beforeRun:e.beforeRun,packager:e.packager,debuggest:e.debuggest}):"html"===e.mode&&(t=function(e){var t=e.beforeRun,n=e.container,r=(0,P.ZP)(),i=ni.Ah.OFFLINE,o="none",a=Math.random();function l(){var e=function(e){i!==e&&(i=e,r.emit(ni.zW.STATE_CHANGE,i))};if("none"!==o){e(ni.Ah.RUNNING);return}e(ni.Ah.IDLE)}function c(){return(c=(0,w._)(function(){var e;return(0,S.Jh)(this,function(n){switch(n.label){case 0:if(i!==ni.Ah.IDLE&&i!==ni.Ah.STOPPING)throw Error("Cannot run while state is not IDLE or STOPPING, got state: "+i);return a=e=Math.random(),r.emit(ni.zW.LOCAL_RUN),o="before-run",l(),[4,t(H.kg.timeStart({replLanguage:"html"}),{runId:e.toString(),type:"html"})];case 1:if(n.sent(),a!==e||"none"===o)return[2];return o="running",l(),o="none",l(),[2]}})})).apply(this,arguments)}return n.onConnectionStateChanged(function(e){e===O.em.CONNECTED&&(o="none",l())}),{mode:"html",run:function(){return c.apply(this,arguments)},stopRun:function(){if(i!==ni.Ah.RUNNING)throw Error("stopRun must be called when running but got ".concat(i));o="none",l()},onStateChanged:function(e){return r.on(ni.zW.STATE_CHANGE,e),function(){r.removeListener(ni.zW.STATE_CHANGE,e)}},onLocalRun:function(e){return r.on(ni.zW.LOCAL_RUN,e),function(){r.removeListener(ni.zW.LOCAL_RUN,e)}},getRunState:function(){return i}}}({beforeRun:e.beforeRun,container:e.container})),!t)throw Error("mode not supported: "+e.mode);return t}({mode:eW,container:ti,toolchain:tg,beforeRun:tw,packager:ty,debuggest:tZ}),tk=(V=(0,P.ZP)(),z=new Promise(function(e){return W=e}),j=null,q=new Map,ti.openChannel({service:"chat",name:"broadcaster"},function(e){var t=e.channel,n=e.context;return n.currentUser&&(j=n.currentUser.username),t.onCommand(function(e){if("chatMessage"===e.body){var t=e.chatMessage;if(!t||!t.username||!t.text)throw Error("unexpected broadcast without a message");V.emit(f.MESSAGE_RECEIVED,{text:t.text,username:t.username})}}),W(t),function(){z=new Promise(function(e){return W=e})}}),{broadcastMessage:function(e,t){var n=t.text;return(0,w._)(function(){var t,r,i,o,a,l,c,s,u,d;return(0,S.Jh)(this,function(f){switch(f.label){case 0:return[4,z];case 1:if(t=f.sent(),!j)throw Error("Cannot broadcast without as username. Is currentUser in context?");r={text:n,username:j},i=!0,o=!1,a=void 0;try{for(l=q[Symbol.iterator]();!(i=(c=l.next()).done);i=!0)u=(s=(0,C._)(c.value,2))[0],d=s[1],u!==e&&d(r)}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return t.send({chatMessage:r}),[2]}})})()},onBroadcastReceived:function(e,t){return q.set(e,t),V.on(f.MESSAGE_RECEIVED,t),function(){V.removeListener(f.MESSAGE_RECEIVED,t),q.delete(e)}}}),tE=function(e){var t=e.container,n=e.toolchain,r=e.fs,i=e.enableMultipleLSPClientsPerFile,o=void 0!==i&&i,a=new Map,l=new Map,c={},s=!0;function u(e){var t=c[e];if(!t)throw Error("LSPNix: removeLanguage called with lspId never configured");var n=t.client;if(n){t.client=null,n.destroy();var r=!0,i=!1,o=void 0;try{for(var s,u=a[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var d=(0,C._)(s.value,2),f=d[0],h=d[1],p=l.get(f);if(p){p.delete(n),l.set(f,p);var m=!0,v=!1,g=void 0;try{for(var y,b=h[Symbol.iterator]();!(m=(y=b.next()).done);m=!0)(0,y.value)(Array.from(p))}catch(e){v=!0,g=e}finally{try{m||null==b.return||b.return()}finally{if(v)throw g}}}}}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}}t.closeChannel(),delete c[e]}function d(e,t){if(c[e])throw Error("LSPNix: addLanguage called with lspId already configured");c[e]={client:null,option:t,closeChannel:function(){}},s&&m(e)}var f=new Map;function h(e){if(!s)return!1;var t=c[e];return!!t&&!t.client}function p(e,t,n){new Date().getTime()-n.getTime()<5e3?t<3?setTimeout(function(){h(e)&&m(e,t+1)},1e3*Math.pow(2,t)):H.kg.error("LSP server is crash-looping. Giving up.",{lspId:e,appService:"lspnix"}):setTimeout(function(){h(e)&&m(e)})}function m(e){return v.apply(this,arguments)}function v(){return(v=(0,w._)(function(e){var n,i,u,d,h,m,v,g,y=arguments;return(0,S.Jh)(this,function(b){switch(b.label){case 0:if(n=y.length>1&&void 0!==y[1]?y[1]:0,!s)throw Error("LSPNix: Called startClient while not enabled");if(!c[e])throw Error("LSPNix: No config found for lspId: ".concat(e));if(!f.get(e))return[3,2];return[4,f.get(e)];case 1:if(b.sent())return[2];b.label=2;case 2:if(u=(i=c[e]).client,i.closeChannel,d=i.option,u)throw Error("LSPNix: A previous client is already set for language: ".concat(e));return h=function(){},m=new Promise(function(e){h=e}),f.set(e,m),v=[],g=t.openChannel({service:"lsp2",skip:function(e){var t=e.repl.language,n=t.startsWith("nix")||t.startsWith("html");return n||(H.kg.error("Skipped opening lsp channel for non-nix repl",{language:t,appService:"lspnix"}),h(null)),!n}},function(i){var u=i.channel,m=null,y=!1,b=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!y){y=!0,t||(h(null),f.delete(e)),v.forEach(function(e){return e()}),null==m||m.destroy(),(null===(o=c[e])||void 0===o?void 0:o.client)===m&&(c[e].client=null),t&&s||g();var n=!0,r=!1,i=void 0;try{for(var o,u,d=a[Symbol.iterator]();!(n=(u=d.next()).done);n=!0){var p=(0,C._)(u.value,2),b=p[0],w=p[1],Z=l.get(b);if(Z&&m&&Z.has(m)){Z.delete(m),Z.size?l.set(b,Z):l.delete(b);var x=!0,S=!1,k=void 0;try{for(var _,E=w[Symbol.iterator]();!(x=(_=E.next()).done);x=!0)(0,_.value)(Array.from(Z))}catch(e){S=!0,k=e}finally{try{x||null==E.return||E.return()}finally{if(S)throw k}}}}}catch(e){r=!0,i=e}finally{try{n||null==d.return||d.return()}finally{if(r)throw i}}}};if("open"!==u.status){H.kg.error("LSPNix got a channel that wasn't open. This is expected to be impossible.",{lspId:e,appService:"lspnix"});return}var k=new Date;return u.request({startLSP:{languageServerId:e}}).then(function(i){if(!i.ok){H.kg.error("LSP server failed to start",{lspId:e,appService:"lspnix",serverError:i.error});return}if(s&&c[e]){v.push(u.onCommand(function(t){t.state===_.api.State.Stopped&&(H.kg.error("LSP server unexpectedly disconnected",{lspId:e,appService:"lspnix"}),b(),s&&p(e,n,k))}));var g=0;t3(t,function(){return g++<5&&s&&t4(c[e].option,d)&&"open"===u.status}).then(function(t){if(!c[e]){H.kg.info("LSPNix: lsp map changed while getting working directory",{lspId:e,appService:"lspnix"});return}if(!t4(c[e].option,d)){H.kg.info("LSPNix: configuration changed while getting working directory",{lspId:e,appService:"lspnix"});return}if("open"!==u.status){H.kg.error("LSPNix: channel wasn't open after getting working directory",{lspId:e,appService:"lspnix"});return}if(t.error){H.kg.error("LSPNix: failed to get working directory",{lspId:e,appService:"lspnix",originalError:null===(_=t.error)||void 0===_?void 0:_.message});return}if(m=function(e){var t,n=e.connection,r=e.isSupportedFile,i=e.clientId,o=e.clientName,a=e.getWorkspaceConfiguration,l=e.onWorkspaceConfigurationChange,c=e.applyWorkspaceEdit,s=(0,P.ZP)();s.setMaxListeners(1/0);var u=null,d=tj.a.OFFLINE,f=tj.N.NOT_READY,h=null,p=!1,m=new Map,v=new Map,g=null;function y(e){if(!u)throw Error("Expected rootUri");var t=e.slice(u.length+1);try{return decodeURIComponent(t)}catch(e){throw B.$e(function(n){n.setExtra("fragment_to_decode",t),B.Tb(e)}),e}}function b(e){if(!u)throw Error("Expected rootUri");if(e.startsWith("/"))throw Error("Path must be relative. Got: ".concat(e));return u+"/"+e}function C(e){d!==e&&(d!==tj.a.INITIALIZED&&k(tj.N.NOT_READY),d=e,s.emit("SERVER_STATE_CHANGE",d))}function k(e){f!==e&&(f=e,s.emit("SERVER_HEALTH_CHANGE",f))}function _(e){s.emit("SEND_NOTIFICATION",e),n.write(t8(e))}function E(e){return T.apply(this,arguments)}function T(){return(T=(0,w._)(function(e){var t,r,o,a,l,c,u,f;return(0,S.Jh)(this,function(h){if(a=void 0===(o=(r=void 0===(t=e.options)?{}:t).id)?t2():o,l=r.signal,c=r.tap,u=(0,tO._)(e,["options"]),!Number.isInteger(a))throw Error("Request ID must be an integer");return n.didClose()?[2,Promise.resolve({result:null,cancelled:!0})]:(s.emit("REQUEST",{id:a,data:u}),null==l||l.addEventListener("abort",function(){I(a)},{once:!0}),n.write(t8((0,x._)((0,Z._)({},u),{id:a}))),null===g&&(g=setTimeout(function(){k(tj.N.STALLED)},3e4)),f=new Promise(function(e){v.set(a,e)}),c&&c(f),[2,f.then(function(e){return null!==g&&(clearTimeout(g),g=null),d!==tj.a.INITIALIZED||e.cancelled||k(tj.N.READY),(function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=tJ[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(a.supports(e))return a}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return new tK})(i).onResponse(u.method,e)})])})})).apply(this,arguments)}function R(e,t){n.write(t8((0,x._)((0,Z._)({},t),{id:e})))}function I(e){var t=v.get(e);t&&(s.emit("CANCEL_REQUEST",e),t({result:null,cancelled:!0}),v.delete(e),_({method:"$/cancelRequest",params:{id:e}}))}var D=0,G=new Y(function(e){var t=v.get(e.id);if(e.id&&t){v.delete(e.id);var n=e.result,r=e.error;if((void 0!==n||r)&&s.emit("RESPONSE",e),void 0!==n){D=0,t({result:n,cancelled:!1});return}if(r){D++;var o=r.code,l=r.message,u=r.data;H.kg.error("LSP request failed",{code:o,lspId:i,errorMessage:l,data:JSON.stringify(u)}),t({error:r}),D>20&&(H.kg.error("LSP experienced 20 consecutive errors. Setting server health to 'BROKEN",{lspId:i}),k(tj.N.BROKEN),D=0);return}throw H.kg.error("LSP response message contained neither error nor result"),new t$.Z("Expected either message or error in LSP response").setExtra("message",JSON.stringify(e))}var d=e.method;if("client/registerCapability"===d){var f=e.params.registrations;if(!f||!Array.isArray(f))throw Error("Expected registrations array");f.forEach(function(e){var t=e.method;if(!t)throw Error("Expected registration method");if(!h)throw Error("Expected server capabilities");var n=e.registerOptions||!0;switch(t){case"textDocument/definition":h.definitionProvider=!0;break;case"textDocument/typeDefinition":h.typeDefinitionProvider=!0;break;case"textDocument/implementation":h.implementationProvider=!0;break;case"textDocument/references":h.referencesProvider=!0;break;case"textDocument/hover":h.hoverProvider=!0;break;case"textDocument/completion":h.completionProvider=n;break;case"textDocument/formatting":h.documentFormattingProvider=n;break;case"textDocument/rename":h.renameProvider=n;break;case"textDocument/codeAction":h.codeActionProvider=n;break;case"textDocument/signatureHelp":h.signatureHelpProvider=n;break;case"textDocument/didSave":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,x._)((0,Z._)({},h.textDocumentSync||{}),{save:n});break;case"textDocument/willSaveWaitUntil":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,x._)((0,Z._)({},h.textDocumentSync||{}),{willSave:!0});break;case"textDocument/didChange":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,x._)((0,Z._)({},h.textDocumentSync||{}),{change:n});break;case"textDocument/didOpen":case"textDocument/didClose":if("number"==typeof h.textDocumentSync)break;h.textDocumentSync=(0,x._)((0,Z._)({},h.textDocumentSync||{}),{openClose:!0});break;case"workspace/executeCommand":h.executeCommandProvider=n;break;default:H.kg.info("Unexpected dynamically registered capability in LSP client",{method:t})}s.emit("SERVER_CAPABILITIES_CHANGE",h)}),R(e.id,{result:null,cancelled:!1});return}if("workspace/applyEdit"===d){c(e.params).then(function(t){R(e.id,{result:t,cancelled:!1})});return}if("textDocument/publishDiagnostics"===d){var p=y(e.params.uri),g=m.get(p);if(!g)return;var b=e.params.diagnostics;if(tX()(g.diagnostics,b))return;g.diagnostics=b,s.emit("DIAGNOSTICS",{path:p,diagnostics:b});return}if("workspace/configuration"===d){var w,C=e.params,S=Array(C.items.length).fill(null),_=null!==(w=null==a?void 0:a())&&void 0!==w?w:null;_&&(S=C.items.map(function(e){return e.section?tW()(_,e.section):_})),R(e.id,{result:S,cancelled:!1})}("window/logMessage"===d||"telemetry/event"===d)&&s.emit("RECEIVE_NOTIFICATION",e)});function A(e){if(!h)throw Error("Expected client to be initialized");if(!h[e])throw Error("LSP Server does not support ".concat(e.replace(/Provider$/,"")));return h[e]}function N(e){return u&&e?e.filter(function(e){return"uri"in e?e.uri.startsWith(u):e.targetUri.startsWith(u)}):e}n.read(G.read);var L=function(){};return{initialize:function(e){var n=e.pwd,r=e.initializationOptions;return(0,w._)(function(){var e,i;return(0,S.Jh)(this,function(o){switch(o.label){case 0:return C(tj.a.INITIALIZING),u="file://".concat(n),[4,E({method:"initialize",params:{initializationOptions:r,capabilities:tz({configurationSupport:{serverToClient:!!a,clientToServer:!!l}}),processId:null,rootUri:u,workspaceFolders:[{name:u,uri:u}]}})];case 1:if("error"in(e=o.sent()))throw Error("Something went wrong initializing the LSP client: ".concat(e.error.message));if(e.cancelled)throw Error("Initialize request cancelled");if(!e.result)throw Error("Expected result in initialize request");return _({method:"initialized",params:{}}),h=e.result.capabilities,t=e.result.serverInfo,s.emit("SERVER_CAPABILITIES_CHANGE",h),C(tj.a.INITIALIZED),l&&(L=l(function(e){_({method:"workspace/didChangeConfiguration",params:{settings:e}})})),a&&(i=a())&&_({method:"workspace/didChangeConfiguration",params:{settings:i}}),[2]}})})()},generateId:t2,notify:{didOpen:function(e,t){if(!r(e))throw Error("Path not supported");var n,o=m.get(e);if(o&&0!==o.buffers){o.buffers++,m.set(e,o);return}var a=null!==(n=null==o?void 0:o.version)&&void 0!==n?n:0;m.set(e,{version:a,buffers:1,diagnostics:[]}),_({method:"textDocument/didOpen",params:{textDocument:{uri:b(e),languageId:t1(e,i),text:t,version:a}}})},didChange:function(e,t){var n=m.get(e);if(!n)throw Error('Document for "'.concat(e,'" is not open'));n.version++,_({method:"textDocument/didChange",params:{textDocument:{uri:b(e),version:n.version},contentChanges:t}})},didSave:function(e){if(!m.get(e))throw Error('Document for "'.concat(e,'" is not open'));A("textDocumentSync"),_({method:"textDocument/didSave",params:{textDocument:{uri:b(e)}}})},didClose:function(e){var t=m.get(e);if(!t)throw Error('Document for "'.concat(e,'" is not open'));t.buffers--,t.buffers>0||(_({method:"textDocument/didClose",params:{textDocument:{uri:b(e)}}}),m.delete(e))},cancelRequest:function(e){I(e)}},request:{completion:function(e,t,n,r){return A("completionProvider"),E({options:r,method:"textDocument/completion",params:{textDocument:{uri:b(e)},position:t,context:n}})},resolveCompletionItem:function(e){if(!A("completionProvider").resolveProvider)throw Error("LSP Server does not support resolving completion items");return E({method:"completionItem/resolve",params:e})},signatureHelp:function(e,t,n){return E({options:n,method:"textDocument/signatureHelp",params:{textDocument:{uri:b(e)},position:t}})},hover:function(e,t,n){return E({options:n,method:"textDocument/hover",params:{textDocument:{uri:b(e)},position:t}})},codeActions:function(e,t,n,r){var i=m.get(e);if(!i)throw Error("Document for path ".concat(e," is not open."));var o=i.diagnostics.filter(function(e){return(0,tQ.dI)(e.range,t)});return E({method:"textDocument/codeAction",params:{textDocument:{uri:b(e)},range:t,context:(0,x._)((0,Z._)({},r),{diagnostics:o})},options:n})},resolveCodeAction:function(e){return E({method:"codeAction/resolve",params:e})},executeCommand:function(e,t){return E({method:"workspace/executeCommand",params:{command:e,arguments:t}})},format:function(e,t){return A("documentFormattingProvider"),E({method:"textDocument/formatting",params:{textDocument:{uri:b(e)},options:t}})},formatRange:function(e,t,n){return A("documentRangeFormattingProvider"),E({method:"textDocument/rangeFormatting",params:{textDocument:{uri:b(e)},range:t,options:n}})},findDefinitions:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,w._)(function(){var i,o;return(0,S.Jh)(this,function(a){switch(a.label){case 0:return A("definitionProvider"),[4,E({options:n,method:"textDocument/definition",params:{textDocument:{uri:b(e)},position:t}})];case 1:if(!1!==(i=a.sent()).cancelled)return[2,i];return(o=i.result)&&r&&(o=N(Array.isArray(o)?o:[o])),[2,(0,x._)((0,Z._)({},i),{result:o})]}})})()},findTypeDefinitions:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,w._)(function(){var i,o;return(0,S.Jh)(this,function(a){switch(a.label){case 0:return A("typeDefinitionProvider"),[4,E({options:n,method:"textDocument/typeDefinition",params:{textDocument:{uri:b(e)},position:t}})];case 1:if(!1!==(i=a.sent()).cancelled)return[2,i];return(o=i.result)&&r&&(o=N(Array.isArray(o)?o:[o])),[2,(0,x._)((0,Z._)({},i),{result:o})]}})})()},findImplementations:function(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];return(0,w._)(function(){var i,o;return(0,S.Jh)(this,function(a){switch(a.label){case 0:return A("implementationProvider"),[4,E({options:n,method:"textDocument/implementation",params:{textDocument:{uri:b(e)},position:t}})];case 1:if(!1!==(i=a.sent()).cancelled)return[2,i];return(o=i.result)&&r&&(o=N(Array.isArray(o)?o:[o])),[2,(0,x._)((0,Z._)({},i),{result:o})]}})})()},findReferences:function(e,t,n){return A("referencesProvider"),E({method:"textDocument/references",params:{textDocument:{uri:b(e)},position:t,context:n}})},rename:function(e,t,n,r){return A("renameProvider"),E({options:r,method:"textDocument/rename",params:{textDocument:{uri:b(e)},position:t,newName:n}})},prepareRename:function(e,t){var n=A("renameProvider");if("boolean"==typeof n||!n.prepareProvider)throw Error("LSP server does not support prepare rename");return E({method:"textDocument/prepareRename",params:{textDocument:{uri:b(e)},position:t}})},documentHighlights:function(e,t,n){return(0,w._)(function(){return(0,S.Jh)(this,function(r){switch(r.label){case 0:return[4,E({options:n,method:"textDocument/documentHighlight",params:{position:t,textDocument:{uri:b(e)}}})];case 1:return[2,r.sent()]}})})()},documentSymbol:function(e,t){return(0,w._)(function(){var n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:return[4,E({options:t,method:"textDocument/documentSymbol",params:{textDocument:{uri:b(e)}}})];case 1:if(!("result"in(n=r.sent())))return[2,n];if(n.result)return[2,{result:n.result,cancelled:!1}];return[2]}})})()}},onDiagnostics:(0,P.JV)(s,"DIAGNOSTICS"),onServerStateChange:(0,P.JV)(s,"SERVER_STATE_CHANGE"),onServerHealthChange:(0,P.JV)(s,"SERVER_HEALTH_CHANGE"),onServerCapabilitiesChange:(0,P.JV)(s,"SERVER_CAPABILITIES_CHANGE"),onRequest:(0,P.JV)(s,"REQUEST"),onResponse:(0,P.JV)(s,"RESPONSE"),onCancelRequest:(0,P.JV)(s,"CANCEL_REQUEST"),onSendNotification:(0,P.JV)(s,"SEND_NOTIFICATION"),onReceiveNotification:(0,P.JV)(s,"RECEIVE_NOTIFICATION"),shutdown:function(){for(var e in C(tj.a.EXITING),m.clear(),v)I(Number(e));L(),E({method:"shutdown"}).then(function(){_({method:"exit"}),C(tj.a.EXITED),s.removeAllListeners()})},isDestroyed:function(){return p},destroy:function(){for(var e in p=!0,m.clear(),v)I(Number(e));L(),C(tj.a.EXITED),s.removeAllListeners()},getServerState:function(){return d},getServerHealth:function(){return f},getServerCapabilities:function(){return h},getServerInfo:function(){return t},getDiagnostics:function(e){var t=m.get(e);if(!t)throw Error("File with path ".concat(e," is not open."));return t.diagnostics},isOpen:function(e){return m.has(e)},documentUriToPath:y,pathToDocumentURI:b,isSupportedFile:r,getLanguageId:function(e){return t1(e,i)},clientId:i,clientName:o}}({connection:{read:function(e){"open"===u.status&&u.onCommand(function(t){t.output&&e(t.output)})},write:function(e){if("open"!==u.status){(null==m?void 0:m.isDestroyed())&&H.kg.error("LSPNix: tried to write to channel but the lsp client is already destroyed");return}u.send({input:e})},didClose:function(){return"open"!==u.status}},clientId:e,clientName:c[e].option.name,isSupportedFile:function(e){return(0,tA.F)(e,d)},applyWorkspaceEdit:(g=(0,w._)(function(e){var t;return(0,S.Jh)(this,function(n){return(t=e.edit,m)?[2,(0,tU.w)({edit:t,fs:r,client:m})]:[2,{applied:!1}]})}),function(e){return g.apply(this,arguments)}),getWorkspaceConfiguration:function(){if(!(null===(e=d.config)||void 0===e?void 0:e.configurationJson))return null;var e,t=null;try{t=JSON.parse(d.config.configurationJson)}catch(e){H.kg.error("Failed to parse LSP workspace configuration",{configurationJson:d.config.configurationJson})}return t}}),null===(y=d.config)||void 0===y?void 0:y.initializationOptionsJson)try{E=JSON.parse(d.config.initializationOptionsJson)}catch(e){H.kg.error("Failed to parse LSP initializationOptions",{initializationOptionsJson:d.config.initializationOptionsJson})}var i,g,y,_,E,T=m.initialize({pwd:t.workingDirectory,initializationOptions:E}).catch(function(t){if((null==t?void 0:t.message)!=="Initialize request cancelled")throw H.kg.error("LSPNix: failed to initialize client",{lspId:e,appService:"lspnix",originalError:null==t?void 0:t.message}),t});v.push(m.onServerHealthChange(function(t){if(t===tj.N.BROKEN&&(H.kg.info("LSP: Server health broken",{lspId:e}),b(),s)){H.kg.info("LSP: retrying after server health broken",{lspId:e}),p(e,n,k);return}}),m.onServerStateChange((i=(0,w._)(function(t){var n,r,i,s,p,v,g,y,w,Z,x,k,_,E,R;return(0,S.Jh)(this,function(S){switch(S.label){case 0:if("open"!==u.status)return H.kg.info("LSPNix: channel wasn't open on state change",{lspId:e,appService:"lspnix",state:t}),b(),[2];if(!m)return H.kg.info("LSPNix: client was null on state change. This should never happen",{lspId:e,appService:"lspnix",state:t}),b(),[2];if(!t4(c[e].option,d))return H.kg.info("LSPNix: configuration changed and received state change",{lspId:e,appService:"lspnix",state:t}),b(),[2];if(t===tj.a.EXITED)return H.kg.info("LSP server exited via 'exit' notification",{lspId:e,appService:"lspnix"}),b(),[2];if(t!==tj.a.INITIALIZED)return[2];return[4,T];case 1:if(S.sent(),"open"!==u.status)return H.kg.info("LSPNix: channel wasn't open after initialization",{lspId:e,appService:"lspnix"}),b(),[2];h(m),f.delete(e),c[e].client=m,n=!0,r=!1,i=void 0;try{for(s=a[Symbol.iterator]();!(n=(p=s.next()).done);n=!0)if(g=(v=(0,C._)(p.value,2))[0],y=v[1],(0,tA.F)(g,d)&&(w=l.get(g),o||!w||!w.size)){Z=w?w.add(m):new Set([m]),l.set(g,Z),x=!0,k=!1,_=void 0;try{for(E=y[Symbol.iterator]();!(x=(R=E.next()).done);x=!0)(0,R.value)(Array.from(Z))}catch(e){k=!0,_=e}finally{try{x||null==E.return||E.return()}finally{if(k)throw _}}}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return[2]}})}),function(e){return i.apply(this,arguments)})))})}}),function(e){b(e.willReconnect)}}),c[e].closeChannel=g,[2]}})})).apply(this,arguments)}function g(e){var t=null==e?void 0:e.languageServers;if(!t||0===t.length){var n=!0,r=!1,i=void 0;try{for(var o,a=Object.keys(c)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;u(l)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return}var s={},f=!0,h=!1,p=void 0;try{for(var m,v=t[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;s[g.id]=g}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}var y=!0,b=!1,w=void 0;try{for(var Z,x=Object.keys(c)[Symbol.iterator]();!(y=(Z=x.next()).done);y=!0){var C=Z.value;s[C]||u(C)}}catch(e){b=!0,w=e}finally{try{y||null==x.return||x.return()}finally{if(b)throw w}}var S=!0,k=!1,_=void 0;try{for(var E,T=Object.keys(s)[Symbol.iterator]();!(S=(E=T.next()).done);S=!0){var R=E.value,I=c[R],D=s[R];if(!I){d(R,D);continue}t4(I.option,D)||(u(R),d(R,D))}}catch(e){k=!0,_=e}finally{try{S||null==T.return||T.return()}finally{if(k)throw _}}}function y(){return(y=(0,w._)(function(){var e;return(0,S.Jh)(this,function(t){try{e=n.configs.current,g(e),n.configs.subscribe(g)}catch(e){H.kg.error("LSP initialization failed: "+e.message)}return[2]})})).apply(this,arguments)}return!function(){y.apply(this,arguments)}(),{disable:function(){if(s){s=!1;var e=!0,t=!1,n=void 0;try{for(var r,i=Object.values(c)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;o.closeChannel(),null===(h=o.client)||void 0===h||h.destroy(),o.client=null;var u=!0,d=!1,f=void 0;try{for(var h,p,m=a[Symbol.iterator]();!(u=(p=m.next()).done);u=!0){var v=(0,C._)(p.value,2),g=v[0],y=v[1];if(l.has(g)){l.delete(g);var b=!0,w=!1,Z=void 0;try{for(var x,S=y[Symbol.iterator]();!(b=(x=S.next()).done);b=!0)(0,x.value)([])}catch(e){w=!0,Z=e}finally{try{b||null==S.return||S.return()}finally{if(w)throw Z}}}}}catch(e){d=!0,f=e}finally{try{u||null==m.return||m.return()}finally{if(d)throw f}}}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},enable:function(){if(!s){s=!0;var e=!0,t=!1,n=void 0;try{for(var r,i=Object.keys(c)[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;m(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},onClient:function(e,t){a.has(e)||a.set(e,[]),null===(d=a.get(e))||void 0===d||d.push(t);var n=l.get(e);if(n&&n.size)t(Array.from(n));else{var r=[],i=!0,s=!1,u=void 0;try{for(var d,f,h=Object.values(c)[Symbol.iterator]();!(i=(f=h.next()).done);i=!0){var p=f.value;if((0,tA.F)(e,p.option)&&p.client&&(r.push(p.client),!o))break}}catch(e){s=!0,u=e}finally{try{i||null==h.return||h.return()}finally{if(s)throw u}}r.length&&t(r)}return function(){var n,r=null!==(n=a.get(e))&&void 0!==n?n:[];a.set(e,r.filter(function(e){return e!==t}))}}}}({container:ti,toolchain:tg,fs:td,enableMultipleLSPClientsPerFile:void 0!==e3&&e3}),tB=(ee=($={container:ti,beforeRun:tw}).container,et=$.beforeRun,er=(0,P.ZP)(),el=tG.Z.Idle,eu=new Date(0),ed=!1,er.on(tG.z.TEST_RESULT,function(e){ed=ed&&"passed"===e.body}),ef=function(e){er.emit(tG.z.STATE_CHANGED,e),el=e},ep=(0,w._)(function(e,t){var n,r,i,o,a,l,c,s,u,d,f;return(0,S.Jh)(this,function(h){switch(h.label){case 0:if(n=tD.api.Payload.fromObject(t),r=tD.api.Payload.verify(n))throw r;return i=new(tP())(function(e){var t=tD.api.Response.fromObject(e),r=tD.api.Response.verify(t);if(r){B.Tb(TypeError("invalid payload received"),function(i){return i.setExtras({validationError:r,payload:n,message:e,response:t})});return}switch(t.body){case"error":return er.emit(tG.z.ERROR,t.error);case"instructionResult":return er.emit(tG.z.INSTRUCTION_RESULT,t.instructionResult);case"testResult":return er.emit(tG.z.TEST_RESULT,t.testResult);case"status":switch(t.status){case tD.api.Status.Ready:return ef(tG.Z.Ready);case tD.api.Status.Building:return ef(tG.Z.Building);case tD.api.Status.Running:return ef(tG.Z.Running)}}}),o=e.onCommand(function(e){if(e.output)try{i.submit(e.output)}catch(t){B.Tb(SyntaxError("invalid response received from i/o testing binary"),function(r){return r.setExtras({err:t,payload:n,cmd:e})})}}),a=e.request({exec:{args:["io-tester"],splitStderr:!0,lifecycle:_.api.Exec.Lifecycle.STDIN,splitLogs:!0}}),[4,new Promise(function(e,t){var n,r=function(){n(),e()};er.once(tG.z.STATE_CHANGED,r);var i=setTimeout(function(){n(),t(Error("timeout while waiting for iotester to start"))},2e4);n=function(){clearTimeout(i),er.off(tG.z.STATE_CHANGED,r)}})];case 1:return h.sent(),[4,e.request({input:JSON.stringify(n)+"\n"})];case 2:if(!(l=h.sent()).ok)throw s=Error(null!==(c=l.error)&&void 0!==c?c:"unexpected error occurred while sending input to i/o testing binary"),B.Tb(s,function(e){return e.setExtra("status",l)}),s;return[4,a];case 3:return(u=h.sent()).ok||(f=Error(null!==(d=u.error)&&void 0!==d?d:"unexpected error occurred while executing i/o testing binary"),B.Tb(f,function(e){return e.setExtra("result",u)})),o(),[2]}})}),{run:function(e){if(el!==tG.Z.Idle)throw Error("iotester already running");return ef(tG.Z.Starting),eu=new Date,ed=!0,et().then(function(){return new Promise(function(t){var n=ee.openChannel({service:"exec"},function(r){var i="",o="",a=r.channel.onCommand(function(e){e.log?i+=e.log:e.stderr&&(o+=e.stderr)});return t((function(e,t){return ep.apply(this,arguments)})(r.channel,e).finally(function(){a(),n(),(o||i)&&B.Tb(Error("logs received from IOTester"),function(t){return t.setExtras({logs:i,stderr:o,payload:e})})})),n})})}).catch(function(e){return ed=!1,Promise.reject(e)}).finally(function(){return ef(tG.Z.Idle)})},get lastRunAt(){return eu},get state(){return el},get lastRunDidPass(){return ed},onInstructionResult:function(e){return er.on(tG.z.INSTRUCTION_RESULT,e),function(){er.off(tG.z.INSTRUCTION_RESULT,e)}},onStateChanged:function(e){return er.on(tG.z.STATE_CHANGED,e),function(){er.off(tG.z.STATE_CHANGED,e)}},onTestResult:function(e){return er.on(tG.z.TEST_RESULT,e),function(){er.off(tG.z.TEST_RESULT,e)}},onError:function(e){return er.on(tG.z.ERROR,e),function(){er.off(tG.z.ERROR,e)}}}),tN=(ey=(ev={container:ti,fs:td}).container,ew=ev.fs,ek=void 0===(ex=ev.provideProfiles)?tS:ex,(e_=(0,P.ZP)()).setMaxListeners(1/0),eE=t_(),eT=!1,eR=new Map,eI=null,eD=ey.getContext(),eP=new eA({container:ey,getEnv:function(){return eE},awaitPromise:(eG=(0,w._)(function(e){var t,n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:return[4,ek({defaultUsername:null==eD?void 0:null===(t=eD.currentUser)||void 0===t?void 0:t.username,defaultUserId:null==eD?void 0:null===(n=eD.currentUser)||void 0===n?void 0:n.id,onProfiles:function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=(0,C._)(o.value,2),c=l[0],s=l[1];eR.set(c,s),e_.emit(eo.dq.NEW_PROFILE)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}t.has(eo.rG.GITHUB)||eR.delete(eo.rG.GITHUB);var u=eR.get(eo.rG.REPLIT_DEFAULT),d=eR.get(eo.rG.GITHUB);if(eI&&!e&&(e=eI.provider),e===eo.rG.GITHUB&&d)eI=d;else{if(!u)return;eI=u}e_.emit(eo.dq.CHANGED_PROFILE)}})];case 1:return[2,r.sent()]}})}),eB=function(e){return eG.apply(this,arguments)})(eo.rG.GITHUB)}),e_.on(eo.dq.FS_CHANGE,function(){return eP.cache.invalidate()}),e_.on(eo.dq.FORCED_REFRESH,function(){return eP.cache.invalidate()}),e_.on(eo.dq.NEW_PROFILE,function(){return eP.cache.invalidate()}),e_.on(eo.dq.CHANGED_PROFILE,function(){return eP.cache.invalidate()}),eN=function(){var e,t=ey.getContext(),n=null==t?void 0:null===(e=t.currentUser)||void 0===e?void 0:e.id;if(null!=n){var r="[user]\n";""!==eE.GIT_AUTHOR_EMAIL&&(r+="email = ".concat(eE.GIT_AUTHOR_EMAIL.replace(/'/g,"'\"'\"'"),"\n")),""!==eE.GIT_AUTHOR_NAME&&(r+="name = ".concat(eE.GIT_AUTHOR_NAME.replace(/'/g,"'\"'\"'"),"\n"));var i="/run/replit/user/".concat(n,"/.config/git"),o="".concat(i,"/config");null!=n&&ey.exec("bash","-c","mkdir -p ".concat(i," && echo '").concat(r,"' > ").concat(o,".new && mv ").concat(o,".new ").concat(o))}},ey.onConnectionStateChanged(function(e){e===O.em.CONNECTED&&eN()}),e_.on(eo.dq.CHANGED_PROFILE,eN),e_.on(eo.dq.CHANGED_PROFILE,function(){null!=eI&&(eE=t_({author:{username:eI.username,email:eI.email}}))}),{getEnv:function(){return eE},getProfiles:function(){return Array.from(eR.values())},hasProfile:function(e){return eR.has(e)},getProfile:function(e){var t=eR.get(e);if(!t)throw Error("Fetched a profile that has not been setup!");return t},addProfile:function(e){eR.set(e.provider,e),e_.emit(eo.dq.NEW_PROFILE)},getCurrentProfile:function(){return eI},setCurrentProfile:function(e){var t=eR.get(e);if(!t)throw Error("Can't set a non-existent profile!");eI=t,eE=t_({author:{username:t.username,email:t.email}}),e_.emit(eo.dq.CHANGED_PROFILE)},onProfileAdded:function(e){var t=function(){e(Array.from(eR.values()))};return e_.on(eo.dq.NEW_PROFILE,t),function(){e_.off(eo.dq.NEW_PROFILE,t)}},onCurrentProfileChanged:function(e){var t=function(){e(eI)};return e_.on(eo.dq.CHANGED_PROFILE,t),function(){e_.off(eo.dq.CHANGED_PROFILE,t)}},refreshProfiles:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).preferredProvider;return eB(e)},onRefresh:function(e){eT||(function(e,t,n){var r,i,o,a,l,c,s,u,d,f,h=!1,p=!1,m=(r=function(){return n.emit(eo.dq.FS_CHANGE)},a=(i={wait:1e3,cooldown:5e3,maxWait:5e3}).wait,l=i.cooldown,c=i.maxWait,s=null,u=!1,d=eL()(function(e){return s=setTimeout(function(){return s=null},l),u=!1,o=r.apply(void 0,(0,X._)(e))},a,{maxWait:c}),(f=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return null!==s?o:(u||(u=!0),d(t))}).cancel=function(){null!==s?(clearTimeout(s),s=null):(d.cancel(),u=!1)},f.flush=function(){return null!==s?(clearTimeout(s),s=null,o):d.flush()},f.isPending=function(){return u},f.isInCooldown=function(){return null!==s},f);function v(){return(v=(0,w._)(function(){var n;return(0,S.Jh)(this,function(r){return n=!0,t.watchDir(tT.Ql,{onChange:function(r){!h&&r.find(function(e){return e.filename===tI&&e.type===tR.Tv.Directory})&&(function(){if(!h){h=!0;var n=!0;t.watchDir(tI,{onChange:function(){n?n=!1:m()},onMoveOrDelete:function(){h=!1,m()},onError:function(t,n){h=!1,RegExp(".+permission denied","im").test(t.message)||e.unrecoverableError(t,n)}})}}(),n||m()),n&&(n=!1)},onError:function(t,n){return e.unrecoverableError(t,n)}}),[2]})})).apply(this,arguments)}(function(){v.apply(this,arguments)})(),t.onStatusChange(function(e){h&&(e===tR.kO.Syncing&&m.isInCooldown()?p=!0:e===tR.kO.Clean&&(p||m(),p=!1))})}(ey,ew,e_),eT=!0);var t=function(){return e(eo.dq.FS_CHANGE)},n=function(){return e(eo.dq.FORCED_REFRESH)},r=function(){return e(eo.dq.NEW_PROFILE)},i=function(){return e(eo.dq.CHANGED_PROFILE)};return e_.on(eo.dq.FS_CHANGE,t),e_.on(eo.dq.FORCED_REFRESH,n),e_.on(eo.dq.NEW_PROFILE,r),e_.on(eo.dq.CHANGED_PROFILE,i),function(){e_.off(eo.dq.FS_CHANGE,t),e_.off(eo.dq.FORCED_REFRESH,n),e_.off(eo.dq.NEW_PROFILE,r),e_.off(eo.dq.CHANGED_PROFILE,i)}},forceRefresh:function(){e_.emit(eo.dq.FORCED_REFRESH)},isBusy:function(){return eP.running.current},onBusyChange:function(e){var t=!1,n=eL()(e,200);return eP.running.subscribe(function(e){t&&!e?(n(!1),t=!1):!t&&e&&(n(!0),t=!0)})},init:eP.wrap(e9,"write"),isInitialized:eP.wrap(te,"read"),lsFiles:eP.wrap(to,"read"),status:eP.wrap(eC.Z,"read"),log:eP.wrap(tr,"read"),findDefaultBranches:eP.wrap(eJ,"read"),listBranches:eP.wrap(e$.ZP,"read"),setBranchUpstream:eP.wrap(Q,"write"),stageFiles:eP.wrap(tp,"write"),commit:eP.wrap(eM,"write"),switchBranch:eP.wrap(eF,"write"),branchExists:eP.wrap(eh,"read"),createBranch:eP.wrap(eH,"write"),getRemotes:eP.wrap(e4,"read"),fetch:eP.wrap(ez,"write"),canMergeBranches:eP.wrap(em,"read"),pull:eP.wrap(tl.Z,"write"),push:eP.wrap(tc,"write"),getRepositoryState:eP.wrap(ei.ZP,"read"),getFileContents:eP.wrap(e2,"read"),addRemote:eP.wrap(eU,"write"),removeRemote:eP.wrap(tu,"write"),setRemoteURL:eP.wrap(tf,"write"),getBranch:eP.wrap(eQ,"read"),restoreFiles:eP.wrap(eS,"write"),lastFetched:eP.wrap(es,"read"),merge:eP.wrap(eg,"write"),mergeContinue:eP.wrap(eZ,"write"),mergeAbort:eP.wrap(eb,"write"),getConflictingFiles:eP.wrap(en,"read"),getMergingRefs:eP.wrap(ea,"read"),getFilesForCommit:eP.wrap(ec.Z,"read")}),tL=function(e){var t,n,r=e.container,i=e.nixService;function o(e){return a.apply(this,arguments)}function a(){return(a=(0,w._)(function(e){return(0,S.Jh)(this,function(t){switch(t.label){case 0:if(e&&(n=void 0),!n){var r;n=new Promise((r=(0,w._)(function(e){var t,n;return(0,S.Jh)(this,function(r){switch(r.label){case 0:return[4,i.listPackages()];case 1:if(null==(n=r.sent())?void 0:null===(t=n.packages)||void 0===t?void 0:t.some(function(e){return"pkgs.postgresql"===e.name}))return[3,3];return[4,i.addPackages(["pkgs.postgresql"])];case 2:return r.sent(),e(),[3,4];case 3:e(),r.label=4;case 4:return[2]}})}),function(e){return r.apply(this,arguments)}))}return[4,n];case 1:return t.sent(),[2]}})})).apply(this,arguments)}return{ensureNixPsqlPackageInstalled:o,run:(t=(0,w._)(function(e){var t,n,i,a,l,c,s,u,d,f,h,p,m;return(0,S.Jh)(this,function(v){switch(v.label){case 0:return t=e.query,n=e.connectionString,[4,o()];case 1:v.sent(),i=(0,t7.Z)({container:r}),a=[],l=null,c=new t9.t(function(e){return a.push(e)}),s=null,u=!1,d=new Promise(function(e){var t=i.onStateChanged(function(n){var r=n.state,i=n.stderrBuffer;if(r===_.api.State.Running){u=!0;return}u&&(s=i,t(),e())})}),i.onOutput(function(e){try{c.process(e)}catch(t){l||(l=t,B.Tb(t,function(t){return t.setExtra("chunk",e)}))}}),v.label=2;case 2:return v.trys.push([2,,5,6]),[4,i.request({args:["psql",n,"--csv","--command",t],splitStderr:!0})];case 3:return f=v.sent(),[4,d];case 4:return v.sent(),f.error&&!s&&(s=f.error),c.flush(),[3,6];case 5:return i.dispose(),[7];case 6:if(s)return[2,{columns:c.headers(),rows:a,error:s}];if(l)return h=l.message,[2,{columns:null!==(p=c.headers())&&void 0!==p?p:[],rows:a,error:h}];return[2,{columns:null!==(m=c.headers())&&void 0!==m?m:[],rows:a,error:null}]}})}),function(e){return t.apply(this,arguments)})}}({container:ti,nixService:tv}),tM=(0,nh.Z)({fs:td}),{session:ts,presence:th,packager:ty,container:ti,fs:td,runner:tC,debuggest:tZ,broadcast:tk,dotReplit:tm,nixService:tv,lspnix:tE,iotester:tB,git:tN,psql:tL,userEvents:ta,replspaceApi:tb,toolchain:tg,ports:tx,secrets:tM}}),1)[0];return null==t||t.span.end(),n}(u=b||(b={})).CHANNEL_OPENED="CHANNEL_OPENED",u.EVENT_SENT="EVENT_SENT"},41062:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(66626),i=n(50959);function o(e,t){var n=(0,r._)((0,i.useState)(null),2),o=n[0],a=n[1];return(0,i.useEffect)(function(){var n=!1;return e.readFile(t).then(function(e){n||a(e)}),function(){n=!0}},[e,t]),o}},57369:function(e,t,n){n.d(t,{ZP:function(){return f},y5:function(){return a},yG:function(){return o}});var r,i,o,a,l=n(27387),c=n(96583),s=n(75813);function u(e,t){return"{ ".concat(e,"; } > /dev/null 2>&1 && echo -n '").concat(t,"' && exit 0")}(r=o||(o={})).NOT_INITIALIZED="NOT_INITIALIZED",r.ON_UNBORN_BRANCH="ON_UNBORN_BRANCH",r.MERGING="MERGING",r.REBASING="REBASING",r.REVERTING="REVERTING",r.CHERRY_PICKING="CHERRY_PICKING",r.APPLYING_MAILBOX="APPLYING_MAILBOX",r.BISECTING="BISECTING",r.DIRTY_WORKTREE="DIRTY_WORKTREE",r.DIRTY_INDEX="DIRTY_INDEX",r.CLEAN="CLEAN",r.DETACHED_HEAD="DETACHED_HEAD",(i=a||(a={})).INITIALIZING="INITIALIZING",i.INTERMEDIATE="INTERMEDIATE",i.NORMAL="NORMAL",i.DETACHED_HEAD="DETACHED_HEAD";var d=[u("! git rev-parse --is-inside-work-tree","NOT_INITIALIZED"),u('[ "$(! git rev-parse HEAD -- 2>&1)" = "fatal: bad revision \'HEAD\'" ]',"ON_UNBORN_BRANCH"),u("git rev-parse -q --verify MERGE_HEAD","MERGING"),u("[ -d '.git/rebase-apply' ] && [ -f '.git/rebase-apply/applying' ]","APPLYING_MAILBOX"),u("[ -d '.git/rebase-apply' ] || [ -d '.git/rebase-merge' ]","REBASING"),u("git rev-parse -q --verify REVERT_HEAD","REVERTING"),u("git rev-parse -q --verify CHERRY_PICK_HEAD","CHERRY_PICKING"),u("[ -f '.git/BISECT_LOG' ]","BISECTING"),u("! git symbolic-ref -q HEAD","DETACHED_HEAD"),"git update-index -q --refresh > /dev/null || exit $?",u('{ ! git diff-files --quiet; } || [ -n "$(git ls-files --others --exclude-standard)" ]',"DIRTY_WORKTREE"),u("! git diff-index --cached --quiet HEAD --","DIRTY_INDEX"),'echo -n "CLEAN"'].join(";");function f(e){return h.apply(this,arguments)}function h(){return(h=(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,e(d,{serviceMethod:"git-get-repository-state"})];case 1:if((t=i.sent()).error)return[2,t];if(!(t.output in o))return[2,{error:s.aq.UNKNOWN}];return r=function(e){switch(e){case"NOT_INITIALIZED":case"ON_UNBORN_BRANCH":return"INITIALIZING";case"MERGING":case"REBASING":case"REVERTING":case"CHERRY_PICKING":case"APPLYING_MAILBOX":case"BISECTING":return"INTERMEDIATE";case"DIRTY_WORKTREE":case"DIRTY_INDEX":case"CLEAN":return"NORMAL";case"DETACHED_HEAD":return"DETACHED_HEAD"}}(n=t.output),[2,{state:n,type:r,error:null}]}})})).apply(this,arguments)}},65307:function(e,t,n){n.d(t,{Z:function(){return g},y:function(){return a}});var r,i,o,a,l=n(27387),c=n(66626),s=n(63257),u=n(96583);function d(e){switch(e){case"A":return"ADDED";case"C":return"COPIED";case"D":return"DELETED";case"M":return"MODIFIED";case"R":return"RENAMED";case"T":return"TYPE_CHANGED";case"U":return"UNMERGED";case"X":default:return"UNKNOWN";case"B":return"BROKEN"}}(r=a||(a={})).ADDED="ADDED",r.COPIED="COPIED",r.DELETED="DELETED",r.MODIFIED="MODIFIED",r.RENAMED="RENAMED",r.TYPE_CHANGED="TYPE_CHANGED",r.UNMERGED="UNMERGED",r.UNKNOWN="UNKNOWN",r.BROKEN="BROKEN";var f=(i=(0,l._)(function(e,t){var n;return(0,u.Jh)(this,function(r){switch(r.label){case 0:return[4,e("git log -1 --pretty=%P ".concat(t))];case 1:if((n=r.sent()).error)return[2,!1];return[2,n.output.trim().length>0]}})}),function(e,t){return i.apply(this,arguments)}),h=(o=(0,l._)(function(e,t){var n,r,i,o,a,l,c,s,d;return(0,u.Jh)(this,function(u){switch(u.label){case 0:return[4,e("git ls-tree --name-only -r ".concat(t),{serviceMethod:"git-get-files-for-commit"})];case 1:if((n=u.sent()).error)return[2,n];r=[],i=n.output.split("\n").filter(Boolean),o=!0,a=!1,l=void 0;try{for(c=i[Symbol.iterator]();!(o=(s=c.next()).done);o=!0)d=s.value,r.push({path:d,type:"ADDED"})}catch(e){a=!0,l=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw l}}return[2,{files:r,error:null}]}})}),function(e,t){return o.apply(this,arguments)});function p(){return(p=(0,l._)(function(e){return(0,u.Jh)(this,function(t){return[2,Array.from(e.matchAll(v)).map(function(e){var t=(0,c._)(e,4),n=t[1],r=t[2];return{path:t[3],originalPath:r,type:d(n)}})]})})).apply(this,arguments)}var m=/([ADMUXBT])\0([^\0]+)/g,v=/([RC])\d*\0([^\0]+)\0([^\0]+)/g;function g(e,t){return y.apply(this,arguments)}function y(){return(y=(0,l._)(function(e,t){var n,r,i;return(0,u.Jh)(this,function(o){switch(o.label){case 0:return[4,f(e,t)];case 1:if(!o.sent())return[2,h(e,t)];return[4,e("git diff-tree --no-commit-id --name-status -z -r -M ".concat(t),{serviceMethod:"git-get-files-for-commit"})];case 2:if((n=o.sent()).error)return[2,n];return[4,function(e){return p.apply(this,arguments)}(n.output)];case 3:return r=o.sent(),i=Array.from(n.output.matchAll(m)).map(function(e){var t=(0,c._)(e,3),n=t[1];return{path:t[2],type:d(n)}}),[2,{files:(0,s._)(r).concat((0,s._)(i)),error:null}]}})})).apply(this,arguments)}},21076:function(e,t,n){n.d(t,{CH:function(){return v},Dc:function(){return d},GE:function(){return f},LY:function(){return h},Pi:function(){return g},Qj:function(){return m},bF:function(){return p},dC:function(){return u}});var r=n(66626),i=n(50431),o=n(80433),a=n(75647),l=/[~^:?*[\\\0-\x20\x7F]/,c=/^(([A-Za-z0-9]+@|http(|s):\/\/)|(http(|s):\/\/[A-Za-z0-9]+@))([A-Za-z0-9.]+(:\d+)?)(?::|\/)([\d/\w.-]+?)$/,s=new RegExp([l,/^$/,/^\//,/\/$/,/\.lock$/,/\/{2,}/,/^\./,/\.$/,/\/\./,/\.\./,/@\{/,/^@$/,/^-/].map(function(e){return"(?:".concat(e.source,")")}).join("|"));function u(e){return 0===e.length||!l.test(e)}function d(e){return!s.test(e)}function f(e){return!s.test(e)}function h(e){return c.test(e)}function p(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"string"==typeof e?(0,i.C)(e):"commit"in e?e.type===a.HO.LOCAL||t&&e.type===a.HO.TRACKED?e.name:"".concat(e.remote,"/").concat(e.name):e.name}function m(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e)return e;if("commit"in e)return e.type===a.HO.LOCAL||t&&e.type===a.HO.TRACKED?"refs/heads/".concat(e.name):"refs/remotes/".concat(e.remote,"/").concat(e.name);if(e.type===o.l.BRANCH)return"refs/heads/".concat(e.name);if(e.type===o.l.REMOTE_BRANCH)return"refs/remotes/".concat(e.remote,"/").concat(e.branch);throw Error("Unknown branch object")}function v(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("string"==typeof e)return t&&!e.startsWith("refs/remotes/")?null:(0,r._)((0,i.Tg)(e),1)[0];if("commit"in e)return t&&e.type!==a.HO.REMOTE?null:e.remote;if(e.type===o.l.BRANCH)return null;if(e.type===o.l.REMOTE_BRANCH)return e.remote;throw Error("Unknown branch object")}function g(e,t){return e===t||null!==e&&null!==t&&m(e)===m(t)}},80433:function(e,t,n){n.d(t,{L:function(){return function e(t){var n;switch("HEAD"===(n=t)||"refs/HEAD"===n||n.startsWith(l)?"HEAD":n.startsWith(c)?"BRANCH":n.startsWith(s)?f.test(n)?"REMOTE_HEAD":"REMOTE_BRANCH":n.startsWith(d)||n.startsWith(u)?"TAG":"BRANCH"){case"HEAD":if(t.startsWith(l)){if(t.endsWith("(detached)"))return{type:"HEAD",name:"HEAD",detached:!0,ref:null};return{type:"HEAD",name:"HEAD",detached:!1,ref:e(t.slice(l.length))}}return{type:"HEAD",name:"HEAD",detached:!1,ref:null};case"REMOTE_HEAD":var r=t.slice(s.length);return{type:"REMOTE_HEAD",name:"HEAD",remote:(0,o._)(r.split("/"),1)[0]};case"BRANCH":return{type:"BRANCH",name:t.startsWith(c)?t.slice(c.length):t};case"REMOTE_BRANCH":var i=t.slice(s.length),h=(0,a._)(i.split("/"));return{type:"REMOTE_BRANCH",name:i,remote:h[0],branch:h.slice(1).join("/")};case"TAG":return t.startsWith(u)&&(t=t.slice(u.length)),t.startsWith(d)&&(t=t.slice(d.length)),{type:"TAG",name:t}}}},l:function(){return i}});var r,i,o=n(66626),a=n(78950),l="HEAD -> ",c="refs/heads/",s="refs/remotes/",u="tag: ",d="refs/tags/",f=/^refs\/remotes\/([^/]+)\/HEAD$/;(r=i||(i={})).HEAD="HEAD",r.REMOTE_HEAD="REMOTE_HEAD",r.BRANCH="BRANCH",r.REMOTE_BRANCH="REMOTE_BRANCH",r.TAG="TAG"},75647:function(e,t,n){n.d(t,{HO:function(){return i},ZP:function(){return h},p3:function(){return d}});var r,i,o=n(27387),a=n(66626),l=n(63257),c=n(96583),s=n(50431),u=n(80433);function d(e,t){return!!e&&!!t&&(e===t||e.name===t.name&&e.remote===t.remote)}function f(e){var t=(0,a._)(e.split("	"),6),n=t[0],r=t[1],i=t[2],o=t[3],l=t[4],c=t[5],d=(0,u.L)(n),f={hash:i,author:{name:o,email:(0,s.tc)(l),date:1e3*parseInt(c,10)}};if(d.type===u.l.BRANCH){var h=r?(0,u.L)(r):null,p=h&&(h.type===u.l.REMOTE_BRANCH||h.type===u.l.BRANCH)?h:null;return{type:"LOCAL",name:d.name,push:p,remote:null,tracking:null,commit:f}}return d.type===u.l.REMOTE_BRANCH?{type:"REMOTE",name:d.branch,remote:d.remote,push:null,tracking:null,commit:f}:null}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,o._)(function(e){var t,n,r=arguments;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return[4,e(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!1===e.local&&!1===e.remote)throw Error("Cannot specify both local and remote as false");var t=[];if(t.push('--format="%(refname)%09%(push)%09%(objectname)%09%(authorname)%09%(authoremail)%09%(authordate:unix)"'),e.max&&t.push("--count=".concat(e.max)),e.pattern){if("string"==typeof e.pattern)t.push((0,s.Gw)(e.pattern));else{var n,r,i=e.pattern.map(function(e){return(0,s.Gw)(e)});t.push.apply(t,(0,l._)(i))}}else(null===(n=e.local)||void 0===n||n)&&t.push("refs/heads"),(null===(r=e.remote)||void 0===r||r)&&t.push("refs/remotes");return"git for-each-ref ".concat(t.join(" "))}(r.length>1&&void 0!==r[1]?r[1]:{}),{serviceMethod:"git-list-branches"})];case 1:if((t=i.sent()).error)return[2,t];return(n=function(e){var t=[],n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var s=a.value;"LOCAL"===s.type?t.push(s):"REMOTE"===s.type&&n.push(s)}}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}var d=new Set,f=[],h=!0,p=!1,m=void 0;try{for(var v,g=n[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)!function(){var e=v.value,n=t.find(function(t){return t.push&&t.push.type===u.l.REMOTE_BRANCH&&t.push.remote===e.remote&&t.push.branch===e.name&&t.name===e.name});n&&(d.add(e),d.add(n),f.push({type:"TRACKED",name:n.name,remote:e.remote,push:n.push,tracking:e,commit:n.commit}))}()}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}var y=e.filter(function(e){return!d.has(e)});return(0,l._)(y).concat((0,l._)(f))}((0,s.so)(t.output,"\n").map(f).filter(function(e){return null!==e}))).sort(function(e,t){return t.commit.author.date-e.commit.author.date}),[2,{branches:n,error:null}]}})})).apply(this,arguments)}(r=i||(i={})).LOCAL="LOCAL",r.REMOTE="REMOTE",r.TRACKED="TRACKED"},91075:function(e,t,n){n.d(t,{T:function(){return i},Z:function(){return d}});var r,i,o=n(27387),a=n(66626),l=n(96583),c=n(75813),s=n(50431),u=n(55103);function d(e){return f.apply(this,arguments)}function f(){return(f=(0,o._)(function(e){var t,n,r,i,o,d,f,h,p,m=arguments;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=m.length>1&&void 0!==m[1]?m[1]:{},[4,(0,u.Z)(e)];case 1:if((n=l.sent()).error)return[2,n];if(!n.branch)return[2,{error:c.aq.HEAD_DETACHED}];if(!n.upstream||(i=(r=(0,a._)((0,s.Tg)(n.upstream.branch),2))[0],o=r[1],!i||!o))return[2,{error:c.aq.UPSTREAM_NOT_SET}];if(n.changes.length>0)return[2,{error:c.aq.DIRTY_WORKTREE}];if("FF_ONLY"===(f=null!==(d=t.mode)&&void 0!==d?d:"FF_ONLY")&&n.upstream.ahead>0)return[2,{error:c.aq.MERGE_CONFLICT}];switch("FF_ONLY"!==f&&0===n.upstream.ahead&&(f="FF_ONLY"),h=["--quiet","--no-edit"],f){case"FF_ONLY":h.push("--no-rebase","--ff-only");break;case"MERGE":h.push("--no-rebase","--ff");break;case"REBASE":h.push("--rebase")}return h.push((0,s.Gw)(i),(0,s.Gw)(o)),[4,e("git pull ".concat(h.join(" ")),{serviceMethod:"git-pull"})];case 2:if((p=l.sent()).error!==c.aq.MERGE_CONFLICT)return[3,8];if(t.allowConflicts)return[2,{hasConflicts:!0,error:null}];switch(f){case"MERGE":return[3,3];case"REBASE":return[3,5]}return[3,7];case 3:return[4,e("git merge --abort",{serviceMethod:"git-pull"})];case 4:case 6:return l.sent(),[3,7];case 5:return[4,e("git rebase --abort",{serviceMethod:"git-pull"})];case 7:return[2,p];case 8:if(p.error)return[2,p];return[2,{hasConflicts:!1,error:null}]}})})).apply(this,arguments)}(r=i||(i={})).FF_ONLY="FF_ONLY",r.MERGE="MERGE",r.REBASE="REBASE"},63043:function(e,t,n){n.d(t,{J:function(){return r},O:function(){return i}});var r="users.noreply.replit.com",i="users.noreply.github.com"},97631:function(e,t,n){n.d(t,{J:function(){return i},e:function(){return r}});var r=(0,n(59173).u)(null);function i(e,t,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Date.now();Array.isArray(e)||(e=[e]);var a=null!==(i=t.output)&&void 0!==i?i:"",l=t.error,c=n?o:Date.now(),s="".concat(o,"-").concat(Math.random());r.set({input:e,output:a,error:l,start:o,end:c,cached:n,key:s})}},75813:function(e,t,n){var r,i,o,a,l,c;n.d(t,{aq:function(){return r},dq:function(){return i},rG:function(){return o}}),(a=r||(r={})).UNKNOWN_NOT_GIT="UNKNOWN_NOT_GIT",a.UNKNOWN="UNKNOWN",a.TIMEOUT="TIMEOUT",a.CHANNEL_CLOSED="CHANNEL_CLOSED",a.NOT_INITIALIZED="NOT_INITIALIZED",a.UNAUTHENTICATED="UNAUTHENTICATED",a.INDEX_FILE_CORRUPT="INDEX_FILE_CORRUPT",a.UNKNOWN_REMOTE="UNKNOWN_REMOTE",a.INDEX_LOCKED="INDEX_LOCKED",a.NO_COMMITS="NO_COMMITS",a.PATH_MATCHED_NO_FILES="PATH_MATCHED_NO_FILES",a.USER_NOT_CONFIGURED="USER_NOT_CONFIGURED",a.INVALID_REFERENCE="INVALID_REFERENCE",a.BRANCH_ALREADY_EXISTS="BRANCH_ALREADY_EXISTS",a.MERGE_CONFLICT="MERGE_CONFLICT",a.UPSTREAM_NOT_SET="UPSTREAM_NOT_SET",a.HEAD_DETACHED="HEAD_DETACHED",a.DIRTY_WORKTREE="DIRTY_WORKTREE",a.PUSH_REJECTED="PUSH_REJECTED",a.REMOTE_ALREADY_EXISTS="REMOTE_ALREADY_EXISTS",a.ALREADY_INITIALIZED="ALREADY_INITIALIZED",a.INVALID_STATE="INVALID_STATE",a.PROTECTED_BRANCH="PROTECTED_BRANCH",(l=i||(i={})).FS_CHANGE="FS_CHANGE",l.FORCED_REFRESH="FORCED_REFRESH",l.NEW_PROFILE="NEW_PROFILE",l.CHANGED_PROFILE="CHANGED_PROFILE",(c=o||(o={})).REPLIT_DEFAULT="REPLIT_DEFAULT",c.GITHUB="GITHUB"},19858:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(66626),i=n(63257),o=n(7444),a=n(50199),l=n(75813),c=n(54916),s=n(3341),u=n.n(s),d=n(50959);function f(e){var t,n,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=(0,r._)((0,d.useState)(null),2),p=h[0],m=h[1],v=(0,o.Z)(p),g=null===(n=null!==(t=f.keepStaleResult)&&void 0!==t?t:f.refresh)||void 0===n||n,y=(0,d.useCallback)(function(e){u()(e,v.current)||m(e)},[v]),b=(0,a.Z)(function(){return e},(0,i._)(s)),w=(0,c.Z)().git,Z=(0,d.useRef)(null),x=(0,d.useCallback)(function(){Z.current?Z.current():g||y(null);var e=!1;b(w).then(function(t){e||(y(t),Z.current=null)}).catch(function(){e||(y({error:l.aq.UNKNOWN}),Z.current=null)}),Z.current=function(){e=!0,Z.current=null,g||y(null)}},[y,b,w,g]);return(0,d.useEffect)(function(){return x()},[x]),(0,d.useEffect)(function(){var e;if(null===(e=f.refresh)||void 0===e||e)return w.onRefresh(x)},[w,x,f.refresh]),p}},36098:function(e,t,n){var r,i,o,a;n.d(t,{Z:function(){return i},z:function(){return r}}),(o=r||(r={})).INSTRUCTION_RESULT="INSTRUCTION_RESULT",o.TEST_RESULT="TEST_RESULT",o.ERROR="ERROR",o.STATE_CHANGED="STATE_CHANGED",(a=i||(i={}))[a.Idle=0]="Idle",a[a.Starting=1]="Starting",a[a.Ready=2]="Ready",a[a.Building=3]="Building",a[a.Running=4]="Running"},19012:function(e,t,n){var r=n(7225);t.Z=[r.SymbolKind.Array,r.SymbolKind.Boolean,r.SymbolKind.Class,r.SymbolKind.Constant,r.SymbolKind.Constructor,r.SymbolKind.Enum,r.SymbolKind.EnumMember,r.SymbolKind.Event,r.SymbolKind.Field,r.SymbolKind.File,r.SymbolKind.Function,r.SymbolKind.Interface,r.SymbolKind.Key,r.SymbolKind.Method,r.SymbolKind.Module,r.SymbolKind.Namespace,r.SymbolKind.Object,r.SymbolKind.Operator,r.SymbolKind.Package,r.SymbolKind.Property,r.SymbolKind.String,r.SymbolKind.Struct,r.SymbolKind.TypeParameter,r.SymbolKind.Variable]},8701:function(e,t,n){var r,i,o,a;n.d(t,{N:function(){return r},a:function(){return i}}),(o=r||(r={})).NOT_READY="NOT_READY",o.READY="READY",o.STALLED="STALLED",o.BROKEN="BROKEN",(a=i||(i={})).OFFLINE="OFFLINE",a.INITIALIZING="INITIALIZING",a.INITIALIZED="INITIALIZED",a.EXITING="EXITING",a.EXITED="EXITED"},49418:function(e,t,n){n.d(t,{Z:function(){return g}});var r=n(66626),i=n(50782),o=n(54916),a=n(50959),l=n(41733),c=n(30509),s=n(2689),u=n(16783),d=n.n(u),f=n(99071),h=n(8701);function p(e){return Math.floor(performance.now()-e.startTime)}var m=new WeakSet,v=n(86790);function g(e){var t=(0,i.Z)(),n=(0,o.Z)().lspnix,u=(0,r._)((0,a.useState)([]),2),g=u[0],y=u[1],b=(0,v.k)();return(0,a.useEffect)(function(){if(e){var t=n.onClient(e,y);return function(){t(),y([])}}},[n,e]),(0,a.useEffect)(function(){return(0,f.uf)(g.map(function(n){return function(e){var t=e.client,n=e.replId,r=e.language,i=e.debug;if(!m.has(t)){m.add(t);var o=new Map,a=function(e){var i,o=t.getServerState(),a=null!==(i=t.getServerInfo())&&void 0!==i?i:{name:"unknown",version:"none"},l=o===h.a.INITIALIZED?"".concat(null==a?void 0:a.name,"@").concat(null==a?void 0:a.version):"not_ready: server is ".concat(o);return{method:e.method,replid:n,language:r,startTime:Math.floor(e.startTime),languageServerInfo:l,lspId:t.clientId}},u=d()(function(e,t){var n=p(t);n>1e4&&s.kg.time("LSP unresponsive request",n,a(t))}),v=setInterval(function(){o.forEach(function(e){u(e.id,e)})},2e3);return(0,f.uf)([t.onRequest(function(e){var t=e.id,n=e.data;(i||.01>Math.random())&&o.set(t,{id:t,method:n.method,startTime:performance.now()})}),t.onResponse(function(e){var t=e.id,n=e.error,r=o.get(t);null!=r&&(o.delete(t),s.kg.time("LSP request",p(r),(0,c._)((0,l._)({},a(r)),{result:null==n?"ok":"error"})))}),t.onCancelRequest(function(e){var t=o.get(e);null!=t&&(o.delete(e),s.kg.time("LSP request",p(t),(0,c._)((0,l._)({},a(t)),{result:"cancelled"})))}),function(){return clearInterval(v)},function(){return m.delete(t)}])}}({client:n,replId:t,language:n.getLanguageId(e),debug:b})}))},[g,t,e,b]),g}},56729:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(66626),i=n(50959),o=n(69521),a=n(99071);function l(e){var t=(0,r._)((0,i.useState)(null),2),n=t[0],l=t[1];return(0,i.useEffect)(function(){var t=function(){l((0,o.H)(e.map(function(e){return(0,o.Z)(e)})))};return t(),(0,a.uf)(e.map(function(e){return e.onServerCapabilitiesChange(function(){return t()})}))},[e]),n}},30942:function(e,t,n){n.d(t,{z:function(){return S},i:function(){return k}});var r=n(27387),i=n(41733),o=n(30509),a=n(96583),l=n(74985),c=n(25425),s=n(11516),u=n(12285),d=n(78047),f=n(38096),h=n(41759),p=n(62207),m=n(98152),v=n(24394),g=n(49500),y=function(){"use strict";function e(t){(0,u._)(this,e),this.n=1,this.cleanup=t}var t=e.prototype;return t.ref=function(){this.n+=1},t.unref=function(){this.n-=1,0===this.n&&this.cleanup()},e}(),b=void 0,w=function(e,t){if(b&&b.clientId===e)b.refcount.ref();else{var n,i=(n=(0,r._)(function(){var e;return(0,a.Jh)(this,function(n){switch(n.label){case 0:return[4,t()];case 1:var r;return e=n.sent(),[2,new m.Z(((r=new URL(e.gurl)).pathname="/wsv2/".concat(e.token),r.toString()))]}})}),function(){return n.apply(this,arguments)}),o="".concat(e,"-").concat((0,v.x0)()),l=new f.k(i,o,"SERVER",{codec:p.f});(0,h.nb)(g.log),(0,h.uR)("info");var c=new y(function(){l.close()});b={ctx:{client:(0,d.eI)(l),transport:l,cleanup:function(){return null==b?void 0:b.refcount.unref()}},clientId:e,refcount:c}}return b.ctx},Z=n(50959),x=n(91060),C=n(16835),S=(0,Z.createContext)(null);function k(e){var t,n=e.clientName,u=e.replId,d=e.children,f=(0,c.P5)({controlName:"flag-pid2",logFlagToAnalytics:!1}),h=(0,Z.useRef)(),p=(0,Z.useCallback)((t=(0,r._)(function(){var e,t;return(0,a.Jh)(this,function(n){switch(n.label){case 0:return t={replId:u,isLoggedIn:!0,pid2Version:null!==(e=s.Z.get("pid2Version","string"))&&void 0!==e?e:"e35892e039b5273c31c4eda656ff3b41702e61ae"},[4,(0,C.Z)()];case 1:return[2,x.Z.apply(void 0,[(t.overrideClusterMetadata=n.sent(),t)])]}})}),function(){return t.apply(this,arguments)}),[u]),m=(0,Z.useCallback)((0,r._)(function(){var e;return(0,a.Jh)(this,function(t){switch(t.label){case 0:if(h.current)return[2,h.current];return[4,p()];case 1:return e=t.sent(),h.current=e,[2,e]}})}),[h,p]),v=(0,Z.useMemo)(function(){return f?(0,o._)((0,i._)({},w("".concat(n,"-").concat(u),(0,r._)(function(){var e;return(0,a.Jh)(this,function(t){switch(t.label){case 0:return[4,p()];case 1:return e=t.sent(),h.current=e,[2,e]}})}))),{getCachedConnectionMetadata:m}):null},[f,n,u,p,m]);return(0,Z.useEffect)(function(){return function(){null==v||v.cleanup()}},[v]),(0,l.tZ)(S.Provider,{value:v,children:d})}},67405:function(e,t,n){n.d(t,{C:function(){return l},h:function(){return a}});var r=n(25425),i=n(50959),o=n(30942);function a(){var e=(0,r.P5)({controlName:"flag-pid2",logFlagToAnalytics:!1}),t=l();if(e&&null===t)throw Error("usePid2 used outside of a workspace context, make sure Pid2Provider is a parent");return null==t?void 0:t.client}function l(){return(0,i.useContext)(o.z)}},35375:function(e,t,n){n.d(t,{DL:function(){return i},OD:function(){return w},TE:function(){return S},UK:function(){return y},VZ:function(){return Z}});var r,i,o=n(27387),a=n(41733),l=n(30509),c=n(63257),s=n(96583),u=n(43182),d=n(64461),f=n(86763),h=n.n(f),p=n(40028),m=n(59173),v=n(3341),g=n.n(v),y=new Set([3e3,3001,3002,3003,4200,5e3,5173,6e3,6800,80,8e3,8008,8080,8081,8099,9e3]);function b(e,t){return new Set(Array.from(e).filter(function(e){return!t.has(e)}))}function w(e){var t=e.type;switch(t){case"FORWARDED":case"MISCONFIGURED":return e.externalPort;case"INTERNAL_ONLY":case"NO_MORE_EXTERNAL_PORTS_AVAILABLE":case"CONFIG_MISSING":return;default:(0,p.Z)(t)}}function Z(e){var t;return null!==(t=e.isLocalhost)&&void 0!==t&&t}function x(e){return e?b(y,new Set(e.map(function(e){return w(e.configuration)}))):y}function C(e){var t=e.localPort,n=x(e.portsState.current);if(0!==n.size){var r=n.has(80),i=n.has(t);return r?80:i?t:Array.from(n).sort()[0]}}function S(e){var t=e.container,n=e.dotReplit,r=e.enableBetterPortHandling,i=void 0!==r&&r,f=(0,m.u)([]),v=(0,m.u)(null),y=(0,m.u)(!1),S=(0,m.u)("only-global"),k=h()((0,o._)(function(){var e;return(0,s.Jh)(this,function(t){switch(t.label){case 0:if(!v.current)return[2];return e=v.current.filter(function(e){return!e.isEphemeral}).map(function(e){var t=e.configuration.type;switch(t){case"FORWARDED":case"MISCONFIGURED":return(0,a._)({localPort:e.configuration.localPort,externalPort:e.configuration.externalPort},Z(e.configuration)?{exposeLocalhost:!0}:void 0);case"INTERNAL_ONLY":return{localPort:e.configuration.localPort};case"NO_MORE_EXTERNAL_PORTS_AVAILABLE":case"CONFIG_MISSING":return!1;default:(0,p.Z)(t)}}).filter(Boolean).sort(function(e,t){return e.localPort-t.localPort}),[4,n.updateDotReplit([{op:"add",path:"ports",value:JSON.stringify(e)}])];case 1:return t.sent(),[2]}})}),1e3,{leading:!1,trailing:!0});function _(){y.set(!0),k()}return i?function(e){var t=e.container,n=e.dotReplit,r=e.portsState,i=e.writeDotReplitPortsConfig,o=e.isThisServiceUpdatingDotReplit,s=e.forwardPortsAutomatically;function f(e){return e.sort(function(e,t){var n,r;return(null!==(n=e.configuration.localPort)&&void 0!==n?n:0)-(null!==(r=t.configuration.localPort)&&void 0!==r?r:0)})}var h=[];function p(e){try{var t=function(e){var t=e.portsState,n=e.portInfo,r=e.forwardPortsAutomatically;if(null===t.current)throw Error("processOpenedPort can only assign ports if dotReplit config was read");var i={pid:n.pid,cgroup:n.cgroup,address:n.address,cmdline:n.cmdline},o="127.0.0.1"===i.address,c=t.current.find(function(e){return e.configuration.localPort===n.port});if(void 0!==c)return{isOpen:!0,isEphemeral:c.isEphemeral,processInfo:i,configuration:(0,l._)((0,a._)({},c.configuration),{isLocalhost:o})};if("none"===r.current||"only-global"===r.current&&o)return{isOpen:!0,isEphemeral:!0,processInfo:i,configuration:{type:"INTERNAL_ONLY",localPort:n.port,isLocalhost:o}};var s=C({localPort:n.port,portsState:t});return void 0===s?{isOpen:!0,isEphemeral:!1,processInfo:i,configuration:{type:"NO_MORE_EXTERNAL_PORTS_AVAILABLE",localPort:n.port,isLocalhost:o}}:{isOpen:!0,isEphemeral:!1,processInfo:i,configuration:{type:"FORWARDED",localPort:n.port,externalPort:s,isLocalhost:o}}}({portsState:r,portInfo:e,forwardPortsAutomatically:s}),n=!1;r.update(function(r){if(!r)throw Error("processOpenedPort can only execute if we red .replit first");return(0,d.Uy)(r,function(i){var o=i.findIndex(function(t){return t.configuration.localPort===e.port});return -1===o?(o=r.length,n=!0):g()(r[o].configuration,t.configuration)||(n=!0),i[o]=t,f(i)})}),n&&i()}catch(e){throw u.$e(function(t){t.setTag("service","ports"),u.Tb(e)}),e}}function m(e){try{r.update(function(t){if(!t)throw Error("onPortClosed can only execute if we red .replit first");return(0,d.Uy)(t,function(t){var n=t.findIndex(function(t){return t.configuration.localPort===e.port});if(-1!==n){var r=t[n];r.isEphemeral?t.splice(n,1):r.isOpen=!1}})})}catch(e){throw u.$e(function(t){t.setTag("service","ports"),u.Tb(e)}),e}}t.onPortOpened(function(e){null===r.current?h.push({type:"portOpen",portInfo:e}):p(e)}),t.onPortClosed(function(e){null===r.current?h.push({type:"portClose",portInfo:e}):m(e)}),n.watch(function(e){var t,n=e.config,i=null!==(t=null==n?void 0:n.ports)&&void 0!==t?t:[];if(!0===o.current){var s=r.current;if(!s||i.length!==s.length)return;i.every(function(e,t){var n,r=s[t];return e.localPort===r.configuration.localPort&&e.externalPort===(null!==(n=w(r.configuration))&&void 0!==n?n:0)})&&o.set(!1);return}r.update(function(e){e||(e=[]);var t=new Set(i.map(function(e){return e.localPort}).filter(function(e){return null!=e})),n=new Set(e.map(function(e){return e.configuration.localPort})),r=new Set(e.filter(function(e){return e.isOpen}).map(function(e){return e.configuration.localPort})),o=b(t,n),s=(m=new Set((0,c._)(Array.from(t)).concat((0,c._)(Array.from(r)))),new Set(Array.from(n).filter(function(e){return m.has(e)}))),u=[],d=!0,h=!1,p=void 0;try{for(var m,v,g=s[Symbol.iterator]();!(d=(v=g.next()).done);d=!0)!function(){var t=v.value,n=e.find(function(e){return e.configuration.localPort===t}),r=i.find(function(e){return e.localPort===t});if(!n)throw Error("couldn't find match for local port: ".concat(t));if(!r)return u.push((0,l._)((0,a._)({},n),{configuration:{type:"CONFIG_MISSING",localPort:n.configuration.localPort,isLocalhost:Z(n.configuration)}}));var o=n.configuration;o=null!=r.externalPort&&0!==r.externalPort?{type:x(u).has(r.externalPort)?"FORWARDED":"MISCONFIGURED",localPort:n.configuration.localPort,externalPort:r.externalPort,isLocalhost:Z(n.configuration)}:{type:"INTERNAL_ONLY",localPort:n.configuration.localPort,isLocalhost:Z(n.configuration)},u.push((0,l._)((0,a._)({},n),{configuration:o}))}()}catch(e){h=!0,p=e}finally{try{d||null==g.return||g.return()}finally{if(h)throw p}}var y=!0,w=!1,C=void 0;try{for(var S,k=o[Symbol.iterator]();!(y=(S=k.next()).done);y=!0)!function(){var e,t=S.value,n=i.find(function(e){return e.localPort===t});if(!n)throw Error("couldn't find match for local port: ".concat(t));var r=null!=n.externalPort&&0!==n.externalPort?n.externalPort:void 0;if(void 0!==r){var o,a=x(u).has(r);u.push({isOpen:!1,isEphemeral:!1,configuration:{type:a?"FORWARDED":"MISCONFIGURED",localPort:t,externalPort:r,isLocalhost:null!==(o=n.exposeLocalhost)&&void 0!==o&&o}})}else u.push({isOpen:!1,isEphemeral:!1,configuration:{type:"INTERNAL_ONLY",localPort:t,isLocalhost:null!==(e=n.exposeLocalhost)&&void 0!==e&&e}})}()}catch(e){w=!0,C=e}finally{try{y||null==k.return||k.return()}finally{if(w)throw C}}return f(u)}),h.length>0&&(h.forEach(function(e){var t=e.type,n=e.portInfo;"portOpen"===t?p(n):"portClose"===t&&m(n)}),h=[])})}({container:t,dotReplit:n,portsState:v,writeDotReplitPortsConfig:_,isThisServiceUpdatingDotReplit:y,forwardPortsAutomatically:S}):function(e){var t=e.container,n=e.openedPorts;function r(e){return e.sort(function(e,t){return e.localPort-t.localPort})}t.onPortOpened(function(e){e.isForwarded&&n.update((0,d.Uy)(function(t){var n=t.findIndex(function(t){return t.localPort===e.port});return -1===n&&(n=t.length),t[n]={localPort:e.port,externalPort:e.externalPort},r(t)}))}),t.onPortClosed(function(e){n.update(function(t){return r(t.filter(function(t){return t.localPort!==e.port}))})})}({container:t,openedPorts:f}),{openedPorts:f,tryExposingPortAutomatically:function(e){if(!i)throw Error("auto-assigning ports is only available when we auto-udpate .replit");var t=C({localPort:e,portsState:v});void 0!==t&&(v.update((0,d.Uy)(function(n){if(n){var r=n.find(function(t){return t.configuration.localPort===e});r&&(r.isEphemeral=!1,r.configuration={type:"FORWARDED",localPort:e,externalPort:t,isLocalhost:r.configuration.isLocalhost})}})),_())},updateDotReplitPortsMapping:function(e,t,n){if(!i)throw Error("updating .replit ports mapping is only available when we auto-udpate .replit");v.update((0,d.Uy)(function(r){var i,o=null==r?void 0:r.find(function(t){return t.configuration.localPort===e}),a=n;void 0===a&&(a=null!==(i=null==o?void 0:o.configuration.isLocalhost)&&void 0!==i&&i);var l=void 0!==t?{type:"FORWARDED",localPort:e,externalPort:t,isLocalhost:a}:{type:"INTERNAL_ONLY",localPort:e,isLocalhost:a};o?(o.isEphemeral=!1,o.configuration=l):(r||(r=[]),r.push({isOpen:!1,isEphemeral:!1,configuration:l}))})),_()},removeDotReplitPortsMapping:function(e,t){if(!i)throw Error("updating .replit ports mapping is only available when we auto-udpate .replit");v.update((0,d.Uy)(function(n){var r;void 0!==(r=void 0!==t?null==n?void 0:n.findIndex(function(n){return n.configuration.localPort===e&&("FORWARDED"===n.configuration.type||"MISCONFIGURED"===n.configuration.type)&&n.configuration.externalPort===t}):null==n?void 0:n.findIndex(function(t){return t.configuration.localPort===e}))&&(null==n||n.splice(r,1))})),_()},portsState:v,setForwardPortsAutomatically:function(e){S.set(e)}}}(r=i||(i={})).FORWARDED="FORWARDED",r.INTERNAL_ONLY="INTERNAL_ONLY",r.NO_MORE_EXTERNAL_PORTS_AVAILABLE="NO_MORE_EXTERNAL_PORTS_AVAILABLE",r.MISCONFIGURED="MISCONFIGURED",r.CONFIG_MISSING="CONFIG_MISSING"},37463:function(e,t,n){n.d(t,{bg:function(){return l},dF:function(){return c},r4:function(){return s}});var r=n(16643),i=n(54916),o=n(50959),a=n(35375);function l(){var e=(0,i.Z)().ports,t=(0,r.Z)(e.portsState);return(0,o.useMemo)(function(){return t?t.filter(function(e){return e.isOpen&&e.configuration.type===a.DL.FORWARDED}):[]},[t])}function c(e){return s((0,i.Z)().ports,e)}function s(e,t){var n=(0,r.Z)(e.portsState);return(0,o.useMemo)(function(){return t&&n?n.filter(function(e){var n;return null!==(n=e.isOpen&&(null==t?void 0:t.endsWith(e.processInfo.cgroup)))&&void 0!==n&&n}):[]},[n,t])}},73660:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(66626),i=n(54916),o=n(50959);function a(){var e=(0,i.Z)().presence,t=(0,r._)((0,o.useState)(e.getFollowedUser()),2),n=t[0],a=t[1];return(0,o.useEffect)(function(){return a(e.getFollowedUser()),e.onFollowedUserChanged(a)},[e]),n}},1518:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(73660);function i(){var e=(0,r.Z)();return e?e.color:null}},12130:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(73164),i=n(40728);function o(e,t,n,o){if(!(null==e?void 0:e.runs))return[];var l=[];if(t=t.slice(),n){var c=t.indexOf(n);-1!==c&&(t.splice(c,1),t.splice(0,0,n))}if(o){var s=t.indexOf(o);-1!==s&&t.splice(s,1),t.splice(0,0,o)}var u=!0,d=!1,f=void 0;try{for(var h,p=t[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value;if(m.match(/(\.[a-z0-9]+)$/)){var v=!0,g=!1,y=void 0;try{for(var b,w=e.runs[Symbol.iterator]();!(v=(b=w.next()).done);v=!0){var Z=b.value;if(Z.fileParam||Z.optionalFileParam){var x=(0,r.rF)(Z.fileTypeAttrs);null===x&&Z.language&&(x=r.$R.from(Z.language)),x&&(0,i.JW)(m,x)&&l.push({runner:Z,filePath:m})}}}catch(e){g=!0,y=e}finally{try{v||null==w.return||w.return()}finally{if(g)throw y}}}}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}var C=!0,S=!1,k=void 0;try{for(var _,E=e.runs[Symbol.iterator]();!(C=(_=E.next()).done);C=!0){var T=_.value;T.fileParam||l.push({runner:T})}}catch(e){S=!0,k=e}finally{try{C||null==E.return||E.return()}finally{if(S)throw k}}return function(e){e.sort(function(e,t){var n=a(e),r=a(t);return n!==r?n-r:e.runner.interpreter===t.runner.interpreter?0:e.runner.interpreter?-1:1})}(l),l}function a(e){var t,n,r;return(null===(t=e.runner.id)||void 0===t?void 0:t.startsWith(".replit/"))?0:(null===(n=e.runner.id)||void 0===n?void 0:n.startsWith("module:"))?1:(null===(r=e.runner.id)||void 0===r?void 0:r.startsWith("language:"))?2:3}},15482:function(e,t,n){n.d(t,{F:function(){return o}});var r=n(73164),i=n(40728);function o(e,t){var n=(0,r.rF)(t.fileTypeAttrs);return!n&&(null==t?void 0:t.language)&&(n=r.$R.from(t.language)),!!(n&&(0,i.JW)(e,n))}},26851:function(e,t,n){n.d(t,{K:function(){return l}});var r=n(41733),i=n(25425),o=n(50959),a=n(54916);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,a.Z)().userEvents,n=(0,i.P5)({controlName:"flag-null-diagnostics",logFlagToAnalytics:!1});return(0,o.useCallback)(function(i,o){n&&t.emit(i,(0,r._)({},e,o))},[t,e,n])}},30845:function(e,t,n){n.d(t,{M:function(){return S},l:function(){return C}});var r=n(42516),i=n(41733),o=n(30509),a=n(66626),l=n(74985),c=n(50782),s=n(93918),u=n(29287),d=n(74833),f=n(56596),h=n(75928),p=n(32078),m=n(93302),v=n(8279),g=n(50959),y=n(34785),b=n(42588),w=n(91612),Z=n(85838),x=(0,s.X)({storageBarWrapper:[u.l0.colWithGap(8)],summaryWrapper:[u.l0.colWithGap(8),u.l0.align.start],totalSummaryDot:[u.l0.backgroundColor.backgroundHigher,u.l0.width(8),u.l0.height(8),{borderRadius:"50%"}],replSummaryDot:[u.l0.backgroundColor.accentPrimaryDefault,u.l0.width(8),u.l0.height(8),{borderRadius:"50%"}],summaryRow:[u.l0.rowWithGap(8),u.l0.justify.start,u.l0.align.center,u.l0.fontSize(14),u.l0.height(14)],summaryRowWrap:[u.l0.rowWithGap(8),u.l0.justify.start,u.l0.align.center,u.l0.fontSize(14),{flexWrap:"wrap"}],replSummaryText:[u.l0.color.accentPrimaryStronger],replSummaryUsage:[u.l0.color.accentPrimaryStrongest],replSummaryTextPlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(78)],replUsagePlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(64)],totalUsagePlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(140)],availablePlaceholder:[v.p.backgroundPulse(u.TV.backgroundHigher,u.TV.backgroundRoot),{opacity:.5},u.l0.borderRadius(4),u.l0.height("100%"),u.l0.width(64)],availableText:[u.l0.color.foregroundDimmest,(0,r._)({},u.BC.max(390),u.l0.pl(16))]}),C=function(e){var t=e.data,n=e.hideAlerts,r=(0,c.Z)(),s=(0,a._)((0,g.useState)(!1),2),u=s[0],v=s[1];if((0,g.useEffect)(function(){var e,n;t&&(null===(e=t.currentUser)||void 0===e?void 0:e.storageInfo.accountStorageUtilization.__typename)==="AccountStorageUtilization"&&(null===(n=t.currentUser.storageInfo.accountStorageUtilization.perRepl.find(function(e){return e.repl.id===r}))||void 0===n?void 0:n.__typename)==="ReplStorageUtilization"&&v(!0)},[t,r]),t&&(null===(C=t.currentUser)||void 0===C?void 0:C.__typename)==="CurrentUser"&&"StorageQuota"===t.currentUser.storageInfo.storageQuota.__typename&&"StorageGracePeriodQuota"===t.currentUser.storageInfo.storageGracePeriodQuota.__typename&&"AccountStorageUtilization"===t.currentUser.storageInfo.accountStorageUtilization.__typename&&"UserPowerUpsTypes"===t.currentUser.userPowerUpsByType.__typename&&u){var C,k,_,E=t.currentUser.username,T=t.currentUser.storageInfo.accountStorageUtilization,R=t.currentUser.storageInfo.storageQuota.quota,I=null!==(k=t.currentUser.userPowerUpsByType.storage.currentSku)&&void 0!==k?k:void 0,D=I?w.zd[I]:void 0,G=T.total,B=T.perRepl,P=null!==(_=t.currentUser.userSubscriptionType)&&void 0!==_?_:void 0,A=P?w.XR[P]:w.XR.FREE,N=Math.max(Number(R)-Number(G),0),L="Bytes",U="(".concat((0,m.fZ)(N,{precision:1,resourceUsageType:L})," available)"),O=B.find(function(e){return e.repl.id===r}),M="0"!==R?(0,l.tZ)(d.xv,{css:x.availableText,multiline:!1,children:U}):null;return(0,l.BX)(f.G,{css:x.storageBarWrapper,children:[(0,l.tZ)(h.$,{context:{type:"workspace_info_modal",replId:r},summary:(0,p._4)((0,o._)((0,i._)({},T),{quota:R})),username:E,resourceUsageType:L}),(0,l.BX)(f.G,{css:x.summaryWrapper,children:[(0,l.BX)(f.G,{css:x.summaryRowWrap,children:[(0,l.BX)(d.xv,{multiline:!1,children:["Replit ",(0,y.s)(P)," storage: ",A," GiB",D?" + ".concat(D," GiB add-on"):null]}),M]}),(0,l.BX)(f.G,{css:x.summaryRow,children:[(0,l.tZ)("div",{css:x.replSummaryDot}),(0,l.tZ)(d.xv,{css:x.replSummaryText,multiline:!1,children:"This Repl:"}),O?(0,l.tZ)(d.xv,{css:x.replSummaryUsage,multiline:!1,children:(0,b.s)(Number(O.usage))}):(0,l.tZ)(f.G,{css:x.replUsagePlaceholder})]}),void 0!==n&&n?null:(0,l.tZ)(Z.q,{})]})]})}return(0,l.tZ)(S,{})},S=function(){return(0,l.BX)(f.G,{css:x.storageBarWrapper,children:[(0,l.tZ)(h.X,{}),(0,l.BX)(f.G,{css:x.summaryWrapper,children:[(0,l.BX)(f.G,{css:x.summaryRow,children:[(0,l.tZ)(f.G,{css:x.totalUsagePlaceholder}),(0,l.tZ)(f.G,{css:x.availablePlaceholder})]}),(0,l.BX)(f.G,{css:x.summaryRow,children:[(0,l.tZ)(f.G,{css:x.replSummaryTextPlaceholder}),(0,l.tZ)(f.G,{css:x.replUsagePlaceholder})]})]})]})}},65243:function(e,t,n){n.d(t,{g:function(){return o}});var r=n(74985),i=n(43312);function o(){return(0,r.tZ)(i.xB,{styles:[{body:{overflow:"hidden"}}]})}},14818:function(e,t,n){n.d(t,{X:function(){return o},z:function(){return a}});var r=n(50959),i=(0,r.createContext)(null);function o(){return(0,r.useContext)(i)}var a=i.Provider},30601:function(e,t,n){n.d(t,{w:function(){return h}});var r=n(41733),i=n(66626),o=n(74985),a=n(43312),l=n(26508),c=n(29287),s=n(30826),u=n.n(s),d=n(50959),f=n(10422);function h(e){var t=e.targetElement,n=(0,i._)((0,d.useState)(null),2),s=n[0],h=n[1],m=(0,l.Z)(function(){t&&h({rect:t.getBoundingClientRect(),docWidth:document.documentElement.clientWidth,docHeight:document.documentElement.clientHeight})},{type:"throttle",wait:100});if((0,d.useEffect)(function(){t&&m(t)},[t,m]),(0,d.useEffect)(function(){if(t){var e=u()(function(){h({rect:t.getBoundingClientRect(),docWidth:document.documentElement.clientWidth,docHeight:document.documentElement.clientHeight})},100);return window.addEventListener("resize",e),window.addEventListener("scroll",e),function(){window.removeEventListener("resize",e),window.removeEventListener("scroll",e)}}},[t]),!s||!t)return null;var v=(0,a.iv)({backgroundColor:c.TV.backgroundOverlay,zIndex:c.n0+1,position:"fixed",transition:"all 0.5s ease-out"});return(0,f.createPortal)((0,o.BX)(o.HY,{children:[(0,o.tZ)("div",{id:"wat",css:[p((0,r._)({side:"left-top"},s)),v]}),(0,o.tZ)("div",{css:[p((0,r._)({side:"top-right"},s)),v]}),(0,o.tZ)("div",{css:[p((0,r._)({side:"right-bottom"},s)),v]}),(0,o.tZ)("div",{css:[p((0,r._)({side:"bottom-left"},s)),v]})]}),document.body)}function p(e){var t=e.side,n=e.rect,r=e.docWidth,i=e.docHeight;switch(t){case"left-top":return(0,a.iv)({top:0,left:0,width:Math.max(0,n.left),height:Math.max(0,n.bottom)});case"top-right":return(0,a.iv)({top:0,right:0,width:"calc(".concat(r,"px - ").concat(Math.max(0,n.left),"px)"),height:Math.max(0,n.top)});case"right-bottom":return(0,a.iv)({bottom:0,right:0,width:"calc(".concat(r,"px - ").concat(Math.max(0,n.right),"px)"),height:"calc(".concat(i,"px - ").concat(Math.max(0,n.top),"px)")});case"bottom-left":return(0,a.iv)({bottom:0,left:0,width:Math.max(0,n.right),height:"calc(".concat(i,"px - ").concat(Math.max(0,n.bottom),"px)")})}}},30869:function(e,t,n){n.d(t,{k:function(){return v}});var r=n(41733),i=n(30509),o=n(66626),a=n(74985),l=n(22487),c=n(26508),s=n(87659),u=n(30983),d=n(36227),f=n(29287),h=n(50959),p=n(10422),m=n(34335);function v(e){var t=e.targetElement,n=e.activeStep,v=e.goto,g=e.currentStepIndex,y=e.totalSteps,b=e.done,w=e.disableAnimation,Z=e.placement,x=e.cypressCloseData,C=e.onClickOutside,S=e.innerRef,k=e.width,_=(0,o._)((0,h.useState)(null),2),E=_[0],T=_[1],R=(0,o._)((0,h.useState)(null),2),I=R[0],D=R[1],G=(0,m.D)(t,E,{placement:void 0===Z?"right":Z,modifiers:[{name:"arrow",options:{element:I,padding:8}},{name:"offset",options:{offset:[0,16]}},{name:"preventOverflow",options:{padding:8}},{name:"flip",options:{fallbackPlacements:["top","bottom","left","right"]}},{name:"computeStyles",options:{adaptive:!1}}]}),B=(0,c.Z)(function(){var e;null===(e=G.update)||void 0===e||e.call(G)},{type:"throttle",wait:100});(0,h.useEffect)(function(){B(t)},[t,B]),(0,h.useImperativeHandle)(S,function(){return{updateTooltip:function(){var e;null===(e=G.update)||void 0===e||e.call(G)}}});var P=(0,l.Z)(function(){C&&C()},[C]);return(0,p.createPortal)((0,a.BX)("div",(0,i._)((0,r._)({ref:function(e){P.current=e,T(e)},style:G.styles.popper,css:{transition:w?"all":"all 0.5s ease-out",zIndex:f.n0+2,width:null!=k?k:320}},G.attributes.popper),{children:[(0,a.tZ)(d.O,{title:n.title,content:n.content,onDismiss:function(){b()},currentStepIndex:g,onCurrentStepChange:v,totalSteps:y,cypressCloseData:void 0===x?"tour-tooltip-close-button":x}),(0,a.tZ)("span",{style:G.styles.arrow,css:[u.wk,{"&::after":{backgroundColor:s.Br.primary.dimmest,border:"1px solid "+s.Br.primary.dimmer}}],ref:D})]})),document.body)}},70781:function(e,t,n){n.d(t,{r:function(){return g},e:function(){return y.e}});var r=n(42516),i=n(41733),o=n(30509),a=n(66626),l=n(74985),c=n(26635),s=n(50959),u=n(14818),d=n(49344),f=n(36227);function h(){var e=(0,u.X)();if(!e)return null;var t=e.activeStep,n=e.goto,r=e.steps,i=e.done;return(0,l.tZ)(d.u,{preventClose:!0,isOpen:!!t.isModal,onRequestClose:function(){},centered:!0,maxWidth:"fit-content",noPadding:!0,children:(0,l.tZ)(f.O,{title:t.title,content:t.content,onDismiss:function(){i()},currentStepIndex:r.findIndex(function(e){return t.id===e.id}),onCurrentStepChange:n,totalSteps:r.length,cypressCloseData:"tour-tooltip-close-button"})})}var p=n(30601),m=n(30869),v=n(49500);function g(e){var t,n,d,f,g,y,b,w,Z,x,C,S=e.children,k=e.tour,_=e.isDoneInitialOverride,E=e.onStep,T=e.onDone,R=(0,a._)((0,s.useState)(k.steps[0]),2),I=R[0],D=R[1],G=(0,a._)((0,s.useState)({}),2),B=G[0],P=G[1],A=(t=k.id,f=(d=(0,c.Pp)({variables:{tours:t}})).data,g=d.loading,y=(0,a._)((0,c.oe)({variables:{name:t},optimisticResponse:{__typename:"RootMutationType",markTourAsSeen2:{__typename:"TourSeen",id:t,seen:!0}}}),1)[0],w=(b=(0,a._)((0,s.useState)(_),2))[0],Z=b[1],x=!!(null==f?void 0:null===(n=f.currentUser)||void 0===n?void 0:n.toursSeen[0].seen),"boolean"==typeof w&&(x=w),{isLoading:g,isDone:x,setIsDone:function(e){Z(e),e&&y()}}),N=A.isDone,L=A.isLoading,U=A.setIsDone,O=k.steps.findIndex(function(e){return I.id===e.id});if(-1===O)throw Error("Current tour step is not in tour steps");function M(){U(!0),null==T||T(I.id)}var X=(0,s.useRef)();function F(e){X.current=I,null==E||E(e.id),D(e)}function W(e){if("number"==typeof e)t=e;else{var t;t=k.steps.findIndex(function(t){return e===t.id})}if(!(t<0)&&!(t>=k.steps.length)){for(var n=k.steps[t],r=t<O;!B[n.id]&&n.autoSkipIfNoTarget;){if((t=r?t-1:t+1)<0||t>=k.steps.length)return;n=k.steps[t]}F(n)}}function H(){W(0),U(!1)}var V=(0,s.useCallback)(function(e,t){var n=k.steps.findIndex(function(t){return e===t.id});if(-1===n)throw Error("Invalid step id");if(k.steps[n].isModal)throw Error("Trying to set a target element for a modal step");P(function(n){return n[e]===t?n:(0,o._)((0,i._)({},n),(0,r._)({},e,t))})},[k]),z=B[I.id],j=!N&&!L;window.startTour=function(){v.log("starting tour:",k.id,"from",k.steps[0].id),H()};var q=k.steps.filter(function(e){return!e.autoSkipIfNoTarget||!!B[e.id]}),Y=q.findIndex(function(e){return I.id===e.id});return(0,l.BX)(u.z,{value:(0,o._)((0,i._)({},k),{setStepTargetElement:V,activeStep:I,next:function(){var e=k.steps[O+1];if(e&&e.autoSkipIfNoTarget)for(var t=O+1;e&&e.autoSkipIfNoTarget&&!B[e.id];)t++,e=k.steps[t];if(!e){M();return}F(e)},prev:function(){var e=k.steps[O-1];if(e&&e.autoSkipIfNoTarget)for(var t=O-1;e&&e.autoSkipIfNoTarget&&!B[e.id];)t--,e=k.steps[t];e&&F(e)},goto:W,isDone:N,isLoading:L,done:M,restart:H}),children:[j&&I.isModal?(0,l.tZ)(h,{}):null,j&&z?(0,l.BX)(l.HY,{children:[(0,l.tZ)(p.w,{targetElement:z}),(0,l.tZ)(m.k,{targetElement:z,activeStep:I,currentStepIndex:Y,done:M,goto:function(e){W(e+O-Y)},totalSteps:q.length,disableAnimation:!!(0===O||(null===(C=X.current)||void 0===C?void 0:C.isModal))})]}):null,S]})}var y=n(89783)},41084:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(89783),i=function(){};function o(e){var t=(0,r.e)(e);return t?t.delegateTooltip:i}},89783:function(e,t,n){n.d(t,{e:function(){return o}});var r=n(50959),i=n(14818);function o(e){var t=(0,i.X)(),n=(0,r.useCallback)(function(n){null==t||t.setStepTargetElement(e,n)},[e,null==t?void 0:t.setStepTargetElement]);return t&&t.steps.some(function(t){return t.id===e})?{delegateTooltip:n,isActive:!t.isLoading&&!t.isDone&&t.activeStep.id===e,activeStep:t.activeStep,done:t.done,goto:t.goto,id:t.id,isDone:t.isDone,isLoading:t.isLoading,next:t.next,prev:t.prev,restart:t.restart,steps:t.steps}:null}},24549:function(e,t,n){var r,i;n.d(t,{z:function(){return r}}),(i=r||(r={})).FileNode="FILE_NODE",i.FileHeaderTab="FILE_HEADER_TAB",i.Code="CODE",i.Pane="PANE",i.NewPane="NEW_PANE"},10099:function(e,t,n){var r=n(74985),i=n(76999),o=n.n(i),a=n(97754),l=n.n(a),c=n(10981);n(50959),t.Z=function(e){var t=e.name,n=void 0===t?"toggle":t,i=e.id,a=e.elevation,s=void 0===a?"higher":a,u=e.isOn,d=e.onIcon,f=e.offIcon,h=e.onChange,p=e.dataCy,m=(0,c.U)(),v=null!=i?i:m(n);return(0,r.BX)("label",{"data-cy":p,htmlFor:v,className:o().dynamic([["8d56ad7b5afff72c",[s]]])+" "+(l()("toggle-label",{isOn:u})||""),children:[(0,r.tZ)("input",{name:n,checked:u,onChange:h,id:v,type:"checkbox",className:o().dynamic([["8d56ad7b5afff72c",[s]]])+" toggle-checkbox"}),(0,r.tZ)("span",{className:o().dynamic([["8d56ad7b5afff72c",[s]]])+" toggle-button",children:u&&d?d:f||null}),(0,r.tZ)(o(),{id:"8d56ad7b5afff72c",dynamic:[s],children:".toggle-checkbox.__jsx-style-dynamic-selector{height:0;width:0;visibility:hidden}.toggle-label.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;cursor:pointer;width:38px;height:24px;background:var(--background-".concat(s,');border:.5px solid var(--outline-dimmest);-webkit-border-radius:100px;-moz-border-radius:100px;border-radius:100px;position:relative;-webkit-transition:background-color.2s;-moz-transition:background-color.2s;-o-transition:background-color.2s;transition:background-color.2s}.toggle-button.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;content:"";position:absolute;left:1px;width:20px;height:20px;-webkit-border-radius:45px;-moz-border-radius:45px;border-radius:45px;-webkit-transition:.2s;-moz-transition:.2s;-o-transition:.2s;transition:.2s;background:var(--white);-webkit-box-shadow:var(--shadow-1);-moz-box-shadow:var(--shadow-1);box-shadow:var(--shadow-1);color:var(--foreground-dimmer)}.toggle-label.isOn.__jsx-style-dynamic-selector{background-color:var(--accent-primary-default);border-color:var(--accent-primary-default)}.toggle-checkbox.__jsx-style-dynamic-selector:checked+.toggle-button.__jsx-style-dynamic-selector{-webkit-transform:translatex(-webkit-calc(100% - 6px));-moz-transform:translatex(-moz-calc(100% - 6px));-ms-transform:translatex(calc(100% - 6px));-o-transform:translatex(calc(100% - 6px));transform:translatex(-webkit-calc(100% - 6px));transform:translatex(-moz-calc(100% - 6px));transform:translatex(calc(100% - 6px));color:var(--accent-primary-default)}.toggle-label.__jsx-style-dynamic-selector:active .toggle-button.__jsx-style-dynamic-selector{-webkit-box-shadow:var(--shadow-2);-moz-box-shadow:var(--shadow-2);box-shadow:var(--shadow-2)}')})]})}},47648:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(41733),i=n(30509),o=n(98924),a=n(74985),l=n(49344),c=n(87001),s=n(44882),u=n(21262),d=n(71440),f=n(58995);function h(){var e=(0,u._)(["\n  query UpgradeModal {\n    currentUser {\n      id\n      cycles {\n        transactions(count: 1) {\n          items {\n            id\n            time_created\n          }\n        }\n      }\n    }\n  }\n"]);return h=function(){return e},e}function p(){var e=(0,u._)(["\n  query CurrentUserSubscriptionIdentify {\n    currentUser {\n      id\n      userSubscriptionType\n    }\n  }\n"]);return p=function(){return e},e}var m={},v=(0,d.Ps)(h()),g=(0,d.Ps)(p());function y(e){var t,n,u=e.isOpen,d=e.onRequestClose,h=e.onPlanCheckoutComplete,p=(0,o._)(e,["isOpen","onRequestClose","onPlanCheckoutComplete"]);return t=(0,r._)({},m,{ssr:!1,context:{noBatch:!0}}),f.a(v,t),n=(0,r._)({},m,void 0),f.a(g,n),(0,a.tZ)(l.u,(0,i._)((0,r._)({noPadding:!0,maxWidth:s.W,fitContent:!0,isOpen:u,onRequestClose:d},p),{children:(0,a.tZ)(s.Z,(0,i._)((0,r._)({},p),{onCyclesCheckoutComplete:d,onPlanCheckoutComplete:function(e){"function"==typeof h&&h(e),e!==c.Pg&&d()}}))}))}},80431:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(12285),i=n(4955),o=n(41733),a=n(30509),l=n(9670),c=n(74985),s=n(43182),u=n(56596),d=n(29287),f=n(50959),h=n(63009),p=n(49500),m=function(e){"use strict";(0,i._)(n,e);var t=(0,l._)(n);function n(){var e;return(0,r._)(this,n),e=t.apply(this,arguments),e.state={hasErrored:!1,error:null,errorInfo:null},e}var o=n.prototype;return o.componentDidCatch=function(e,t){this.setState({hasErrored:!0,error:e,errorInfo:t}),this.props.handleError(e,t),p.error(e)},o.render=function(){if(this.state.hasErrored){var e,t,n;return(0,c.tZ)(u.G,{css:[d.l0.font.code,d.l0.p(16),{whiteSpace:"pre",overflow:"hidden",color:"white"},d.l0.backgroundColor.blurpleDefault,d.l0.height("100%")],children:(0,c.tZ)(u.G,{children:null!==(n=null===(t=this.state)||void 0===t?void 0:null===(e=t.error)||void 0===e?void 0:e.stack)&&void 0!==n?n:"An unknown error occurred."})})}return this.props.children},n}(f.Component);function v(e){var t=e.bsod,n=void 0!==t&&t,r=e.sentry,i=void 0===r||r,l=e.handleError,u=e.children,d=e.origin,f=void 0===d?"ErrorBoundary: (no origin provided)":d,p=e.tags,v=void 0===p?{}:p,g=e.extras,y=void 0===g?{}:g,b=(0,h.uV)();return(0,c.tZ)(m,{handleError:function(e,t){n?b({error:e,extras:(0,a._)((0,o._)({},y),{errorInfo:t}),tags:(0,a._)((0,o._)({},v),{errorBoundary:!0}),origin:f}):i&&s.$e(function(n){n.setTag("errorBoundary",!0),n.setTags(v),n.setExtra("errorInfo",t),n.setExtras(y),s.Tb(e)}),l&&l(e,t)},children:u})}},62808:function(e,t,n){n.d(t,{Y:function(){return x},Z:function(){return _}});var r=n(74985),i=n(99517),o=n(75533),a=n(4687),l=n(92994),c=n(40497),s=n(16643),u=n(56596),d=n(29287),f=n(63461),h=n(86790),p=n(50959),m=n(99071),v=n(59173),g=(0,v.u)(null),y=(0,v.u)(null),b=(0,v.u)({from:0,to:0}),w=a.p.mark({class:"ast-hover"}),Z=a.tk.baseTheme({".ast-hover":{background:d.TV.backgroundHighest}});function x(e){var t=e.view,n=(0,l.Z)({view:t}),r=(0,h.k)();(0,p.useEffect)(function(){if(r&&t){g.current=t.state;var e=o.Py.define(),i=(0,m.uf)([y.subscribe(function(n){t.dispatch({effects:e.of(n)})}),b.subscribe(function(e){t.dispatch({selection:{anchor:e.from,head:e.to}})})]);return t.dispatch({effects:n.reconfigure([a.tk.updateListener.of(function(e){(e.selectionSet||e.docChanged)&&(g.current=e.state)}),o.QQ.define({create:function(){return a.p.none},update:function(t,n){return t=t.map(n.changes),(0,c.j)(n,e,function(e){t=null==e.value?a.p.none:a.p.set([w.range(e.value.from,e.value.to)])}),t},provide:function(e){return a.tk.decorations.from(e)}}),Z])}),function(){g.current=null,i(),t.dispatch({effects:n.reconfigure([])})}}},[t,r,n])}var C=(0,p.memo)(function(e){var t=e.node,n=e.index,i=e.active,o=e.terminal,a=t.type.name,l={from:t.from,to:t.to};return(0,r.BX)(u.G,{css:[{marginLeft:4*n+(o?4:0)},d.l0.mb(4),d.l0.rowWithGap(2),d.l0.align.center,d.l0.cursor.pointer],onMouseEnter:function(){y.current=l},onClick:function(){y.current=null,b.current=l},children:[(0,r.tZ)(f.Z,{size:"small",fontFamily:a.length>1?"sans-serif":"monospace",fontWeight:i?"bold":"regular",children:a}),(0,r.BX)(f.Z,{size:"xsmall",truncate:!0,children:["(",t.from,"  ",t.to,")"]})]})});function S(e,t){for(var n=[];t(e);)n.push(e.node);return n}var k=(0,p.memo)(function(e){var t=e.state,n=(0,i.qz)(t),o=t.selection.main.head,a=(0,p.useMemo)(function(){return S(n.cursorAt(o),function(e){return e.parent()}).reverse()},[n,o]),l=(0,p.useMemo)(function(){return S(n.cursorAt(o),function(e){return e.prevSibling()})},[n,o]),c=(0,p.useMemo)(function(){return S(n.cursorAt(o),function(e){return e.nextSibling()})},[n,o]);return(0,r.BX)(u.G,{css:d.l0.ml(4),onMouseLeave:function(){y.current=null},children:[a.map(function(e,t){return(0,r.tZ)(C,{node:e,index:t},t)}),l.map(function(e,t){return(0,r.tZ)(C,{node:e,index:a.length,terminal:!0},t)}),(0,r.tZ)(C,{node:n.resolveInner(t.selection.main.head),index:a.length,terminal:!0,active:!0}),c.map(function(e,t){return(0,r.tZ)(C,{node:e,index:a.length,terminal:!0},t)})]})});function _(e){var t=e.isHidden,n=(0,s.Z)(g);return t?null:n?(0,r.tZ)(k,{state:n}):null}},12621:function(e,t,n){n.d(t,{YX:function(){return w},ho:function(){return Z}});var r=n(12285),i=n(41733),o=n(30509),a=n(66626),l=n(74985),c=n(16643),s=n(74833),u=n(56596),d=n(32377),f=n(34815),h=n(88936),p=n(29287),m=n(61155),v=n(71984),g=n(50959),y=n(59173),b=n(98463),w=new(function(){"use strict";function e(){var t=this;(0,r._)(this,e),this.counter=0,this.enabled=!1,this.maxEntries=10,this.logs=(0,y.u)([]),this.clear=function(){t.logs.current=[]}}var t=e.prototype;return t.toggle=function(e){this.enabled=e},t.add=function(e){var t=this,n=this.counter++;if(!this.enabled)return{id:n};var r={id:n,request:e,requestTime:Date.now()};return this.logs.update(function(e){return[r].concat(e).slice(0,t.maxEntries)}),{id:n}},t.update=function(e,t){this.enabled&&this.logs.update(function(n){var r=n.findIndex(function(t){return t.id===e.id});if(-1===r)return n;var i=n.slice();return i[r]=t(i[r]),i})},t.complete=function(e,t){this.update(e,function(e){return(0,o._)((0,i._)({},e),{response:t,responseTime:Date.now()})})},t.abort=function(e){this.logs.update(function(t){return t.filter(function(t){return t.id!==e.id||null!=t.responseTime})})},e}()),Z=function(e){var t=e.isHidden,n=(0,c.Z)(w.logs);return t?null:(0,l.BX)(u.G,{css:[p.l0.flex.column],children:[(0,l.BX)(u.G,{css:[p.l0.flex.row,p.l0.align.center,p.l0.m(4),p.l0.position.sticky,p.l0.top(0),p.l0.backgroundColor.backgroundDefault,p.l0.zIndex(1)],children:[(0,l.tZ)(s.xv,{css:p.l0.flex.grow(1),multiline:!1,children:"Requests"}),(0,l.tZ)(v.Z,{onClick:w.clear})]}),(0,l.BX)(u.G,{css:[p.l0.flex.grow(1),p.l0.flex.column,p.l0.overflow("auto")],children:[n.map(function(e){var t;return(0,l.tZ)(x,{log:e},null!==(t=e.id)&&void 0!==t?t:e.requestTime.valueOf())}),!n.length&&(0,l.tZ)(u.G,{css:p.l0.m(4),children:"\uD83D\uDE14 No logs yet..."})]})]})},x=(0,g.memo)(function(e){var t,n=e.log,r=n.requestTime,i=n.responseTime,o=n.request,c=n.response,v=(0,a._)((0,m.Z)(!0),2),g=v[0],y=v[1],w=o.code.length>20?"...".concat(o.code.slice(-20)):o.code;return(0,l.BX)(u.G,{css:[p.l0.my(4),p.l0.mx(4)],children:[(0,l.BX)(u.G,{role:"button",onClick:y,onKeyDown:y,tabIndex:0,css:[p.l0.flex.row,p.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],children:[(0,l.BX)(u.G,{css:[p.l0.flex.grow(1),p.l0.rowWithGap(2)],children:[(0,l.tZ)(s.xv,{multiline:!1,children:(t=n.response)?"CompleteCodeResult"===t.__typename?(0,l.tZ)(d.Z,{}):(0,l.tZ)(f.Z,{}):(0,l.tZ)(h.Z,{})}),(0,l.tZ)(s.xv,{multiline:!1,children:(0,l.tZ)("code",{children:w})})]}),(0,l.tZ)(u.G,{css:{opacity:.5},children:null!=i&&(0,l.BX)(s.xv,{css:p.l0.fontSize(13),multiline:!1,children:[i.valueOf()-r.valueOf(),"ms"]})})]}),!g&&(0,l.BX)(l.HY,{children:[void 0!==o&&(0,l.tZ)(b.g,{name:"request",src:o}),void 0!==c&&("CompleteCodeResult"===c.__typename?(0,l.BX)("details",{children:[(0,l.tZ)("summary",{children:"Response"}),(0,l.tZ)("pre",{css:[p.l0.overflow("scroll"),p.l0.borderRadius(4),p.l0.p(4),{border:"1px solid ".concat(p.TV.outlineDimmest)}],children:c.code})]}):(0,l.tZ)(b.g,{name:"response",src:c}))]})]})})},87271:function(e,t,n){n.d(t,{Sj:function(){return l},Th:function(){return o},UB:function(){return c},a0:function(){return s},cF:function(){return i},ot:function(){return a}});var r=n(19713),i=function(e,t){var n=e.dir,r=e.channel,i=e.cmd;return(!t.direction||n===t.direction)&&(!t.regexp||!t.regexp.test||!!(r.name&&t.regexp.test(r.name))||!!(r.service&&t.regexp.test(r.service))||!!t.regexp.test(JSON.stringify(i)))&&(!t.channels.length||!!t.channels.includes(i.channel))},o=(0,r.cn)([]),a=(0,r.cn)({regexp:null,direction:"",highlightOnly:!1,channels:[]}),l=(0,r.cn)(function(e){var t,n;return t=e(o),((n=e(a)).regexp||n.direction)&&!n.highlightOnly?t.filter(function(e){return i(e,n)}):t}),c=(0,r.cn)(null,function(e,t){t(o,[])}),s=(0,r.cn)(!1)},28131:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(66626),i=n(63257),o=n(54916),a=n(87271),l=n(80703),c=n(47611),s=n(50959);function u(){var e=(0,c.useRouter)(),t=(0,o.Z)().container,n=(0,r._)((0,l.KO)(a.a0),2),u=n[0],d=n[1],f=(0,l.b9)(a.Th);(0,s.useEffect)(function(){e.query.debug&&"undefined"!==e.query.debug&&d(!0)},[d,e.query.debug]),(0,s.useEffect)(function(){if(u)return t.client().onDebugLog(function(e){if("log"===e.type){if(e.log.channel){if(n={name:e.log.channel.name,service:null},"string"==typeof e.log.channel.service)n.service=e.log.channel.service;else if(e.log.channel.service){var n,r=t.getContext();r&&(n.service=e.log.channel.service(r))}}f(function(t){return(0,i._)(t).concat([{index:t[t.length-1]?t[t.length-1].index+1:0,channel:n,dir:e.log.direction,cmd:e.log.cmd,timestamp:window.performance.now()}])})}})},[u,f,t])}},98463:function(e,t,n){n.d(t,{L:function(){return P},g:function(){return N}});var r=n(42516),i=n(41733),o=n(30509),a=n(66626),l=n(63257),c=n(74985),s=n(10981),u=n(50959),d=n(97703),f=n(60769),h=n(15146),p=n(18836),m=n(74833),v=n(56596),g=n(87279),y=n(32377),b=n(58719),w=n(12036),Z=n(80339),x=n(21869),C=n(69640),S=n(97615),k=n(88936),_=n(29287),E=n(49418),T=n(10099),R=n(61155),I=n(71984),D=n(58091),G=n(99071),B=n(59639),P=function(e){var t,n,d,g,y,b,w=e.isHidden,C=(n=(t=(0,a._)((0,u.useState)(null),2))[0],d=t[1],g=(0,D.R3)(),(0,u.useEffect)(function(){g!==n&&null!=g&&d(g)},[g,n]),n),S=(0,E.Z)(C||""),k=(0,a._)((0,u.useState)(null===(y=S[0])||void 0===y?void 0:y.clientId),2),P=k[0],N=k[1];P&&!S.find(function(e){return P===e.clientId})&&N(null===(b=S[0])||void 0===b?void 0:b.clientId),!P&&S.length&&N(S[0].clientId);var U=(0,s.U)(),O=(0,a._)((0,R.Z)(!0),2),M=O[0],X=O[1],F=(0,a._)((0,u.useState)(""),2),W=F[0],H=F[1],V=(0,a._)((0,u.useState)(function(){return{}}),2),z=V[0],j=V[1],q=(0,a._)((0,R.Z)(!0),2),Y=q[0],J=q[1],K=(0,a._)((0,R.Z)(!0),2),$=K[0],Q=K[1],ee=(0,u.useCallback)(function(e,t){j(function(n){var a;return(0,o._)((0,i._)({},n),(0,r._)({},e,[t].concat((0,l._)(null!==(a=n[e])&&void 0!==a?a:[])).slice(0,100)))})},[]),et=(0,u.useCallback)(function(e,t,n){j(function(r){if(r[e]){for(var o=0;o<r[e].length;o++)if(r[e][o].id===t){r[e][o]=n(r[e][o]);break}r[e]=r[e].slice(0,100)}return(0,i._)({},r)})},[]),en=(0,u.useCallback)(function(){P&&j(function(e){return(0,o._)((0,i._)({},e),(0,r._)({},P,[]))})},[P]),er=(0,u.useMemo)(function(){return S.find(function(e){return e.clientId===P})},[S,P]),ei=null==er?void 0:er.isOpen(C||""),eo=(0,u.useCallback)(function(){var e=null==er?void 0:er.clientId;e&&ee(e,{canceled:!1,notification:{method:"probe",params:{filePath:C,state:null==er?void 0:er.getServerState(),capabilities:null==er?void 0:er.getServerCapabilities(),diagnostics:ei?null==er?void 0:er.getDiagnostics(C||""):[],isOpen:ei,isSupportedFile:null==er?void 0:er.isSupportedFile(C||"")}},requestTime:new Date,type:"probe"})},[ee,C,er,ei]),ea=(0,u.useMemo)(function(){if(!P)return[];var e,t,n=W.split(",").map(function(e){return e.trim()}).filter(Boolean);if(!n.length)return null!==(e=z[P])&&void 0!==e?e:[];var r=null!==(t=z[P])&&void 0!==t?t:[];return Y||(r=r.filter(function(e){return null==e.notification})),$||(r=r.filter(function(e){return null==e.request})),W&&(r=r.filter(function(e){return n.some(function(t){var n;return null===(n=e.request||e.notification)||void 0===n?void 0:n.method.toLowerCase().includes(t.toLowerCase())})})),r},[W,z,P,Y,$]);return((0,u.useEffect)(function(){return(0,G.uf)(S.flatMap(function(e){return[e.onRequest(function(t){M&&ee(e.clientId,{id:t.id,canceled:!1,request:t.data,requestTime:new Date})}),e.onResponse(function(t){M&&et(e.clientId,t.id,function(e){return(0,i._)((0,o._)((0,i._)({},e),{responseTime:new Date}),void 0!==t.result?{response:t.result}:{error:t.error})})}),e.onCancelRequest(function(t){M&&et(e.clientId,t,function(e){return(0,o._)((0,i._)({},e),{canceled:!0})})}),e.onDiagnostics(function(t){var n=t.path,r=t.diagnostics;M&&ee(e.clientId,{canceled:!1,notification:{method:"textDocument/publishDiagnostics for "+n,params:r},requestTime:new Date,type:"diagnostics"})}),e.onServerStateChange(function(t){M&&ee(e.clientId,{canceled:!1,notification:{method:"state",params:{serverState:t}},requestTime:new Date,type:"state"})}),e.onServerCapabilitiesChange(function(t){M&&ee(e.clientId,{canceled:!1,notification:{method:"capabilities",params:{serverCapabilities:t}},requestTime:new Date,type:"capabilities"})}),e.onSendNotification(function(t){M&&ee(e.clientId,{canceled:!1,notification:t,requestTime:new Date})}),e.onReceiveNotification(function(t){M&&ee(e.clientId,{canceled:!1,notification:t,requestTime:new Date})})]}))},[ee,et,M,S]),w)?null:(0,c.BX)(v.G,{css:[_.l0.flex.column],children:[(0,c.BX)(v.G,{css:[_.l0.flex.row,_.l0.align.center,_.l0.m(4),_.l0.position.sticky,_.l0.top(0),_.l0.backgroundColor.backgroundDefault,_.l0.zIndex(1)],children:[(0,c.tZ)(m.xv,{multiline:!1,children:P?(0,c.BX)(c.HY,{children:[(0,c.tZ)(L,{})," logs for ",(0,c.tZ)("code",{children:C})]}):"No LSP client available"}),(0,c.tZ)(h.hU,{alt:"Probe LSP",onClick:eo,children:(0,c.tZ)(Z.Z,{})}),(0,c.tZ)(v.G,{css:_.l0.flex.grow(1)}),(0,c.tZ)(T.Z,{id:"toggleIsLogging",isOn:M,onChange:X})]}),(0,c.tZ)(v.G,{children:(0,c.tZ)(B.hE,{name:"Visible LSP Client",value:P,onChange:N,row:!0,children:S.map(function(e){return(0,c.tZ)(B.rK,{id:e.clientId,text:e.clientName,value:e.clientId},e.clientId)})})}),(0,c.BX)(v.G,{css:[_.l0.rowWithGap(8),_.l0.m(4),_.l0.mb(8)],children:[(0,c.BX)(v.G,{css:_.l0.rowWithGap(4),children:[(0,c.tZ)(x.Z,{}),(0,c.tZ)(m.xv,{multiline:!1,children:"Show"})]}),(0,c.BX)(v.G,{css:_.l0.rowWithGap(4),children:[(0,c.tZ)(f.X,{id:U("showNotifications"),checked:Y,onChange:J}),(0,c.tZ)("label",{htmlFor:U("showNotifications"),children:" Notifications"})]}),(0,c.BX)(v.G,{css:_.l0.rowWithGap(4),children:[(0,c.tZ)(f.X,{id:U("showRequests"),checked:$,onChange:Q}),(0,c.tZ)("label",{htmlFor:U("showRequests"),children:" Requests"})]}),(0,c.tZ)(v.G,{css:_.l0.flex.growAndShrink(1)}),(0,c.tZ)(v.G,{css:_.l0.rowWithGap(4),children:(0,c.tZ)(I.Z,{onClick:en})})]}),(0,c.tZ)(v.G,{css:_.l0.rowWithGap(4),children:(0,c.tZ)(p.II,{id:U("filterLsp"),placeholder:"Filter by method (Separate by ,)",onChange:function(e){return H(e.target.value)},value:W})}),(0,c.BX)(v.G,{css:[_.l0.flex.grow(1),_.l0.flex.column,_.l0.overflow("auto")],children:[ea.map(function(e,t){var n;return(0,c.tZ)(A,{log:e},null!==(n=e.id)&&void 0!==n?n:e.requestTime.valueOf()+""+t)}),!ea.length&&(0,c.tZ)(v.G,{css:_.l0.m(4),children:"\uD83D\uDE14 No logs yet..."})]})]})},A=u.memo(function(e){var t,n,r,i,o,l=e.log,s=l.requestTime,u=l.responseTime,d=l.request,f=l.response,h=l.notification,p=l.id,x=(0,a._)((0,R.Z)(!0),2),E=x[0],T=x[1];return(0,c.BX)(v.G,{css:[_.l0.my(4),_.l0.mx(4)],children:[(0,c.BX)(v.G,{role:"button",onClick:T,onKeyDown:T,tabIndex:0,css:[_.l0.flex.row,_.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".lspLog-requestMethod":{textDecoration:"underline"}}}],children:[(0,c.BX)(v.G,{css:[_.l0.flex.grow(1),_.l0.rowWithGap(2)],children:[(0,c.tZ)(m.xv,{className:"lspLog-emoji",multiline:!1,children:(t=l.type,n=l.canceled,r=l.response,i=l.notification,"state"===t?(0,c.tZ)(w.Z,{}):"diagnostics"===t?(0,c.tZ)(g.Z,{}):"capabilities"===t?(0,c.tZ)(C.Z,{}):"probe"===t?(0,c.tZ)(Z.Z,{}):n?(0,c.tZ)(b.Z,{}):i?(0,c.tZ)(S.Z,{}):void 0!==r?(0,c.tZ)(y.Z,{}):(0,c.tZ)(k.Z,{}))}),(0,c.BX)(m.xv,{className:"lspLog-requestMethod",multiline:!1,children:[(0,c.tZ)("code",{children:null===(o=d||h)||void 0===o?void 0:o.method}),null!=p&&(0,c.BX)("code",{className:"lspLog-logId",css:{opacity:.5},children:["#",p]})]})]}),(0,c.tZ)(v.G,{css:{opacity:.5},children:null!=u&&(0,c.BX)(m.xv,{css:_.l0.fontSize(13),multiline:!1,children:[u.valueOf()-s.valueOf(),"ms"]})})]}),!E&&(0,c.BX)(c.HY,{children:[void 0!==d&&(0,c.tZ)(N,{name:"request.params",src:d.params}),void 0!==h&&(0,c.tZ)(N,{name:"notification.params",src:h.params}),void 0!==f&&(0,c.tZ)(N,{name:"response",src:f})]})]})}),N=(0,u.memo)(function(e){var t=e.name,n=e.src;return(0,c.tZ)(v.G,{css:{marginTop:5,".node-ellipsis":{letterSpacing:-2},".object-key span":{letterSpacing:0},".object-key-val":{paddingBottom:"0 !important"},'.object-key + span[style*="margin"], .array-key + span[style*="margin"]':{marginLeft:"0 !important"},".variable-row, .pushed-content .object-key-val":{paddingLeft:"10px !important",paddingBottom:"0 !important"}},children:(0,c.tZ)(d.Z,{json:(0,r._)({},t,n)})})}),L=function(){return(0,c.tZ)(m.xv,{multiline:!1,css:{display:"inline",fontStyle:"italic",fontWeight:600,textShadow:"".concat(_.TV.redDimmer," 2px 2px")},children:"LSP"})}},61155:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(66626),i=n(50959);function o(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(0,r._)((0,i.useState)(e),2),n=t[0],o=t[1];return[n,(0,i.useCallback)(function(){return o(function(e){return!e})},[])]}},46689:function(e,t,n){n.d(t,{AA:function(){return S},CH:function(){return y},Gg:function(){return v},Ne:function(){return _},pV:function(){return x},vk:function(){return w}});var r=n(41733),i=n(21262),o=n(71440),a=n(79962),l=n(58995),c=n(99165);function s(){var e=(0,i._)(["\n  fragment AutograderTest on ReplTemplateTest {\n    id\n    name\n    input\n    output\n    name\n    type\n  }\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  query Autograder($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        currentUserPermissions {\n          writeTests\n        }\n        template {\n          id\n        }\n        ioTests {\n          id\n          ...AutograderTest\n        }\n        unitTests {\n          meta {\n            id\n            ...UnitTestsReplUnitTestMeta\n          }\n          tests {\n            id\n            ...UnitTestsReplUnitTest\n            lastRun(replId: $replId) {\n              ... on ReplUnitTestLastRun {\n                status\n              }\n              ... on UserError {\n                message\n              }\n            }\n          }\n        }\n        isProject\n        isProjectFork\n        owner {\n          ... on Team {\n            id\n            isAdmin\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation SaveIOTestResults(\n    $teamId: Int!\n    $replId: String!\n    $results: [IOTestResultInput!]!\n  ) {\n    saveIOTestResults(teamId: $teamId, replId: $replId, results: $results) {\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n    }\n  }\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation CreateAutograderTest($input: CreateTemplateTestInput!) {\n    createTemplateTest(input: $input) {\n      ... on ReplTemplateTest {\n        id\n        ...AutograderTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  mutation UpdateAutograderTest($input: UpdateTemplateTestInput!) {\n    updateTemplateTest(input: $input) {\n      ... on ReplTemplateTest {\n        id\n        ...AutograderTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation DeleteAutograderTest($testId: Int!) {\n    deleteTemplateTest(testId: $testId) {\n      ... on ReplTemplate {\n        id\n        tests {\n          id\n          ...AutograderTest\n        }\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return p=function(){return e},e}var m={},v=(0,o.Ps)(s()),g=(0,o.Ps)(u(),v,a.aA,a.Rb);function y(e){var t=(0,r._)({},m,e);return l.a(g,t)}var b=(0,o.Ps)(d());function w(e){var t=(0,r._)({},m,e);return c.D(b,t)}var Z=(0,o.Ps)(f(),v);function x(e){var t=(0,r._)({},m,e);return c.D(Z,t)}var C=(0,o.Ps)(h(),v);function S(e){var t=(0,r._)({},m,e);return c.D(C,t)}var k=(0,o.Ps)(p(),v);function _(e){var t=(0,r._)({},m,e);return c.D(k,t)}},37054:function(e,t,n){n.d(t,{pZ:function(){return eT},aT:function(){return eE},jg:function(){return eS},fD:function(){return ek},Ls:function(){return eC}});var r=n(27387),i=n(96583),o=n(74985),a=n(75533),l=n(4687),c=n(57111),s=n(9135),u=n(76363),d=n(51944),f=n(92994);function h(e){var t=[],n=[],r=!1,i=!0,o=!1,a=void 0;try{for(var l,c=e.selection.ranges[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.empty||(t.push(e.sliceDoc(s.from,s.to)),n.push(s))}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}if(!t.length){var u=-1,d=!0,f=!1,h=void 0;try{for(var p,m=e.selection.ranges[Symbol.iterator]();!(d=(p=m.next()).done);d=!0){var v=p.value.from,g=e.doc.lineAt(v);g.number>u&&(t.push(g.text),n.push({from:g.from,to:Math.min(e.doc.length,g.to+1)})),u=g.number}}catch(e){f=!0,h=e}finally{try{d||null==m.return||m.return()}finally{if(f)throw h}}r=!0}return{text:t.join(e.lineBreak),ranges:n,linewise:r}}function p(e){var t=e.selection,n=e.doc,r=t.ranges.map(function(e){return e.extend(n.lineAt(e.from).from,n.lineAt(e.to).to)});return a.jT.create(r)}var m=n(82200),v=n(445),g=n(22031),y=n(22421),b=n(13358),w=n(23758),Z=n(61018),x=n(75023),C=n(74106),S=n(25425),k=n(7444),_=n(10041),E=n(2689),T=n(59868),R=n(93918),I=n(44680),D=n(83215),G=n(87279),B=n(74883),P=n(32377),A=n(48728),N=n(78786),L=n(41859),U=n(64595),O=n(52924),M=n(44620),X=n(93646),F=n(81),W=n(73030),H=n(19408),V=n(25934),z=n(12880),j=n(32781),q=n(8017),Y=n(4832),J=n(82723),K=n(48282),$=n(29287),Q=n(72526),ee=n(49418),et=n(56729),en=n(54916),er=n(50978),ei=n(67774),eo=n(18440),ea=n(19724),el=n(74652),ec=n(27308),es=n(38806),eu=n(50959),ed=n(19659),ef=n(80259),eh=n(54249),ep=n(14917),em=n(99952),ev=n(50586),eg=n(69521),ey=n(7225);function eb(e,t,n){var r=e.selection.main,i=e.sliceDoc(r.from,r.to),o=(0,ed.r6)(t);return{code:i,filePath:t,fileVersion:n,fileContent:e.doc.toString(),range:{indexFrom:r.from,indexTo:r.to,lineFrom:e.doc.lineAt(r.from).number,lineTo:e.doc.lineAt(r.to).number},language:o}}var ew=(0,R.X)({ghostwriterIcon:[$.l0.color.blurpleStronger]});function eZ(e){var t=e.label,n=e.icon,r=e.run,i=e.keyboardShortcut,o=e.dataCy;return{match:ef.pl,data:{type:"action",label:t,icon:n,run:r,keyboardShortcut:i,dataCy:o}}}function ex(e){var t=e.view,n=e.mainSelection,r=e.codeReference;t.dispatch({selection:{anchor:n.to},effects:[d.Q.of({codeReference:r,type:"ghostwriterKillswitch"}),l.tk.scrollIntoView(n.to,{y:"center"})]})}function eC(e){var t=e.path,n=(0,en.Z)().fs,r=(0,ep.eD)(),i=(0,S.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,eu.useCallback)(function(e){r(t);var o=e.state,c=o.doc,s=o.selection,u=o.lineBreak,f=c.lineAt(s.main.head);f.length&&e.dispatch({changes:{from:f.to,insert:u},selection:a.jT.cursor(f.to+1)});var h=n.getOTVersion(t),p=eb(e.state,t,h);if((0,T.j)(T.U3.GHOSTWRITER_CHAT_INLINE_OPENED,{action:"GENERATE"}),i){ex({view:e,mainSelection:e.state.selection.main,codeReference:p});return}var m=e.state.selection.main.to;e.dispatch({selection:{anchor:m},effects:[d.Q.of({codeReference:p,type:"generateCode"}),l.tk.scrollIntoView(m,{y:"center"})]})},[t,n,r,i])}function eS(e){var t=e.path,n=(0,en.Z)().fs,r=(0,em.Ef)(),i=(0,S.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,eu.useCallback)(function(e){r(t),e.dispatch({selection:p(e.state)});var o=n.getOTVersion(t),a=eb(e.state,t,o);if(i){ex({view:e,mainSelection:e.state.selection.main,codeReference:a});return}(0,T.j)(T.U3.GHOSTWRITER_CHAT_INLINE_OPENED,{action:"TRANSFORM"});var c=e.state.selection.main.to;e.dispatch({selection:{anchor:c},effects:[d.Q.of({type:"transformCode",codeReference:a}),l.tk.scrollIntoView(c,{y:"center"})]})},[t,n,r,i])}function ek(e){var t=e.path,n=(0,en.Z)().fs,r=(0,eh.ql)(),i=(0,S.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1});return(0,eu.useCallback)(function(e){e.dispatch({selection:p(e.state)});var o=n.getOTVersion(t),a=eb(e.state,t,o);if((0,T.j)(T.U3.GHOSTWRITER_CHAT_INLINE_OPENED,{action:"EXPLAIN"}),i){ex({view:e,mainSelection:e.state.selection.main,codeReference:a});return}r({chatMessage:{type:"explainCode",codeReference:a,text:"Explain code"}});var c=e.state.selection.main.to;e.dispatch({selection:{anchor:c},effects:[d.Q.of({codeReference:a,type:"explainCode"}),l.tk.scrollIntoView(c,{y:"center"})]})},[n,t,i,r])}var e_="Rename all occurrences";function eE(e){var t,n,a,d,p,x,T,R,$,ed,eh,ep,em,eb,ex,eE,eT,eR,eI,eD,eG,eB,eP,eA,eN,eL,eU,eO,eM=e.path,eX=e.openFile,eF=e.openSearchAndReplace,eW=e.view,eH=e.onCommand,eV=(t=eC({path:eM}),n=eS({path:eM}),a=ek({path:eM}),d=(0,el.gf)(ev.x.id),(0,eu.useCallback)(function(e){var r=[],i=!e.state.selection.main.empty;return t&&!i&&r.push(eZ({label:"Generate",icon:(0,o.tZ)(V.Z,{css:ew.ghostwriterIcon}),keyboardShortcut:d,run:function(){t(e)},dataCy:"context-menu-GenerateCode"})),i&&(r.push(eZ({label:"Explain",icon:(0,o.tZ)(H.Z,{css:ew.ghostwriterIcon}),dataCy:"context-menu-ExplainCode",run:function(){a(e)}})),r.push(eZ({label:"Modify",icon:(0,o.tZ)(z.Z,{css:ew.ghostwriterIcon}),keyboardShortcut:d,dataCy:"context-menu-TransformCode",run:function(){n(e)}}))),r},[t,n,a,d])),ez=(p=(0,el.gf)("editor.action.startThread"),(0,eu.useCallback)(function(e){var t=[];return t.push(eZ({label:"Start thread",icon:(0,o.tZ)(B.Z,{}),keyboardShortcut:p,run:function(){(0,er.h$)(e)}})),t},[p])),ej=(0,eu.useCallback)(function(e){var t=[eZ({label:"Copy link to position",icon:(0,o.tZ)(q.Z,{}),run:function(){var t=(0,C.sg)(e.state.doc,e.state.selection.main.head),n=t.line,r=t.character,i=(0,es.dr)({path:eM,line:n+1,col:r});(0,_.Z)(i)}}),eZ({label:"Copy",icon:(0,o.tZ)(L.Z,{}),keyboardShortcut:(0,ec.l2)({cmdOrCtrl:!0,key:"c"}),run:function(){var t=h(e.state).text;(0,_.Z)(t)}}),eZ({label:"Cut",icon:(0,o.tZ)(U.Z,{}),keyboardShortcut:(0,ec.l2)({cmdOrCtrl:!0,key:"x"}),run:function(){var t=h(e.state),n=t.text,r=t.ranges;(0,_.Z)(n),e.state.readOnly||e.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"})}})];return window.navigator.clipboard&&"readText"in window.navigator.clipboard&&t.push(eZ({label:"Paste",icon:(0,o.tZ)(A.Z,{}),keyboardShortcut:(0,ec.l2)({cmdOrCtrl:!0,key:"v"}),run:function(){return(0,r._)(function(){var t,n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:t="",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.navigator.clipboard.readText()];case 2:return t=r.sent(),[3,4];case 3:return n=r.sent(),E.kg.error("CodeMirror context menu paste failed",{message:n.message}),[2];case 4:return(0,Z.l)({filePath:eM,view:e,clipboardText:t}),[2]}})})()}})),t},[eM]),eq=(T=(x={path:eM,openFile:eX,openSearchAndReplace:eF}).path,R=x.openFile,$=x.openSearchAndReplace,ed=(0,ee.Z)(T),eh=(0,et.Z)(ed),ep=(0,eu.useRef)(null),em=(0,en.Z)().fs,eb=(0,S.P5)({controlName:"flag-clui-ctx-menu-rename-all",logFlagToAnalytics:!1}),ex=(0,el.gf)("editor.action.goToDefinition"),eE=(0,el.gf)("editor.action.goToTypeDefinition"),eT=(0,el.gf)("editor.action.goToImplementation"),eR=(0,el.gf)("editor.action.goToReferences"),eI=(0,el.gf)("editor.selection.allOccurrences"),eD=(0,el.gf)("editor.action.formatDocument"),eG=(0,el.gf)("editor.action.codeActions"),(0,eu.useCallback)(function(e){var t=[],n=eh&&ed.length;n&&eh.isFindDefinitionSupported&&R&&t.push(eZ({label:"Go to definition",icon:(0,o.tZ)(M.Z,{}),dataCy:"context-menu-JumpToDefinition",run:function(t){(0,g.wK)(e,t)},keyboardShortcut:ex})),n&&eh.isFindTypeDefinitionSupported&&R&&t.push(eZ({label:"Go to type definition",icon:(0,o.tZ)(I.Z,{}),run:function(){(0,g.OM)(e)},keyboardShortcut:eE})),n&&eh.isFindImplementationSupported&&R&&t.push(eZ({label:"Go to implementation",icon:(0,o.tZ)(K.Z,{}),run:function(){(0,g.Zc)(e)},keyboardShortcut:eT})),n&&(eh.isFindDefinitionSupported||eh.isFindReferencesSupported)&&t.push(eZ({label:"Show references",icon:(0,o.tZ)(D.Z,{}),keyboardShortcut:eR,run:function(){(0,y.Z)(e)}})),$&&t.push(eZ({label:"Find in Repl",icon:(0,o.tZ)(J.Z,{}),run:function(){$(h(e.state).text)}})),n&&eh.isRenameSupported&&(eb?t.push(eZ({label:e_,icon:(0,o.tZ)(O.Z,{}),keyboardShortcut:"F2",run:function(){(0,b.Z)(e)}})):t.push({match:ef.pl,data:{type:"context",label:e_,icon:(0,o.tZ)(O.Z,{}),keyboardShortcut:"F2"},commands:function(t){var n=t.active,a=t.search;return n&&a?[{match:function(){return{score:1}},data:{type:"action",label:"Rename",icon:(0,o.tZ)(P.Z,{}),keyboardShortcut:"Enter",run:function(){return(0,r._)(function(){var t,n,r,o;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(!(t=ed.find(function(e){return(0,eg.Z)(e).isRenameSupported})))return[2,{type:"error",message:"Rename is not supported"}];if(n=e.state.selection.main.head,!e.state.wordAt(n))return[2,{type:"error",message:"You cannot rename this element"}];return ep.current&&t.notify.cancelRequest(ep.current),ep.current=t.generateId(),[4,t.request.rename(T,(0,C.sg)(e.state.doc,n),a,{id:ep.current,tap:function(t){return(0,m.SC)(e,t)}})];case 1:if((r=i.sent()).cancelled)return[2];if("error"in r)return[2,{type:"error",message:"Something went wrong renaming ".concat(r.error.message)}];if(!(o=r.result))return[2];return(0,Q.w)({edit:o,fs:em,client:t}),[2]}})})()}}}]:[]}})),e.state.facet(s.SD)&&t.push(eZ({label:"Format document",icon:(0,o.tZ)(F.Z,{}),keyboardShortcut:eD,run:function(){(0,s.z1)(e)}})),!e.state.selection.main.empty&&e.state.facet(u.R2)&&t.push(eZ({label:"Format selection",icon:(0,o.tZ)(F.Z,{}),run:function(){(0,s.uy)(e)}})),t.push(eZ({label:"Select all occurrences",icon:(0,o.tZ)(N.Z,{}),keyboardShortcut:eI,run:function(){(0,er.SK)(e)}}));var a=void 0!==e.state.field(c.K0,!1);return n&&a&&t.push(eZ({label:"Toggle breakpoint",icon:(0,o.tZ)(G.Z,{}),run:function(){(0,er.QF)(e)}})),n&&eh.isCodeActionsSupported&&(eh.isSourceActionsSupported&&t.push(eZ({label:"Source actions",icon:(0,o.tZ)(X.Z,{}),run:function(){(0,v.b7)(e,{force:!0,only:[ey.CodeActionKind.Source]})}})),t.push(eZ({label:"More actions",icon:(0,o.tZ)(j.Z,{}),keyboardShortcut:eG,run:function(){(0,v.b7)(e,{force:!0})}}))),t},[eh,ed,R,$,eI,ex,eE,eT,eR,eb,T,em,eD,eG])),eY=(eB=(0,eo.s6)(ea.Y.EditorContextMenu),(0,eu.useCallback)(function(e){var t=[];return t.push({data:{type:"group",key:"extensions"},commands:(0,r._)(function(){var t;return(0,i.Jh)(this,function(n){switch(n.label){case 0:var o;return t=[{data:{filePath:e.filePath,selection:e.view.state.selection.toJSON()}}],[4,Promise.all(eB.map((o=(0,r._)(function(e){var n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return[4,e.create({path:t})];case 1:if(!(n=r.sent()))return[2,null];return[2,(0,ei.C)(n,{path:t})]}})}),function(e){return o.apply(this,arguments)})))];case 1:return[2,n.sent().filter(Boolean)]}})})}),t},[eB])),eJ=(0,eu.useMemo)(function(){return eW?eq(eW):[]},[eW,eq]);return eA=(eP={view:eW,commands:eJ,onCommand:eH}).view,eN=eP.commands,eL=eP.onCommand,eU=(0,k.Z)(eL),eO=(0,f.Z)({view:eA}),(0,eu.useEffect)(function(){if(eA){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=eN[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)!function(){var t=i.value,n=t.data;if(("context"===n.type||"action"===n.type)&&n.keyboardShortcut){var r=Array.isArray(n.keyboardShortcut)?n.keyboardShortcut.join(" "):n.keyboardShortcut;e.push({run:function(){if("action"===n.type)return n.run(null),!0;var e=eA.state.selection.main.head;return"context"!==n.type||n.label!==e_||eA.state.wordAt(e)?eU.current(t):(0,w.J)(eA,{message:"You cannot rename this element",offset:e}),!0},key:r,preventDefault:!0})}}()}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}try{eA.dispatch({effects:eO.reconfigure(l.$f.of(e))})}catch(e){(0,l.OO)(eA.state,e,"contextMenu")}return function(){try{eA.dispatch({effects:eO.reconfigure([])})}catch(e){(0,l.OO)(eA.state,e,"contextMenu")}}}},[eA,eN,eO,eU]),(0,eu.useCallback)(function(){var e=eW?[{data:{type:"context",label:"AI",icon:(0,o.tZ)(W.Z,{})},commands:function(){return eV(eW)}},{data:{type:"context",label:"Code actions",icon:(0,o.tZ)(j.Z,{})},commands:function(){return eq(eW)}},{data:{type:"context",label:"Social",icon:(0,o.tZ)(B.Z,{})},commands:function(){return ez(eW)}},{data:{type:"context",label:"Clipboard",icon:(0,o.tZ)(A.Z,{})},commands:function(){return ej(eW)}},{data:{type:"context",label:"Extensions",icon:(0,o.tZ)(Y.Z,{})},commands:function(){return eY({view:eW,filePath:eM})}}]:[];return{data:{type:"context",label:"Search actions",icon:(0,o.tZ)(J.Z,{})},commands:function(){return e}}},[eW,eV,eq,ez,ej,eM,eY])}var eT=new x.j(function(e,t){return e?null:l.tk.domEventHandlers({contextmenu:function(e,n){var r=e.clientX,i=e.clientY,o=n.state.selection.main,l=n.posAtCoords({x:r,y:i}),c=n.state.doc.length,s=null===l?c:l;if(s<o.from||s>o.to){var u=a.jT.cursor(s);n.dispatch({selection:u})}return t(e),!0}})})},45549:function(e,t,n){n.d(t,{u:function(){return ew}});var r,i=n(66626),o=n(74985),a=n(75533),l=n(12285),c=n(42516),s=n(4687),u=n(35895),d=n(75023),f=n(93918),h=n(74833),p=n(29287),m=n(56596),v=n(74652),g=n(59510),y=n.n(g),b=n(53466),w=n(54472),Z=n(7612),x=(0,f.X)({root:[p.l0.p(16),p.l0.align.center,p.l0.colWithGap(8),{marginTop:"10%",pointerEvents:"none","*":{pointerEvents:"all"}}],button:[p.l0.reset.button,p.l0.rowWithGap(6),p.l0.align.center,p.l0.color.foregroundDimmest,p.l0.cursor.pointer,{fontFamily:p.TV.fontFamilyDefault,"*":{borderColor:p.TV.foregroundDimmest,color:p.TV.foregroundDimmest},":hover *":{borderColor:p.TV.foregroundDefault,color:p.TV.foregroundDefault}}],iconText:[p.l0.rowWithGap(4)]}),C={layer:"cm-empty-state-layer",dom:"cm-empty-state-dom"},S=s.tk.theme((r={},(0,c._)(r,".".concat(C.layer),{width:"100%",height:"100%",pointerEvents:"none",zIndex:"201 !important"}),(0,c._)(r,".".concat(C.dom),{position:"absolute",width:"100%",pointerEvents:"none",display:"flex",justifyContent:"center"}),r)),k=function(){"use strict";function e(t){(0,l._)(this,e),this.options=t}var t=e.prototype;return t.draw=function(){var e=this.options,t=e.ctas,n=e.view,r=e.width,i=(0,w.V)((0,o.tZ)(m.G,{css:x.root,children:t.map(function(e){return(0,o.BX)(m.G,{css:x.button,onClick:function(){return e.onClick(n)},children:[(0,o.BX)(m.G,{css:x.iconText,children:[e.icon,(0,o.tZ)(h.xv,{variant:"small",children:e.text})]}),e.shortcut?(0,o.tZ)(v.bM,{keyCombo:e.shortcut,fontSize:12}):null]},e.text)})}));return i.className=C.dom,i.style.width=r+"px",i.style.visibility=r>240?"visibile":"hidden",i.style.left="0px",i},t.eq=function(e){return y()(e.options,this.options)},e}(),_=new d.j(function(e){var t=function(e){var t;return!(e.doc.length>0||e.field(b.$))&&(null===(t=e.field(u.xg,!1))||void 0===t||!t.size)},n=a.QQ.define({create:t,update:function(e,n){return t(n.state)}}),r=(0,s.EY)({above:!0,class:C.layer,update:function(e){return(0,Z.a)(e,n)},markers:function(t){if(!t.state.field(n,!1))return[];var r=t.dom.getBoundingClientRect();return[new k({ctas:e,width:Math.round(t.contentDOM.getBoundingClientRect().right-r.left),view:t})]}});return[S,n,r]}),E=n(75595),T=n(40497),R=n(73164),I=n(2038),D=n(59868),G=n(49344),B=n(25934),P=n(31270),A=n(48282),N=n(43312),L=n(4498),U=n(93496),O=n(29479),M=n(88936),X=n(50959),F=n(41733),W=n(21262),H=n(71440),V=n(58995);function z(){var e=(0,W._)(["\n  query ReplCodeExamples($language: String!) {\n    languageExamples(language: $language) {\n      ... on LanguageExamples {\n        examples {\n          ... on LanguageExample {\n            mainFile\n            name\n            code\n          }\n        }\n      }\n    }\n  }\n"]);return z=function(){return e},e}var j={},q=(0,H.Ps)(z());function Y(e){var t=(0,F._)({},j,e);return V.a(q,t)}var J=m.K.button;function K(e){var t=e.name,n=e.children,r=e.onClick;return(0,o.BX)(J,{onClick:function(){return r()},css:[U.gU.nofill,p.l0.p(8),p.l0.focusRing,p.l0.textAlign.left],children:[(0,o.tZ)(h.xv,{variant:"subheadDefault",css:p.l0.pb(16),multiline:!1,children:t}),(0,o.tZ)(m.G,{css:[p.l0.backgroundColor.backgroundDefault,p.l0.p(8),p.l0.borderRadius(8)],children:n})]})}var $="@media (min-width: ".concat(O.j.tabletMax,"px)"),Q=(0,N.iv)([p.l0.colWithGap(16),(0,c._)({},$,{width:"calc(50%  - 8px)",flex:"0 0 auto",gap:"16px"})]);function ee(e){var t=e.children;return(0,o.tZ)(m.G,{css:[(0,c._)({},$,[p.l0.rowWithGap(16)])],children:t})}function et(e){var t=e.mainFile,n=e.examples,r=e.onSelect;return(0,o.BX)(m.G,{css:[p.l0.colWithGap(24)],children:[(0,o.tZ)(h.h4,{level:1,variant:"headerDefault",children:"Code examples"}),(0,o.tZ)(h.xv,{children:"Get started with some program examples."}),(0,o.BX)(ee,{css:[p.l0.colWithGap(16)],children:[(0,o.tZ)(m.G,{css:Q,children:n.slice(0,(n.length+1)/2).map(function(e){return(0,o.tZ)(K,{name:e.name,onClick:function(){return r(e)},children:(0,o.tZ)(L.Z,{code:e.code,filePath:t,fontSize:12,disableCursorStyling:!0})},e.name)})}),(0,o.tZ)(m.G,{css:Q,children:n.slice((n.length+1)/2).map(function(e){return(0,o.tZ)(K,{name:e.name,onClick:function(){return r(e)},children:(0,o.tZ)(L.Z,{code:e.code,filePath:t,fontSize:12,disableCursorStyling:!0})},e.name)})})]})]})}function en(e){var t=e.filePath,n=e.language,r=e.onSelect,i=Y({variables:{language:n}}),a=i.data,l=i.loading,c=i.error;if(l)return(0,o.tZ)(m.G,{css:[p.l0.colWithGap(0),p.l0.justify.center,p.l0.align.center,p.l0.pt(32),p.l0.pb(32)],children:(0,o.tZ)(M.Z,{})});if(c)return(0,o.tZ)(m.G,{css:[p.l0.colWithGap(0),p.l0.justify.center,p.l0.align.center,p.l0.pt(32),p.l0.pb(32)],children:c.message});var s=(null==a?void 0:a.languageExamples.__typename)==="LanguageExamples"?a.languageExamples.examples:null;return(null==s?void 0:s.length)?(null==s?void 0:s.length)?(0,o.tZ)(et,{mainFile:t,examples:s,onSelect:r}):(0,o.tZ)(m.G,{css:[p.l0.colWithGap(0),p.l0.justify.center,p.l0.align.center,p.l0.pt(32),p.l0.pb(32)],children:(0,o.BX)(h.xv,{children:["Sorry, this language doesnt have any examples. Want to add some? Contact us at ",(0,o.tZ)("a",{href:"mailto:support@replit.com",children:"support@replit.com"}),"!"]})}):null}var er=n(50586),ei=n(88883),eo={python:'from replit.ai.modelfarm import ChatExample, ChatMessage, ChatModel, ChatSession\n\nmodel = ChatModel("chat-bison")\nresponse = model.chat([\n  ChatSession(\n    context="You are philosophy bot.",\n    examples=[\n      ChatExample(\n        input=ChatMessage(content="1 + 1"),\n        output=ChatMessage(content="2")\n      )\n    ],\n    messages=[\n      ChatMessage(author="USER", content="How much wood can a woodchuck chuck?"),\n    ],\n  )\n], temperature=0.2)\n\nprint(response.responses[0].candidates[0].message.content)',typescript:"import * as replitai from '@replit/ai-modelfarm';\n\nconst result = await replitai.chat({\n  model: 'chat-bison',\n  temperature: 0.5,\n  messages: [{ author: 'user', content: 'how are you?' }],\n});\n\nconsole.log(result);"},ea=n(75582),el=n(73524);function ec(){var e=(0,W._)(["\n  query EditorEmptyStateCurrentUser {\n    currentUser {\n      id\n      userSubscriptionType\n      userPowerUpsByType {\n        __typename\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n            CTA\n          }\n        }\n      }\n    }\n  }\n"]);return ec=function(){return e},e}var es={},eu=(0,H.Ps)(ec()),ed=n(38041),ef=n(917),eh=n(70781),ep=n(19659),em=n(85172),ev=a.Py.define(),eg=a.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,T.j)(t,ev,function(e){n=e.value}),n}}),ey=E.t.from(eg,function(e){if(!e)return null;var t=e.language,n=e.filePath;return{key:"examplesModal",node:function(e){var r=function(){e.dispatch({effects:ev.of(null)})};return(0,o.tZ)(G.u,{maxWidth:872,isOpen:!0,onRequestClose:r,children:(0,o.tZ)(eZ,{onRequestClose:r,language:t,filePath:n})})}}}),eb=[eg,ey];function ew(e){var t,n,r,i,a,l,c,s,u,d,f,h,p,m,g,y,b,w=e.isMobile,Z=e.filePath,x=e.generateCode,C=e.openPane,S=(0,v.gf)(er.x.id),k=null!==(y=null===(p=R.$R.from(Z))||void 0===p?void 0:p.id)&&void 0!==y?y:null,E=(0,em.v)().isTeamWithAiDisabled,T=Y({variables:{language:k},skip:!k}).data,G=(a=(t={openPane:C,filePath:Z,language:k}).filePath,l=t.language,c=t.openPane,s=(0,I.T3)(),d=((null==(u=(n=(0,F._)({},es,void 0),V.a(eu,n)).data)?void 0:null===(r=u.currentUser)||void 0===r?void 0:r.userSubscriptionType)===ea.HP.Hacker||(null==u?void 0:null===(i=u.currentUser)||void 0===i?void 0:i.userSubscriptionType)===ea.HP.HackerPro)&&l&&["python","javascript","typescript","javascriptreact","typescriptreact"].includes(l),f=(0,ei.Z)(a),h=(0,X.useCallback)(function(){if(l){var e="python"===l?"python":"typescript";(0,D.j)(D.U3.GHOSTWRITER_CHAT_MODELFARM_PLACEHOLDER_CLICKED,{language:e}),c({type:"docs",data:{url:el.TT.MODEL_FARM+"/".concat(e,"#installation")}}),f&&f({code:eo[e],insertAt:0})}},[f,l,c]),s?null:d?h:null),N=(null!==(b=null==T?void 0:null===(g=T.languageExamples)||void 0===g?void 0:null===(m=g.examples)||void 0===m?void 0:m.length)&&void 0!==b?b:0)>=1,L=(0,X.useMemo)(function(){var e=[];return(0,ep.gK)(Z)||E||e.push({icon:(0,o.tZ)(B.Z,{}),text:"Generate Code with AI",shortcut:w?void 0:S,onClick:function(e){(0,ed.S)({cta:"generate",version:"new"}),x(e)}}),G&&e.push({icon:(0,o.tZ)(P.Z,{}),text:"Build an AI app for free with ModelFarm",onClick:function(){(0,ed.S)({cta:"modelFarm",version:"new"}),G()}}),k&&N&&e.push({icon:(0,o.tZ)(A.Z,{}),text:"Start with a code example",onClick:function(e){(0,ed.S)({cta:"examples",version:"new"}),e.dispatch({effects:ev.of({language:k,filePath:Z})})}}),e},[w,S,G,k,N,x,Z,E]);return[_.use(L),eb]}function eZ(e){var t=e.onRequestClose,n=e.language,r=e.filePath,a=(0,eh.e)(ef.y.Examples),l=(0,eh.e)(ef.y.Editor),c=(0,i._)((0,X.useState)(!1),2),s=c[0],u=c[1],d=(0,ei.Z)(r),f=(0,X.useRef)(null==a?void 0:a.isActive),h=(0,X.useRef)();h.current=null==a?void 0:a.isActive;var p=(0,X.useRef)(null==a?void 0:a.goto);return(p.current=null==a?void 0:a.goto,(0,X.useEffect)(function(){return function(){var e;h.current&&(null===(e=p.current)||void 0===e||e.call(p,ef.y.Editor))}},[]),(0,X.useEffect)(function(){if((null==l?void 0:l.isActive)&&!f.current){if(!s){u(!0);return}l.goto(ef.y.Examples)}},[l,t,s]),(0,X.useEffect)(function(){if(null==a?void 0:a.isActive){f.current=!0;return}f.current&&t(null)},[t,null==a?void 0:a.isActive]),d)?(0,o.tZ)("div",{ref:null==a?void 0:a.delegateTooltip,children:(0,o.tZ)(en,{filePath:r,language:n,onSelect:function(e){d({code:e.code,insertAt:0}),t({exampleName:e.name})}})}):(0,o.tZ)("div",{children:"Please make sure you have a file open"})}},50586:function(e,t,n){n.d(t,{x:function(){return $},W:function(){return Q}});var r,i=n(74985),o=n(4687),a=n(12285),l=n(42516),c=n(41733),s=n(30509),u=n(75533),d=n(75023),f=n(91608),h=n(44166),p=n(93496),m=n(38080),v=n(74833),g=n(30983),y=n(56596),b=n(93918),w=n(13900),Z=n(29287),x=n(74652),C=n(95684),S=n(59510),k=n.n(S),_=n(50959),E=n(53466),T=n(54472),R=n(40497),I=n(7612),D=n(18059),G=(0,f.$)(["opacity","transform"]),B=G.cssVars,P=G.styleTokens,A=[Z.l0.display.flex,Z.l0.reset.button,Z.l0.cursor.pointer,Z.l0.center,p.gU.nofill,Z.l0.height("100%"),Z.l0.borderRadius(0)],N=[A,Z.l0.width(28),{"& svg":Z.l0.display.block}],L=(0,b.X)({root:[Z.l0.align.stretch,Z.l0.flex.row,Z.l0.borderRadius(6),Z.l0.border({color:Z.TV.outlineDefault}),Z.l0.position.relative,Z.l0.height(30),{opacity:P.opacity,transform:P.transform,transition:"opacity 120ms, transform 120ms","button:first-of-type":{borderTopLeftRadius:6,borderBottomLeftRadius:6},"button:last-of-type":{borderTopRightRadius:6,borderBottomRightRadius:6}}],moreButton:N,button:[A,Z.l0.rowWithGap(4),Z.l0.align.center,Z.l0.pl(4),Z.l0.pr(6),Z.l0.flex.growAndShrink(1),Z.l0.border({direction:"right",color:Z.TV.outlineDefault}),{fontFamily:Z.TV.fontFamilyDefault,"*":{color:Z.TV.foregroundDimmer},":hover *":{color:Z.TV.foregroundDefault},".shortcut":{color:Z.TV.foregroundDimmest},":hover .shortcut":{color:Z.TV.foregroundDimmer}}],iconButton:[N,Z.l0.border({direction:"right",color:Z.TV.outlineDefault})],tooltip:[Z.l0.rowWithGap(2),Z.l0.align.center]}),U=new T.J(function(e){var t,n=e.controls,r=e.verticalPlacement,o=e.onMoreClick,a=(0,_.useRef)(null),u=(0,D.NJ)(),d=(0,C.xx)();(0,_.useEffect)(function(){var e;d(),(0,h.A)(a,(e={},(0,l._)(e,B.opacity,"1"),(0,l._)(e,B.transform,"translateY(calc(".concat("top"===r?1:-1," * ").concat(Z.TV.space4,"))")),e))},[r,d]);var f=(0,_.useRef)((0,C.qm)());return(0,i.BX)(m.Tg,{innerRef:a,elevated:!0,css:L.root,style:(t={},(0,l._)(t,B.opacity,"0"),(0,l._)(t,B.transform,"translateY(calc(".concat("top"===r?1:-1," * ").concat(Z.TV.space16,"))")),t),children:[n.map(function(e){if(f.current){var t=(0,i.BX)(y.G,{css:L.tooltip,children:[(0,i.tZ)(v.xv,{variant:"small",multiline:!1,children:e.text}),e.shortcut?(0,i.tZ)(v.xv,{variant:"small",className:"shortcut",color:"dimmest",children:(0,x.Ih)(e.shortcut,u)}):null]});return(0,i.tZ)(g.u,{tooltip:t,children:function(t,n){return(0,i.tZ)(y.G,(0,s._)((0,c._)({},t),{innerRef:n,css:L.iconButton,onClick:e.onClick,tag:"button",children:e.icon}))}},e.text)}return(0,i.BX)(y.G,{css:L.button,onClick:e.onClick,tag:"button",children:[e.icon,(0,i.tZ)(v.xv,{variant:"small",multiline:!1,children:e.text}),e.shortcut?(0,i.BX)(v.xv,{variant:"small",className:"shortcut",children:["(",(0,x.Ih)(e.shortcut,u),")"]}):null]},e.text)}),o?(0,i.tZ)(y.G,{"aria-label":"More",css:L.moreButton,onClick:function(e){var t=(a.current||e.currentTarget).getBoundingClientRect();o({top:t.top,right:t.right})},tag:"button",children:(0,i.tZ)(w.Z,{size:16})}):null]})}),O={layer:"cm-selection-controls-layer",dom:"cm-selection-controls-dom"},M=o.tk.theme((r={},(0,l._)(r,".".concat(O.layer),{width:"100%"}),(0,l._)(r,".".concat(O.dom),{position:"absolute"}),r)),X=function(){"use strict";function e(t){(0,a._)(this,e),this.options=t}var t=e.prototype;return t.draw=function(){var e=this.options,t=e.controls,n=e.onMoreClick,r=e.top,i=e.align,o=e.verticalPlacement,a=U.create({controls:t,onMoreClick:n,verticalPlacement:o});return a.className=O.dom,a.style.top=r+"px","left"===i.side?(a.style.left=i.value+"px",a.style.right=""):(a.style.right=i.value+"px",a.style.left=""),a},t.eq=function(e){return k()(e.options,this.options)},e}(),F=u.Py.define(),W=u.QQ.define({create:function(){return null},update:function(e,t){var n;return!t.state.selection||(null===(n=t.state.selection)||void 0===n?void 0:n.main.empty)?null:((0,R.j)(t,F,function(t){e=t.value}),e)}}),H=u.QQ.define({create:function(e){return!e.selection.main.empty},update:function(e,t){return!t.state.selection.main.empty}}),V=o.lg.define(function(e){var t=function(){var t=e.state.selection.main;e.dispatch({effects:F.of(t.empty?null:Date.now())})},n=function(e){"Shift"===e.key&&t()},r=function(){document.addEventListener("mouseup",t),document.addEventListener("keyup",n)},i=function(){document.removeEventListener("mouseup",t),document.removeEventListener("keyup",n)};return{update:function(e){(0,I.a)(e,H)&&(e.state.field(H)?r():i())},destroy:i}}),z=new d.j(function(e){return[M,(0,o.EY)({above:!0,class:O.layer,update:function(e){return(0,I.a)(e,E.$,W)},markers:function(t){if(!t.hasFocus)return[];var n=t.state.field(W)?t.state.selection.main:null;if(!n||t.state.field(E.$,!1))return[];var r=function(e,t){for(var n=Math.min(t.from,t.to),r=Math.max(t.from,t.to),i=null;n<=r;){var o=e.lineAt(n);n=o.to+1,null!==i&&o.length<i.length||(i=o)}return i}(t.state.doc,n);if(!r)return[];var i=t.coordsAtPos(r.to);if(!i)return[];var o=t.lineBlockAt(Math.min(n.anchor,n.head)),a=t.dom.getBoundingClientRect(),l=t.contentDOM.getBoundingClientRect(),c=o.top+t.documentPadding.top-30,s=l.right-i.left<200?{side:"right",value:a.right-l.right+16}:{side:"left",value:i.left-a.left},u="top";if(c<t.scrollDOM.scrollTop){var d=t.lineBlockAt(n.to);c=d.top+d.height,u="bottom"}return[new X({top:c,align:s,controls:e.controls(t),onMoreClick:e.onMoreClick,verticalPlacement:u})]}}),H,W,V]}),j=n(85172),q=n(19408),Y=n(12880),J=n(27308),K=n(49932),$={id:"editor.generateOrModifyWithAI",name:"AI",description:"Generate or modify selection with AI",default:(0,J.l2)({cmdOrCtrl:!0,key:"i"})};function Q(e){var t=e.editCode,n=e.explainCode,r=e.generateCode,a=e.onMoreClick,l=(0,j.v)().isTeamWithAiDisabled,c=(0,x.gf)($.id),s=(0,_.useMemo)(function(){if(!c)return[];var e=Array.isArray(c)?c.join(" "):c;return o.$f.of([{key:e,scope:"editor",run:function(e){return e.state.selection.main.empty?r(e):t(e),!0}}])},[c,r,t]),u=(0,_.useMemo)(function(){return{controls:function(e){return l?[]:[{text:"Modify",icon:(0,i.tZ)(Y.Z,{size:16,color:K.TV.blurpleStronger}),onClick:function(){return t(e)},shortcut:c},{text:"Explain",icon:(0,i.tZ)(q.Z,{size:16,color:K.TV.blurpleStronger}),onClick:function(){return n(e)}}]},onMoreClick:a}},[t,n,a,c,l]),d=z.use(u);return(0,_.useMemo)(function(){return[d,s]},[d,s])}},38041:function(e,t,n){n.d(t,{S:function(){return p},r:function(){return h}});var r,i=n(27387),o=n(96583),a=n(89446),l=n(59868),c=n(19659),s=n(39756),u=RegExp("_(?<num>\\d+)$");function d(){return(d=(0,i._)(function(e,t){var n,r,i,a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return n=(0,c.Il)(t),[4,e.readDir(n||s.Ql)];case 1:if((r=o.sent()).error)return[2,t];return a=(i=function(e){if(r.children.find(function(t){return"FILE"===t.type&&t.filename===e})){var t,n=(0,c.eb)(e),o=(0,c.r6)(e),a=n.match(u);if(null==a?void 0:null===(t=a.groups)||void 0===t?void 0:t.num){var l=Number(a.groups.num);return i("".concat(n.replace(u,""),"_").concat(l+1,".").concat(o))}return i("".concat(n,"_2.").concat(o))}return e})((0,c.UO)(t)),[2,n?n+"/"+a:a]}})})).apply(this,arguments)}var f=n(41500),h=(r=(0,i._)(function(e,t,n){var r,i,l,s,u,h;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return r=encodeURI(e.name),[4,function(e,t){return d.apply(this,arguments)}(t,(i=(0,c.Il)(n))?i+"/"+r:r)];case 1:return l=o.sent(),[4,(0,a.pV)(e)];case 2:return s=o.sent(),[4,t.writeFile(l,f.Z.from(s))];case 3:return o.sent(),u=(0,c.eb)(e.name),h=(0,c.UO)(l),[2,"![".concat(u,"](").concat(h,")")]}})}),function(e,t,n){return r.apply(this,arguments)});function p(e){var t=e.cta,n=e.version;(0,l.j)(l.U3.EDITOR_EMPTY_STATE_CLICKED,{cta:t,version:n})}},11398:function(e,t,n){n.d(t,{Mp:function(){return l},ac:function(){return a},ev:function(){return o}});var r=n(43312),i=n(29287),o=(0,r.iv)({position:"relative",overflowY:"auto",width:"100%",height:"100%",zIndex:3}),a=(0,r.iv)({position:"relative",overflowY:"auto",width:"100%",height:"100%",fontSize:"14px",backgroundColor:i.TV.backgroundDefault}),l=(0,r.iv)({display:"flex",alignItems:"stretch",width:"100%",height:"100%","& > .cm-editor":{flex:"1 1 auto",width:"100%"}})},17225:function(e,t,n){n.d(t,{Q1:function(){return b},Rz:function(){return g},xy:function(){return w}});var r=n(27387),i=n(63257),o=n(96583),a=n(74985),l=n(69119),c=n(57468),s=n(56596),u=n(93918),d=n(29287),f=n(85045),h=n(19659),p=(0,u.X)({root:[d.l0.rowWithGap(8),d.l0.align.center,d.l0.flex.growAndShrink(1),d.l0.px(8),{userSelect:"none"}],header:[{fontSize:d.TV.fontSizeSmall,opacity:.6},d.l0.color.foregroundDimmest,d.l0.truncate],result:[d.l0.colWithGap(0)],fileName:[d.l0.truncate,d.l0.flex.row]});function m(e){var t=e.height,n=e.active,r=e.match,i=r.directory,o=r.filename;return(0,a.BX)(s.G,{css:p.root,style:{height:t},children:[(0,a.tZ)(c.Z,{path:o.text,size:16}),(0,a.BX)(s.G,{css:p.result,children:[i?(0,a.tZ)(s.G,{css:p.header,children:(0,a.tZ)(l.x,{text:i.text+"/",highlight:i.ranges,dimmed:!n})}):null,(0,a.tZ)(s.G,{css:p.fileName,children:(0,a.tZ)(l.x,{text:o.text,highlight:o.ranges,dimmed:!n})})]})]})}var v={match:f.kN,forward:!1,tiebreakers:[function(e,t,n){return n(e.item).trim().length-n(t.item).trim().length}]};function g(e,t){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function(e,t){return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,new f.Zn(t,v).find(e)];case 1:return[2,n.sent().map(function(e){return{path:e.item,score:e.score,ranges:function(e){for(var t=(0,i._)(e.values()).sort(function(e,t){return e-t}),n=[],r=t[0],o=t[0],a=1;a<t.length;a++)t[a]===o+1?o++:(n.push({from:r,to:o+1}),r=t[a],o=t[a]);return n.push({from:r,to:o+1}),n}(e.positions)}})]}})})).apply(this,arguments)}function b(e){var t=e.ranges,n=e.path,r=(0,h.UO)(n),i=(0,h.Il)(n);if(!i)return{filename:{text:r,ranges:t.length?t:void 0}};var o=i.length,a=o+1,l=[],c=[],s=!0,u=!1,d=void 0;try{for(var f,p=t[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var m=f.value;if(m.from<o){l.push({from:m.from,to:Math.min(m.to,o)});var v=m.to-a;if(v<=0)continue;c.push({from:0,to:v});continue}m.from<a||c.push({from:m.from-a,to:m.to-a})}}catch(e){u=!0,d=e}finally{try{s||null==p.return||p.return()}finally{if(u)throw d}}return{filename:{text:r,ranges:c.length?c:void 0},directory:{text:i,ranges:l.length?l:void 0}}}function w(e){var t=e.path,n=e.ranges,r=b({path:t,ranges:null!=n?n:[]}),i=r.directory?44:32;return{height:i,content:(0,a.tZ)(m,{match:r,height:i})}}},7727:function(e,t,n){n.d(t,{i:function(){return Z},w:function(){return y}});var r=n(27387),i=n(66626),o=n(96583),a=n(74985),l=n(43182),c=n(57468),s=n(74833),u=n(56596),d=n(81764),f=n(93646),h=n(20573),p=n(29287),m=n(80259),v=n(41500),g=n(17225);function y(e){return b.apply(this,arguments)}function b(){return(b=(0,r._)(function(e){var t,n,r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(t=e.search,n=e.paths,r=e.run,!t)return[2,n.map(function(e){return{data:{type:"action",label:e,icon:(0,a.tZ)(c.Z,{path:e}),run:function(){return r(e)}},match:function(){return{score:1,render:(0,g.xy)({path:e})}}}})];return[4,(0,g.Rz)(t,n)];case 1:return[2,i.sent().map(function(e){var t=e.path,n=e.score,i=e.ranges;return{data:{type:"action",label:t,icon:(0,a.tZ)(c.Z,{path:t}),run:function(){return r(t)}},match:function(){return{score:n,render:(0,g.xy)({path:t,ranges:i})}}}})]}})})).apply(this,arguments)}function w(){return(0,a.BX)(u.G,{css:[p.l0.rowWithGap(8)],children:[(0,a.tZ)(h.Z,{}),(0,a.tZ)(s.xv,{color:"dimmest",multiline:!1,children:"Something went wrong searching your Repl's files. Please try again."})]})}function Z(e){var t;return(0,m.fA)({type:"context",label:"Files",description:"Find a file",icon:(0,a.tZ)(f.Z,{}),keyboardShortcut:e.keyboardShortcut?e.keyboardShortcut:void 0},{match:(0,m.zf)({defaultScore:3}),commands:(t=(0,r._)(function(t){var n,s,u,f,p,m,g,b,Z,x,C,S,k,_,E,T;return(0,o.Jh)(this,function(R){switch(R.label){case 0:if(n=e.fs,s=e.shouldHideFile,!t.search&&(!t.active||e.lazyLoad))return[2,[]];return[4,Promise.resolve(e.getRecentFiles())];case 1:if(u=R.sent(),f=[],!(t.search||t.active))return[3,3];return[4,n.listFiles()];case 2:if((p=R.sent()).error)return l.Tb(Error("Find or create file returned an error"),{extra:{message:p.error}}),[2,[{data:{type:"error",label:p.error,icon:(0,a.tZ)(h.Z,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(w,{})}}}}]];if(!p.files)throw Error("Expected files");m=!0,g=!1,b=void 0;try{for(Z=p.files[Symbol.iterator]();!(m=(x=Z.next()).done);m=!0)C=x.value,s(C)||u.includes(C)||f.push(C)}catch(e){g=!0,b=e}finally{try{m||null==Z.return||Z.return()}finally{if(g)throw b}}R.label=3;case 3:return S=[],[4,Promise.all([y({search:t.search,paths:u,run:function(t){e.openFile({path:t})}}),y({search:t.search,paths:f,run:function(t){e.openFile({path:t})}})])];case 4:return _=(k=i._.apply(void 0,[R.sent(),2]))[0],E=k[1],_.length&&S.push({data:{type:"context",label:"Recent",icon:(0,a.tZ)(d.Z,{})},commands:function(){return _}}),E.length&&S.push({data:{type:"group",key:"files"},commands:function(){return E}}),0===E.length&&0===_.length&&t.active&&(T=t.search,S.push({data:{label:T,description:"Create a new file",icon:(0,a.tZ)(c.Z,{path:T}),type:"action",run:(0,r._)(function(){return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,n.writeFile(T,v.Z.from(""))];case 1:if(t.sent().error)return[2,{type:"error",message:'Could not create "'+T+'"'}];return e.openFile({path:T}),[2]}})})},match:function(){return{score:1}}})),[2,S]}})}),function(e){return t.apply(this,arguments)})})}},56287:function(e,t,n){n.d(t,{F:function(){return _},q:function(){return k}});var r=n(27387),i=n(66626),o=n(96583),a=n(74985),l=n(43182),c=n(39313),s=n(43208),u=n(57468),d=n(74833),f=n(56596),h=n(93918),p=n(82723),m=n(20573),v=n(29287),g=n(80259),y=n(27308),b=n(19924),w=(0,h.X)({root:[v.l0.colWithGap(4),v.l0.align.start,v.l0.flex.growAndShrink(1),v.l0.p(8)],header:[v.l0.rowWithGap(4),v.l0.align.center],singleLine:[{whiteSpace:"nowrap",fontFamily:v.TV.fontFamilyCode},v.l0.truncate,v.l0.color.foregroundDimmest]});function Z(e){var t=e.path,n=e.line;return(0,a.BX)(f.G,{css:w.root,children:[(0,a.BX)(f.G,{css:w.header,children:[(0,a.tZ)(u.Z,{path:t,size:12}),(0,a.BX)(d.xv,{variant:"small",color:"dimmest",multiline:!1,children:[t.replace(/^\.\//,""),":",n.lineNumber]})]}),(0,a.tZ)(f.G,{css:w.singleLine,children:(0,a.tZ)(c.xK,{source:n.content,matches:n.matches})})]})}function x(){return(0,a.BX)(f.G,{css:[v.l0.px(8),v.l0.rowWithGap(8),v.l0.align.center],children:[(0,a.tZ)(m.Z,{}),(0,a.tZ)(d.xv,{color:"dimmest",multiline:!1,children:"Something went wrong searching your Repl's contents. Please try again."})]})}function C(){return(0,a.BX)(f.G,{css:[v.l0.rowWithGap(8),v.l0.p(8),v.l0.align.center],children:[(0,a.tZ)(m.Z,{}),(0,a.tZ)(d.xv,{color:"dimmest",multiline:!1,children:"Displaying only part of the results, try being more specific with your search."})]})}function S(){return(0,a.tZ)(f.G,{css:[v.l0.rowWithGap(8),v.l0.p(8),v.l0.align.center],children:(0,a.tZ)(d.xv,{color:"dimmest",multiline:!1,children:"Nothing came up searching your Repl's content."})})}var k=(0,y.l2)({cmdOrCtrl:!0,shift:!0,key:"f"});function _(e){var t,n,c=(0,b.e)({container:e.container});return(0,g.fA)({type:"context",description:"Search through your files",label:"Search",icon:(0,a.tZ)(p.Z,{}),keyboardShortcut:e.keyboardShortcut?k:void 0},{match:(0,g.zf)({defaultScore:2}),commands:(t=(0,r._)(function(t){var r,d,h,p,v,g,y,b,w,k,_,E;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(!t.search||!t.active&&e.activeOnly)return[2,[]];return n=r=Math.random(),[4,c({query:t.search})];case 1:if(h=(d=o.sent()).results,p=d.error,v=d.isPartialResult,r!==n)return[2,[]];if(null!==p){if(!t.active)return[2,[]];return l.Tb(Error("Search file contents returned an error"),{extra:{message:p}}),[2,[{data:{type:"error",label:"error",icon:(0,a.tZ)(m.Z,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(x,{})}}}}]]}g=[],y=!0,b=!1,w=void 0;try{for(k=function(){var n=(0,i._)(E.value,2),r=n[0];n[1].forEach(function(n){var i=n.matches[0].column;g.push({match:function(){var e=s.Z.match(t.search,n.content);return{score:(null==e?void 0:e.score)||1,render:{height:60,content:(0,a.tZ)(Z,{path:r,line:n})}}},data:{type:"action",label:r,icon:(0,a.tZ)(u.Z,{path:r}),key:[r,n.lineNumber,i].join(":"),run:function(){e.openFile({path:r,line:n.lineNumber,col:i})}}})})},_=Object.entries(h)[Symbol.iterator]();!(y=(E=_.next()).done);y=!0)k()}catch(e){b=!0,w=e}finally{try{y||null==_.return||_.return()}finally{if(b)throw w}}if(0===g.length&&t.active)return[2,[{data:{type:"output",label:"",icon:(0,a.tZ)(f.G,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(S,{})}}}}]];if(t.active){if(0===g.length)return[2,[{data:{type:"output",label:"",icon:(0,a.tZ)(f.G,{})},match:function(){return{score:1,render:{content:(0,a.tZ)(S,{})}}}}]];v&&g.push({data:{type:"error",label:"error",icon:(0,a.tZ)(m.Z,{})},match:function(){return{score:1/0,render:{content:(0,a.tZ)(C,{})}}}})}return[2,g]}})}),function(e){return t.apply(this,arguments)})})}},15011:function(e,t,n){n.d(t,{Z:function(){return ew}});var r,i,o=n(27387),a=n(41733),l=n(30509),c=n(66626),s=n(96583),u=n(74985),d=n(50959),f=n(39426),h=n(39713),p=n(59735),m=n(76999),v=n.n(m),g=function(e){var t=(0,h._)({},(0,p._)(e));return(0,u.BX)(u.HY,{children:[(0,u.tZ)(v(),{id:"fcfe85a13ecbf46b",children:".one.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:0s;-moz-animation-delay:0s;-o-animation-delay:0s;animation-delay:0s}.two.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:.1s;-moz-animation-delay:.1s;-o-animation-delay:.1s;animation-delay:.1s}.three.jsx-fcfe85a13ecbf46b{opacity:.1;-webkit-animation:dot 1.5s ease-in-out infinite;-moz-animation:dot 1.5s ease-in-out infinite;-o-animation:dot 1.5s ease-in-out infinite;animation:dot 1.5s ease-in-out infinite;-webkit-animation-delay:.2s;-moz-animation-delay:.2s;-o-animation-delay:.2s;animation-delay:.2s}@-webkit-keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}@-moz-keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}@-o-keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}@keyframes dot{0%{opacity:.1}50%{opacity:1}100%{opacity:.1}}"}),(0,u.tZ)("span",(0,l._)((0,a._)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"one"),children:"."})),(0,u.tZ)("span",(0,l._)((0,a._)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"two"),children:"."})),(0,u.tZ)("span",(0,l._)((0,a._)({},t),{className:"jsx-fcfe85a13ecbf46b "+(t&&null!=t.className&&t.className||"three"),children:"."}))]})},y=n(78975),b=n(59121),w=n(72310),Z=n(76433),x=n(50782),C=n(59868),S=n(1498),k=n(59639),_=n(18836),E=n(93496),T=n(49344),R=n(38080),I=n(74833),D=n(56596),G=n(88936),B=n(20573),P=n(29287),A=n(54916),N=n(35972),L=n(43891),U=n(4004),O=n(30084),M=n(43778),X=function(e){var t=e.split("/");if(1===t.length)return t;for(var n=[],r=0;r<t.length;r++)n.push(t.slice(0,r+1).join("/"));return n},F=function(){var e=(0,A.Z)(),t=e.fs,n=e.dotReplit,r=(0,L.P)(n),i=(0,c._)((0,d.useState)(null),2),a=i[0],l=i[1];return(0,d.useEffect)(function(){var e;(e=(0,o._)(function(){var e,n,i,o;return(0,s.Jh)(this,function(a){switch(a.label){case 0:if(!r)return[2];return[4,t.listFiles()];case 1:if((e=a.sent()).error||!e.files)return l([]),[2];return[4,t.readFile(U.l)];case 2:return n=a.sent(),i=e.files,o=M.uP.concat(M.nh),l(i.filter(function(e){return(n.error===O.Df.NotFound||!r.some(function(t){return X(e).some(function(e){return null!=e.match(t)})}))&&!o.includes(e)})),[2]}})}),function(){return e.apply(this,arguments)})()},[r,t]),a},W=n(81701),H=n(21262),V=n(71440),z=n(58995),j=n(99165);function q(){var e=(0,H._)(["\n  query ConfigReplLanguage($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        language\n      }\n    }\n  }\n"]);return q=function(){return e},e}function Y(){var e=(0,H._)(["\n  mutation ConfigUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n      }\n    }\n  }\n"]);return Y=function(){return e},e}var J={},K=(0,V.Ps)(q()),$=(0,V.Ps)(Y()),Q=n(43312),ee=n(31366),et=n(42308),en=n(7444),er=n(35273),ei=n(79217),eo=n(82723),ea=n(43208),el=n(21371),ec=(0,Q.iv)([P.l0.py(8),P.l0.pl(8),P.l0.pr(32),{color:"inherit",outline:"0 none",border:"1px solid",fontSize:"inherit",lineHeight:P.TV.space16,display:"block",width:"100%","::placeholder, :disabled":{color:P.TV.foregroundDimmer,borderColor:"transparent"},cursor:"text"}]),es=(0,Q.iv)([P.l0.reset.button,E.gU.listItem,P.l0.borderRadius(8),P.l0.center,{width:24,height:24}]),eu=D.K.button;function ed(e){var t,n,r,i,o,s,f,h,p,m,v,g=e.id,y=e.onSelect,b=e.onInit,w=e.options,Z=e.initialSelectedOption,x=e.placeholderText,C=e.autoFocus,S=e.disabled,k=(0,d.useRef)(null),E=(0,c._)((0,d.useState)(null!=Z?Z:""),2),T=E[0],R=E[1],G=(n=(t={options:w,initialSelectedOption:Z,inputRef:k,setInputValue:R}).options,r=t.initialSelectedOption,i=t.inputRef,o=t.setInputValue,f=(s=(0,c._)((0,d.useState)(""),2))[0],h=s[1],p={options:n,filter:f},m=(0,d.useMemo)(function(){return p.filter?ea.Z.filter(p.filter.toLowerCase(),p.options).map(function(e){return e.original}):p.options},[p.options,p.filter]),v=(0,el.Kb)({items:m,initialHighlightedIndex:0,initialSelectedItem:r,stateReducer:function(e,t){var n,r,c=t.type,s=t.changes;return((c===el.Kb.stateChangeTypes.ItemClick||c===el.Kb.stateChangeTypes.InputKeyDownEnter&&s.selectedItem)&&(null===(n=i.current)||void 0===n||n.blur()),c!==el.Kb.stateChangeTypes.InputBlur||s.selectedItem)?(c===el.Kb.stateChangeTypes.InputBlur&&s.selectedItem&&o(null!==(r=s.selectedItem)&&void 0!==r?r:""),s):(0,l._)((0,a._)({},s),{isOpen:!0})}}),{filteredOptions:m,combobox:v,setFilter:h,filter:f}),B=G.filteredOptions,A=G.filter,N=G.combobox,L=G.setFilter,U=(0,en.Z)(y),O=(0,en.Z)(b);return(0,d.useEffect)(function(){Z&&(O.current(Z),R(Z),L(""))},[Z]),(0,er.Z)(function(){var e;N.selectedItem&&(null===(e=k.current)||void 0===e||e.blur(),U.current(N.selectedItem),R(N.selectedItem),L(""))},[N.selectedItem,U]),(0,d.useEffect)(function(){Z&&(N.selectItem(Z),R(Z),L(""))},[Z]),(0,u.BX)(D.G,{children:[(0,u.tZ)("div",(0,l._)((0,a._)({},N.getComboboxProps()),{children:(0,u.BX)(D.G,{css:[P.l0.flex.row,{position:"relative"}],children:[(0,u.tZ)(D.G,{css:[P.l0.flex.growAndShrink(1)],children:(0,u.tZ)(_.II,(0,l._)((0,a._)({},N.getInputProps({id:g,spellCheck:!1,autoFocus:C,onChange:function(e){L(e.currentTarget.value.toLowerCase()),R(e.currentTarget.value)},ref:k,onFocus:function(e){N.openMenu(),e.currentTarget.select()}})),{value:T,placeholder:null!=Z?Z:x,css:[ec],disabled:S}))}),S?null:(0,u.tZ)(D.G,{css:[{position:"absolute",top:0,right:0,height:"100%"},P.l0.center],children:(0,u.tZ)(eu,(0,l._)((0,a._)({},N.getToggleButtonProps()),{css:es,type:"button",children:N.inputValue&&!N.isOpen?(0,u.tZ)(ei.Z,{}):(0,u.tZ)(eo.Z,{})}))})]})})),(0,u.BX)("div",(0,l._)((0,a._)({},N.getMenuProps()),{css:{position:"relative"},children:[N.isOpen&&B.length?(0,u.tZ)(ee.Z,{children:(0,u.tZ)("ul",{css:[P.l0.pt(4),P.l0.pb(8)],children:B.map(function(e,t){return(0,u.tZ)("li",(0,l._)((0,a._)({},N.getItemProps({item:e,index:t})),{children:(0,u.tZ)(et.Z,(0,l._)((0,a._)({},{title:e,key:e.toLowerCase()}),{filter:A,selected:N.selectedItem===e,highlighted:N.highlightedIndex===t}))}),e.toLowerCase())})})}):null,A&&!B.length&&N.isOpen?(0,u.tZ)(ee.Z,{children:(0,u.tZ)(D.G,{css:[P.l0.p(16),P.l0.colWithGap(4)],children:(0,u.BX)(I.xv,{color:"dimmer",multiline:!1,children:['No results for "',A,'"']})})}):null]}))]})}var ef=n(37229),eh=n(19659);(r=i||(i={})).Unknown="UNKNOWN",r.Npm="NPM",r.Django="DJANGO",r.Rails="RAILS",r.DotNet="DOTNET",r.Cargo="CARGO",r.Make="MAKE",r.RegularRun="REGULAR_RUN";var ep=RegExp("((index)|(main)|(app)|(run)|(start)|(server))\\..+","i"),em=RegExp("((node_modules)|(venv)|(bower_components)|(vendor)|(build)|(dist)|(target)|(\\.git)|(\\.vscode)|(\\.idea)).+$","i");function ev(e){var t=e.children;return(0,u.BX)(R.Tg,{background:"default",css:[P.l0.borderRadius(8),{width:"100%",height:"calc(100% - var(--space-2))",backgroundColor:"var(--background-default)",overflowY:"auto",marginTop:"0px"}],children:[(0,u.tZ)(D.G,{children:(0,u.tZ)(I.xv,{multiline:!1,variant:"subheadDefault",css:[P.l0.color.foregroundDimmest,P.l0.pl(16),P.l0.pt(16)],children:".replit"})}),(0,u.tZ)(D.G,{css:[P.l0.p(16),P.l0.justify.center,P.l0.align.center,{flex:"1 1 auto"}],children:t})]})}function eg(e){var t,n=!!e.hasInterpreter,r=e.initialRun,o=null!==(t=e.initialCompile)&&void 0!==t?t:"",s=e.isFrameworkRecommended,h=!!e.projType&&e.projType===i.Rails,p=e.isApplyingConfig,m=(0,c._)((0,d.useState)("Unknown"===f.ZP.get(e.initialLanguage).displayName?"bash":e.initialLanguage),2),v=m[0];m[1];var g=(0,w.Y)(e.initialRun,function(e){if(!e)return{message:"Add a run command"}}),y=(0,c._)((0,d.useState)(e.initialCompile),2),b=y[0],Z=y[1];(0,d.useEffect)(function(){g.setValue(r)},[r]),(0,d.useEffect)(function(){Z(null!=o?o:"")},[o]);var x=(0,w.Y)("",function(e){if(!e)return{message:"Choose an entry point file"}}),C=(0,c._)((0,d.useState)(!!(n&&!s)),2),R=C[0],A=C[1];(0,d.useEffect)(function(){A(!!(n&&!s))},[n,s]);var L=D.K.a,U=(0,c._)((0,d.useState)([]),2),O=U[0],M=U[1],X=F();return(0,d.useEffect)(function(){X&&M(X)},[X]),(0,u.BX)("form",{onSubmit:function(t){if(t.preventDefault(),e.setIsApplyingConfig(!0),!g.value&&!R){g.validate();return}e.onSubmit({run:g.value,compile:null!=b?b:"",entry:x.value,deleteInterp:!R,onDone:e.closeConfigPane,runChanged:g.value!==r,compileChanged:b!==o,projType:e.projType})},css:[P.l0.maxWidth(400),{width:"100%"}],children:[(0,u.BX)(D.G,{css:[P.l0.colWithGap(8)],children:[e.hasProcfile?(0,u.tZ)(D.G,{css:[P.l0.colWithGap(8)],children:(0,u.BX)(I.xv,{variant:"small",css:[P.l0.mb(24)],children:["Looks like you came from Heroku!",(0,u.tZ)(L,{target:"_blank",href:"https://docs.replit.com/tutorials/import-heroku",rel:"noopener noreferrer",children:"Read more about Replit and Heroku here."})]})}):null,n?(0,u.tZ)(D.G,{css:[P.l0.pb(16)],children:(0,u.BX)(k.hE,{disabled:p,name:"interpreterView",value:R.toString(),row:!0,onChange:function(){return A(function(e){return!e})},stretch:!0,primary:!0,children:[(0,u.tZ)(k.rK,{id:"interpreterFalse",value:"false",text:"Use run command"}),(0,u.tZ)(k.rK,{id:"interpreterTrue",value:"true",text:"Use default interpreter"})]})}):null,(0,u.BX)(D.G,{css:[P.l0.height(e.initialCompile?210:170),P.l0.colWithGap(8)],children:[R?null:(0,u.BX)(D.G,{css:[P.l0.maxWidth(400),P.l0.colWithGap(8)],children:[e.initialCompile?(0,u.BX)(D.G,{css:[P.l0.colWithGap(4)],children:[(0,u.tZ)("label",{htmlFor:"compile-sel",children:"Configure the Compile Command"}),(0,u.tZ)(I.xv,{variant:"small",color:"dimmest",children:"This is optional, and is executed before your run command."}),(0,u.tZ)(_.II,{disabled:p,id:"compile-sel",type:"text",value:b,placeholder:"Enter a command to compile the program",onChange:function(e){Z(e.currentTarget.value)},css:{"&:disabled":{color:P.TV.foregroundDimmer}}})]}):null,(0,u.tZ)("label",{htmlFor:"run-sel",css:[P.l0.mt(4)],"data-cy":"import-config-run-command",children:"Configure the Run Command"}),(0,u.tZ)(_.II,{disabled:p,id:"run-sel",dataCy:"import-config-run-command-input",type:"text",value:g.value,placeholder:"Enter a command to run the program",onChange:function(e){g.setValue(e.currentTarget.value)},css:[{"&:disabled":{color:P.TV.foregroundDimmer,cursor:"auto"},cursor:"text"}]}),h?(0,u.BX)(I.xv,{variant:"small",color:"dimmest",children:["We detected this is a Rails project. You will need",(0,u.BX)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://docs.replit.com/misc/rails-on-replit",children:[" ","additional changes"," "]}),"to your config files to use all of Replits features."]}):null,g.error||!g.value?(0,u.BX)(D.G,{css:[P.l0.color.accentNegativeDefault,P.l0.rowWithGap(4),P.l0.align.center],children:[(0,u.tZ)(B.Z,{size:12}),(0,u.tZ)(D.G,{children:g.error?g.error.message:"Add a run command"})]}):null]}),R?(0,u.BX)(D.G,{css:[{maxWidth:400},P.l0.colWithGap(8)],children:[(0,u.tZ)("label",{htmlFor:"entry-sel",children:"Configure entry point"}),(0,u.tZ)(I.xv,{variant:"small",css:[P.l0.color.foregroundDimmest],children:"The entry point is the file thats run by default and shown first."}),0!==O.length?(0,u.tZ)(ed,(0,l._)((0,a._)({id:"config-selector",onSelect:x.setValue,onInit:x.setValue,options:O},O.length&&!!X&&{initialSelectedOption:O[0]}),{disabled:p})):(0,u.tZ)(_.II,{disabled:p,id:"entry-sel",type:"text",value:x.value,placeholder:"Choose entry point file",onChange:function(e){x.setValue(e.currentTarget.value)},css:[E.gU.filled,{cursor:"text"}]}),x.error?(0,u.BX)(D.G,{css:[{color:"var(--accent-negative-default)"},P.l0.rowWithGap(4),P.l0.align.center],children:[(0,u.tZ)(B.Z,{size:12}),(0,u.tZ)(D.G,{children:x.error.message})]}):null]}):null,(0,u.tZ)(L,{css:[P.l0.color.accentPrimaryStronger,{fontWeight:P.TV.fontWeightMedium}],target:"_blank",href:"https://docs.replit.com/programming-ide/running-github-repositories-replit",rel:"noopener noreferrer",children:"Not sure what to do?"}),(0,u.tZ)(D.G,{css:[P.l0.flex.row,P.l0.pt(16)],children:(0,u.tZ)(S.zx,{colorway:"primary",variant:"outlined",type:"submit",text:p?"Saving...":"Done",disabled:p||!R&&(!!g.error||!g.value),css:[E.gU.filledAndOutlined,{fontWeight:P.TV.fontWeightMedium,color:P.TV.accentPrimaryStronger}],dataCy:"import-config-done"})})]})]}),(0,u.tZ)(T.u,{isOpen:!1,preventClose:!0,onRequestClose:function(){},children:(0,u.tZ)(D.G,{css:[P.l0.borderRadius(16),P.l0.p(32),{backgroundColor:"var(--background-default)"}],children:(0,u.BX)(N.gC,{align:"center",spacing:1,children:[(0,u.tZ)(G.Z,{size:32}),(0,u.BX)(I.xv,{multiline:!1,children:["Upgrading to ",f.ZP.get(v).displayName]})]})})})]})}function ey(){return(0,u.BX)(D.G,{children:[(0,u.tZ)(D.G,{children:".replit looks a lil messed up :/"}),(0,u.tZ)("a",{css:[P.l0.pt(8),{fontSize:P.TV.fontSizeSmall}],target:"_blank",href:"https://docs.replit.com/programming-ide/configuring-repl",children:"View docs"})]})}function eb(){return(0,u.tZ)(D.G,{children:(0,u.BX)("p",{children:["Initializing run configuration",(0,u.tZ)(g,{style:{color:"var(--foreground-default)"}})]})})}var ew=function(e){var t,n,r,l,f=(0,x.Z)(),h=(0,A.Z)(),p=h.fs,m=h.dotReplit,v=(0,c._)((t=(0,a._)({},J,void 0),j.D($,t)),1)[0],g=(n=(0,a._)({},J,{variables:{replId:f}}),z.a(K,n)),w=(null===(l=g.data)||void 0===l?void 0:l.repl.__typename)==="Repl"?g.data.repl:null,S=e.useReadFile(p,U.l),k=(0,c._)((0,d.useState)(!1),2),_=k[0],E=k[1],T=(0,c._)((0,d.useState)(!1),2),R=T[0],I=T[1],D=S&&!S.error?S.content.toString("utf8"):"",G=(0,c._)((0,d.useState)(""),2),B=G[0],P=G[1],N=(0,c._)((0,d.useState)(""),2),L=N[0],O=N[1],M=(0,c._)((0,d.useState)(!1),2),X=M[0],F=M[1],H=(0,c._)((0,d.useState)(i.Unknown),2),V=H[0],q=H[1],Y=(0,c._)((0,d.useState)(!1),2),Q=Y[0],ee=Y[1];(0,d.useEffect)(function(){function e(){return(e=(0,o._)(function(){var e,t,n,r,o,a,l,c,u,d,f,h,v,g,y,w,Z;return(0,s.Jh)(this,function(s){switch(s.label){case 0:return[4,m.getConfig()];case 1:if(t=(e=s.sent()).config,e.error)return[2];return r=(0,W.Cq)(null!==(n=t.run)&&void 0!==n?n:void 0),a=(0,W.Cq)(null!==(o=t.compile)&&void 0!==o?o:void 0),l=!!t.compile,c=!!t.interpreter,[4,p.listFiles()];case 2:if(null!=(u=s.sent()).error||null==u.files||0===u.files.length)return[2];return d=u.files,h=(f=function(e,t,n){if(0===n.length)return{projType:"UNKNOWN",runCommand:null,compileCommand:null};var r,i,o,a,l,c={initRunCommand:e,isCompiled:t,allFiles:n},s=(i=(r=c).initRunCommand,o=r.isCompiled,a=r.allFiles,(l=new Set(a)).has("Makefile")||l.has("makefile")?"MAKE":l.has("package.json")?"NPM":l.has("Cargo.toml")?"CARGO":o?"UNKNOWN":l.has("config/application.rb")?"RAILS":a.some(function(e){return"csproj"===(0,eh.r6)(e)})?"DOTNET":l.has("manage.py")?"DJANGO":ep.test(i)?"REGULAR_RUN":"UNKNOWN");return{projType:s,runCommand:function(e,t){var n=t.initRunCommand,r=t.allFiles;switch(e){case"NPM":return"npm run start";case"REGULAR_RUN":var i,o=null!==(i=r.filter(function(e){return!em.test(e)}).find(function(e){return ep.test(e)}))&&void 0!==i?i:null;if(null==o)return null;return n.replace(ep,o);case"DJANGO":return"python3 manage.py runserver 0.0.0.0:3000";case"RAILS":return"bundle exec rails server --binding=0.0.0.0";case"DOTNET":return"dotnet run";case"CARGO":return"cargo run";default:return null}}(s,c),compileCommand:function(e){switch(e){case"MAKE":return"make";case"CARGO":case"DOTNET":case"NPM":return"";default:return null}}(s)}}(r,l,d)).projType,v=f.runCommand,g=f.compileCommand,w=(y=d.includes(b.E))?null!=r?r:v:null!=v?v:r,Z=null!=g?g:a,E(y),P(w),O(Z),F(h!==i.Unknown&&h!==i.RegularRun),q(h),ee(c),[2]}})})).apply(this,arguments)}D&&function(){e.apply(this,arguments)}()},[D,m,p]),(0,d.useEffect)(function(){(0,C.j)(C.U3.NIX_GH_IMPORT_USED,{action:y.D.ImportEnded,replId:f})},[f]);var et=(0,Z.Z)();(0,d.useEffect)(function(){et(!1)},[et]);var en=(r=(0,o._)(function(e){var t,n,r,i,o,a,l,c,u,d;return(0,s.Jh)(this,function(s){switch(s.label){case 0:var h;return t=e.run,n=e.compile,r=e.entry,i=e.deleteInterp,o=e.onDone,a=e.runChanged,l=e.compileChanged,c=e.projType,(0,C.j)(C.U3.NIX_GH_IMPORT_USED,{action:y.D.ConfigDone,interpUsed:!i,isCompiled:""!==n,runChanged:a,compileChanged:l,projType:c,replId:f}),h=[],i?(h.push((0,ef.xz)("interpreter")),h.push((0,ef.xz)("entrypoint")),h.push((0,ef.KQ)(t)),h.push((0,ef.X6)(t)),n?(h.push((0,ef.D3)(n)),h.push((0,ef.pi)(n))):(h.push((0,ef.xz)("compile")),h.push((0,ef.xz)("deployment/build")))):(h.push((0,ef.xz)("run")),h.push((0,ef.If)(r))),u=h,d=v({variables:{input:{id:f}}}),[4,m.updateDotReplit(u)];case 1:return s.sent(),p.flush().then(function(){p.persist({skipDebounce:!0})}),[4,d];case 2:return s.sent(),o(),[2]}})}),function(e){return r.apply(this,arguments)});return w&&S?(null==S?void 0:S.error)?(0,u.tZ)(ev,{children:(0,u.tZ)(ey,{})}):(0,u.tZ)(ev,{children:(0,u.tZ)(eg,{initialLanguage:"",initialRun:B,initialCompile:L,hasInterpreter:Q,fs:p,hasProcfile:_,isApplyingConfig:R,setIsApplyingConfig:I,onSubmit:en,isFrameworkRecommended:X,projType:V,closeConfigPane:e.closeConfigPane})}):(0,u.tZ)(ev,{children:(0,u.tZ)(eb,{})})}},9626:function(e,t,n){var r=n(74985),i=n(47075),o=n(1415),a=n(74833),l=n(56596),c=n(29287),s=n(50959),u=function(e){var t=e.reason,n=e.children;return(0,r.BX)(l.G,{css:[c.l0.center,c.l0.minWidth(225),c.l0.height(225),c.l0.p(16),c.l0.color.foregroundDefault,c.l0.borderRadius(8),c.l0.backgroundColor.backgroundOverlay,c.l0.zIndex(5e5),{cursor:"not-allowed"}],children:[(0,r.tZ)(i.Z,{height:80}),(0,r.BX)(a.xv,{multiline:!1,variant:"subheadBig",css:[c.l0.mt(32)],dataCy:"import-loading-spinner",children:[t,"..."]}),n]})};t.Z=(0,s.memo)(function(e){var t=e.reason,n=e.children;return(0,r.tZ)(o.h,{children:(0,r.tZ)(l.G,{css:[c.l0.position.fixed,c.l0.flex.row,c.l0.align.center,c.l0.justify.center,c.l0.backgroundColor.backgroundOverlay,{top:0,bottom:0,left:0,right:0,zIndex:5e5,cursor:"not-allowed"}],children:(0,r.tZ)(u,{reason:null!=t?t:"Importing",children:n})})})})},31384:function(e,t,n){n.d(t,{xV:function(){return K},du:function(){return _},av:function(){return q}});var r=n(42516),i=n(41733),o=n(74985),a=n(38003),l=n(62624),c=n(31950),s=n(1415),u=n(38080),d=n(93918),f=n(29287),h=n(50959),p=n(88032),m=n(64461),v=n(19713),g=n(69852),y=n(66626),b=n(66368),w=n(80703),Z=(0,h.createContext)(null);function x(){var e=(0,h.useContext)(Z);if(!e)throw Error("Expected store in context");return e}function C(e){return(0,w.Dv)(e,{store:x()})}function S(e){return(0,b.b)(e,x())}var k=function(e){return(0,w.b9)(e,{store:x()})};function _(e){var t=(0,y._)((0,h.useState)(function(){return(0,v.MT)()}),1)[0];return(0,o.tZ)(Z.Provider,{value:t,children:e.children})}var E=(0,n(91608).$)(["display","visibility","transform","maxHeight","width"]),T=E.cssVars,R=E.styleTokens,I=(0,v.cn)(null),D=(0,v.cn)("default"),G=(0,v.cn)({command:null,offset:{x:0,y:0},visible:!1}),B=(0,g.kv)(G,function(e){return e.offset}),P=(0,g.kv)(G,function(e){return e.command}),A=(0,g.kv)(G,function(e){return e.visible}),N=(0,g.kv)(G,function(e){return e.onKeyDownHandler}),L=(0,g.kv)(I,function(e){var t;return null!==(t=null==e?void 0:e.initial)&&void 0!==t?t:null}),U=(0,v.cn)(function(e){var t=e(B);if(!t)return null;var n=t.y,r=window.innerHeight-n,i=e(L),o=null!==i?i-r:0;return o>0&&(n=Math.max(16,n-Math.min(200,o))),n}),O=(0,v.cn)(function(e){var t=e(B);if(!t)return null;var n=t.x,r=window.innerWidth,i=e(X),o=n+(null!=i?i:F)-r+16;return o>0&&(n=Math.max(16,n-o)),n}),M=(0,v.cn)(function(e){var t=e(O),n=e(U);return null==t||null===n?null:(0,r._)({},T.transform,"translate(".concat(t,"px, ").concat(n,"px)"))}),X=(0,v.cn)(null),F=180,W=(0,v.cn)(function(e){var t=e(X);return(0,r._)({},T.width,(null===t?F:t)+"px")}),H=(0,v.cn)(function(e){var t=e(U);return null===t?null:(0,r._)({},T.maxHeight,"calc(100vh - ".concat(f.TV.space16," - ").concat(t,"px)"))}),V=(0,v.cn)(null,function(e,t){t(I,null),t(X,null),t(z,null),t(G,function(e){return(0,m.Uy)(e,function(e){e.visible=!1,e.command=null})})}),z=(0,v.cn)(null),j=(0,v.cn)(null,function(e,t,n){if(t(D,n.background),n.width&&t(X,n.width),n.target){var r=n.target.getBoundingClientRect(),i={x:r.x,y:r.y+r.height+8};t(z,r),t(G,function(e){return(0,m.Uy)(e,function(e){e.command=n.command,e.offset=i,e.visible=!0,e.onKeyDownHandler=n.onKeyDownHandler})});return}t(G,function(e){return(0,m.Uy)(e,function(e){e.command=n.command,e.offset=n.offset,e.visible=!0,e.onKeyDownHandler=n.onKeyDownHandler})})});function q(){var e=k(j),t=k(V),n=(0,u.nZ)({elevated:!0});return{openContextMenu:(0,h.useCallback)(function(t){e(t.target instanceof HTMLElement?{command:t.command,target:t.target,width:t.width,background:n,onKeyDownHandler:t.onKeyDownHandler}:{command:t.command,offset:t.target,target:null,width:t.width,background:n,onKeyDownHandler:t.onKeyDownHandler})},[e,n]),closeContextMenu:t,onContextMenu:(0,h.useCallback)(function(t,r){var i=r.command,o=r.width,a=r.onKeyDownHandler;t.preventDefault(),e({command:i,offset:{x:t.clientX,y:Math.min(window.innerHeight-64,t.clientY)},target:null,width:o,background:n,onKeyDownHandler:a})},[e,n])}}var Y=(0,d.X)({surface:[f.l0.shadow(3),f.l0.borderRadius(8),f.l0.position.absolute,{top:0,left:0,border:"1px solid",borderColor:f.TV.outlineDefault,maxWidth:"min(500px, calc(100vw - ".concat(f.TV.space16,"))"),minWidth:"min(100px, calc(100vw - ".concat(f.TV.space16,"))"),maxHeight:R.maxHeight,width:R.width,transform:R.transform,visibility:R.visibility,display:R.display}]});function J(){var e=C(z);return e?(0,o.tZ)("div",{style:{position:"fixed",width:e.width,height:e.height,top:e.y,left:e.x}}):null}var K=(0,h.memo)(function(e){var t=e.fontSize,n=k(V),d=C(P),f=C(N),m=S(A),v=(0,h.useRef)(function(){});(0,h.useEffect)(function(){var e=function(e){if(e){var t;null===(t=v.current)||void 0===t||t.call(v);return}};return e(m.current),m.subscribe(e)},[m]);var g=k(I),y=(0,h.useRef)(null);(0,h.useEffect)(function(){var e=function(e){var t;e.target instanceof HTMLElement&&(null===(t=y.current)||void 0===t?void 0:t.contains(e.target))||n()},t=function(){n()},r=function(n){n?(window.addEventListener("blur",t),document.addEventListener("pointerdown",e)):(window.removeEventListener("blur",t),document.removeEventListener("pointerdown",e))},i=m.subscribe(r);return function(){i(),r(!1)}},[m,n]);var b=S(M);(0,c.j)(y,b),(0,c.j)(y,S(H)),(0,c.j)(y,m,function(e){var t;return t={},(0,r._)(t,T.visibility,e?"visible":"hidden"),(0,r._)(t,T.display,e?"flex":"none"),t});var w=S(W);(0,c.j)(y,w);var Z=(0,l.Z)(),x=C(A)&&!Z,_=C(D),E=(0,i._)({},b.current,w.current);return d?(0,o.BX)(s.h,{children:[(0,o.tZ)(J,{}),(0,o.tZ)(p.MT,{autoFocus:x,restoreFocus:!0,contain:!0,children:(0,o.tZ)(u.Tg,{onKeyDown:function(e){"Escape"===e.key&&n()},innerRef:y,css:Y.surface,style:E,background:_,children:(0,o.tZ)(a.X,{iconBreadcrumbs:!0,command:d,onAction:n,onSelect:n,onTotalHeightChange:g,onKeyDown:f,focusRef:v,fontSize:void 0===t?14:t,compact:!0})})})]}):null})},27695:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(66626),i=n(74985),o=n(1498),a=n(49344),l=n(74833),c=n(56596),s=n(32377),u=n(29287),d=n(47001),f=n(17867),h=n(50959),p=n(12285),m=function e(){"use strict";var t=this;(0,p._)(this,e),this.audioStart=0,this.feed=function(e){var n=t.getFormatedValue(e),r=new Float32Array(t.samples.length+n.length);r.set(t.samples,0),r.set(n,t.samples.length),t.samples=r},this.getFormatedValue=function(e){for(var t=new Float32Array(e.length),n=0;n<e.length;n++)t[n]=e[n]/2147483648;return t},this.stop=function(){if(t.bufferSource)try{t.bufferSource.stop()}catch(e){if("InvalidStateError"!==e.name&&"RangeError"!==e.name)throw e}},this.flush=function(e){if(t.audioCtx&&t.samples.length){var n,r,i,o=0,a=t.audioCtx.currentTime;if(0===e)t.startTime=a,t.audioStart=a;else{for(var l=Math.floor((a-t.audioStart)*44100);l>e-32896;)t.audioStart+=.7459410430839002,l-=32896;l>e&&(o=l-e,t.startTime=a),t.startTime=a}t.samples=t.samples.slice(o,t.samples.length);for(var c=t.audioCtx.createBufferSource(),s=t.samples.length/1,u=t.audioCtx.createBuffer(1,s,44100),d=0;d<1;d++)for(i=0,n=u.getChannelData(d),r=d;i<s;i++)n[i]=t.samples[r],r+=1;t.startTime<t.audioCtx.currentTime&&(t.startTime=t.audioCtx.currentTime),c.buffer=u,c.connect(t.gainNode),c.start(t.startTime),t.stop(),t.bufferSource=c,t.startTime+=u.duration,t.samples=new Float32Array}},this.samples=new Float32Array;var n=window.AudioContext||window.webkitAudioContext;this.audioCtx=new n,this.gainNode=this.audioCtx.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioCtx.destination),this.startTime=this.audioCtx.currentTime};function v(e){var t=e.container,n=(0,r._)((0,h.useState)(!1),2),p=n[0],v=n[1],g=(0,r._)((0,h.useState)(!1),2),y=g[0],b=g[1],w=(0,f.Z)(t);(0,h.useEffect)(function(){if(w===d.em.CONNECTED&&!0!==y){var e=setTimeout(function(){b(!0)},1e3);return function(){clearTimeout(e)}}},[w,y]);var Z=(0,h.useRef)(null);(0,h.useEffect)(function(){if(y&&t.getConnectionState()!==d.em.DISCONNECTED)return t.openChannel({name:"audio",service:"audio"},function(e){var t=e.channel,n=null,r=!1;return t.onCommand(function(e){var t;r||(r=!0,Z.current=function(){n=new m,Z.current=null},v(!0)),n&&(null==e?void 0:null===(t=e.audio2)||void 0===t?void 0:t.data)&&(e.audio2.samples||(e.audio2.samples=0),n.feed(Int32Array.from(e.audio2.data)),n.flush(e.audio2.samples))}),function(){v(!1),n&&(n.stop(),n=null),Z.current=null}})},[t,y]);var x=function(){v(!1)};return(0,i.tZ)(a.u,{isOpen:p,onRequestClose:x,children:(0,i.BX)(c.G,{css:[u.l0.colWithGap(24)],children:[(0,i.tZ)(l.h4,{variant:"headerDefault",level:1,children:"We hear audio!"}),(0,i.BX)(c.G,{css:[u.l0.colWithGap(8)],children:[(0,i.tZ)(l.xv,{children:"Hey! It appears that this Repl is playing audio."}),(0,i.tZ)(l.xv,{children:"In order for us to hear the audio youre receiving, please click confirm."})]}),(0,i.BX)(c.G,{css:[u.l0.rowWithGap(12),u.l0.justify.end],children:[(0,i.tZ)(o.zx,{onClick:x,text:"Cancel"}),(0,i.tZ)(o.zx,{colorway:"positive",onClick:function(){v(!1),Z.current&&Z.current()},text:"Confirm",iconLeft:(0,i.tZ)(s.Z,{})})]})]})})}},30249:function(e,t,n){n.d(t,{Z:function(){return y},e:function(){return Z}});var r=n(41733),i=n(98924),o=n(74985),a=n(55534),l=n(1498),c=n(15146),s=n(38080),u=n(74833),d=n(56596),f=n(93918),h=n(9331),p=n(41859),m=n(29287),v=n(19659),g=(0,f.X)({code:[m.l0.font.code,m.l0.flex.grow(1)],surface:[m.l0.borderRadius(8),m.l0.p(8),m.l0.flex.row,m.l0.rowWithGap(8),m.l0.align.center]});function y(e){var t=Z(e.filePath,e.keyName);if(!t)return null;var n=t.import,i=t.access;return(0,o.BX)(d.G,{css:m.l0.colWithGap(8),children:[n?(0,o.tZ)(b,(0,r._)({code:n},e)):null,(0,o.tZ)(b,(0,r._)({code:i},e))]})}function b(e){var t=e.code,n=e.onInsert,r=(0,i._)(e,["code","onInsert"]);return(0,o.BX)(s.Tg,{elevated:r.elevated,css:g.surface,children:[(0,o.tZ)(w,{value:t}),(0,o.tZ)(u.xv,{variant:"small",css:g.code,multiline:!1,children:t}),n?(0,o.tZ)(l.zx,{variant:"outlined",size:"small",onClick:function(){return n(t)},text:"Insert",iconRight:(0,o.tZ)(h.Z,{})}):null]})}function w(e){var t=e.value,n=(0,a.Z)();return(0,o.tZ)(c.hU,{alt:"Copy",tooltipHidden:!0,onClick:function(){navigator.clipboard.writeText(t).then(function(){n.showConfirm("Copied")})},children:(0,o.tZ)(p.Z,{})})}function Z(e,t){if(!e)return null;switch((0,v.r6)(e)){case"js":case"ts":case"jsx":case"tsx":return{import:null,access:"const mySecret = process.env['".concat(t,"']")};case"py":return{import:"import os",access:"my_secret = os.environ['".concat(t,"']")};case"go":return{import:'import "os"',access:'mySecret := os.Getenv("'.concat(t,'")')};case"java":case"scala":return{import:null,access:'System.getenv("'.concat(t,'")')};case"rb":return{import:null,access:'ENV["'.concat(t,'"]')};case"c":case"cpp":return{import:"#include <stdlib.h>",access:'char* mySecret = getenv("'.concat(t,'")')};case"cs":return{import:"using System;",access:'string mySecret = System.Environment.GetEnvironmentVariable("'.concat(t,'");')};case"sh":return{import:null,access:'"$'.concat(t,'"')};default:return null}}},52489:function(e,t,n){n.d(t,{qi:function(){return ea},$M:function(){return es},u_:function(){return eh},BH:function(){return ep},ZP:function(){return eb}});var r=n(27387),i=n(41733),o=n(30509),a=n(66626),l=n(96583),c=n(74985),s=n(31900),u=n(76588),d=n(55534),f=n(50199),h=n(11516),p=n(59868),m=n(1498),v=n(70002),g=n(68514),y=n(15146),b=n(18836),w=n(49344),Z=n(37109),x=n(38080),C=n(74833),S=n(30983),k=n(56596),_=n(93918),E=n(44680),T=n(41859),R=n(52924),I=n(80339),D=n(98859),G=n(88936),B=n(99656),P=n(52682),A=n(29287),N=n(66349),L=n(18107),U=n(30249),O=n(88883),M=n(58091),X=n(50959),F=n(28268),W=n(30084),H=n(9756),V=n(4687),z=n(43182),j=n(20142),q=n(81013),Y=n(37951),J=n(32377),K=n(52686),$=n(15006),Q=n(27308),ee=p.U3.ENV_EDITOR_USED;function et(e){var t,n=e.secrets,i=e.update,o=(0,a._)((0,X.useState)(!1),2),s=o[0],u=o[1],d=(0,a._)((0,X.useState)(!1),2),f=d[0],h=d[1],v=(0,a._)((0,X.useState)(!1),2),g=v[0],y=v[1],b=(0,a._)((0,X.useState)(0),2),Z=b[0],S=b[1],_=0===Z,E=(0,X.useRef)();E.current||(E.current=(0,H.ir)(function(e){var t=en(e.state.doc.toString());return S(t),0!==t?(0,p.j)(ee,{action:"rawEditorUpdatedError"}):(0,p.j)(ee,{action:"rawEditorUpdated"}),[]}));var T=(0,q.Z)(),R=T.ref,I=T.view,D=function(){f||u(!1)},G=function(){y(!1),u(!0),(0,p.j)(ee,{action:"rawEditorOpened"})},B=function(){if(!I)return!1;var e=en(I.state.doc.toString());return S(e),0===e},P=(t=(0,r._)(function(){var e;return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(!I||!B())return[2];h(!0),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i(JSON.parse(I.state.doc.toString()))];case 2:return t.sent(),h(!1),y(!0),setTimeout(function(){D(),setTimeout(function(){y(!1)},500)},500),[3,4];case 3:return e=t.sent(),z.Tb(e),(0,p.j)(ee,{action:"rawEditorUpdatedError"}),S(3),h(!1),[3,4];case 4:return[2]}})}),function(){return t.apply(this,arguments)});return(0,X.useEffect)(function(){if(I){var e=JSON.stringify(n,null,2);"{}"===e&&(e="{\n  \n}"),I.dispatch({changes:{from:0,to:I.state.doc.length,insert:e}}),I.dispatch({selection:{anchor:I.state.doc.length-2}}),I.focus()}},[I,n]),(0,c.BX)(c.HY,{children:[(0,c.tZ)(m.zx,{onClick:function(){return G()},text:"Edit as JSON",iconLeft:(0,c.tZ)(K.Z,{}),size:"small"}),(0,c.tZ)(w.u,{isOpen:s,onRequestClose:function(){return D()},children:(0,c.BX)(k.G,{css:[A.l0.colWithGap(24)],children:[(0,c.tZ)(C.h4,{level:1,variant:"headerDefault",children:"Raw Secrets Editor"}),(0,c.tZ)(C.xv,{children:"Secrets are specified in JSON. Values must be strings."}),(0,c.tZ)(x.Tg,{css:[A.l0.borderRadius(8),A.l0.transition.snappy,A.l0.p(4),{border:"1px solid var(--outline-dimmer)",":hover":{borderColor:"var(--outline-stronger)"}}],elevated:!0,children:(0,c.tZ)(j.ZP,{ref:R,readOnly:f||g,extensions:[E.current,V.$f.of([{key:(0,Q.l2)({cmdOrCtrl:!0,key:"Enter"}),run:function(){return P(),!0},preventDefault:!0,stopPropagation:!0}])],language:"json",hideGutter:!0})}),(0,c.BX)(k.G,{css:[A.l0.rowWithGap(4),A.l0.justify.end],children:[!_&&(0,c.tZ)(Y.E,{icon:(0,c.tZ)($.Z,{}),colorway:"negative",text:function(e){switch(e){case 1:return"Make sure the data is valid JSON.";case 2:return"Make sure that all values are strings.";case 3:return"There was an error saving the secrets.";default:return""}}(Z)}),(0,c.BX)(k.G,{css:[A.l0.rowWithGap(12)],children:[(0,c.tZ)(m.zx,{onClick:D,text:"Cancel"}),(0,c.tZ)(m.zx,{iconLeft:(0,c.tZ)(J.Z,{}),stretch:!0,colorway:g?"positive":"primary",text:g?"Saved!":"Save",disabled:!_||f||g,onClick:function(){return P()}})]})]})]})})]})}function en(e){try{var t=JSON.parse(e);for(var n in t)if("string"!=typeof n||"string"!=typeof t[n])return 2;return 0}catch(e){return 1}}var er=(0,_.X)({addSecretContainer:[A.l0.flex.column,A.l0.colWithGap(8),A.l0.py(8)],secretItemEdit:[A.l0.colWithGap(8)],secretItemEditInputs:[A.l0.rowWithGap(8)],secretItem:[A.l0.flex.row,A.l0.rowWithGap(8),A.l0.align.center],headerStyle:[A.l0.flex.row,A.l0.rowWithGap(8),A.l0.align.center,A.l0.p(8)],accessSecrect:[A.l0.px(8),A.l0.py(16),A.l0.colWithGap(8)],accessSecrectHeader:[A.l0.rowWithGap(8),A.l0.align.center]}),ei={fontFamily:"text-security-disc"};function eo(e){var t=e.onClose,n=e.onAdd,r=e.otherKeys,l=(0,a._)((0,X.useState)(!0),2),s=l[0],u=l[1],d=(0,a._)((0,X.useState)({key:"",value:""}),2),f=d[0],h=d[1],p=f.key.length>0&&!r.includes(f.key);return(0,c.tZ)(c.HY,{children:(0,c.BX)(k.G,{css:er.addSecretContainer,children:[(0,c.BX)(k.G,{css:A.l0.rowWithGap(8),children:[(0,c.BX)(k.G,{css:[A.l0.colWithGap(4),A.l0.width("40%")],children:[(0,c.tZ)(C.xv,{css:[A.l0.pt(2),A.l0.pb(4)],variant:"small",color:"dimmer",multiline:!1,children:"Key"}),(0,c.tZ)(b.II,{value:f.key,onChange:function(e){return h((0,o._)((0,i._)({},f),{key:e.target.value}))},placeholder:"SECRET_KEY",autoComplete:"off"}),r.includes(f.key)?(0,c.BX)(C.xv,{multiline:!1,variant:"small",css:{color:A.TV.accentNegativeDefault},children:['Secret "',f.key,'" already exists']}):null]}),(0,c.BX)(k.G,{css:[A.l0.colWithGap(4),A.l0.flex.growAndShrink(1)],children:[(0,c.BX)(k.G,{css:[A.l0.flex.row,A.l0.rowWithGap(4),A.l0.align.center],children:[(0,c.tZ)(C.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Value"}),(0,c.tZ)(y.hU,{alt:"Toggle Visibility",tooltipHidden:!0,onClick:function(){return u(!s)},children:s?(0,c.tZ)(I.Z,{}):(0,c.tZ)(D.Z,{})})]}),(0,c.tZ)(b.II,{value:f.value,onChange:function(e){return h((0,o._)((0,i._)({},f),{value:e.target.value}))},style:s?ei:void 0,autoComplete:"off",placeholder:"Value"})]})]}),(0,c.BX)(k.G,{css:[A.l0.rowWithGap(8),A.l0.justify.end],children:[(0,c.tZ)(m.zx,{size:"small",text:"Cancel",onClick:function(){return t()}}),(0,c.tZ)(m.zx,{size:"small",text:"Add Secret",colorway:"primary",disabled:!p,onClick:function(){n({key:f.key.trim(),value:f.value}),h({key:"",value:""})}})]})]})})}function ea(e){var t=e.value,n=(0,d.Z)();return(0,c.tZ)(y.hU,{alt:"Copy",tooltipHidden:!0,onClick:function(){navigator.clipboard.writeText(t).then(function(){n.showConfirm("Copied")})},children:(0,c.tZ)(T.Z,{})})}var el=[A.l0.flex.row,A.l0.rowWithGap(8),A.l0.align.center],ec=(0,_.X)({root:[A.l0.height("100%"),A.l0.borderRadius(8),{'& [aria-haspopup="listbox"]':[A.l0.height(32)]}],item:el,itemDanger:[el,{color:A.TV.accentNegativeStronger}]});function es(e){var t=e.onEdit,n=e.onDelete;return(0,c.tZ)(x.Tg,{elevated:!0,css:ec.root,children:(0,c.tZ)(s.Z,{label:"Options",items:[{label:(0,c.BX)(k.G,{css:ec.item,children:[(0,c.tZ)(R.Z,{}),(0,c.tZ)(C.xv,{multiline:!1,children:"Edit"})]}),onClick:t},{label:(0,c.BX)(k.G,{css:ec.itemDanger,children:[(0,c.tZ)(P.Z,{}),(0,c.tZ)(C.xv,{multiline:!1,children:"Delete"})]}),isDescructive:!0,onClick:n}],onItemClick:function(e){var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e)}})})}var eu=[A.l0.p(4),A.l0.rowWithGap(4),A.l0.borderRadius(8)],ed=(0,_.X)({root:[eu,A.l0.width("40%"),A.l0.display.flex,A.l0.overflowX("hidden")],text:[A.l0.flex.growAndShrink(1)]}),ef=(0,_.X)({root:[eu,A.l0.flex.growAndShrink(1)],text:[A.l0.flex.growAndShrink(1),A.l0.truncate,{fontFamily:A.TV.fontFamilyCode}]});function eh(e){var t=e.value;return(0,c.BX)(x.Tg,{elevated:!0,css:ed.root,children:[(0,c.tZ)(ea,{value:t}),(0,c.tZ)(S.u,{tooltip:(0,c.tZ)(C.xv,{children:t}),children:function(e,n){return(0,c.tZ)(C.xv,(0,o._)((0,i._)({ref:n},e),{multiline:!1,css:ed.text,children:t}))}})]})}function ep(e){var t=e.value,n=(0,a._)((0,X.useState)(!1),2),r=n[0],i=n[1];return(0,c.BX)(x.Tg,{elevated:!0,css:ef.root,children:[(0,c.tZ)(ea,{value:t}),(0,c.tZ)(C.xv,{multiline:!1,css:ef.text,children:r?t:"".repeat(12)}),(0,c.tZ)(y.hU,{alt:"Toggle Secret",tooltipHidden:!0,onClick:function(){return i(!r)},children:r?(0,c.tZ)(D.Z,{}):(0,c.tZ)(I.Z,{})})]})}function em(e){var t=(0,a._)((0,X.useState)(""===e.secret.value?{key:e.secret.key,value:""}:null),2),n=t[0],r=t[1],l=(0,a._)((0,X.useState)(!1),2),s=l[0],u=l[1],d=(0,a._)((0,X.useState)(!0),2),f=d[0],h=d[1],p=e.secret;if(n&&!e.readOnly){var v,g=e.onDeleteSecret,Z=e.onUpdateSecret;return(0,c.BX)(c.HY,{children:[(0,c.BX)(k.G,{css:er.secretItemEdit,children:[(0,c.BX)(k.G,{css:er.secretItemEditInputs,children:[(0,c.BX)(k.G,{css:[A.l0.colWithGap(2),A.l0.width("40%")],children:[(0,c.tZ)(C.xv,{multiline:!1,css:[A.l0.pt(2),A.l0.pb(4)],variant:"small",color:"dimmer",children:"Key"}),(0,c.tZ)(k.G,{children:(0,c.tZ)(b.II,{value:null!==(v=null==n?void 0:n.key)&&void 0!==v?v:"",onChange:function(e){return r(function(t){return t?(0,o._)((0,i._)({},t),{key:e.target.value}):t})},placeholder:"SECRET_KEY",autoComplete:"off"})})]}),(0,c.BX)(k.G,{css:[A.l0.flex.growAndShrink(1),A.l0.colWithGap(2)],children:[(0,c.BX)(k.G,{css:[A.l0.flex.row,A.l0.rowWithGap(4),A.l0.align.center],children:[(0,c.tZ)(C.xv,{multiline:!1,css:[A.l0.pt(2),A.l0.pb(4)],variant:"small",color:"dimmer",children:"Value"}),(0,c.tZ)(y.hU,{alt:"Toggle Visibility",tooltipHidden:!0,onClick:function(){return h(!f)},children:f?(0,c.tZ)(I.Z,{}):(0,c.tZ)(D.Z,{})})]}),(0,c.tZ)(k.G,{children:(0,c.tZ)(b.II,{value:n.value,style:f?ei:void 0,onChange:function(e){return r(function(t){return t?(0,o._)((0,i._)({},t),{value:e.target.value}):t})}})})]})]}),(0,c.BX)(k.G,{css:[A.l0.flex.row,A.l0.rowWithGap(8)],children:[(0,c.tZ)(m.zx,{size:"small",text:"Delete",colorway:"negative",onClick:function(){return u(!0)}}),(0,c.tZ)(k.G,{css:A.l0.flex.grow(1)}),(0,c.tZ)(m.zx,{size:"small",text:"Cancel",onClick:function(){return r(null)}}),(0,c.tZ)(m.zx,{size:"small",colorway:"primary",text:""===e.secret.value?"Add Secret":"Update Secret",disabled:!(null==n?void 0:n.key.length),onClick:function(){n&&(Z(p.key,{key:n.key.trim(),value:n.value}),r(null))}})]})]}),(0,c.tZ)(w.u,{isOpen:s,onRequestClose:function(){return u(!1)},children:(0,c.BX)(k.G,{children:[(0,c.BX)(C.xv,{variant:"subheadDefault",multiline:!1,children:["Delete ",p.key,"?"]}),(0,c.tZ)(C.xv,{color:"dimmer",multiline:!1,children:"Are you sure you would like to delete this secret? This cannot be undone."}),(0,c.BX)(k.G,{css:[A.l0.justify.end,A.l0.flex.row,A.l0.rowWithGap(8)],children:[(0,c.tZ)(m.zx,{text:"Cancel",onClick:function(){return u(!1)}}),(0,c.tZ)(m.zx,{text:"Delete",colorway:"negative",onClick:function(){return g(p.key)}})]})]})})]})}return(0,c.BX)(k.G,{css:er.secretItem,children:[(0,c.tZ)(eh,{value:p.key}),(0,c.tZ)(ep,{value:p.value}),e.readOnly?null:(0,c.BX)(c.HY,{children:[(0,c.tZ)(k.G,{children:(0,c.tZ)(es,{onEdit:function(){return r(p)},onDelete:function(){return u(!0)}})}),(0,c.tZ)(w.u,{isOpen:s,onRequestClose:function(){return u(!1)},children:(0,c.BX)(k.G,{css:[A.l0.colWithGap(24)],children:[(0,c.BX)(C.xv,{multiline:!1,variant:"headerDefault",children:["Delete ",p.key,"?"]}),(0,c.tZ)(C.xv,{color:"dimmer",multiline:!1,children:"Are you sure you would like to delete this secret? This cannot be undone."}),(0,c.BX)(k.G,{css:[A.l0.justify.end,A.l0.flex.row,A.l0.rowWithGap(12)],children:[(0,c.tZ)(m.zx,{text:"Cancel",onClick:function(){return u(!1)}}),(0,c.tZ)(m.zx,{iconLeft:(0,c.tZ)(P.Z,{}),text:"Yes, delete secret",colorway:"negative",onClick:function(){return e.onDeleteSecret(p.key)}})]})]})})]})]})}function ev(e){var t=e.secrets,n=e.onUpdateSecret,r=e.onDeleteSecret,i=e.onAddSecret,o=e.showAddSecret,l=e.onClose,s=Object.entries(t).filter(function(e){var t=(0,a._)(e,2);return""===(t[0],t[1])}),u=Object.entries(t).filter(function(e){var t=(0,a._)(e,2);return""!==(t[0],t[1])});return(0,c.BX)(k.G,{css:[A.l0.colWithGap(8),A.l0.px(8),A.l0.py(8)],children:[0!==s.length&&(0,c.BX)(c.HY,{children:[(0,c.BX)(k.G,{css:[A.l0.colWithGap(8)],children:[(0,c.tZ)(C.xv,{variant:"subheadDefault",multiline:!1,children:"Configure missing Secret values"}),(0,c.tZ)(C.xv,{variant:"small",children:"This Repl contains Secrets that might be required. Add values to ensure the code runs as expected."}),(0,c.tZ)(k.G,{css:[A.l0.colWithGap(8)],children:s.map(function(e){var t=(0,a._)(e,2),i=t[0],o=t[1];return(0,c.tZ)(em,{secret:{key:i,value:o},onUpdateSecret:n,onDeleteSecret:r},i)})})]}),(0,c.tZ)(g.R,{})]}),(0,c.BX)(k.G,{css:[A.l0.colWithGap(8)],children:[o?(0,c.tZ)(eo,{onClose:l,onAdd:i,otherKeys:Object.keys(t)}):null,u.map(function(e){var t=(0,a._)(e,2),i=t[0],o=t[1];return(0,c.tZ)(em,{secret:{key:i,value:o},onUpdateSecret:n,onDeleteSecret:r},i)})]})]})}function eg(e){var t=e.secrets,n=e.activeFile,r=(0,a._)((0,X.useState)(Object.keys(t)[0]),2),i=r[0],o=r[1];return(0,O.Z)(n)&&(0,U.e)(n,i)&&0!==Object.keys(t).length?(0,c.BX)(k.G,{css:er.accessSecrect,children:[(0,c.BX)(k.G,{css:er.accessSecrectHeader,children:[(0,c.tZ)(C.xv,{multiline:!1,children:"Access secret"}),(0,c.tZ)(Z.P,{css:A.l0.minWidth(48),items:Object.keys(t).map(function(e){return{title:e}}),selectedItem:{title:i},onChange:function(e){return o(e.title)}})]}),(0,c.tZ)(U.Z,{elevated:!0,keyName:i,filePath:n})]}):null}function ey(e,t){var n=(0,i._)({},e);return"add"===t.type?n[t.key]=t.value:"update"===t.type?(delete n[t.oldKey],n[t.key]=t.value):delete n[t.key],n}function eb(e){var t,n,o,s,y,b=e.readRawEnv,w=e.writeRawEnv,Z=e.getRunState,x=(0,M.R3)(),S=(0,a._)((0,X.useState)(null),2),_=S[0],T=S[1],R=(0,a._)((0,X.useState)(!1),2),I=R[0],D=R[1],P=function(){D(!1)},U=(0,N.Z)();(0,X.useEffect)(function(){(0,p.Cn)(p.U3.ENV_EDITOR_USED,{action:"opened"}),h.Z.set("enveditortour",!0)},[]),(0,X.useEffect)(function(){function e(){return(e=(0,r._)(function(){var e;return(0,l.Jh)(this,function(t){switch(t.label){case 0:return[4,b()];case 1:if((e=t.sent()).error===W.Df.NotFound)return T({}),[2];if(e.error)throw Error("Error getting .env");return T(F.Z.parse(e.content.toString())),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[b,T]);var O=(0,X.useRef)(null),H=(0,X.useRef)([]),V=(t=(0,r._)(function(e){var t,n,r,i;return(0,l.Jh)(this,function(o){switch(o.label){case 0:if(!_)throw Error("trying to write secrets before loading");return T(t=ey(_,e)),H.current.push(e),n=Math.random(),O.current=n,[4,b()];case 1:if(i=o.sent(),O.current!==n)return[2];return i.error?r=t:(r=F.Z.parse(i.content.toString()),H.current.forEach(function(e){r=ey(r,e)}),T(r)),H.current=[],[4,w(F.Z.serialize(r))];case 2:return o.sent(),[2]}})}),function(e){return t.apply(this,arguments)}),z=(0,d.Z)().showConfirm,j=(n=(0,r._)(function(e){return(0,l.Jh)(this,function(t){return(0,p.j)(p.U3.ENV_EDITOR_USED,{action:"created",multiline:e.value.includes("\n")}),V((0,i._)({type:"add"},e)),Z()===L.Ah.RUNNING&&z("Re-run your Repl to use this secret"),P(),[2]})}),function(e){return n.apply(this,arguments)}),q=(o=(0,r._)(function(e,t){return(0,l.Jh)(this,function(n){return(0,p.j)(p.U3.ENV_EDITOR_USED,{action:"updated",multiline:t.value.includes("\n")}),V((0,i._)({type:"update",oldKey:e},t)),[2]})}),function(e,t){return o.apply(this,arguments)}),Y=(s=(0,r._)(function(e){return(0,l.Jh)(this,function(t){return(0,p.j)(p.U3.ENV_EDITOR_USED,{action:"deleted"}),V({type:"delete",key:e}),[2]})}),function(e){return s.apply(this,arguments)}),J=(0,f.Z)(function(){return _&&Object.keys(_).length>0},[_]);return _&&U?(0,c.BX)(k.G,{css:[A.l0.flex.column],children:[(0,c.BX)(k.G,{css:er.headerStyle,children:[(0,c.tZ)(C.xv,{css:A.l0.flex.growAndShrink(1),variant:"subheadDefault",multiline:!1,children:"Secrets"}),(0,c.tZ)(et,{secrets:_,update:(y=(0,r._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:return T(e),[4,w(F.Z.serialize(e))];case 1:return t.sent(),[2]}})}),function(e){return y.apply(this,arguments)})}),(0,c.tZ)(v.Z,{iconLeft:(0,c.tZ)(E.Z,{}),href:"https://docs.replit.com/programming-ide/workspace-features/secrets",size:"small",text:"Docs",target:"_blank"}),(0,c.tZ)(m.zx,{iconLeft:(0,c.tZ)(B.Z,{}),text:"New Secret",colorway:"primary",size:"small",onClick:function(){return D(!0)}})]}),(0,c.tZ)(k.G,{css:[A.l0.px(8)],children:(0,c.tZ)(g.R,{})}),0===Object.keys(_).length&&!1===I?(0,c.BX)(k.G,{css:[A.l0.center,A.l0.flex.shrink(1)],children:[(0,c.tZ)(u.Z,{alt:"A rotating key",src:"/public/images/secrets/secretskey.gif",height:200,width:200,objectFit:"contain"}),(0,c.tZ)(C.xv,{variant:"subheadDefault",multiline:!1,children:"Store sensitive information securely using Secrets."}),(0,c.tZ)(C.xv,{css:[A.l0.textAlign.center,A.l0.mt(8),A.l0.color],multiline:!1,children:(0,c.tZ)("a",{href:"https://docs.replit.com/programming-ide/workspace-features/secrets#how-replit-keeps-your-secrets-safe",target:"_blank",rel:"noopener",children:"How does Replit keep my Secrets safe?"})})]}):null,(0,c.tZ)(ev,{secrets:_,onUpdateSecret:q,onDeleteSecret:Y,onAddSecret:j,showAddSecret:I,onClose:P}),x&&J?(0,c.tZ)(eg,{secrets:_,activeFile:x}):null]}):(0,c.tZ)(k.G,{css:[A.l0.center,A.l0.coverContainer],children:(0,c.tZ)(G.Z,{size:24})})}},12506:function(e,t,n){n.d(t,{VY:function(){return B},HK:function(){return A},h4:function(){return R},Qc:function(){return D},H4:function(){return N},$E:function(){return P},Mp:function(){return L}});var r=n(27387),i=n(96583),o=n(74985),a=n(43312),l=n(50199),c=n(10041),s=n(19659);function u(){return(u=(0,r._)(function(e,t){var n,r,o,a,l;return(0,i.Jh)(this,function(i){return n=(0,s.yC)(e),r=(0,s.UO)(e),o=new Blob([t.toBuffer()],{type:n}),(a=document.createElement("a")).download=r,l=window.URL.createObjectURL(o),a.href=l,a.style.display="none",document.body.appendChild(a),a.click(),setTimeout(function(){document.body.removeChild(a),URL.revokeObjectURL(l)},1e4),[2]})})).apply(this,arguments)}var d=n(24227),f=n(56596),h=n(48728),p=n(41859),m=n(42463),v=n(8017),g=n(52682),y=n(29287),b=n(54916),w=n(47611),Z=n.n(w),x=n(50959),C=n(38806),S=n(3947),k=n(58091),_=n(80259),E=n(66995),T=(0,a.iv)([y.l0.height(28),y.l0.flex.row,y.l0.align.center,{borderBottom:"1px solid ".concat(y.TV.backgroundHigher),opacity:.8,":hover":{opacity:1}}]);function R(e){return"/replEnvironmentDesktop"!==Z().pathname?null:(0,o.tZ)(f.G,{css:T,children:e.children})}var I=(0,a.iv)([y.l0.flex.row,y.l0.align.center,y.l0.flex.growAndShrink(1),y.l0.overflowX("auto"),y.l0.height("100%"),{"&::-webkit-scrollbar":{height:0},scrollbarWidth:"none"}]);function D(e){return(0,o.tZ)(f.G,{css:I,children:e.children})}var G=(0,a.iv)([y.l0.flex.growAndShrink(1),y.l0.position.relative,y.l0.overflow("hidden"),y.l0.borderRadius(0,0,8,8)]);function B(e){return(0,o.tZ)(f.G,{css:[G,e.children&&y.l0.center],children:e.children})}function P(e){return{type:(0,S.Dp)({path:e}),data:{path:e}}}function A(e){var t=e.path,n=e.performPaneOperation,r=(0,x.useCallback)(function(e){n({operation:"replace",pane:P(e)})},[n]);return(0,o.tZ)(R,{children:(0,o.tZ)(D,{children:(0,o.tZ)(E.tr,{path:t,onFileClick:r})})})}function N(e,t){return{match:_.pl,data:{label:"Download",icon:(0,o.tZ)(m.Z,{}),type:"action",run:function(){return(0,r._)(function(){var n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return[4,t.readFile(e)];case 1:if((n=r.sent()).error)return[2,{type:"error",message:"Error downloading file"}];return[4,function(e,t){return u.apply(this,arguments)}(e,n.content)];case 2:return r.sent(),[2]}})})()}}}}function L(e){var t=e.path,n=e.performPaneOperation,a=(0,b.Z)(),s=(0,k._o)();return(0,l.Z)(function(){var e,l;return t?[{match:_.pl,data:{label:"Copy file path",icon:(0,o.tZ)(h.Z,{}),type:"action",run:function(){(0,c.Z)(t)}}},{match:_.pl,data:{label:"Copy link",icon:(0,o.tZ)(v.Z,{}),type:"action",run:function(){var e=(0,C.dr)({path:t});(0,c.Z)(e)}}},(e=a.fs,l=function(e){n({operation:"replace",pane:{type:(0,S.Dp)({path:e}),data:{path:e}}})},{match:_.pl,data:{label:"Duplicate file",icon:(0,o.tZ)(p.Z,{}),type:"action",run:function(){return(0,r._)(function(){var n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,d.Z)(t,e)];case 1:return n=r.sent(),[3,3];case 2:return r.sent(),[2,{type:"error",message:"Error duplicating file"}];case 3:return l(n),[2]}})})()}}}),N(t,a.fs),{match:_.pl,data:{label:"Delete",icon:(0,o.tZ)(g.Z,{color:y.TV.redDefault}),type:"action",run:function(){s(t)}}}]:null},[t,a.fs,n,s])}},30965:function(e,t,n){n.d(t,{Z:function(){return p}});var r=n(74985),i=n(43312),o=n(96179),a=n(2689),l=n(56596),c=n(29287),s=n(50959),u=n(39756),d=n(49932),f=(0,i.iv)([c.l0.justify.center,c.l0.pl(8),{overflow:"hidden",height:"100%",width:"100%","> svg":{opacity:.5,width:250,display:"flex"}}]);function h(e){var t=e.index,n=32*t+8;return(0,r.BX)(r.HY,{children:[(0,r.tZ)("rect",{x:0,y:n,rx:"3",ry:"3",width:16,height:16}),(0,r.tZ)("rect",{x:28,y:n,rx:"3",ry:"3",width:"".concat(100+(t%2!=0?-10*t:10*t)),height:16})]})}function p(e){var t=e.path,n=t===u.Ql,i=n?5:1;(0,s.useEffect)(function(){var e=a.kg.timeStart({isRootPath:n});return function(){e("time to load filetree folder")}},[n,t]);var c="fileTreeLoader-"+Math.random().toString();return(0,r.tZ)(l.G,{css:f,children:(0,r.tZ)(o.Z,{speed:2,backgroundColor:d.TV.backgroundHighest,foregroundColor:d.TV.backgroundHigher,height:32*i,width:250,viewBox:"0 0 250 ".concat(32*i),uniqueKey:c,children:Array(i).fill(null).map(function(e,t){return(0,r.tZ)(h,{index:t},t)})})})}},6033:function(e,t,n){n.d(t,{st:function(){return y}});var r,i,o=n(41733),a=n(30509),l=n(74985);n(43312),n(76588);var c=n(95891),s=n(25425),u=n(93496),d=n(38080),f=n(74833),h=n(56596),p=n(13900),m=n(29287),v=n(21371),g=n(50959);n(13090),(r=i||(i={})).AddFile="AddFile",r.AddFolder="AddFolder",r.UploadFile="UploadFile",r.UploadFolder="UploadFolder",r.DownloadZip="DownloadZip",r.Duplicate="Duplicate",r.ShowHiddenFiles="ShowHiddenFiles",r.HideHiddenFiles="HideHiddenFiles",r.OpenTab="OpenTab",r.OpenPane="OpenPane",r.CopyLink="CopyLink",r.CopyFilePath="CopyFilePath",r.CopyFolderPath="CopyFolderPath",r.OpenShellHere="OpenShellHere",r.Rename="Rename",r.Download="Download",r.Delete="Delete",r.OpenWith="OpenWith";var y={AddFile:{type:"AddFile",text:"Add file"},AddFolder:{type:"AddFolder",text:"Add folder"},UploadFile:{type:"UploadFile",text:"Upload file"},UploadFolder:{type:"UploadFolder",text:"Upload folder"},DownloadZip:{type:"DownloadZip",text:"Download as zip"},Duplicate:{type:"Duplicate",text:"Duplicate file"},ShowHiddenFiles:{type:"ShowHiddenFiles",text:"Show hidden files"},HideHiddenFiles:{type:"HideHiddenFiles",text:"Hide hidden files"},OpenTab:{type:"OpenTab",text:"Open tab"},OpenPane:{type:"OpenPane",text:"Open pane"},CopyFilePath:{type:"CopyFilePath",text:"Copy file path"},CopyFolderPath:{type:"CopyFolderPath",text:"Copy folder path"},CopyLink:{type:"CopyLink",text:"Copy link"},OpenShellHere:{type:"OpenShellHere",text:"Open shell here"},Rename:{type:"Rename",text:"Rename"},Download:{type:"Download",text:"Download"},Delete:{type:"Delete",text:"Delete"}};m.l0.position.relative,m.l0.width(16),m.l0.height(16);var b={self:[m.l0.position.relative,m.l0.width(20),m.l0.height("100%"),m.l0.justify.center,{"& span":{height:"100%"}}],self2:[m.l0.position.relative,m.l0.width(16),m.l0.height("100%"),m.l0.justify.center,m.l0.pr(1)],button:[m.l0.display.flex,m.l0.align.center,m.l0.justify.center,m.l0.py(2),m.l0.top(0),m.l0.width("100%"),m.l0.border({width:0,color:"none"}),m.l0.cursor.pointer,m.l0.color.foregroundDimmest,m.l0.borderRadius(4),u.gU.filled,m.l0.position.relative,{top:-1,right:-1,height:"calc(100% + 2px)",backgroundColor:"transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0}],button2:[m.l0.display.flex,m.l0.align.center,m.l0.py(2),m.l0.width("100%"),m.l0.height("100%"),m.l0.cursor.pointer,m.l0.color.foregroundDimmest,m.l0.focusRing,m.l0.borderRadius(4),{backgroundColor:"transparent",":hover":{color:m.TV.foregroundDefault}}],list:[m.l0.flex.column,m.l0.justify.center,m.l0.borderRadius(8),m.l0.zIndex(1),m.l0.backgroundColor.backgroundDefault,{listStyle:"none"},{":focus":{outline:"none"}}],option:function(e,t){return[m.l0.color.foregroundDefault,m.l0.p(8),m.l0.fontWeight.normal,m.l0.cursor.pointer,{whiteSpace:"nowrap"},t&&[m.l0.backgroundColor.backgroundHigher],e&&[{":hover":{backgroundColor:m.TV.accentNegativeDefault},":hover .option-label":{color:m.TV.white}}]]},optionLabel:function(e){return e?[m.l0.color.accentNegativeStronger]:[]}};function w(e){var t=e.isNegative,n=e.isHighlighted,r=e.children;return(0,l.tZ)(h.G,{css:b.option(t,n),children:(0,l.tZ)(f.xv,{className:"option-label",css:b.optionLabel(t),multiline:!1,children:r})})}var Z=h.K.ul,x=h.K.li,C=h.K.button,S=h.K.div;g.forwardRef(function(e,t){var n=e.isActive,r=e.actions,i=e.onAction,u=e.onOpenChange,k=(0,g.useRef)(!1),_=(0,v.L7)({items:r,onSelectedItemChange:function(e){var t=e.selectedItem;t&&(k.current||i(t),B())}}),E=_.isOpen,T=_.getToggleButtonProps,R=_.getMenuProps,I=_.highlightedIndex,D=_.getItemProps,G=_.openMenu,B=_.reset;(0,g.useImperativeHandle)(t,function(){return{open:G}}),(0,g.useEffect)(function(){u&&u(E)},[E,u]);var P=T(),A=(0,s.P5)({controlName:"flag-ws-density-filetree",logFlagToAnalytics:!1});return(0,l.tZ)(h.G,{css:A?b.self2:b.self,children:(0,l.BX)(c.Z,{elevated:!0,showArrow:!0,isOpen:E,placement:"right-start",padding:0,onClickOutside:B,children:[(0,l.tZ)(d.Tg,{background:n?"default":"root",css:[m.l0.height("100%"),{background:n?m.TV.backgroundHigher:"transparent",borderTopRightRadius:8,borderBottomRightRadius:8}],children:(0,l.tZ)(C,(0,a._)((0,o._)({},P),{css:A?b.button2:b.button,size:20,onClick:function(e){e.stopPropagation(),P.onClick(e)},children:(0,l.tZ)(p.Z,{})}))}),(0,l.tZ)(S,(0,a._)((0,o._)({},R({},{suppressRefError:!0})),{children:E?(0,l.tZ)(Z,{css:b.list,children:r.map(function(e,t){return(0,l.tZ)(x,(0,a._)((0,o._)({"data-cy":"filetree-node-action-".concat(e.type)},D({item:e,index:t,onClick:function(t){k.current=!0,setTimeout(function(){k.current=!1}),i(e),t.stopPropagation()}})),{children:(0,l.tZ)(w,{isHighlighted:I===t,isNegative:e.type===y.Delete.type,children:(0,l.BX)(h.G,{css:[m.l0.rowWithGap(8),m.l0.align.center],children:[(0,l.tZ)(f.xv,{multiline:!1,children:e.text}),"icon"in e?e.icon:null]})})}),e.text)})}):null}))]})})}).displayName="NodeActionsMenu"},85267:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(74985),i=n(1498),o=n(74833),a=n(56596),l=n(39469),c=n(29287),s=n(19659);function u(e){var t,n=e.paths,u=e.onCancel,d=e.onConfirm;return(0,r.BX)(a.G,{css:[c.l0.colWithGap(24)],children:[(0,r.tZ)(o.h4,{level:1,variant:"headerDefault",children:n.length>1?"Overwrite files?":"Overwrite file?"}),(0,r.BX)(o.xv,{children:[(t=(t=n).map(s.UO)).length<2?t[0]:"".concat(t.slice(0,-1).join(", ")," and ").concat(t.slice(-1))," already"," ",n.length>1?"exist":"exists"," in the destination, are you sure you want to overwrite ",n.length>1?"them":"it","? This cannot be undone."]}),(0,r.BX)(a.G,{css:[c.l0.rowWithGap(12),c.l0.justify.end],children:[(0,r.tZ)(i.zx,{onClick:function(){return u()},text:"Cancel"}),(0,r.tZ)(i.zx,{colorway:"negative",onClick:function(){return d()},text:"Yes, overwrite ".concat(n.length>1?"these files":"this file"),iconLeft:(0,r.tZ)(l.Z,{})})]})]})}},22580:function(e,t,n){n.d(t,{J:function(){return m}});var r=n(41733),i=n(74985),o=n(68333),a=n(74833),l=n(56596),c=n(50959),s=n(71253),u=n(66164),d=[n(25462).Z,u.Z,s.Z],f=[],h=function(e){return(0,i.tZ)(l.G,{children:(0,i.tZ)(a.xv,{children:e.children})})},p={h1:h,h2:h,h3:h,h4:h,h5:h,h6:h},m=(0,c.memo)(function(e){var t=e.text,n=e.codeComponent;return(0,i.tZ)(o.ZP,{remarkPlugins:d,rehypePlugins:f,components:(0,r._)({},p,n?{code:n}:void 0),lineBreaks:!0,themed:!0,children:t})})},24796:function(e,t,n){n.d(t,{r:function(){return c}});var r=n(74985),i=n(76588),o=n(74833),a=n(56596),l=n(29287);function c(e){var t=e.textVariant;return(0,r.BX)(o.xv,{variant:t,children:["AI Chat is currently unavailable. For more information, visit"," ",(0,r.tZ)("a",{href:"https://status.replit.com",target:"_blank",children:"our status page."})]})}t.Z=function(e){var t=e.textVariant,n=e.showImage;return(0,r.BX)(a.G,{css:[l.l0.center,l.l0.textAlign.center,l.l0.px(16),l.l0.colWithGap(8),l.l0.flex.growAndShrink(1)],children:[(0,r.tZ)(c,{textVariant:t}),n?(0,r.tZ)(i.Z,{src:"/public/images/ghostwriter/orb.png",css:[{userSelect:"none",mixBlendMode:"screen",filter:"brightness(110%) saturate(1.2)",maskImage:"linear-gradient(".concat(l.TV.backgroundRoot,", transparent)")}],width:200,height:200,objectFit:"contain","aria-hidden":"true",alt:"",draggable:!1}):null]})}},16750:function(e,t,n){n.d(t,{Th:function(){return R},c8:function(){return B}});var r=n(13718),i=n(31417),o=n(27387),a=n(17528),l=n(66626),c=n(63257),s=n(2178),u=n(96583),d=n(43182),f=n(99149),h=n(25425),p=n(25632),m=n(15542),v=n(50782),g=n(3590),y=n(4736),b=n(50959),w=n(11548),Z=n(52297),x=n(26572),C=n(54249),S=n(12639);function k(e,t){var n=Error(e);return d.$e(function(e){e.setTag("ghostwriter-chat",!0),t&&e.setExtras(t),d.Tb(n)}),n}function _(e){return E.apply(this,arguments)}function E(){return(E=(0,o._)(function(e){var t;return(0,u.Jh)(this,function(n){switch(n.label){case 0:return[4,fetch("/ai/auth",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({replId:e})})];case 1:return[4,n.sent().json()];case 2:if(t=n.sent(),!f.B4.Check(S.v,t))throw k("Authentication to chat service failed",{detail:t});return[2,t.token]}})})).apply(this,arguments)}var T=n(42371),R=function(){return(0,p.Gn)("ghostwriterChatServiceEnvironment").preferences.ghostwriterChatServiceEnvironment||T.f.production},I=function(e){if(f.B4.Check(Z.LD,e)||f.B4.Check(Z.t3,e))return e;throw k("Invalid model",{model:e})};function D(e){var t=f.B4.Convert(Z.EI,JSON.parse(e.data));if(!f.B4.Check(Z.EI,t)){var n=f.B4.Errors(Z.EI,t);throw k("Invalid Ghostwriter Chat service message",{errors:(0,c._)(n)})}return t}function G(e,t){return new Date(e.timeCreated).getTime()-new Date(t.timeCreated).getTime()}var B=function(){var e,t=(0,h.P5)({controlName:"flag-notable-exotic-flash-memory"}),n=(0,v.Z)(),f=(0,m.d)(),p=(0,g.jC)(),Z=(0,C.kL)(),S=(0,l._)((0,b.useState)(!1),2),E=S[0],T=S[1],B=(0,l._)((0,b.useState)(0),2),P=B[0],A=B[1],N=R(),L=(0,y.Lv)(),U=(0,l._)((0,b.useState)(function(){return(0,x.Z)()}),2),O=U[0],M=U[1],X=(0,h.P5)({controlName:"flag-blue-water-token"}),F=(0,b.useCallback)((0,o._)(function(){var e,t;return(0,u.Jh)(this,function(r){switch(r.label){case 0:return[4,_(n)];case 1:return e=r.sent(),(t=new URL(N)).searchParams.set("authToken",e),[2,t.toString()]}})}),[N,n]),W=(0,w.ZP)(X?F:N,{shouldReconnect:function(){return P<10},reconnectInterval:function(e){var t=Math.min(1e3*Math.pow(2,Math.max(e,P)),1e4);return t+Math.floor(t/2*Math.random())},reconnectAttempts:10,onClose:function(){M((0,x.Z)()),T(!1)},onReconnectStop:function(){var e=(0,x.Z)();e.resolve(!1),M(e)},onOpen:(0,o._)(function(){return(0,u.Jh)(this,function(e){switch(e.label){case 0:if(X)return J?K():Y(),T(!0),O.resolve(!0),[2];return[4,q()];case 1:return H({authRequest:{authToken:e.sent()}},!1),[2]}})}),onError:function(e){P>=10&&k("Ghostwriter Chat websocket error",{endpoint:N,event:e})},onMessage:function(e){var t=D(e);t.authResponse?$(t):t.sessionCreationResponse?Q(t):t.usageQuota?en(t):t.chatReplSessions?et(t.chatReplSessions):t.invalidMessage&&k("Invalid request",{endpoint:N,replId:n,currentUserId:f,detail:t.invalidMessage.error})}},!t&&null!==f),H=W.sendJsonMessage,V=W.readyState,z=W.getWebSocket,j=V===w.kQ.OPEN&&E;(0,b.useEffect)(function(){if(j){var e,t=z();if(t){var n=function(){},r=!1;return(e=(0,o._)(function(){var e;return(0,u.Jh)(this,function(i){switch(i.label){case 0:if(!(!r&&t.readyState===w.kQ.OPEN))return[3,3];return[4,new Promise(function(e){var r=function(t){D(t).pong&&(n(),e({success:!0}))},i=setTimeout(function(){n(),e({success:!1})},2e3);t.addEventListener("message",r),n=function(){t.removeEventListener("message",r),clearTimeout(i),n=function(){}},H({ping:{}},!1)})];case 1:if(e=i.sent().success,r)return[2];if(!e)return t.close(),[2];return[4,new Promise(function(e){return setTimeout(e,2e4)})];case 2:return i.sent(),[3,0];case 3:return[2]}})}),function(){return e.apply(this,arguments)})(),function(){r=!0,n()}}}},[z,H,j]);var q=(0,b.useCallback)((0,o._)(function(){return(0,u.Jh)(this,function(e){return[2,_(n)]})}),[n]),Y=(0,b.useCallback)((0,o._)(function(){return(0,u.Jh)(this,function(e){if(!f)throw k("Cannot create session without a user id",{endpoint:N,replId:n});return H({sessionCreationRequest:{userId:f,replId:n}}),[2,null]})}),[f,N,n,H]),J=(0,h.P5)({controlName:"flag-gigantic-events"}),K=(0,b.useCallback)(function(){H({getReplSessionsRequest:{replId:n,includeFirstSessionEvents:!0,messagesLimit:1e3}})},[n,H]),$=(0,b.useCallback)(function(e){if(e.authResponse){if(e.authResponse.success)J?K():Y(),T(!0),O.resolve(!0),A(0);else throw A(function(e){return e+1}),k("Authentication failed",{endpoint:N,replId:n,currentUserId:f,detail:e.authResponse.error})}},[Y,f,N,n,A,J,K,O]),Q=(0,b.useCallback)(function(e){if(e.sessionCreationResponse){if(e.sessionCreationResponse.sessionId)p(e.sessionCreationResponse.sessionId);else throw k("Session creation failed",{endpoint:N,replId:n,currentUserId:f,detail:e.sessionCreationResponse.error})}},[f,N,n,p]),ee=(0,h.P5)({controlName:"flag-gigantic-events-display"}),et=(0,b.useCallback)(function(e){if(!e.sessions.length){Y();return}var t=function(e){var t=null,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(!t){t=l;continue}if(l.values.length){if(!t.values.length){t=l;continue}new Date(l.values[l.values.length-1].timeCreated)>new Date(t.values[t.values.length-1].timeCreated)&&(t=l)}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}(e.sessions);if(t){ee&&Z((function(e){try{var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if("this_message_was_retried"===l.parentEventId&&"Human"===l.role){if(t.length>1&&"Assistant"===t[t.length-1].role&&"Human"===t[t.length-2].role)t.pop(),t.pop();else throw Error("The last two messages do not have 'Assistant' and 'Human' roles.")}t.push(l)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}catch(t){return e}})((0,c._)(t.values).sort(G)).map(function(e){var t;return{id:e.id,text:e.content,attribution:"Human"===e.role?"Human":"Assistant",timeCreated:new Date(e.timeCreated),type:e.eventType,codeReference:e.codeReference,intent:null!==(t=e.intent)&&void 0!==t?t:"NONE"}})),p(t.sessionId);return}},[ee,Y,Z,p]),en=(0,b.useCallback)(function(e){var t=e.usageQuota;t&&L({basicModelUsage:t.basicModelUsage,basicModelLimit:t.basicModelLimit,basicModelTTLEnd:1e3*t.basicLimitRefreshTime+Date.now(),advancedModelUsage:t.advancedModelUsage,advancedModelLimit:t.advancedModelLimit,advancedModelTTLEnd:1e3*t.advancedLimitRefreshTime+Date.now()})},[L]),er=(0,b.useCallback)((e=(0,o._)(function(e){var t,r,i,o,l,c,h,p,m,v,g,y,b,w,Z,C,S,_,T,R,G,B,P;return(0,u.Jh)(this,function(A){switch(A.label){case 0:return t=e.body,r=e.options,i=t.sessionId,o=t.message,l=t.chatHistory,c=t.model,h=t.context,p=t.useAdvancedModel,m={chatRequest:{sessionId:i,replId:n,message:o,chatHistory:l,model:I(c),context:h,useAdvancedModel:p}},v=[],g=(0,x.Z)(),y=!1,b=0,w="",Z=null,C=new Promise(function(e,t){Z=setTimeout(function(){t(k("Authentication timed out while sending a message",{endpoint:N,replId:n,currentUserId:f,requestId:w,finished:y,dispatched:b,isAuthed:E,timeout:6e4}))},6e4)}),[4,Promise.race([O.promise,C])];case 1:if(A.sent(),Z&&clearTimeout(Z),!(S=z()))throw k("Websocket is not ready to send messages",{endpoint:N,isAuthed:E,replId:n,currentUserId:f,sessionId:i});return _=function(){y=!0,S.removeEventListener("message",R),S.removeEventListener("close",T)},r.abortSignal.onabort=function(){if(!w)throw k("Cannot abort request",{endpoint:N,replId:n,currentUserId:f});H({abortRequest:{requestId:w}})},T=function(){if(!y){var e=k("Request did not finished - websocket closed",{endpoint:N,replId:n,currentUserId:f,dispatched:b});g.reject(e)}},R=function(e){e.data&&"string"==typeof e.data||g.reject(k("Invalid Event - does not match Message Event",{event:e}));try{var t=D(e);if(t.invalidMessage&&!w)throw Error("Invalid request: ".concat(t.invalidMessage));if(t.chatResponseStart&&!w&&(w=t.chatResponseStart.requestId),t.chatResponseChunk){var r=t.chatResponseChunk;if(r.requestId!==w)return;v.push(r)}if(t.chatResponseEnd){var i,o=t.chatResponseEnd;if(o.requestId!==w)return;o.success||g.reject(Error("Chat request failed: ".concat(null!==(i=o.error)&&void 0!==i?i:"Unknown error"))),_()}if(t.abortResponse){var a=t.abortResponse;if((null==a?void 0:a.requestId)!==w)return;_()}g.resolve()}catch(e){d.$e(function(t){t.setExtra("requestId",w),t.setExtra("finished",y),t.setExtra("dispatched",b),t.setExtra("userId",f),t.setExtra("replId",n),t.setTag("ghostwriter-chat",!0),d.Tb(e)}),g.reject(e)}},S.addEventListener("message",R),S.addEventListener("close",T),H(m),G=setTimeout(function(){var e=k("Message total timed out",{endpoint:N,replId:n,dispatched:b});g.reject(e)},12e4),P=(B=function(){return setTimeout(function(){var e=k("Message chunk timed out",{endpoint:N,replId:n,dispatched:b});g.reject(e)},2e4)})(),[2,(0,s._)(function(){return(0,u.Jh)(this,function(e){switch(e.label){case 0:e.trys.push([0,,8,9]),e.label=1;case 1:if(y)return[3,7];return[4,(0,a._)(g.promise)];case 2:e.sent(),P&&(clearTimeout(P),P=B()),g=(0,x.Z)(),e.label=3;case 3:if(!(b<v.length))return[3,6];return[4,v[b]];case 4:e.sent(),e.label=5;case 5:return b++,[3,3];case 6:return[3,1];case 7:return[3,9];case 8:return _(),clearTimeout(G),clearTimeout(P),[7];case 9:return[2]}})})()]}})}),function(t){return e.apply(this,arguments)}),[f,N,z,E,n,H,O]);return(0,b.useCallback)(function(){return{sendMessage:function(e){var t=e.body,n=e.options;return(0,s._)(function(){var e;return(0,u.Jh)(this,function(o){switch(o.label){case 0:return[4,(0,a._)(er({body:t,options:n}))];case 1:return e=o.sent(),[5,(0,u.XA)((0,r._)((0,i._)(e),a._))];case 2:return o.sent(),[2]}})})()},createNewSession:Y}},[Y,er])}},54249:function(e,t,n){n.d(t,{ZT:function(){return eh},ql:function(){return ev},kL:function(){return el}});var r,i,o,a,l=n(31417),c=n(27387),s=n(41733),u=n(30509),d=n(66626),f=n(96583),h=n(43182),p=n(99149),m=n(25632),v=n(45434),g=n(1228),y=n(87722),b=n(90719),w=n(4736);function Z(){var e,t,n=(0,m.Gn)("chatEngine").preferences,r=(0,y.hG)().data,i=(0,d._)((0,b.Ni)(),1)[0],o=(0,w.ll)(),a=null==r?void 0:null===(e=r.currentUser)||void 0===e?void 0:e.hasOverride,l=null==n?void 0:n.chatEngine,c=null==r?void 0:null===(t=r.currentUser)||void 0===t?void 0:t.defaultEngine;return a&&l&&(0,v.uL)(l)?l:(0,v.uL)(c)?"advanced"===i&&o?v.hf.model:c:g.Fp}var x=n(50782),C=n(2689),S=n(59868),k=n(49275),_=n(78094),E=n(19713),T=(0,E.cn)(null,function(e,t,n){var r=e(k.qw).filter(function(e){var t;return!("explainCode"===e.type&&(null===(t=e.codeReference)||void 0===t?void 0:t.filePath)===n)});t(k.qw,r)});(0,E.cn)(function(e){return e(k.qw).filter(function(e){return"Assistant"===e.attribution&&"explainCode"===e.type})});var R=n(14917),I=n(99952),D=n(52590),G=n(29217),B=n(64461),P=n(65381),A=n(50959),N=n(52297),L=n(85234),U=n.n(L),O=n(23394),M=n(63257),X=n(39426),F=n(1574),W=n(19659),H=n(39756),V=n(37685),z=n(30084),j=n(10009),q=n(82960),Y=n(95683);function J(){return(J=(0,c._)(function(e){var t,n,r,i,o,a,l,c;return(0,f.Jh)(this,function(s){switch(s.label){case 0:if(t=e.files,n=e.fs,r=e.entrypointFile,i=e.hiddenFiles,!(r&&t.length<10))return[3,2];return t.push(r),l=""===(a=(0,W.Il)(r))?H.Ql:a,[4,n.readDir(l)];case 1:if(!("children"in(c=s.sent())))return[2];(o=t).push.apply(o,(0,M._)(c.children.filter(function(e){return e.type===z.Tv.File}).filter(function(e){return!((0,q.Z)(e.filename)||(0,V.lv)(e.filename,i)||!(0,W.Mb)(e.filename))}).map(function(e){return l===H.Ql?e.filename:"".concat(a,"/").concat(e.filename)}).filter(function(e){return!t.includes(e)}).slice(0,1))),s.label=2;case 2:return[2]}})})).apply(this,arguments)}function K(){return(K=(0,c._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,h,p,m,v,g,y,b,w,Z,x,S,k,_,E,T,R,I,D,G,B,P,A,N;return(0,f.Jh)(this,function(f){switch(f.label){case 0:return t=e.recentFiles,n=e.fs,r=e.dotReplit,i=e.maxCharacters,o=e.replLanguage,a=e.filePreferences,[4,r.getConfig()];case 1:return d=(null==(u=f.sent().config)?void 0:u.entrypoint)||X.ZP.getMainFileName(o)||null,h=((null==u?void 0:u.hidden)||[]).map(function(e){return(0,F.Z)(e)}).filter(Boolean),p=[],v=null!==(m=null==a?void 0:null===(s=a.filter(function(e){return"include"===e.preference}))||void 0===s?void 0:s.map(function(e){return e.path}))&&void 0!==m?m:[],(l=p).push.apply(l,(0,M._)(v)),g=v.length,y=t.slice(0,3),(c=p).push.apply(c,(0,M._)(y)),b=y.length,[4,function(e){return J.apply(this,arguments)}({files:p,entrypointFile:d,fs:n,hiddenFiles:h})];case 2:return f.sent(),w=p.length-b-g,C.kg.info("GhostwriterChat got file context",{numRecentFiles:b,numEntrypointFiles:w,maxFiles:10}),x=(Z=function(e){var t=e.files,n=e.hiddenFiles,r=e.filePreferences,i=null!==(p=null==r?void 0:null===(f=r.filter(function(e){return"include"===e.preference}))||void 0===f?void 0:f.map(function(e){return e.path}))&&void 0!==p?p:[],o=null!==(m=null==r?void 0:null===(h=r.filter(function(e){return"exclude"===e.preference}))||void 0===h?void 0:h.map(function(e){return e.path}))&&void 0!==m?m:[],a=0,l=[],c=[],s=!0,u=!1,d=void 0;try{for(var f,h,p,m,v,g=(0,M._)(new Set(t))[Symbol.iterator]();!(s=(v=g.next()).done);s=!0){var y=v.value;if(!(!i.includes(y)&&((0,q.Z)(y)||(0,V.lv)(y,n)||o.includes(y)||!(0,W.Mb)(y)))){if(a>=10){c.push(y);continue}l.push(y),a+=1}}}catch(e){u=!0,d=e}finally{try{s||null==g.return||g.return()}finally{if(u)throw d}}return 0===l.length&&C.kg.info("GhostwriterChat filtered out all files for file context",{numFiles:t.length}),{validFilePaths:l,pathsExceedingMaxFilesLimit:c}}({files:p,hiddenFiles:h,filePreferences:a})).validFilePaths,S=Z.pathsExceedingMaxFilesLimit,[4,Promise.all(x.map(function(e){return n.readFile(e)}))];case 3:for(I=0,k=f.sent(),_=[],E=[],T=S,R=i;I<x.length;I++){if(D=x[I],G=(0,Y.S)(D),(B=k[I]).error){C.kg.info("GhostwriterChat failed to read file",{filePath:D});continue}if((0,j.Z)(B.content.toBuffer())){C.kg.info("GhostwriterChat filtered out binary file",{filePath:D});continue}if(R<=0){T.push(D);continue}A=(P=B.content.toString()).slice(0,R),N=P.length>A.length,R<=0&&T.push(D),N?E.push(D):_.push({filePath:D,language:G,code:A}),R-=A.length}return R<=0?C.kg.info("GhostwriterChat hit character limit for file context",{numFilesIncluded:x.length,filesExcluded:x.length-_.length}):C.kg.info("GhostwriterChat has remaining file context characters",{remainingChars:R}),[2,{fileContext:_,truncatedFiles:E,overflowingFiles:T}]}})})).apply(this,arguments)}var $=n(54916),Q=(0,E.cn)([]),ee=n(58091);(0,E.cn)(!1);var et=(0,E.cn)({}),en=(0,E.cn)(null,function(e,t,n){var r=n.id,i=n.debugInfo,o=e(et);t(et,(0,B.Uy)(o,function(e){e[r]||(e[r]={}),e[r]=(0,s._)({},e[r],i)}))}),er=(0,E.cn)(""),ei=(0,E.cn)(""),eo=(0,E.cn)(!1);(0,E.cn)(!1);var ea=n(3590),el=function(){return(0,_.$X)(k.qw)},ec=(0,E.cn)(new Set),es=(0,E.cn)(null,function(e,t,n){var r=(0,B.Uy)(e(ec),function(e){e.add(n)});t(ec,r)}),eu=(0,E.cn)(null,function(e,t,n){var r=(0,B.Uy)(e(ec),function(e){e.delete(n)});t(ec,r)});function ed(e){return{user:e.attribution,message:e.text}}(0,E.cn)(function(e){return e(ec).size>0});var ef=(0,E.cn)(null,(r=(0,c._)(function(e,t){var n;return(0,f.Jh)(this,function(r){switch(r.label){case 0:if(t(k.mJ),t(k.qw,[]),t(D.r),!(n=e(G.tV)))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.createNewSession()];case 2:return r.sent(),[3,4];case 3:return r.sent(),h.Tb(Error("Unable to initialize Ghostwriter Chat session")),[2];case 4:return[2]}})}),function(e,t){return r.apply(this,arguments)})),eh=function(){return(0,_.$X)(ef)},ep=(0,E.cn)(null,(i=(0,c._)(function(e,t,n){var r,i,o,a,c,d,h,p,m,g,y,b,Z,x,_,E,T,R,I,D,P,A,N,L,U,O,M,X,F,W,H,V,z,j,q,Y,J,K,$,Q;return(0,f.Jh)(this,function(f){switch(f.label){case 0:return r=n.chatInput,i=n.responseId,o=n.timesRegenerated,a=n.modelType,c=n.chatModel,d=n.replId,h=r.chatMessage,p=r.workspaceContext,m=r.messages,g=e(w.yH),y="advanced"===a&&g,b=h.type,Z=h.codeReference,[4,Promise.resolve(p)];case 1:if(_=(x=f.sent()).fileContext,E=x.mostRecentFile,T=e(ea.qy),R=e(G.tV),void 0!==(I=e(eg))&&(h.action=I),(0,S.j)(S.U3.GHOSTWRITER_CHAT_MESSAGE_SENT,{type:b,model:c,isAdvancedModel:y}),D={id:i,type:b,codeReference:Z,text:"",loading:!0,attribution:"Assistant",model:c,useAdvancedModel:y,timesRegenerated:o},(A=null!==(P=n.abortController)&&void 0!==P?P:new AbortController).signal.aborted)return t(k.Mk,{message:(0,B.Uy)(D,function(e){e.loading=!1,e.stopReason="unknown"})}),[2];t(k.WU,{messageId:i,abortController:A}),f.label=2;case 2:var ee,et;if(f.trys.push([2,15,16,17]),t(eo,!0),ee=m,et=function(e){return!e.loading&&!e.error},N=ee.filter(function(e,t){return(!(t<ee.length-1)||!!et(ee[t+1]))&&et(ee[t])&&"feedback"!==ee[t].type}).map(ed),L=performance.now(),U=void 0,!(0,v.uL)(c))throw Error("Invalid chat model");if(!R)throw Error("Invalid Ghostwriter Chat client");O={fileContext:_,mostRecentFile:E},M=R.sendMessage({body:{chatHistory:N,message:h,model:c,useAdvancedModel:y,sessionId:T,context:O},options:{abortSignal:A.signal}}),X=void 0,F="",W=!1,H=!1,f.label=3;case 3:f.trys.push([3,8,9,14]),z=(0,l._)(M),f.label=4;case 4:return[4,z.next()];case 5:if(!(W=!(j=f.sent()).done))return[3,7];if((q=j.value).intentStreamChunk&&(X=q.intentStreamChunk.intent),q.debugStreamChunk&&(t(er,q.debugStreamChunk.fullPrompt),t(en,{id:i,debugInfo:{fullPrompt:q.debugStreamChunk.fullPrompt}}),t(en,{id:i,debugInfo:{workspaceContext:O}})),U||(U=performance.now()-L,C.kg.time("ghostwriter chat time to first stream",U,{replid:d,chatId:T,chatModel:c,messageId:i,isAdvancedModel:y}),t(en,{id:i,debugInfo:{timeToFirstStream:U}})),!q.responseStreamChunk)return[3,6];J=(Y=q.responseStreamChunk).stopReason,Y.stopReason&&(t(ei,Y.stopReason),t(en,{id:i,debugInfo:{stopReason:Y.stopReason}}),J=Y.stopReason),F+=Y.data,D=(0,u._)((0,s._)({},D),{loading:!1,streaming:!J&&!q.responseStreamChunk.isComplete,text:F,intent:X,inferenceId:q.responseId,useAdvancedModel:y,stopReason:J}),t(k.Mk,{message:D}),f.label=6;case 6:return W=!1,[3,4];case 7:return[3,14];case 8:return K=f.sent(),H=!0,V=K,[3,14];case 9:if(f.trys.push([9,,12,13]),!(W&&null!=z.return))return[3,11];return[4,z.return()];case 10:f.sent(),f.label=11;case 11:return[3,13];case 12:if(H)throw V;return[7];case 13:return[7];case 14:return t(eg,void 0),[3,17];case 15:if($=f.sent(),t(eo,!1),"AbortError"===$.name)return t(k.Mk,{message:(0,u._)((0,s._)({},D),{aborted:!0,streaming:!1})}),[2];return t(k.b9,{messageId:i,error:$.message}),C.kg.error("ghostwriter chat client response error",{replid:d,chatId:T,chatModel:c,messageId:i,originalError:null!==(Q=null==$?void 0:$.message)&&void 0!==Q?Q:$}),[3,17];case 16:return t(k.mV,{messageId:i}),[7];case 17:return[2]}})}),function(e,t,n){return i.apply(this,arguments)})),em=(0,E.cn)(null,(o=(0,c._)(function(e,t,n,r){var i,o,a,l,c,s,u,d,h,m,v,g,y,b,w,Z,x;return(0,f.Jh)(this,function(f){switch(f.label){case 0:if(i=r.modelType,o=r.chatModel,a=r.replId,l=r.getContext,c=n.text,s=n.type,u=n.codeReference,d=(null==c?void 0:c.trim())||"",h=e(k.qw),m=U()(),v=U()(),e(G.Rr))return g={id:v,type:s,codeReference:u,loading:!1,text:"AI features are disabled in this team's Repls.",attribution:"Assistant",useAdvancedModel:!1},t(k.OV,{message:g}),[2];return p.B4.Check(N.cZ,n)?t(T,n.codeReference.filePath):p.B4.Check(N.FL,n)?t(R.k8,n.codeReference.filePath):p.B4.Check(N.Mx,n)&&t(I.ev,n.codeReference.filePath),t(es,m),y={id:m,type:s,codeReference:u,text:d,attribution:"Human",timeCreated:new Date},t(k.TC,{message:y}),b={id:v,type:s,codeReference:u,loading:!0,text:"Please wait while I think through your request",attribution:"Assistant",useAdvancedModel:"advanced"===i},t(k.OV,{message:b}),[4,l()];case 1:Z={fileContext:(w=f.sent()).ghostwriterFileContext.fileContext,mostRecentFile:w.mostRecentFile},x={type:s,text:d,codeReference:u},f.label=2;case 2:return f.trys.push([2,,4,5]),[4,t(ep,{chatInput:{chatMessage:x,workspaceContext:Z,messages:h},responseId:v,modelType:i,chatModel:o,replId:a})];case 3:return f.sent(),[3,5];case 4:return t(eu,m),[7];case 5:return[2]}})}),function(e,t,n,r){return o.apply(this,arguments)}));(0,E.cn)(null,(a=(0,c._)(function(e,t,n){var r,i,o,a,l,c,s,u,d,h,p,m,v,g,y,b,w,Z,x,S;return(0,f.Jh)(this,function(f){switch(f.label){case 0:if(r=n.responseId,i=n.action,o=n.modelType,a=n.chatModel,l=n.replId,c=n.getContext,!(d=-1!==(u=(s=e(k.qw)).findIndex(function(e){return e.id===r}))&&"Assistant"===s[u].attribution))return C.kg.error("GW Chat error regenerate assistant message",{responseId:r,isResponseAssistantMessage:d}),[2];if(!(p=(h=s.slice(0,u)).pop()))return C.kg.error("GW Chat error no human message before response message"),[2];return t(es,p.id),m=(s[u].timesRegenerated||0)+1,v="advanced"===o,g=p.text,y=p.type,b=p.codeReference,w={id:r,type:y,codeReference:b,loading:!0,text:"Please wait while I think through your request",attribution:"Assistant",timesRegenerated:m,useAdvancedModel:v},t(k.Mk,{message:w}),[4,c()];case 1:x={fileContext:(Z=f.sent()).ghostwriterFileContext.fileContext,mostRecentFile:Z.mostRecentFile},S={type:y,parentEventId:"this_message_was_retried",text:g,codeReference:b,action:i},t(eg,i),f.label=2;case 2:return f.trys.push([2,,4,5]),[4,t(ep,{chatInput:{chatMessage:S,messages:h,workspaceContext:x},responseId:r,timesRegenerated:m,modelType:o,chatModel:a,replId:l})];case 3:return f.sent(),[3,5];case 4:return t(eu,p.id),[7];case 5:return[2]}})}),function(e,t,n){return a.apply(this,arguments)}));var ev=function(){var e,t,n,r,i,o,a,l,s,u,h,p=(0,_.Uu)(),m=(0,d._)((0,b.Ni)(),1)[0],g=Z(),y=(0,x.Z)(),C=(t=(e=(0,$.Z)()).fs,n=e.dotReplit,r=Z(),i=(0,ee.AA)(),o=(0,O.Z)(),a=(0,d._)((0,b.Ni)(),1)[0],l=(0,w.ll)(),s="advanced"===a&&l?v.hf.model:r,u=(0,_.Dm)(Q),(0,A.useCallback)((0,c._)(function(){var e,r,a,l,c,d;return(0,f.Jh)(this,function(f){switch(f.label){case 0:if(!t||!n)throw Error("Expected fs and dotReplit services");return e=(0,v.yL)(s).fileContextCharacters,r=i(),a=u(),[4,function(e){return K.apply(this,arguments)}({recentFiles:r,fs:t,dotReplit:n,maxCharacters:e,replLanguage:o,filePreferences:a})];case 1:return l=f.sent(),c=r[0],[2,{ghostwriterFileContext:l,mostRecentFile:(null!==(d=null==a?void 0:a.filter(function(e){return"exclude"===e.preference}).map(function(e){return e.path}))&&void 0!==d?d:[]).includes(c)?null:c}]}})}),[t,n,s,i,u,o]));return(0,P.lV)((0,A.useCallback)((h=(0,c._)(function(e,t,n){return(0,f.Jh)(this,function(e){switch(e.label){case 0:return[4,t(em,n.chatMessage,{modelType:m,chatModel:g,replId:y,getContext:C})];case 1:return[2,e.sent()]}})}),function(e,t,n){return h.apply(this,arguments)}),[m,y,g,C]),{store:p})},eg=(0,E.cn)(void 0)},14917:function(e,t,n){n.d(t,{eD:function(){return l},k8:function(){return a}});var r=n(49275),i=n(78094),o=n(19713),a=(0,o.cn)(null,function(e,t,n){var i=e(r.qw).filter(function(e){var t;return!("generateCode"===e.type&&(null===(t=e.codeReference)||void 0===t?void 0:t.filePath)===n)});t(r.qw,i)});(0,o.cn)(function(e){return e(r.qw).filter(function(e){return"Assistant"===e.attribution&&"generateCode"===e.type})});var l=function(){return(0,i.$X)(a)}},99952:function(e,t,n){n.d(t,{Ef:function(){return l},ev:function(){return a}});var r=n(49275),i=n(78094),o=n(19713),a=(0,o.cn)(null,function(e,t,n){var i=e(r.qw).filter(function(e){var t;return!("transformCode"===e.type&&(null===(t=e.codeReference)||void 0===t?void 0:t.filePath)===n)});t(r.qw,i)});(0,o.cn)(function(e){return e(r.qw).filter(function(e){return"Assistant"===e.attribution&&"transformCode"===e.type})});var l=function(){return(0,i.$X)(a)}},52590:function(e,t,n){n.d(t,{g:function(){return c},r:function(){return s}});var r=n(51944),i=n(78094),o=n(19713),a=n(50959),l=(0,o.cn)(new Set),c=function(e){var t=(0,i.c1)(l);(0,a.useEffect)(function(){if(e)return t.add(e),function(){t.delete(e)}},[t,e])},s=(0,o.cn)(null,function(e,t){var n=e(l),i=!0,o=!1,a=void 0;try{for(var c,s=n[Symbol.iterator]();!(i=(c=s.next()).done);i=!0)c.value.dispatch({effects:r.Q.of(null)})}catch(e){o=!0,a=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}})},49275:function(e,t,n){n.d(t,{Mk:function(){return f},OV:function(){return d},TC:function(){return u},WU:function(){return m},b9:function(){return h},mJ:function(){return g},mV:function(){return v},qw:function(){return s}});var r=n(66626),i=n(63257);n(50199),n(78094);var o=n(64461),a=n(19713),l=n(92674),c=n.n(l),s=(0,a.cn)([]),u=(0,a.cn)(null,function(e,t,n){var r=n.message,o=e(s);t(s,(0,i._)(o).concat([r]))}),d=(0,a.cn)(null,function(e,t,n){var r=n.message,o=e(s);t(b,{message:r}),t(s,(0,i._)(o).concat([r]))}),f=(0,a.cn)(null,function(e,t,n){var r=n.message,i=r.id,a=e(s),l=(0,o.Uy)(a,function(e){var t;for(t=e.length-1;t>=0&&a[t].id!==i;t--);t>=0&&(e[t]=r)});t(b,{message:r}),t(s,l)}),h=(0,a.cn)(null,function(e,t,n){var r=n.messageId,i=n.error,a=e(s);t(s,(0,o.Uy)(a,function(e){var t=e.find(function(e){return e.id===r});t&&(t.loading&&(t.text="",t.loading=!1),t.error=i)}))});(0,a.cn)(null,function(e,t,n){var r=n.feedback,o=n.message,a=e(s),l={id:c()(),type:"feedback",text:r,feedbackProvidedMessage:{id:o.id,text:o.text},attribution:"Assistant",useAdvancedModel:o.useAdvancedModel};t(s,(0,i._)(a).concat([l]))});var p=(0,a.cn)(new Map),m=(0,a.cn)(null,function(e,t,n){var r=n.messageId,i=n.abortController,a=(0,o.Uy)(e(p),function(e){e.set(r,i)});t(p,a)}),v=(0,a.cn)(null,function(e,t,n){var r=n.messageId,i=(0,o.Uy)(e(p),function(e){e.delete(r)});t(p,i)});(0,a.cn)(null,function(e,t,n){var r,i=n.messageId;null===(r=e(p).get(i))||void 0===r||r.abort(),t(s,function(e){return(0,o.Uy)(e,function(e){var t=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=o.value;if(l.id===i){l.stopReason="unknown",l.loading=!1;break}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}})}),t(v,{messageId:i})});var g=(0,a.cn)(null,function(e,t){var n=(0,o.Uy)(e(p),function(e){var t=!0,n=!1,i=void 0;try{for(var o,a=e.entries()[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=(0,r._)(o.value,2);(l[0],l[1]).abort()}}catch(e){n=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}e.clear()});t(p,n)}),y=(0,a.cn)(new Set),b=(0,a.cn)(null,function(e,t,n){var r=n.message,i=r.id,a=r.loading,l=(0,o.Uy)(e(y),function(e){a?e.add(i):e.delete(i)});t(y,l)})},3590:function(e,t,n){n.d(t,{jC:function(){return c},qy:function(){return l}});var r=n(78094),i=n(19713),o=n(85234),a=n.n(o),l=(0,i.cn)(a()()),c=function(){return(0,r.$X)(l)}},82017:function(e,t,n){n.d(t,{b:function(){return s}});var r=n(85172),i=n(16750),o=n(50959),a=function(){var e=(0,i.c8)();return(0,o.useCallback)(function(){return e()},[e])},l=n(29217),c=n(78094);function s(){var e=a(),t=(0,l.e)(),n=(0,c.$X)(l.Rr),i=(0,r.v)().isTeamWithAiDisabled;(0,o.useEffect)(function(){n(i)},[n,i]),(0,o.useEffect)(function(){return t(e()),function(){t(null)}},[e,t])}},29217:function(e,t,n){n.d(t,{Rr:function(){return o},e:function(){return l},tV:function(){return a}});var r=n(78094),i=n(19713),o=(0,i.cn)(!1),a=(0,i.cn)(null);function l(){return(0,r.$X)(a)}(0,i.cn)(null),(0,i.cn)(null)},46868:function(e,t,n){n.d(t,{CN:function(){return o},CT:function(){return i},bO:function(){return a}});var r=n(27308),i="git",o={gitCommit:{id:"git.commit",name:"Git: Commit",scope:i,default:(0,r.l2)({cmdOrCtrl:!0,key:"Enter"})}},a=Object.values(o)},31171:function(e,t,n){n.d(t,{Ai:function(){return g},BI:function(){return u},Jp:function(){return d},_H:function(){return f},_Z:function(){return v},bA:function(){return m},ox:function(){return y}});var r=n(41733),i=n(30509),o=n(50199),a=n(80703),l=n(19713),c=n(50959),s=n(59173),u=(0,s.u)(function(){return null}),d=(0,s.u)(function(){return null});function f(e){var t=d.current();(0,c.useEffect)(function(){e!==t&&d.set(function(){return e})},[e,t])}var h=(0,l.cn)(null),p=(0,l.cn)(null,function(e,t,n){var o,a,l=e(h),c=l?(0,r._)({},l,n):(0,r._)({},n),s=null==c?void 0:c.changes,d=null==c?void 0:c.filePath;if(!d||!s)throw Error('"filePath", "changes", "users" required when initializing history state');var f=(a=(o=(0,i._)((0,r._)({},c),{changes:s,filePath:d})).changes.length,(0,r._)({users:{},count:a,version:Math.max(0,a-1),playing:!1,comparing:!1},o));u.set(function(){return f});var p=f.changes.length;if(0===p){t(h,f);return}(null==l?void 0:l.changes)&&f.changes!==l.changes&&(f.count=p,f.version=Math.min(f.version,p-1),f.playing=!1,f.comparing=!1),f.version===p-1&&(f.playing=!1),t(h,f)});function m(){return(0,a.Dv)(h,{store:b()})}function v(){return(0,a.b9)(p,{store:b()})}function g(){return(0,a.b9)((0,o.Z)(function(){return(0,l.cn)(null,function(e,t){t(h,null)})},[]),{store:b()})}var y=(0,c.createContext)(null);function b(){var e=(0,c.useContext)(y);if(!e)throw Error("Expected store in context");return e}},99418:function(e,t,n){n.d(t,{j:function(){return s},p:function(){return u}});var r=n(41733),i=n(59868),o=n(63009),a=n(50959),l=n(67795),c=n(31171);function s(){var e=(0,o.uV)();return(0,a.useCallback)(function(t,n,i){e({origin:"History2: useHistoryBSOD",error:t,tags:{source:"ws-history2",type:n},extras:(0,r._)({state:c.BI.current()},i)})},[e])}function u(e){(0,i.j)(l.U3.HISTORY_USED,{action:e,which:"ws"})}},92854:function(e,t,n){var r=n(74985),i=n(1498),o=n(49344),a=n(74833),l=n(56596),c=n(93918),s=n(39233),u=n(29287),d=n(47611),f=(0,c.X)({root:[u.l0.colWithGap(32)],header:[u.l0.rowWithGap(16),u.l0.align.center],icon:[u.l0.color.orangeStrongest],body:[u.l0.pr(32),u.l0.colWithGap(16)],list:[u.l0.colWithGap(16),u.l0.pl(16)],buttons:[u.l0.rowWithGap(16),u.l0.justify.end]});t.Z=function(e){var t=e.isOpen,n=(0,d.useRouter)();return(0,r.tZ)(o.u,{preventClose:!0,isOpen:t,centered:!0,onRequestClose:function(){},maxWidth:600,children:(0,r.BX)(l.G,{css:f.root,children:[(0,r.BX)(l.G,{css:f.header,children:[(0,r.tZ)(s.Z,{size:24,css:f.icon}),(0,r.tZ)(a.h4,{css:[{width:"fit-content"}],level:2,variant:"headerDefault",children:"You cant join this Repl from Firewall Mode."})]}),(0,r.BX)(l.G,{css:f.body,children:[(0,r.tZ)(a.xv,{children:"This Repl was started by someone not in Firewall Mode. If you would like to join, please do one of the following:"}),(0,r.BX)(l.G,{css:f.list,children:[(0,r.tZ)(a.xv,{multiline:!1,children:" Exit Firewall Mode."}),(0,r.tZ)(a.xv,{multiline:!1,children:" Ask the creator to open this Repl in Firewall Mode."})]})]}),(0,r.BX)(l.G,{css:f.buttons,children:[(0,r.tZ)(i.zx,{text:"Exit Firewall Mode",onClick:function(){window.location.href="https://www.replit.com".concat(n.asPath)}}),(0,r.tZ)(i.zx,{text:"Leave",onClick:function(){n.push("/home","~/")}})]})]})})}},17137:function(e,t,n){n.d(t,{Z:function(){return S}});var r=n(74985),i=n(50782),o=n(1498),a=n(49344),l=n(74833),c=n(30983),s=n(56596),u=n(93918),d=n(75875),f=n(29287),h=n(33988),p=n.n(h),m=n(47611),v=n(41733),g=n(21262),y=n(71440),b=n(58995);function w(){var e=(0,g._)(["\n  query NotAllowedModal {\n    currentUser {\n      id\n      isStaff: hasRole(role: REPLIT_STAFF)\n    }\n  }\n"]);return w=function(){return e},e}var Z={},x=(0,y.Ps)(w()),C=(0,u.X)({root:[f.l0.colWithGap(32)],header:[f.l0.rowWithGap(16),f.l0.align.center],body:[f.l0.colWithGap(16)],staffHelpers:[f.l0.colWithGap(8),f.l0.border({color:"var(--accent-negative-default)",width:1,style:"solid"}),f.l0.overflow("hidden")],buttons:[f.l0.rowWithGap(16),f.l0.justify.end]}),S=function(e){var t,n,u=e.isOpen,h=(0,m.useRouter)(),g=(t=(0,v._)({},Z,{skip:!u}),b.a(x,t)).data,y=(0,i.Z)(),w=null==g?void 0:null===(n=g.currentUser)||void 0===n?void 0:n.isStaff;return(0,r.tZ)(a.u,{preventClose:!0,isOpen:u,centered:!0,onRequestClose:function(){},maxWidth:600,children:(0,r.BX)(s.G,{css:C.root,children:[(0,r.tZ)(s.G,{css:C.header,children:(0,r.tZ)(l.h4,{css:{width:"fit-content"},level:2,variant:"headerDefault",children:"You cant run this Repl right now."})}),(0,r.BX)(s.G,{css:C.body,children:[(0,r.BX)(l.xv,{children:["It may be temporarily unavailable or it may have violated our"," ",(0,r.tZ)(p(),{legacyBehavior:!0,href:"/site/terms",children:"Terms of Service"}),"."]}),(0,r.tZ)(l.xv,{children:"If you are the owner of this Repl and believe you should be able to run it, you can try again later or contact support."}),w?(0,r.BX)(s.G,{css:C.staffHelpers,children:[(0,r.BX)(s.G,{css:f.l0.rowWithGap(8),children:[(0,r.tZ)(c.u,{tooltip:"You are seeing this functionality because you have special permissions.",children:(0,r.tZ)(d.Z,{})}),(0,r.tZ)(l.h4,{level:3,children:"Debug Info"})]}),(0,r.tZ)(s.G,{children:(0,r.BX)(l.xv,{children:["Repl ID ",y," is not allowed to run. This is most likely due to a policy takedown."]})}),(0,r.tZ)(s.G,{children:(0,r.BX)(l.xv,{multiline:!1,children:[(0,r.tZ)(p(),{legacyBehavior:!0,href:"https://app.datadoghq.com/logs?query=%40replid%3A".concat(y),children:"All datadog logs"})," ",""," ",(0,r.tZ)(p(),{legacyBehavior:!0,href:"https://app.datadoghq.com/logs?query=%40replid%3A".concat(y,"+taking+down"),children:"Takedown-specific logs"})]})})]}):null]}),(0,r.BX)(s.G,{css:C.buttons,children:[(0,r.tZ)(o.zx,{text:"Reload",onClick:function(){window.location.reload()}}),(0,r.tZ)(o.zx,{text:"Leave",onClick:function(){h.push("/home","~/")}})]})]})})}},8607:function(e,t,n){var r=n(74985),i=n(56337),o=n(2038),a=n(1498),l=n(49344),c=n(74833),s=n(56596),u=n(93918),d=n(73722),f=n(29287),h=n(47611),p=(0,u.X)({root:[f.l0.colWithGap(16)],header:[f.l0.rowWithGap(16),f.l0.align.center],body:[f.l0.pr(32),f.l0.colWithGap(16)],buttonRow:[f.l0.rowWithGap(16)],button:[f.l0.flex.growAndShrink(1)]});t.Z=function(e){var t=e.isOpen,n=(0,h.useRouter)(),u=(0,o.Vg)(n),f=(0,i.Z)();return(0,r.tZ)(l.u,{preventClose:!0,isOpen:t,centered:!0,onRequestClose:function(){},maxWidth:600,children:(0,r.BX)(s.G,{css:p.root,children:[(0,r.BX)(s.G,{css:p.header,children:[(0,r.tZ)(d.Z,{size:24}),(0,r.tZ)(c.h4,{css:{width:"fit-content"},level:2,variant:"headerDefault",children:"Please Refresh"})]}),(0,r.BX)(s.G,{css:p.body,children:[(0,r.tZ)(c.xv,{children:"Your connection to this Repl has been temporarily interrupted. Usually this is because of a network issue. Please refresh."}),u?(0,r.tZ)(c.xv,{children:"If the issue continues please logout and re-login."}):null]}),(0,r.BX)(s.G,{css:p.buttonRow,children:[u||f?null:(0,r.tZ)(a.zx,{css:p.button,text:"Leave",onClick:function(){n.push("/home","~/")}}),(0,r.tZ)(a.zx,{text:"Refresh",colorway:"primary",css:p.button,onClick:function(){window.location.reload()}})]})]})})}},94655:function(e,t,n){n.d(t,{h:function(){return _},w:function(){return S}});var r=n(41733),i=n(30509),o=n(74985),a=n(50199),l=n(95571),c=n(18836),s=n(50959),u=n(64461),d=n(19713),f=n(66626),h=n(80703);function p(){return(0,f._)((0,s.useState)(function(){return(0,d.MT)()}),1)[0]}var m=(0,s.createContext)(null),v=function(e){return(0,h.b9)(e,{store:function(){var e=(0,s.useContext)(m);if(!e)throw Error("Expected store in context");return e}()})},g=(0,d.cn)(-1),y=(0,d.cn)([]),b=(0,d.cn)(void 0),w=(0,d.cn)(null,function(e,t,n){var r=e(b);switch(r&&(clearTimeout(r.id),r.cb()),n){case"forward":t(g,function(t){return Math.min(e(y).length,t+1)});break;case"backward":t(g,function(e){return Math.max(0,e-1)})}var i=e(y),o=e(g);return o>=i.length?"":i[o]}),Z=(0,d.cn)(null,function(e,t,n){clearTimeout(null===(r=e(b))||void 0===r?void 0:r.id);var r,i=function(){if(n.length>0){var r=!1;t(y,function(t){return(0,u.Uy)(t,function(t){if(n!==t[e(g)])for(r=!0,t.push(n);t.length>20;)t.shift()})}),r&&t(g,e(y).length-1)}t(b,void 0)};t(b,{id:setTimeout(i,2e3),cb:i})});function x(e){var t,n=v(Z),o=(t=v(w),{forward:(0,a.Z)(function(){return function(){return t("forward")}},[t]),backward:(0,a.Z)(function(){return function(){return t("backward")}},[t])}),c=o.forward,u=o.backward,d=(0,s.useRef)(e.value);return(0,s.useEffect)(function(){e.value!==(null==d?void 0:d.current)&&(e.value&&n(e.value),d.current=e.value)},[n,e.value]),(0,i._)((0,r._)({},e),{onKeyDown:(0,a.Z)(function(){return function(t){if(t.shiftKey||(0,l.jh)(t)){null===(r=e.onKeyDown)||void 0===r||r.call(e,t);return}var n,r,i=t.currentTarget,o=!!i.value.match(/\n/);if("ArrowUp"===t.key){if(o&&i.selectionStart&&i.selectionStart>0)return;e.onChange(u()),t.preventDefault(),t.stopPropagation();return}if("ArrowDown"===t.key){if(o&&i.selectionEnd&&i.selectionEnd<i.value.length)return;e.onChange(c()),t.preventDefault(),t.stopPropagation();return}null===(n=e.onKeyDown)||void 0===n||n.call(e,t)}},[u,c,e]),onChange:(0,a.Z)(function(){return function(t){e.onChange(t.target.value)}},[e])})}var C=s.forwardRef(function(e,t){var n=x(e);return(0,o.tZ)(c.B,(0,r._)({ref:t},n))}),S=s.forwardRef(function(e,t){var n=p();return(0,o.tZ)(m.Provider,{value:n,children:(0,o.tZ)(C,(0,r._)({ref:t},e))})}),k=s.forwardRef(function(e,t){var n=x(e);return(0,o.tZ)(c.II,(0,r._)({ref:t},e,n))}),_=s.forwardRef(function(e,t){var n=p();return(0,o.tZ)(m.Provider,{value:n,children:(0,o.tZ)(k,(0,r._)({ref:t},e))})})},80499:function(e,t,n){n.d(t,{m:function(){return v}});var r=n(74985),i=n(43312),o=n(30983),a=n(56596),l=n(93918),c=n(69428),s=n(59811),u=n(88546),d=n(29287),f=n(73858),h=(0,i.F4)("0%,100%{opacity:1;}50%{opacity:0.25;}"),p=(0,l.X)({root:[d.l0.height(20),d.l0.width(20),d.l0.center]}),m=(0,l.X)({root:[p.root],pulseRoot:[p.root,{animation:"".concat(h," 2s infinite")}]});function v(){var e=(0,f.Z)(),t=e.isSaving;return e.isOffline?(0,r.tZ)(o.u,{tooltip:"Reconnecting, changes will be synced when youre online",placement:"right",children:(0,r.tZ)(a.G,{css:m.root,children:(0,r.tZ)(c.Z,{size:16,color:d.TV.redDefault})})}):t?(0,r.tZ)(o.u,{tooltip:"Saving",placement:"right",children:(0,r.tZ)(a.G,{css:m.pulseRoot,children:(0,r.tZ)(s.Z,{size:16,color:d.TV.foregroundDimmest})})}):(0,r.tZ)(o.u,{tooltip:"Saved",placement:"right",children:(0,r.tZ)(a.G,{css:m.root,children:(0,r.tZ)(u.Z,{size:16,color:d.TV.foregroundDimmest})})})}},1854:function(e,t,n){n.d(t,{X2:function(){return d},iA:function(){return h},sg:function(){return f}});var r=n(41733),i=n(30509),o=n(98924),a=n(74985),l=n(56596),c=n(93918),s=n(29287);n(50959);var u=(0,c.X)({table:{},tableRow:[s.l0.rowWithGap(12),s.l0.align.center,s.l0.border({direction:"bottom"}),{"box-sizing":"border-box"}],wrapper:[s.l0.rowWithGap(0)],column:[s.l0.display.flex,s.l0.colWithGap(0),s.l0.justify.center,s.l0.border({direction:"right"}),{":last-child":{borderRight:0}}],header:[s.l0.colWithGap(0),s.l0.justify.center],cell:[s.l0.rowWithGap(0),s.l0.align.center,s.l0.color.foregroundDimmest,s.l0.justify.spaceBetween,s.l0.fontSize("small"),s.l0.px(4),s.l0.py(2)],responsiveWrapper:[],responsiveColumn:[]}),d=function(e){var t=e.children,n=(0,o._)(e,["children"]);return(0,a.tZ)("tr",(0,i._)((0,r._)({css:u.tableRow},n),{children:(0,a.tZ)(l.G,{css:u.wrapper,children:t})}))},f=function(e){var t=e.header,n=e.width,r=e.last,i=e.children,o={};return n&&(o.width=n),r&&(o.marginLeft="auto"),(0,a.tZ)("td",{css:void 0!==t&&t?u.header:u.column,style:o,children:(0,a.tZ)(l.G,{css:u.cell,children:i})})},h=function(e){var t=e.children;return(0,a.tZ)("table",{css:u.table,children:t})}},16278:function(e,t,n){n.d(t,{I:function(){return f}});var r=n(41733),i=n(30509),o=n(66626),a=n(25425),l=n(23896),c=n(66349),s=n(54916),u=n(50959),d={nodejs:["package.json","package-lock.json","yarn.lock","node_modules/"],python:["poetry.lock","pyproject.toml","requirements.txt",".venv/",".local"],ruby:["Gemfile","Gemfile.lock"],java:["pom.xml","target"]};function f(){var e=(0,c.Z)(),t=(0,l.T)(),n=(0,s.Z)(),f=(0,o._)((0,u.useState)(null),2),h=f[0],p=f[1],m=(0,a.P5)({controlName:"flag-system-dependencies-search-unstable"}),v=(0,a.P5)({controlName:"flag-system-dependencies-search-23_05"});return(0,u.useEffect)(function(){var e=n.dotReplit.watch(function(e){var t,n;null===e.error&&p(null!==(n=null===(t=e.config.nix)||void 0===t?void 0:t.channel)&&void 0!==n?n:null)});return function(){e()}},[n]),{configs:(0,u.useMemo)(function(){var n=(null==t?void 0:t.packagers)||[],o=(null==n?void 0:n.map(function(e){var t,n;return(0,i._)((0,r._)({},e),{title:e.language,packagerFiles:(null===(t=e.packagerFiles)||void 0===t?void 0:t.length)?e.packagerFiles:null!==(n=d[e.language])&&void 0!==n?n:[]})}))||[];((null==e?void 0:e.language)==="html"||(null==e?void 0:e.language)==="html_beta")&&o.push({id:"html",title:"html",name:"HTML Packager",language:"html",packageSearch:!0,guessImports:!1,packagerFiles:[]});var a="unstable"===h&&m||"stable-23_05"===h&&v;return o.push({id:"nix",title:"system",name:"System Dependencies",language:"nix",packageSearch:a,guessImports:!1,packagerFiles:["replit.nix"]}),o},[t,e,h,m,v]),loading:!t}}},46801:function(e,t,n){n.d(t,{C:function(){return g}});var r,i,o,a=n(27387),l=n(42516),c=n(96583),s="index.html",u=/^\s*<script src="https:\/\/cdnjs\.cloudflare\.com\/ajax\/libs\/([^/]+)\/([^/]+)\/.+.js"><\/script>$/,d=(r={name:"html",getInstalledPackages:function(e){var t=e.services.fs;return(0,a._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,t.stat(s)];case 1:var n;if(!e.sent().exists)return[2,[]];return[2,new Promise((n=(0,a._)(function(e){var n;return(0,c.Jh)(this,function(r){return n=t.watchTextFile(s,{onReady:function(t){var r=t.initialContent,i=[],o=!0,a=!1,l=void 0;try{for(var c,s=r.split("\n")[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var d=c.value.match(u);d&&i.push({name:d[1],version:d[2]})}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}n(),e(i)},onError:function(){n(),e([])}}),[2]})}),function(e){return n.apply(this,arguments)}))]}})})()},getPackageInfo:function(e){var t=e.name;return(0,a._)(function(){var e,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,fetch("/data/cdnjs/info/".concat(encodeURIComponent(t)),{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"}})];case 1:if(!(e=r.sent()).ok)return[2,void 0];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,e.json()];case 3:if(n=r.sent())return[2,{name:n.name,version:n.version,description:n.description,homepageURL:n.link,sourceCodeURL:n.include}];return[3,5];case 4:return r.sent(),[2,void 0];case 5:return[2]}})})()},search:function(e){var t=e.query;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,fetch("/data/cdnjs/search/".concat(encodeURIComponent(t)),{credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json"}})];case 1:if(!(e=n.sent()).ok)return[2,[]];return[4,e.json()];case 2:return[2,n.sent().map(function(e){return{name:e.name,version:e.version,description:e.description,homepageURL:e.link,sourceCodeURL:e.include}})]}})})()}},(0,l._)(r,"install",function(e){var t=e.pkgs,n=e.services.fs;return(0,a._)(function(){var e,r,i,o,l,u,d;return(0,c.Jh)(this,function(f){switch(f.label){case 0:return[4,n.stat(s)];case 1:if(!f.sent().exists)return[2];e=!0,r=!1,i=void 0,f.label=2;case 2:f.trys.push([2,7,8,9]),o=function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:var r;return e=u.value,[4,new Promise((r=(0,a._)(function(t){var r;return(0,c.Jh)(this,function(i){return r=n.watchTextFile(s,{onReady:function(i){var o=i.initialContent,l=i.writeChange;return(0,a._)(function(){var i,a;return(0,c.Jh)(this,function(c){switch(c.label){case 0:i='<script src="'.concat(e.sourceCodeURL,'"></script>\n'),-1===(a=o.indexOf("<script"))&&(a=o.indexOf("</body>")),-1===a&&(a=o.length),l({from:a,insert:i}),c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,n.flush()];case 2:case 3:return c.sent(),[3,5];case 4:return r(),t(),[7];case 5:return[2]}})})()},onError:function(){r(),t()}}),[2]})}),function(e){return r.apply(this,arguments)}))];case 1:return t.sent(),[2]}})},l=t[Symbol.iterator](),f.label=3;case 3:if(e=(u=l.next()).done)return[3,6];return[5,(0,c.XA)(o())];case 4:f.sent(),f.label=5;case 5:return e=!0,[3,3];case 6:return[3,9];case 7:return d=f.sent(),r=!0,i=d,[3,9];case 8:try{e||null==l.return||l.return()}finally{if(r)throw i}return[7];case 9:return[2]}})})()}),(0,l._)(r,"uninstall",function(e){var t=e.pkgs,n=e.services.fs;return(0,a._)(function(){var e,r,i,o,l,d,f;return(0,c.Jh)(this,function(h){switch(h.label){case 0:return[4,n.stat(s)];case 1:if(!h.sent().exists)return[2];e=!0,r=!1,i=void 0,h.label=2;case 2:h.trys.push([2,7,8,9]),o=function(){var e;return(0,c.Jh)(this,function(t){switch(t.label){case 0:var r;return e=d.value,[4,new Promise((r=(0,a._)(function(t){var r;return(0,c.Jh)(this,function(i){return r=n.watchTextFile(s,{onReady:function(i){var o=i.initialContent,l=i.writeChange;return(0,a._)(function(){var i,a,s,d,f,h,p,m,v;return(0,c.Jh)(this,function(c){switch(c.label){case 0:i=0,a=!0,s=!1,d=void 0;try{for(f=o.split("\n")[Symbol.iterator]();!(a=(h=f.next()).done);a=!0)(m=(p=h.value).match(u))&&(v=m[1],e.name===v&&l({from:i,to:i+p.length+1})),i+=p.length+1}catch(e){s=!0,d=e}finally{try{a||null==f.return||f.return()}finally{if(s)throw d}}c.label=1;case 1:return c.trys.push([1,3,4,5]),[4,n.flush()];case 2:case 3:return c.sent(),[3,5];case 4:return r(),t(),[7];case 5:return[2]}})})()},onError:function(){r(),t()}}),[2]})}),function(e){return r.apply(this,arguments)}))];case 1:return t.sent(),[2]}})},l=t[Symbol.iterator](),h.label=3;case 3:if(e=(d=l.next()).done)return[3,6];return[5,(0,c.XA)(o())];case 4:h.sent(),h.label=5;case 5:return e=!0,[3,3];case 6:return[3,9];case 7:return f=h.sent(),r=!0,i=f,[3,9];case 8:try{e||null==l.return||l.return()}finally{if(r)throw i}return[7];case 9:return[2]}})})()}),r),f=(i={name:"upm",getInstalledPackages:function(e){var t=e.id,n=e.services.packager;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,n.listSpecfile(t)];case 1:if((e=r.sent()).error||null===e.packages)return[2,[]];return[2,e.packages]}})})()}},(0,l._)(i,"getPackageInfo",function(e){var t=e.id,n=e.name,r=e.services.packager;return(0,a._)(function(){return(0,c.Jh)(this,function(e){return[2,r.fetchPackageInfo(n,t)]})})()}),(0,l._)(i,"search",function(e){var t=e.id,n=e.query,r=e.services.packager;return(0,a._)(function(){return(0,c.Jh)(this,function(e){return[2,r.searchPackages(n,t)]})})()}),(0,l._)(i,"install",function(e){var t=e.id,n=e.pkgs,r=e.services.packager;return(0,a._)(function(){return(0,c.Jh)(this,function(e){switch(e.label){case 0:return[4,r.addPackages(n,t)];case 1:if(!e.sent())throw Error("Package install failed");return[2]}})})()}),(0,l._)(i,"uninstall",function(e){var t=e.id,n=e.pkgs,r=e.services.packager;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return e=n.filter(function(e){return e.name}).map(function(e){return e.name}),[4,r.removePackages(e,t)];case 1:if(!i.sent())throw Error("Package uninstall failed");return[2]}})})()}),i),h=n(21262),p=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.map(function(e,t){var r;return e+(null!==(r=n[t])&&void 0!==r?r:"")}).join("")};function m(){var e=(0,h._)(["\n        let\n          pkgs = import <nixpkgs> {};\n          pkg = pkgs."," or {};\n          meta = pkg.meta or {};\n        in {\n          name = pkg.pname or pkg.name or null;\n          version = pkg.version or null;\n          license = meta.license or null;\n          description = meta.description or null;\n          homepage = meta.homepage or null;\n         }\n     "]);return m=function(){return e},e}var v=(o={name:"nix",getInstalledPackages:function(e){var t=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(n){switch(n.label){case 0:return[4,t.listPackages()];case 1:if(null!==(e=n.sent()).error)return[2,[]];return[2,e.packages.filter(function(e){return!!e.name}).map(function(e){return{name:e.name,version:e.version}})]}})})()}},(0,l._)(o,"getPackageInfo",function(e){var t=e.name,n=e.services.container;return(0,a._)(function(){var e,r,i,o,a,l,s,u,d,f;return(0,c.Jh)(this,function(c){switch(c.label){case 0:return e=t.replace(/^pkgs\./,""),[4,n.exec("nix-instantiate","--strict","--json","--eval","--expr",p(m(),e))];case 1:if(null!==(r=c.sent()).error)return[2,{name:t}];return a=null!==(o=(i=JSON.parse(r.output)).license)&&void 0!==o?o:void 0,void 0!==i.license&&"string"!=typeof i.license&&(a=null===(l=i.license)||void 0===l?void 0:l.fullName),[2,{name:t,prettyName:null!==(s=i.name)&&void 0!==s?s:void 0,version:null!==(u=i.version)&&void 0!==u?u:void 0,license:a,description:null!==(d=i.description)&&void 0!==d?d:void 0,homepageURL:null!==(f=i.homepage)&&void 0!==f?f:void 0}]}})})()}),(0,l._)(o,"search",function(e){var t=e.query,n=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return[4,n.searchPackages(t)];case 1:if(null!==(e=r.sent()).error)throw Error("Could not search Nix packages");return[2,e.packages.map(function(e){return{name:"pkgs.".concat(e.name),version:e.version}})]}})})()}),(0,l._)(o,"install",function(e){var t=e.pkgs,n=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return e=t.map(function(e){return e.name}).filter(function(e){return null!=e}),[4,n.addPackages(e)];case 1:return r.sent(),[2]}})})()}),(0,l._)(o,"uninstall",function(e){var t=e.pkgs,n=e.services.nixService;return(0,a._)(function(){var e;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return e=t.map(function(e){return e.name}).filter(function(e){return null!=e}),[4,n.removePackages(e)];case 1:return r.sent(),[2]}})})()}),o);function g(e){switch(e){case"html":return d;case"nix":return v;default:return f}}},71071:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(27387),i=n(96583),o=n(74985),a=n(55534),l=n(59868),c=n(54916),s=n(86763),u=n.n(s),d=n(50959),f=n(16278),h=n(46801),p=n(59072);function m(){var e=(0,c.Z)(),t=(0,p.Hg)(p.NC),n=(0,p.Hg)(p.w$),o=(0,p.XD)(p.w$),s=(0,p.$X)(p.w$),m=(0,p.Hg)(p.vO),v=(0,p.Mi)(),g=(0,p.Zq)(),y=(0,p.OO)(),b=(0,p.np)(),w=(0,a.Z)(),Z=(0,f.I)().configs,x=(0,p.T9)();return(0,d.useEffect)(function(){if(0!==Z.length){var t=[],n=!1,r=!0,i=!1,a=void 0;try{for(var l,c=Z[Symbol.iterator]();!(r=(l=c.next()).done);r=!0)!function(){var r=l.value,i=Promise.resolve(),a=g(r.id),c=u()(function(){var t=g(r.id),a=o();if(t===p.C0.Idle||(null==a?void 0:a.id)!==r.id){var l=(0,h.C)(r.id);i=i.then(function(){if(!n)return l.getInstalledPackages({id:r.id,services:e}).then(function(e){n||(y(r.id,e),v(r.id,p.C0.Idle))})})}},500);if(r.packagerFiles.length>0){var s=!0,d=!1,f=void 0;try{for(var m,b=r.packagerFiles[Symbol.iterator]();!(s=(m=b.next()).done);s=!0)!function(){var n=m.value;if(!n.endsWith("/")){var r=null!==a&&a!==p.C0.Initializing&&a!==p.C0.Uninitialized,i=e.fs.watchFilePath(n,{onChange:function(){if(!r){r=!0;return}c()}});t.push(i)}}()}catch(e){d=!0,f=e}finally{try{s||null==b.return||b.return()}finally{if(d)throw f}}}}()}catch(e){i=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}return function(){n=!0;var e=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)(0,o.value)()}catch(e){r=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(r)throw i}}}}},[Z,e.fs]),(0,d.useEffect)(function(){var t,n=!1;return(t=(0,r._)(function(){var t,r,o,a,l,c;return(0,i.Jh)(this,function(i){t=!0,r=!1,o=void 0;try{for(a=function(){var t=c.value,r=g(t.id);if(r&&r!==p.C0.Uninitialized&&r!==p.C0.Initializing)return"continue";v(t.id,p.C0.Initializing),(0,h.C)(t.id).getInstalledPackages({id:t.id,services:e}).then(function(e){n||(y(t.id,e),v(t.id,p.C0.Idle))})},l=Z[Symbol.iterator]();!(t=(c=l.next()).done);t=!0)a()}catch(e){r=!0,o=e}finally{try{t||null==l.return||l.return()}finally{if(r)throw o}}return[2]})}),function(){return t.apply(this,arguments)})(),function(){n=!0}},[Z]),(0,d.useEffect)(function(){if(null===n&&0!==t.length){var e=t[0];g(e.id)===p.C0.Idle&&b(e)}},[m,n,t]),(0,d.useEffect)(function(){if(null!==n){var t,o=!1;return(t=(0,r._)(function(){var t,r,a,c,u,d,f,m,g,b,Z,C,S,k,_,E,T,R;return(0,i.Jh)(this,function(i){switch(i.label){case 0:switch(t=(0,h.C)(n.id),n.kind){case p.TH.Install:return[3,1];case p.TH.Uninstall:return[3,6]}return[3,11];case 1:v(n.id,p.C0.Installing),r=!0,a=!1,c=void 0;try{for(u=n.pkgs[Symbol.iterator]();!(r=(d=u.next()).done);r=!0)f=d.value,(0,l.j)(l.U3.PACKAGE_MANAGER_USED,{action:"installed",packageId:f.name})}catch(e){a=!0,c=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw c}}i.label=2;case 2:return i.trys.push([2,4,,5]),[4,t.install({id:n.id,pkgs:n.pkgs,services:e})];case 3:return i.sent(),1===n.pkgs.length?w.showNotice("Installed ".concat(null!==(m=n.pkgs[0].name)&&void 0!==m?m:"package")):w.showNotice("Installed ".concat(n.pkgs.length," packages")),[3,5];case 4:return i.sent(),1===n.pkgs.length?w.showError("Failed to install ".concat(null!==(g=n.pkgs[0].name)&&void 0!==g?g:"package")):w.showError("Failed to install ".concat(n.pkgs.length," packages")),x(n.id,n.pkgs),[3,5];case 5:return[3,11];case 6:v(n.id,p.C0.Uninstalling),b=!0,Z=!1,C=void 0;try{for(S=n.pkgs[Symbol.iterator]();!(b=(k=S.next()).done);b=!0)_=k.value,(0,l.j)(l.U3.PACKAGE_MANAGER_USED,{action:"removed",packageId:_.name})}catch(e){Z=!0,C=e}finally{try{b||null==S.return||S.return()}finally{if(Z)throw C}}i.label=7;case 7:return i.trys.push([7,9,,10]),[4,t.uninstall({id:n.id,pkgs:n.pkgs,services:e})];case 8:return i.sent(),1===n.pkgs.length?w.showNotice("Removed ".concat(null!==(E=n.pkgs[0].name)&&void 0!==E?E:"package")):w.showNotice("Removed ".concat(n.pkgs.length," packages")),[3,10];case 9:return i.sent(),1===n.pkgs.length?w.showError("Failed to remove ".concat(null!==(T=n.pkgs[0].name)&&void 0!==T?T:"package")):w.showError("Failed to remove ".concat(n.pkgs.length," packages")),x(n.id,n.pkgs),[3,10];case 10:return[3,11];case 11:if(o)return[2];return[4,t.getInstalledPackages({id:n.id,services:e})];case 12:if(R=i.sent(),o)return[2];return y(n.id,R),v(n.id,p.C0.Idle),s(null),[2]}})}),function(){return t.apply(this,arguments)})(),function(){o=!0}}},[n]),null}function v(e){var t=e.children,n=(0,p.ns)();return(0,o.BX)(p.vN.Provider,{value:n,children:[(0,o.tZ)(m,{}),t]})}},59072:function(e,t,n){n.d(t,{$X:function(){return w},$z:function(){return T},B2:function(){return G},C0:function(){return o},Hg:function(){return x},Mi:function(){return I},NC:function(){return B},OO:function(){return L},T9:function(){return k},TH:function(){return a},Wx:function(){return X},XD:function(){return Z},Zq:function(){return R},cW:function(){return P},jh:function(){return O},np:function(){return W},ns:function(){return g},pN:function(){return S},te:function(){return N},vN:function(){return y},vO:function(){return E},w$:function(){return D},wY:function(){return _},zi:function(){return V}});var r,i,o,a,l=n(42516),c=n(41733),s=n(30509),u=n(66626),d=n(78950),f=n(64461),h=n(19713),p=n(80703),m=n(65381),v=n(50959);function g(){return(0,u._)((0,v.useState)(function(){return(0,h.MT)()}),1)[0]}(0,h.cn)({replId:"",packageManagers:{}}),(r=o||(o={})).Uninitialized="Uninitialized",r.Initializing="Initializing",r.Installing="Installing",r.Uninstalling="Uninstalling",r.Idle="Idle",(i=a||(a={})).Install="Install",i.Uninstall="Uninstall";var y=(0,v.createContext)(null);function b(){var e=(0,v.useContext)(y);if(!e)throw Error("Expected store in context");return e}var w=function(e){return(0,p.b9)(e,{store:b()})};function Z(e){return(0,m.lV)((0,v.useCallback)(function(t){return t(e)},[e]),{store:b()})}function x(e){return(0,p.Dv)(e,{store:b()})}(0,h.cn)(null),(0,h.cn)(null);var C=(0,h.cn)({});function S(e){var t,n=x(C);return e&&null!==(t=n[e])&&void 0!==t?t:[]}function k(){var e=w(C);return function(t,n){e(function(e){return(0,f.Uy)(e,function(e){var r=e[t];if(!r||0===r.length){e[t]=n;return}var i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)!function(){var e=l.value;r.find(function(t){return t.name===e.name})||r.push(e)}()}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}})})}}function _(){var e=w(C);return function(t,n){e(function(e){return(0,f.Uy)(e,function(e){var r=e[t];if(r&&0!==r.length){var i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)!function(){var e=l.value,t=r.findIndex(function(t){return t.name===e.name});-1!==t&&r.splice(t,1)}()}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}})})}}var E=(0,h.cn)({});function T(e){var t,n=x(E);return e&&null!==(t=n[e])&&void 0!==t?t:null}function R(){var e=Z(E);return function(t){var n;return null!==(n=e()[t])&&void 0!==n?n:null}}function I(){var e=w(E);return function(t,n){e(function(e){return(0,s._)((0,c._)({},e),(0,l._)({},t,n))})}}var D=(0,h.cn)(null);function G(){return x(D)}var B=(0,h.cn)([]);function P(){return x(B)}var A=(0,h.cn)({});function N(e){var t,n=x(A);return e&&null!==(t=n[e])&&void 0!==t?t:[]}function L(){var e=w(A);return function(t,n){e(function(e){return(0,s._)((0,c._)({},e),(0,l._)({},t,n))})}}var U=(0,h.cn)(null,function(e,t,n){var r=n.id,i=n.pkg;if(!i.name)throw Error("Package does not have a name.");t(B,function(e){return(0,f.Uy)(e,function(e){if(!e.find(function(e){return e.pkgs.find(function(t){return e.id===r&&t.name===i.name})})){var t=e.find(function(e){return"Install"===e.kind});t?t.pkgs.push(i):e.push({kind:"Install",id:r,pkgs:[i]})}})})});function O(){return w(U)}var M=(0,h.cn)(null,function(e,t,n){var r=n.id,i=n.pkg;if(!i.name)throw Error("Package does not have a name.");t(B,function(e){return(0,f.Uy)(e,function(e){if(!e.find(function(e){return e.pkgs.find(function(t){return e.id===r&&t.name===i.name})})){var t=e.find(function(e){return"Uninstall"===e.kind});t?t.pkgs.push(i):e.push({kind:"Uninstall",id:r,pkgs:[i]})}})})});function X(){return w(M)}(0,h.cn)(null);var F=(0,h.cn)(null,function(e,t,n){var r=(0,d._)(e(B)),i=r[0],o=r.slice(1);n===i&&(t(B,o),t(D,n))});function W(){return w(F)}var H=(0,h.cn)(null,function(e,t,n){t(B,function(e){return(0,f.Uy)(e,function(e){var t=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var l=o.value,c=l.pkgs.findIndex(function(e){return e.name===n});-1!==c&&l.pkgs.splice(c,1)}}catch(e){r=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw i}}})})});function V(){return w(H)}},4662:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(63257),i=n(74985),o=n(56167),a=n.n(o),l=n(58091);function c(e){var t=e.replTitle,n=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r._)(t.filter(Boolean)).concat(["Replit"]).join(" - ")}((0,l.ex)(),t);return(0,i.tZ)(a(),{children:(0,i.tZ)("title",{children:n},"title")})}},71914:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(74985),i=n(76999),o=n.n(i),a=n(96179),l=n(29287),c=n(1518);function s(e){var t=e.preventHighlightBorder,n=(0,c.Z)();return(0,r.BX)("div",{className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])+" loader",children:[(0,r.tZ)("div",{className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])+" wrap",children:(0,r.BX)(a.Z,{backgroundColor:l.TV.backgroundHighest,foregroundColor:l.TV.backgroundHigher,uniqueKey:"editorLoader",children:[(0,r.tZ)("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"70",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"80",y:"0",rx:"3",ry:"3",width:"100",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"190",y:"0",rx:"3",ry:"3",width:"10",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"20",rx:"3",ry:"3",width:"130",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"155",y:"20",rx:"3",ry:"3",width:"130",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"40",rx:"3",ry:"3",width:"90",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"115",y:"40",rx:"3",ry:"3",width:"60",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"185",y:"40",rx:"3",ry:"3",width:"60",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"30",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"80",rx:"3",ry:"3",width:"70",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"95",y:"80",rx:"3",ry:"3",width:"60",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"165",y:"80",rx:"3",ry:"3",width:"30",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"15",y:"100",rx:"3",ry:"3",width:"110",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"135",y:"100",rx:"3",ry:"3",width:"100",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])}),(0,r.tZ)("rect",{x:"0",y:"120",rx:"3",ry:"3",width:"70",height:"10",className:o().dynamic([["abfe52c92a5cedca",[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"]]])})]})}),(0,r.tZ)(o(),{id:"abfe52c92a5cedca",dynamic:[n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)"],children:".loader.__jsx-style-dynamic-selector{z-index:3;height:100%;width:100%;background-color:var(--background-default);overflow:hidden;padding:var(--space-16);-webkit-border-bottom-right-radius:var(--border-radius-4);-moz-border-radius-bottomright:var(--border-radius-4);border-bottom-right-radius:var(--border-radius-4);-webkit-border-bottom-left-radius:var(--border-radius-4);-moz-border-radius-bottomleft:var(--border-radius-4);border-bottom-left-radius:var(--border-radius-4);-webkit-box-shadow:".concat(n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)",";-moz-box-shadow:").concat(n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)",";box-shadow:").concat(n&&!t?"0 3px 0 3px ".concat(n):"var(--shadow-1)","}.wrap.__jsx-style-dynamic-selector{overflow:hidden}.wrap.__jsx-style-dynamic-selector>svg{max-width:640px;min-width:500px;height:auto}@media screen and (min-width:900px){.loader.__jsx-style-dynamic-selector{padding:30px}}")})]})}},32911:function(e,t,n){n.d(t,{ms:function(){return I}});var r=n(66626),i=n(74985),o=n(73157),a=n(1498),l=n(15146),c=n(74833),s=n(56596),u=n(93918),d=n(58719),f=n(58003),h=n(29287),p=n(35375),m=n(50494),v=n(50959),g=n(40028),y=n(3409),b=n(98848),w=n(39390),Z=(0,u.X)({wrapper:[h.l0.py(6),h.l0.flex.row,h.l0.align.center,h.l0.backgroundColor.accentPrimaryDimmest],wrapperWarning:[h.l0.py(6),h.l0.flex.row,h.l0.align.center,h.l0.backgroundColor.orangeDimmest],body:[h.l0.flex.growAndShrink(1)],firstLine:[h.l0.px(6),h.l0.rowWithGap(2),h.l0.align.center,h.l0.flex.wrap,h.l0.maxWidth("100%"),h.l0.overflow("hidden")],secondLine:[h.l0.px(6),h.l0.rowWithGap(2),h.l0.align.center,h.l0.flex.wrap,h.l0.maxWidth("100%"),h.l0.overflow("hidden"),h.l0.color.accentPrimaryStronger],secondLineWarning:[h.l0.px(6),h.l0.rowWithGap(2),h.l0.align.center,h.l0.flex.wrap,h.l0.maxWidth("100%"),h.l0.overflow("hidden"),h.l0.color.orangeStrongest],buttons:[h.l0.flex.row,h.l0.pr(6)],verticalDivider:[h.l0.ml(6),h.l0.mr(6),h.l0.height("1em"),h.l0.width(1),h.l0.backgroundColor.foregroundDefault]});function x(e){var t=e.openNetworkingTool,n=e.onClose,r=e.onDontExposePort,o=e.onDoExposePort,a=e.firstLine,c=e.secondLine,u=e.renderSecondLine,h=e.renderDontExposeButton,p=e.renderDoExposeButton,m=e.isWarning,v=void 0!==m&&m;return(0,i.BX)(s.G,{css:v?Z.wrapperWarning:Z.wrapper,children:[(0,i.BX)(s.G,{css:Z.body,children:[(0,i.tZ)(s.G,{css:Z.firstLine,children:a}),u?(0,i.tZ)(s.G,{css:v?Z.secondLineWarning:Z.secondLine,children:c}):null]}),(0,i.BX)(s.G,{css:Z.buttons,children:[(0,i.tZ)(l.hU,{alt:"Networking tool",onClick:t,children:(0,i.tZ)(f.Z,{})}),void 0!==h&&h?(0,i.tZ)(l.hU,{alt:"Don't expose this port",onClick:r,children:(0,i.tZ)(b.Z,{})}):null,void 0!==p&&p?(0,i.tZ)(l.hU,{alt:"Expose this port",onClick:o,children:(0,i.tZ)(w.Z,{})}):null,(0,i.tZ)(l.hU,{alt:"Close",onClick:n,children:(0,i.tZ)(d.Z,{})})]})]})}function C(e){var t=e.configuration,n=e.openWebview,r=e.openNetworkingTool,o=e.onClose,l=e.onDontExposePort,s=e.renderSecondLine,u=(0,y.O2)(t.externalPort)?"{...}.replit.dev":"{...}.replit.dev:".concat(t.externalPort);return(0,i.tZ)(x,{openNetworkingTool:r,onClose:o,firstLine:(0,i.BX)(i.HY,{children:[(0,i.BX)(c.xv,{children:["Port :",t.localPort," opened on"]}),(0,i.tZ)(a.zx,{variant:"underlined",text:u,onClick:n})]}),secondLine:(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.xv,{children:"You can manage this config in the"}),(0,i.tZ)(a.zx,{variant:"underlined",text:"Networking tool",onClick:r})]}),renderSecondLine:s,renderDontExposeButton:!0,onDontExposePort:l})}function S(e){var t=e.configuration,n=e.openNetworkingTool,r=e.onClose,o=e.renderSecondLine,l=e.onDoExposePort;return(0,i.tZ)(x,{openNetworkingTool:n,onClose:r,firstLine:"Port :".concat(t.localPort," opened, but not exposed to the web."),secondLine:(0,i.tZ)(a.zx,{variant:"underlined",text:"Expose this port?",onClick:n}),renderSecondLine:o,renderDoExposeButton:!0,onDoExposePort:l})}function k(e){var t=e.openNetworkingTool,n=e.configuration,r=e.onClose,o=e.renderSecondLine;return(0,i.tZ)(x,{isWarning:!0,openNetworkingTool:t,onClose:r,firstLine:"Port :".concat(n.localPort," opened, but all available external ports are reserved."),secondLine:(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.xv,{children:"Remove an external port in"}),(0,i.tZ)(a.zx,{variant:"underlined",text:"port configuration",onClick:t}),(0,i.tZ)(c.xv,{children:"to open a new port."})]}),renderSecondLine:o})}function _(e){var t=e.openNetworkingTool,n=e.configuration,r=e.onClose,o=e.renderSecondLine;return(0,i.tZ)(x,{isWarning:!0,openNetworkingTool:t,onClose:r,firstLine:"Port :".concat(n.localPort," opened, but is not configured properly."),secondLine:(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.xv,{children:"You can fix this in the"}),(0,i.tZ)(a.zx,{variant:"underlined",text:"Networking tool",onClick:t})]}),renderSecondLine:o})}function E(e){var t=e.openNetworkingTool,n=e.configuration,r=e.onClose,o=e.renderSecondLine;return(0,i.tZ)(x,{isWarning:!0,openNetworkingTool:t,onClose:r,firstLine:"Port :".concat(n.localPort," opened, but has missing configuration."),secondLine:(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.xv,{children:"You can fix this in the"}),(0,i.tZ)(a.zx,{variant:"underlined",text:"Networking tool",onClick:t})]}),renderSecondLine:o})}function T(e){var t=e.configuration,n=e.openWebview,r=e.openNetworkingTool,o=e.onClose,a=e.onDontExposePort,l=e.onDoExposePort,c=e.renderSecondLine,s=t.type;switch(s){case p.DL.FORWARDED:return(0,i.tZ)(C,{configuration:t,openWebview:n,openNetworkingTool:r,onClose:o,renderSecondLine:c,onDontExposePort:a});case p.DL.INTERNAL_ONLY:return(0,i.tZ)(S,{configuration:t,openNetworkingTool:r,onClose:o,renderSecondLine:c,onDoExposePort:l});case p.DL.NO_MORE_EXTERNAL_PORTS_AVAILABLE:return(0,i.tZ)(k,{configuration:t,openNetworkingTool:r,onClose:o,renderSecondLine:c});case p.DL.MISCONFIGURED:return(0,i.tZ)(_,{configuration:t,openNetworkingTool:r,onClose:o,renderSecondLine:c});case p.DL.CONFIG_MISSING:return(0,i.tZ)(E,{configuration:t,openNetworkingTool:r,onClose:o,renderSecondLine:c});default:(0,g.Z)(s)}}function R(e){var t=e.configurations,n=e.openWebview,r=e.openNetworkingTool,l=e.onClose,u=e.renderSecondLine,d=t.filter(function(e){return e.type===p.DL.FORWARDED}),f=t.filter(function(e){return e.type!==p.DL.FORWARDED});return(0,i.tZ)(x,{isWarning:!1,openNetworkingTool:r,onClose:l,firstLine:(0,i.BX)(i.HY,{children:[d.length>0?(0,i.BX)(i.HY,{children:[(0,i.BX)(c.xv,{children:[d.length," ",(0,o.Z)("port",d.length)," ","opened on"]}),(0,i.tZ)(a.zx,{variant:"underlined",text:"{...}.replit.dev",onClick:n})]}):null,d.length>0&&f.length>0?(0,i.tZ)(s.G,{css:Z.verticalDivider}):null,f.length>0?(0,i.BX)(c.xv,{children:[f.length," ",(0,o.Z)("port",f.length)," ","did not open"]}):null]}),secondLine:(0,i.BX)(i.HY,{children:[(0,i.tZ)(c.xv,{children:"You can manage this config in the"}),(0,i.tZ)(a.zx,{variant:"underlined",text:"Networking tool",onClick:r})]}),renderSecondLine:u})}function I(e){var t=e.configurations,n=e.openWebview,o=e.openNetworkingTool,a=e.onClose,l=e.onDontExposePort,c=e.onDoExposePort,s=(0,m.e)("port-nudges"),u=(0,r._)((0,v.useState)(!1),2),d=u[0],f=u[1],h=!s.isDone,p=(0,r._)((0,v.useState)(!0),2),g=p[0],y=p[1];function b(){y(!1),null==a||a()}return((0,v.useEffect)(function(){0===t.length&&y(!0)},[t]),(0,v.useEffect)(function(){if(!s.isDone){if(t.length>0&&!d){f(!0);return}0===t.length&&d&&s.setAsDone()}},[t,s,d]),g&&0!==t.length)?1===t.length?(0,i.tZ)(T,{configuration:t[0],openNetworkingTool:o,openWebview:n,renderSecondLine:h,onClose:b,onDontExposePort:l,onDoExposePort:c}):(0,i.tZ)(R,{configurations:t,openNetworkingTool:o,openWebview:n,renderSecondLine:h,onClose:b}):null}},81662:function(e,t,n){n.d(t,{Ly:function(){return v},ZP:function(){return y},qm:function(){return w}});var r=n(66626),i=n(63257),o=n(74985),a=n(25632),l=n(68514),c=n(18836),s=n(37109),u=n(4070),d=n(74833),f=n(93918),h=n(29287),p=n(18330),m=n(50959),v=[{value:"spaces",title:"spaces"},{value:"tabs",title:"tabs"}],g=(0,f.X)({sizeInput:[h.l0.py(6),h.l0.flex.growAndShrink(0),{border:"none"}]});function y(){var e=(0,a.Gn)("indentDetection","indentFormatPastes","indentIsSpaces","indentSize"),t=e.preferences,n=e.update;return(0,o.BX)(o.HY,{children:[(0,o.tZ)(p.$,{id:"indentDetection",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(d.xv,{multiline:!1,children:"Indentation detection"}),(0,o.tZ)(d.xv,{variant:"small",color:"dimmest",children:"Automatically detect indentation settings when opening a file."})]}),children:(0,o.tZ)(u.r,{"aria-label":"Indentation detection",isSelected:t.indentDetection,onChange:function(e){n({indentDetection:e})}})}),(0,o.tZ)(l.R,{}),(0,o.tZ)(p.$,{id:"indentFormatPastes",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(d.xv,{multiline:!1,children:"Format pasted text indentation"}),(0,o.tZ)(d.xv,{variant:"small",color:"dimmest",children:"Automatically format the indentation of pasted text."})]}),children:(0,o.tZ)(u.r,{"aria-label":"Format pasted text indentation",isSelected:t.indentFormatPastes,onChange:function(e){n({indentFormatPastes:e})}})}),(0,o.tZ)(l.R,{}),(0,o.tZ)(p.$,{id:"indentType",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(d.xv,{multiline:!1,children:"Indentation character"}),(0,o.tZ)(d.xv,{variant:"small",color:"dimmest",children:"The character used for indenting lines."})]}),children:(0,o.tZ)(s.P,{initialSelectedItem:v.find(function(e){return e.value===(t.indentIsSpaces?"spaces":"tabs")}),onChange:function(e){n({indentIsSpaces:(null==e?void 0:e.value)==="spaces"})},items:(0,i._)(v)})}),(0,o.tZ)(l.R,{}),(0,o.tZ)(p.$,{id:"indentSize",title:(0,o.BX)(o.HY,{children:[(0,o.tZ)(d.xv,{multiline:!1,children:"Indentation size"}),(0,o.tZ)(d.xv,{variant:"small",color:"dimmest",children:"The number of columns taken up by an indentation level."})]}),children:(0,o.tZ)(w,{css:g.sizeInput,size:t.indentSize,onChange:function(e){n({indentSize:e})}})})]})}function b(e){return null==e?2:("string"==typeof e&&(e=parseInt(e,10)),isNaN(e))?2:(Number.isInteger(e)||(e=Math.round(e)),e<1)?1:e>16?16:e}function w(e){var t=e.size,n=e.onChange,i=e.className,a=(0,r._)((0,m.useState)(null),2),l=a[0],s=a[1],u=null!==l?l:t.toString(),d=""===u?"6ch":u.length+5.5+"ch";return(0,o.tZ)(c.II,{type:"number",style:{width:d},className:i,min:1,max:16,value:u,onBlur:function(){return s(null)},onChange:function(e){var t=e.target.value.trim(),r=e.target.valueAsNumber;if(""===t||isNaN(r)){s(t);return}e.target.validity.valid?(s(null),n(b(r))):(s(t),""===t||isNaN(parseInt(t,10))||n(b(t)))}})}},18330:function(e,t,n){n.d(t,{$:function(){return s}});var r=n(74985),i=n(74833),o=n(56596),a=n(29287),l=n(10981),c=n(50959);function s(e){var t=e.id,n=e.title,s=e.children,u=(0,l.U)()(t);return(0,r.BX)(o.G,{css:[a.l0.rowWithGap(8),a.l0.justify.spaceBetween,a.l0.align.center],children:[(0,r.tZ)(o.G,{css:a.l0.flex.growAndShrink(1),tag:"label",htmlFor:u,children:"string"==typeof n?(0,r.tZ)(i.xv,{multiline:!1,children:n}):n}),c.cloneElement(s,{id:u})]})}},80819:function(e,t,n){n.d(t,{Z:function(){return tB}});var r,i,o,a=n(74985),l=n(2038),c=n(83447),s=n(74833),u=n(56596),d=n(29287),f=n(93918),h=n(63257),p=n(25632),m=n(25425),v=n(95571),g=n(59868),y=n(18059),b=n(68514),w=n(15146),Z=n(37109),x=n(37951),C=n(38080),S=n(4070),k=n(88936),_=n(73722),E=n(41733),T=n(98924),R=n(66626),I=n(55534),D=n(8279),G=n(38202),B=n(21262),P=n(71440),A=n(58995),N=n(78711);function L(){var e=(0,B._)(["\n  fragment ThemesSwitcherCustomTheme on CustomTheme {\n    id\n    title\n    isCurrentUserThemeAuthor\n    colorScheme\n  }\n"]);return L=function(){return e},e}function U(){var e=(0,B._)(["\n  query ThemesSwitcherCurrentUserAuthoredThemes(\n    $input: CurrentUserAuthoredThemesInput!\n  ) {\n    currentUser {\n      id\n      authoredThemes(input: $input) {\n        ... on CustomThemeConnection {\n          items {\n            id\n            ...ThemesSwitcherCustomTheme\n          }\n          pageInfo {\n            nextCursor\n            hasNextPage\n          }\n        }\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserError {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return U=function(){return e},e}function O(){var e=(0,B._)(["\n  query ThemesSwitcherCurrentUserInstalledThemes(\n    $input: CurrentUserInstalledThemesInput!\n  ) {\n    currentUser {\n      id\n      installedThemes(input: $input) {\n        ... on InstalledThemeConnection {\n          items {\n            id\n            themeVersion {\n              id\n            }\n            customTheme {\n              id\n              ...ThemesSwitcherCustomTheme\n            }\n          }\n          pageInfo {\n            nextCursor\n            hasNextPage\n          }\n        }\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserError {\n          message\n        }\n      }\n    }\n  }\n  ","\n"]);return O=function(){return e},e}var M={},X=(0,P.Ps)(L()),F=(0,P.Ps)(U(),X),W=(0,P.Ps)(O(),X),H=n(30509),V=n(42308),z=n(50959),j=n(4062),q=function(e){var t=(0,R._)((0,z.useState)(0),2),n=t[0],r=t[1];return(0,j.Z)(function(){null!==e.current&&r(e.current.getBoundingClientRect().height)},[e]),n},Y=n(7444),J=n(35597),K=n(93496),$=n(79217),Q=n(84822),ee=n(21371),et=n(72143),en=n(99656),er=n(17054),ei=n(33988),eo=n.n(ei),ea=(0,f.X)({self:[{border:"1px solid",borderColor:d.TV.outlineDimmest},d.l0.zIndex(5),d.l0.maxHeight(300),d.l0.position.absolute,d.l0.overflowY("auto"),d.l0.width("100%"),d.l0.left(0),d.l0.borderRadius(8),d.l0.flex.column],apron:[d.l0.flex.grow(1),{borderTop:"1px solid",borderTopColor:d.TV.outlineDimmest}],menuItems:[d.l0.flex.growAndShrink(1),d.l0.overflowY("auto"),{listStyle:"none"}],menuApronItem:[d.l0.p(8),d.l0.rowWithGap(12),d.l0.justify.start,d.l0.align.center,K.gU.listItem],menuApronWrapper:[d.l0.flex.column]}),el=(0,er.oM)(),ec=function(e){var t=e.children,n=e.className,r=e.bottomOffset;return(0,a.BX)(C.Tg,{className:n,tag:"ul",elevated:!0,css:ea.self,style:{bottom:"calc(".concat(r,"px + ").concat(d.TV.space8,")")},children:[(0,a.tZ)(u.G,{css:ea.menuItems,children:t}),(0,a.tZ)(C.Tg,{css:ea.apron,children:(0,a.BX)(u.G,{css:ea.menuApronWrapper,children:[(0,a.tZ)(eo(),{legacyBehavior:!0,href:el.href,as:el.as,children:(0,a.BX)(u.G,{css:ea.menuApronItem,children:[(0,a.tZ)(Q.Z,{}),(0,a.tZ)(s.xv,{multiline:!1,children:"Explore Themes"})]})}),(0,a.tZ)(eo(),{legacyBehavior:!0,href:er.ZS.href,as:er.ZS.as,children:(0,a.BX)(u.G,{css:ea.menuApronItem,children:[(0,a.tZ)(en.Z,{}),(0,a.tZ)(s.xv,{multiline:!1,children:"Create a Theme"})]})})]})})]})},es=(0,f.X)({trigger:[K.gU.filled,d.l0.p(8),d.l0.color.foregroundDefault,d.l0.border({width:0})],triggerContent:[d.l0.align.center,d.l0.rowWithGap(8)],chevron:[d.l0.transition.snappy],selectLabel:[d.l0.flex.growAndShrink(1),{textAlign:"left",lineHeight:d.TV.lineHeightHeaderBig}],menuWrapper:[d.l0.position.relative],sectionHeadings:[d.l0.p(8),d.l0.fontWeight.bold,d.l0.fontSize(12),{borderTop:"1px solid ".concat(d.TV.outlineDimmer),textTransform:"uppercase"}],officialHeading:[d.l0.p(8),d.l0.fontWeight.bold,d.l0.fontSize(12),{textTransform:"uppercase"}],showMoreWrapper:[d.l0.align.center],spinnerWrapper:[d.l0.p(8),d.l0.align.center]}),eu=u.K.li;function ed(e){var t=e.id,n=e.sections,r=e.initialSelectedItem,i=e.selectedItem,o=e.onChange,l=e.placeholder,c=e.dataCy,d=e.paginationOptions,f=(0,T._)(e,["id","sections","initialSelectedItem","selectedItem","onChange","placeholder","dataCy","paginationOptions"]),h=(0,z.useId)(),p=(0,Y.Z)(o),m=(0,z.useRef)(null),v=q(m),g=Object.values(n).flat(),y=(0,ee.L7)((0,H._)((0,E._)({items:g,initialSelectedItem:r,onSelectedItemChange:function(e){var t=e.selectedItem;t&&p.current(t)},stateReducer:function(e,t){var n=t.type,r=t.changes;switch(n){case ee.L7.stateChangeTypes.MenuKeyDownEnter:case ee.L7.stateChangeTypes.MenuKeyDownSpaceButton:case ee.L7.stateChangeTypes.ItemClick:return(0,H._)((0,E._)({},r),{isOpen:!0});default:return r}}},void 0!==i&&{selectedItem:i}),{id:h})),b=(0,J.Z)({onLoadMore:d.loadMore,rootMargin:"0px 0px 300px 0px"}).targetRef,Z=function(e){var t,n=e.item,r=e.index;return(0,a.tZ)(eu,(0,H._)((0,E._)({},y.getItemProps({item:n,index:r})),{"data-cy":n.dataCy,children:(0,a.tZ)(V.Z,{highlighted:r===y.highlightedIndex,selected:n.id===(null===(t=y.selectedItem)||void 0===t?void 0:t.id),title:n.title})}))};return(0,a.BX)(u.G,{id:t,dataCy:c,children:[(0,a.tZ)(et.T,{children:(0,a.tZ)("label",(0,H._)((0,E._)({},y.getLabelProps()),{children:"select a theme"}))}),(0,a.tZ)("button",(0,H._)((0,E._)({type:"button",css:es.trigger},f,y.getToggleButtonProps({ref:m})),{children:(0,a.BX)(u.G,{css:es.triggerContent,children:[(0,a.tZ)(Q.Z,{size:16}),y.selectedItem?(0,a.tZ)(s.xv,{css:es.selectLabel,multiline:!1,children:y.selectedItem.title}):(0,a.tZ)(s.xv,{color:"dimmer",css:es.selectLabel,multiline:!1,children:l}),(0,a.tZ)($.Z,{rotate:y.isOpen?180:0,css:es.chevron})]})})),(0,a.tZ)("div",(0,H._)((0,E._)({},y.getMenuProps()),{css:es.menuWrapper,children:y.isOpen&&g.length>0?(0,a.BX)(ec,{bottomOffset:v,children:[(0,a.tZ)(s.xv,{color:"dimmer",css:es.officialHeading,multiline:!1,children:"Official Themes"}),n.official.map(function(e,t){return(0,a.tZ)(Z,{item:e,index:t},"".concat(e.id))}),n.authored.length?(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{color:"dimmer",css:es.sectionHeadings,multiline:!1,children:"Your Themes"}),n.authored.map(function(e,t){var r=n.official.length;return(0,a.tZ)(Z,{item:e,index:r+t},"".concat(e.id))})]}):null,n.installed.length?(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{color:"dimmer",css:es.sectionHeadings,multiline:!1,children:"Community Themes"}),n.installed.map(function(e,t){var r=n.official.length+n.authored.length;return(0,a.tZ)(Z,{item:e,index:r+t},"".concat(e.id))})]}):null,d.authoredHasNextPage||d.installedHasNextPage?(0,a.tZ)(u.G,{css:es.showMoreWrapper,children:d.loading?(0,a.tZ)(u.G,{css:es.spinnerWrapper,children:(0,a.tZ)(k.Z,{size:12})}):(0,a.tZ)(w.hU,{tooltipHidden:!0,alt:"Show more",onClick:d.loadMore,ref:b,children:(0,a.tZ)($.Z,{})})}):null]}):null}))]})}var ef=n(70671),eh=n(49932),ep=n(43349),em=n(67225),ev=function(e,t){var n,r,i=t.fetchMoreResult;if((null===(n=e.currentUser)||void 0===n?void 0:n.authoredThemes.__typename)==="CustomThemeConnection"&&(null===(r=i.currentUser)||void 0===r?void 0:r.authoredThemes.__typename)==="CustomThemeConnection"){var o=e.currentUser.authoredThemes.items,a=i.currentUser.authoredThemes.items;return(0,H._)((0,E._)({},i),{currentUser:(0,H._)((0,E._)({},i.currentUser),{authoredThemes:(0,H._)((0,E._)({},i.currentUser.authoredThemes),{items:(0,h._)(o).concat((0,h._)(a))})})})}return i},eg=function(e,t){var n,r,i=t.fetchMoreResult;if((null===(n=e.currentUser)||void 0===n?void 0:n.installedThemes.__typename)==="InstalledThemeConnection"&&(null===(r=i.currentUser)||void 0===r?void 0:r.installedThemes.__typename)==="InstalledThemeConnection"){var o=e.currentUser.installedThemes.items,a=i.currentUser.installedThemes.items;return(0,H._)((0,E._)({},i),{currentUser:(0,H._)((0,E._)({},i.currentUser),{installedThemes:(0,H._)((0,E._)({},i.currentUser.installedThemes),{items:(0,h._)(o).concat((0,h._)(a))})})})}return i},ey=function(e){var t=e.authoredThemesData,n=e.installedThemesData,r=e.fetchMoreAuthored,i=e.fetchMoreInstalled;return(0,z.useCallback)(function(){var e,o;(null==t?void 0:null===(e=t.currentUser)||void 0===e?void 0:e.authoredThemes.__typename)==="CustomThemeConnection"&&t.currentUser.authoredThemes.pageInfo.hasNextPage?r({variables:{input:{after:t.currentUser.authoredThemes.pageInfo.nextCursor,count:100}},updateQuery:ev}):(null==n?void 0:null===(o=n.currentUser)||void 0===o?void 0:o.installedThemes.__typename)==="InstalledThemeConnection"&&n.currentUser.installedThemes.pageInfo.hasNextPage&&i({variables:{input:{after:n.currentUser.installedThemes.pageInfo.nextCursor,count:100}},updateQuery:eg})},[t,n,r,i])},eb=function(e){var t,n,r,i,o,l,c,s,f=e.context,h=(0,T._)(e,["context"]),p=(0,z.useId)(),m=(0,I.Z)().showError,v=(t=(0,E._)({},M,{variables:{input:{count:100}},fetchPolicy:"network-only",ssr:!1,notifyOnNetworkStatusChange:!0,onError:function(e){return m(e.message)},onCompleted:function(e){var t,n=null===(t=e.currentUser)||void 0===t?void 0:t.authoredThemes;((null==n?void 0:n.__typename)==="UnauthorizedError"||(null==n?void 0:n.__typename)==="UserError")&&m(n.message)}}),A.a(F,t)),g=v.data,y=v.loading,b=v.error,w=v.fetchMore,Z=(0,R._)((n=(0,E._)({},M,{variables:{input:{count:100}},fetchPolicy:"network-only",ssr:!1,notifyOnNetworkStatusChange:!0,onError:function(e){return m(e.message)},onCompleted:function(e){var t,n=null===(t=e.currentUser)||void 0===t?void 0:t.installedThemes;((null==n?void 0:n.__typename)==="UnauthorizedError"||(null==n?void 0:n.__typename)==="UserError")&&m(n.message)}}),N.t(W,n)),2),C=Z[0],S=Z[1],k=S.data,_=S.loading,B=S.error,P=S.fetchMore,L=(0,ef.F)(),U=L.setActiveTheme,O=L.isSaving,X=L.error,H=L.theme;(0,z.useEffect)(function(){var e,t=null==g?void 0:null===(e=g.currentUser)||void 0===e?void 0:e.authoredThemes;(null==t?void 0:t.__typename)!=="CustomThemeConnection"||t.pageInfo.hasNextPage||C()},[g,C]);var V=((null==k?void 0:null===(i=k.currentUser)||void 0===i?void 0:null===(r=i.installedThemes)||void 0===r?void 0:r.__typename)==="InstalledThemeConnection"?k.currentUser.installedThemes.items:[]).map(function(e){return e.customTheme}),j=(null==g?void 0:null===(l=g.currentUser)||void 0===l?void 0:null===(o=l.authoredThemes)||void 0===o?void 0:o.__typename)==="CustomThemeConnection"?g.currentUser.authoredThemes.items:[];(0,z.useEffect)(function(){X&&m(X.message)},[X,m]);var q=ey({authoredThemesData:g,installedThemesData:k,fetchMoreAuthored:w,fetchMoreInstalled:P}),Y=(null==g?void 0:null===(c=g.currentUser)||void 0===c?void 0:c.authoredThemes.__typename)==="CustomThemeConnection"&&g.currentUser.authoredThemes.pageInfo.hasNextPage,J=(null==k?void 0:null===(s=k.currentUser)||void 0===s?void 0:s.installedThemes.__typename)==="InstalledThemeConnection"&&k.currentUser.installedThemes.pageInfo.hasNextPage;if(b||B)return(0,a.tZ)(u.G,{children:(0,a.tZ)(x.E,{colorway:"negative",text:"Something went wrong loading your themes"})});var K={official:ep.T,authored:j,installed:V};return(0,a.tZ)(u.G,{children:(0,a.tZ)(ed,(0,E._)({css:[[O?D.p.backgroundPulse(eh.TV.accentPrimaryDefault,eh.TV.accentPrimaryDimmest):{}],d.l0.backgroundColor.backgroundDefault,{":not([disabled]):hover":{background:eh.TV.backgroundHigher}}],id:p,dataCy:"preferences-theme-dropdown",sections:K,disabled:O,paginationOptions:{loadMore:q,authoredHasNextPage:Y,installedHasNextPage:J,loading:y||_},selectedItem:(0,G.iG)(H)?H.customTheme:ep.T.find(function(e){return e.id===H.id}),onChange:function(e){U(e.id),"number"==typeof e.id&&(0,em.B4)({themeId:e.id,colorScheme:e.colorScheme,isAlreadyInstalled:!0,isAuthor:e.isCurrentUserThemeAuthor,context:f})}},h))})},ew=n(81662),eZ=n(1498),ex=n(18836),eC=n(32377),eS=n(35034),ek=n(18330);function e_(e){return e.slice().sort(function(e,t){return e-t})}var eE=(0,f.X)({ruler:[d.l0.py(4),d.l0.px(8),d.l0.rowWithGap(4),d.l0.align.center,d.l0.borderRadius(8)],remove:[d.l0.borderRadius(4)],title:[d.l0.pr(8),d.l0.overflow("visible"),d.l0.flex.shrink(0)],body:[d.l0.flex.row,d.l0.flex.wrapReverse,d.l0.align.start,d.l0.justify.end,d.l0.flex.growAndShrink(1),{gap:d.TV.space4}],list:[d.l0.flex.row,d.l0.flex.wrap,d.l0.flex.growAndShrink(1),d.l0.align.end,d.l0.justify.end,{gap:d.TV.space4}],add:[d.l0.rowWithGap(4),d.l0.align.center]});function eT(e){var t=e.pos,n=e.onRemove;return(0,a.BX)(C.Tg,{css:eE.ruler,elevated:!0,children:[(0,a.tZ)(s.xv,{multiline:!1,children:t}),(0,a.tZ)(w.hU,{css:eE.remove,alt:"Remove ruler",onClick:n,children:(0,a.tZ)(eS.Z,{})})]})}function eR(){var e=(0,R._)((0,z.useState)(!1),2),t=e[0],n=e[1],r=(0,R._)((0,z.useState)(80),2),i=r[0],o=r[1],l=(0,z.useRef)(null),c=(0,z.useRef)(null),d=-1===i,f=i>=0&&i<=1e3,m=(0,p.Gn)("rulers"),v=m.preferences,g=m.update,y=e_(v.rulers);return(0,a.tZ)(ek.$,{id:"rulers",title:(0,a.tZ)(s.xv,{css:eE.title,multiline:!1,children:"Rulers"}),children:(0,a.BX)(u.G,{css:eE.body,children:[(0,a.tZ)(u.G,{css:eE.list,children:y.map(function(e,t){return(0,a.tZ)(eT,{pos:e,onRemove:function(){g({rulers:y.filter(function(e,n){return n!==t})})}},t)})}),t?(0,a.BX)(u.G,{css:eE.add,children:[(0,a.tZ)(ex.II,{ref:l,type:"number",style:{width:d?"6ch":i.toString().length+5.5+"ch"},value:i>=0?i.toString():"",onChange:function(e){if(""===e.target.value)o(-1);else{var t=parseInt(e.target.value,10);isNaN(t)||o(t)}},onKeyDown:function(e){"Escape"===e.key?(o(80),n(!1)):"Enter"===e.key&&f&&(g({rulers:e_((0,h._)(y).concat([i]))}),n(!1),o(80))},onBlur:function(e){e.relatedTarget!==c.current&&(n(!1),o(80))},onFocus:function(e){e.target.select()},autoFocus:!0}),(0,a.tZ)(eZ.zx,{ref:c,text:"Accept",colorway:"primary",iconLeft:(0,a.tZ)(eC.Z,{}),disabled:!f,onClick:function(){f&&(g({rulers:e_((0,h._)(y).concat([i]))}),n(!1),o(80))},onBlur:function(e){e.relatedTarget!==l.current&&(n(!1),o(80))}})]}):(0,a.tZ)(a.HY,{children:y.length>=10?null:(0,a.tZ)(eZ.zx,{text:"Add Ruler",iconLeft:(0,a.tZ)(en.Z,{}),onClick:function(){return n(!0)}})})]})})}var eI=(0,f.X)({container:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.start],title:[d.l0.flex.growAndShrink(1)],body:[d.l0.colWithGap(12)],switch:[d.l0.rowWithGap(8),d.l0.align.center,d.l0.justify.end]});function eD(){var e=(0,p.Gn)("showLeadingWhitespace","showTrailingWhitespace","showEnclosedWhitespace","showSelectedWhitespace"),t=e.preferences,n=e.update;return(0,a.BX)(u.G,{css:eI.container,children:[(0,a.BX)(u.G,{css:eI.title,children:[(0,a.tZ)(s.xv,{children:"Show whitespace"}),(0,a.tZ)(s.xv,{multiline:!0,variant:"small",css:[d.l0.color.foregroundDimmest],children:"Make whitespace characters visible, such as tabs and spaces."})]}),(0,a.BX)(u.G,{css:eI.body,children:[(0,a.BX)(u.G,{css:eI.switch,tag:"label",children:[(0,a.tZ)(s.xv,{variant:"small",children:"Leading"}),(0,a.tZ)(S.r,{"aria-label":"Show leading whitespace",isSelected:t.showLeadingWhitespace,onChange:function(e){n({showLeadingWhitespace:e})}})]}),(0,a.BX)(u.G,{css:eI.switch,tag:"label",children:[(0,a.tZ)(s.xv,{variant:"small",children:"Enclosed"}),(0,a.tZ)(S.r,{css:[d.l0.flex.rowReverse],"aria-label":"Show enclosed whitespace",isSelected:t.showEnclosedWhitespace,onChange:function(e){n({showEnclosedWhitespace:e})}})]}),(0,a.BX)(u.G,{css:eI.switch,tag:"label",children:[(0,a.tZ)(s.xv,{variant:"small",children:"Trailing"}),(0,a.tZ)(S.r,{"aria-label":"Show trailing whitespace",isSelected:t.showTrailingWhitespace,onChange:function(e){n({showTrailingWhitespace:e})}})]}),(0,a.BX)(u.G,{css:eI.switch,tag:"label",children:[(0,a.tZ)(s.xv,{variant:"small",children:"Selected"}),(0,a.tZ)(S.r,{"aria-label":"Show selected whitespace",isSelected:t.showSelectedWhitespace,onChange:function(e){n({showSelectedWhitespace:e})}})]})]})]})}var eG=n(60442),eB=n(47611),eP=n(42516),eA=n(96748),eN=n(30983),eL=n(75875),eU=n(16750);function eO(){var e=(0,B._)(["\n  query GhostwriterChatCurrentUserQuery {\n    currentUser {\n      username\n      id\n      image\n      isStaff: hasRole(role: REPLIT_STAFF)\n      isVerified\n      userSubscriptionType\n      userPowerUpsByType {\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n    }\n  }\n"]);return eO=function(){return e},e}var eM={},eX=(0,P.Ps)(eO()),eF=n(45434),eW=n(42371),eH=Array.from(eF.ce,function(e){return{title:e,value:e}}),eV=Array.from((0,h._)(Object.entries(eW.f)).concat([["custom",""]]),function(e){return{title:e[0],value:e[1]}});function ez(){var e,t,n,r,i=(0,m.P5)({controlName:"flag-ghostwriter-chat-engine-override",logFlagToAnalytics:!1}),o=(e=(0,E._)({},eM,void 0),A.a(eX,e)).data,l=(null==o?void 0:null===(t=o.currentUser)||void 0===t?void 0:t.isStaff)||!1,c=(0,p.Gn)("chatEngine","ghostwriterChatServiceEnvironment","ghostwriterUseAdvancedModel"),f=c.preferences,v=c.update,y=(0,eA.v)(),x={value:null,title:"default"},C=(0,eU.Th)(),k=(0,R._)((0,z.useState)(!Object.values(eW.f).includes(C)),2),T=k[0],I=k[1],D=(0,R._)((0,z.useState)(""),2),G=D[0],B=D[1],P=function(e,t){v((0,eP._)({},e,t)),(0,g.j)(g.U3.SETTINGS_TOGGLED,{settingChanged:e,updatedValue:t})};return(0,a.BX)(a.HY,{children:[i?(0,a.BX)(a.HY,{children:[(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"ghostwriterChatEngine",title:(0,a.BX)(a.HY,{children:[(0,a.BX)(u.G,{css:[d.l0.flex.row,d.l0.rowWithGap(8),d.l0.center,d.l0.justify.start],children:[(0,a.BX)(s.xv,{multiline:!1,children:["AI"," chat engine"]}),(0,a.tZ)(eN.u,{tooltip:'You are seeing this functionality because you have special permissions. If set, this preference overrides "Use Advanced model" preference.',children:(0,a.tZ)(eL.Z,{})})]}),(0,a.BX)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:["Current applied engine: ",y]})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(Z.P,{css:[d.l0.minWidth(184)],initialSelectedItem:null!==(n=eH.find(function(e){return e.value===f.chatEngine}))&&void 0!==n?n:x,onChange:function(e){return P("chatEngine",null==e?void 0:e.value)},items:[x].concat((0,h._)(eH))})})})]}):null,(0,a.BX)(a.HY,{children:[(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"ghostwriterChatUseAdvancedModel",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.G,{css:[d.l0.flex.row,d.l0.rowWithGap(8),d.l0.center,d.l0.justify.start],children:(0,a.BX)(s.xv,{multiline:!1,children:["AI"," advanced model"]})}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Advanced models require a lot of power and have usage limits. They're most useful for tasks that are ambiguous or require creativity."})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(S.r,{"aria-label":"Use Advanced model",isSelected:f.ghostwriterUseAdvancedModel,onChange:function(e){(0,g.j)(g.U3.GHOSTWRITER_CHAT_MODEL_CHANGED,{source:"settingsPane",model:e?"advanced":"default"}),P("ghostwriterUseAdvancedModel",e)}})})})]}),l?(0,a.BX)(a.HY,{children:[(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"ghostwriterChatService",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.G,{css:[d.l0.flex.row,d.l0.rowWithGap(8),d.l0.center,d.l0.justify.start],children:(0,a.tZ)(s.xv,{multiline:!1,children:"Ghostwriter Chat Service V2 "})}),(0,a.BX)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:["Current endpoint: ",C]})]}),children:(0,a.BX)(u.G,{css:d.l0.colWithGap(12),children:[(0,a.tZ)(Z.P,{css:[d.l0.minWidth(184)],initialSelectedItem:null!==(r=eV.find(function(e){return e.value===f.ghostwriterChatServiceEnvironment}))&&void 0!==r?r:f.ghostwriterChatServiceEnvironment?eV[eV.length-1]:eV[0],onChange:function(e){(null==e?void 0:e.title)!=="custom"?(P("ghostwriterChatServiceEnvironment",null==e?void 0:e.value),I(!1)):I(!0)},items:eV}),T?(0,a.BX)(u.G,{css:d.l0.rowWithGap(4),children:[(0,a.tZ)(ex.II,{value:G,onChange:function(e){B(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&P("ghostwriterChatServiceEnvironment",G)}}),(0,a.tZ)(w.hU,{alt:"Update custom url",onClick:function(){return P("ghostwriterChatServiceEnvironment",G)},children:f.ghostwriterChatServiceEnvironment!==G?(0,a.tZ)(_.Z,{}):(0,a.tZ)(eC.Z,{})})]}):null]})})]}):null]})}var ej=n(78272);function eq(e){var t=e.context,n=e.text,r=(0,R._)((0,z.useState)(!1),2),i=r[0],o=r[1];return(0,a.BX)(a.HY,{children:[(0,a.tZ)(eZ.zx,{text:void 0===n?"Activate":n,colorway:"primary",onClick:function(){return o(!0)}}),(0,a.tZ)(ej.Z,{isOpen:i,onClose:function(){return o(!1)},type:"purchase",analyticsContext:{upgrade:{context:t}}})]})}var eY=n(75582),eJ=n(18597);(r=i||(i={})).None="None",r.Activate="Activate",r.Activated="Activated",r.TrialOngoing="TrialOngoing",r.TrialExpired="TrialExpired";var eK=(o={},(0,eP._)(o,eY.e4.Activate,"Activate"),(0,eP._)(o,eY.e4.Activated,"Activated"),(0,eP._)(o,eY.e4.TrialOngoing,"TrialOngoing"),(0,eP._)(o,eY.e4.TrialExpired,"TrialExpired"),o),e$=n(79490),eQ=n(40028),e0=n(20916),e1=n(85172),e2=n(75452),e8=n(87001);function e4(){var e=(0,B._)(["\n  query CodeSuggestionPreferences {\n    currentUser {\n      id\n      userSubscriptionType\n      userPowerUpsByType {\n        __typename\n        ... on UnauthorizedError {\n          message\n        }\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n    }\n  }\n"]);return e4=function(){return e},e}var e3={},e5=(0,P.Ps)(e4()),e6=Array.from(e2.vw,function(e){return{title:e,value:e}}),e9={titleContainer:[d.l0.rowWithGap(8),d.l0.align.center],upgradeRow:[d.l0.rowWithGap(8),d.l0.align.center,d.l0.justify.spaceBetween]};function e7(){var e,t,n,r=(0,m.P5)({controlName:"flag-code-suggestion-engine",logFlagToAnalytics:!1}),i=(e=(0,E._)({},e3,void 0),A.a(e5,e)).data,o=(null==i?void 0:null===(t=i.currentUser)||void 0===t?void 0:t.userSubscriptionType)===eY.HP.HackerPro,l=(0,e1.v)().isTeamWithAiDisabled,c=(0,p.Gn)("codeSuggestion","completeCodeEngine"),f=c.preferences,v=c.update,y=(0,e0.Z)().engine,w={value:null,title:"default"},x=function(e,t){v((0,eP._)({},e,t)),(0,g.j)(g.U3.SETTINGS_TOGGLED,{settingChanged:e,updatedValue:t})};return l?null:(0,a.BX)(u.G,{css:d.l0.colWithGap(12),children:[(0,a.tZ)(ek.$,{id:"codeSuggestionToggle",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(u.G,{css:e9.titleContainer,children:(0,a.tZ)(s.xv,{multiline:!1,children:"AI code completion"})}),(0,a.BX)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:["Code completion provides inline ghost text suggestions while you code.",(0,a.tZ)("br",{}),"Press tab or swipe right on your mobile device to accept."]})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(S.r,{"aria-label":"Code complete",isSelected:f.codeSuggestion,onChange:function(e){x("codeSuggestion",e)}})})}),o?null:(0,a.BX)(u.G,{css:e9.upgradeRow,children:[(0,a.tZ)(s.xv,{children:"Upgrade for full access to Replit AI"}),(0,a.tZ)(eq,{text:"Upgrade to Replit ".concat(e8.we),context:"workspace_settings_pane"})]}),r?(0,a.BX)(a.HY,{children:[(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"completeCodeEngine",title:(0,a.BX)(a.HY,{children:[(0,a.BX)(u.G,{css:[d.l0.flex.row,d.l0.rowWithGap(8),d.l0.center,d.l0.justify.start],children:[(0,a.tZ)(s.xv,{multiline:!1,children:"AI code completion engine"}),(0,a.tZ)(eN.u,{tooltip:"You are seeing this functionality because you have special permissions.",children:(0,a.tZ)(eL.Z,{})})]}),(0,a.BX)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:["Current applied engine: ",y]})]}),children:(0,a.tZ)(a.HY,{children:(0,a.tZ)(Z.P,{css:[d.l0.minWidth(184)],initialSelectedItem:null!==(n=e6.find(function(e){return e.value===f.completeCodeEngine}))&&void 0!==n?n:w,onChange:function(e){return x("completeCodeEngine",null==e?void 0:e.value)},items:[w].concat((0,h._)(e6))})})})]}):null]})}var te={titleContainer:[d.l0.rowWithGap(8),d.l0.align.center],surface:[d.l0.p(8),d.l0.colWithGap(8),d.l0.borderRadius(8),d.l0.align.start]};function tt(){var e=function(){var e,t,n=(0,eJ.JC)(),r=n.data;if(n.loading)return{loading:!0};if((null==r?void 0:null===(e=r.currentUser)||void 0===e?void 0:e.userPowerUpsByType.__typename)==="UnauthorizedError");else if((null==r?void 0:null===(t=r.currentUser)||void 0===t?void 0:t.userPowerUpsByType.__typename)==="UserPowerUpsTypes"){var i=r.currentUser.userPowerUpsByType.ghostwriter,o=i.CTA,a=i.timeTrialExpiry;if(null!=o){var l=eK[o];if(("TrialOngoing"===l||"TrialExpired"===l)&&a)return{cta:l,trialExpiryDate:new Date(a),loading:!1};if("Activate"===l||"Activated"===l)return{cta:l,loading:!1}}}return{cta:"None",loading:!1}}(),t=e.cta,n=e.loading,r=(0,l.rv)();if(n)return(0,a.tZ)(ek.$,{id:"ghostwriter",title:"Ghostwriter",children:(0,a.tZ)(k.Z,{})});if(!r)return(0,a.tZ)(e7,{});switch(t){case i.None:return null;case i.Activated:case i.TrialOngoing:return(0,a.tZ)(e7,{});case i.TrialExpired:case i.Activate:if(r)return null;return(0,a.tZ)(ek.$,{id:"ghostwriter",title:(0,a.BX)(a.HY,{children:[(0,a.BX)(u.G,{css:te.titleContainer,children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Ghostwriter"}),(0,a.tZ)(e$.Z,{context:"workspace_settings_pane",powerUp:"ghostwriter"})]}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],multiline:!1,children:"Replit's AI pair programmer can complete, generate, explain, and edit code."})]}),children:(0,a.tZ)(eq,{context:"workspace_settings_pane"})});default:(0,eQ.Z)(t)}}var tn=n(81810);function tr(e){var t=e.onBeforePreferencesUpdate,n=e.hideLayoutControl,r=e.className,i=e.resetLayout,o=(0,p.Gn)("isLayoutStacked","fontSize","minimapDisplay","wrapping","keyboardHandler","multiselectModifierKey","showFileTreeGitStatus","codeIntelligence","accessibleTerminal","shellBellAudio","webviewAutoOpenOnPortOpened","chatAudioNotification","forwardPortsAutomatically"),c=o.preferences,f=o.update,E=(0,l.Vg)((0,eB.useRouter)()),T=(0,l.T3)(),R=(0,eG.cR)(),I=(0,y.NJ)(),D=(0,m.P5)({controlName:"flag-editor-visible-whitespace",logFlagToAnalytics:!1}),G=(0,m.P5)({controlName:"flag-chat-audio-notification"}),B=(0,m.P5)({controlName:"flag-filetree-git-status",logFlagToAnalytics:!1}),P=(0,m.P5)({controlName:tn.c0,logFlagToAnalytics:!0}),A=function(e){t&&t(e),Object.keys(e).forEach(function(t){var n=e[t];(0,g.j)(g.U3.SETTINGS_TOGGLED,{settingChanged:t,updatedValue:n})}),f(e)};if(!c)return null;var N=[{value:"side-by-side",title:"side-by-side"},{value:"stacked",title:"stacked"}],L=[{value:10,title:"tiny"},{value:12,title:"small"},{value:14,title:"normal"},{value:18,title:"large"},{value:24,title:"huge"}],U=[{value:"default",title:"default"},{value:"emacs",title:"emacs"},{value:"vim",title:"vim"}],O=[{value:"none",title:"none"},{value:"soft",title:"soft wrap"}],M=[{value:"none",title:"none"},{value:"blocks",title:"blocks"},{value:"characters",title:"characters"}],X=[{value:"none",title:"never"},{value:"only-global",title:"all ports except localhost"},{value:"all",title:"all ports"}],F=["cmdOrCtrlKey","altKey"].map(function(e){return{value:e,title:(0,v.hp)("cmdOrCtrlKey"===e?v.LH.CMD_OR_CTRL_KEY:v.LH.ALT_KEY,I)}});return(0,a.BX)(C.Tg,{className:r,background:"default",css:[d.l0.p(16),d.l0.colWithGap(12)],children:[n?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(ek.$,{id:"layout",title:"Default layout",children:(0,a.BX)(u.G,{css:[d.l0.align.center,d.l0.rowWithGap(8)],children:[i?(0,a.tZ)(w.hU,{alt:"Reset layout",onClick:function(){i.reset()},children:i.reseting?(0,a.tZ)(k.Z,{}):(0,a.tZ)(_.Z,{})}):null,(0,a.tZ)(Z.P,{initialSelectedItem:N.find(function(e){return c.isLayoutStacked?"stacked"===e.value:"side-by-side"===e.value}),onChange:function(e){A({isLayoutStacked:(null==e?void 0:e.value)==="stacked"})},items:(0,h._)(N)})]})}),(0,a.tZ)(b.R,{})]}),(0,a.tZ)(ek.$,{id:"fontSize",title:"Font size",children:(0,a.tZ)(Z.P,{initialSelectedItem:L.find(function(e){return e.value===c.fontSize}),onChange:function(e){A({fontSize:"number"==typeof(null==e?void 0:e.value)?e.value:14})},items:(0,h._)(L)})}),(0,a.tZ)(b.R,{}),(0,a.tZ)(ew.ZP,{}),(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"wrapping",title:"Wrapping",children:(0,a.tZ)(Z.P,{initialSelectedItem:O.find(function(e){return e.value===(c.wrapping?"soft":"none")}),onChange:function(e){A({wrapping:(null==e?void 0:e.value)==="soft"})},items:(0,h._)(O)})}),(0,a.tZ)(b.R,{}),T?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(ek.$,{id:"minimap",title:"Minimap",children:(0,a.tZ)(Z.P,{initialSelectedItem:M.find(function(e){return e.value===c.minimapDisplay}),onChange:function(e){A({minimapDisplay:e.value})},items:(0,h._)(M)})}),(0,a.tZ)(b.R,{})]}),(0,a.tZ)(eR,{}),(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"keybinds",title:"Keybinds",children:(0,a.tZ)(Z.P,{initialSelectedItem:U.find(function(e){return["vim","emacs"].includes(e.value)?e.value===c.keyboardHandler:"default"===e.value&&!c.keyboardHandler}),onChange:function(e){A({keyboardHandler:["vim","emacs"].includes(e.value)?e.value:null})},items:(0,h._)(U),dataCy:"keybinds"})}),(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"multiselectModifier",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Multiselect modifier key"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Modifier key for selecting multiple items in the filetree."})]}),children:(0,a.tZ)(Z.P,{initialSelectedItem:F.find(function(e){return e.value===c.multiselectModifierKey}),onChange:function(e){A({multiselectModifierKey:e.value})},items:(0,h._)(F)})}),(0,a.tZ)(b.R,{}),B?(0,a.BX)(a.HY,{children:[(0,a.tZ)(ek.$,{id:"showFileTreeGitStatus",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"File tree Git status"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Show the Git status of files in the file tree."})]}),children:(0,a.tZ)(S.r,{"aria-label":"File tree Git status",isSelected:c.showFileTreeGitStatus,onChange:function(e){A({showFileTreeGitStatus:e})}})}),(0,a.tZ)(b.R,{})]}):null,(0,a.tZ)(tt,{}),(0,a.tZ)(ez,{}),(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"codeIntelligence",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Code intelligence"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Code intelligence gives you autocomplete, as well as hints as you type."})]}),children:(0,a.tZ)(S.r,{"aria-label":"Code Intelligence",isSelected:c.codeIntelligence,onChange:function(e){A({codeIntelligence:e})}})}),(0,a.tZ)(b.R,{}),D?(0,a.BX)(a.HY,{children:[(0,a.tZ)(eD,{}),(0,a.tZ)(b.R,{})]}):null,(0,a.tZ)(ek.$,{id:"accessibleTerminal",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Accessible terminal output"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Enable this setting to use a screen reader. Warning: this can affect performance."})]}),children:(0,a.tZ)(S.r,{"aria-label":"Accessible terminal output",isSelected:c.accessibleTerminal,onChange:function(e){A({accessibleTerminal:e})}})}),(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"shellBellAudio",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Shell bell audible indicator"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Should the Shell play sounds when there is an issue like a failed tab completion?"})]}),children:(0,a.tZ)(S.r,{"aria-label":"Shell bell audible indicator",isSelected:c.shellBellAudio,onChange:function(e){A({shellBellAudio:e})}})}),(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"webviewAutoOpenOnPortOpened",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:R?"Automatic webview (unavailable in this Repl)":"Automatic webview"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],multiline:!1,children:"Open a webview automatically when a port is open"}),R?(0,a.tZ)(u.G,{css:[d.l0.pt(8),d.l0.maxWidth("calc(100% - 12px)")],children:(0,a.tZ)(x.E,{colorway:"orange",text:'This preference is unavailable in Extension Repls. To view custom tools in dev mode, click the "Preview" button in Extension Devtools instead.'})}):null]}),children:(0,a.tZ)(S.r,{"aria-label":"Automatic Webview",isSelected:c.webviewAutoOpenOnPortOpened,isDisabled:R,onChange:function(e){A({webviewAutoOpenOnPortOpened:e})}})}),P?(0,a.BX)(a.HY,{children:[(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"forwardPortsAutomatically",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Forward opened ports automatically"}),(0,a.tZ)(s.xv,{variant:"small",css:d.l0.color.foregroundDimmest,multiline:!1,children:"Automatically configure detected newly opened ports."})]}),children:(0,a.tZ)(Z.P,{initialSelectedItem:X.find(function(e){return e.value===c.forwardPortsAutomatically}),onChange:function(e){A({forwardPortsAutomatically:e.value})},items:(0,h._)(X)})})]}):null,E?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"theme",title:"Theme",children:(0,a.tZ)(eb,{css:[d.l0.minWidth(184),d.l0.backgroundColor.backgroundHigher],context:em.HY.WorkspacePreferencesPane})})]}),G?(0,a.BX)(a.HY,{children:[(0,a.tZ)(b.R,{}),(0,a.tZ)(ek.$,{id:"chat-audio",title:(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{multiline:!1,children:"Chat Audio Notifications"}),(0,a.tZ)(s.xv,{variant:"small",css:[d.l0.color.foregroundDimmest],children:"Enables playing a sound when you receive a new chat message."})]}),children:(0,a.tZ)(S.r,{"aria-label":"Chat Audio Notifications",isSelected:c.chatAudioNotification,onChange:function(e){A({chatAudioNotification:e})}})})]}):null]})}var ti=n(10981),to=n(43312),ta=n(69119),tl=n(22487),tc=n(50199),ts=n(43208),tu=n(1128),td=n(52682),tf=n(52924),th=n(89788),tp=n(20573),tm=n(88032),tv=n(25961),tg=n(27308),ty=n(96003);function tb(e){var t=(0,z.useRef)(null),n=(0,z.useRef)([]);function r(){t.current&&clearTimeout(t.current),n.current=[]}function i(t){e({type:"success",shortcut:t.length>1?[t[0],t[1]]:t[0]}),r()}return{onKeyDown:function(r){var o=t.current,a=n.current;r.preventDefault(),r.stopPropagation(),o&&clearTimeout(o);var l=(0,tg.lc)(r);if(l){if((0,tg.ZG)(l)){e({type:"update",recorded:a.length?[a[0],l]:[l]});return}if(a.length>0&&"Enter"===l){i(a);return}a.push(l),e({type:"update",recorded:a});var c=2===a.length?0:600;t.current=setTimeout(function(){return i(a)},c)}},startRecording:function(){r(),e({type:"start"})},stopRecording:function(){r(),e({type:"stop"})}}}var tw=(0,f.X)({root:[d.l0.colWithGap(8)],row:[d.l0.rowWithGap(8),d.l0.align.center,d.l0.minHeight(28)],left:[d.l0.colWithGap(2),d.l0.flex.grow(0),d.l0.flex.shrink(1)],right:[d.l0.rowWithGap(4),d.l0.align.center,d.l0.justify.end,d.l0.position.relative,d.l0.flex.grow(1),d.l0.flex.shrink(0)],recordingRow:[d.l0.flex.column,d.l0.align.center,d.l0.justify.end],recordingRowInner:[d.l0.rowWithGap(8),d.l0.align.center],recordingRowKeys:[d.l0.position.relative],recordingRowHint:[d.l0.position.absolute,d.l0.top(20),d.l0.right(0),{fontStyle:"italic"}],recordingRowPlaceholder:[d.l0.display.flex,d.l0.align.baseline,d.l0.rowWithGap(4),{fontStyle:"italic"}],keys:[d.l0.display.inlineFlex,d.l0.rowWithGap(12)],secondaryText:[d.l0.display.flex,d.l0.flex.row,d.l0.align.center,d.l0.rowWithGap(4)],secondaryTextId:[d.l0.flex.grow(1),d.l0.flex.shrink(0)],secondaryTextDescription:[d.l0.flex.grow(0),d.l0.flex.shrink(1),d.l0.color.foregroundDimmest],buttons:[d.l0.rowWithGap(4)]}),tZ=(0,f.X)({root:[d.l0.rowWithGap(8),d.l0.align.center],recordingRow:[d.l0.rowWithGap(4),d.l0.align.center]});function tx(e){var t,n,r,i,o=e.command,l=e.filter,c=(0,ty.r3)(),d=(0,ty.wU)(),f=(0,ty.V_)(o.id),h=(0,R._)((0,z.useState)(null),2),p=h[0],m=h[1],v=(0,R._)((0,z.useState)(null),2),g=v[0],y=v[1],b=tb(function(e){switch(e.type){case"start":y({recorded:[]}),m(null);return;case"stop":y(null),m(null);return;case"update":y({recorded:e.recorded}),m(null);return;case"success":var t=(0,tg.SG)(e.shortcut);if(!t){y(null),m(null);return}var n=c(o.id,t);if(n){y(null),m('This shortcut conflicts with "'.concat(n.conflict.name,'"'));return}y(null);return;case"error":y(function(t){var n;return{error:e.message,recorded:null!==(n=null==t?void 0:t.recorded)&&void 0!==n?n:[]}});return}}),Z=b.stopRecording,C=b.startRecording,S=b.onKeyDown,k=(0,tl.Z)(function(){return Z()},[]),E=!!g;tE(E);var T=null!==(i=null==g?void 0:g.recorded)&&void 0!==i?i:[],I=null==g?void 0:g.error,D=l.length>0,G=null===(t=ts.Z.match(l,o.name))||void 0===t?void 0:t.ranges,B=null===(n=ts.Z.match(l,o.id))||void 0===n?void 0:n.ranges,P=(null==o?void 0:o.description)?null===(r=ts.Z.match(l,o.description))||void 0===r?void 0:r.ranges:void 0,A=(0,tc.Z)(function(){return l.replaceAll('"',"").split("-").map(function(e){return e.toLowerCase()})},[l]);return(0,a.BX)(u.G,{css:tw.root,children:[(0,a.BX)(u.G,{css:tw.row,children:[(0,a.BX)(u.G,{css:tw.left,children:[(0,a.tZ)(ta.x,{text:o.name,highlight:G,dimmed:D}),(0,a.BX)(s.xv,{variant:"small",css:tw.secondaryText,multiline:!1,children:[D?(0,a.tZ)(ta.x,{css:tw.secondaryTextId,text:o.id,highlight:B,dimmed:D}):null,o.description?(0,a.BX)(a.HY,{children:[D?(0,a.tZ)(s.xv,{color:"dimmest",multiline:!1,children:""}):null,(0,a.tZ)(ta.x,{css:tw.secondaryTextDescription,text:o.description,highlight:P,dimmed:D})]}):null]})]}),(0,a.BX)(u.G,{innerRef:E?k:void 0,css:tw.right,children:[E?(0,a.tZ)(tm.MT,{autoFocus:!0,restoreFocus:!0,children:(0,a.tZ)("input",{onKeyDown:S,css:{opacity:0,width:1}})}):null,o.shortcut&&!E?(0,a.tZ)(tv.bM,{small:!0,keyCombo:o.shortcut,match:A}):null,o.shortcut||E?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(eZ.zx,{size:"small",variant:"outlined",iconLeft:(0,a.tZ)(en.Z,{}),text:"Add shortcut",onClick:function(){return C()}}),f?(0,a.tZ)(w.hU,{alt:"Reset",onClick:function(){var e=c(o.id,f);e&&m("".concat(f,' conflicts with "').concat(e.conflict.name,'"'))},children:(0,a.tZ)(_.Z,{})}):null]}),E?(0,a.tZ)(u.G,{css:tw.recordingRow,children:(0,a.BX)(u.G,{css:tw.recordingRowInner,children:[(0,a.tZ)(u.G,{css:tw.recordingRowKeys,children:T.length>0?(0,a.tZ)(u.G,{css:[tw.keys],children:T.map(function(e,t){return(0,a.tZ)(tv.bM,{small:!0,keyCombo:e},"".concat(e,"-").concat(t))})}):(0,a.tZ)(s.xv,{multiline:!1,color:"dimmest",css:tw.recordingRowPlaceholder,children:"Recording..."})}),(0,a.tZ)(w.hU,{alt:"Stop",onClick:function(){return Z()},children:(0,a.tZ)(tI,{})})]})}):null,o.shortcut&&!E?(0,a.BX)(u.G,{css:tw.buttons,children:[f&&f!==o.shortcut?(0,a.tZ)(w.hU,{alt:"Reset",onClick:function(){var e=c(o.id,f);e&&m("".concat(f,' conflicts with "').concat(e.conflict.name,'"'))},children:(0,a.tZ)(_.Z,{})}):null,(0,a.tZ)(w.hU,{alt:"Change",onClick:function(){return C()},children:(0,a.tZ)(tf.Z,{})}),(0,a.tZ)(w.hU,{alt:"Remove",onClick:function(){return d(o.id)},children:(0,a.tZ)(td.Z,{})})]}):null]})]}),I?(0,a.tZ)(x.E,{icon:(0,a.tZ)(tp.Z,{}),colorway:"warning",text:I,closable:!0,closeAction:function(){return y(function(e){var t;return{recorded:null!==(t=null==e?void 0:e.recorded)&&void 0!==t?t:[]}})}}):null,p?(0,a.tZ)(x.E,{icon:(0,a.tZ)(tp.Z,{}),colorway:"warning",text:p,closable:!0,closeAction:function(){return m(null)}}):null]})}function tC(e){var t=e.flat();return t.length>1?t.map(function(e){return tC([e])}).join(" "):(0,tg.QR)(t[0]).map(function(e){return'"'.concat(e,'"')}).join("-").replaceAll(" ","space")}var tS=(0,f.X)({root:[d.l0.colWithGap(8),d.l0.p(0)],surface:[d.l0.pt(8),d.l0.borderRadius(8),d.l0.colWithGap(12)]});function tk(e){var t=(0,R._)((0,z.useState)(""),2),n=t[0],r=t[1];function i(t){r(t),z.startTransition(function(){return e.onSearch(t)})}var o=(0,z.useRef)(null),l=(0,R._)((0,z.useState)(!1),2),c=l[0],d=l[1];tE(c);var f=tb(function(e){var t,n,r;switch(e.type){case"start":d(!0),i(""),null==o||null===(t=o.current)||void 0===t||t.focus();return;case"stop":case"error":d(!1),null==o||null===(n=o.current)||void 0===n||n.focus(),null==o||null===(r=o.current)||void 0===r||r.select();return;case"success":i(tC([e.shortcut]));return;case"update":i(tC(e.recorded));return}}),h=f.stopRecording,p=f.startRecording,m=f.onKeyDown;return(0,a.BX)(u.G,{css:tZ.root,children:[(0,a.tZ)(tm.MT,{children:(0,a.tZ)(ex.II,{ref:o,placeholder:c?"Recording keys. Press Escape to exit":"Type to search keyboard shortcuts",onBlur:c?h:void 0,onChange:function(e){i(e.currentTarget.value)},onKeyDown:c?function(e){"Escape"===e.key?h():m(e)}:void 0,value:n})}),(0,a.tZ)(u.G,{css:tZ.recordingRow,children:c?(0,a.BX)(a.HY,{children:[(0,a.tZ)(s.xv,{color:"dimmest",css:[{fontStyle:"italic"}],multiline:!1,children:"Recording..."}),(0,a.tZ)(w.hU,{alt:"Stop Recording",onClick:h,children:(0,a.tZ)(tI,{})})]}):(0,a.tZ)(w.hU,{alt:"Record Keys",onClick:p,children:(0,a.tZ)(th.Z,{})})}),(0,a.tZ)(w.hU,{alt:"Clear Input",disabled:0===n.length,onClick:function(){var e;i(""),null==o||null===(e=o.current)||void 0===e||e.focus()},children:(0,a.tZ)(eS.Z,{})})]})}function t_(){var e=(0,R._)((0,z.useState)(""),2),t=e[0],n=e[1],r=(0,ty.xF)(),i=(0,tc.Z)(function(){return(0,h._)(r.values())},[r]),o=(0,z.useMemo)(function(){return ts.Z.filter(t,i,{extract:function(e){var t="".concat(e.name," ").concat(e.id);return e.description&&(t+=" ".concat(e.description)),e.shortcut&&(t+=" ".concat(tC([e.shortcut]))),t}})},[t,i]);return(0,a.BX)(u.G,{css:tS.root,children:[(0,a.tZ)(tk,{onSearch:n}),o.length>0?(0,a.tZ)(C.Tg,{css:tS.surface,children:o.map(function(e,n){return(0,a.BX)(z.Fragment,{children:[n>0?(0,a.tZ)(C.Tg,{elevated:!0,style:{height:1}}):null,(0,a.tZ)(tx,{command:e.original,filter:t})]},e.original.id)})}):null]})}function tE(e){var t="You have unsaved changes";(0,z.useEffect)(function(){var n=function(e){return e.preventDefault(),e.returnValue=t,t};if(e)return window.addEventListener("beforeunload",n),function(){window.removeEventListener("beforeunload",n)}},[e])}var tT=(0,to.F4)("0%{transform:scale(1);}40%{transform:scale(1.3);}100%{transform:scale(1);}"),tR=(0,f.X)({background:[{animationName:tT,animation:"".concat(tT," 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"),boxShadow:"0 0 10px ".concat(d.TV.redStronger)},d.l0.height(11),d.l0.width(11),d.l0.borderRadius("full"),d.l0.position.absolute],container:[d.l0.position.relative,d.l0.align.center,d.l0.justify.center],icon:[{zIndex:1}]});function tI(){return(0,a.BX)(u.G,{css:tR.container,children:[(0,a.tZ)(tu.Z,{css:tR.icon,color:d.TV.redStronger}),(0,a.tZ)(u.G,{css:tR.background})]})}function tD(){var e=(0,ti.U)()("keyboard_shortcuts");return(0,a.BX)(C.Tg,{background:"default",css:[d.l0.px(16),d.l0.pb(16),d.l0.colWithGap(12)],children:[(0,a.tZ)(u.G,{tag:"label",htmlFor:e}),(0,a.tZ)(t_,{})]})}var tG=(0,f.X)({headerContainer:[d.l0.flex.column,d.l0.justify.center,d.l0.px(16),d.l0.py(8)],subheading:[{fontStyle:"italic"},d.l0.color.foregroundDimmer,d.l0.mt(8),d.l0.mb(8)],tabs:[{width:"100%"}],tabList:[{"[aria-selected=true]":[d.l0.fontWeight.medium]}],tab:[d.l0.py(8),d.l0.px(16)]});function tB(e){var t=e.hideLayoutControl,n=e.resetLayout,r=(0,l.T3)();return(0,a.BX)(a.HY,{children:[(0,a.BX)(u.G,{css:tG.headerContainer,children:[(0,a.tZ)(s.h4,{variant:"subheadBig",level:3,children:"User Settings"}),(0,a.tZ)(s.xv,{variant:"small",css:tG.subheading,children:"The following settings apply to your account and will be used across all your Repls."})]}),r?(0,a.tZ)(tr,{hideLayoutControl:t,resetLayout:n}):(0,a.tZ)(u.G,{children:(0,a.BX)(c.mQ,{css:tG.tabs,children:[(0,a.BX)(c.td,{withDividers:!1,css:tG.tabList,children:[(0,a.tZ)(c.OK,{css:tG.tab,children:"Editor preferences"}),(0,a.tZ)(c.OK,{css:tG.tab,children:"Keyboard shortcuts"})]}),(0,a.BX)(c.nP,{children:[(0,a.tZ)(c.x4,{children:(0,a.tZ)(tr,{resetLayout:n})}),(0,a.tZ)(c.x4,{children:(0,a.tZ)(tD,{})})]})]})})]})}},5344:function(e,t,n){n.d(t,{BZ:function(){return S},HX:function(){return x},WM:function(){return E},ap:function(){return P},gF:function(){return I},l9:function(){return T},vi:function(){return G},zu:function(){return _}});var r=n(41733),i=n(21262),o=n(71440),a=n(78747),l=n(11707),c=n(83436),s=n(63204),u=n(51780),d=n(32147),f=n(58995),h=n(99165);function p(){var e=(0,i._)(["\n  fragment WorkspaceHeaderReplInfoRepl on Repl {\n    id\n    title\n    rawTemplateLabel: templateLabel(disableFallbackToTitle: true)\n    description\n    isPrivate\n    isRenamed\n    url\n    slug\n    workspaceCta\n    lastPublishedAt\n    publishedAs\n    owner {\n      ... on Team {\n        id\n      }\n      ... on User {\n        id\n      }\n    }\n    currentUserPermissions {\n      containerAttach\n      changeIconUrl\n      changeTemplateLabel\n      changeTitle\n      changeDescription\n      changePrivacy\n      delete\n      changeAlwaysOn\n      publish\n      fork\n    }\n    hostingDeployment {\n      ... on HostingDeployment {\n        id\n        currentBuild {\n          id\n        }\n      }\n    }\n    hostingDeploymentPermissions {\n      canDeploy\n    }\n    user {\n      id\n      image\n      ...UserLinkUser\n    }\n    ...WorkspaceHeaderReplMetadataRepl\n    ...ReplEnvironmentWebviewRepl\n    ...PublishReleaseFormRepl\n    ...BulkDeleteConfirmationModalRepl\n  }\n  ","\n  ","\n  ","\n  ","\n  ","\n"]);return p=function(){return e},e}function m(){var e=(0,i._)(["\n  query WorkspaceHeaderReplInfo($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n  }\n  ","\n"]);return m=function(){return e},e}function v(){var e=(0,i._)(["\n  query CurrentUserStates {\n    currentUser {\n      __typename\n      ... on CurrentUser {\n        id\n      }\n    }\n  }\n"]);return v=function(){return e},e}function g(){var e=(0,i._)(["\n  query ReplPowerUpStatus {\n    currentUser {\n      __typename\n      ... on CurrentUser {\n        id\n        userPowerUpsByType {\n          ... on UserPowerUpsTypes {\n            privateRepls {\n              active\n              cost {\n                cycles\n                explanation\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return g=function(){return e},e}function y(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoUnpublishTemplate(\n    $input: DeleteReplDeploymentInput!\n  ) {\n    deleteReplDeployment(input: $input) {\n      ... on Repl {\n        id\n        ...PublishReplData\n      }\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function b(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...WorkspaceHeaderReplInfoRepl\n      }\n    }\n  }\n  ","\n"]);return b=function(){return e},e}function w(){var e=(0,i._)(["\n  mutation WorkspaceHeaderReplInfoDeleteRepl($id: String!) {\n    deleteRepl(id: $id) {\n      id\n    }\n  }\n"]);return w=function(){return e},e}var Z={},x=(0,o.Ps)(p(),a._,l.s,c.sY,s.wd,u.d),C=(0,o.Ps)(m(),x);function S(e){var t=(0,r._)({},Z,e);return f.a(C,t)}var k=(0,o.Ps)(v());function _(e){var t=(0,r._)({},Z,e);return f.a(k,t)}var E=(0,o.Ps)(g());function T(e){var t=(0,r._)({},Z,e);return f.a(E,t)}var R=(0,o.Ps)(y(),d.FW);function I(e){var t=(0,r._)({},Z,e);return h.D(R,t)}var D=(0,o.Ps)(b(),x);function G(e){var t=(0,r._)({},Z,e);return h.D(D,t)}var B=(0,o.Ps)(w());function P(e){var t=(0,r._)({},Z,e);return h.D(B,t)}},32604:function(e,t,n){n.d(t,{Z:function(){return e4}});var r=n(41733),i=n(30509),o=n(66626),a=n(74985),l=n(76999),c=n.n(l),s=n(43182),u=n(50959),d=n(14819),f=n(38889),h=n(46835),p=n(60427),m=n(56337),v=n(68399),g=n(7444),y=n(55534),b=n(50782),w=n(6189),Z=n(22004),x=n(59868),C=n(73614),S=n(30384),k=n(27387),_=n(42516),E=n(96583),T=n(72310),R=n(21262),I=n(71440),D=n(58995);function G(){var e=(0,R._)(["\n  query PendingChanges($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        deployment {\n          id\n          activeRelease {\n            id\n            pendingChanges {\n              fileName\n              changeType\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return G=function(){return e},e}var B={},P=(0,I.Ps)(G()),A=n(1498),N=n(60769),L=n(18836),U=n(57468),O=n(37951),M=n(74833),X=n(30983),F=n(56596),W=n(88936),H=n(81799),V=n(20573),z=n(29287),j=n(10981),q=n(56412),Y=n(75582),J=n(73524),K=n(19659),$=n(63204),Q=n(48459),ee=n(66555),et=n(99165);function en(){var e=(0,R._)(["\n  mutation RevertTemplateRelease($input: RevertReplReleaseInput!) {\n    revertReplRelease(input: $input) {\n      ... on Repl {\n        id\n      }\n      ... on UserError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return en=function(){return e},e}var er={},ei=(0,I.Ps)(en()),eo=F.K.form;function ea(e){if(0===e.length)return{message:"You cannot leave this empty."}}function el(e){var t,n,r=e.changeType;return r===Y.J5.NewFile?(t=z.TV.accentPositiveStronger,n="Added"):r===Y.J5.DeletedFile?(t=z.TV.accentNegativeStronger,n="Deleted"):(t=z.TV.foregroundDefault,n="Changed"),(0,a.tZ)(M.xv,{variant:"small",css:[{color:t}],multiline:!1,children:n})}function ec(e){var t=e.pendingChangesState,n=e.isReplitTemplate;if(t.loading)return(0,a.tZ)(F.G,{css:[z.l0.center],children:(0,a.tZ)(W.Z,{})});if(t.error)return(0,a.tZ)(O.E,{icon:(0,a.tZ)(V.Z,{}),text:t.error.message||"Could not load modified files - please try again.",colorway:"negative"});if(!t.pendingChanges||0===t.pendingChanges.length)return n?null:(0,a.tZ)(M.xv,{children:"No changes to publish. Come back when you have made changes to your Repl."});var r=t.pendingChanges,i=r.slice(0,15);return(0,a.BX)(F.G,{css:[{display:"grid",gridTemplateColumns:"1fr 1fr",gap:z.TV.space8}],children:[i.map(function(e){return(0,a.BX)(u.Fragment,{children:[(0,a.BX)(F.G,{css:[z.l0.rowWithGap(4),z.l0.align.center],children:[(0,a.tZ)(U.Z,{size:12,path:e.fileName}),(0,a.tZ)(M.xv,{multiline:!1,children:e.fileName})]},e.fileName),(0,a.tZ)(el,{changeType:e.changeType})]},e.fileName)}),r.length>i.length&&(0,a.BX)(M.xv,{multiline:!1,children:["And ",r.length-i.length," other files..."]})]})}function es(e){var t,n=e.repl,i=function(){var e,t=(0,o._)((e=(0,r._)({},er,{refetchQueries:["ReplEnvironmentHeader"]}),et.D(ei,e)),2),n=t[0];function i(){return(i=(0,k._)(function(e){var t;return(0,E.Jh)(this,function(r){switch(r.label){case 0:return[4,n({variables:{input:e.input}})];case 1:return[2,{data:(t=r.sent()).data,error:function(e){if(!e.data)return null;var t=e.data;if("revertReplRelease"in t){if("NotFoundError"===t.revertReplRelease.__typename||"UnauthorizedError"===t.revertReplRelease.__typename||"UserError"===t.revertReplRelease.__typename)return t.revertReplRelease.message;if("Repl"!==t.revertReplRelease.__typename)return"Something went wrong reverting your Template"}}(t)}]}})})).apply(this,arguments)}return{revertTemplateRelease:function(e){return i.apply(this,arguments)},state:t[1]}}(),l=(t=(0,k._)(function(e){return(0,E.Jh)(this,function(t){switch(t.label){case 0:return[4,i.revertTemplateRelease({input:{replId:n.id,releaseId:e}})];case 1:return t.sent(),[2]}})}),function(e){return t.apply(this,arguments)});return(0,a.BX)(F.G,{children:[(0,a.tZ)(M.h4,{level:1,variant:"subheadBig",css:[z.l0.mb(16)],children:"Existing Releases"}),(0,a.tZ)(F.G,{css:[{display:"grid",gridTemplateColumns:"2fr 3fr 1fr",gap:z.TV.space8}],children:n.releases.items.map(function(e){var t,r;return(0,a.BX)(u.Fragment,{children:[(0,a.tZ)("span",{children:(0,q.Z)(new Date(e.timeCreated),"do MMM, hh:mm a")}),(0,a.tZ)("span",{children:e.description}),(0,a.tZ)("span",{style:{justifySelf:"end"},children:e.id===(null===(r=n.deployment)||void 0===r?void 0:null===(t=r.activeRelease)||void 0===t?void 0:t.id)?(0,a.tZ)("span",{css:[z.l0.p(4),{display:"flex"}],children:"(active)"}):(0,a.tZ)(A.zx,{text:"revert",colorway:"primary",size:"small",onClick:function(){l(e.id)}})})]},e.id)})})]})}function eu(e){var t=e.children;return(0,a.tZ)(F.G,{css:[z.l0.rowWithGap(8),z.l0.py(2)],children:t})}function ed(e){var t,n,l,c,s,d,f,h,p,m=e.repl,v=(0,j.U)(),g=(0,o._)((0,u.useState)(!1),2),y=g[0],b=g[1],w=(0,o._)((0,u.useState)(!1),2),Z=w[0],x=w[1],C=(t=function(e){var t,n,i,o,a=(i={variables:{replId:e.replId},fetchPolicy:"cache-and-network",ssr:!1},o=(0,r._)({},B,i),D.a(P,o)),l=a.data,c=a.loading,s=a.error;if(c)return{loading:c,pendingChanges:null,error:null};if(s)return{loading:!1,pendingChanges:null,error:s};var u=(null==l?void 0:l.repl.__typename)==="Repl"?l.repl:null;return u?{loading:!1,pendingChanges:(null===(n=u.deployment)||void 0===n?void 0:null===(t=n.activeRelease)||void 0===t?void 0:t.pendingChanges)||[],error:s}:{loading:!1,pendingChanges:null,error:Error("Repl not found")}}({replId:{replId:m.id}.replId}),n=(0,u.useMemo)(function(){return t.pendingChanges?t.pendingChanges.slice().sort(function(e,t){return e.fileName.localeCompare(t.fileName)}).map(function(e){return{file:e,pathDepth:(0,K.U$)(e.fileName)}}).sort(function(e,t){return e.pathDepth-t.pathDepth}).map(function(e){return e.file}):[]},[t.pendingChanges]),(0,i._)((0,r._)({},t),{pendingChanges:n})),S=(0,ee.r)(),R=(0,T.Y)("",ea),I=(null===(c=C.pendingChanges)||void 0===c?void 0:c.length)!==0,G=(null===(s=m.user)||void 0===s?void 0:s.username)===J.IU||(null===(d=m.user)||void 0===d?void 0:d.username)==="templates",N=(0,o._)((0,u.useState)({ran:!1,tested:!1}),2),U=N[0],W=N[1];(0,u.useEffect)(function(){W({ran:!1,tested:!1})},[W]);var q=!!(R.error||!G&&!I||S.loading||G&&(!U.ran||!U.tested)),Y=G&&(null===(h=m.releases)||void 0===h?void 0:null===(f=h.items)||void 0===f?void 0:f.length)>1,$="";return(R.error?$="Please fill out the form":G||I||($="No changes to publish in this release"),y)?(0,a.tZ)(Q.q,{repl:m,isUpdate:!0}):Z?(0,a.tZ)(F.G,{css:[z.l0.p(16),z.l0.colWithGap(16)],children:(0,a.tZ)(es,{repl:m})}):(0,a.BX)(eo,{onSubmit:(l=(0,k._)(function(e){return(0,E.Jh)(this,function(t){switch(t.label){case 0:if(e.preventDefault(),q||R.validate())return[2];return[4,S.createRelease({input:{replId:m.id,description:R.value}})];case 1:if(t.sent().error)return[2];return b(!0),[2]}})}),function(e){return l.apply(this,arguments)}),css:[z.l0.colWithGap(24),z.l0.p(16)],children:[(0,a.tZ)(M.h4,{level:1,variant:"headerDefault",children:"Publish a new release"}),(0,a.BX)(F.G,{css:[z.l0.colWithGap(8)],children:[(0,a.tZ)(M.h4,{level:2,variant:"subheadDefault",children:"Modified files"}),(0,a.tZ)(ec,{pendingChangesState:C,isReplitTemplate:G})]}),G||I?(0,a.BX)(F.G,{css:[z.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:v("description"),css:[z.l0.color.foregroundDimmer,{fontSize:z.TV.fontSizeSmall,lineHeight:z.TV.lineHeightSmall}],children:"Description"}),(0,a.tZ)(L.B,{id:v("description"),"aria-label":"Description",onChange:function(e){return R.setValue(e.target.value)},css:[z.l0.width("100%"),z.l0.minHeight(64),z.l0.maxHeight(128),{resize:"vertical"}],placeholder:"Explain what has changed about your template"}),R.error?(0,a.tZ)(O.E,{icon:(0,a.tZ)(V.Z,{}),text:null===(p=R.error)||void 0===p?void 0:p.message,colorway:"negative"}):null]}):null,G?(0,a.tZ)(ef,{repl:m,state:U,onChange:function(e,t){return W(function(n){return(0,i._)((0,r._)({},n),(0,_._)({},e,t))})}}):null,(0,a.tZ)(F.G,{children:S.error?(0,a.tZ)(O.E,{icon:(0,a.tZ)(V.Z,{}),text:S.error,colorway:"negative"}):null}),(0,a.BX)(F.G,{css:[z.l0.rowWithGap(12),z.l0.justify.end],children:[Y?(0,a.tZ)(A.zx,{text:"Revert to older",colorway:"negative",onClick:function(){return x(!0)}}):null,(0,a.tZ)(X.u,{tooltip:$,placement:"bottom",isDisabled:!$,children:(0,a.tZ)(A.zx,{text:"Publish release",type:"submit",colorway:"primary",iconLeft:(0,a.tZ)(H.Z,{}),disabled:q})})]})]})}function ef(e){var t,n,r,i=e.repl,o=e.state,l=e.onChange,c=(0,j.U)(),s=(0,$.e9)(),u=s.data,d=s.loading,f=null==u?void 0:null===(t=u.currentUser)||void 0===t?void 0:t.username;return(0,a.BX)(F.G,{css:[z.l0.colWithGap(12)],children:[(0,a.tZ)(M.h4,{level:2,children:"Official Replit Template publishing checklist"}),(0,a.BX)(F.G,{children:[(0,a.BX)(eu,{children:[(0,a.tZ)(N.X,{id:c("ran"),checked:o.ran,onChange:function(e){return l("ran",e.target.checked)}}),(0,a.tZ)("label",{htmlFor:c("ran"),children:"Ran Repl:"}),(0,a.BX)("span",{children:["I ran the Repl to generate and cache package guesser result into"," ",(0,a.tZ)("code",{children:".upm"}),"."]})]}),(0,a.BX)(eu,{children:[(0,a.tZ)(N.X,{id:c("tested"),checked:o.tested,onChange:function(e){return l("tested",e.target.checked)}}),(0,a.tZ)("label",{htmlFor:c("tested"),children:"Ran tests:"}),(0,a.BX)("span",{children:['I ran "Test working copy" for @',null===(n=i.user)||void 0===n?void 0:n.username,"/",i.slug," in"," ",(0,a.tZ)("a",{href:"https://template-tester.replit.app/",target:"_blank",children:"template tester"}),". ",(0,a.tZ)("br",{}),"If there are no tests, consider adding one."]})]})]}),d||(null===(r=i.user)||void 0===r?void 0:r.username)!==f?null:(0,a.tZ)(O.E,{text:"You can't publish an update while impersonating. Add yourself as a member of the 'replit' team using CLUI tool 'add-remove-team-member', then open this Repl from your account.",colorway:"negative"})]})}var eh=n(25061),ep=n(5693),em=n(5315),ev=n(15053),eg=n(59639),ey=n(49344),eb=n(38080),ew=n(7877),eZ=n(39390),ex=n(97411),eC=n(78272),eS=n(47611),ek=n(40028),e_=n(5344),eE=n(78066),eT=n(85805),eR=n(43973),eI=n(52924),eD=n(6620),eG=n(35972),eB=n(88205);function eP(e){var t=(0,u.useRef)(null),n=(0,o._)((0,u.useState)(e.value),2),r=n[0],i=n[1],l=(0,o._)((0,u.useState)(null),2),s=l[0],d=l[1],f=(0,eT.Z)({onUpload:function(t){var n=t.url;e.onChange(n)},onUploadPreview:function(e){i(e.dataUrl)},onError:function(e){d(e.message)}});(0,u.useEffect)(function(){i(e.value)},[e.value]);var h=null==r?void 0:r.startsWith("data:");return(0,a.BX)(eG.gC,{spacing:"var(--space-4)",children:[(0,a.BX)("div",{onClick:function(){var e;null===(e=t.current)||void 0===e||e.click()},"aria-label":r?"Change icon":"Upload an icon","data-microtip-position":"right",role:"tooltip",className:c().dynamic([["649b73688aef77e0",[32,32]]])+" "+((r?"update-icon":"add-icon")||""),children:[r?(0,a.BX)(a.HY,{children:[(0,a.tZ)(eE.Z,{iconUrl:r,size:32,alt:"icon"}),h?(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" loading-state",children:(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" loading-icon",children:(0,a.tZ)(W.Z,{})})}):(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" hover-state",children:(0,a.tZ)(eI.Z,{})})]}):(0,a.tZ)(eD.Z,{}),(0,a.tZ)("input",{ref:t,accept:eR.W9.join(","),type:"file",onChange:function(e){var t=e.target,n=t.validity,r=t.files;n.valid&&(null==r?void 0:r.length)&&(d(null),f.uploadImage(r[0],eB.N.TemplateIcon))},className:c().dynamic([["649b73688aef77e0",[32,32]]])})]}),s?(0,a.tZ)("div",{className:c().dynamic([["649b73688aef77e0",[32,32]]])+" error",children:s}):null,(0,a.tZ)(c(),{id:"649b73688aef77e0",dynamic:[32,32],children:".add-icon.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;border:1px dashed var(--foreground-dimmest);background-color:var(--background-root);width:".concat(32,"px;height:").concat(32,"px}.add-icon.__jsx-style-dynamic-selector:hover{color:var(--accent-primary-default);border-color:var(--accent-primary-default)}.add-icon.__jsx-style-dynamic-selector,.update-icon.__jsx-style-dynamic-selector{position:relative;cursor:pointer;background-color:var(--background-higher);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);padding:2px}.update-icon.__jsx-style-dynamic-selector:hover .hover-state.__jsx-style-dynamic-selector{opacity:.8}.hover-state.__jsx-style-dynamic-selector{opacity:0}.loading-state.__jsx-style-dynamic-selector{opacity:.8}.loading-icon.__jsx-style-dynamic-selector{-webkit-animation:rotate 1s linear infinite;-moz-animation:rotate 1s linear infinite;-o-animation:rotate 1s linear infinite;animation:rotate 1s linear infinite;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}@-webkit-keyframes rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes rotate{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes rotate{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}.hover-state.__jsx-style-dynamic-selector,.loading-state.__jsx-style-dynamic-selector{color:var(--accent-primary-default);position:absolute;top:0;left:0;width:100%;height:100%;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);background-color:var(--background-root);overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}input.__jsx-style-dynamic-selector{opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1}.error.__jsx-style-dynamic-selector{font-size:var(--font-size-default);color:var(--accent-negative-default)}")})]})}var eA=n(25770),eN=n(79378),eL=n(70002),eU=n(15146),eO=n(5542),eM=n(74883),eX=n(58719),eF=n(80339),eW=n(98859),eH=n(8271),eV=n(52682),ez=n(48528),ej=n(89106),eq=n(20399),eY=n(93918),eJ=n(8017),eK=n(13900),e$=n(31811),eQ=n(92611),e0=(0,eY.X)({destructiveMenuItem:[z.l0.color.accentNegativeStronger]});function e1(e){var t=e.repl,n=(0,m.Z)(),o=(0,u.useMemo)(function(){return t.user?{text:t.user.username,css:[{"&, & span":z.l0.flex.shrink(1)}],iconLeft:(0,a.tZ)(eN.q,{src:t.user.image,username:t.user.username})}:{text:""}},[t]);if(!t.user)return null;var l=(0,eO.Ru)(t.user);return n?(0,a.tZ)(A.zx,(0,i._)((0,r._)({},o),{onClick:function(){ej.X.openExternalUrl(l.as)}})):(0,a.tZ)(eL.Z,(0,i._)((0,r._)({},o,l),{prefetch:!1}))}function e2(e){var t=e.setActiveDialog,n=e.repl,o=e.isTemplate,l=e.updateIconUrl,c=e.showCloseButton,s=e.setIsEditing,u=e.updateReplInfo,d=(0,e$.Z)(),h=!!n.publishedAs,p=n.currentUserPermissions.publish,v=(0,m.Z)(),g=!(null==n?void 0:n.publishedAs)&&!v,y=(null==n?void 0:n.publishedAs)===Y.O2.RegularRepl,b=(0,f.g)().fork,w=[];n.currentUserPermissions.fork&&w.push({value:eQ.$.Fork,label:"Fork",icon:(0,a.tZ)(eH.Z,{})}),n.publishedAs===Y.O2.RegularRepl&&p&&!v&&w.push({value:eQ.$.Unpublish,label:"Unpublish",icon:(0,a.tZ)(eW.Z,{})}),o&&p&&!v&&w.push({value:eQ.$.UnpublishTemplate,label:"Unpublish template",icon:(0,a.tZ)(eW.Z,{})}),h&&p&&!v&&w.push({value:eQ.$.EditPublishSettings,label:"Edit Publish Settings",icon:(0,a.tZ)(eI.Z,{})}),n.currentUserPermissions.delete&&w.push({isDestructive:!0,value:eQ.$.Delete,label:"Delete",icon:(0,a.tZ)(eV.Z,{})});var Z=(null==n?void 0:n.isPrivate)||!(null==n?void 0:n.isRenamed),x="";return(null==n?void 0:n.isPrivate)?x="This Repl is private. You need to make it public in order to publish it!":(null==n?void 0:n.isRenamed)||(x="You need to give this Repl a name before publishing it."),(0,a.BX)(F.G,{css:[z.l0.colWithGap(8),z.l0.p(8)],children:[(0,a.BX)(F.G,{css:[z.l0.rowWithGap(8),z.l0.align.center,z.l0.justify.spaceBetween,(0,_._)({},z.BC.max("mobileMax"),[z.l0.flex.columnReverse,z.l0.align.start,{gap:z.TV.space8}])],children:[(0,a.BX)(F.G,{css:[z.l0.rowWithGap(8),z.l0.center,z.l0.flex.shrink(1)],children:[(0,a.tZ)(e1,{repl:n}),n.currentUserPermissions.changeIconUrl&&o?(0,a.tZ)(eP,{value:n.iconUrl,onChange:l}):null]}),(0,a.BX)(F.G,{css:[z.l0.align.center,z.l0.rowWithGap(8),(0,_._)({},z.BC.max("mobileMax"),{width:"100%",">*:not(div)":{flex:1}})],children:[v?null:(0,a.tZ)(eL.Z,(0,i._)((0,r._)({prefetch:!1},(0,eA.j3)(n)),{iconLeft:(0,a.tZ)(eF.Z,{}),colorway:"primary",text:"Cover page",target:"_blank"})),p&&g&&!d?(0,a.tZ)(X.u,{tooltip:x,isDisabled:!Z,children:(0,a.tZ)(A.zx,{type:"button",iconLeft:(0,a.tZ)(eD.Z,{}),onClick:function(){t(eQ.x.Publish)},dataCy:"ws-publish-button",text:"Publish",disabled:Z})}):null,o&&!v?(0,a.tZ)(A.zx,{type:"button",iconLeft:(0,a.tZ)(eD.Z,{}),onClick:function(){return t(eQ.x.UpdatePublishedTemplate)},text:"Update"}):null,y&&!v?(0,a.tZ)(A.zx,{type:"button",iconLeft:(0,a.tZ)(eM.Z,{}),onClick:function(){return t(eQ.x.UpdatePublishedRepl)},text:"Update"}):null,v?(0,a.tZ)(ez.j,{textToCopy:window.location.href,alt:"Copy Repl URL",tooltip:"Copied!",tooltipPlacement:"bottom-end",timeout:2e3,children:(0,a.tZ)(eJ.Z,{})}):null,w.length>0&&(0,a.tZ)(eq.ZE,{icon:(0,a.tZ)(eK.Z,{size:16}),"aria-label":o?"Template Actions":"Repl Actions",cssProps:[z.l0.backgroundColor.backgroundDefault],placement:"bottom-end",onAction:function(e){switch(e){case eQ.$.Fork:b();return;case eQ.$.Unpublish:t(eQ.x.Unpublish);return;case eQ.$.UnpublishTemplate:t(eQ.x.UnpublishTemplate);return;case eQ.$.Delete:t(eQ.x.DeleteRepl);return;case eQ.$.EditPublishSettings:t(eQ.x.EditPublishSettings)}},children:w.map(function(e){return(0,a.tZ)(eq.ck,{children:(0,a.BX)(F.G,{css:[z.l0.rowWithGap(8),e.isDestructive&&e0.destructiveMenuItem],children:[e.icon,(0,a.tZ)(F.G,{children:e.label})]})},e.value)})}),c?(0,a.tZ)(eU.hU,{alt:"Close",tooltipHidden:!0,onClick:function(){u(),s(!1)},children:(0,a.tZ)(eX.Z,{})}):null]})]}),n.lastPublishedAt&&p?(0,a.BX)(M.xv,{variant:"small",color:"dimmest",multiline:!1,children:["Last published on"," ",new Date(n.lastPublishedAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]}):null]})}var e8={query:v.s8};function e4(e){var t=e.setIsEditing,n=e.showCloseButton,r=e.onDeployClick,i=(0,b.Z)(),o=(0,e_.BZ)({variables:{replId:i}}),l=o.data,c=o.refetch,s=(null==l?void 0:l.repl.__typename)==="Repl"?l.repl:null;return s?(0,a.tZ)(e3,{setIsEditing:t,showCloseButton:n,repl:s,refetch:c,onDeployClick:r}):(0,a.tZ)(F.G,{css:[z.l0.center,z.l0.p(16)],children:(0,a.tZ)(W.Z,{})})}function e3(e){var t,n,l,v=e.repl,b=e.showCloseButton,k=e.setIsEditing,_=e.onDeployClick,E=(0,eS.useRouter)(),T=(0,m.Z)(),R=(0,o._)((0,u.useState)(null),2),I=R[0],D=R[1],G=(0,o._)((0,u.useState)(v.isRenamed?v.title:""),2),B=G[0],P=G[1],N=(0,o._)((0,u.useState)(v.description||""),2),U=N[0],X=N[1],W=(0,o._)((0,u.useState)(v.rawTemplateLabel),2),H=W[0],V=W[1],q=(0,e_.zu)().data,J=(0,y.Z)().showError,K=v.publishedAs===Y.O2.Template;(0,u.useEffect)(function(){X(v.description||"")},[v.description]);var $=(0,C.Z)(),Q=(0,u.useRef)(v),ee=(0,o._)((0,e_.ap)({variables:{id:v.id},onCompleted:function(){if(T){E.push("/desktopApp/home");return}E.push("/home","/~")},update:function(e,t){var n;(null===(n=t.data)||void 0===n?void 0:n.deleteRepl)&&(e.evict({id:e.identify(t.data.deleteRepl)}),e.gc())},onError:function(e){return J((0,w.Z)(e.message))}}),2),et=ee[0],en=ee[1].loading,er=(0,o._)((0,e_.vi)({onError:function(e){return J((0,w.Z)(e.message))},onCompleted:function(e){var t=e.updateRepl.repl,n=Q.current,r={};n.description!==t.description&&(r.description=t.description),n.title!==t.title&&(r.title=t.title),n.url!==t.url&&(r.url=t.url,E.push({pathname:$,query:{replUrl:t.url}},t.url+window.location.search+window.location.hash)),n.isRenamed!==t.isRenamed&&(r.isRenamed=!!t.isRenamed),Q.current=v,Object.keys(r).length>0&&k(!1)}}),2),ei=er[0],eo=er[1].loading,ea=(0,o._)((0,e_.gF)({variables:{input:{replId:v.id}},onError:function(e){s.Tb(e),J((0,w.Z)(e.message))}}),2),el=ea[0],ec=ea[1],es=(0,e_.l9)({fetchPolicy:"cache-and-network",ssr:!1}),eu=es.data,ef=es.loading,eE=es.error,eT=(0,u.useMemo)(function(){return!!B&&B!==v.title||H!==v.rawTemplateLabel||(""!==U||!!v.description)&&U!==v.description},[v,B,U,H]),eR=(0,g.Z)(eT),eI=(0,u.useCallback)(function(){eT&&ei({variables:{input:{id:v.id,title:B.trim()||v.title,description:U,templateLabel:v.currentUserPermissions.changeTemplateLabel?H:void 0}}})},[eT,ei,v,B,U,H]),eD=(0,g.Z)(eI);(0,u.useLayoutEffect)(function(){return function(){eR.current&&eD.current()}},[eD,eR]);var eG=(0,u.useCallback)(function(e){switch(e){case"private":var t,n,r;return(null==eu?void 0:null===(t=eu.currentUser)||void 0===t?void 0:t.userPowerUpsByType.__typename)==="UserPowerUpsTypes"?null===(r=eu.currentUser.userPowerUpsByType)||void 0===r?void 0:null===(n=r.privateRepls.cost)||void 0===n?void 0:n.explanation:null;case"always-on":case"gpu":return null;default:(0,ek.Z)(e)}},[eu]),eB=function(){ei({variables:{input:{id:v.id,isPrivate:!v.isPrivate}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,i._)((0,r._)({},v),{isPrivate:!v.isPrivate})}},refetchQueries:[{query:e_.WM,variables:{replId:v.id}},e8]}),(0,x.j)(x.U3.PRIVATE_TOGGLED,{enabled:!v.isPrivate,source:"workspace_info_modal"})},eP=v.isRenamed?"Name your Repl":"Default name: ".concat(v.title),eA=[Y.Sy.Submit,Y.Sy.PublishTemplate,Y.Sy.EditTemplate].includes(v.workspaceCta),eN=(0,j.U)(),eL=(null===(t=v.owner)||void 0===t?void 0:t.__typename)==="Team",eU=v.hostingDeploymentPermissions.canDeploy&&"function"==typeof _,eO="/replEnvironmentDesktop"===$&&eU,eM=(0,p.gg)(),eX=eM.isDeployableRepl,eF=eM.reason,eW=(null===(n=v.hostingDeployment)||void 0===n?void 0:n.__typename)==="HostingDeployment"&&v.hostingDeployment.currentBuild;return(0,a.BX)("div",{css:{overflow:"auto",maxHeight:"80vh"},className:c().dynamic([["2a8dddb54f0c0922",[v.currentUserPermissions.changeDescription?"auto":"not-allowed"]]]),children:[(0,a.tZ)(f.b,{forkParams:{trackingData:{forkSource:"editReplPopoverMenuItem"}},repl:v,teamContext:null===(l=v.user)||void 0===l?void 0:l.username,children:(0,a.tZ)(e2,{repl:v,isTemplate:K,showCloseButton:b,setActiveDialog:D,setIsEditing:k,updateIconUrl:function(e){return ei({variables:{input:{id:v.id,iconUrl:e}},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:(0,i._)((0,r._)({},v),{iconUrl:e})}}})},updateReplInfo:eI})}),(0,a.tZ)("form",{onSubmit:function(e){e.preventDefault(),eI()},className:c().dynamic([["2a8dddb54f0c0922",[v.currentUserPermissions.changeDescription?"auto":"not-allowed"]]]),children:(0,a.BX)(F.G,{css:[z.l0.align.stretch,z.l0.colWithGap(16)],children:[(0,a.BX)(eb.Tg,{background:"default",css:[z.l0.colWithGap(16)],children:[(0,a.tZ)(F.G,{css:[z.l0.flex.column],children:(0,a.BX)(F.G,{css:[z.l0.colWithGap(4)],children:[(0,a.BX)(F.G,{css:[z.l0.flex.row,z.l0.justify.spaceBetween,z.l0.align.end],children:[(0,a.tZ)("label",{htmlFor:eN("name"),className:c().dynamic([["2a8dddb54f0c0922",[v.currentUserPermissions.changeDescription?"auto":"not-allowed"]]]),children:(0,a.tZ)(M.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Name"})}),(0,a.tZ)(h.Z,{maxLength:60,value:B,hideLabel:!0})]}),(0,a.tZ)(L.II,{style:{cursor:v.currentUserPermissions.changeTitle?"auto":"not-allowed"},disabled:!v.currentUserPermissions.changeTitle,maxLength:60,placeholder:eP,value:B,onChange:function(e){return P(e.target.value)},spellCheck:!1,id:eN("name"),dataCy:"ws-repl-info-title-input"})]})}),(0,a.tZ)(F.G,{css:[z.l0.flex.column],children:(0,a.BX)(F.G,{css:[z.l0.colWithGap(4)],children:[(0,a.BX)(F.G,{css:[z.l0.flex.row,z.l0.justify.spaceBetween,z.l0.align.end],children:[(0,a.tZ)("label",{htmlFor:eN("description"),className:c().dynamic([["2a8dddb54f0c0922",[v.currentUserPermissions.changeDescription?"auto":"not-allowed"]]]),children:(0,a.tZ)(M.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Description"})}),(0,a.tZ)(h.Z,{maxLength:em.p,value:U,hideLabel:!0})]}),(0,a.tZ)(L.B,{onKeyDown:function(e){13===e.keyCode&&(e.ctrlKey||e.metaKey)},disabled:!v.currentUserPermissions.changeDescription,maxLength:em.p,value:U,onChange:function(e){return X(e.target.value)},placeholder:"What does this Repl do?",css:[z.l0.minHeight(96),z.l0.maxHeight(256),{resize:"vertical"}],id:eN("description")})]})})]}),K&&v.currentUserPermissions.changeTemplateLabel?(0,a.tZ)(eb.Tg,{background:"default",css:[z.l0.colWithGap(4)],children:(0,a.BX)(F.G,{css:[z.l0.colWithGap(4)],children:[(0,a.tZ)("label",{htmlFor:eN("template"),className:c().dynamic([["2a8dddb54f0c0922",[v.currentUserPermissions.changeDescription?"auto":"not-allowed"]]]),children:(0,a.tZ)(M.xv,{color:"dimmer",variant:"small",multiline:!1,children:"Template label"})}),(0,a.tZ)(L.II,{value:H,maxLength:60,placeholder:"Template label",spellCheck:!1,onChange:function(e){return V(e.target.value)},id:eN("template")})]})}):null]})}),eA?null:(0,a.BX)(F.G,{css:[z.l0.colWithGap(24),z.l0.p(8),z.l0.pt(0)],children:[v.currentUserPermissions.changePrivacy===Y.HA.Allowed&&(0,a.BX)(F.G,{css:[z.l0.colWithGap(8)],children:[(0,a.BX)(eg.hE,{tag:"fieldset",name:eN("privacy"),value:v.isPrivate.toString(),onChange:function(){if(!eo){if(v.isPrivate||v.currentUserPermissions.changePrivacy===Y.HA.Allowed&&(null===(e=v.user)||void 0===e?void 0:e.id)!=null&&(null==q?void 0:null===(t=q.currentUser)||void 0===t?void 0:t.id)!=null&&v.user.id!==q.currentUser.id){eB();return}var e,t,n,r,i=(null==eu?void 0:null===(n=eu.currentUser)||void 0===n?void 0:n.userPowerUpsByType.__typename)==="UserPowerUpsTypes"&&(null===(r=eu.currentUser.userPowerUpsByType)||void 0===r?void 0:r.privateRepls.active),o=eG("private");if(null==o||ef){J("You're too fast for us! Please try again in a moment.");return}if(eE){J("This action is currently unavailable. Please refresh and try again.");return}if((0,x.j)(x.U3.POWER_UP_TOGGLE_REQUESTED,{powerUp:"private",setting:!v.isPrivate,source:"workspace_info_modal",costExplanation:o}),i){eB();return}D(eQ.x.PowerUp)}},row:!0,primary:!0,stretch:!0,children:[(0,a.tZ)(eg.rK,{id:eN("false"),value:"false",text:"Public",icon:(0,a.tZ)(eZ.Z,{})}),(0,a.tZ)(eg.rK,{id:eN("true"),value:"true",text:"Private",icon:(0,a.tZ)(ex.Z,{})})]}),(0,a.tZ)(M.xv,{variant:"small",color:"dimmest",children:(0,Z.Z)(v.isPrivate,eL)})]}),eO?(0,a.BX)(F.G,{css:z.l0.colWithGap(8),children:[(0,a.tZ)(A.zx,{text:eW?"Redeploy your project":"Deploy your project",iconLeft:(0,a.tZ)(ew.Z,{}),colorway:eW?void 0:"primary",onClick:function(){_(),eW||(0,x.j)(x.U3.DEPLOY_PROJECT_SELECTED,{source:"workspace_info_modal"})},disabled:!eX}),eX?null:(0,a.tZ)(O.E,{text:eF})]}):null]}),(0,a.tZ)(ev.Z,{isOpen:I===eQ.x.DeleteRepl,onClose:function(){return D(null)},selectedRepls:[v],onDelete:function(){et()},deleting:en}),(0,a.tZ)(eC.Z,{isOpen:I===eQ.x.PowerUp,onClose:function(){return D(null)},type:"purchase",analyticsContext:{upgrade:{context:"workspace_info_modal"}}}),(0,a.tZ)(ey.u,{isOpen:I===eQ.x.Unpublish,onRequestClose:function(){return D(null)},children:(0,a.tZ)(ep.Z,{repl:v,source:"replEnvironment",onDone:function(){D(null)}})}),(0,a.tZ)(ey.u,{isOpen:I===eQ.x.UnpublishTemplate,onRequestClose:function(){return D(null)},children:(0,a.tZ)(d.Z,{confirmLabel:"Yes, unpublish this Template",isDestructive:!0,title:"Unpublish Template",onCancel:function(){return D(null)},onConfirm:function(){ec.loading||(el(),D(null))},children:"Your Repl will no longer be discoverable on Templates. You can republish again at any time, and all of your comments or reactions will stick around."})}),(0,a.tZ)(ey.u,{isOpen:I===eQ.x.EditPublishSettings,onRequestClose:function(){return D(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,a.tZ)(S.Z,{source:"replEnvironment",replId:v.id})}),(0,a.tZ)(ey.u,{isOpen:I===eQ.x.Publish,onRequestClose:function(){return D(null)},noPadding:!0,maxWidth:872,fitContent:!0,children:(0,a.tZ)(S.Z,{source:"replEnvironment",replId:v.id})}),(0,a.tZ)(ey.u,{isOpen:I===eQ.x.UpdatePublishedTemplate,onRequestClose:function(){return D(null)},noPadding:!0,children:(0,a.tZ)(ed,{repl:v})}),(0,a.tZ)(ey.u,{isOpen:I===eQ.x.UpdatePublishedRepl,onRequestClose:function(){return D(null)},children:(0,a.tZ)(eh.Z,{repl:v,onDone:function(){return D(null)},source:"replEnvironment"})}),(0,a.tZ)(c(),{id:"2a8dddb54f0c0922",dynamic:[v.currentUserPermissions.changeDescription?"auto":"not-allowed"],children:"form.__jsx-style-dynamic-selector{padding:var(--space-8)}textarea.__jsx-style-dynamic-selector{min-height:42px;height:200px;resize:none;cursor:".concat(v.currentUserPermissions.changeDescription?"auto":"not-allowed",";font-size:var(--font-size-default);font-family:var(--font-family-default);padding:var(--space-8);display:block;width:100%;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);border:1px solid var(--outline-dimmest);-webkit-transition:.2s border-color;-moz-transition:.2s border-color;-o-transition:.2s border-color;transition:.2s border-color;background-color:transparent;color:var(--foreground-default)}textarea.__jsx-style-dynamic-selector:hover{border-color:var(--accent-primary-dimmer)}textarea.__jsx-style-dynamic-selector:active,textarea.__jsx-style-dynamic-selector:focus{border-color:var(--accent-primary-default)}textarea.__jsx-style-dynamic-selector:disabled{opacity:.5}textarea.__jsx-style-dynamic-selector:focus,textarea.__jsx-style-dynamic-selector:active{outline:none;border-color:var(--accent-primary-default)}.edit-repl-actions.__jsx-style-dynamic-selector{padding:0 var(--space-16)}.menu-item.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;color:var(--foreground-default)}.delete-menu-item.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;color:var(--accent-negative-default)}.icon-container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;padding:0 var(--space-4)}.menu-text.__jsx-style-dynamic-selector{padding:0 var(--space-4)}@media screen and (max-width:480px){.edit-repl.__jsx-style-dynamic-selector{width:80vw}}")})]})}},11707:function(e,t,n){n.d(t,{s:function(){return l}});var r=n(21262),i=n(71440),o=n(78747);function a(){var e=(0,r._)(["\n  fragment WorkspaceHeaderReplMetadataRepl on Repl {\n    id\n    title\n    iconUrl\n    user {\n      id\n      ...UserLinkUser\n    }\n  }\n  ","\n"]);return a=function(){return e},e}var l=(0,i.Ps)(a(),o._)},38168:function(e,t,n){n.d(t,{Z:function(){return p}});var r=n(42516),i=n(74985),o=n(2161),a=n(74833),l=n(56596),c=n(93918),s=n(29287),u=n(6597),d=n(4901),f=n(30983),h=(0,c.X)({metadata:[s.l0.rowWithGap(6),s.l0.align.center,s.l0.flex.growAndShrink(1)],iconWrapper:[s.l0.position.relative,s.l0.display.none,(0,r._)({},s.BC.min("tabletMax"),[s.l0.display.flex])],dimIcon:[{opacity:.2}],diconnectedIcon:[s.l0.position.absolute,{left:0,right:0,top:0,bottom:0,margin:"auto"}],title:[s.l0.flex.shrink(1),s.l0.truncate]});function p(e){var t=e.repl,n=(0,u.Z)().didDisconnect;return(0,i.BX)(l.G,{css:h.metadata,children:[(0,i.BX)(l.G,{css:h.iconWrapper,children:[(0,i.tZ)(l.G,{css:n&&h.dimIcon,children:(0,i.tZ)(o.ZP,{iconUrl:t.iconUrl,size:20,alt:""})}),n?(0,i.tZ)(f.u,{tooltip:"Reconnecting",children:(0,i.tZ)(d.Z,{size:16,css:h.diconnectedIcon})}):null]}),(0,i.tZ)(a.xv,{multiline:!1,css:h.title,"data-cy":"header-repl-title",color:n?"dimmer":"default",children:t.title})]})}},92611:function(e,t,n){var r,i,o,a;n.d(t,{$:function(){return i},x:function(){return r}}),(o=r||(r={})).DeleteRepl="DeleteRepl",o.PowerUp="PowerUp",o.BuyCycles="BuyCycles",o.Unpublish="Unpublish",o.UnpublishTemplate="UnpublishTemplate",o.EditPublishSettings="EditPublishSettings",o.Publish="Publish",o.UpdatePublishedTemplate="UpdatePublishedTemplate",o.UpdatePublishedRepl="UpdatePublishedRepl",(a=i||(i={})).Fork="Fork",a.Delete="Delete",a.Unpublish="Unpublish",a.UnpublishTemplate="UnpublishTemplate",a.EditPublishSettings="EditPublishSettings"},61673:function(e,t,n){n.d(t,{ZP:function(){return Q},L7:function(){return $}});var r,i,o,a=n(27387),l=n(42516),c=n(41733),s=n(30509),u=n(66626),d=n(96583),f=n(74985),h=n(43312),p=n(43182),m=n(25632),v=n(60561),g=n(80703),y=n(69852),b=n(21262),w=n(71440),Z=n(58995);function x(){var e=(0,b._)(["\n  query CelebrateReplRunCurrentUser {\n    currentUser {\n      id\n      timeCreated\n    }\n  }\n"]);return x=function(){return e},e}var C={},S=(0,w.Ps)(x()),k=new Date("2022-07-08"),_=(0,y.O4)("useCelebrateFirstReplPlay",!1),E=n(55534),T=n(50782),R=n(2689),I=n(93049),D=n(59868),G=n(74833),B=n(30983),P=n(56596),A=n(29479),N=n(88936),L=n(27187),U=n(25753),O=n(29287),M=n(18107),X=n(49996),F=n(74652),W=n(50959);function H(){var e=(0,b._)(["\n  query WorkspaceRunButton($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        language\n        title\n        rootOriginReplUrl\n        source {\n          release {\n            id\n            repl {\n              id\n              title\n              owner {\n                ... on User {\n                  id\n                  username\n                }\n                ... on Team {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n    currentUser {\n      id\n    }\n  }\n"]);return H=function(){return e},e}var V={},z=(0,w.Ps)(H());function j(e){var t=e.runState,n=e.size,r=void 0===n?16:n;switch(t){case M.Ah.IDLE:return(0,f.tZ)(L.Z,{size:r});case M.Ah.RUNNING:return(0,f.tZ)(U.Z,{size:r});default:return(0,f.tZ)(N.Z,{size:r})}}var q=(r={},(0,l._)(r,M.Ah.IDLE,"Run"),(0,l._)(r,M.Ah.RUNNING,"Stop"),(0,l._)(r,M.Ah.STOPPING,"Stopping"),(0,l._)(r,M.Ah.OFFLINE,"Working"),(0,l._)(r,M.Ah.BEFORE_RUN,"Working"),r),Y=(i={small:48,large:100},(0,l._)(i,M.Ah.IDLE,68),(0,l._)(i,M.Ah.RUNNING,72),(0,l._)(i,M.Ah.STOPPING,92),(0,l._)(i,M.Ah.OFFLINE,86),(0,l._)(i,M.Ah.BEFORE_RUN,86),i),J=(0,h.iv)([O.l0.py(12),O.l0.width(Y.small),O.l0.flex.row,O.l0.center,O.l0.borderRadius(),O.l0.backgroundColor.accentPositiveDimmest,O.l0.color.accentPositiveStrongest,O.l0.cursor.pointer,O.l0.focusRing,(o={transition:"color 0.2s ease 0s, background-color 0.2s ease 0s",border:"1px solid",borderColor:"transparent",lineHeight:1,outline:"0 none","&:hover":[{color:"white"},O.l0.backgroundColor.accentPositiveDefault],"&:active":[{borderColor:O.TV.accentPositiveStrongest}]},(0,l._)(o,(0,X.et)("tabletMax"),[O.l0.width(Y.large)]),(0,l._)(o,":focus-visible",{outlineColor:"".concat(O.TV.accentPositiveStrongest)}),o)]),K=(0,h.iv)([O.l0.color.foregroundDimmer,O.l0.backgroundColor.backgroundHigher,{borderColor:"transparent","&:hover":[{color:"white"},O.l0.backgroundColor.backgroundHighest],"&:active":[{borderColor:O.TV.accentPrimaryDefault}]}]);function $(e){var t=(0,u._)((0,W.useState)(e.getRunState()),2),n=t[0],r=t[1];return(0,W.useEffect)(function(){return r(e.getRunState()),e.onStateChanged(function(e){r(e)})},[e]),n}var Q=W.forwardRef(function(e,t){var n,r,i,o,h,y,b,w,x,N,L,U,H,Q=e.runner,ee=e.runConfig,et=e.onRunInitiated,en=e.style,er=void 0===en?"default":en,ei=e.disableTooltip,eo=e.shortcut,ea=(0,T.Z)(),el=$(Q),ec=(n=(0,c._)({},V,{variables:{id:ea}}),Z.a(z,n)).data,es=(null==ec?void 0:ec.repl.__typename)==="Repl"?ec.repl:null,eu=(r=(0,c._)({},C,void 0),h=Z.a(S,r),y=(0,m.Gn)("extraDelight").preferences.extraDelight,b=(0,v.$0)().fireCircularBurstFrom,x=(w=(0,u._)((0,g.KO)(_),2))[0],N=w[1],L=null!==(o=null===(i=h.data)||void 0===i?void 0:i.currentUser)&&void 0!==o?o:null,U=!x&&L&&new Date(L.timeCreated)>=k,{hasCelebrated:x,celebrate:function(e){if(!e){p.Tb(Error("Cannot find element for celebrate Repl run confetti"));return}(y||U)&&b({element:e}),U&&N(!0)}}).celebrate,ed=el!==M.Ah.IDLE&&el!==M.Ah.RUNNING,ef=(0,E.Z)().showError,eh=(0,W.useRef)(null),ep=(H=(0,a._)(function(){var e,t,n,r,i,o,a,l;return(0,d.Jh)(this,function(c){switch(c.label){case 0:if(c.trys.push([0,3,,4]),el!==M.Ah.IDLE)return[3,2];return et&&et(),eh.current&&eu(eh.current),[4,Q.run(ee)];case 1:return c.sent(),es&&(0,D.j)(D.U3.PROJECT_RAN,{placement:"primary_btn",language:es.language,replId:es.id,replTitle:es.title,rootOriginReplUrl:es.rootOriginReplUrl,templateTitle:null===(n=es.source)||void 0===n?void 0:null===(t=n.release)||void 0===t?void 0:null===(e=t.repl)||void 0===e?void 0:e.title,templateOwner:null===(a=es.source)||void 0===a?void 0:null===(o=a.release)||void 0===o?void 0:null===(i=o.repl)||void 0===i?void 0:null===(r=i.owner)||void 0===r?void 0:r.username}),[2];case 2:if(el===M.Ah.RUNNING)return[2,Q.stopRun()];return[3,4];case 3:if(ef((l=c.sent()).toString()),R.kg.error("run button error",{errorMessage:l.message}),el===M.Ah.RUNNING)return[2,Q.stopRun()];return[3,4];case 4:return[2]}})}),function(){return H.apply(this,arguments)});if("floating"===er)return(0,f.tZ)(P.G,{tag:"button",disabled:ed,css:[{position:"fixed",right:24,bottom:72,zIndex:1},O.l0.center,{height:"50px",width:"50px",opacity:"0.5",cursor:"pointer",borderRadius:"100%",border:"solid 2px var(--accent-positive-dimmer)",backgroundColor:O.TV.accentPositiveDimmest}],onClick:ep,innerRef:eh,children:(0,f.tZ)(j,{runState:el})});var em=el===M.Ah.IDLE;return"inline-small"===er?(0,f.BX)("button",{"data-cy":"ws-run-btn",onClick:ep,ref:eh,disabled:ed,css:[O.l0.p(12),O.l0.flex.row,O.l0.center,O.l0.borderRadius(8),em?O.l0.backgroundColor.accentPositiveDimmest:O.l0.backgroundColor.backgroundHigher,em?O.l0.color.accentPositiveStronger:O.l0.color.foregroundDimmer,{border:"1px solid",borderColor:em?O.TV.accentPositiveDimmest:O.TV.backgroundHigher},O.l0.width("100%"),O.l0.height("100%")],children:[(0,f.tZ)(j,{runState:el}),(0,f.tZ)(G.xv,{variant:"subheadDefault",css:[O.l0.pl(8)],multiline:!1,children:q[el]})]}):(0,f.tZ)(B.u,{placement:"bottom",isDisabled:ei||!eo,tooltip:eo?(0,f.tZ)(F.bM,{keyCombo:eo,fontSize:12}):null,children:function(e,n){return(0,f.BX)("button",(0,s._)((0,c._)({},e),{onClick:ep,ref:(0,I.l)(eh,n,t),css:[J,!em&&K,O.l0.height(32),(0,l._)({transition:"width 80ms ease-out"},(0,X.et)("tabletMax"),O.l0.width(Y[el]))],children:[(0,f.tZ)(j,{runState:el,size:12}),(0,f.tZ)(G.xv,{multiline:!1,css:[O.l0.pl(6),O.l0.display.none,O.l0.fontWeight.medium,(0,l._)({lineHeight:1,overflow:"visible"},"@media (min-width: ".concat(A.j.tabletMax,"px)"),[O.l0.display.block])],children:q[el]})]}))}})})},68681:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(41733),i=n(30509),o=n(98924),a=n(74985),l=n(15146),c=n(93918),s=n(29287),u=(0,c.X)({checked:[s.l0.width(32),s.l0.height(32),s.l0.backgroundColor.backgroundHigher],unchecked:[s.l0.width(32),s.l0.height(32),s.l0.color.foregroundDimmest]});function d(e){var t=e.alt,n=e.icon,c=e.checked,s=e.onClick,d=(0,o._)(e,["alt","icon","checked","onClick"]);return(0,a.tZ)(l.hU,(0,i._)((0,r._)({},d),{css:c?u.checked:u.unchecked,alt:"".concat(c?"Disable":"Enable"," ").concat(t),onClick:s,children:n}))}},71984:function(e,t,n){n.d(t,{Z:function(){return d}});var r,i=n(42516),o=n(74985),a=n(43312),l=n(30983),c=n(52682),s=n(29287),u=(0,a.iv)([s.l0.focusRing,s.l0.display.flex,s.l0.center,s.l0.borderRadius(4),s.l0.backgroundColor.backgroundRoot,s.l0.color.foregroundDefault,s.l0.cursor.pointer,s.l0.p(4),(r={transition:"background-color 0.2s",border:"none"},(0,i._)(r,s.wl.hover,[s.l0.backgroundColor.backgroundHigher]),(0,i._)(r,":focus",{outline:"none"}),r)]),d=function(e){var t=e.onClick;return(0,o.tZ)(l.u,{tooltip:"Clear",placement:"bottom-start",children:(0,o.tZ)("button",{"aria-label":"Clear",onClick:t,css:u,children:(0,o.tZ)(c.Z,{size:16})})})}},19562:function(e,t,n){n.d(t,{j:function(){return C}});var r=n(27387),i=n(96583),o=n(74985),a=n(38931),l=n(25425),c=n(10041),s=n(48728),u=n(41859),d=n(73030),f=n(19408),h=n(25934),p=n(82723),m=n(41140),v=n(47030),g=n(29287),y=n(74652),b=n(27308),w=n(50959),Z=n(80259),x=n(83663);function C(e){var t,n,C,S,k,_,E,T,R,I,D,G,B=e.xterm,P=e.openAIWithMessage,A=e.openShellSearch,N=e.openSearchAndReplace,L=e.openGeneratePrompt,U=e.isOutputsTerminal,O=(n=(t={xterm:B,openAIWithMessage:P,openGeneratePrompt:L}).xterm,C=t.openAIWithMessage,S=t.openGeneratePrompt,k=(0,l.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1}),_=(0,l.P5)({controlName:"flag-ai-in-the-shell",logFlagToAnalytics:!1}),E=(0,y.gf)(x.CH.id),(0,w.useMemo)(function(){if(!k){var e=[];if(_&&S&&e.push({match:Z.pl,data:{type:"action",label:"Generate",icon:(0,o.tZ)(h.Z,{color:g.TV.blurpleStronger}),keyboardShortcut:E,run:function(){S()}}}),C&&e.push({match:Z.pl,data:{type:"action",label:"Explain",icon:(0,o.tZ)(f.Z,{color:g.TV.blurpleStronger}),run:function(){var e,t;C({type:"chat",text:(t=null!==(e=null==n?void 0:n._term.getSelection())&&void 0!==e?e:"","\nCan you explain this shell output?\n\n```\n".concat(t,"\n```\n"))})}}}),0!==e.length)return{data:{type:"context",label:"AI",icon:(0,o.tZ)(d.Z,{})},commands:function(){return e}}}},[_,k,C,E,S,null==n?void 0:n._term])),M=(R=(T={xterm:B,openShellSearch:A,openSearchAndReplace:N,isOutputsTerminal:void 0!==U&&U}).xterm,I=T.openShellSearch,D=T.openSearchAndReplace,G=T.isOutputsTerminal,(0,w.useMemo)(function(){var e=[];if(I){var t=G?(0,o.tZ)(v.Z,{}):(0,o.tZ)(m.Z,{});e.push({match:Z.pl,data:{type:"action",label:G?"Find in Console":"Find in Shell",icon:t,run:function(){var e;I(null!==(e=null==R?void 0:R._term.getSelection())&&void 0!==e?e:"")}}})}if(D&&e.push({match:Z.pl,data:{type:"action",label:"Find in Repl",icon:(0,o.tZ)(p.Z,{}),run:function(){var e;D(null!==(e=null==R?void 0:R._term.getSelection())&&void 0!==e?e:"")}}}),0!==e.length)return{data:{type:"context",label:"Search",icon:(0,o.tZ)(p.Z,{})},commands:function(){return e}}},[R,I,D,G])),X=(0,w.useMemo)(function(){return{data:{type:"context",label:"Clipboard",icon:(0,o.tZ)(s.Z,{})},commands:function(){return[{match:Z.pl,data:{type:"action",label:"Copy",icon:(0,o.tZ)(u.Z,{}),keyboardShortcut:(0,b.l2)({cmdOrCtrl:!0,key:"c"}),run:function(){var e,t=null!==(e=null==B?void 0:B._term.getSelection())&&void 0!==e?e:"";(0,c.Z)(t)}}},{match:Z.pl,data:{type:"action",label:"Paste",icon:(0,o.tZ)(s.Z,{}),keyboardShortcut:(0,b.l2)({cmdOrCtrl:!0,key:"v"}),run:function(){return(0,r._)(function(){var e,t;return(0,i.Jh)(this,function(n){switch(n.label){case 0:e="",n.label=1;case 1:return n.trys.push([1,3,,4]),[4,window.navigator.clipboard.readText()];case 2:return e=n.sent(),[3,4];case 3:return t=n.sent(),a.kg.error("Shell context menu paste failed",{message:t.message}),[2];case 4:return null==B||B._term.paste(e),[2]}})})()}}}]}}},[B]);return(0,w.useMemo)(function(){var e=[];return O&&e.push(O),M&&e.push(M),X&&e.push(X),{data:{type:"context",label:"Search actions",icon:(0,o.tZ)(p.Z,{})},commands:function(){return e}}},[O,M,X])}},14675:function(e,t,n){n.d(t,{R:function(){return s}});var r=n(74985),i=n(76999),o=n.n(i),a=n(29287),l=n(50831),c=n(50959);function s(e){var t=e.searchValue,n=e.setSearchValue,i=e.findNext,s=e.findPrevious,u=e.exit,d=(0,c.useRef)(null);(0,c.useEffect)(function(){d.current&&d.current.focus()},[]);var f=function(e){if("Escape"===e.key){u();return}"Enter"===e.key&&(e.shiftKey?s(t):i(t))};return(0,r.BX)("div",{className:"jsx-cae03adee2975d4 search",children:[(0,r.tZ)("input",{ref:d,placeholder:"Find",value:t,onChange:function(e){return n(e.target.value)},onKeyDown:function(e){return f(e)},css:[a.l0.focusRing],className:"jsx-cae03adee2975d4"}),(0,r.tZ)(l.Z,{size:"small",onClick:function(){return i(t)},children:"Next"}),(0,r.tZ)(l.Z,{size:"small",onClick:function(){return s(t)},children:"Previous"}),(0,r.tZ)(l.Z,{size:"small",onClick:u,children:"Exit"}),(0,r.tZ)(o(),{id:"cae03adee2975d4",children:".search.jsx-cae03adee2975d4{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;height:30px}input.jsx-cae03adee2975d4{padding:4px var(--space-8)var(--space-4);background-color:var(--background-default);color:var(--foreground-default);height:24px;width:85px;border:none;-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none}input.jsx-cae03adee2975d4::-webkit-input-placeholder{color:var(--foreground-default)}input.jsx-cae03adee2975d4:-moz-placeholder{color:var(--foreground-default)}input.jsx-cae03adee2975d4::-moz-placeholder{color:var(--foreground-default)}input.jsx-cae03adee2975d4:-ms-input-placeholder{color:var(--foreground-default)}input.jsx-cae03adee2975d4::-ms-input-placeholder{color:var(--foreground-default)}input.jsx-cae03adee2975d4::placeholder{color:var(--foreground-default)}input.jsx-cae03adee2975d4:focus{outline:none;border:var(--accent-primary-default)}input.jsx-cae03adee2975d4,.search button{margin:0 var(--space-4)}"})]})}},83663:function(e,t,n){n.d(t,{CH:function(){return m},Xd:function(){return y},bW:function(){return b}});var r=n(74985),i=n(25425),o=n(2038),a=n(74652),l=n(44478),c=n(50959),s=n(27308),u=n(74833),d=n(56596),f=n(93918),h=n(29287),p=n(1643),m={id:"shell.generateWithAI",name:"Generate with AI in the shell",default:(0,s.l2)({cmdOrCtrl:!0,key:"i"})},v=(0,f.X)({container:[h.l0.rowWithGap(2),h.l0.flex.row,h.l0.align.center,h.l0.textAlign.center,h.l0.cursor.pointer,h.l0.justify.end,{opacity:.6},h.l0.height("100%")],text:[h.l0.rowWithGap(4),h.l0.color.foregroundDimmest,h.l0.font.code],shortcut:[h.l0.ml(4),{"& > div > div":{fontSize:"0.8em",paddingLeft:(0,p.fP)(4),paddingRight:(0,p.fP)(4),paddingTop:(0,p.fP)(2),paddingBottom:(0,p.fP)(2)}}]}),g=function(e){var t=e.onClick,n=e.renderShortcut,i=e.shortcut;return(0,r.BX)(d.G,{css:v.container,onClick:function(e){e.stopPropagation(),t()},children:[(0,r.tZ)("div",{css:v.text,children:(0,r.tZ)(u.xv,{variant:"small",children:"Generate"})}),(0,r.tZ)("div",{css:v.shortcut,children:n&&i?(0,r.tZ)(a.bM,{keyCombo:i,small:!0}):null})]})},y=133;function b(e){var t=e.onOpenGeneratePrompt,n=e.onUpdateCurrentPromptLineNumber,s=(0,i.P5)({controlName:"flag-ai-in-the-shell",logFlagToAnalytics:!1}),u=(0,c.useRef)(null),d=(0,c.useRef)(null),f=(0,o.T3)(),h=(0,a.gf)(m.id),p=(0,c.useRef)(null);return(0,c.useCallback)(function(e,i){if("B"===i&&s){var o,a,c=e.buffer.active,m=c.cursorX,v=c.cursorY;n(v),u.current&&u.current.dispose(),d.current&&d.current.dispose(),p.current&&(p.current.unmount(),p.current=null),u.current=e.registerMarker(0),d.current=null!==(a=e.registerDecoration({marker:u.current,x:e.cols-14,width:14,layer:"top"}))&&void 0!==a?a:null,null===(o=d.current)||void 0===o||o.onRender(function(n){for(var i=!1,o=e.buffer.active._buffer.lines._array[v],a=m;a<e.cols;a++)if((null==o?void 0:o.hasContent(a))!==0){i=!0;break}var c=!i;p.current||(p.current=(0,l.createRoot)(n)),p.current.render(c?(0,r.tZ)(g,{onClick:function(){return t()},renderShortcut:!f,shortcut:h}):null)})}},[s,t,n,f,h])}},24837:function(e,t,n){n.d(t,{Z:function(){return W}});var r=n(66626),i=n(74985),o=n(23291),a=n(37951),l=n(74833),c=n(30983),s=n(54254),u=n(56596),d=n(29287),f=n(50959),h=n(31900),p=n(15542),m=n(25425),v=n(55534),g=n(44680),y=n(32377),b=n(52682),w=n(33988),Z=n.n(w),x=n(41733),C=n(21262),S=n(71440),k=n(55846),_=n(99165);function E(){var e=(0,C._)(["\n  mutation DeleteThreadMessage($id: String!) {\n    deleteThreadMessage(messageId: $id) {\n      ... on AnnotationAnchor {\n        id\n        ...AnnotationsUIAnchor\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return E=function(){return e},e}var T={},R=(0,S.Ps)(E(),k.j7),I=n(68333),D=n(25632),G=n(53326),B=n(33195),P=n(9100),A=n(42173),N=n(71253),L=n(66164),U=n(25462),O=n(43312),M=["a","pre","code","em","strong","p","ul","ol","li","img","del","h1","h2","h3","h4","h5","h6","sup","sub","br","hr","blockquote","span","div"],X=(0,f.memo)(function(e){var t=e.content,n=(0,D.Gn)("fontSize").preferences.fontSize,r=(0,f.useCallback)(function(e){return(0,i.tZ)(G.Z,(0,x._)({},e))},[]);return(0,i.tZ)("div",{css:[{"& ol":{paddingInlineStart:"20px"},"& ul":{paddingInlineStart:"20px",listStyle:"initial"}}],children:(0,i.tZ)(P.D,{css:(0,O.iv)({wordBreak:"break-word",boxSizing:"border-box",whiteSpace:"normal",lineHeight:1.5,color:d.TV.foregroundDefault,fontFamily:"".concat(d.TV.fontFamilyDefault," !important"),fontSize:n,textSizeAdjust:"100%","h1, h2, h3, h4, h5, h6":{color:d.TV.foregroundDefault,fontWeight:d.TV.fontWeightMedium,marginBottom:d.TV.space16,lineHeight:1.25,wordWrap:"break-word"},"h1, h2":{paddingBottom:d.TV.space8,borderBottom:"1px solid ".concat(d.TV.backgroundHigher),marginTop:d.TV.space32},h1:{fontSize:"2em"},h2:{fontSize:"1.5em"},h3:{fontSize:"1.25em",marginTop:d.TV.space24},h4:{fontSize:"1em",marginTop:d.TV.space16},h5:{fontSize:"0.875em"},h6:{color:d.TV.foregroundDimmer,fontSize:"0.85em"},".anchor":{float:"left",lineHeight:1,marginLeft:"calc(-1 * ".concat(d.TV.space16,")"),paddingRight:d.TV.space4},".anchor:focus":{outline:"none"},p:{marginBottom:d.TV.space16,fontSize:n,fontFamily:"".concat(d.TV.fontFamilyDefault," !important")},"p:last-child":{marginBottom:0},table:{borderSpacing:0,borderCollapse:"collapse",display:"block",width:"100%",overflow:"auto",marginBottom:d.TV.space16,wordBreak:"normal",th:{fontWeight:d.TV.fontWeightMedium},"td, th":{padding:"".concat(d.TV.space8," ").concat(d.TV.space12),border:"1px solid ".concat(d.TV.backgroundHighest),minWidth:"16ch"},tr:{backgroundColor:d.TV.backgroundDefault,borderTop:"1px solid ".concat(d.TV.backgroundHighest)},"tr:nth-of-type(2n)":{backgroundColor:d.TV.backgroundRoot}},"hr:after":{clear:"both"},"li > p":{marginBottom:0},li:{marginTop:d.TV.space4},dd:{marginLeft:0},"ol, ul":{paddingLeft:d.TV.space16,marginTop:0,marginBottom:0},ul:{listStyle:"initial",listStyleType:"disc",marginBottom:d.TV.space16},ol:{listStyle:"decimal",marginBottom:d.TV.space16},"ol ol, ol ul, ul ol, ul ul":{paddingLeft:d.TV.space16,marginTop:0,marginBottom:0,paddingBottom:0},"ul ul":{listStyleType:"circle"},"ul ul ul":{listStyleType:"square"},"ol ol, ul ol":{listStyleType:"lower-roman"},"ol ol ol, ol ul ol, ul ol ol, ul ul ol":{listStyleType:"lower-alpha"},pre:{fontFamily:"".concat(d.TV.fontFamilyCode," !important"),margin:"".concat(d.TV.space16," 0"),borderRadius:4,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",color:d.TV.foregroundDefault},"pre:last-child":{marginBottom:"0 !important"},blockquote:{padding:"0 1em",marginBottom:d.TV.space16,borderLeft:"".concat(d.TV.space2," solid ").concat(d.TV.backgroundHighest),paddingLeft:d.TV.space16},"blockquote > *":{color:"".concat(d.TV.foregroundDimmer," !important")},"blockquote > :last-child":{marginBottom:"0 !important",borderBottom:"none !important"},"blockquote > :first-child":{marginTop:"0 !important"},kbd:{display:"inline-block",padding:"3px 5px",font:"11px ".concat(d.TV.fontFamilyCode),color:d.TV.foregroundDimmer,verticalAlign:"middle",backgroundColor:d.TV.backgroundHigher,border:"none",borderRadius:3,boxShadow:"inset 0 -1px 0 ".concat(d.TV.backgroundHighest)},a:{color:d.TV.accentPrimaryStronger,backgroundColor:"initial"},"> :first-child":{marginTop:"0 !important",paddingTop:"0 !important"},"> :last-child":{borderBottom:"none !important",marginBottom:"0 !important",paddingBottom:"0 !important"},'[type="checkbox"]':{boxSizing:"border-box",marginRight:d.TV.space8,padding:0},details:{marginBottom:d.TV.space16,display:"block",background:d.TV.backgroundHigher,borderRadius:d.TV.borderRadius4,padding:d.TV.space16},summary:{display:"list-item",userSelect:"none",cursor:"pointer",fontWeight:d.TV.fontWeightBold},"details[open] > summary":{borderBottom:"1px solid ".concat(d.TV.backgroundHighest),marginBottom:d.TV.space16,paddingBottom:d.TV.space16},hr:{height:1,backgroundColor:d.TV.backgroundHigher,margin:"".concat(d.TV.space24," 0"),border:0}}),allowedElements:M,remarkPlugins:[I.Ic,L.Z,U.Z,N.Z],linkTarget:"_blank",rehypePlugins:[A.Z],components:{code:r,img:B.Z},children:t})})}),F=n(61657),W=(0,f.memo)(function(e){var t,n=e.thread,w=e.message,C=(0,p.d)(),S=(0,v.Z)().showError,k=(0,r._)((t=(0,x._)({},T,{onError:function(e){S(e.message)},onCompleted:function(e){var t;(null===(t=e.deleteThreadMessage)||void 0===t?void 0:t.__typename)==="UserError"&&S(e.deleteThreadMessage.message)}}),_.D(R,t)),2),E=k[0],I=k[1].loading,D=(0,m.P5)({controlName:"flag-threads-dropdown-menu",default:!1,type:"boolean",logFlagToAnalytics:!1}),G=!!(n&&n.indexStart===n.indexEnd),B={statusBanner:{resolved:"Thread resolved. Re-open it any time in the inbox.",unresolved:"Thread re-opened"},outdated:"Outdated",outdatedTooltip:"The code has changed since the comment was left"},P=(0,f.useMemo)(function(){return{diff:(0,F.Y)(w.timeCreated),full:(0,F.u)(w.timeCreated)}},[w]);if(!w.user)return null;var A=C===w.user.id?[{label:"Delete",icon:(0,i.tZ)(b.Z,{}),isDestructive:!0}]:[];return(0,i.BX)(u.G,{children:[(0,i.BX)(u.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.pb(4)],children:[(0,i.BX)(u.G,{css:[d.l0.flex.row,d.l0.align.center,d.l0.rowWithGap(8)],children:[(0,i.tZ)(Z(),{legacyBehavior:!0,passHref:!0,href:"/@".concat(w.user.username),children:(0,i.tZ)("a",{children:(0,i.tZ)(s.n,{small:!0,src:w.user.image,username:w.user.username})})}),(0,i.tZ)("p",{children:(0,i.tZ)(c.u,{tooltip:P.full,placement:"top",children:(0,i.tZ)(l.xv,{variant:"small",color:"dimmer",multiline:!1,children:P.diff})})}),A.length>0&&D?(0,i.tZ)(h.Z,{items:A,onItemClick:function(e){"Delete"!==e.label||I||E({variables:{id:w.id}})},label:"More"}):null]}),G?(0,i.tZ)(c.u,{tooltip:B.outdatedTooltip,children:(0,i.tZ)(o.D,{colorway:"negative",text:B.outdated})}):null]}),"StatusMessageContentType"===w.content.__typename&&"resolved"===w.content.status?(0,i.tZ)(a.E,{colorway:"positive",icon:(0,i.tZ)(y.Z,{}),text:B.statusBanner.resolved}):null,"StatusMessageContentType"===w.content.__typename&&"unresolved"===w.content.status?(0,i.tZ)(a.E,{colorway:"primary",icon:(0,i.tZ)(g.Z,{}),text:B.statusBanner.unresolved}):null,"TextMessageContentType"===w.content.__typename&&(0,i.tZ)(X,{content:w.content.text})]})})},61657:function(e,t,n){n.d(t,{Y:function(){return o},u:function(){return a}});var r=n(57526),i=n(20597),o=function(e){var t=new Date(e),n=new Date;return 60>(0,i.Z)(n,t)?"just now":(0,r.F)(t,!0)+" ago"},a=function(e){return new Date(e).toLocaleString()}},31105:function(e,t,n){n.d(t,{Z:function(){return eT}});var r=n(66626),i=n(74985),o=n(50782),a=n(15146),l=n(74833),c=n(56596),s=n(88936),u=n(99656),d=n(29287),f=n(9617),h=n(50959),p=n(46689),m=n(41733),v=n(30509),g=n(76999),y=n.n(g),b=n(73722),w=n(50831),Z=function(e){var t=e.onClick,n=e.hasTests,r=n?{"aria-label":"Delete all tests to switch test type","data-microtip-position":"bottom","data-microtip-size":"medium",role:"tooltip"}:{};return(0,i.BX)("div",(0,v._)((0,m._)({},r),{className:"jsx-44786ca38dd3aa42 "+(r&&null!=r.className&&r.className||"back-button"),children:[(0,i.tZ)(w.Z,{filled:!1,border:!1,size:"small",Icon:b.Z,onClick:t,disabled:n,children:"Switch test type"}),(0,i.tZ)(y(),{id:"44786ca38dd3aa42",children:".back-button.jsx-44786ca38dd3aa42{width:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}"})]}))},x=n(55534),C=n(59868),S=n(1498),k=n(70002),_=n(49344),E=n(44680),T=n(32377),R=n(79217),I=n(58003),D=n(75533),G=n(4687),B=n(20142),P=n(81013),A=D.q6.define();function N(e){var t=e.editorRef,n=e.onChange,r=e.placeholder,o=e.skeleton,a=e.language,l=e.skeletonClosingBracket,c=e.indentSize,s=(0,P.Z)(),u=s.ref,d=s.view,f=(0,h.useRef)(o?"".concat(o,"\n"):""),p=l?"\n".concat(l):"",m=" ".repeat(void 0===c?2:c);return(0,h.useEffect)(function(){if(d&&d.state.doc.length){var e=f.current;f.current=o?"".concat(o,"\n"):"",d.dispatch({changes:{from:0,to:e.length-1,insert:o},annotations:[D.YW.addToHistory.of(!1),A.of(!0)]})}},[d,o]),(0,h.useEffect)(function(){if(d){var e=D.yy.changeFilter.of(function(e){return!!e.annotation(A)||[-1,f.current.length,e.startState.doc.length-p.length,e.startState.doc.length+1]}),i=G.tk.updateListener.of(function(e){var t=e.state.doc.slice(f.current.length,e.state.doc.toString().length-p.length).toString();if(t!=="".concat(m).concat(r,"\n").concat(m)?n(t):n(""),e.docChanged&&e.state.doc.length===f.current.length+p.length){var i="\n"+m;d.dispatch({changes:{from:f.current.length-1,insert:"\n"+m},selection:{anchor:f.current.length+i.length-1},annotations:[A.of(!0)]})}}),o="".concat(f.current).concat(m).concat(r,"\n").concat(p);d.dispatch({changes:{from:0,to:d.state.doc.length,insert:o},effects:D.Py.appendConfig.of([e,i]),selection:{anchor:o.length},annotations:D.YW.addToHistory.of(!1)}),t({setValue:function(e){if(e){var t=d.state.doc.toString().length;d.dispatch({changes:{from:f.current.length,to:t-p.length,insert:e},annotations:D.YW.addToHistory.of(!1)})}},focus:function(){return d.focus()}})}},[n,a,d,p,t,r,m]),(0,i.BX)("div",{className:"jsx-c0a72647b9c20ef editor",children:[(0,i.tZ)(B.ZP,{ref:u,language:a,indentSize:2,fontSize:14,indentIsSpaces:!0}),(0,i.tZ)(y(),{id:"c0a72647b9c20ef",children:".editor.jsx-c0a72647b9c20ef{overflow:auto;position:absolute;width:100%;height:100%}.loader.jsx-c0a72647b9c20ef{height:100%;width:100%;z-index:5}"})]})}var L=n(68809),U=n(79962);function O(e){var t,n,a,s,u=e.isOpen,f=e.meta,p=e.language,g=e.hasMetadata,y=e.onClose,b=(0,o.Z)(),w=(0,x.Z)().showConfirm,Z=(0,r._)((0,h.useState)(null),2),k=Z[0],E=Z[1],I=(0,r._)((0,h.useState)(!0),2),D=I[0],G=I[1],B=(0,r._)((0,h.useState)((null==f?void 0:f.initialization)||""),2),P=B[0],A=B[1],N=(0,r._)((0,h.useState)((null==f?void 0:f.imports)||""),2),O=N[0],H=N[1],V=(0,r._)((0,h.useState)((null==f?void 0:f.setup)||""),2),z=V[0],j=V[1],q=(0,r._)((0,h.useState)((null==f?void 0:f.tearDown)||""),2),Y=q[0],J=q[1],K=(0,r._)((0,U.rU)({onError:function(e){return E(e.message)},update:function(e,t){var n,r=null===(n=t.data)||void 0===n?void 0:n.createReplUnitTestMeta;r&&("UserError"===r.__typename?E(r.message):"ReplUnitTestMeta"===r.__typename&&(e.modify({id:e.identify({__typename:"Repl",id:b}),fields:{unitTests:function(t){var n=e.writeFragment({data:r,fragment:U.aA});return t?(0,v._)((0,m._)({},t),{meta:(0,m._)({},n)}):{__typename:"ReplUnitTestsWithMeta",meta:n,tests:[]}}}}),w("Setup saved!"),y()))}}),2),$=K[0],Q=K[1],ee=(0,r._)((0,U.AF)({onError:function(e){return E(e.message)},onCompleted:function(e){var t=e.updateReplUnitTestMeta;t&&("UserError"===t.__typename?E(t.message):"ReplUnitTestMeta"===t.__typename&&(w("Imports updated!"),y()))}}),2),et=ee[0],en=ee[1],er=(0,L.x)(p),ei=O!==(null==f?void 0:f.imports)||P!==(null==f?void 0:f.initialization)||z!==(null==f?void 0:f.setup)||Y!==(null==f?void 0:f.tearDown),eo=Q.loading||en.loading;return(0,i.tZ)(_.u,{isOpen:u,onRequestClose:y,maxWidth:872,children:(0,i.BX)(c.G,{css:[d.l0.colWithGap(24)],children:[(0,i.tZ)(l.h4,{level:1,variant:"headerDefault",children:"Setup"}),(0,i.tZ)(M,{unitTestsLib:er,onChange:H,language:p,initialValue:null!==(t=null==f?void 0:f.imports)&&void 0!==t?t:""}),(0,i.tZ)(c.G,{onClick:function(){return G(!D)},css:{cursor:"pointer"},children:(0,i.BX)(c.G,{css:[d.l0.rowWithGap(8),d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"headerDefault",children:"Advanced"}),(0,i.tZ)(R.Z,{color:"var(--foreground-default)",size:20,rotate:D?270:0})]})}),D?null:(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.tZ)(X,{unitTestsLib:er,onChange:A,language:p,initialValue:null!==(n=null==f?void 0:f.initialization)&&void 0!==n?n:""}),(0,i.tZ)(F,{unitTestsLib:er,onChange:j,language:p,initialValue:null!==(a=null==f?void 0:f.setup)&&void 0!==a?a:""}),(0,i.tZ)(W,{unitTestsLib:er,onChange:J,language:p,initialValue:null!==(s=null==f?void 0:f.tearDown)&&void 0!==s?s:""})]}),(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween],children:[(0,i.tZ)(l.xv,{css:[d.l0.color.accentNegativeStronger],children:k}),(0,i.BX)(c.G,{css:[d.l0.rowWithGap(12)],children:[(0,i.tZ)(S.zx,{disabled:eo,onClick:y,text:"Cancel"}),(0,i.tZ)(S.zx,{colorway:"primary",disabled:!ei||eo,onClick:function(){(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{action:"modifiedSetup"}),g?et({variables:{input:{initialization:P,imports:O,setup:z,tearDown:Y,replId:b}}}):$({variables:{input:{initialization:P,imports:O,setup:z,tearDown:Y,replId:b}}})},iconLeft:(0,i.tZ)(T.Z,{}),text:"".concat(eo?"Saving...":"Save")})]})]})]})})}function M(e){var t=e.unitTestsLib,n=e.onChange,o=e.language,a=e.initialValue,s=(0,r._)((0,h.useState)(null),2),u=s[0],f=s[1];(0,h.useEffect)(function(){u&&(u.setValue(a),u.focus())},[u,a]);var p=t.defaultImports().trim();return(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Imports"}),(0,i.tZ)(k.Z,{iconLeft:(0,i.tZ)(E.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add imports here"),editorRef:f,language:o,skeleton:p,skeletonClosingBracket:"",indentSize:0})})})]})}function X(e){var t=e.unitTestsLib,n=e.onChange,o=e.language,a=e.initialValue,s=(0,r._)((0,h.useState)(null),2),u=s[0],f=s[1];(0,h.useEffect)(function(){u&&u.setValue(a)},[u,a]);var p=t.classConstructorName();return(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Initialization"}),(0,i.tZ)(k.Z,{iconLeft:(0,i.tZ)(E.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),p?(0,i.BX)(l.xv,{children:["Hint: constructor name is ",(0,i.tZ)("code",{children:p}),"."]}):null,(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add initialization code here"),editorRef:f,language:o,skeleton:"",skeletonClosingBracket:"",indentSize:0})})})]})}function F(e){var t=e.unitTestsLib,n=e.onChange,o=e.language,a=e.initialValue,s=(0,r._)((0,h.useState)(null),2),u=s[0],f=s[1];(0,h.useEffect)(function(){u&&u.setValue(a)},[u,a]);var p=t.setupIntro().trim();return(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Setup"}),(0,i.tZ)(k.Z,{iconLeft:(0,i.tZ)(E.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add setup code here"),editorRef:f,language:o,skeleton:p,skeletonClosingBracket:t.hasClosingBrackets()?t.getClosingBrackets():""})})})]})}function W(e){var t=e.unitTestsLib,n=e.onChange,o=e.language,a=e.initialValue,s=(0,r._)((0,h.useState)(null),2),u=s[0],f=s[1];(0,h.useEffect)(function(){u&&u.setValue(a)},[u,a]);var p=t.tearDownIntro().trim();return(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Teardown"}),(0,i.tZ)(k.Z,{iconLeft:(0,i.tZ)(E.Z,{}),text:"Docs",href:"https://docs.replit.com/teams-edu/unit-testing",target:"_blank",variant:"outlined"})]}),(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{onChange:n,placeholder:"".concat(t.getCommentChar()," Add teardown code here"),editorRef:f,language:o,skeleton:p,skeletonClosingBracket:t.hasClosingBrackets()?t.getClosingBrackets():""})})})]})}var H=function(e){var t=e.language,n=e.meta,o=(0,r._)((0,h.useState)(!1),2),a=o[0],l=o[1];return(0,i.BX)(i.HY,{children:[(0,i.tZ)(S.zx,{iconLeft:(0,i.tZ)(I.Z,{}),onClick:function(){return l(!0)},text:"Setup"}),(0,i.tZ)(O,{language:t,isOpen:a,onClose:function(){return l(!1)},hasMetadata:!!(null==n?void 0:n.id),meta:n})]})},V=n(63257),z=n(95891),j=n(72310),q=n(18836),Y=n(85508),J=n(58719),K=n(2158),$=n(52924),Q=n(52682),ee=n(98924),et=n(43312),en=n(15006),er=n(20573),ei=n(10981),eo={success:(0,et.iv)({":not([disabled])":{borderColor:d.TV.accentPositiveStrongest}}),error:(0,et.iv)({":not([disabled])":{borderColor:d.TV.accentNegativeStrongest}}),warning:(0,et.iv)({":not([disabled])":{borderColor:d.TV.yellowStrongest}}),default:void 0,loading:void 0},ea={success:(0,et.iv)([{color:d.TV.accentPositiveStrongest}]),error:(0,et.iv)([{color:d.TV.accentNegativeStrongest}]),warning:(0,et.iv)([{color:d.TV.yellowStrongest}]),default:void 0,loading:void 0},el={success:(0,i.tZ)(T.Z,{}),error:(0,i.tZ)(en.Z,{}),warning:(0,i.tZ)(er.Z,{}),default:void 0,loading:(0,i.tZ)(s.Z,{})},ec=function(e){var t=el[e.state];return(0,i.BX)(c.G,{css:[ea[e.state],d.l0.rowWithGap(4)],children:[h.isValidElement(t)?h.cloneElement(t,{size:12}):null,(0,i.tZ)(l.xv,{variant:"small",multiline:!1,children:e.message})]})},es=(0,et.iv)("display:grid;grid-gap:",d.TV.space8,";grid-template-areas:'label . status'\n    'input input input'\n    'validation validation validation'\n    'details details details';> .label{grid-area:label;}> .status{grid-area:status;}> .input{grid-area:input;}> .details{grid-area:details;}> .validation{grid-area:validation;}"),eu=function(e){var t,n=e.id,r=e.label,o=e.status,a=e.description,c=e["aria-describedby"],s=e.error,u=e.isValid,f=e.touched,h=e.value,p=e.warning,g=e.successText,y=(0,ee._)(e,["id","label","status","description","aria-describedby","error","isValid","touched","value","warning","successText"]),b=(0,ei.U)(),w=n||b("input"),Z=o&&b("status"),x=a?b("description"):void 0,C=[Z,x,c].filter(Boolean).join(" "),S=!(t={description:a,error:s,isValid:u,touched:f,value:h,warning:p,successText:g}).touched&&t.description?{state:"default",message:t.description}:t.error?{message:t.error.message,state:"error"}:t.warning?{message:t.warning.message,state:"warning"}:t.isValid?{message:t.successText||"",state:"success"}:t.touched?{message:"",state:"loading"}:void 0;return(0,i.BX)("div",{css:es,children:[(0,i.tZ)("label",{htmlFor:w,className:"label",children:(0,i.tZ)(l.xv,{variant:"small",color:"dimmer",multiline:!1,children:r})}),o?(0,i.tZ)(l.xv,{multiline:!1,variant:"small",color:"dimmer",css:[d.l0.textAlign.right],className:"status",children:o}):null,(0,i.tZ)(q.II,(0,v._)((0,m._)({id:w,className:"input",value:h,css:[eo[(null==S?void 0:S.state)||"default"]]},y),{"aria-describedby":C,"aria-invalid":(null==S?void 0:S.state)==="error"})),(0,i.tZ)("div",{id:x,className:"validation",css:[ea[(null==S?void 0:S.state)||"default"]],"aria-live":(null==S?void 0:S.state)!=="default"?"polite":void 0,children:S?(0,i.tZ)(ec,(0,m._)({},S)):null})]})},ed=n(75582),ef=n(27387),eh=n(96583),ep=n(43182),em=n(15250),ev=n(18107),eg=n(54916),ey=n(59109),eb="\x1b[0;31m",ew="\x1b[0m",eZ=["","","","","","","","","","","","","","","",""];function ex(e){var t=e.name,n=e.failureMessage,r=e.stack;return"	".concat(eb).concat(t).concat(ew,"\r").concat(n?"\nMessage: ".concat(n,"\r"):"","\nStack Trace:\r\n").concat(r.replace(/\n/g,"\r\n"),"\n\r\n\r\n")}var eC=function(e){var t,n,o=e.language,a=e.unitTests,l=e.onResult,s=e.trackingContext,u=e.getRunnerOutput,d=(0,r._)((0,h.useState)(!1),2),f=d[0],p=d[1],v=(0,eg.Z)(),g=v.container,y=v.packager,b=v.fs,w=null,Z=u(),x=Z&&void 0!==Z.startBlock&&void 0!==Z.endBlock&&void 0!==Z.writeOutputToBlock&&void 0!==Z.writeErrorToBlock,k=function(){p(!1),(0,ey.WT)(b),w&&(w.stopLogSpinner(),w.finish(),w=null)},_=(t=(0,ef._)(function(){var e,t,n,r,i,c,u,d,h,v,S,_,E,T,R,I,D,G,B,P,A,N,U,O;return(0,eh.Jh)(this,function(M){switch(M.label){case 0:if(f)return[2];if(t=null,w={startLogSpinner:function(e){if(t)throw Error("A spinner is already active! call stopSpinner first or use the update callback to update the active spinner's message.");var n=e,r=0;return t=setInterval(function(){var e=eZ[++r%eZ.length];if(!w)throw Error("Expected logger");w.clearLine(),w.logMessage(e+" "+n)},100),function(e){n=e}},stopLogSpinner:function(){t&&clearInterval(t),t=null},finish:function(){if(x&&e){var t;null==Z||null===(t=Z.endBlock)||void 0===t||t.call(Z,e)}},logMessage:function(t){var n,r;if(x&&e){null==Z||null===(r=Z.writeOutputToBlock)||void 0===r||r.call(Z,e,t);return}null==Z||null===(n=Z.write)||void 0===n||n.call(Z,t)},logError:function(t){if(x&&e){var n;null==Z||null===(n=Z.writeErrorToBlock)||void 0===n||n.call(Z,e,t)}},clearLogs:function(){var e;x||(null==Z||null===(e=Z.clear)||void 0===e||e.call(Z),null==w||w.logMessage("\r\n"))},clearLine:function(){if(!w)throw Error("Expected logger");w.logMessage("\x1b[1K\r")}},!a)throw Error("Run button should not be active if there are no tests");return p(!0),(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{trackingData:{context:s},action:"ranTests"}),w.clearLogs(),x&&(e=null==Z?void 0:null===(n=Z.startBlock)||void 0===n?void 0:n.call(Z,ev.kH.UNIT_TEST).id),[4,(r=(0,L.x)(o)).buildAndRunTests((0,m._)({container:g,fs:b,packager:y,logger:w},a))];case 1:if(i=M.sent(),w.stopLogSpinner(),w.clearLine(),w.clearLogs(),null!==i.error)return w.logMessage("".concat(eb).concat(i.error).concat(ew,"\r\n")),k(),a.tests.map(function(e){return{testId:e.id,didPass:!1}}),[2];if(c=i.result.passed?[]:i.result.failures.map(function(e){return r.parseTestResultName(e.name)}),u=[],d=a.tests.map(function(e){return r.getProperTestName(e.name)}),(h=c.filter(function(e){return!d.includes(e)})).length)S=h[0],_=i.result.failures[0].stack,w.logMessage(ex({name:S,failureMessage:"The following error occurred but was not related to a single unit test",stack:_})),w.logError("Testing failed"),(v=u).push.apply(v,(0,V._)(a.tests.map(function(e){return{testId:e.id,didPass:!1}})));else{E=!0,T=!1,R=void 0;try{for(I=a.tests[Symbol.iterator]();!(E=(D=I.next()).done);E=!0){if(G=D.value,B=r.getProperTestName(G.name),P=c.indexOf(B),A=-1===P,u.push({testId:G.id,didPass:A}),A){w.logMessage("	".concat("\x1b[0;32m").concat(B).concat(ew,"\r\n\r\n"));continue}N=i.result.failures[P].stack,w.logMessage(ex({name:B,failureMessage:G.failureMessage,stack:N})),w.logError('Test "'.concat(B,'" failed'))}}catch(e){T=!0,R=e}finally{try{E||null==I.return||I.return()}finally{if(T)throw R}}}if(l(u),U=a.tests.length,i.result.passed)return w.logMessage("".concat("\x1b[48;5;22m","  All tests have passed ").concat(U,"/").concat(U,"  ").concat(ew,"\r\n")),k(),[2];return O=U-i.result.failures.length,w.logMessage("".concat("\x1b[48;5;88m","  ").concat(O,"/").concat(U," passed, see errors above  ").concat(ew)),k(),[2]}})}),function(){return t.apply(this,arguments)}),E=(n=(0,ef._)(function(){return(0,eh.Jh)(this,function(e){try{_()}catch(e){ep.$e(function(t){t.setTag("unittestsrun","true"),ep.Tb(e)}),w&&(w.logMessage("\r\n".concat(eb," Sorry, we have failed to run your tests. Please try again or contact support. ").concat(ew,"\r\n")),w.logError("Running tests failed")),k()}return[2]})}),function(){return n.apply(this,arguments)});return a&&a.tests.length>0?(0,i.tZ)(c.G,{children:(0,i.tZ)(S.zx,{disabled:f,colorway:"primary",iconLeft:(0,i.tZ)(em.Z,{}),onClick:E,text:f?"Running tests...":"Run tests"})}):null};function eS(e){var t=e.isOpen,n=e.test,a=e.language,s=e.onClose,f=e.trackingContext,p=(0,o.Z)(),g=(0,x.Z)().showConfirm,y=(0,r._)((0,h.useState)(null),2),b=y[0],w=y[1],Z=(0,r._)((0,h.useState)(""),2),E=Z[0],R=Z[1],I=(0,r._)((0,h.useState)(""),2),D=I[0],G=I[1],B=(0,r._)((0,h.useState)(""),2),P=B[0],A=B[1],O=(0,r._)((0,U.Hd)({onError:function(e){return A(e.message)},update:function(e,t){var n,r=null===(n=t.data)||void 0===n?void 0:n.createReplUnitTest;r&&("UserError"===r.__typename?A(r.message):"ReplUnitTest"===r.__typename&&(e.modify({id:e.identify({__typename:"Repl",id:p}),fields:{unitTests:function(t){var n=e.writeFragment({data:r,fragment:U.Rb});return t?(0,v._)((0,m._)({},t),{tests:(0,V._)(t.tests).concat([n])}):{__typename:"ReplUnitTestsWithMeta",meta:null,tests:[n]}}}}),g("Test created!"),s()))}}),2),M=O[0],X=O[1],F=(0,r._)((0,U.kO)({onError:function(e){return A(e.message)},onCompleted:function(e){var t=e.updateReplUnitTest;t&&("UserError"===t.__typename?A(t.message):"ReplUnitTest"===t.__typename&&(g("Test updated!"),s()))}}),2),W=F[0],H=F[1],$=(0,j.Y)("",function(e){return e.length<=0?{message:"Must include test name"}:e.trim().split(" ").length>1?{message:"Test name must only be one word"}:void 0});(0,h.useEffect)(function(){$.setValue((null==n?void 0:n.name)||"",{preventTouch:!0}),G((null==n?void 0:n.failureMessage)||""),R((null==n?void 0:n.code)||""),b&&b.setValue((null==n?void 0:n.code)||"")},[n,b]),(0,h.useEffect)(function(){A("")},[E,A]);var Q=(0,L.x)(a),ee="".concat(Q.getCommentChar()," Enter code here"),et=!n||n.name!==$.value||n.code!==E||n.failureMessage!==D,en=X.loading||H.loading,er=Q.testIntro($.value||""),ei=Q.hasClosingBrackets()?Q.getClosingBrackets():"",eo=(0,r._)((0,h.useState)(!1),2),ea=eo[0],el=eo[1],ec=function(){b&&(b.setValue("  "+Q.exampleTest.code),b.focus()),R(Q.exampleTest.code)};return(0,i.tZ)(_.u,{isOpen:t,onRequestClose:s,maxWidth:872,children:(0,i.BX)(c.G,{css:[d.l0.colWithGap(24)],children:[(0,i.tZ)(l.h4,{level:1,variant:"headerDefault",children:"New unit test"}),(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.tZ)("label",{htmlFor:"name",children:(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Name"})}),(0,i.tZ)(eu,{id:"name",label:"Test name",status:null,autoFocus:!0,required:!0,value:$.value,isValid:$.isValid,error:$.error,warning:$.warning,touched:$.touched,onChange:function(e){$.setValue(e.target.value)},placeholder:"Enter test name here"})]}),(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.align.center,d.l0.justify.spaceBetween],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Code"}),(0,i.BX)(c.G,{css:[d.l0.rowWithGap(4)],children:[(0,i.BX)(z.Z,{isOpen:ea,onClickOutside:function(){return el(!1)},placement:"bottom-end",children:[(0,i.tZ)(S.zx,{iconLeft:(0,i.tZ)(K.Z,{}),size:"small",variant:"outlined",text:"View an example",onClick:function(){if([ee,Q.exampleTest.code].includes(E.trim())){ec();return}el(!0)}}),(0,i.BX)(c.G,{children:["This will overwrite your current test. Are you sure?",(0,i.BX)(c.G,{css:[d.l0.rowWithGap(4),d.l0.pt(8)],children:[" ",(0,i.tZ)(S.zx,{text:"No, go back",size:"small",iconLeft:(0,i.tZ)(J.Z,{}),onClick:function(){el(!1)}}),(0,i.tZ)(S.zx,{text:"Yes, delete test",colorway:"negative",size:"small",iconLeft:(0,i.tZ)(T.Z,{}),onClick:function(){ec(),el(!1)}})]})]})]}),(0,i.tZ)(k.Z,{iconLeft:(0,i.tZ)(Y.Z,{}),size:"small",variant:"outlined",text:"View docs",target:"_blank",href:"https://docs.replit.com/teams-edu/unit-testing"})]})]}),(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.borderRadius(8),{border:"1px solid var(--background-highest)"}],children:(0,i.tZ)(c.G,{css:[d.l0.borderRadius(8),d.l0.height(200),d.l0.position.relative],children:(0,i.tZ)(N,{skeleton:er,skeletonClosingBracket:ei,language:a,editorRef:w,onChange:R,placeholder:ee})})})]}),(0,i.BX)(c.G,{css:[d.l0.colWithGap(8)],children:[(0,i.tZ)(l.h4,{level:2,variant:"subheadDefault",children:"Failure message"}),(0,i.tZ)(q.II,{value:D,onChange:function(e){return G(e.target.value)},placeholder:"This will be displayed on test failure"})]}),(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.align.center,d.l0.justify.spaceBetween],children:[(0,i.tZ)(l.xv,{css:[d.l0.color.accentNegativeStronger],multiline:!1,children:P}),(0,i.BX)(c.G,{css:[d.l0.rowWithGap(12)],children:[(0,i.tZ)(S.zx,{text:"Cancel",onClick:s}),(0,i.tZ)(S.zx,{text:"".concat(en?"Creating test...":"Create test"),iconLeft:(0,i.tZ)(u.Z,{}),colorway:"primary",disabled:!et||en,onClick:function(){if(!$.validate()){if(E.length<=0){A("Test cannot be empty");return}n?(W({variables:{input:{name:$.value,code:E,failureMessage:D,testId:n.id}}}),(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{trackingData:{context:f},action:"modifiedTest"})):(M({variables:{input:{name:$.value,code:E,failureMessage:D,replId:p}}}),(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{trackingData:{context:f},action:"addedTest"}))}}})]})]})]})})}function ek(e){var t=e.testId,n=e.onClose,a=(0,x.Z)().showConfirm,s=(0,o.Z)(),u=(0,r._)((0,U.IV)({onError:function(e){return b(e.message)},update:function(e,r){var i,o=null===(i=r.data)||void 0===i?void 0:i.deleteReplUnitTest;o&&("UserError"===o.__typename?b(o.message):"ReplUnitTest"===o.__typename&&t&&(e.modify({id:e.identify({__typename:"Repl",id:s}),fields:{unitTests:function(e,n){var r=n.readField,i=e.tests.filter(function(e){return r("id",e)!==t});return(0,v._)((0,m._)({},e),{tests:(0,V._)(i)})}}}),(0,C.j)(C.U3.REPL_UNIT_TEST_USED,{action:"removedTest"}),a("Test deleted!"),n()))}}),2),f=u[0],p=u[1],g=(0,r._)((0,h.useState)(""),2),y=g[0],b=g[1];return(0,i.tZ)(_.u,{isOpen:!!t,onRequestClose:n,children:(0,i.BX)(c.G,{css:[d.l0.colWithGap(24)],children:[(0,i.tZ)(l.h4,{level:1,variant:"headerDefault",children:"Delete test?"}),(0,i.tZ)(l.xv,{children:"Are you sure you want to delete this test? This cannot be undone."}),(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center],children:[(0,i.tZ)(l.xv,{css:[d.l0.color.accentNegativeStronger],children:y}),(0,i.BX)(c.G,{css:[d.l0.rowWithGap(12),d.l0.justify.end],children:[(0,i.tZ)(S.zx,{text:"Cancel",disabled:p.loading,onClick:n}),(0,i.tZ)(S.zx,{text:"Yes, delete this test",colorway:"negative",iconLeft:(0,i.tZ)(Q.Z,{}),disabled:p.loading,onClick:function(){if(!t)throw Error("Expected a testId");f({variables:{testId:t}})}})]})]})]})})}var e_=function(e){var t=e.unitTests,n=e.isAddingTest,s=e.onClose,f=e.language,p=e.canWrite,m=e.trackingContext,v=void 0===m?"default":m,g=e.getRunnerOutput,b=(0,r._)((0,h.useState)(n),2),w=b[0],Z=b[1],x=(0,r._)((0,h.useState)(null),2),C=x[0],k=x[1],_=(0,r._)((0,h.useState)(null),2),E=_[0],T=_[1],R=(0,o.Z)(),I=(0,r._)((0,U.lQ)(),1)[0],D=(null==t?void 0:t.tests)||[];return(0,i.BX)(c.G,{css:[d.l0.colWithGap(16)],children:[(0,i.tZ)(eC,{language:f,unitTests:t,onResult:function(e){I({variables:{input:{replId:R,results:e},replId:R}})},getRunnerOutput:g,trackingContext:v}),D.length>0?(0,i.tZ)(c.G,{css:[d.l0.colWithGap(8),d.l0.align.center],children:D.map(function(e){var t,n;return(null===(t=e.lastRun)||void 0===t?void 0:t.__typename)==="ReplUnitTestLastRun"&&(e.lastRun.status===ed.$I.Passed?n="passed-test":e.lastRun.status===ed.$I.Failed&&(n="failed-test")),(0,i.tZ)(c.G,{className:"test ".concat(n),css:{width:"100%"},children:(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center,d.l0.p(8),d.l0.borderRadius(8),{border:"1px solid var(--background-highest);"}],children:[(0,i.tZ)(l.xv,{multiline:!1,children:e.name}),p?(0,i.BX)(c.G,{css:[d.l0.rowWithGap(8)],children:[(0,i.tZ)(a.hU,{onClick:function(){k(e)},alt:"Edit",children:(0,i.tZ)($.Z,{})}),(0,i.tZ)(a.hU,{onClick:function(){T(e.id)},alt:"Delete",children:(0,i.tZ)(Q.Z,{})})]}):null]})},e.id)})}):(0,i.BX)(c.G,{css:[d.l0.colWithGap(8),d.l0.align.center],children:[(0,i.tZ)(l.xv,{css:[d.l0.textAlign.center],children:"Looks like you dont have any tests yet!"}),p?(0,i.tZ)(S.zx,{text:"Add test",onClick:function(){return Z(!0)},iconLeft:(0,i.tZ)(u.Z,{})}):null]}),(0,i.tZ)(eS,{isOpen:w||!!C||n,test:C,language:f,onClose:function(){k(null),Z(!1),s&&s()},trackingContext:v}),(0,i.tZ)(ek,{testId:E,onClose:function(){return T(null)}}),(0,i.tZ)(y(),{id:"a2df1ed8108a6cad",children:".tests-wrapper.jsx-a2df1ed8108a6cad{-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4);padding:var(--space-16)0;width:100%}.test.jsx-a2df1ed8108a6cad{padding:var(--space-8)var(--space-8);border:1px solid var(--outline-dimmest);-webkit-border-radius:var(--border-radius-4);-moz-border-radius:var(--border-radius-4);border-radius:var(--border-radius-4)}.passed-test.jsx-a2df1ed8108a6cad{border-color:var(--accent-positive-default);background:var(--accent-positive-dimmer)}.failed-test.jsx-a2df1ed8108a6cad{border-color:var(--accent-negative-default);background:var(--accent-negative-dimmer)}"})]})},eE=n(31593),eT=function(e){var t,n,m,v,g=e.onBack,y=e.getRunnerOutput,b=(0,o.Z)(),w=(0,r._)((0,h.useState)(!1),2),x=w[0],C=w[1],S=(0,eE.Z)(),k=S.language,_=S.isLoading,E=(0,p.CH)({variables:{replId:b}}),T=null===(t=E.data)||void 0===t?void 0:t.repl;if(E.loading||_)return(0,i.tZ)(c.G,{css:[d.l0.backgroundColor.backgroundDefault,d.l0.flex.row,d.l0.align.center,d.l0.justify.center,d.l0.p(16)],children:(0,i.tZ)(s.Z,{})});if(!T||"Repl"!==T.__typename)return(0,i.tZ)(c.G,{css:[d.l0.p(16)],children:(0,i.tZ)(l.xv,{css:{textAlign:"center"},children:"Unable to fetch tests, please try again."})});if(!k)return(0,i.tZ)(c.G,{css:[d.l0.p(16)],children:(0,i.tZ)(l.xv,{css:{textAlign:"center"},children:"Unit tests are currently only supported in Java, Python, and Node.js Repls."})});var R="default";(null==T?void 0:T.isProject)?R="project_repl":(null==T?void 0:T.isProjectFork)&&(R="submission_repl");var I=!!((null===(n=T.unitTests)||void 0===n?void 0:n.tests)&&T.unitTests.tests.length>0);return(null==T?void 0:null===(m=T.currentUserPermissions)||void 0===m?void 0:m.writeTests)?(0,i.BX)(c.G,{css:[d.l0.colWithGap(16),d.l0.align.center],children:[(0,i.BX)(c.G,{css:[d.l0.flex.row,d.l0.justify.spaceBetween,d.l0.align.center,{width:"100%"}],children:[(0,i.tZ)(f.Z,{truncate:!0,level:4,children:"Unit tests"}),(0,i.tZ)(a.hU,{alt:"Add test",size:32,onClick:function(){return C(!0)},children:(0,i.tZ)(u.Z,{})})]}),(0,i.BX)(c.G,{css:[d.l0.colWithGap(8),d.l0.maxWidth(256),{width:"80%"}],children:[(0,i.tZ)(H,{language:k,meta:(null===(v=T.unitTests)||void 0===v?void 0:v.meta)||null}),(0,i.tZ)(e_,{isAddingTest:x,unitTests:(null==T?void 0:T.unitTests)||null,onClose:function(){return C(!1)},language:k,canWrite:!0,trackingContext:R,getRunnerOutput:y}),g?(0,i.tZ)(Z,{hasTests:I,onClick:g}):null]})]}):(0,i.BX)(c.G,{css:[d.l0.colWithGap(16)],children:[(0,i.tZ)(l.h4,{level:1,variant:"headerDefault",children:"Unit tests"}),(0,i.tZ)(c.G,{css:{width:"100%",overflowY:"auto"},children:(0,i.tZ)(e_,{unitTests:(null==T?void 0:T.unitTests)||null,language:k,isAddingTest:!1,canWrite:!1,trackingContext:R,getRunnerOutput:y})})]})}},68809:function(e,t,n){n.d(t,{x:function(){return E},y:function(){return _}});var r=n(27387),i=n(63257),o=n(96583),a=n(51305),l=n(43182),c=n(59868),s=n(12285),u=function(){"use strict";function e(t){(0,s._)(this,e),this.code="",this.currentIndent=0,this.lib=t}var t=e.prototype;return t.indent=function(){this.currentIndent+=1},t.dedent=function(){if(0===this.currentIndent)throw Error("indent at zero");this.currentIndent-=1},t.addIndents=function(){for(var e=0;e<this.currentIndent;e++)this.code+="  "},t.push=function(e){var t=e.split("\n"),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;this.addIndents(),this.code+=l,this.newLine()}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}},t.newLine=function(){this.code+="\n"},t.closeCurly=function(){this.addIndents(),this.code+=this.lib.getClosingBrackets()},t.toString=function(){return this.code},e}(),d=n(59109),f={testRunnerName:function(){return"TestRunner"},testSuiteName:function(){return"TestSuite"},defaultImports:function(){return"import org.junit.Before;\nimport org.junit.After;\nimport org.junit.Test;\nimport static org.junit.Assert.*;"},classIntro:function(){return"public class ".concat((0,d.Og)(f.testSuiteName())," {")},classConstructorName:function(){return(0,d.Og)(f.testSuiteName())},setupIntro:function(){return"@Before\npublic void setUp() {"},tearDownIntro:function(){return"@After\npublic void tearDown() {"},testIntro:function(e){return"".concat(f.testIntroPreName()).concat(e).concat(f.testIntroPostName())},testIntroPreName:function(){return"@Test\npublic void "},testIntroPostName:function(){return"() {"},getProperTestName:function(e){return e},parseTestResultName:function(e){return e.replace("(".concat((0,d.Og)(f.testSuiteName()),")"),"")},buildSuite:function(e){var t=e.tests,n=e.meta,r=new u(f);r.push(f.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(f.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),n.setup&&(r.push(f.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()),n.tearDown&&(r.push(f.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()));var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.code&&(r.push(f.testIntro(s.name)),r.indent(),r.push(s.code),r.dedent(),r.closeCurly(),r.newLine(),r.newLine())}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r.dedent(),r.closeCurly(),r.toString()},runSuite:function(e){return v.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,o=e.tests,a=e.meta,l=f.buildSuite({tests:o,meta:a});return f.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:l})},hasClosingBrackets:function(){return!0},getClosingBrackets:function(){return"}"},hasSemicolon:function(){return!0},getCommentChar:function(){return"//"},getHelpText:function(){return"no react in this bitch either"},captureSetupError:function(e){var t=e.tag,n=e.raw;l.$e(function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","java10"),l.Tb(t)})},exampleTest:{id:-1,failureMessage:"An Adder class should have an add method that adds two ints and returns the result",name:"add",code:"Adder adder = new Adder();\nint result = adder.add(1, 2);\nassertEquals(3, result);\n"}},h="__UNIT_TEST_RESULT_START__",p="__UNIT_TEST_RESULT_END__",m="import org.json.simple.JSONArray;\nimport org.json.simple.JSONObject;\nimport org.junit.runner.JUnitCore;\nimport org.junit.runner.Result;\nimport org.junit.runner.notification.Failure;\n\npublic class ".concat((0,d.Og)(f.testRunnerName())," {\n    public static void main(String[] args) {\n      Result result = JUnitCore.runClasses(").concat((0,d.Og)(f.testSuiteName()),'.class);\n      JSONArray failures = new JSONArray();\n\n        for (Failure failure : result.getFailures()) {\n            JSONObject obj = new JSONObject();\n            obj.put("name", failure.getTestHeader());\n            obj.put("stack", failure.getTrace());\n            failures.add(obj);\n        }\n        JSONObject out = new JSONObject();\n        out.put("passed", result.wasSuccessful());\n        out.put("failures", failures);\n        System.out.println();\n        System.out.println("').concat(h,'");\n        System.out.println(out);\n        System.out.println("').concat(p,'");\n    }\n}');function v(){return(v=(0,r._)(function(e){var t,n,r,l,s,u,v,g,y,b,w,Z,x,C,S,k,_,E,T,R,I;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.container,n=e.fs,r=e.packager,l=e.logger,s=e.suiteCode,v=l.startLogSpinner("Setting up the environment"),[4,(0,d.WT)(n)];case 1:return o.sent(),v("Creating your test files 1/2"),[4,(0,d.e3)({fs:n,code:s,filename:"".concat(f.testSuiteName(),".java")})];case 2:if(g=o.sent().error)return f.captureSetupError({tag:"Failed to create suite code file",raw:g}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return v("Creating your test files 2/2"),[4,(0,d.e3)({fs:n,code:m,filename:"".concat(f.testRunnerName(),".java")})];case 3:if(y=o.sent().error)return f.captureSetupError({tag:"Failed to create test runner file",raw:y}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return l.stopLogSpinner(),l.clearLine(),l.logMessage("Installing imported packages\r\n"),[4,r.addPackages([{name:"junit:junit",version:"4.12"},{name:"com.googlecode.json-simple:json-simple",version:"1.1.1"},{name:"org.hamcrest:hamcrest-core",version:"1.3"}])];case 4:return o.sent(),[4,r.installPackages(a.D.active())];case 5:if(o.sent().error)return[2,{error:"Failed to install packages\r\n"}];return l.clearLogs(),v=l.startLogSpinner("Compiling your files"),[4,t.exec("find",".","-type","f","-name","*.java","-print0")];case 6:if(w=(b=o.sent()).output,Z=b.error)return x="Failed to fetch working directory java files",f.captureSetupError({tag:x,raw:Z}),[2,{error:"".concat(x,"\r\n\r\n")+(null==w?void 0:w.replace(/\n/g,"\n\r"))+"\r\n\r\n"+Z}];if("string"!=typeof w)throw Error("expected working directory files to be a string");return C=w.slice(0,-1).split("\x00"),S=".:./target/dependency/*",[4,(u=t).exec.apply(u,["javac","-classpath",S,"-d","."].concat((0,i._)(C)))];case 7:if(_=(k=o.sent()).output,E=k.error)return[2,{error:"".concat("Failed to compile test runner file","\r\n\r\n")+(null==_?void 0:_.replace(/\n/g,"\n\r"))+"\r\n\r\n"+E}];return v("Running your tests"),[4,t.exec("java","-classpath",S,(0,d.Og)(f.testRunnerName()))];case 8:if(R=(T=o.sent()).output,I=T.error)return(0,c.j)(c.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),[2,{error:"Running tests failed\r\n\r\n"+(null==R?void 0:R.replace(/\n/g,"\n\r"))+"\r\n\r\n"+I}];if("string"!=typeof R)throw Error("expected runOutput to be a string");return[2,{result:JSON.parse(R.slice(R.indexOf(h)+h.length,R.lastIndexOf(p))),error:null}]}})})).apply(this,arguments)}var g=function(e){return!!e&&e.trim().length>0&&e.split("\n").some(function(e){return!(e.trim().startsWith("#")||""===e.trim())})},y={testRunnerName:function(){return"test_runner"},testSuiteName:function(){return"test_suite"},defaultImports:function(){return"import unittest\nfrom main import *\n"},classIntro:function(){return"class UnitTests(unittest.TestCase):"},classConstructorName:function(){return"__init__"},setupIntro:function(){return"def setUp(self):"},tearDownIntro:function(){return"def tearDown(self):"},testIntro:function(e){return y.testIntroPreName()+e+y.testIntroPostName()},testIntroPreName:function(){return"def test_"},testIntroPostName:function(){return"(self):"},getProperTestName:function(e){return"test_".concat(e)},parseTestResultName:function(e){return e},buildSuite:function(e){var t=e.tests,n=e.meta,r=new u(y);r.push(y.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(y.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),g(n.setup)&&(r.push(y.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.newLine()),g(n.tearDown)&&(r.push(y.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.newLine()));var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;r.push(y.testIntro(s.name)),r.indent(),r.push(s.code||"pass"),r.dedent(),r.newLine()}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r.toString()},runSuite:function(e){return x.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,o=e.tests,a=e.meta,l=y.buildSuite({tests:o,meta:a});return y.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:l})},hasClosingBrackets:function(){return!1},getClosingBrackets:function(){throw Error("This language does not have closing brackets, check `hasClosingBrackets` first")},hasSemicolon:function(){return!1},getCommentChar:function(){return"#"},getHelpText:function(){return"no react in this bitch"},captureSetupError:function(e){var t=e.tag,n=e.raw;l.$e(function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","python3"),l.Tb(t)})},exampleTest:{id:-1,failureMessage:"In main.py you should have an add functions that adds two numbers and returns the result",name:"add",code:"self.assertEquals(add(1, 2), 3)"}},b="__UNIT_TEST_RESULT_START__",w="__UNIT_TEST_RESULT_END__",Z="import unittest\nimport ".concat((0,d.Og)(y.testSuiteName()),"\nimport os\nimport json\nfrom time import sleep\n\nsuite = unittest.TestLoader().loadTestsFromTestCase(\n  ").concat((0,d.Og)(y.testSuiteName()),'.UnitTests)\nf = open(os.devnull,"w")\ntest_res = unittest.TextTestRunner(stream=f).run(suite)\n\n# Merge errors and failures and normalize to {name, stack}\nfailures = [\n    {\n        "name": r[0]._testMethodName,\n        "stack": r[1],\n    } for r in test_res.errors + test_res.failures\n]\nprint()\nprint(\'').concat(b,'\')\nsleep(1)\nprint(json.dumps({\n    "passed": test_res.wasSuccessful(),\n    "failures": failures,\n}))\nprint()\nprint(\'').concat(w,"');");function x(){return(x=(0,r._)(function(e){var t,n,r,i,l,s,u,f,h,p,m;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.container,n=e.fs,r=e.packager,i=e.logger,l=e.suiteCode,s=i.startLogSpinner("Setting up the environment"),[4,(0,d.WT)(n)];case 1:return o.sent(),s("Creating your test files 1/2"),[4,(0,d.e3)({fs:n,code:l,filename:"".concat(y.testSuiteName(),".py")})];case 2:if(u=o.sent().error)return y.captureSetupError({tag:"Failed to create suite code file",raw:u}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return s("Creating your test files 2/2"),[4,(0,d.e3)({fs:n,code:Z,filename:"".concat(y.testRunnerName(),".py")})];case 3:if(f=o.sent().error)return y.captureSetupError({tag:"Failed to create test runner file",raw:f}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return i.stopLogSpinner(),i.clearLine(),i.logMessage("Installing imported packages\r\n"),[4,r.installPackages(a.D.active())];case 4:if(o.sent().error)return[2,{error:"Failed to install packages\r\n"}];return i.clearLogs(),i.startLogSpinner("Running your tests"),[4,t.exec("python","-B",(0,d.Og)("".concat(y.testRunnerName(),".py")))];case 5:if(p=(h=o.sent()).output,m=h.error)return(0,c.j)(c.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),[2,{error:"Running tests failed\r\n\r\n"+(null==p?void 0:p.replace(/\n/g,"\n\r"))+"\r\n"+m}];if("string"!=typeof p)throw Error("expected runoutput to be a string");return[2,{result:JSON.parse(p.slice(p.indexOf(b)+b.length,p.lastIndexOf(w))),error:null}]}})})).apply(this,arguments)}var C={testRunnerName:function(){throw Error("Node test runner uses jest directly")},testSuiteName:function(){return"test_suite"},defaultImports:function(){return"const index = require('./index.js');"},classIntro:function(){return'describe("UnitTests", function() {'},classConstructorName:function(){return null},setupIntro:function(){return"beforeAll(async function() {"},tearDownIntro:function(){return"afterAll(async function() {"},testIntro:function(e){return C.testIntroPreName()+e+C.testIntroPostName()},testIntroPreName:function(){return'test("'},testIntroPostName:function(){return'", async function() {'},getProperTestName:function(e){return e},parseTestResultName:function(e){return e},buildSuite:function(e){var t=e.tests,n=e.meta,r=new u(C);r.push(C.defaultImports()),n&&n.imports&&r.push(n.imports),r.newLine(),r.push(C.classIntro()),r.newLine(),r.indent(),n&&(n.initialization&&(r.push(n.initialization),r.newLine()),n.setup&&(r.push(C.setupIntro()),r.indent(),r.push(n.setup),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()),n.tearDown&&(r.push(C.tearDownIntro()),r.indent(),r.push(n.tearDown),r.dedent(),r.closeCurly(),r.newLine(),r.newLine()));var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.code&&(r.push(C.testIntro(s.name)),r.indent(),r.push(s.code),r.dedent(),r.closeCurly(),r.newLine(),r.newLine())}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r.dedent(),r.closeCurly(),r.toString()},runSuite:function(e){return S.apply(this,arguments)},buildAndRunTests:function(e){var t=e.container,n=e.fs,r=e.packager,i=e.logger,o=e.tests,a=e.meta,l=C.buildSuite({tests:o,meta:a});return C.runSuite({container:t,fs:n,packager:r,logger:i,suiteCode:l})},hasClosingBrackets:function(){return!0},getClosingBrackets:function(){return"});"},hasSemicolon:function(){return!0},getCommentChar:function(){return"//"},getHelpText:function(){return"no react yet"},captureSetupError:function(e){var t=e.tag,n=e.raw;l.$e(function(e){e.setTag("unitTestLib","true"),e.setExtra("raw",n),e.setExtra("language","nodejs"),l.Tb(t)})},exampleTest:{id:-1,failureMessage:"",name:"add",code:"expect(index.add(1, 2)).toBe(3);"}};function S(){return(S=(0,r._)(function(e){var t,n,r,i,l,s,u,f,h,p,m,v,g,y,b,w,Z,x,S;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.container,n=e.fs,r=e.packager,i=e.logger,l=e.suiteCode,s=i.startLogSpinner("Setting up the environment"),[4,(0,d.WT)(n)];case 1:return o.sent(),s("Creating your test files 1/2"),[4,(0,d.e3)({fs:n,code:l,filename:"".concat(C.testSuiteName(),".js")})];case 2:if(u=o.sent().error)return C.captureSetupError({tag:"Failed to create suite code file",raw:u}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return s("Creating your test files 2/2"),f=69,h="jest.config.json",p={testRegex:(0,d.Og)("".concat(C.testSuiteName(),".js")),testEnvironment:"node",testFailureExitCode:f},[4,(0,d.e3)({fs:n,code:JSON.stringify(p),filename:h})];case 3:if(m=o.sent().error)return C.captureSetupError({tag:"Failed to create config file",raw:m}),[2,{error:"There was an error creating a test file, if this happens again, please contact support."}];return i.stopLogSpinner(),i.clearLine(),i.logMessage("Installing imported packages\r\n"),[4,r.installPackages(a.D.active())];case 4:if(o.sent().error)return[2,{error:"Failed to install packages\r\n"}];return i.clearLogs(),s=i.startLogSpinner("Running your tests"),v=(0,d.Og)("output.json"),[4,t.exec("jest","--json","--outputFile",v,"--config",(0,d.Og)(h),"--forceExit","--passWithNoTests")];case 5:if(y=(g=o.sent()).output,(b=g.error)&&!b.endsWith(f.toString()))return(0,c.j)(c.U3.REPL_UNIT_TEST_CONSTRUCTION_ERROR_INTERNAL),[2,{error:"Running tests failed\r\n\r\n"+(null==y?void 0:y.replace(/\n/g,"\n\r"))+"\r\n"+b}];return s("Parsing your test results"),[4,n.readFile(v)];case 6:if((w=o.sent()).error)return C.captureSetupError({tag:"Error reading test results",raw:w.error}),[2,{error:"There was an error getting test results, if this happens please contact support."}];if((Z=JSON.parse(w.content.toString())).success)return[2,{error:null,result:{passed:!0,failures:[]}}];if(!(S=(x=Z.testResults[0]).assertionResults.filter(function(e){return"passed"!==e.status}).map(function(e){return{name:e.title,stack:e.failureMessages[0]}})).length)return[2,{error:x.message.replace(/\n/g,"\r\n")}];return[2,{error:null,result:{passed:!1,failures:S}}]}})})).apply(this,arguments)}var k={java10:f,java10_beta:f,java:f,python3:y,python3_beta:y,python:y,nodejs:C,javascript:C,nodejs_beta:C};function _(e){return e in k}function E(e){if(!_(e))throw Error("".concat(e," is not a supported unit testing language, it has to be one of ").concat(Object.keys(k)));return k[e]}},59109:function(e,t,n){n.d(t,{Og:function(){return u},WT:function(){return h},e3:function(){return d}});var r=n(27387),i=n(96583),o=n(43182),a=n(41500),l=n(39756),c=n(30084),s="_test_runner";function u(e){return s+e}function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e){var t,n,r,o;return(0,i.Jh)(this,function(i){return t=e.fs,n=e.code,r=s+e.filename,o=a.Z.from(n,"utf8"),[2,t.writeFile(r,o)]})})).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)(function(e){var t,n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,e.readDir(l.Ql)];case 1:if((t=r.sent()).error)return[2];return[4,Promise.all(t.children.map(function(t){return t.filename.startsWith(s)?t.type===c.Tv.File?e.deleteFile(t.filename):e.deleteDir(t.filename):Promise.resolve(null)}))];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),o.$e(function(e){e.setTag("unitTestLib","true"),o.Tb(n)}),[3,4];case 4:return[2]}})})).apply(this,arguments)}},79962:function(e,t,n){n.d(t,{AF:function(){return Z},Hd:function(){return C},IV:function(){return E},Rb:function(){return g},aA:function(){return v},kO:function(){return k},lQ:function(){return R},rU:function(){return b}});var r=n(41733),i=n(21262),o=n(71440),a=n(99165);function l(){var e=(0,i._)(["\n  fragment UnitTestsReplUnitTestMeta on ReplUnitTestMeta {\n    id\n    imports\n    initialization\n    setup\n    tearDown\n  }\n"]);return l=function(){return e},e}function c(){var e=(0,i._)(["\n  fragment UnitTestsReplUnitTest on ReplUnitTest {\n    id\n    name\n    code\n    failureMessage\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  mutation createUnitTestMeta($input: CreateReplUnitTestMetaInput!) {\n    createReplUnitTestMeta(input: $input) {\n      ... on ReplUnitTestMeta {\n        id\n        ...UnitTestsReplUnitTestMeta\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return s=function(){return e},e}function u(){var e=(0,i._)(["\n  mutation updateUnitTestMeta($input: UpdateReplUnitTestMetaInput!) {\n    updateReplUnitTestMeta(input: $input) {\n      ... on ReplUnitTestMeta {\n        id\n        ...UnitTestsReplUnitTestMeta\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return u=function(){return e},e}function d(){var e=(0,i._)(["\n  mutation createUnitTest($input: CreateReplUnitTestInput!) {\n    createReplUnitTest(input: $input) {\n      ... on ReplUnitTest {\n        id\n        ...UnitTestsReplUnitTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return d=function(){return e},e}function f(){var e=(0,i._)(["\n  mutation updateUnitTest($input: UpdateReplUnitTestInput!) {\n    updateReplUnitTest(input: $input) {\n      ... on ReplUnitTest {\n        id\n        ...UnitTestsReplUnitTest\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return f=function(){return e},e}function h(){var e=(0,i._)(["\n  mutation deleteUnitTest($testId: Int!) {\n    deleteReplUnitTest(testId: $testId) {\n      ... on ReplUnitTest {\n        id\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return h=function(){return e},e}function p(){var e=(0,i._)(["\n  mutation updateReplUnitTestLastRun(\n    $input: UpdateReplUnitTestLastRunInput!\n    $replId: String!\n  ) {\n    updateReplUnitTestLastRun(input: $input) {\n      ... on UpdateReplUnitTestLastRunUpdatedTests {\n        __typename\n        updatedTests {\n          ... on ReplUnitTest {\n            id\n            __typename\n            lastRun(replId: $replId) {\n              ... on ReplUnitTestLastRun {\n                __typename\n                status\n              }\n              ... on UserError {\n                __typename\n                message\n              }\n            }\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n      ... on UserError {\n        __typename\n        message\n      }\n    }\n  }\n"]);return p=function(){return e},e}var m={},v=(0,o.Ps)(l()),g=(0,o.Ps)(c()),y=(0,o.Ps)(s(),v);function b(e){var t=(0,r._)({},m,e);return a.D(y,t)}var w=(0,o.Ps)(u(),v);function Z(e){var t=(0,r._)({},m,e);return a.D(w,t)}var x=(0,o.Ps)(d(),g);function C(e){var t=(0,r._)({},m,e);return a.D(x,t)}var S=(0,o.Ps)(f(),g);function k(e){var t=(0,r._)({},m,e);return a.D(S,t)}var _=(0,o.Ps)(h());function E(e){var t=(0,r._)({},m,e);return a.D(_,t)}var T=(0,o.Ps)(p());function R(e){var t=(0,r._)({},m,e);return a.D(T,t)}},31593:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(66626),i=n(66349),o=n(54916),a=n(50959),l=n(59808),c=n(68809);function s(){var e=(0,i.Z)(),t=(0,o.Z)().dotReplit,n=null==e?void 0:e.language,s=(0,r._)((0,a.useState)(null),2),u=s[0],d=s[1],f=(0,r._)((0,a.useState)(!0),2),h=f[0],p=f[1];return(0,a.useEffect)(function(){if(n){if((0,c.y)(n)){d(n),p(!1);return}var e=!1,r=t.watch(function(t){if(e||(e=!0,p(!1)),t.error){t.error===l.Yt.NotFound&&d(null);return}var n,r,i=null===(r=t.config.unitTest)||void 0===r?void 0:null===(n=r.language)||void 0===n?void 0:n.toLowerCase();i&&(0,c.y)(i)?d(i):d(null)});return function(){r()}}},[n,t]),{language:u,isLoading:h}}},39783:function(e,t,n){n.d(t,{Q:function(){return o}});var r=n(74985),i=n(50959);function o(e){var t=e.uploadFiles,n=e.fileUploadInputRef,o=e.dirUploadInputRef,a=(0,i.useRef)(Math.random().toString(36));return(0,r.BX)(r.HY,{children:[(0,r.tZ)("input",{style:{display:"none"},ref:n,id:"file-upload-input-".concat(a.current),type:"file",onChange:function(e){var n=e.target.files;n&&t({files:Array.from(n)})},onClick:function(e){e.currentTarget.value=""},multiple:!0,accept:"*"}),(0,r.tZ)("input",{style:{display:"none"},ref:o,id:"dir-upload-input-".concat(a.current),type:"file",onChange:function(e){var n=e.target.files;n&&t({files:Array.from(n)})},onClick:function(e){e.currentTarget.value=""},webkitdirectory:"true",mozdirectory:"true",msdirectory:"true",odirectory:"true",directory:"true",accept:"*"})]})}},81810:function(e,t,n){n.d(t,{ZP:function(){return eD},c0:function(){return ek}});var r,i,o=n(12285),a=n(42516),l=n(41733),c=n(66626),s=n(74985),u=n(43312),d=n(56337),f=n(22487),h=n(25425),p=n(7444),m=n(50199),v=n(10041),g=n(73157),y=n(1498),b=n(70002),w=n(15146),Z=n(18836),x=n(49344),C=n(85195),S=n(38080),k=n(74833),_=n(30983),E=n(56596),T=n(93918),R=n(40102),I=n(12874),D=n(41859),G=n(52924),B=n(44620),P=n(88936),A=n(57122),N=n(58003),L=n(67337),U=n(20573),O=n(29287),M=n(10981),X=n(52234),F=n(74652),W=n(33988),H=n.n(W),V=n(50959),z=n(98924),j=n(76999),q=n.n(j),Y=n(21262),J=n(71440),K=n(58995),$=n(99165);function Q(){var e=(0,Y._)(["\n  fragment EditDomainRepl on Repl {\n    id\n    hostedUrl\n    apexProxy\n    domains {\n      hosting_deployment_id\n      domain\n      state\n    }\n  }\n"]);return Q=function(){return e},e}function ee(){var e=(0,Y._)(["\n  query EditDomain($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...EditDomainRepl\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n      ... on SubscriptionExpiredError {\n        replId\n      }\n    }\n  }\n  ","\n"]);return ee=function(){return e},e}function et(){var e=(0,Y._)(["\n  query EditDomainCheckDomain2($replId: String!, $domain: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        checkDomain2(domain: $domain) {\n          ... on DomainStatus2 {\n            verified\n            retry\n            status\n            records {\n              A\n              TXT\n              CNAME\n            }\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on ServiceUnavailable {\n            message\n          }\n        }\n      }\n    }\n  }\n"]);return et=function(){return e},e}function en(){var e=(0,Y._)(["\n  mutation EditDomainLinkReplDomain2(\n    $replId: String!\n    $domain: String!\n    $deploymentId: String\n  ) {\n    linkReplDomain2(\n      replId: $replId\n      domain: $domain\n      deploymentId: $deploymentId\n    ) {\n      __typename\n      ... on Repl {\n        id\n        ...EditDomainRepl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on ServiceUnavailable {\n        message\n      }\n    }\n  }\n  ","\n"]);return en=function(){return e},e}function er(){var e=(0,Y._)(["\n  mutation EditDomainUpdateRepl($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        ...EditDomainRepl\n      }\n    }\n  }\n  ","\n"]);return er=function(){return e},e}var ei={},eo=(0,J.Ps)(Q()),ea=(0,J.Ps)(ee(),eo),el=(0,J.Ps)(et()),ec=(0,J.Ps)(en(),eo),es=(0,J.Ps)(er(),eo),eu=n(43182),ed=n(32377),ef=n(58719),eh=n(8017),ep=n(99656),em=n(52682),ev=n(32508),eg=n.n(ev);function ey(e){switch(e.status){case"verified":return(0,s.tZ)(ed.Z,{color:O.TV.accentPositiveDefault});case"failed":return(0,s.tZ)(ef.Z,{color:O.TV.accentNegativeDefault});case"verifying":return(0,s.tZ)(P.Z,{color:O.TV.accentPrimaryDefault});default:return null}}function eb(e){var t,n=e.replId,r=e.hostedUrl,i=e.desiredARecord,o=e.existingDomain,a=e.onLink,u=e.onGoBack,d=e.onLinkStarted,f=e.onStateChanged,h=(0,c._)((0,V.useState)(o?"loading":null),2),p=h[0],m=h[1],g=(0,c._)((0,V.useState)(!1),2),b=g[0],w=g[1],x=(0,c._)((0,V.useState)(null),2),C=x[0],S=x[1],_=(0,c._)((0,V.useState)(!1),2),T=_[0],R=_[1],I=(0,c._)((t=(0,l._)({},ei,void 0),$.D(ec,t)),2),D=I[0],G=I[1],B=(0,V.useRef)(null),P=(0,V.useRef)(null),A=(0,V.useRef)(null),N=function(e){(null==e?void 0:e.current)&&e.current.select()},L=function(e){var t;(null==e?void 0:null===(t=e.current)||void 0===t?void 0:t.value)&&(0,v.Z)(e.current.value).catch(function(e){eu.$e(function(t){t.setTag("domain-link",!0),t.setExtra("type","copy"),eu.Tb(e)})})},U=(0,c._)((0,V.useState)(o||""),2),X=U[0],F=U[1];(0,V.useEffect)(function(){G.data&&"Repl"===G.data.linkReplDomain2.__typename&&a()},[G.data,a]);var W=function(){try{var e=new URL("/",X);F(e.hostname)}catch(e){}},H=function(e){m(e),f()},z=eg()(X,{require_valid_protocol:!1})&&X.split(".").length>=2,j=z&&2===X.split(".").length,q=r.replace(/^https:\/\//,""),Y="replit-verify=".concat(n),J=(0,M.U)();return(0,s.BX)(E.G,{css:[O.l0.colWithGap(16)],children:[(0,s.BX)(E.G,{css:[O.l0.colWithGap(8)],children:[(0,s.tZ)(k.h4,{level:2,variant:"subheadDefault",children:"New Domain Link"}),(0,s.BX)(k.xv,{children:["Learn more"," ",(0,s.tZ)("a",{href:"https://docs.replit.com/hosting/hosting-web-pages#custom-domains",target:"_blank",children:"here"}),"."]})]}),(0,s.BX)(E.G,{css:[O.l0.colWithGap(4)],children:[(0,s.tZ)("label",{htmlFor:J("domain"),children:(0,s.tZ)(k.xv,{color:"dimmer",variant:"small",multiline:!1,children:"Step 1: Enter your domain"})}),(0,s.tZ)(Z.II,{className:"cname-url",readOnly:"loading"===p,value:X,onChange:function(e){F(e.target.value)},onBlur:function(){W()},placeholder:"example.com",id:J("domain")})]}),j&&!T?(0,s.BX)(E.G,{css:[O.l0.colWithGap(8)],children:[(0,s.BX)(E.G,{css:[O.l0.colWithGap(4)],children:[(0,s.tZ)("label",{htmlFor:J("record"),children:(0,s.BX)(k.xv,{color:"dimmer",variant:"small",multiline:!1,children:["Step 2: Add an ",(0,s.tZ)("code",{children:"A"})," Record"]})}),(0,s.BX)(E.G,{css:[O.l0.rowWithGap(8),O.l0.align.center],children:[(0,s.tZ)(k.xv,{multiline:!1,css:{fontFamily:O.TV.fontFamilyCode,maxWidth:"40%"},children:X}),(0,s.tZ)(k.xv,{multiline:!1,css:{fontFamily:O.TV.fontFamilyCode},children:"A"}),(0,s.tZ)(Z.II,{readOnly:!0,ref:B,onChange:function(){return null},value:i,onFocus:function(){return N(B)},id:J("record")}),(0,s.tZ)(y.zx,{onClick:function(){return L(B)},text:"Copy"})]})]}),(0,s.tZ)(E.G,{css:[O.l0.flex.row,O.l0.align.stretch],children:(0,s.tZ)(y.zx,{variant:"outlined",onClick:function(){return R(!0)},text:"Use CNAME record instead."})})]}):null,z&&(T||!j)?(0,s.BX)(E.G,{css:[O.l0.colWithGap(4)],children:[(0,s.tZ)("label",{htmlFor:J("CNAMERecord"),children:(0,s.BX)(k.xv,{color:"dimmer",variant:"small",multiline:!1,children:["Step 2: Add a ",(0,s.tZ)("code",{children:"CNAME"})," Record"]})}),(0,s.BX)(E.G,{css:[O.l0.rowWithGap(8),O.l0.align.center],children:[(0,s.tZ)(k.xv,{multiline:!1,css:{fontFamily:O.TV.fontFamilyCode,maxWidth:"40%"},children:X}),(0,s.tZ)(k.xv,{multiline:!1,css:{fontFamily:O.TV.fontFamilyCode},children:"CNAME"}),(0,s.tZ)(Z.II,{readOnly:!0,ref:A,onChange:function(){return null},value:q,onFocus:function(){return N(A)},id:J("CNAMERecord")}),(0,s.tZ)(y.zx,{onClick:function(){return L(A)},text:"Copy"})]}),j?(0,s.BX)(E.G,{css:[O.l0.colWithGap(8)],children:[(0,s.tZ)(k.xv,{variant:"small",children:'Note: this CNAME record requires that your DNS provider supports CNAMEs for apex domains - for example Cloudflare with "CNAME Flattening".'}),(0,s.tZ)(E.G,{css:[O.l0.flex.row,O.l0.align.stretch],children:(0,s.tZ)(y.zx,{onClick:function(){return R(!1)},text:"Use A record instead",variant:"outlined"})})]}):null]}):null,z?(0,s.BX)(E.G,{css:[O.l0.colWithGap(4)],children:[j?(0,s.tZ)("label",{htmlFor:J("txtRecord"),children:(0,s.BX)(k.xv,{color:"dimmer",variant:"small",multiline:!1,children:["This domain also requires a ",(0,s.tZ)("code",{children:"TXT"})," Record"]})}):(0,s.BX)("label",{children:['If you are using a service like Cloudflare (with "orange cloud") that rewrites domain records, you can add a ',(0,s.tZ)("code",{children:"TXT"})," ","Record for verification purposes."]}),(0,s.BX)(E.G,{css:[O.l0.rowWithGap(8),O.l0.align.center],children:[(0,s.tZ)(k.xv,{multiline:!1,css:{fontFamily:O.TV.fontFamilyCode,maxWidth:"40%"},children:X}),(0,s.tZ)(k.xv,{multiline:!1,css:{fontFamily:O.TV.fontFamilyCode},children:"TXT"}),(0,s.tZ)(Z.II,{readOnly:!0,ref:P,onChange:function(){return null},value:Y,onClick:function(){return N(P)},id:J("txtRecord")}),(0,s.tZ)(y.zx,{onClick:function(){return L(P)},text:"Copy"})]})]}):null,"loading"===p?(0,s.tZ)(E.G,{css:[O.l0.colWithGap(12),O.l0.pt(16)],children:(0,s.tZ)(ew,{replId:n,domain:X,onVerified:function(){return H("verified")},onError:function(){return H("error")}})}):null,"verified"===p?(0,s.tZ)(E.G,{css:[O.l0.colWithGap(12),O.l0.pt(16)],children:(0,s.tZ)(k.xv,{multiline:!1,children:"Your domain has been verified."})}):null,"error"===p||C?(0,s.tZ)(E.G,{css:[O.l0.colWithGap(12),O.l0.pt(16)],children:(0,s.BX)(k.xv,{multiline:!1,children:["Creating the domain link failed",C?": "+C:"","."]})}):null,(0,s.BX)(E.G,{css:[O.l0.rowWithGap(12),O.l0.justify.end],children:[(0,s.tZ)(y.zx,{onClick:u,text:"Close"}),z&&null===p?(0,s.tZ)(y.zx,{disabled:b,onClick:function(){w(!0),S(null),D({variables:{replId:n,domain:X}}).then(function(e){var t,n=(null===(t=e.data)||void 0===t?void 0:t.linkReplDomain2)||null;(null==n?void 0:n.__typename)==="Repl"?(S(null),H("loading")):(((null==n?void 0:n.__typename)==="ServiceUnavailable"||(null==n?void 0:n.__typename)==="NotFoundError"||(null==n?void 0:n.__typename)==="UnauthorizedError")&&S(null==n?void 0:n.message),H("error")),w(!1),d()}).catch(function(e){w(!1),S(e.message)})},text:"".concat(b?"Linking domain...":"Link domain"),iconLeft:(0,s.tZ)(eh.Z,{}),colorway:"primary"}):null]})]})}function ew(e){var t=e.domain,n=e.replId,r=e.onVerified,i=e.onError,o=(d=(0,l._)({},ei,{variables:{replId:n,domain:t},pollInterval:1e3}),K.a(el,d)),a=o.data,u=o.stopPolling;if((0,V.useEffect)(function(){if(a&&"Repl"===a.repl.__typename){var e,t,n=a.repl;if((null===(e=n.checkDomain2)||void 0===e?void 0:e.__typename)==="NotFoundError"){i();return}if((null===(t=n.checkDomain2)||void 0===t?void 0:t.__typename)==="DomainStatus2"){var o=n.checkDomain2,l=o.retry,c=o.verified;if(!c&&!l){i();return}(c||!l)&&u(),c&&r()}}},[a,u,r,i]),(null==a?void 0:a.repl.__typename)==="Repl"&&a.repl.checkDomain2){var d,f,h,p,m,v,g="DomainStatus2"===a.repl.checkDomain2.__typename?a.repl.checkDomain2:null,y=null;if(null==g?void 0:g.records){var b=g.records;b.__typename,y=(0,z._)(b,["__typename"])}var w=null;return(null==g?void 0:g.status)||((null===(v=a.repl.checkDomain2)||void 0===v?void 0:v.__typename)==="ServiceUnavailable"&&(w=a.repl.checkDomain2.message),w||(w="DNS updates can take up to 48 hours to fully synchronize. Feel free to check back later.")),(0,s.BX)(E.G,{css:[O.l0.colWithGap(16),O.l0.justify.spaceBetween],children:[(0,s.BX)(E.G,{css:[O.l0.rowWithGap(16),O.l0.align.center],children:[(0,s.tZ)("div",{css:[O.l0.width("20px"),O.l0.height("20px"),{aspectRatio:"1 / 1"},{borderRadius:"100%"},{borderRadius:"100%"},{borderStyle:"solid"},{borderWidth:"3px"},{borderColor:O.TV.accentPrimaryDimmer},{borderTopColor:O.TV.accentPrimaryDefault},{transform:"rotate(0deg)"},{animation:"linear domain-loading 1s infinite"}],className:"jsx-4e6cc6caecb799c9"}),(0,s.tZ)("div",{className:"jsx-4e6cc6caecb799c9",children:w})]}),y||(null===(h=a.repl.checkDomain2)||void 0===h?void 0:h.__typename)==="DomainStatus2"&&(null===(p=a.repl.checkDomain2)||void 0===p?void 0:p.retry)||(null===(m=a.repl.checkDomain2)||void 0===m?void 0:m.__typename)==="ServiceUnavailable"?(0,s.BX)(E.G,{children:[(0,s.tZ)("br",{className:"jsx-4e6cc6caecb799c9"}),y?(0,s.BX)(E.G,{children:["Currently, your domains records show:",(0,s.tZ)("pre",{css:[O.l0.overflow("scroll")],className:"jsx-4e6cc6caecb799c9",children:Object.entries(y).map(function(e){var n=(0,c._)(e,2),r=n[0],i=n[1];return null==i?void 0:i.map(function(e){return(0,s.BX)("div",{className:"jsx-4e6cc6caecb799c9",children:[t," ",r," ",e]},"{domain}-{dnsType}")})})})]}):(0,s.tZ)(k.xv,{children:"Currently, your domain is either not returning any records, or something is getting in the way of our verification process."})]}):null,(0,s.tZ)(q(),{id:"4e6cc6caecb799c9",children:"@-webkit-keyframes domain-loading{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes domain-loading{from{-moz-transform:rotate(0deg);transform:rotate(0deg)}to{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes domain-loading{from{-o-transform:rotate(0deg);transform:rotate(0deg)}to{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes domain-loading{from{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]})}return(null==a?void 0:a.repl.__typename)==="Repl"&&(null===(f=a.repl.checkDomain2)||void 0===f?void 0:f.__typename)==="NotFoundError"?(0,s.tZ)(s.HY,{children:"We ran into an internal error while checking the domain. Please try again later."}):null}function eZ(e){var t,n=e.replId,r=e.domain,i=e.onUnlink,o=e.onGoBack,a=(0,c._)((t=(0,l._)({},ei,{variables:{input:{id:n,removeDomain:r}}}),$.D(es,t)),2),u=a[0],d=a[1];return(0,V.useEffect)(function(){d.data&&d.data.updateRepl.repl&&i()},[d.data,i]),(0,s.BX)(E.G,{css:[O.l0.colWithGap(16)],children:[(0,s.BX)(E.G,{css:[O.l0.colWithGap(8)],children:[(0,s.tZ)(k.h4,{level:3,variant:"subheadDefault",children:"Domain Unlinking"}),(0,s.BX)(k.xv,{children:["Are you sure you want to unlink"," ",(0,s.tZ)("a",{target:"_blank",rel:"noopener",href:"https://"+r,children:r}),"?"]})]}),(0,s.BX)(E.G,{css:[O.l0.rowWithGap(12),O.l0.justify.end],children:[(0,s.tZ)(y.zx,{onClick:o,text:"Cancel"}),(0,s.tZ)(y.zx,{onClick:function(){d.loading||u()},text:d.loading?"Unlinking domain...":"Yes, unlink this domain",colorway:"negative",iconLeft:(0,s.tZ)(em.Z,{}),disabled:d.loading})]})]})}function ex(e){var t=e.replId,n=e.hostedUrl,r=e.apexProxy,i=e.onUnlink,o=e.onLink,a=e.domains,l=e.refetch,u=(0,c._)((0,V.useState)("listing"),2),d=u[0],f=u[1],h=(0,c._)((0,V.useState)(null),2),p=h[0],m=h[1],v=null;return"listing"===d?v=(0,s.BX)(E.G,{css:[O.l0.colWithGap(16)],children:[(0,s.BX)(E.G,{children:[(0,s.tZ)(k.h4,{level:3,variant:"subheadDefault",children:"Currently Linked Domains"}),(0,s.tZ)(E.G,{css:[O.l0.colWithGap(16)],children:a.map(function(e){return e?(0,s.tZ)(E.G,{children:(0,s.BX)(E.G,{css:[O.l0.colWithGap(4),O.l0.justify.spaceBetween,O.l0.align.center],children:[(0,s.BX)(E.G,{css:[O.l0.rowWithGap(8),O.l0.align.center,O.l0.justify.spaceBetween,O.l0.width("100%")],children:[(0,s.tZ)(E.G,{css:[O.l0.flex.shrink(1)],children:(0,s.tZ)(_.u,{tooltip:e.domain,children:(0,s.tZ)(k.xv,{multiline:!1,children:e.domain})})}),(0,s.tZ)(E.G,{children:(0,s.tZ)(_.u,{tooltip:(0,s.tZ)(k.xv,{css:{textTransform:"capitalize"},multiline:!1,children:e.state}),children:(0,s.tZ)(ey,{status:e.state})})})]}),(0,s.BX)(E.G,{css:[O.l0.rowWithGap(12),O.l0.justify.end,O.l0.align.center,O.l0.width("100%"),"verified"!==e.state&&O.l0.pl(12)],children:[(0,s.tZ)(y.zx,{text:"Unlink",css:O.l0.width("verified"!==e.state?"50%":"100%"),onClick:function(){m(e.domain),f("unlinking")}}),"verified"!==e.state?(0,s.tZ)(y.zx,{text:"Check status",css:O.l0.width("50%"),onClick:function(){m(e.domain),f("linking")}}):null]})]})},e.domain):null})})]}),(0,s.tZ)(y.zx,{text:"Create domain link",onClick:function(){return f("linking")},iconLeft:(0,s.tZ)(ep.Z,{})})]}):"linking"===d?v=(0,s.tZ)(eb,{replId:t,desiredARecord:r,hostedUrl:n,existingDomain:p,onLink:o,onGoBack:function(){f("listing"),m(null)},onLinkStarted:l,onStateChanged:l}):"unlinking"===d&&null!==p&&(v=(0,s.tZ)(eZ,{replId:t,domain:p,onUnlink:function(){l(),f("listing"),i()},onGoBack:function(){f("listing"),m(null)}})),(0,s.BX)(E.G,{css:[O.l0.colWithGap(16)],children:[(0,s.tZ)(k.h4,{level:1,variant:"subheadDefault",children:"Domain Linking"}),(0,s.BX)(k.xv,{css:{fontStyle:"italic"},children:["Domain linking to the development preview is deprecated, please consider switching to"," ",(0,s.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/about-deployments",target:"_blank",children:"deployments"})," ","as a more scalable solution."]}),v]})}(r=i||(i={})).Verified="verified",r.Verifying="verifying",r.Failed="failed";var eC=n(18059),eS=n(3409),ek="flag-ocean-easy",e_=(0,u.iv)([O.l0.borderRadius(6),O.l0.color.foregroundDimmer,O.l0.height(24),O.l0.m(4)]),eE=[O.l0.reset.button,Z.u3,O.l0.rowWithGap(0),O.l0.flex.grow(0),O.l0.color.accentPositiveStronger,O.l0.fontSize("small"),O.l0.focusRing,{"&:hover":[O.l0.cursor.pointer,O.l0.color.accentPositiveStrongest]},{borderTopRightRadius:0,borderBottomRightRadius:0,borderRight:0},O.l0.align.center,O.l0.py(0),O.l0.px(4)],eT=(0,T.X)({root:[O.l0.flex.row,O.l0.align.center,O.l0.justify.spaceBetween,O.l0.border({color:O.TV.outlineDimmest,direction:"bottom"}),O.l0.p(2),O.l0.container("root"),O.l0.zIndex(1)],navControls:[O.l0.align.center,O.l0.rowWithGap(4),O.l0.flex.grow(1)],urlWrapper:[O.l0.position.relative,O.l0.flex.row,O.l0.flex.grow(1)],urlOptionsRoot:[O.l0.rowWithGap(0),O.l0.flex.growAndShrink(1)],urlOptions:[O.l0.position.absolute,O.l0.width("100%"),O.l0.backgroundColor.backgroundHigher,O.l0.p(8),O.l0.colWithGap(6),O.l0.border(),O.l0.borderRadius(0,0,12,12),{top:"100%",borderTop:0}],urlOptionsSection:[O.l0.colWithGap(4),O.l0.pb(8),O.l0.border({direction:"bottom"}),{":last-child":{borderBottom:0}}],urlOptionsTitle:[O.l0.rowWithGap(0),O.l0.justify.spaceBetween,O.l0.flex.grow(1)],portRadioGroup:[O.l0.colWithGap(8)],portOption:[O.l0.rowWithGap(8),O.l0.color.foregroundDimmer],portOptionSelected:[O.l0.rowWithGap(8),O.l0.color.foregroundDefault],portOptionLabel:[{"&:hover":[O.l0.cursor.pointer,O.l0.color.foregroundDefault]}],temporaryDevLinkWrapper:[O.l0.rowWithGap(4)],temporaryDevLinkText:{flex:"0 1 auto"},temporaryDevLink:[O.l0.display.block,O.l0.color.accentPositiveStronger,O.l0.fontSize("small"),O.l0.focusRing,{wordBreak:"break-all","&:hover":[O.l0.cursor.pointer,O.l0.color.accentPositiveStrongest]}],url:eE,urlSelected:[eE,O.l0.backgroundColor.backgroundHighest,{borderBottomLeftRadius:0}],urlPath:[O.l0.py(0),O.l0.fontSize(12),O.l0.flex.grow(1)],urlPath2:[O.l0.py(0),O.l0.fontSize(12),O.l0.flex.grow(1),{borderTopLeftRadius:0,borderBottomLeftRadius:0}],urlDots:[O.l0.backgroundColor.greenDimmer,O.l0.borderRadius(4),O.l0.p(2),{lineHeight:1,"&:hover":[O.l0.cursor.pointer,O.l0.backgroundColor.greenDefault]}],goButton:[O.l0.position.absolute,O.l0.right(4),O.l0.top("50%"),{transform:"translateY(-50%)"}],text:[O.l0.ml(8),O.l0.mr(4),O.l0.color.foregroundDimmest],buttons:[O.l0.flex.row,O.l0.align.center,(0,a._)({},O.nC.max("mobileMax","root"),{span:{fontSize:0},svg:{marginRight:0}})],navButton:[O.l0.p(6),O.l0.borderRadius(4),O.l0.flex.shrink(0),{border:"none"}],fakeUrl:[O.l0.fontSize(12),O.l0.border(),{boxSizing:"content-box"},O.l0.borderRadius(6),O.l0.px(8),O.l0.py(2),O.l0.flex.grow(1),O.l0.rowWithGap(4),O.l0.align.center],devtoolsErrorsBadge:[O.l0.position.absolute,O.l0.center,O.l0.textAlign.center,O.l0.backgroundColor.accentNegativeStronger,O.l0.color.accentNegativeDimmest,O.l0.right(0),O.l0.top(-2),O.l0.p(2),O.l0.minWidth(14),O.l0.height(14),O.l0.borderRadius(16),O.l0.fontSize(10)]}),eR=function e(t,n,r,i){"use strict";var a=this;(0,o._)(this,e),this.history=[],this.historyIndex=-1,this.init=function(e,t){a.history.push({relativeUrl:e,port:t}),a.historyIndex=a.history.length-1,a.notifyChanges()},this.notifyChanges=function(){a.onChange(a.canGoBack(),a.canGoForward(),a.getCurrentRelativeUrl(),a.getCurrentPort())},this.canGoBack=function(){return a.historyIndex>0},this.canGoForward=function(){return a.historyIndex<a.history.length-1},this.getCurrentRelativeUrl=function(){return a.history[a.historyIndex].relativeUrl},this.getCurrentPort=function(){return a.history[a.historyIndex].port},this.push=function(e,t){(e!==a.getCurrentRelativeUrl()||t!==a.getCurrentPort())&&(a.history=a.history.slice(0,a.historyIndex+1),a.history.push({relativeUrl:e,port:t}),a.historyIndex=a.history.length-1),a.notifyChanges()},this.relativeUrlUpdate=function(e){if(a.pendingNavigations>0){a.pendingNavigations-=1;return}a.push(e,a.getCurrentPort())},this.back=function(){(0,X.xn)(),a.canGoBack()&&(a.historyIndex-=1,a.navigate(a.getCurrentRelativeUrl(),a.getCurrentPort()))},this.forward=function(){(0,X.Yl)(),a.canGoForward()&&(a.historyIndex+=1,a.navigate(a.getCurrentRelativeUrl(),a.getCurrentPort()))},this.navigate=function(e,t){var n=null!=t?t:a.getCurrentPort();a.requestIframeNavigateTo(e,n),a.push(e,n),a.pendingNavigations+=1},this.refresh=function(){var e,t;(0,X.rJ)(),a.requestIframeNavigateTo(null!==(e=a.getCurrentRelativeUrl())&&void 0!==e?e:"/",null!==(t=a.getCurrentPort())&&void 0!==t?t:80)},this.setPort=function(e){var t=a.getCurrentRelativeUrl();a.navigate(t,e)},this.onChange=r,this.pendingNavigations=0,this.requestIframeNavigateTo=i,this.init(t,n)};function eI(e){var t=e.children;return(0,s.tZ)(_.u,{tooltip:"Dev URLs are only active when someone is in the workspace. The dev URL is also subject to change. For production hosting, use Deployments.",children:t})}function eD(e){var t,n,r,i,o,a,u,f,h,v,g,w,Z,C,_,T,R,I,D,P,A,N,U=e.canEditDomain,M=e.onToggleDevtools,F=e.navigationState,W=e.replId,H=e.url,z=e.requestIframeNavigateTo,j=e.initialPort,q=e.initialPath,Y=e.forwardedPorts,J=e.onOpenPortSettings,$=e.devtoolsErrorCount,Q=e.setRefreshCb,ee=e.iframeLoading,et=(0,d.Z)(),en=(n=(t={initialPort:j,initialPath:q,navigationState:F,requestIframeNavigateTo:z}).initialPort,r=t.initialPath,i=t.navigationState,o=t.requestIframeNavigateTo,u=(a=(0,c._)((0,V.useState)(!1),2))[0],f=a[1],v=(h=(0,c._)((0,V.useState)(!1),2))[0],g=h[1],Z=(w=(0,c._)((0,V.useState)("Loading..."),2))[0],C=w[1],T=(_=(0,c._)((0,V.useState)(80),2))[0],R=_[1],I=(0,V.useCallback)(function(e,t,n,r){f(e),g(t),C(n),R(r)},[]),D=(0,p.Z)(o),P=(0,p.Z)(n),A=(0,p.Z)(r),N=(0,m.Z)(function(){return new eR(A.current,P.current,I,D.current)},[A,P,I,D]),(0,V.useEffect)(function(){"active"===i.state&&N.relativeUrlUpdate(i.relativeUrl)},[i.state,i.relativeUrl,N]),{canNavigateBack:u,canNavigateForward:v,navigateBack:N.back,navigateForward:N.forward,canNavigateToInputRelativeUrl:Z!==i.relativeUrl,navigateToInputRelativeUrl:function(){(0,X.Fq)(Z),N.navigate(Z)},inputRelativeUrl:Z,setInputRelativeUrl:C,refresh:N.refresh,setPort:N.setPort,selectedPort:T}),er=en.canNavigateForward,eo=en.navigateForward,el=en.canNavigateBack,ec=en.navigateBack,es=en.canNavigateToInputRelativeUrl,eu=en.navigateToInputRelativeUrl,ed=en.inputRelativeUrl,ef=en.setInputRelativeUrl,eh=en.refresh,ep=en.setPort,em=en.selectedPort;(0,V.useEffect)(function(){Q(function(){return eh})},[eh,Q]);var ev=function(e){var t,n,r,i=(t=(0,l._)({},ei,{variables:{replId:e}}),K.a(ea,t)),o=i.data,a=i.refetch,s=(0,c._)((0,V.useState)(!1),2),u=s[0],d=s[1],f=(0,V.useRef)(!1);if(!o||"Repl"!==o.repl.__typename)return{showEditReplcoDomainButton:!1};var h=null!==(r=null===(n=o.repl.domains)||void 0===n?void 0:n.filter(Boolean).filter(function(e){return!(null==e?void 0:e.hosting_deployment_id)}).map(function(e){return{domain:e.domain,state:e.state}}))&&void 0!==r?r:[];return h.length||f.current?(f.current=!0,{showEditReplcoDomainButton:!0,setIsEditingDomain:d,isEditingDomain:u,editDomainProps:{domains:h,refetch:a,replId:e,apexProxy:o.repl.apexProxy,hostedUrl:o.repl.hostedUrl,onUnlink:function(){a(),d(!1)},onLink:function(){a(),d(!1)}}}):{showEditReplcoDomainButton:!1}}(W),eg=(0,s.tZ)(eN,{});return"external-page"===F.state?eg=(0,s.tZ)(eA,{backToLocal:function(){return eh()}}):"active"===F.state&&(eg=(0,s.tZ)(eP,{canNavigateForward:er,navigateForward:eo,canNavigateBack:el,navigateBack:ec,canNavigateToInputRelativeUrl:es,navigateToInputRelativeUrl:eu,inputRelativeUrl:ed,setInputRelativeUrl:ef,refresh:eh,forwardedPorts:Y,setPort:ep,selectedPort:em,url:H,onOpenPortSettings:J,iframeLoading:ee})),(0,s.BX)(S.Tg,{css:eT.root,children:[eg,(0,s.tZ)(E.G,{css:O.l0.flex.row,children:(0,s.BX)(E.G,{css:eT.buttons,children:[U&&ev.showEditReplcoDomainButton?(0,s.BX)(s.HY,{children:[(0,s.tZ)(y.zx,{variant:"outlined",size:"small",text:"Edit custom domain",onClick:function(){return ev.setIsEditingDomain(!ev.isEditingDomain)},iconLeft:(0,s.tZ)(G.Z,{size:16})}),(0,s.tZ)(x.u,{isOpen:ev.isEditingDomain,onRequestClose:function(){return ev.setIsEditingDomain(!1)},children:(0,s.tZ)(ex,(0,l._)({},ev.editDomainProps))})]}):null,"active"===F.state?(0,s.BX)(E.G,{css:O.l0.position.relative,children:[(0,s.tZ)(y.zx,{size:"small",variant:"outlined",onClick:M,css:e_,text:"Devtools",iconLeft:(0,s.tZ)(L.Z,{})}),$>0?(0,s.tZ)(E.G,{css:eT.devtoolsErrorsBadge,children:(0,s.tZ)(k.xv,{variant:"small",multiline:!1,children:$>99?"99+":$.toString()})}):null]}):null,(0,s.tZ)(eI,{children:(0,s.tZ)(b.Z,{size:"small",variant:"outlined",css:e_,href:"".concat(H).concat(F.relativeUrl?F.relativeUrl:""),target:"_blank",iconLeft:(0,s.tZ)(B.Z,{}),text:et?"Open in the browser":"New tab",onClick:function(){(0,X.Ji)()}})})]})})]})}function eG(e){var t=e.url,n=(0,c._)((0,V.useState)(!1),2),r=n[0],i=n[1],o=(0,V.useRef)(null),a=function(){i(!0),o.current=setTimeout(function(){i(!1)},1500)};return(0,V.useEffect)(function(){return function(){o.current&&clearTimeout(o.current)}},[]),(0,s.tZ)(_.u,{isOpen:r,placement:"bottom",tooltip:r?"Copied!":"Copy link",delay:"none",children:(0,s.tZ)(w.hU,{alt:"Copy link",size:18,tooltipHidden:!1,onClick:function(){(0,v.Z)(t),a()},children:(0,s.tZ)(D.Z,{})})})}function eB(e){var t=e.canNavigateToInputRelativeUrl,n=e.navigateToInputRelativeUrl,r=e.inputRelativeUrl,i=e.setInputRelativeUrl,o=e.forwardedPorts,a=e.setPort,l=e.selectedPort,u=e.url,d=e.onOpenPortSettings,h=(0,c._)((0,V.useState)(!1),2),p=h[0],m=h[1],v=(0,M.U)(),y=v("radioGroup"),b=(0,f.Z)(function(){m(!1)},[]);return(0,s.BX)(E.G,{css:eT.urlOptionsRoot,innerRef:b,children:[p?(0,s.BX)(S.Tg,{css:eT.urlOptions,elevated:!0,children:[(0,s.BX)(E.G,{css:eT.urlOptionsSection,children:[(0,s.BX)(E.G,{css:eT.urlOptionsTitle,children:[(0,s.BX)(k.xv,{children:["Listening on ",(0,g.Z)("port",o.length),":"]}),(0,s.tZ)(w.hU,{alt:"Networking tool",onClick:d,children:(0,s.tZ)(N.Z,{})})]}),(0,s.tZ)(C.E,{tag:"fieldset",css:eT.portRadioGroup,name:y,value:l.toString(),onChange:function(e){a(parseInt(e.target.value,10)),m(!1)},children:o.map(function(e,t){return(0,s.BX)(E.G,{css:l===e.configuration.externalPort?eT.portOptionSelected:eT.portOption,children:[(0,s.tZ)(C.Y,{id:v(e.configuration.externalPort),value:e.configuration.externalPort.toString()}),(0,s.tZ)("label",{htmlFor:v(e.configuration.externalPort),css:eT.portOptionLabel,children:":".concat(e.configuration.localPort,"  :").concat(e.configuration.externalPort)})]},"".concat(t,"-").concat(e.configuration.externalPort,":").concat(e.configuration.localPort))})})]}),(0,s.BX)(E.G,{css:eT.urlOptionsSection,children:[(0,s.tZ)(k.xv,{children:"Dev URL:"}),(0,s.BX)(E.G,{css:eT.temporaryDevLinkWrapper,children:[(0,s.tZ)(k.xv,{css:eT.temporaryDevLinkText,maxLines:1,children:(0,s.tZ)(H(),{legacyBehavior:!0,href:u,passHref:!0,children:(0,s.tZ)("a",{css:eT.temporaryDevLink,target:"_blank",children:u})})}),(0,s.tZ)(eG,{url:u})]}),(0,s.tZ)(k.xv,{color:"dimmer",variant:"small",children:"Dev URLs are temporary and will sleep after you leave the workspace."})]})]}):null,(0,s.BX)("button",{css:p?eT.urlSelected:eT.url,onClick:function(){return m(!p)},children:[(0,s.tZ)(eI,{children:(0,s.tZ)(E.G,{css:eT.urlDots,children:"{...}"})}),".".concat(u.includes("replit.dev")?"replit.dev":"repl.co").concat((0,eS.O2)(l)?"":":"+l)]}),(0,s.tZ)(Z.II,{css:eT.urlPath2,style:p?{borderBottomRightRadius:0}:{},value:r,onKeyDown:function(e){"Enter"===e.key&&t&&n()},onChange:function(e){if(""===e.currentTarget.value){i("/");return}i(e.target.value)}})]})}function eP(e){var t=e.canNavigateForward,n=e.navigateForward,r=e.canNavigateBack,i=e.navigateBack,o=e.canNavigateToInputRelativeUrl,a=e.navigateToInputRelativeUrl,l=e.inputRelativeUrl,c=e.setInputRelativeUrl,u=e.refresh,d=e.forwardedPorts,f=e.setPort,p=e.selectedPort,m=e.url,v=e.onOpenPortSettings,g=e.iframeLoading,y=(0,eC.NJ)(),b=(0,h.P5)({controlName:ek,logFlagToAnalytics:!0}),x=(0,F.gf)("webviewpane.reload");return(0,s.BX)(E.G,{css:eT.navControls,children:[(0,s.tZ)(w.hU,{alt:"Back",tooltipDelay:"long",onClick:i,disabled:!r,css:eT.navButton,children:(0,s.tZ)(R.Z,{})}),(0,s.tZ)(w.hU,{alt:"Forward",tooltipDelay:"long",onClick:n,disabled:!t,css:eT.navButton,children:(0,s.tZ)(I.Z,{})}),(0,s.tZ)(w.hU,{alt:"Refresh".concat(x?" (".concat((0,F.Ih)(x,y),")"):""),tooltipDelay:"long",onClick:u,css:eT.navButton,children:g?(0,s.tZ)(P.Z,{}):(0,s.tZ)(A.Z,{})}),(0,s.BX)(E.G,{css:eT.urlWrapper,children:[b?(0,s.tZ)(eB,{canNavigateToInputRelativeUrl:o,navigateToInputRelativeUrl:a,inputRelativeUrl:l,setInputRelativeUrl:c,forwardedPorts:d,setPort:f,selectedPort:p,url:m,onOpenPortSettings:v}):(0,s.tZ)(Z.II,{css:eT.urlPath,value:l,onKeyDown:function(e){"Enter"===e.key&&o&&a()},onChange:function(e){if(""===e.currentTarget.value){c("/");return}c(e.target.value)}}),(0,s.tZ)(S.Tg,{elevated:!0,css:eT.goButton,children:(0,s.tZ)(w.hU,{alt:"Go to URL",disabled:!o,onClick:a,size:18,tooltipContents:(0,s.tZ)(F.bM,{keyCombo:"Enter"}),children:(0,s.tZ)(I.Z,{})})})]})]})}function eA(e){var t=e.backToLocal,n=(0,c._)((0,V.useState)(!1),2),r=n[0],i=n[1];return(0,s.BX)(E.G,{css:eT.navControls,children:[(0,s.tZ)(y.zx,{size:"small",variant:"outlined",onClick:function(){t(),i(!0)},loading:r,css:e_,text:"Back to my page",iconLeft:r?(0,s.tZ)(P.Z,{}):(0,s.tZ)(R.Z,{})}),(0,s.BX)(S.Tg,{elevated:!0,css:eT.fakeUrl,children:[(0,s.tZ)(_.u,{tooltip:"The URL bar is not supported when navigating to external pages. You can open in a new tab to use your browser instead.",delay:"none",placement:"auto",children:(0,s.tZ)(U.Z,{})}),(0,s.tZ)(k.xv,{variant:"small",color:"dimmer",children:"External page"})]})]})}function eN(){return(0,s.tZ)(E.G,{css:eT.navControls,children:(0,s.BX)(S.Tg,{elevated:!0,css:eT.fakeUrl,children:[(0,s.tZ)(_.u,{tooltip:"Page is loading, please wait.",delay:"none",placement:"auto",children:(0,s.tZ)(P.Z,{})}),(0,s.tZ)(k.xv,{variant:"small",color:"dimmer",children:"Loading your page"})]})})}},83436:function(e,t,n){n.d(t,{I5:function(){return p},sY:function(){return f}});var r=n(41733),i=n(21262),o=n(71440),a=n(58995);function l(){var e=(0,i._)(["\n  fragment ReplEnvironmentWebviewDeployBanner on Repl {\n    hostingDeployment {\n      ... on HostingDeployment {\n        id\n        currentBuild {\n          id\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n    hostingDeploymentPermissions {\n      canDeploy\n    }\n    config {\n      isVnc\n    }\n  }\n"]);return l=function(){return e},e}function c(){var e=(0,i._)(["\n  fragment ReplEnvironmentWebviewRepl on Repl {\n    id\n    prodUrl: hostedUrl(dotty: true)\n    devUrl: hostedUrl(dev: true)\n    currentUserPermissions {\n      linkDomain\n    }\n    lang {\n      id\n    }\n  }\n"]);return c=function(){return e},e}function s(){var e=(0,i._)(["\n  query ReplEnvironmentWebview($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        ...ReplEnvironmentWebviewRepl\n        ...ReplEnvironmentWebviewDeployBanner\n      }\n    }\n  }\n  ","\n  ","\n"]);return s=function(){return e},e}var u={},d=(0,o.Ps)(l()),f=(0,o.Ps)(c()),h=(0,o.Ps)(s(),f,d);function p(e){var t=(0,r._)({},u,e);return a.a(h,t)}},85515:function(e,t,n){n.d(t,{e:function(){return H}});var r=n(41733),i=n(66626),o=n(74985),a=n(76999),l=n.n(a),c=n(59868),s=n(9617),u=n(35972),d=n(63461),f=n(50959);function h(){return(0,f.useEffect)(function(){(0,c.j)(c.U3.WS_REPLCO_UNREACHABLE)},[]),(0,o.BX)("div",{className:"jsx-88c49dc4f1cb807b unreachable",children:[(0,o.BX)(u.gC,{align:"center",spacing:4,children:[(0,o.BX)(u.gC,{align:"center",children:[(0,o.tZ)(s.Z,{level:1,children:"\uD83D\uDE48"}),(0,o.tZ)(s.Z,{level:4,children:"This Repl link isnt broken!"}),(0,o.tZ)(s.Z,{level:4,foreground:2,children:"Its just blocked."})]}),(0,o.BX)(u.gC,{spacing:2,className:"why",children:[(0,o.tZ)(d.Z,{foreground:2,children:"Why this might be happening:"}),(0,o.tZ)(d.Z,{foreground:2,children:(0,o.BX)("ul",{className:"jsx-88c49dc4f1cb807b",children:[(0,o.BX)("li",{className:"jsx-88c49dc4f1cb807b",children:["Repl URLs could be"," ",(0,o.tZ)(d.Z,{fontWeight:"medium",foreground:1,children:"blocked by a firewall,"})," ","so contact your IT administrator"]}),(0,o.BX)("li",{className:"jsx-88c49dc4f1cb807b",children:["Repl URLs could be"," ",(0,o.tZ)(d.Z,{fontWeight:"medium",foreground:1,children:"blocked by your ISP,"})," ","so try getting in touch with them"]})]})})]}),(0,o.BX)(d.Z,{foreground:2,align:"center",children:["If you have any other questions, please check out"," ",(0,o.tZ)("a",{href:"https://docs.replit.com/teams-edu/it-administrators-toolkit",target:"_blank",rel:"noopener noreferrer",className:"jsx-88c49dc4f1cb807b",children:"our IT docs"})," ","or"," ",(0,o.tZ)("a",{href:"https://replit.com/support",target:"_blank",rel:"noopener noreferrer",className:"jsx-88c49dc4f1cb807b",children:"contact support"}),"."]})]}),(0,o.tZ)(l(),{id:"88c49dc4f1cb807b",children:".unreachable.jsx-88c49dc4f1cb807b{padding:var(--space-32)}.unreachable.jsx-88c49dc4f1cb807b ul.jsx-88c49dc4f1cb807b{list-style-position:inside}.unreachable.jsx-88c49dc4f1cb807b li.jsx-88c49dc4f1cb807b{padding-bottom:var(--space-16)}"})]})}var p=(0,f.createContext)(!1),m=n(74833),v=n(56596),g=n(29287),y=n(93918),b=(0,y.X)({styles0:[g.l0.align.center,g.l0.p(64)],styles1:[g.l0.align.center],styles2:[g.l0.textAlign.center,g.l0.pb(8)],styles3:[g.l0.textAlign.center],styles4:[g.l0.p(16)],styles5:[g.l0.color.foregroundDimmer,g.l0.textAlign.center,g.l0.pb(16)]});function w(){return(0,o.BX)(v.G,{css:b.styles0,children:[(0,o.BX)(v.G,{css:b.styles1,children:[(0,o.tZ)(s.Z,{level:1,children:"\uD83D\uDE48"}),(0,o.tZ)(m.xv,{css:b.styles2,variant:"headerDefault",children:"We've detected a crash loop"}),(0,o.tZ)(m.xv,{css:b.styles3,variant:"subheadDefault",color:"dimmer",children:"Preview is disabled until you click the run button again."})]}),(0,o.tZ)(v.G,{css:b.styles4,children:(0,o.tZ)(m.xv,{css:b.styles5,children:"There may be errors in the code that are causing your application to repeatedly crash."})})]})}var Z=n(56337),x=n(50782),C=n(62582),S=n(37463),k=n(60427),_=n(42549),E=n(40664);function T(e){var t,n=e.repl,r=e.onClick,i=(0,k.gg)().isDeployableRepl,a=(0,E.Z)("workspace","workspace-deployments-webview-banner"),l=a.shouldDisplay,s=a.register,u=a.dismiss;(0,f.useEffect)(function(){s()},[s]);var d=n.hostingDeploymentPermissions.canDeploy&&i,h=(null===(t=n.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"&&n.hostingDeployment.currentBuild;return d&&!h&&l?(0,o.tZ)(v.G,{children:(0,o.tZ)(_.U,{onClick:function(){(0,c.j)(c.U3.DEPLOY_PROJECT_SELECTED,{source:"workspace_webview_deploy_banner"}),u(),r()},onDismiss:u,rounded:!1})}):null}var R=n(43312),I=n(76588),D=n(1498),G={container:(0,R.iv)(g.l0.p(16),g.l0.height("100%"),g.l0.align.center),imageContainer:(0,R.iv)(g.l0.height("100%"),g.l0.colWithGap(16),g.l0.align.center,g.l0.justify.center,g.l0.width(300)),image:(0,R.iv)(g.l0.width(200))};function B(e){var t=e.hasForwardedPorts,n=e.showWebview;return(0,o.tZ)(v.G,{css:G.container,children:(0,o.BX)(v.G,{css:G.imageContainer,children:[(0,o.tZ)("div",{css:G.image,children:(0,o.tZ)(I.Z,{src:"/public/images/run_pointer.svg",alt:"A play button with a mouse pointer",height:250,width:400})}),t?(0,o.BX)(o.HY,{children:[(0,o.tZ)(m.h4,{level:3,variant:"subheadDefault",children:"Looks like you have a server running."}),(0,o.tZ)(D.zx,{text:"Show web content",colorway:"primary",onClick:n})]}):(0,o.tZ)(m.h4,{level:3,variant:"subheadDefault",children:"Start a server to see the hosted output."})]})})}var P=n(52234),A=n(81810),N=n(83436),L=n(30686),U=n(30509),O=n(43182),M=n(18107),X=n(54916),F=n(3409),W=(0,y.X)({desktopAppWebview:[g.l0.flex.growAndShrink(1),{border:"none",backgroundColor:g.TV.white}],iframe:[g.l0.flex.growAndShrink(1),{border:"none",display:"block",backgroundColor:g.TV.white}],self:[g.l0.backgroundColor.backgroundDefault,g.l0.height("100%"),g.l0.borderRadius(4),{overflow:"hidden"}]});function H(e){var t,n,a,l,s,u,d,m,g,y,b,k,_,E,R,I,D,G,H,z,j,q,Y,J,K,$,Q,ee,et,en,er,ei,eo,ea,el,ec=e.initialPort,es=void 0===ec?80:ec,eu=e.initialPath,ed=void 0===eu?"/":eu,ef=e.openPane,eh=e.containerRef,ep=e.openNetworkingTool,em=e.setRefreshCb,ev=(0,f.useId)(),eg=(0,x.Z)(),ey=(0,N.I5)({variables:{id:eg}}).data,eb=(null==ey?void 0:ey.repl.__typename)==="Repl"?ey.repl:null,ew=(0,f.useContext)(p),eZ=(0,L.S)().isCircuitBroken,ex=(0,f.useRef)(null),eC=(0,i._)((0,f.useState)(!0),2),eS=eC[0],ek=eC[1],e_=(R=(0,X.Z)().runner,D=(I=(0,i._)((0,f.useState)(R.getRunState()),2))[0],G=I[1],z=(H=(0,i._)((0,f.useState)(!1),2))[0],j=H[1],(0,f.useEffect)(function(){return R.onStateChanged(G)},[R]),{shouldHide:(D===M.Ah.OFFLINE||D===M.Ah.STOPPING||D===M.Ah.IDLE&&"html"!==R.mode)&&!z,forceShow:function(){return j(!0)}}),eE=e_.shouldHide,eT=e_.forceShow,eR=(0,i._)((0,f.useState)(0),2),eI=eR[0],eD=eR[1],eG=(0,F.J_)(eg),eB=(0,S.bg)(),eP=(null==eb?void 0:eb.lang.id)==="html"||(null==eb?void 0:eb.lang.id)==="html_beta",eA=(0,Z.Z)(),eN=(n=(t={urls:eG,unreachable:ew,isCircuitBroken:eZ,shouldHide:eE,forceShow:eT,forwardedPorts:eB,isInDesktopApp:eA,iframe:ex,initialPort:es,initialPath:ed,id:ev}).urls,a=t.unreachable,l=t.isCircuitBroken,s=t.shouldHide,u=t.forceShow,d=t.forwardedPorts,m=t.isInDesktopApp,g=t.iframe,y=t.initialPort,b=t.initialPath,k=t.id,_=!1,E=null,n?a?E=(0,o.tZ)(h,{}):l?E=(0,o.tZ)(w,{}):s?E=(0,o.tZ)(B,{hasForwardedPorts:d.length>0,showWebview:u}):m?(_=!0,E=(0,o.tZ)("webview",(0,r._)({"data-cy":"ws-webview",ref:g,src:V({url:n.iframeSrc,port:y,path:b,id:k}).toString(),css:W.desktopAppWebview},C.Z))):(_=!0,E=(0,o.tZ)("iframe",(0,r._)({title:"webview","data-cy":"ws-webview",ref:g,src:V({url:n.iframeSrc,port:y,path:b,id:k}).toString(),css:W.iframe},C.Z))):E=null,{isWebviewVisible:_,webviewElement:E}),eL=eN.isWebviewVisible,eU=eN.webviewElement,eO=(Y=(q={replId:eg,webviewId:ev,isHTML:eP,isWebviewVisible:eL,iframeOrWebviewRef:ex,iframeSrc:null==eG?void 0:eG.iframeSrc,onLoaded:function(){return ek(!1)},onDevtoolsErrorCountChange:eD}).replId,J=q.webviewId,K=q.isHTML,$=q.isWebviewVisible,Q=q.iframeOrWebviewRef,ee=q.iframeSrc,et=q.onLoaded,en=q.onDevtoolsErrorCountChange,ei=(er=(0,i._)((0,f.useState)({state:"loading",relativeUrl:null}),2))[0],eo=er[1],ea=(0,Z.Z)(),(0,f.useEffect)(function(){if(ea&&$&&ee){if(!Q.current)throw Error("Expected iframe to be defined when isWebviewRendered");var e=Q.current,t=new URL(ee);return e.addEventListener("did-navigate",n),e.addEventListener("did-navigate-in-page",n),function(){e.removeEventListener("did-navigate",n),e.removeEventListener("did-navigate-in-page",n)}}function n(e){var n=new URL(e.url),r=n.pathname+n.search+n.hash;if("did-navigate-in-page"===e.type&&et(),n.hostname!==t.hostname){eo(function(e){return"external-page"===e.state?e:{state:"external-page",relativeUrl:null}});return}eo(function(e){return"active"===e.state&&e.relativeUrl===r?e:{state:"active",relativeUrl:r}})}},[$,ea,ee,Q,et]),(0,f.useEffect)(function(){if(!ea&&ee){var e=new URL(ee);return window.addEventListener("message",t),function(){window.removeEventListener("message",t)}}function t(t){if(t.origin&&"null"!==t.origin&&new URL(t.origin).hostname===e.hostname&&"object"==typeof t.data&&(null===(n=t.data)||void 0===n?void 0:n.type)){var n,i,o=Q.current,a=t.data;if(null==a||!a.id||a.id===J)switch((null==a?void 0:a.id)===J&&t.source!==(null==o?void 0:o.contentWindow)&&O.Tb(Error("Expected event source to match iframe content window")),a.type){case"ready":et(),t.data.wasShown&&(null==o||null===(i=o.contentWindow)||void 0===i||i.postMessage({type:"toggleDevtools",source:"automatic"},"*"));break;case"event":var l=t.data,s=l.event,u=l.payload;"error"===s?O.Tb(u):(0,c.j)(s,(0,U._)((0,r._)({},u),{replId:Y,isHTML:K}));break;case"show-badge":en(t.data.count);break;case"page-navigation":if(a.payload.isExternal){eo(function(e){return"external-page"===e.state?e:{state:"external-page",relativeUrl:null}});return}var d=a.payload.path;eo(function(e){return"active"===e.state&&e.relativeUrl===d?e:{state:"active",relativeUrl:d}})}}}},[Y,J,ea,K,ee,Q,et,en]),{webviewEventMonitorState:ei}).webviewEventMonitorState;return eb&&eG?(el=eL?(0,o.tZ)(A.ZP,{navigationState:eO,canEditDomain:eb.currentUserPermissions.linkDomain,url:eG.presentationUrl,initialPort:es,initialPath:ed,forwardedPorts:eB,replId:eg,requestIframeNavigateTo:function(e,t){if(eD(0),ex.current){if(eA){var n,r=ex.current,i=new URL(e,eG.iframeSrc);t&&(i=(0,F.hw)(i.toString(),t)),r.loadURL(i.toString()),ek(!0);return}if(null===(n=ex.current)||void 0===n?void 0:n.contentWindow){var o=(0,F.hw)(eG.iframeSrc,t);o.searchParams.set("initialPath",e),o.searchParams.set("id",ev),ex.current.src=o.href,ek(!0)}}},onToggleDevtools:function(){if((0,P.t1)(),eD(0),!eA){var e,t;null===(t=ex.current)||void 0===t||null===(e=t.contentWindow)||void 0===e||e.postMessage({type:"toggleDevtools",source:"manual"},"*");return}var n=ex.current;n&&(n.isDevToolsOpened()?n.closeDevTools():n.openDevTools())},onOpenPortSettings:ep,devtoolsErrorCount:eI,setRefreshCb:em,iframeLoading:eS}):null,(0,o.BX)(v.G,{css:W.self,innerRef:eh,children:[el,eS?null:(0,o.tZ)(T,{repl:eb,onClick:function(){return ef({type:"deployments"})}}),eU]})):null}function V(e){var t=e.url,n=e.port,r=e.path,i=e.id,o=new URL(t);return(0,F.O2)(n)?o.port="":o.port=n.toString(),o.searchParams.set("initialPath",r),o.searchParams.set("id",i),o}},52234:function(e,t,n){n.d(t,{Fq:function(){return u},Ji:function(){return f},Yl:function(){return c},rJ:function(){return l},t1:function(){return d},xn:function(){return s}});var r=n(41733),i=n(98924),o=n(59868);function a(e){var t=e.actionType,n=(0,i._)(e,["actionType"]);(0,o.j)(o.U3.WS_WEBVIEW_USED,(0,r._)({type:t},n))}function l(){a({actionType:"refresh"})}function c(){a({actionType:"history_forward"})}function s(){a({actionType:"history_back"})}function u(e){a({actionType:"navigated_to",path:e})}function d(){a({actionType:"devtools_opened"})}function f(){a({actionType:"open_new_window"})}},86793:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(18107),i=n(50959);function o(e){var t=e.container,n=e.runner,o=e.refreshWebView;(0,i.useEffect)(function(){var e,i=[];return"outputs"===n.mode&&i.push(n.onBlockChanged(function(t){t.type===r.kH.EXECUTION&&1===t.data.exitCode&&(e=Date.now())})),i.push(t.onPortOpened(function(t){var n=t.isVnc;if(t.isForwarded&&!n){var r=Date.now();void 0!==e&&r-e<1e3||o()}})),function(){return i.forEach(function(e){return e()})}},[t,o,n])}},45495:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(18107),i=n(50959);function o(e){var t=e.runner,n=e.refreshWebView;(0,i.useEffect)(function(){if("html"===t.mode)return t.onStateChanged(function(e){e===r.Ah.RUNNING&&n()})},[t,n])}},30686:function(e,t,n){n.d(t,{S:function(){return f},e:function(){return d}});var r=n(66626),i=n(2689),o=n(18107),a=n(54916),l=n(19713),c=n(80703),s=n(50959),u=(0,l.cn)(!1),d=function(){return(0,c.KO)(u)};function f(){var e=(0,a.Z)().runner,t=(0,r._)(d(),2),n=t[0],l=t[1];return(0,s.useEffect)(function(){if("outputs"===e.mode){var t,n=[],r=Date.now(),a=Array(6),c=0;return n.push(e.onLocalRun(function(){r=Date.now(),l(!1)})),n.push(e.onStateChanged(function(e){if(!(t===o.Ah.RUNNING&&e===o.Ah.IDLE)){t=e;return}var n=c%6,s=Date.now();a[n]=s;var u=a[n>0?n-1:5];void 0!==u&&s-u<6e4&&null!=r&&r<u&&(l(!0),i.kg.info("webview circuit broken",{lastRunnerStops:JSON.stringify(a),runnerStopCount:c,lastLocalRunTimestamp:r})),c++,t=e})),function(){l(!1),n.forEach(function(e){return e()})}}},[e,l]),{isCircuitBroken:n}}},67774:function(e,t,n){n.d(t,{C:function(){return function e(t,n){if(!["context","action"].includes(t.data.type))throw Error("Command type not supported: "+t.data.type);if("action"===t.data.type)return{match:u.pl,data:{label:t.data.label,description:t.data.description,icon:t.data.iconPath?(0,a.tZ)(s.Z,{src:(0,f.Vh)(t.extension.baseUrl,t.data.iconPath),layout:"fill",alt:""}):(0,a.tZ)(a.HY,{children:" "}),type:"action",run:(0,r._)(function(){var e;return(0,o.Jh)(this,function(n){switch(n.label){case 0:if(!(e=t.run))throw Error("Action command must have run");return[4,e()];case 1:return[2,n.sent()]}})})}};var l,c=t.commands;if(!c)throw Error("Context command must have commands");return{match:u.pl,data:{label:t.data.label,description:t.data.description,icon:t.data.iconPath?(0,a.tZ)(s.Z,{src:(0,f.Vh)(t.extension.baseUrl,t.data.iconPath),layout:"fill",alt:""}):(0,a.tZ)(a.HY,{}),type:t.data.type},commands:(l=(0,r._)(function(r){var a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return[4,c({active:r.active,search:r.search,path:a=(0,i._)(n.path).concat([{data:t.data}])})];case 1:return[2,o.sent().map(function(t){return e(t,{path:a})})]}})}),function(e){return l.apply(this,arguments)})}}},V:function(){return p}});var r=n(27387),i=n(63257),o=n(96583),a=n(74985),l=n(74044),c=n(99149),s=n(76588),u=n(80259),d=n(19724),f=n(13090),h=l.Dy.Object({id:l.Dy.Optional(l.Dy.String()),icon:l.Dy.Optional(l.Dy.String()),type:l.Dy.Union([l.Dy.Literal("action"),l.Dy.Literal("context")]),label:l.Dy.String(),description:l.Dy.String(),contributions:l.Dy.Optional(l.Dy.Array(l.Dy.Enum(d.Y)))});function p(e,t){return m.apply(this,arguments)}function m(){return(m=(0,r._)(function(e,t){var n,i,a;return(0,o.Jh)(this,function(l){switch(l.label){case 0:return[4,e.data];case 1:if(n=l.sent(),!c.B4.Check(h,n))throw Error("Invalid command");if(i=null,"string"==typeof n.icon){if(""===n.icon)throw Error("Command icon cannot be empty. Omit it if you do not want an icon.");i=n.icon}if(a={data:{label:n.label,description:n.description,type:n.type,iconPath:i,id:n.id?n.id:void 0},extension:t.extension},n.contributions&&(a.data.contributions=n.contributions,t.logger.warn("Command ".concat(n.label," uses deprecated contributions field"))),"context"===n.type){var s;a.commands=(s=(0,r._)(function(n){var r,i,a,l,c,s,u,d,f;return(0,o.Jh)(this,function(o){switch(o.label){case 0:r=n.active,i=n.search,a=n.path,l=null,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,e.commands({active:r,search:i,path:a})];case 2:return l=o.sent(),[3,4];case 3:return c=o.sent(),t.logger.error(c.message,{commandError:c,api:"command"}),[2,[]];case 4:return[4,l.length];case 5:s=o.sent(),u=[],d=0,o.label=6;case 6:if(!(d<s))return[3,9];return f=u.push,[4,p(l[d],t)];case 7:f.apply(u,[o.sent()]),o.label=8;case 8:return d++,[3,6];case 9:return[2,u]}})}),function(e){return s.apply(this,arguments)})}else a.run=(0,r._)(function(){var n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,e.run()];case 1:return r.sent(),[2,void 0];case 2:return n=r.sent(),t.logger.error(n.message,{runError:n,api:"command"}),[2,{type:"error",message:n.message}];case 3:return[2]}})});return[2,a]}})})).apply(this,arguments)}},60442:function(e,t,n){n.d(t,{cR:function(){return b},nP:function(){return w},gI:function(){return Z},Sp:function(){return x}});var r=n(66626),i=n(50782),o=n(54916),a=n(22894),l=n(41733),c=n(21262),s=n(71440),u=n(58995),d=n(99165);function f(){var e=(0,c._)(["\n  query ReplConfigIsExtension($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          isExtension\n        }\n      }\n    }\n  }\n"]);return f=function(){return e},e}function h(){var e=(0,c._)(["\n  mutation UpdateReplConfigIsExtension(\n    $replId: String!\n    $isExtension: Boolean!\n  ) {\n    updateRepl(input: { id: $replId, isExtension: $isExtension }) {\n      repl {\n        id\n        config {\n          isExtension\n        }\n      }\n    }\n  }\n"]);return h=function(){return e},e}var p={},m=(0,s.Ps)(f()),v=(0,s.Ps)(h()),g=n(50959),y=n(46565);function b(){var e,t=(0,g.useContext)(a.Z),n=(0,r._)((0,g.useState)(null!==(e=null==t?void 0:t.replConfigIsExtension)&&void 0!==e&&e),2),i=n[0],l=n[1],c=(0,o.Z)().dotReplit;return(0,g.useEffect)(function(){return c.watch(function(e){var t,n,r;l(null!==(r=null===(n=e.config)||void 0===n?void 0:null===(t=n.extension)||void 0===t?void 0:t.isExtension)&&void 0!==r&&r)})},[c]),i}function w(){var e=(0,r._)((0,g.useState)(null),2),t=e[0],n=e[1],i=(0,o.Z)().dotReplit;return(0,g.useEffect)(function(){return i.watch(function(e){var t,r,i=null===(r=e.config)||void 0===r?void 0:null===(t=r.extension)||void 0===t?void 0:t.extensionID;i?n((0,y.T8)(i)):n(null)})},[i]),t}var Z=function(){var e=(0,o.Z)().dotReplit,t=(0,r._)((0,g.useState)(null),2),n=t[0],i=t[1];return(0,g.useEffect)(function(){return e.watch(function(e){var t,n,r=null===(n=e.config)||void 0===n?void 0:null===(t=n.extension)||void 0===t?void 0:t.staticDirectory;r?i({path:r,relativePath:r.replace(/^\.\//,"")}):i(null)})},[e]),n};function x(){var e,t,n,a,c=(0,i.Z)(),s=(e=(0,l._)({},p,{variables:{replId:c}}),u.a(m,e)),f=s.data,h=s.loading,y=s.error,b=(0,r._)((t=(0,l._)({},p,void 0),d.D(v,t)),1)[0],w=!h&&!y&&!!(null==f?void 0:f.repl)&&"Repl"===f.repl.__typename&&null!==(a=null===(n=f.repl.config)||void 0===n?void 0:n.isExtension)&&void 0!==a&&a,Z=(0,r._)((0,g.useState)(!1),2),x=Z[0],C=Z[1],S=(0,o.Z)().dotReplit;(0,g.useEffect)(function(){return S.watch(function(e){var t,n,r;C(null!==(r=null===(n=e.config)||void 0===n?void 0:null===(t=n.extension)||void 0===t?void 0:t.isExtension)&&void 0!==r&&r)})},[S]),(0,g.useEffect)(function(){h||y||x===w||b({variables:{replId:c,isExtension:x},optimisticResponse:{__typename:"RootMutationType",updateRepl:{__typename:"UpdateReplPayload",repl:{id:c,__typename:"Repl",config:{__typename:"ReplConfig",isExtension:x}}}}})},[h,y,c,w,x,b])}},70504:function(e,t,n){n.d(t,{LM:function(){return r.LM},Mu:function(){return i.Mu},WF:function(){return r.WF},WG:function(){return i.WG},jx:function(){return i.jx},ot:function(){return r.ot},r9:function(){return i.r9}});var r=n(1831),i=n(18440)},1831:function(e,t,n){n.d(t,{EO:function(){return R},I1:function(){return G},Kf:function(){return D},LM:function(){return T},WF:function(){return E},bN:function(){return k},dI:function(){return I},ot:function(){return _},zm:function(){return B}});var r=n(27387),i=n(41733),o=n(30509),a=n(66626),l=n(96583),c=n(59868),s=n(86612),u=n(54916),d=n(70226),f=n(19713),h=n(19334),p=n.n(h),m=n(50959),v=n(13090),g=n(16385),y=n(46565),b=n(34471),w=n(85234),Z=n.n(w),x=n(67887),C=n(18440),S=n(19418);function k(){var e,t=(0,S.E4)(C.We);return(0,m.useCallback)((e=(0,r._)(function(e){return(0,l.Jh)(this,function(n){return t({installationId:e}),[2]})}),function(t){return e.apply(this,arguments)}),[t])}function _(){var e,t=N(),n=t.throwSystemError,a=t.throwExtensionError,c=(0,S.E4)(C.nk),s=(0,S.ZC)(C.Ol),u=(0,S.Ld)();return(0,m.useCallback)((e=(0,r._)(function(e){var t,r,d,f,h,m,w,Z,S,k,_,E,T,R,I,D,G,B,P,A;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=e.installationId,d=void 0===(r=e.forceRefetch)||r,[4,(0,x.Al)()];case 1:if(!(f=l.sent())||f.error)return n({friendlyMessage:"Failed to load user context",error:f.error}),[2];if(h=f.result.userHasInternalApiEnabled,!(m=u.get(C.Lq).find(function(e){return e.installationId===t})))return[3,3];return[4,(0,x.V9)(m.baseUrl)];case 2:if(w=l.sent(),Z=s.createLogger({extensionId:m.extensionId,installationId:m.installationId,local:!0}),w.error)return S=(0,o._)((0,i._)({},m),{manifest:(0,v.fF)(),enableExperimentalApi:!1,enableInternalApi:!1,logger:Z.createLogger({extensionName:"Unnamed Extension"}),isLocal:!0}),s.info("Adding extension: ".concat(S.manifest.name),{extensionArgs:p()(S,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:S.isLocal,error:!0}),c(S),k="Failed to load extension manifest",w.error instanceof b.Jg&&(k=w.error.message),a({extensionId:m.extensionId,installationId:m.installationId,extensionError:{error:w.error,friendlyMessage:k}}),[2];return _=(0,g.MU)(w.result,"experimental-api"),E=(0,o._)((0,i._)({},m),{manifest:w.result,enableExperimentalApi:_,enableInternalApi:h,logger:Z.createLogger({extensionName:w.result.name}),isLocal:!0}),s.info("Adding extension: ".concat(E.manifest.name),{extensionArgs:p()(E,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!0}),c(E),[3,5];case 3:return[4,(0,x.mr)(t,d)];case 4:if((T=l.sent()).error)return n({friendlyMessage:"Something went wrong while downloading an extension",error:T.error}),[2];if(!(R=T.result))return n({friendlyMessage:"Extension failed to install",error:Error("Expected installation to be defined")}),[2];if(!(I=R.extension))return n({friendlyMessage:"Extension failed to install",error:Error("Expected extension to be defined")}),[2];if(!I.manifest)return a({extensionId:(0,y.T8)(I.id),installationId:(0,y.Ad)(R.id),extensionError:{friendlyMessage:"Extension failed to install",error:Error("Expected extension manifest to be defined")}}),[2];if("ExtensionManifestError"===I.manifest.__typename)return a({extensionId:(0,y.T8)(I.id),installationId:(0,y.Ad)(R.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest: ".concat(I.manifest.message),error:Error(I.manifest.message)}}),[2];if(!I.manifest||"ExtensionManifest"!==I.manifest.__typename)return a({extensionId:(0,y.T8)(I.id),installationId:(0,y.Ad)(R.id),extensionError:{friendlyMessage:"An error occurred while loading the extension manifest",error:Error("Expected extension manifest to be defined")}}),[2];return D=(0,v.tr)(I.manifest),G=(0,g.MU)(D,"experimental-api"),B=(0,y.T8)(I.id),P=I.enableInternalApi,A={extensionId:B,installationId:t,manifest:D,baseUrl:(0,v.BY)(I.url),enableExperimentalApi:G,enableInternalApi:h||P,logger:s.createLogger({extensionId:B,installationId:t,extensionName:D.name,local:!1}),isLocal:!1},s.info("Adding extension: ".concat(A.manifest.name),{extensionArgs:p()(A,["extensionId","installationId","baseUrl","manifest","enableExperimentalApi","enableInternalApi","isLocal"]),local:!1}),c(A),[2,R];case 5:return[2]}})}),function(t){return e.apply(this,arguments)}),[c,a,n,u,s])}function E(){var e,t=_(),n=N().throwSystemError;return(0,m.useCallback)((e=(0,r._)(function(e){var r,i,o,a,s;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return r=e.extensionId,i=e.replId,[4,(0,x.Wc)({extensionId:r,replId:i})];case 1:if((s=l.sent()).error)return n({error:s.error,friendlyMessage:"Something went wrong while installing an extension"}),[2];return(0,c.j)(c.U3.EXTENSION_INSTALLED,{name:null===(a=s.result)||void 0===a?void 0:null===(o=a.extension)||void 0===o?void 0:o.name,extensionId:r}),[4,t({installationId:(0,y.Ad)(s.result.id)})];case 2:return l.sent(),[2,s.result]}})}),function(t){return e.apply(this,arguments)}),[t,n])}function T(){var e,t=k(),n=(0,S.Ld)(),i=N().throwSystemError;return(0,m.useCallback)((e=(0,r._)(function(e){var r,o,a;return(0,l.Jh)(this,function(l){switch(l.label){case 0:if(r=e.installationId,o=e.replId,!(a=n.get(C._t).find(function(e){return e.installationId===r})))return i({friendlyMessage:"Extension appears to be already uninstalled",error:Error("Expected extension to be defined")}),[2];if(!a.installationId||!a.extensionId)return i({friendlyMessage:"Failed to uninstall extension",error:Error("Expected installationId to be defined")}),[2];return(0,c.j)(c.U3.EXTENSION_UNINSTALLED,{name:a.manifest.name,extensionId:a.extensionId}),[4,(0,x.Y4)({installationId:a.installationId,replId:o})];case 1:return l.sent(),[4,t(a.installationId)];case 2:return l.sent(),[2]}})}),function(t){return e.apply(this,arguments)}),[t,n,i])}function R(){var e,t=k(),n=_();return(0,m.useCallback)((e=(0,r._)(function(e){return(0,l.Jh)(this,function(r){switch(r.label){case 0:return[4,t(e)];case 1:return r.sent(),[4,n({installationId:e,forceRefetch:!0})];case 2:return r.sent(),[2]}})}),function(t){return e.apply(this,arguments)}),[t,n])}function I(){var e,t,n,i,o=(e=_(),t=(0,S.ZC)(C.Ol),n=N().throwSystemError,(0,m.useCallback)((i=(0,r._)(function(r){var i,o,a,c,s,u,d,f,h,p;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return[4,(0,x.Zw)(r)];case 1:if((i=l.sent()).error)return n({friendlyMessage:"Failed to load installed extensions",error:i.error}),[2];o=!0,a=!1,c=void 0,l.label=2;case 2:l.trys.push([2,9,10,11]),s=i.result[Symbol.iterator](),l.label=3;case 3:if(o=(u=s.next()).done)return[3,8];if(null===(f=(d=u.value).extension)||void 0===f?void 0:f.isDisabled)return t.info("Skipping disabled extension: ".concat(d.extension.name),{extension:!0,extensionId:d.extension.id,installationId:d.id}),[3,7];l.label=4;case 4:return l.trys.push([4,6,,7]),[4,e({installationId:(0,y.Ad)(d.id),forceRefetch:!0})];case 5:return l.sent(),[3,7];case 6:return h=l.sent(),t.error("Extension Loading error: ".concat(h.message),{extension:!0,errors:h.message}),[3,7];case 7:return o=!0,[3,3];case 8:return[3,11];case 9:return p=l.sent(),a=!0,c=p,[3,11];case 10:try{o||null==s.return||s.return()}finally{if(a)throw c}return[7];case 11:return[2]}})}),function(e){return i.apply(this,arguments)}),[e,n,t])),c=(0,S.E4)(C.Ol),s=(0,S.E4)(C.zk),u=(0,a._)((0,m.useState)(!1),2),f=u[0],h=u[1],p=(0,a._)((0,m.useState)(null),2),v=p[0],g=p[1],b=(0,a._)((0,m.useState)(null),2),w=b[0],Z=b[1];return(0,m.useEffect)(function(){if(v&&w&&!f){var e=v.replId;h(!0),o(e)}},[v,w,o,f]),(0,m.useCallback)(function(e){var t=e.replId,n=e.userId;if(!f){g({replId:t,userId:n});var r=(0,d.Z)({extension:!0,isInitialized:!0,replId:t,userId:n},{onLog:function(e){s(e)}});Z(r),c(r)}},[c,f,s])}function D(){var e,t=_(),n=(0,C.qr)(),i=(0,C.Mu)(),o=(0,S.E4)(C.ot);return(0,m.useCallback)((e=(0,r._)(function(e){var r,a;return(0,l.Jh)(this,function(l){return r=(0,v.BY)(e),(a=n.find(function(e){return e.baseUrl===r}))||o(a={extensionId:(0,y.T8)(Z()()),installationId:(0,y.Ad)(Z()()),baseUrl:r}),i.find(function(e){return e.extensionId===(null==a?void 0:a.extensionId)})||t({installationId:a.installationId}),[2]})}),function(t){return e.apply(this,arguments)}),[n,i,o,t])}function G(){var e=(0,u.Z)().container,t=(0,s.Z)(e),n=(0,S.E4)(C.M1),i=(0,S.Ld)(),o=_();return(0,m.useCallback)((0,r._)(function(){var e;return(0,l.Jh)(this,function(r){switch(r.label){case 0:if(!t)return[2];return[4,o({installationId:(e=n(t)).installationId,forceRefetch:!0})];case 1:return r.sent(),[2,i.get(C._t).find(function(t){return t.installationId===e.installationId})]}})}),[t,n,o,i])}function B(){var e=(0,u.Z)().container,t=(0,s.Z)(e),n=(0,S.E4)(C.M1),r=(0,C.Mu)();return(0,m.useMemo)(function(){if(t){var e=n(t);return r.find(function(t){return e.installationId===t.installationId})}},[t,r,n])}var P=(0,f.cn)(null,function(e,t,n){var r=e(C.Ol);t(C.wQ,n),r.error("Extension System Error: ".concat(n.error.message),{extensionSystem:!0,originalError:n.error.message,friendlyMessage:n.friendlyMessage})}),A=(0,f.cn)(null,function(e,t,n){var r=e(C._t),i=e(C.Ol),o=r.find(function(e){return e.extensionId===n.extensionId});if(i.error("Extension Error: ".concat(n.extensionError.friendlyMessage),{extension:!0,extensionId:n.extensionId,originalError:n.extensionError.error.message,friendlyMessage:n.extensionError.friendlyMessage}),!o){t(C.nk,{extensionId:n.extensionId,installationId:n.installationId,manifest:(0,v.fF)({name:n.extensionId}),baseUrl:"",enableExperimentalApi:!1,enableInternalApi:!1,logger:i.createLogger({extensionId:n.extensionId,extensionName:n.extensionId,installationId:n.installationId,local:void 0}),isLocal:null}),t(C.f4,{extensionId:n.extensionId,extensionError:n.extensionError});return}t(C.f4,{extensionId:n.extensionId,extensionError:n.extensionError})});function N(){return{throwSystemError:(0,S.E4)(P),throwExtensionError:(0,S.E4)(A)}}},67887:function(e,t,n){n.d(t,{Al:function(){return b},V9:function(){return g},Wc:function(){return s},Y4:function(){return d},Zw:function(){return m},mr:function(){return h}});var r=n(27387),i=n(96583),o=n(3720),a=n(68216),l=n(13090),c=n(65169);function s(e){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e){var t,n,r,a,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=e.extensionId,n=e.replId,!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.mutate({mutation:c.aq,variables:{extensionId:t,replId:n}})];case 1:if((a=i.sent()).errors&&a.errors.length>0)return[2,{error:Error("Error when installing extension: "+a.errors.map(function(e){return e.message}).join(", ")),result:null}];if(!(l=null===(r=a.data)||void 0===r?void 0:r.installExtension))return[2,{error:Error("Error when installing extension: expected result"),result:null}];if((null==l?void 0:l.__typename)==="UnauthorizedError"||(null==l?void 0:l.__typename)==="UserError")return[2,{error:Error("Error when installing extension: "+l.message),result:null}];if(!l.extension)return[2,{error:Error("Error when installing extension: expected extension to be set"),result:null}];if(!l.extension.url)return[2,{error:Error("Error when installing extension: Extension does not have a URL and cannot be installed"),result:null}];return[2,{result:l,error:null}]}})})).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r._)(function(e){var t,n,r,a,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=e.installationId,n=e.replId,!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.mutate({mutation:c.jF,variables:{installationId:t,replId:n}})];case 1:if((a=i.sent()).errors&&a.errors.length>0)return[2,{error:Error("Error when uninstalling extension: "+a.errors.map(function(e){return e.message}).join(", ")),result:null}];if(!(l=null===(r=a.data)||void 0===r?void 0:r.uninstallExtension))return[2,{error:Error("Error when uninstalling extension: expected result"),result:null}];if((null==l?void 0:l.__typename)==="NotFoundError"||(null==l?void 0:l.__typename)==="UserError")return[2,{error:Error("Error when uninstalling extension: "+l.message),result:null}];return[2,{result:l,error:null}]}})})).apply(this,arguments)}function h(e){return p.apply(this,arguments)}function p(){return(p=(0,r._)(function(e){var t,n,r=arguments;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(t=r.length>1&&void 0!==r[1]&&r[1],!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.query({query:c.AR,variables:{installationId:e},fetchPolicy:t?"network-only":"cache-first"})];case 1:if("ExtensionInstallation"!==(n=i.sent().data.extensionInstallationById).__typename)return[2,{error:Error("Expected to find extension installation"),result:null}];if(!n.extension)return[2,{error:Error("Expected installation.extension"),result:null}];return[2,{result:n,error:null}]}})})).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=(0,r._)(function(e){var t;return(0,i.Jh)(this,function(n){switch(n.label){case 0:if(!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.query({query:c.Ve,variables:{replId:e}})];case 1:if("ExtensionInstallationList"!==(t=n.sent().data.extensionInstallations).__typename)return[2,{error:Error("Expected to find ExtensionInstallationList"),result:null}];return[2,{result:t.installations,error:null}]}})})).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=(0,r._)(function(e){var t,n,r,o,c;return(0,i.Jh)(this,function(i){switch(i.label){case 0:t=(0,l.BP)(e),i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(t)];case 2:return[4,i.sent().text()];case 3:if(n=i.sent(),r=a.ku(n),(o=(0,l.U4)(r)).error)return[2,{error:o.error,result:null}];return[2,{result:o.manifest,error:null}];case 4:if("SyntaxError"===(c=i.sent()).name)return[2,{error:Error("Error when fetching manifest: invalid JSON"),result:null}];return[2,{error:Error("Error when fetching manifest: "+c.message),result:null}];case 5:return[2]}})})).apply(this,arguments)}function b(){return w.apply(this,arguments)}function w(){return(w=(0,r._)(function(){var e;return(0,i.Jh)(this,function(t){switch(t.label){case 0:if(!o.l)return[2,{error:Error("expected apolloClient to be initialized"),result:null}];return[4,o.l.query({query:c.LF,fetchPolicy:"cache-first"})];case 1:if(!(e=t.sent().data.currentUser)||"CurrentUser"!==e.__typename)return[2,{error:Error("Expected to find CurrentUser"),result:null}];return[2,{result:{userHasInternalApiEnabled:e.isAdmin||e.isStaff},error:null}]}})})).apply(this,arguments)}},18440:function(e,t,n){n.d(t,{Lq:function(){return C},M1:function(){return B},Mu:function(){return M},Ol:function(){return k},UB:function(){return T},UT:function(){return R},WG:function(){return H},We:function(){return P},_K:function(){return N},_t:function(){return x},c_:function(){return W},ep:function(){return I},f4:function(){return A},jx:function(){return X},nk:function(){return D},ot:function(){return G},qr:function(){return z},r9:function(){return F},s6:function(){return V},wQ:function(){return S},zk:function(){return E}});var r,i,o,a=n(27387),l=n(41733),c=n(30509),s=n(66626),u=n(63257),d=n(96583),f=n(50199),h=n(70226),p=n(64461),m=n(19713),v=n(35554),g=n.n(v),y=n(46565),b=n(85234),w=n.n(b),Z=n(19418),x=(0,m.cn)([]),C=(0,m.cn)([]),S=(0,m.cn)(null),k=(0,m.cn)((0,h.Z)({extension:!0,isInitialized:!1},{onLog:function(){throw Error("Logged before extension system was initialized.")}})),_=(0,m.cn)([]),E=(0,m.cn)(null,function(e,t,n){var r=e(_);t(_,(0,p.Uy)(r,function(e){e.push((0,p.Uy)(n,function(t){t.index=e.length})),e.length>1e3&&e.splice(0,e.length-1e3)}))}),T=(0,m.cn)(null,function(e,t){t(_,[])}),R=(0,m.cn)("local:true"),I=(0,m.cn)(function(e){var t=e(_),n=e(R);if(!n)return t;var r=n.split(" ").map(function(e){var t=(0,s._)(e.split(":"),2),n=t[0],r=t[1];return n&&void 0===r?function(e){return e.message.toLowerCase().includes(n.toLowerCase())}:n&&""===r?function(e){return void 0!==g()(e,n)}:n&&r?function(e){try{return String(g()(e,n))===r}catch(e){return!1}}:null}).filter(function(e){return null!==e});return t.filter(function(e){return r.every(function(t){return t(e)})})}),D=(0,m.cn)(null,(r=(0,a._)(function(e,t,n){return(0,d.Jh)(this,function(r){if(e(x).find(function(e){return e.extensionId===n.extensionId}))throw Error("Extension already loaded");return t(x,function(e){return(0,p.Uy)(e,function(e){var t,r,i,o,a,l,c,s,u=(r=n.baseUrl,i=n.extensionId,o=n.installationId,a=n.manifest,l=n.enableExperimentalApi,c=n.enableInternalApi,s=n.logger,{baseUrl:r,extensionId:i,installationId:o,manifest:a,isLocal:n.isLocal,stateAtom:(0,m.cn)({error:null,panes:[],scopes:new Set(null===(t=a.scopes)||void 0===t?void 0:t.map(function(e){return e.name})),enableExperimentalApi:l,enableInternalApi:c,commands:new Map}),logger:s});e.push(u)})}),[2]})}),function(e,t,n){return r.apply(this,arguments)})),G=(0,m.cn)(null,(i=(0,a._)(function(e,t,n){return(0,d.Jh)(this,function(r){if(e(C).find(function(e){return e.extensionId===n.extensionId||e.installationId===n.installationId||e.baseUrl===n.baseUrl}))throw Error("Extension already loaded");return t(C,function(e){return(0,p.Uy)(e,function(e){e.push(n)})}),[2]})}),function(e,t,n){return i.apply(this,arguments)})),B=(0,m.cn)(null,function(e,t,n){var r=e(C).find(function(e){return e.baseUrl===n});if(r)return r;var i={baseUrl:n,extensionId:(0,y.T8)(w()()),installationId:(0,y.Ad)(w()())};return t(C,function(e){return(0,p.Uy)(e,function(e){e.push(i)})}),i}),P=(0,m.cn)(null,(o=(0,a._)(function(e,t,n){return(0,d.Jh)(this,function(e){return t(x,function(e){return(0,p.Uy)(e,function(e){var t=e.findIndex(function(e){return"extensionId"in n?e.extensionId===n.extensionId:e.installationId===n.installationId});-1!==t&&e.splice(t,1)})}),[2]})}),function(e,t,n){return o.apply(this,arguments)})),A=(0,m.cn)(null,function(e,t,n){var r=e(x).find(function(e){return e.extensionId===n.extensionId});if(!r)throw Error("Extension not found");t(r.stateAtom,function(e){return(0,p.Uy)(e,function(e){e.error=n.extensionError})})}),N=(0,m.cn)(null,function(e,t,n){var r=n.createCommand.id;t(n.extensionStateAtom,function(e){return(0,p.Uy)(e,function(e){e.commands.set(r,n.createCommand)})})}),L=(0,m.cn)(function(e){return e(x).flatMap(function(t){return(0,u._)(e(t.stateAtom).commands.values())})}),U=(0,m.cn)(function(e){return e(x).map(function(e){var t;return null===(t=e.manifest.fileHandlers)||void 0===t?void 0:t.map(function(t){return(0,c._)((0,l._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})}),O=(0,m.cn)(function(e){return e(x).map(function(e){var t;return null===(t=e.manifest.tools)||void 0===t?void 0:t.map(function(t){return(0,c._)((0,l._)({},t),{extension:e})})}).flat().filter(function(e){return!!e})});function M(){return(0,Z.ZC)(x)}function X(e){return M().find(function(t){return t.installationId===e})}function F(e){var t=X(e);return t&&e?t.stateAtom:null}function W(){return(0,Z.ZC)(U)}function H(){return(0,Z.ZC)(O)}function V(e){var t=(0,Z.ZC)(L);return(0,f.Z)(function(){return t.filter(function(t){return t.contributions.includes(e)})},[t,e])}function z(){return(0,Z.ZC)(C)}},19418:function(e,t,n){n.d(t,{E4:function(){return f},Ld:function(){return s},OA:function(){return u},Wv:function(){return h},ZC:function(){return d}});var r=n(66626),i=n(74985),o=n(19713),a=n(80703),l=n(50959),c=(0,l.createContext)(null);function s(){return function(){var e=(0,l.useContext)(c);if(!e)throw Error("Expected extensions context");return e}().store}var u=function(e){var t=s();return(0,a.KO)(e,{store:t})};function d(e){var t=s();return(0,a.Dv)(e,{store:t})}var f=function(e){var t=s();return(0,a.b9)(e,{store:t})};function h(e){var t=e.children,n=(0,r._)((0,l.useState)(function(){return(0,o.MT)()}),1)[0];return(0,i.tZ)(c.Provider,{value:{store:n},children:t})}},19724:function(e,t,n){var r,i;n.d(t,{Y:function(){return r}}),(i=r||(r={})).CommandBar="commandbar",i.FiletreeContextMenu="filetree-context-menu",i.SidebarSearch="sidebar-search",i.EditorContextMenu="editor-context-menu"},70226:function(e,t,n){n.d(t,{Z:function(){return function e(t,n){var r=function(e){var r,i,l,s,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{logLevel:"debug"},h=null!==(r=(i={},(0,o._)(i,"debug",c.kg.debug),(0,o._)(i,"warn",c.kg.warn),(0,o._)(i,"info",c.kg.info),(0,o._)(i,"error",c.kg.error),i)[f.logLevel])&&void 0!==r?r:c.kg.debug;(null!==(l=(s={},(0,o._)(s,"debug",d.debug),(0,o._)(s,"warn",d.warn),(0,o._)(s,"info",d.info),(0,o._)(s,"error",d.error),s)[f.logLevel])&&void 0!==l?l:d.debug)(e,f),h(e,u()((0,a._)({},f,t),["replId","logLevel"])),n.onLog((0,a._)({message:e},f,t))};return{context:t,info:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,(0,l._)((0,a._)({},t),{logLevel:"info"}))},warn:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,(0,l._)((0,a._)({},t),{logLevel:"warn"}))},error:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r(e,(0,l._)((0,a._)({},t),{logLevel:"error"}))},createLogger:function(r){return e((0,a._)({},t,r),n)}}}},i:function(){return i}});var r,i,o=n(42516),a=n(41733),l=n(30509),c=n(2689),s=n(59245),u=n.n(s),d=n(49500);(r=i||(i={})).debug="debug",r.info="info",r.warn="warn",r.error="error"},3574:function(e,t,n){n.d(t,{Cl:function(){return a},VD:function(){return d},uN:function(){return u}});var r=n(19713),i=n(80703),o=n(50959),a=(0,o.createContext)(null),l=(0,r.cn)(null),c=(0,r.cn)(null,function(e,t,n){t(l,n)});function s(){var e=(0,o.useContext)(a);if(!e)throw Error("Expected store in context");return e}function u(){return(0,i.Dv)(l,{store:s()})}function d(e){var t=(0,i.Dv)(l,{store:s()}),n=(0,i.b9)(c,{store:s()});(0,o.useEffect)(function(){t!==e&&n(e)},[e,t,n])}},88883:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(54916),i=n(50959),o=n(19659);function a(e){var t=(0,r.Z)().fs,n=(0,i.useCallback)(function(n,r){var i=n.code,a=n.insertAt,l=n.newLine,c=void 0===l||l;if(!e||(0,o.T3)(e)||(0,o.sL)(e)||(0,o.IQ)(e)||(0,o.hj)(e))throw Error("Invalid file, this should never happen");if(0!==i.length)var s=t.watchTextFile(e,{onReady:function(e){var n=e.initialContent,o=e.writeChange,l=n.toString(),u="end"===a?l.length:a,d=i;c&&(0!==u&&u!==l.length&&-1===(u=l.indexOf("\n",u))&&(u=l.length),0!==u&&"\n"!==l[u-1]&&(d="\n"+d),"\n"!==l[u]&&(d+="\n")),o({from:u,insert:d},r),t.flush().finally(function(){s()})}})},[e,t]);return!e||(0,o.T3)(e)||(0,o.sL)(e)||(0,o.IQ)(e)||(0,o.hj)(e)?null:n}},51279:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(27387),i=n(66626),o=n(63257),a=n(96583),l=n(58626),c=n(59868),s=n(17789),u=n(54916),d=n(26851),f=n(58091),h=n(50959),p=n(19659),m=n(30084),v=n(63009),g=n(86790);function y(e){var t,n,y,b=e.moveOrDeleteFile,w=(0,u.Z)().fs,Z=(0,d.K)(),x=(0,h.useRef)(new Map),C=(0,f.ex)(),S=(0,i._)((0,h.useState)(!1),2),k=S[0],_=S[1],E=(0,i._)((0,h.useState)(!1),2),T=E[0],R=E[1],I=(0,i._)((0,h.useState)([]),2),D=I[0],G=I[1],B=(0,g.k)(),P=(0,v.uV)(),A=D.map(function(e){return e.path}).map(function(e){return{title:e,path:e}}),N=(0,i._)((0,h.useState)(),2),L=N[0],U=N[1],O=(0,f.Gg)();(0,h.useEffect)(function(){if(!(!C||x.current.has(C))&&C!==s.w){var e=function(e){var t=e.node.path;O(e.eventType===m.kS.Move?{path:t,type:"move",to:e.to}:{path:t,type:"delete"}),b&&b(e),x.current.delete(C),G(function(e){return e.filter(function(e){return e.path!==C})})};(0,p.Mb)(C)?w.watchTextFile(C,{onMoveOrDelete:e,onError:function(e,t){e.code||(w.flush(),w.persist({skipDebounce:!0}),P({error:e,extras:t,tags:{ot:!0},origin:"useContentsDiverged: fs.watchTextFile"}))},onReconnectFail:function(e,t){G(function(n){return(0,o._)(n.filter(function(e){return e.path!==C})||[]).concat([{path:C,prompt:t,cb:e}])}),Z("user:ot:diverged",{path:C,divergence:t}),_(!0),L||U(C)}}):w.watchFile(C,{onChange:function(){},onMoveOrDelete:e}),x.current.set(C,!0)}},[C,w,P,b,L,Z,O]);var M=(t=(0,r._)(function(e){return(0,a.Jh)(this,function(t){switch(t.label){case 0:return(0,c.j)(c.U3.FILE_RECONNECT_FALLBACK_CHOSEN,{choice:e}),(0,c.j)(c.U3.CONTENTS_DIVERGED_ACTION,{action:"local"===e?"client":"server"}),R(!0),[4,Promise.all(D.map(function(t){return G(function(e){var n=e.filter(function(e){return e.path!==t.path});return 0===n.length?_(!1):U(n[0].path),n}),t.cb(e)}))];case 1:return t.sent(),R(!1),[2]}})}),function(e){return t.apply(this,arguments)}),X=L?D.find(function(e){return e.path===L}):null,F=null==X?void 0:X.prompt,W=(0,l.J)({left:{code:null!==(n=null==F?void 0:F.localContent)&&void 0!==n?n:"",filePath:L},right:{code:null!==(y=null==F?void 0:F.remoteContent)&&void 0!==y?y:"",filePath:L}});return{isConverging:T,didContentsDiverge:k,showMoreDetail:B,failedFiles:D,failedFilesOptions:A,selectedFile:L,setSelectedFile:U,reviewingPrompt:F,onChoice:M,local:W.left,remote:W.right}}},6597:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(66626),i=n(47001),o=n(17867),a=n(54916),l=n(50959);function c(){var e=(0,a.Z)().container,t=(0,o.Z)(e),n=(0,r._)((0,l.useState)(!1),2),c=n[0],s=n[1];return((0,l.useEffect)(function(){t===i.em.CONNECTED&&s(!0)},[t]),c)?{didConnectOnce:c,didDisconnect:t!==i.em.CONNECTED}:{didConnectOnce:!1,didDisconnect:!1}}},1308:function(e,t,n){n.d(t,{F:function(){return H}});var r=n(27387),i=n(66626),o=n(96583),a=n(59121),l=n(55534),c=n(50782),s=n(2689),u=n(52296),d=n.n(u),f=function(e){var t=d()(e,{baseUrl:!1}).pathname.replace(/\.git$/,"");if(t){var n=(0,i._)(t.split("/").reverse(),2),r=n[0],o=n[1];if(o&&r)return{username:o,repository:r}}},h=n(81106),p=n(54916),m=n(45123),v=n(41733),g=n(33859),y=n.n(g),b=n(50959),w=n(21262),Z=n(71440),x=n(78711);function C(){var e=(0,w._)(["\n  query WorkspacePatchDotReplitRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        rootOriginReplUrl\n      }\n    }\n  }\n"]);return C=function(){return e},e}var S={},k=(0,Z.Ps)(C()),_=function(e,t){return{op:"add",path:e,value:JSON.stringify(t)}},E=new Map([["hintsList","hints"]]);function T(){return(T=(0,r._)(function(e){var t,n,a,l,c,s,u,d,f,h,p,m,g,y,b;function w(){return Z.apply(this,arguments)}function Z(){return(Z=(0,r._)(function(){var e,n,r;return(0,o.Jh)(this,function(i){switch(i.label){case 0:if(!(e="object"==typeof a.env?a.env:null)||0===Object.keys(e).length)return[2];return r=(n="object"==typeof l.env?l.env:null)?(0,v._)({},e,n):e,[4,t.updateDotReplit([_("env",r)])];case 1:return i.sent(),[2]}})})).apply(this,arguments)}function x(){return C.apply(this,arguments)}function C(){return(C=(0,r._)(function(){var e,r,i,c;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(null===(e=l.nix)||void 0===e?void 0:e.channel)return[2];if(null==a?void 0:null===(r=a.nix)||void 0===r?void 0:r.channel)return[3,2];return[4,n.getLatestStableChannel()];case 1:if(!(c=o.sent()).channel)return[2];return i=c.channel,[3,3];case 2:i=a.nix.channel,o.label=3;case 3:return[4,t.updateDotReplit([_("nix/channel",i)])];case 4:return o.sent(),[2]}})})).apply(this,arguments)}function S(){return(S=(0,r._)(function(e){var n,r,i,c,s;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(r=!!(n=l[e]),Array.isArray(n)?r=n.length>0:n&&"object"==typeof n&&(r=Object.keys(n).length>0),c=null!==(i=E.get(e))&&void 0!==i?i:e,r||!a[c])return[2];return s=_(c,a[c]),[4,t.updateDotReplit([s])];case 1:return o.sent(),[2]}})})).apply(this,arguments)}return(0,o.Jh)(this,function(r){switch(r.label){case 0:t=e.dotReplit,n=e.nixService,a=e.templateConfig,l=e.config,c=[],s={entrypoint:"entrypoint config",hidden:"hidden files config",audio:"audio config",run:"run command",refreshWebViewOnFileChange:"webview refresh config",language:"language config",onBoot:"onBoot command",languages:"languages config",compile:"compile command",debugger:"debugger config",packager:"packager config",interpreter:"interpreter config",unitTest:"unit test config",nix:x,env:w,hosting:"hosting config",gitHubImport:"GitHub import config",auth:"Repl Auth config",hintsList:"Hints config",ports:"Ports config",deployment:"deployment config",orderedEnv:null,modules:"nix modules config",extension:"extension config",rules:"rules config",suggestions:"suggestions config",objectStorage:"object storage config"},u=[],d=!0,f=!1,h=void 0;try{for(p=Object.entries(s)[Symbol.iterator]();!(d=(m=p.next()).done);d=!0)y=(g=(0,i._)(m.value,2))[0],b=g[1],null!==b&&("function"==typeof b?u.push(b()):u.push(function(e){return S.apply(this,arguments)}(y)))}catch(e){f=!0,h=e}finally{try{d||null==p.return||p.return()}finally{if(f)throw h}}return[4,Promise.all(u)];case 1:return r.sent(),[2,c]}})})).apply(this,arguments)}var R=n(71042),I=n(50682),D=n(4004),G=n(37229),B=n(39756),P=n(30084),A=n(99165);function N(){var e=(0,w._)(["\n  query WorkspaceDoGitHubImportFlow($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        config {\n          gitRemoteUrl\n          doClone\n        }\n      }\n    }\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n      }\n      username\n    }\n  }\n"]);return N=function(){return e},e}function L(){var e=(0,w._)(["\n  mutation WorkspaceDoGitHubImportFlowFinishClone($input: UpdateReplInput!) {\n    updateRepl(input: $input) {\n      repl {\n        id\n        config {\n          doClone\n        }\n      }\n    }\n  }\n"]);return L=function(){return e},e}function U(){var e=(0,w._)(["\n  query GitHubImportRootOriginReplUrl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        rootOriginReplUrl\n      }\n    }\n  }\n"]);return U=function(){return e},e}var O={},M=(0,Z.Ps)(N()),X=(0,Z.Ps)(L());U();var F=n(91620).lW;function W(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return["bash","-c",t.join("&&")]}function H(e){var t,n,u,d,g,w,Z,C,_,E,N,L,U,H,V,z,j,q,Y,J,K,$,Q,ee,et,en,er=e.insertConfigPlugin,ei=e.setConfigScreenLockIsOpen,eo=e.openFile,ea=(0,c.Z)(),el=(0,i._)((t=(0,v._)({},O,void 0),A.D(X,t)),2),ec=el[0],es=el[1],eu=(0,i._)((0,b.useState)(null),2),ed=eu[0],ef=eu[1],eh=(0,p.Z)(),ep=eh.container,em=eh.fs,ev=eh.runner,eg=eh.dotReplit,ey=eh.git,eb=(0,h.Z)(ep),ew=(0,l.Z)(),eZ=ew.showError,ex=ew.showConfirm,eC=(u=(n=(0,p.Z)()).dotReplit,d=n.nixService,g=(0,c.Z)(),Z=(0,i._)((w=(0,v._)({},S,void 0),x.t(k,w)),1)[0],_=(C=(0,l.Z)()).showWarning,E=C.showError,(0,b.useCallback)((N=(0,r._)(function(e){var t,n,r,i,a,l,c,f,h,p,m,v;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return[4,u.getConfig()];case 1:if(!(n=o.sent().config)||(null===(t=n.modules)||void 0===t?void 0:t.length))return[2];return[4,Z({variables:{replId:g}})];case 2:if(!(null==(i=(null==(r=o.sent().data)?void 0:r.repl.__typename)==="Repl"?r.repl:null)?void 0:i.rootOriginReplUrl))return[2];try{a=y().parse(e.toString())}catch(e){return E("Failed to parse template .replit file"),s.kg.error("GitHub Import: Failed to parse template .replit file"),[2]}if(!a)return[2];return[4,function(e){return T.apply(this,arguments)}({nixService:d,dotReplit:u,config:n,templateConfig:a})];case 3:l=o.sent(),c=!0,f=!1,h=void 0;try{for(p=l[Symbol.iterator]();!(c=(m=p.next()).done);c=!0)v=m.value,_(v,1e3)}catch(e){f=!0,h=e}finally{try{c||null==p.return||p.return()}finally{if(f)throw h}}return[2]}})}),function(e){return N.apply(this,arguments)}),[g,_,E,u,d,Z]));(0,b.useEffect)(function(){es.error&&eZ("Failed to finish cloning Repl - "+es.error)},[es.error,eZ]),(0,b.useEffect)(function(){ed&&eZ("Failed to finish cloning Repl - "+ed)},[ed,eZ]),(0,b.useEffect)(function(){es.data&&ex("Finished cloning Repl")},[es.data,ex]),(0,b.useEffect)(function(){eS()},[]);var eS=(0,i._)((U={variables:{replId:ea},fetchPolicy:"no-cache",onCompleted:(L=(0,r._)(function(e){var t,n,r,i,a,l;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(t=e.repl,n=e.currentUser,"Repl"!==t.__typename||!n||"CurrentUser"!==n.__typename||!t.config.gitRemoteUrl||!t.config.doClone)return[2];o.label=1;case 1:return o.trys.push([1,3,4,5]),ei(!0),[4,eL({remote:null!==(i=t.config.gitRemoteUrl)&&void 0!==i?i:"",accessToken:null!==(a=null===(r=n.gitHubInfo)||void 0===r?void 0:r.accessToken)&&void 0!==a?a:null})];case 2:return o.sent(),[3,5];case 3:return l=o.sent(),s.kg.error("GitHub Import: Failed to do GitHub import flow",{originalError:String(l)}),ef(String(l)),[3,5];case 4:return ei(!1),[7];case 5:return[2]}})}),function(e){return L.apply(this,arguments)})},H=(0,v._)({},O,U),x.t(M,H)),1)[0],ek=(V=(0,r._)(function(){return(0,o.Jh)(this,function(e){switch(e.label){case 0:return[4,ey.init({initialCommit:!1,includeAllInitialFiles:!1})];case 1:return e.sent(),[2]}})}),function(){return V.apply(this,arguments)}),e_=(z=(0,r._)(function(e){return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,ey.addRemote({name:"origin",url:e})];case 1:return t.sent(),[2]}})}),function(e){return z.apply(this,arguments)}),eE=(j=(0,r._)(function(){var e,t;return(0,o.Jh)(this,function(n){switch(n.label){case 0:return[4,eb({args:W("git remote show origin | grep 'HEAD branch'")})];case 1:if(!(e=n.sent()).output)return[2,"main"];return(t=(0,i._)(e.output.split(": "),2))[0],[2,t[1].trim()]}})}),function(){return j.apply(this,arguments)}),eT=(q=(0,r._)(function(e){return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,eb({args:W("git checkout -f -b ".concat(e," origin/").concat(e))})];case 1:return t.sent(),[2]}})}),function(e){return q.apply(this,arguments)}),eR=(Y=(0,r._)(function(e){var t,n,r,i;return(0,o.Jh)(this,function(o){switch(o.label){case 0:if(n=void 0!==(t=e.deepen)&&t,r=e.remote,i=e.branch,!r.startsWith("https://api.glitch.com"))return[3,2];return[4,eb({args:W("git","fetch",r,"+refs/heads/*:refs/remotes/origin/*")})];case 1:return o.sent(),[2];case 2:if(!n)return[3,4];return[4,eb({args:W("git fetch origin ".concat(i," --progress --deepen=10"))})];case 3:case 5:case 7:return[2,o.sent()];case 4:if(!(""!==i))return[3,6];return[4,eb({args:W("git fetch origin ".concat(i," --progress --depth=10"))})];case 6:return[4,eb({args:W("git fetch origin +refs/heads/*:refs/remotes/origin/* --progress --depth=10")})]}})}),function(e){return Y.apply(this,arguments)}),eI=(J=(0,r._)(function(){var e,t,n,r,i,a;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return[4,em.readDir(B.Ql)];case 1:if((r=o.sent()).error)return[2];return[4,eg.getConfig()];case 2:if(!(null===(t=(i=o.sent()).config)||void 0===t?void 0:null===(e=t.gitHubImport)||void 0===e?void 0:e.requiredFiles))return[3,4];return a=i.config.gitHubImport.requiredFiles.concat(".cache").map(function(e){return new RegExp(e)}),[4,Promise.all(r.children.filter(function(e){var t;return t=e.filename,!a.some(function(e){return null!=t.match(e)})}).map(function(e){return e.type===P.Tv.Directory?em.deleteDir(e.filename):em.deleteFile(e.filename)}))];case 3:return o.sent(),[3,6];case 4:if(!(null===(n=i.config)||void 0===n?void 0:n.entrypoint))return[3,6];return[4,em.deleteFile(i.config.entrypoint)];case 5:o.sent(),o.label=6;case 6:return[2]}})}),function(){return J.apply(this,arguments)}),eD=(K=(0,r._)(function(){return(0,o.Jh)(this,function(e){switch(e.label){case 0:return[4,em.stat("requirements.txt")];case 1:if(!e.sent().exists)return[3,3];return[4,eb({args:W("git","clean","-fdx","pyproject.toml","poetry.lock")})];case 2:e.sent(),e.label=3;case 3:return[2]}})}),function(){return K.apply(this,arguments)}),eG=($=(0,r._)(function(e,t){var n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,ek()];case 1:return r.sent(),[4,e_(e)];case 2:return r.sent(),[4,eE()];case 3:return[4,eR({deepen:!1,remote:e,remoteToken:t,branch:n=r.sent()})];case 4:return r.sent(),[4,eT(null!=n?n:"")];case 5:if(r.sent(),"html"!==ev.mode)return[3,8];return[4,(0,R.r)(ep,B.Ql)];case 6:return r.sent(),[4,ev.run()];case 7:r.sent(),r.label=8;case 8:return[2]}})}),function(e,t){return $.apply(this,arguments)}),eB=(Q=(0,r._)(function(){var e;return(0,o.Jh)(this,function(t){switch(t.label){case 0:return[4,(0,m.W)({dotReplit:eg,fs:em})];case 1:return(e=t.sent().entrypoint)&&eo({path:e}),[2]}})}),function(){return Q.apply(this,arguments)}),eP=(ee=(0,r._)(function(e,t){var n;return(0,o.Jh)(this,function(r){switch(r.label){case 0:return[4,(0,I.J9)({repoNameWithOwner:e,accessToken:t})];case 1:if("error"in(n=r.sent()))return[2,{hasDotReplit:!1,hasProcfile:!1}];return[2,{hasDotReplit:n.some(function(e){return e.path===D.l}),hasProcfile:n.some(function(e){return e.path===a.E})}]}})}),function(e,t){return ee.apply(this,arguments)}),eA=(et=(0,r._)(function(e,t){var n,r,i,l,c,s,u,d;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return[4,(0,I.LK)({repoNameWithOwner:e,filePath:a.E,accessToken:t})];case 1:if("error"in(n=o.sent())||(r=F.from(n.content,"base64").toString(),!(i=(0,a.c)(r))||!(c=null!==(l=i.web)&&void 0!==l?l:i.worker)))return[2,{showConfigPanel:!0}];return s=c.command+" "+c.options.join(" "),[4,eg.updateDotReplit([(0,G.KQ)(s),(0,G.xz)("interpreter")])];case 2:if(u=o.sent(),d=i.web&&!i.worker||!i.web&&i.worker,u.error||!d)return[2,{showConfigPanel:!0}];return[2,{showConfigPanel:!1}]}})}),function(e,t){return et.apply(this,arguments)});function eN(){return em.readFile(D.l)}var eL=(en=(0,r._)(function(e){var t,n,r,i,a,l,c,u,d,h;return(0,o.Jh)(this,function(o){switch(o.label){case 0:return t=e.remote,n=e.accessToken,s.kg.info("GitHub Import: Starting client-side GitHub import flow"),[4,eN()];case 1:return r=o.sent(),[4,eI()];case 2:return o.sent(),s.kg.info("GitHub Import: Removed template boilerplate"),[4,eG(t,n)];case 3:return o.sent(),s.kg.info("GitHub Import: Cloned repo into Repl"),[4,eD()];case 4:if(o.sent(),s.kg.info("GitHub Import: Tidied up required files"),"content"in r)return[3,5];return s.kg.error("GitHub Import: Skipping patching dotReplit because templateDotReplit was an error",{readError:String(r.error)}),[3,8];case 5:return[4,eN()];case 6:return"content"in(i=o.sent())&&i.content.toString()!==r.content.toString()&&s.kg.info("GitHub Import: Repo has .replit",{githubURL:t}),[4,eC(r.content)];case 7:o.sent(),s.kg.info("GitHub Import: Patched dotreplit"),o.label=8;case 8:return[4,ec({variables:{input:{id:ea,doClone:!1}}})];case 9:return o.sent(),s.kg.info("GitHub Import: Disabled doClone on Repl. Done."),[4,eB()];case 10:if(o.sent(),a=f(t),l=!1,!a)return[3,14];return c=a.username,u=a.repository,[4,eP("".concat(c,"/").concat(u),n)];case 11:if(h=(d=o.sent()).hasDotReplit,!(d.hasProcfile&&!h))return[3,13];return[4,eA("".concat(c,"/").concat(u),n)];case 12:return l=!o.sent().showConfigPanel,[3,14];case 13:l=h,o.label=14;case 14:if("html"===ev.mode||l)return[2];return er(),[2]}})}),function(e){return en.apply(this,arguments)})}},5218:function(e,t,n){n.d(t,{T:function(){return d}});var r=n(50782),i=n(41733),o=n(21262),a=n(71440),l=n(58995);function c(){var e=(0,o._)(["\n  query WorkspaceEduPaneEnabled($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        isModelSolution\n        isProject\n        isProjectFork\n        owner {\n          __typename\n          ... on Team {\n            id\n            isAdmin\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return c=function(){return e},e}var s={},u=(0,a.Ps)(c());function d(){var e,t,n,o=(t={variables:{replId:(0,r.Z)()}},n=(0,i._)({},s,t),l.a(u,n)).data,a=(null==o?void 0:null===(e=o.repl)||void 0===e?void 0:e.__typename)==="Repl"?null==o?void 0:o.repl:null;if(!a)return!1;var c=a.owner;return!!c&&a.isProjectFork&&!a.isModelSolution&&"Team"===c.__typename&&c.isAdmin}},73858:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(66626),i=n(54916),o=n(50959),a=n(30084),l=n(6597);function c(){var e=(0,i.Z)().fs,t=(0,r._)((0,o.useState)(!1),2),n=t[0],c=t[1],s=(0,l.Z)(),u=s.didConnectOnce,d=s.didDisconnect;return((0,o.useEffect)(function(){return c(e.getStatus()===a.kO.Syncing),e.onStatusChange(function(e,t){var n=t.hasUserChanged;c(e===a.kO.Syncing&&n)})},[e]),u)?{isSaving:n,isOffline:d}:{isSaving:!1,isOffline:!1}}},13779:function(e,t,n){n.d(t,{O:function(){return s}});var r=n(27387),i=n(96583),o=n(25632),a=n(25425),l=n(57369),c=n(19858);function s(){var e,t,n,s=(0,a.P5)({controlName:"flag-filetree-git-status",logFlagToAnalytics:!1}),u=(0,o.Gn)("showFileTreeGitStatus").preferences.showFileTreeGitStatus&&s,d=(0,c.Z)((e=(0,r._)(function(e){var t,n;return(0,i.Jh)(this,function(r){switch(r.label){case 0:if(!u)return[2,{status:null,error:null}];return[4,e.getRepositoryState()];case 1:if((t=r.sent()).error)return[2,t];if(t.type!==l.y5.NORMAL)return[2,{status:null,error:null}];return[4,e.status()];case 2:if((n=r.sent()).error)return[2,n];return[2,{status:n,error:null}]}})}),function(t){return e.apply(this,arguments)}),[u]);return d&&!d.error&&(null===(t=d.status)||void 0===t?void 0:t.changes)?function(e){var t=new Map,n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;t.set(l.path,{index:l.type.index,worktree:l.type.worktree})}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}(null===(n=d.status)||void 0===n?void 0:n.changes):null}},71881:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(25425),i=n(50782),o=n(23394),a=n(11516),l=n(54916),c=n(50959),s=n(39756),u="persistmirrored";function d(){var e=(0,o.T)(),t=(0,i.Z)(),n=(0,r.P5)({controlName:"flag-persist-mirror-html",default:!0,logFlagToAnalytics:!1}),d=(0,l.Z)().container;(0,c.useEffect)(function(){if(!(!e||!n||(null!==(r=a.Z.get(u,"array"))&&void 0!==r?r:[]).includes(t))){var r,i=d.openChannel({service:"gcsfiles",skip:function(e){return!e.repl.currentUserPermissions.containerWrite}},function(e){return e.channel.request({persistMirror:{path:s.Ql}}).then(function(e){if(e.ok){var n,r;r=null!==(n=a.Z.get(u,"array"))&&void 0!==n?n:[],a.Z.set(u,r.concat(t)),i()}}),function(){}});return i}},[d,e,n,t])}},51359:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(47001),i=n(54916),o=n(50959);function a(){var e=(0,i.Z)().container;(0,o.useEffect)(function(){var t=function(){e.getConnectionState()===r.em.CONNECTED&&e.focus()};return window.addEventListener("focus",t),function(){window.removeEventListener("focus",t)}},[e])}},6309:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(74985),i=n(25425),o=n(55534),a=n(74833),l=n(56596),c=n(93918),s=n(20573),u=n(29287),d=n(54916),f=n(50959),h=n(81810),p=(0,c.X)({noticeContainer:[u.l0.rowWithGap(8),u.l0.align.center],noticeText:[u.l0.colWithGap(0)]}),m=new Set([3e3,3001,3002,3003,4200,5e3,5173,6e3,6800,8e3,8008,8080,8081,8888,9e3,1e4,25565,25577]);function v(){var e=(0,d.Z)().container,t=(0,o.Z)().showNotice,n=(0,i.P5)({controlName:h.c0,logFlagToAnalytics:!0});(0,f.useEffect)(function(){if(!n)return e.onPortOpened(function(e){var n=e.port,i=e.address;if(!e.isForwarded&&m.has(n)){var o="Port ".concat(n," opened on host ").concat(i,".");t((0,r.BX)(l.G,{css:p.noticeContainer,children:[(0,r.tZ)(s.Z,{}),(0,r.BX)(l.G,{css:p.noticeText,children:[(0,r.tZ)(a.xv,{multiline:!1,children:o}),(0,r.tZ)(a.xv,{variant:"small",multiline:!1,children:"Use the host 0.0.0.0 to open the port to web traffic."})]})]}),1e4)}})},[t,e,n])}},68348:function(e,t,n){n.d(t,{V:function(){return c},Z:function(){return s}});var r=n(66626),i=n(50959),o=n(54916),a=n(39756),l=n(30084),c=".tutorial";function s(){var e=(0,o.Z)().fs,t=(0,r._)((0,i.useState)({isLoading:!0,isTutorial:!1}),2),n=t[0],s=t[1];return(0,i.useEffect)(function(){e.watchDir(a.Ql,{onChange:function(e){s({isLoading:!1,isTutorial:e.some(function(e){return e.type===l.Tv.Directory&&e.filename===c})})},onMoveOrDelete:function(){s({isLoading:!1,isTutorial:!1})},onError:function(){s({isLoading:!1,isTutorial:!1})}})},[e]),n}},61364:function(e,t,n){n.d(t,{ZP:function(){return R},Ln:function(){return T}});var r=n(27387),i=n(96583),o=n(43182),a=n(50782),l=n(47001),c=n(84800),s=n(30173),u=n(33829),d=n(54916),f=n(19713),h=n(80703),p=n(50959),m=n(3042),v=n(97474),g=n(30084),y=n(41733),b=n(21262),w=n(71440),Z=n(80428),x=n(58995);function C(){var e=(0,b._)(["\n  query ReplEnvironmentDesktopLoadCurriculum($id: String!) {\n    currentUser {\n      id\n      isTeacher: hasRole(role: TEACHER)\n      ...CrosisContextCurrentUser\n    }\n    repl(id: $id) {\n      ... on Repl {\n        id\n        isProject\n        isProjectFork\n        isModelSolution\n        isModelSolutionFork\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n        language\n        origin {\n          id\n          ...CrosisContextRepl\n          origin {\n            id\n            ...CrosisContextRepl\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return C=function(){return e},e}var S={},k=(0,w.Ps)(C(),Z.D,Z.C),_=n(49500),E=(0,f.cn)(!1);function T(){return(0,h.Dv)(E)}function R(){var e,t,n,f=(0,a.Z)(),b=(0,d.Z)().fs,w=(e=(0,y._)({},S,{variables:{id:f}}),x.a(k,e)).data,Z=(0,h.b9)(E);(0,p.useEffect)(function(){return function(){Z(!1)}},[Z]);var C=(null==w?void 0:w.repl.__typename)==="Repl"?w.repl:null,T=(null==w?void 0:null===(t=w.currentUser)||void 0===t?void 0:t.__typename)==="CurrentUser"?w.currentUser:null,R=(null==w?void 0:w.repl.__typename)==="Repl"&&w.repl.isModelSolutionFork,I=R?C&&(null===(n=C.origin)||void 0===n?void 0:n.origin):C&&C.origin||null,D=(0,c.b)((null==I?void 0:I.__typename)==="Repl"?{repl:I,currentUser:T||void 0}:null),G=(0,s.S)();(0,p.useEffect)(function(){C&&T&&C.isProject&&b.stat(".lesson").then(function(e){e.exists||b.createDir(".lesson")})},[b,T,C]),(0,p.useEffect)(function(){if(C&&(C.isProjectFork||R)&&I&&D){var e,t=(0,l.ZP)({onUnrecoverableError:function(e){_.error(e),o.$e(function(t){t.setTag("curriculum-authoring",!0),t.setExtra("originId",I.id),o.Tb(e)})}}),n=(0,u.Z)({container:t});t.connect({context:D,getMinimumRetryDelayMs:G,fetchConnectionMetadata:function(){return(0,m.Z)({url:"/data/repls/".concat(C.id,"/get_repl_origin_guest_connection_metadata")})}});var a=t.onConnectionStateChanged((e=(0,r._)(function(e){var r,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:if(e!==v.e.CONNECTED)return[3,8];a(),i.label=1;case 1:return i.trys.push([1,6,7,8]),[4,b.copyDirFromRemote(".lesson",".lesson",n)];case 2:if(!((r=i.sent()).error&&r.error!==g.Df.NotFound))return[3,3];return o.$e(function(e){e.setTag("curriculum-authoring",!0),e.setExtra("originId",I.id),o.Tb(Error("Error copying lesson: ".concat(r.error)))}),[3,5];case 3:return[4,b.stat(".lesson/instructions.md")];case 4:i.sent().exists&&Z(!0),i.label=5;case 5:return[3,8];case 6:return l=i.sent(),o.$e(function(e){e.setTag("curriculum-authoring",!0),o.Tb(l)}),[3,8];case 7:return t.destroy(),[7];case 8:return[2]}})}),function(t){return e.apply(this,arguments)}));return function(){return t.destroy()}}},[b,D,C,I,R,Z])}},86790:function(e,t,n){n.d(t,{k:function(){return d}});var r=n(47611),i=n(41733),o=n(21262),a=n(71440),l=n(58995);function c(){var e=(0,o._)(["\n  query WorkspaceShowAdmin {\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n    }\n  }\n"]);return c=function(){return e},e}var s={},u=(0,a.Ps)(c());function d(){var e,t,n=(e=(0,i._)({},s,void 0),l.a(u,e)).data,o=(0,r.useRouter)();return(null==n?void 0:null===(t=n.currentUser)||void 0===t?void 0:t.isAdmin)||!!o.query.debug}},92796:function(e,t,n){n.d(t,{B:function(){return I}});var r=n(66626),i=n(25425),o=n(50782),a=n(50199),l=n(2038),c=n(16278),s=n(31593),u=n(81810),d=n(60442),f=n(5218),h=n(68348),p=n(61364),m=n(3947),v=n(75582),g=n(47611),y=n(70504),b=n(41733),w=n(21262),Z=n(71440),x=n(58995);function C(){var e=(0,w._)(["\n  fragment WorkspaceToolPanesRepl on Repl {\n    isProjectFork\n    isModelSolution\n    isProject\n    isProjectFork\n    workspaceCta\n    currentUserPermissions {\n      containerWrite\n      editMultiplayers\n    }\n    hostingDeploymentPermissions {\n      canDeploy\n    }\n    lang {\n      id\n      key\n      engine\n      supportsGit\n      hasLibSearch\n      supportsPackager3\n      hasDAP\n    }\n    config {\n      isServer\n      isVnc\n    }\n  }\n"]);return C=function(){return e},e}function S(){var e=(0,w._)(["\n  query WorkspaceToolPanes($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...WorkspaceToolPanesRepl\n      }\n    }\n    currentUser {\n      id\n      isAdmin: hasRole(role: ADMIN)\n      isPrivacyLimitedAccess: hasRole(role: PRIVACY_LIMITED_ACCESS)\n      userPowerUpsByType {\n        __typename\n        ... on UserPowerUpsTypes {\n          ghostwriter {\n            active\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return S=function(){return e},e}var k={},_=(0,Z.Ps)(C()),E=(0,Z.Ps)(S(),_),T=["shell","git","diff","packager","envEditor","deployments","database","neon","ghostwriterChat","unitTests","submitEduRepl","preferences","docs","multiplayer","adminPanel","sshConfigurator","webview","problems","systemDependencies","dependencies"],R=["ghostwriterChat","deployments"];function I(){var e,t,n,w,Z,C=(Z=(null==(w=(t={variables:{replId:(0,o.Z)()}},n=(0,b._)({},k,t),x.a(E,n)).data)?void 0:null===(e=w.repl)||void 0===e?void 0:e.__typename)==="Repl"?null==w?void 0:w.repl:null)?{repl:Z,currentUser:(null==w?void 0:w.currentUser)||null}:{repl:null,currentUser:null},S=C.repl,_=C.currentUser,I=(0,g.useRouter)(),D=(0,l.T3)(),G=(0,l.rv)(),B=(0,i.P5)({controlName:"flag-neon-databases",logFlagToAnalytics:!1}),P=(0,i.P5)({controlName:"flag-postgres-db-god-mode",logFlagToAnalytics:!1}),A=!!((0,i.P5)({controlName:"flag-deployments",logFlagToAnalytics:!1})&&(null==S?void 0:S.hostingDeploymentPermissions.canDeploy)),N=(0,i.P5)({controlName:"flag-repl-auth-sidebar",logFlagToAnalytics:!1}),L=(0,i.P5)({controlName:"flag-nix-modules-tool",logFlagToAnalytics:!1}),U=(0,i.P5)({controlName:"flag-problems-pane",logFlagToAnalytics:!1}),O=(0,i.P5)({controlName:"flag-mb-ai4all",logFlagToAnalytics:!1}),M=(0,i.P5)({controlName:u.c0,logFlagToAnalytics:!1}),X=(0,i.P5)({controlName:"flag-object-storage-pane"}),F=(0,i.P5)({controlName:"flag-new-dependencies-pane"}),W=(0,i.P5)({controlName:"flag-replit-code-reviews"}),H=(0,d.cR)(),V=(0,s.Z)().language,z=(0,f.T)(),j=(0,p.Ln)(),q=(0,h.Z)().isTutorial,Y=(0,c.I)().configs.some(function(e){return"nix"!==e.id}),J=(0,y.WG)(),K=(null==_?void 0:_.isAdmin)||!!I.query.debug,$=(0,m.Se)();return(0,a.Z)(function(){var e=D&&(null==S?void 0:S.currentUserPermissions.editMultiplayers),t=(null==_?void 0:null===(y=_.userPowerUpsByType)||void 0===y?void 0:y.__typename)==="UserPowerUpsTypes"&&(null==_?void 0:_.userPowerUpsByType.ghostwriter)&&(null==_?void 0:_.userPowerUpsByType.ghostwriter.active)||O,n=!G||t,i=e?[{type:"multiplayer"}]:[];if(!S||!_)return i;var o=!!S.config.isVnc,a=S.lang.supportsGit,l=S.lang.key.startsWith("html"),c="nix"===S.lang.key,s=S.isProject||S.isProjectFork,u=!s&&null!==V,d=W&&a,f=[[{type:"shell"},!0],[{type:"instructions"},j],[{type:"threadInbox"},!0],[{type:"chat"},!0],[{type:"docs",data:{url:null}},!0],[{type:"webview"},!0],[{type:"vnc"},o],[{type:"runnerOutput"},!l],[{type:"git"},a],[{type:"packager"},!0],[{type:"systemDependencies"},!0],[{type:"dependencies"},F],[{type:"envEditor"},!l],[{type:"debugger"},!0],[{type:"tutorial"},q],[{type:"database"},!l],[{type:"neon"},P||c&&B],[{type:"replAuth"},!!(N&&Y)],[{type:"autograder"},s],[{type:"unitTests"},u],[{type:"education"},!!z],[{type:"preferences"},!0],[{type:"adminPanel"},K],[{type:"deployments"},A],[{type:"sshConfigurator"},!0],[{type:"ghostwriterChat"},n],[{type:"searchReplace"},!0],[{type:"extensionStore",data:{page:"store"}},!0],[{type:"modules"},L],[{type:"extensionDevtools"},H],[{type:"problems"},U],[{type:"networking"},M],[{type:"objectStorage"},X],[{type:"codeReview"},d]];if(D){var h=S.workspaceCta===v.Sy.Submit||S.workspaceCta===v.Sy.Resubmit;f.push([{type:"submitEduRepl"},h])}var p=!0,m=!1,g=void 0;try{for(var y,b,w=J[Symbol.iterator]();!(p=(b=w.next()).done);p=!0){var Z=b.value;f.push([{type:"extension",data:{extensionId:Z.extension.extensionId,installationId:Z.extension.installationId,name:Z.name||Z.extension.manifest.name,icon:Z.icon||Z.extension.manifest.icon,baseUrl:Z.extension.baseUrl,path:Z.handler}},!0])}}catch(e){m=!0,g=e}finally{try{p||null==w.return||w.return()}finally{if(m)throw g}}var x=!0,C=!1,k=void 0;try{for(var E,I=f[Symbol.iterator]();!(x=(E=I.next()).done);x=!0){var Q=(0,r._)(E.value,2),ee=Q[0];Q[1]&&(!D||T.includes(ee.type))&&i.push(ee)}}catch(e){C=!0,k=e}finally{try{x||null==I.return||I.return()}finally{if(C)throw k}}return i.map(function(e){return{title:$.getTitle(e),pane:e}}).sort(function(e,t){return R.includes(e.pane.type)?-1:R.includes(t.pane.type)?1:e.title.localeCompare(t.title)}).map(function(e){return e.pane})},[D,S,_,N,Y,V,P,F,B,j,q,z,K,A,L,H,U,J,$,O,G,M,X,W])}},72875:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(2689),i=n(50959);function o(){(0,i.useEffect)(function(){var e=null;return!function t(){if(window.performance.memory){var n=window.performance.memory,i=n.jsHeapSizeLimit,o=n.totalJSHeapSize,a=n.usedJSHeapSize,l=window.performance.now();r.kg.info("perf:browser_memory",{jsHeapSizeLimit:i,totalJSHeapSize:o,usedJSHeapSize:a,timeElapsed:l}),e=setTimeout(t,-(3e5*Math.log(Math.random())))}}(),function(){e&&clearTimeout(e)}},[])}},87716:function(e,t,n){n.d(t,{L:function(){return c}});var r=n(41733),i=n(50782),o=n(87584),a=n(84707),l=n(50959);function c(){var e=(0,i.Z)(),t=(0,o.Z)("fileTree").trackTimeToLoadFileStart;return(0,l.useCallback)(function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t(n);var o={action:"select",source:"filetree"};i.newTab?o={action:"newTab",source:"filetree"}:i.newPane&&(o={action:"newPane",source:"filetree"}),(0,a.Z)((0,r._)({replId:e},o))},[e,t])}},28470:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(25632),i=n(50782),o=n(59868),a=n(54916),l=n(50959),c=new Set([3e3,3001,3002,3003,3306,4e3,4200,5e3,5432,5173,6e3,6800,7e3,7001,8e3,8008,8080,8081,8888,9e3,9001,1e4,25565,25577,8887,27017,27018]);function s(){var e=(0,a.Z)().container,t=(0,r.Gn)("webviewAutoOpenOnPortOpened").preferences.webviewAutoOpenOnPortOpened,n=(0,i.Z)();(0,l.useEffect)(function(){return e.onPortOpened(function(e){var r=e.port,i=e.address,a=e.isForwarded,l=e.isVnc,s=e.externalPort;if(a){(0,o.j)(o.U3.WS_PORT_OPENED,{type:l?"vnc":"webview",replId:n,port:r,externalPort:s,address:i,webviewAutoOpenOnPortOpened:t});return}(0,o.j)(o.U3.WS_UNFORWARDED_PORT_OPENED,{port:r,isCommon:c.has(r),address:i,type:l?"vnc":"webview",replId:n,externalPort:s})})},[e,n,t])}},93702:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(47726),i=n(25425),o=n(50782),a=n(2689),l=n(58130),c=n(54916),s=n(50959),u=n(34523),d=n(59808),f=new Set;function h(e){var t=e.workspaceType,n=(0,o.Z)(),h=(0,c.Z)(),p=h.dotReplit,m=h.container,v=(0,i.P5)({controlName:"flag-channel-request-priority",logFlagToAnalytics:!1});(0,s.useEffect)(function(){if(!f.has(n)){f.add(n);var e=p.watch(function(n){if(!n.error||n.error!==d.Yt.Disconnected){try{var i=m.getConnectionMetadata();if(!i||!i.token)throw Error("Expected token in measure call.");!function(e){var t=e.workspaceType,n=e.parsedToken,i=e.flagChannelRequestPriority,o=!!window.performance.getEntriesByName(u.Iy.pageNavStart,"mark").length,l={ssr:!o,workspaceType:t,tokenCluster:n.cluster,flagChannelRequestPriority:i},c="time to code";window.performance.measure(c,o?u.Iy.pageNavStart:void 0);var s=window.performance.getEntriesByName(c,"measure")[0];if(!s){a.kg.info("Could not obtain measure for time to code",l);return}var d="page invisible fetch connection metadata",f=s.duration;window.performance.getEntriesByName(u.Iy.fetchConnectionMetadataPageInvisibleStart,"mark").length&&(window.performance.measure(d,u.Iy.fetchConnectionMetadataPageInvisibleStart,u.Iy.fetchConnectionMetadataPageInvisibleEnd),f-=window.performance.getEntriesByName(d,"measure")[0].duration,window.performance.clearMeasures(d),window.performance.clearMarks(u.Iy.fetchConnectionMetadataPageInvisibleStart),window.performance.clearMarks(u.Iy.fetchConnectionMetadataPageInvisibleEnd)),a.kg.time("time to code minus page invisible",f,l),a.kg.time("time to code with page invisible",s.duration,l),window.performance.clearMeasures(c),r.v.addTiming("time_to_code_minus_page_invisible",f),r.v.addTiming("time_to_code_with_page_invisible",s.duration)}({workspaceType:t,parsedToken:(0,l.he)(i.token),flagChannelRequestPriority:v})}catch(e){a.kg.info("Could not measure time to code",{workspaceType:t,e:e,dotReplitResult:n.error?n.error:"success"})}e()}});return e}},[n,t,p,m,v])}},87584:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(2689),i=n(56684),o=n(19659),a=new Map,l=function(e,t){if((0,o.Mb)(e)){var n=window.performance.now();a.set(e,{start:n,source:t})}},c=function(e){var t=a.get(e);if(void 0!==t){var n=t.start,o=t.source,l=window.performance.now(),c=(0,i.V)(e);r.kg.time("time to load file",l-n,{from:o,fileViewerType:c}),a.delete(e)}};function s(e){return{trackTimeToLoadFileStart:function(t){return l(t,e)},trackTimeToLoadFileEnd:c}}},25961:function(e,t,n){n.d(t,{Ih:function(){return y},bM:function(){return b},ir:function(){return x}});var r=n(42516),i=n(41733),o=n(30509),a=n(98924),l=n(74985),c=n(91608),s=n(56596),u=n(93918),d=n(29287);n(50959);var f=n(27308),h=n(18059),p=(0,c.$)(["fontSize","gap","xPadding"]),m=p.cssVars,v=p.styleTokens,g=(0,u.X)({chord:[d.l0.display.inlineFlex,d.l0.rowWithGap(12)],shortcut:[d.l0.display.inlineFlex,d.l0.flex.row,{fontSize:v.fontSize,"& > div":{marginRight:v.gap},"& > div:last-child":{marginRight:0}}]});function y(e,t){return((0,f.bU)(e)?e:[e]).map(function(e){return(0,f.QR)(e).map(function(e){var n;return null!==(n=Z(t)[e])&&void 0!==n?n:e.toUpperCase()}).join("")}).join(" ")}function b(e){if((0,f.bU)(e.keyCombo))return(0,l.tZ)(s.G,{"data-testid":"Keybinding:".concat(e.keyCombo.join(" ")),css:g.chord,children:e.keyCombo.map(function(t,n){return(0,l.tZ)(b,(0,o._)((0,i._)({},e),{keyCombo:t}),n)})});var t,n=(0,f.QR)(e.keyCombo),a=null!==(t=e.fontSize)&&void 0!==t?t:e.small?12:14,c=e.hideBorder?0:Math.round(.2*a);return(0,l.tZ)(s.G,{"data-testid":"Keybinding:".concat(e.keyCombo),css:g.shortcut,style:(0,r._)({},m.gap,c+"px"),title:e.keyCombo,children:n.map(function(t){var n;return(0,l.tZ)(x,{text:t,hideBorder:e.hideBorder,fontSize:e.fontSize,isActive:null==e?void 0:null===(n=e.match)||void 0===n?void 0:n.includes(t.toLowerCase())},t)})})}var w=(0,u.X)({root:[d.l0.color.foregroundDimmest,d.l0.position.relative,d.l0.justify.center,{fontSize:"inherit",textAlign:"center",textTransform:"capitalize",paddingLeft:v.xPadding,paddingRight:v.xPadding},d.l0.font.default],border:[d.l0.coverContainer,d.l0.borderRadius(4),{opacity:.5,border:"1px solid",borderColor:d.TV.outlineStrongest}],text:[{fontSize:v.fontSize}]}),Z=function(e){return{Ctrl:e?"":"Ctrl",Cmd:e?"":"Cmd",Alt:e?"":"Alt",Shift:e?"":"Shift",Enter:e?"Return":"Enter",ArrowLeft:"",ArrowRight:"",ArrowUp:"",ArrowDown:""," ":"Space"}};function x(e){var t,n,i,o=e.text,c=e.small,u=e.isActive,f=void 0!==u&&u,p=e.hideBorder,v=void 0!==p&&p,g=(0,a._)(e,["text","small","isActive","hideBorder"]),y=(0,h.NJ)(),b=null!==(t=g.fontSize)&&void 0!==t?t:void 0!==c&&c?12:14,x=Math.round(1.4*b),C=(n={},(0,r._)(n,m.fontSize,b+"px"),(0,r._)(n,m.xPadding,Math.round(b*(v?.1:.2))+"px"),(0,r._)(n,"height",x),(0,r._)(n,"minWidth",v?void 0:x),n);f&&(C.fontWeight=d.TV.fontWeightMedium,C.color=d.TV.foregroundDefault);var S={borderColor:d.TV.foregroundDefault,opacity:1};return(0,l.BX)(s.G,{css:w.root,style:C,children:["string"==typeof o?(0,l.tZ)(s.G,{css:w.text,children:null!==(i=Z(y)[o])&&void 0!==i?i:o}):o,v?null:(0,l.tZ)(s.G,{css:w.border,style:f?S:void 0})]})}},74652:function(e,t,n){n.d(t,{GO:function(){return c},Ih:function(){return l.Ih},Il:function(){return o.Il},bM:function(){return l.bM},gf:function(){return o.gf}});var r=n(74985),i=n(50959),o=n(96003),a=n(27308),l=n(25961);function c(e){var t=(0,o.ns)(e);return(0,r.BX)(o.Ge.Provider,{value:t,children:[e.children,(0,r.tZ)(s,{})]})}function s(){var e=(0,o.Sy)(),t=(0,i.useRef)(null);return(0,i.useEffect)(function(){var n=function(n){var r=(0,a.IX)(n);if(r){var i=r;t.current&&(i=(0,a.cZ)(t.current,r));var l=e(i);switch(l.kind){case o.Xp.NoMatch:t.current=null;break;case o.Xp.WaitingForChord:t.current=l.key,n.preventDefault();break;case o.Xp.MatchFound:t.current=null;var c=!0,s=!1,u=void 0;try{for(var d,f=l.matches[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value,p=h.run,m=h.bubble,v=void 0===m||m;if(!1!==p()&&(n.preventDefault(),!v))break}}catch(e){s=!0,u=e}finally{try{c||null==f.return||f.return()}finally{if(s)throw u}}}}};return document.addEventListener("keydown",n),function(){document.removeEventListener("keydown",n)}},[e]),null}},75722:function(e,t,n){n.d(t,{_:function(){return y},O:function(){return g}});var r=n(27387),i=n(66626),o=n(96583),a=n(50199),l=n(82278),c=n(27308),s=n(5805),u=n(41733),d=n(21262),f=n(71440),h=n(99165);function p(){var e=(0,d._)(["\n  mutation SetUserKeybindings($input: SetUserKeybindingsInput!) {\n    setUserKeybindings(input: $input) {\n      ... on Keybindings {\n        keybindings\n      }\n    }\n  }\n"]);return p=function(){return e},e}var m={},v=(0,f.Ps)(p());function g(){var e,t=(0,l.O)(),n=(0,i._)((e=(0,u._)({},m,void 0),h.D(v,e)),1)[0],c=(0,s.F)();return(0,a.Z)(function(){var e;return e=(0,r._)(function(e){var r,a,l,s,u,d,f,h,p;return(0,o.Jh)(this,function(o){switch(o.label){case 0:r=[],a=!0,l=!1,s=void 0;try{for(u=e[Symbol.iterator]();!(a=(d=u.next()).done);a=!0)h=(f=(0,i._)(d.value,2))[0],p=f[1],r.push({commandId:h,keyCombo:p})}catch(e){l=!0,s=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw s}}return[4,n({variables:{input:{environment:t,platform:c,keybindings:r}}})];case 1:return o.sent(),[2]}})}),function(t){return e.apply(this,arguments)}},[t,n,c])}function y(e){var t=new Map;if(!Array.isArray(e))return t;var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,s=function(e){if(e&&"object"==typeof e&&"commandId"in e&&"string"==typeof e.commandId&&"keyCombo"in e){if(Array.isArray(e.keyCombo)){var t=(0,c.uv)(e.keyCombo);return{commandId:e.commandId,keyCombo:t}}if("string"==typeof e.keyCombo){var n=(0,c.gD)(e.keyCombo);return{commandId:e.commandId,keyCombo:n}}return{commandId:e.commandId,keyCombo:null}}}(l);s&&t.set(s.commandId,s.keyCombo)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}},5805:function(e,t,n){n.d(t,{F:function(){return o}});var r=n(18059),i=n(34396);function o(){var e=(0,r.NJ)(),t=(0,r.Vm)(),n=(0,r.Cl)();return e||t?i.K5.Mac:n?i.K5.Windows:i.K5.Linux}},46866:function(e,t,n){n.d(t,{R:function(){return s}});var r=n(27387),i=n(96583),o=n(3720),a=n(21262);function l(){var e=(0,a._)(["\n  query FiletreeDownloadZip($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        url\n      }\n    }\n  }\n"]);return l=function(){return e},e}var c=(0,n(71440).Ps)(l());function s(e){return u.apply(this,arguments)}function u(){return(u=(0,r._)(function(e){var t,n,r;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return[4,null===o.l||void 0===o.l?void 0:o.l.query({query:c,variables:{replId:e}})];case 1:return r=(null==(n=i.sent())?void 0:null===(t=n.data)||void 0===t?void 0:t.repl.__typename)==="Repl"?n.data.repl.url:window.location.pathname,window.open(r+".zip","_blank"),[2]}})})).apply(this,arguments)}},31232:function(e,t,n){n.d(t,{mn:function(){return u}});var r=n(66626),i=n(63257),o=n(19659),a=n(30084),l=["json","md","draw","txt"],c=[".gitignore",".replit"];function s(e,t){var n=new Map,a=!0,l=!1,c=void 0;try{for(var s,u=e[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d,f=s.value,h=(0,o.r6)(f);if(h&&(!t||h.startsWith(t))){var p=null!==(d=n.get(h))&&void 0!==d?d:0;n.set(h,p+1)}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}return(0,i._)(n.entries()).sort(function(e,t){var n=(0,r._)(e,2)[1];return(0,r._)(t,2)[1]-n}).map(function(e){return(0,r._)(e,1)[0]})}function u(e,t){if(e.fileType===a.Tv.Directory||!e.input)return[];if("."===e.input)return c.map(function(e){return{value:e,highlight:[{from:1,to:e.length}]}});if(e.input.startsWith("."))return c.filter(function(t){return t.startsWith(e.input)}).map(function(t){return{value:t,highlight:[{from:t.length-e.input.length,to:t.length}]}});var n=(0,o.r6)(e.input),r=s(e.siblings.map(function(e){return e.filename}),n);if(r.length<3&&r.push.apply(r,(0,i._)(s(t(),n))),r.length<3){var u=n?l.filter(function(e){return e.startsWith(n)}):l;r.push.apply(r,(0,i._)(u))}return(0,i._)(new Set(r)).slice(0,3).map(function(t){var r=e.input;r.endsWith(".")?r=r.slice(0,-1):n&&(r=r.slice(0,-(n.length+1)));var i=r+"."+t;return{value:i,highlight:[{from:e.input.length,to:i.length}]}})}},23090:function(e,t,n){n.d(t,{B:function(){return o}});var r=n(30084),i=function(e){if(1===e.length)return e[0].type===r.Tv.File?"file":"folder";if(e.length>1){var t=e.filter(function(e){return e.type===r.Tv.File}).length,n=e.filter(function(e){return e.type===r.Tv.Directory}).length,i=t>1?"files":"file",o=n>1?"folders":"folder",a="file";return t>0&&n>0?a="".concat(i," and ").concat(o):t>0?a="".concat(i):n>0&&(a="".concat(o)),"".concat(a)}return""};function o(e){var t=i(e),n=1===e.length?t:"".concat(e.length," ").concat(t),r=e.slice(0,5).map(function(e){return e.path}).join(", ");return{name:n,description:e.length>5?"".concat(r," and ").concat(e.length-5," more ").concat(i(e.slice(5))):r,confirmDescription:n}}},71042:function(e,t,n){n.d(t,{r:function(){return r}});function r(e,t){return new Promise(function(n){var r=e.openChannel({service:"gcsfiles"},function(e){return e.channel.request({persistMirror:{path:t}}).then(function(e){e.ok,r(),n()}),function(e){e.willReconnect&&r()}})})}},19924:function(e,t,n){n.d(t,{e:function(){return S},Z:function(){return C}});var r=n(41733),i=n(66626),o=n(85234),a=n.n(o),l=n(2689),c=n(27387),s=n(98924),u=n(63257),d=n(96583),f=n(43182),h=n(14131),p=n(99843),m=n(52527),v="exit status 1";function g(){return(g=(0,c._)(function(e){var t,n,r,i,o,a,l;return(0,d.Jh)(this,function(c){switch(c.label){case 0:if(n=e.container,0===(r=(0,s._)(e,["container"])).query.trim().length)return[2,y(m.f.EMPTY_QUERY)];if(n.getConnectionState()===h.em.DISCONNECTED)return[2,y(m.f.CONTAINER_DISCONNECTED)];if(n.getConnectionState()===h.em.CONNECTING)return[2,y(m.f.CONTAINER_CONNECTING)];return[4,(t=n).exec.apply(t,(0,u._)((0,p.PR)(r)))];case 1:if(o=(i=c.sent()).output,a=i.error)switch(a){case v:return[2,y(m.f.EMPTY_RESULTS)];case"signal: broken pipe":return[2,y(m.f.PARTIAL_RESULTS)];case"Channel closed":return[2,y(m.f.CHANNEL_CLOSED)];default:return f.Tb(Error("Ripgrep search command failed with error: ".concat(a))),[2,{error:a,data:null}]}if(!(null==o?void 0:o.trim())||!(l=(0,p.Tq)()(o))||0===l.filesMap.size)return[2,y(m.f.EMPTY_RESULTS)];return[2,y(l.error,l.filesMap)]}})})).apply(this,arguments)}function y(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{error:e,data:t}}var b=n(86763),w=n.n(b),Z=n(1660),x="File Search Used";function C(e){var t=e.container,n=e.onError,i=e.onUpdate,o=e.onLoadingStateChange,c=e.isStreaming,u=e.trackLatency,d=void 0!==u&&u,h=(0,Z.Z)({container:t}),g=[],y=a()(),b=Date.now(),C=function(e){i(g=e)};return w()(function(e){var t=a()();y=t,b=Date.now(),n(null),o(!0);var i=!0;if(""===e.query){C([]),o(!1);return}!function(e){var t=e.execer,n=e.onComplete,r=e.onError,i=e.onParse,o=(0,s._)(e,["execer","onComplete","onError","onParse"]);if(0===o.query.length){n("abort");return}var a=new TextEncoder,l=(0,p.Tq)(),c=0,u=0,d=function(){},h=function(e){r(e),n("error")},g=function(e){if(0===c&&"finished"===e){h(m.f.EMPTY_RESULTS);return}"finished"===e?n(e,{bytes:u}):n(e),d()},y=t.onOutput(function(e){var t=a.encode(e).length;u+=t;var n=l(e);if(n){var r=n.error,o=n.filesMap,s=n.filesMapChanges;r&&h(r),c=o.size,s.forEach(function(e){var t=o.get(e);t&&o.set(e,(0,p.Vd)(t))}),i(o,s)}}),b=t.onStderr(function(e){if(e.trim()===v)return h(m.f.EMPTY_RESULTS);h(m.f.INVALID_COMMAND)});d=function(){y(),b()};var w=(0,p.PR)(o);t.request({args:w}).then(function(e){if(e.error)return e.error.trim()===v?h(m.f.EMPTY_RESULTS):h(m.f.INVALID_COMMAND);g("finished")}).catch(function(e){return f.Tb(Error("Ripgrep search command failed with error: ".concat(e))),h(m.f.INVALID_COMMAND)})}((0,r._)({execer:h,onComplete:function(r,i){if(y===t){o(!1);var a,c,s,u,f="finished"===r&&i&&i.bytes===p.Ak;f&&n(m.f.PARTIAL_RESULTS),d&&l.kg.time("".concat(x," - complete"),Date.now()-b,{query:e.query,isRegex:e.isRegex,isCaseSensitive:e.isCaseSensitive,hasIncludes:(null!==(s=null==e?void 0:null===(a=e.includeGlobs)||void 0===a?void 0:a.length)&&void 0!==s?s:0)>0,hasExcludes:(null!==(u=null==e?void 0:null===(c=e.excludeGlobs)||void 0===c?void 0:c.length)&&void 0!==u?u:0)>0,latency:Date.now()-b,isPartialResults:f})}},onError:function(e){y===t&&n(e)},onParse:function(n,r){if(y===t){if(i){if(d){var a,s,u,f;l.kg.time("".concat(x," - first_chunk"),Date.now()-b,{query:e.query,isRegex:e.isRegex,isCaseSensitive:e.isCaseSensitive,hasIncludes:(null!==(u=null==e?void 0:null===(a=e.includeGlobs)||void 0===a?void 0:a.length)&&void 0!==u?u:0)>0,hasExcludes:(null!==(f=null==e?void 0:null===(s=e.excludeGlobs)||void 0===s?void 0:s.length)&&void 0!==f?f:0)>0})}C((0,p.Md)([],n,r)),i=!1}else C((0,p.Md)(g,n,r));c&&o(!1)}},mode:"json",context:0},e))},200)}function S(e){var t=e.container,n=w()(function(e,n,o){(function(e){return g.apply(this,arguments)})((0,r._)({container:t,mode:"json",context:1,isCaseSensitive:!1},e)).then(function(e){var t=e.data?function(e){var t={},n=!0,r=!1,o=void 0;try{for(var a,l=e.entries()[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=(0,i._)(a.value,2),s=c[0],u=c[1];t[s]=u.lines.map(function(e){return{content:e.content,lineNumber:e.lineNumber,matches:e.matches.map(function(e){return{column:e.start,length:e.length}})}}).filter(function(e){return e.matches.length>0})}}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}return t}(e.data):{},r=e.error===m.f.PARTIAL_RESULTS;if(r);else if(e.error)return n({error:e.error,results:null,isPartialResult:r});return n({error:null,results:t,isPartialResult:r})}).catch(o)},200);return function(e){return new Promise(function(t,r){return n(e,t,r)})}}},12763:function(e,t,n){n.d(t,{Eu:function(){return d},m6:function(){return l}});var r,i,o,a=n(63257);function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],r=function(e){return e.forEach(function(e){return e&&n.push("-g",e)})},i=[],o=[],l=!0,u=!1,f=void 0;try{for(var h,p=e[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){var m=h.value,v=s(m);v.startsWith("**")?i.push(v):o.push(v)}}catch(e){u=!0,f=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw f}}return o.length>0&&(r(["!*"]),new Set(o).forEach(function(e){r((function(e){var t=function(e){Array.isArray(r[e])||(r[e]=[]);var t,i=n[e],o=i.startsWith("{")&&i.endsWith("}")?d(i.substring(1,i.length-1),","):[i];(t=r[e]).push.apply(t,(0,a._)(o.map(function(t){var n=r[e-1];return n&&n.length>0?n.map(function(e){return"".concat(e,"/").concat(t)}):t}).flat(2)))},n=d(e,"/").filter(function(e){return e.length>0});"**"!==n[n.length-1]&&n.push("**");for(var r={},i=0;i<n.length;i++)t(i);return Object.values(r).flat(2)})(e).map(c))})),r(i),r(t.map(function(e){return"!".concat(c(s(e)))})),n}function c(e){return e.startsWith("**")||e.startsWith("/")?e:"/".concat(e)}function s(e){return e.replaceAll(/\*/g,function(e,t,n){return t>0&&("*"===n[t-1]||"\\"===n[t-1])||t<n.length-1&&"*"===n[t+1]?e:"**"})}var u=(r={},i={},(o=function(e,t){r[e]=t,i[t]=e})("{","}"),o("(",")"),o("[","]"),{hasKey:function(e){return e in r},getKey:function(e){return r[e]},hasValue:function(e){return e in i},getValue:function(e){return i[e]}});function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";if(0===e.length)return[];var n=[],r=[],i="",o=!0,a=!1,l=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var d=c.value;if(d===t){if(0===r.length){n.push(i),i="";continue}}else if(u.hasKey(d))r.push(d);else if(u.hasValue(d)&&r.pop()!==u.getValue(d))return[e];i+=d}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return 0!==r.length?[e]:(i.length>0&&n.push(i),n)}},99843:function(e,t,n){n.d(t,{Ak:function(){return f},Tq:function(){return h},PR:function(){return g},Vd:function(){return m},Md:function(){return v}});var r=n(41733),i=n(30509),o=n(63257),a=n(2689);function l(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(function(e){return e.match(/["\s]/)&&!e.match(/'/)?"'".concat(e.replace(/(['\\])/g,"\\$1"),"'"):e.match(/["'\s]/)?'"'.concat(e.replace(/(["\\$`!])/g,"\\$1"),'"'):e.replace(/[#!"$&'()*,:;<=>?@[\\\]^`{|}]/g,"\\$&")}).join(" ")}var c=n(12763),s=n(52527),u=n(72190),d=n(91620).lW,f=524288;function h(){var e="",t=new Map;return function(n){var o=new Set,l=!1;if(n.trim().startsWith("error"))return{error:s.f.INVALID_COMMAND,filesMap:t,filesMapChanges:o};var c=n.indexOf("\n"),u=0,d=e+n;if(c>=0)c+=e.length;else{e=d;return}for(;c>=0;){var f=d.substring(u,c).trim();if(0!==f.length){var h=function(e){try{return JSON.parse(e)}catch(e){return null}}(f);h&&!function(e,t,n){switch(e.type){case"begin":var o=p(e.data.path);if(!o)return!1;t.set(o,{path:o,lines:[],dedentBy:0}),n.add(o);break;case"end":break;case"match":case"context":var l=p(e.data.path);if(!l)return!1;n.add(l);var c=t.get(l);if(!c)return!1;var s=function(e,t){var n,o,a=p(e.data.lines);if(!a)return null;var l=a.trimEnd().split(/\r?\n/),c=[];(null===(n=l[0])||void 0===n?void 0:n.trim())===""&&l.shift(),(null===(o=l[l.length-1])||void 0===o?void 0:o.trim())===""&&l.pop();var s=0,u=0,d=e.data.submatches;return l.forEach(function(t,n){var r=e.data.line_number+n,i=u;u+=t.length+1;for(var o=[];s<d.length;){var a=d[s];if(a.start>=u)break;var l=a.start-i,f=void 0;if(f=a.end<u?a.end-a.start:a.end===u?a.end-a.start-1:t.length-l,l<t.length&&o.push({start:l,length:f}),a.end>u){a.start=u;break}s++}c.push({lineNumber:r,content:t,matches:o})}),(0,i._)((0,r._)({},t),{lines:t.lines.concat(c)})}(e,c);s&&t.set(l,s);break;case"error":return a.kg.error("Invalid Search Line",{line:JSON.stringify(e)}),!1}return!0}(h,t,o)&&(l=!0)}u=c+1,c=d.indexOf("\n",u)}return e=d.substring(u),{error:l?s.f.INVALID_LINE:null,filesMap:t,filesMapChanges:o}}}function p(e){return e?"bytes"in e?d.from(e.bytes,"base64").toString():e.text:null}function m(e){var t,n=e.lines.length>0?(t=Math).min.apply(t,(0,o._)(e.lines.map(function(e){return e.content.match(/^[\t ]+/)}).flat().map(function(e){return(null==e?void 0:e.length)||0}))):0;return(0,i._)((0,r._)({},e),{dedentBy:n})}function v(e,t,n){for(var r=(0,o._)(e),i=new Set,a=0;a<r.length;a++){var l=r[a].path,c=t.get(l);n.has(l)&&c&&(r[a]=c,i.add(l))}var s=!0,u=!1,d=void 0;try{for(var f,h=n[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value,m=t.get(p);!i.has(p)&&m&&r.push(m)}}catch(e){u=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw d}}return r}function g(e){var t=e.mode,n=e.query,r=e.context,i=e.isRegex,a=e.isCaseSensitive,s=e.isMatchingWholeWords,d=e.includeGlobs,h=e.excludeGlobs,p=void 0===h?(0,o._)(u.hD):h,m=["rg"];switch(t){case"json":m.push("--json");break;case"files":m.push("--files-with-matches")}return null!==r&&m.push("--context","".concat(r)),n.includes("\n")&&m.push("--multiline"),i||m.push("--fixed-strings"),m.push("--max-count","100"),m.push("--max-filesize","4M"),m.push("--max-depth","24"),m.push("--max-columns","512"),m.push("--max-columns-preview"),m.push(a?"--case-sensitive":"--ignore-case"),m.push("--hidden"),s&&m.push("--word-regexp"),m.push.apply(m,(0,o._)((0,c.m6)(d,p))),m.push("--",n),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;return["sh","-c","".concat(l.apply(void 0,(0,o._)(e))," | head -c ").concat(t)]}(m)}},52527:function(e,t,n){var r,i;n.d(t,{f:function(){return r}}),(i=r||(r={})).PARTIAL_RESULTS="Displaying partial results, try being more specific with your search.",i.EMPTY_RESULTS="Nothing came up searching your Repl's content.",i.EMPTY_QUERY="No search query was provided.",i.INVALID_LINE="We encountered an invalid line while parsing your search results.",i.INVALID_COMMAND="Ripgrep returned an invalid response.",i.CONTAINER_DISCONNECTED="Disconnected from the container.",i.CONTAINER_CONNECTING="Connecting to the container.",i.CHANNEL_CLOSED="Channel was closed."},84707:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(59868);function i(e){(0,r.j)(r.U3.FILETREE_USED,e)}},66959:function(e,t,n){n.d(t,{YI:function(){return A},kW:function(){return P}});var r,i,o=n(41733),a=n(30509),l=n(74985),c=n(76999),s=n.n(c),u=n(63461);n(50959),(r=i||(i={})).TEXT="TEXT",r.MENTION="MENTION",r.LINK="LINK",r.REPL_LINK="REPL_LINK",r.DEEP_LINK="DEEP_LINK",r.CODE="CODE",r.BOLD="BOLD",r.ITALICS="ITALICS",r.STRIKETHROUGH="STRIKETHROUGH",r.QUOTE="QUOTE";var d=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)(u.Z,{size:"small",onClick:n,children:t.content})},f=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)(u.Z,{size:"small",fontWeight:"medium",onClick:n,children:t.content})},h=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("a",{href:t.url,onClick:n,rel:"noreferrer noopener nofollow",target:"_blank",children:t.content})},p=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("a",{href:t.url,onClick:n,target:"_blank",children:t.content})},m=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("a",{href:t.url,onClick:n,children:t.content})},v=function(e){var t=e.fragment,n=e.onClick,r=e.style;return(0,l.tZ)("code",{onClick:n,style:r,children:t.content})},g=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("b",{onClick:n,children:t.content})},y=function(e){var t=e.fragment,n=e.onClick;return(0,l.tZ)("i",{onClick:n,children:t.content})},b=function(e){var t=e.fragment,n=e.onClick;return(0,l.BX)("span",{onClick:n,className:"jsx-e2f6e2707e7599fa",children:[t.content,(0,l.tZ)(s(),{id:"e2f6e2707e7599fa",children:"span.jsx-e2f6e2707e7599fa{text-decoration:line-through}"})]})},w=function(e){var t=e.fragment,n=e.onClick;return(0,l.BX)("blockquote",{onClick:n,className:"jsx-8741a91fadaf26be",children:[t.content,(0,l.tZ)(s(),{id:"8741a91fadaf26be",children:"blockquote.jsx-8741a91fadaf26be{border-left:2px solid var(--foreground-dimmest);padding-left:6px;color:var(--foreground-dimmest)}"})]})},Z=/(@[0-9a-zA-Z_]+)/,x=/(#[-a-zA-Z0-9@:%._+~#=/]+)/,C=/(https?:\/\/[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{2,6}\b(?:[-a-zA-Z0-9()@:%_+.~#?&//=]*))/,S=/(`.+?`)/,k=/(\*\*.+?\*\*)/,_=/(_.+?_)/,E=/(\*.+?\*)/,T=/(~~.+?~~)/,R=/(^>.+?$\n?)/m,I=/\/@([0-9a-zA-Z_]+)\/(.+)/;function D(e){var t=e.url;return{type:"LINK",url:t,content:t}}function G(e){var t=e.hash;return{type:"DEEP_LINK",url:t,content:t}}var B=RegExp([S.source,k.source,_.source,E.source,T.source,C.source,Z.source,x.source,R.source].join("|"),"m");function P(e,t){var n=e.split(B),r=[],i=[],o=!0,a=!1,l=void 0;try{for(var c,s=n[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;if(u){var d=function(e,t){if(C.test(e)){var n={};try{n=new window.URL(e)}catch(t){return{content:e,type:"TEXT"}}return["repl.it","replit.com","firewalledreplit.com",document.location.host].includes(n.host)?n.pathname===t.replUrl?G({hash:n.hash}):I.test(n.pathname)?function(e){var t=e.url,n=I.exec(t.pathname);if(!n)throw Error("Not a Repl URL");return{type:"REPL_LINK",url:t.href,content:"@".concat(n[1],"/").concat(n[2]).concat(t.hash)}}({url:n}):D({url:e}):D({url:e})}if(x.test(e))return G({hash:e});if(R.test(e))return{type:"QUOTE",content:({text:e.slice(1).trim()}).text};if(S.test(e))return{type:"CODE",content:({code:e.slice(1,-1)}).code};if(k.test(e))return{type:"BOLD",content:({text:e.slice(2,-2)}).text};if(_.test(e)||E.test(e))return{type:"ITALICS",content:({text:e.slice(1,-1)}).text};if(T.test(e))return{type:"STRIKETHROUGH",content:({text:e.slice(2,-2)}).text};if(Z.test(e)){var r=e.slice(1);if(!t.users||t.users.includes(r))return{type:"MENTION",username:r,content:"@".concat(r)}}return{content:e,type:"TEXT"}}(u,t);if(d){if("MENTION"===d.type){if(!d.username)continue;r.push(d.username)}i.push(d)}}}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return{tokens:i,mentions:r}}function A(e){var t=e.message,n=e.onMentionClick,r=void 0===n?function(){}:n,i=e.codeStyles,c=void 0===i?{}:i;return(0,l.tZ)(l.HY,{children:t.tokens.map(function(e,t){var n={fragment:e,key:t};return"MENTION"===e.type?(0,l.tZ)(f,(0,a._)((0,o._)({},n),{onClick:function(){return r(e)}})):"LINK"===e.type?(0,l.tZ)(h,(0,o._)({},n)):"REPL_LINK"===e.type?(0,l.tZ)(p,(0,o._)({},n)):"DEEP_LINK"===e.type?(0,l.tZ)(m,(0,o._)({},n)):"CODE"===e.type?(0,l.tZ)(v,(0,a._)((0,o._)({},n),{style:c})):"BOLD"===e.type?(0,l.tZ)(g,(0,o._)({},n)):"ITALICS"===e.type?(0,l.tZ)(y,(0,o._)({},n)):"STRIKETHROUGH"===e.type?(0,l.tZ)(b,(0,o._)({},n)):"QUOTE"===e.type?(0,l.tZ)(w,(0,o._)({},n)):(0,l.tZ)(d,(0,o._)({},n))})})}},91190:function(e,t,n){n.d(t,{D:function(){return sr}});var r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,b=n(41733),w=n(30509),Z=n(66626),x=n(63257),C=n(74985),S=n(99517),k=n(9756),_=n(74044),E=n(99149),T=n(8622),R=n(9135),I=n(14044),D=n(79604),G=n(45086),B=n(25632),P=n(50199),A=n(2038),N=n(57468),L=n(36577),U=n(9331),O=n(80339),M=n(98859),X=n(81),F=n(80711),W=n(33914),H=n(88936),V=n(3844),z=n(47611),j=n.n(z),q=n(76568),Y=n(19713),J=n(50959),K=n(19659),$=n(76999),Q=n.n($),ee=n(64551),et=n(62340),en=n(64457),er=n(56596),ei=n(39179),eo=n(86262),ea=n(29287),el=n(86763),ec=n.n(el),es=n(3574),eu=n(18059),ed=function(e){var t=e.buttons,n=e.onClick,r=e.onUndo,i=e.onRedo;return(0,C.BX)("nav",{className:"jsx-43582faf24448cbd",children:[t.map(function(e){return(0,C.tZ)("button",{onClick:function(t){t.stopPropagation(),t.preventDefault(),n(e)},className:"jsx-43582faf24448cbd",children:void 0!==e.label?e.label:e.value},e.value)}),(0,C.tZ)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),r()},className:"jsx-43582faf24448cbd",children:(0,C.tZ)(ei.Z,{})}),(0,C.tZ)("button",{onClick:function(e){e.stopPropagation(),e.preventDefault(),i()},className:"jsx-43582faf24448cbd",children:(0,C.tZ)(eo.Z,{})}),(0,C.tZ)(Q(),{id:"43582faf24448cbd",children:'nav.jsx-43582faf24448cbd{font-family:Monaco,Menlo,"Ubuntu Mono",Consolas,source-code-pro,monospace;height:48px;background-color:var(--background-root);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:stretch;-webkit-align-items:stretch;-moz-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}button.jsx-43582faf24448cbd{color:var(--foreground-default);padding:10px;font-family:inherit;font-size:16px;background-color:transparent;border:0 none;-webkit-box-flex:1;-webkit-flex:1 1 auto;-moz-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}'})]})},ef=[{value:"{}",cursorOffset:1},{value:"()",cursorOffset:1},{value:'""',cursorOffset:1}],eh=function(e){var t=e.path,n=(0,x._)(ef).concat([{value:"= ",cursorOffset:2}]);return t.endsWith(".html")&&(n.unshift({value:"<>",cursorOffset:1}),n.unshift({label:"div",value:"<div></div>",cursorOffset:5})),n},ep="visualViewport"in window;function em(e){var t=e.filePath,n=e.isLoading,r=(0,es.uN)(),i=(0,et.d)({tablet:!1}),o=(0,eu.Vm)(),a=(0,en.Z)();(0,J.useEffect)(function(){a&&r&&r.requestMeasure({read:function(){return{cursor:r.coordsAtPos(r.state.selection.main.head),scroller:r.scrollDOM.getBoundingClientRect()}},write:function(e){var t=e.cursor,n=e.scroller;if(t){var i=(t.top+t.bottom)/2,a=(n.top+n.bottom)/2;Math.abs(i-a)>5&&(r.scrollDOM.scrollTop+=i-a+(o?50:0))}}})},[a,r,o]);var l=(0,Z._)((0,J.useState)(0),2),c=l[0],s=l[1];if((0,J.useEffect)(function(){if(o){var e=window.visualViewport;if(ep&&e){var t=ec()(function(){s(window.innerHeight-e.height-e.offsetTop)},100);return e.addEventListener("scroll",t),e.addEventListener("resize",t),function(){e.removeEventListener("scroll",t),e.removeEventListener("resize",t)}}}},[o]),!a||n||!i)return null;var u=(0,C.tZ)(ed,{onUndo:function(){r&&((0,ee.Yw)(r),r.focus())},onRedo:function(){r&&((0,ee.KX)(r),r.focus())},onClick:function(e){if(r){var t,n=null!==(t=r.state.selection.ranges[0].from)&&void 0!==t?t:0;r.dispatch({changes:{from:n,insert:e.value},selection:{anchor:n+e.cursorOffset}}),r.focus()}},buttons:eh({path:t})});return!o||ep?(0,C.tZ)(er.G,{css:[ea.l0.position.fixed,ea.l0.width("100%"),ea.l0.zIndex(100),ea.l0.bottom(c),ea.l0.left(0)],children:u}):u}var ev=n(62789),eg=n(917),ey=n(1518),eb=n(41084),ew=n(24549),eZ=n(84900),ex=[{img:"/public/images/kaboomdraw/rect.png",code:"\ndrawRect({\n	pos: vec2(80, 80),\n	width: 120,\n	height: 80,\n	color: rgb(250, 242, 164),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/triangle.png",code:"\ndrawTriangle({\n	pos: vec2(100, 100),\n	p1: vec2(0, -48),\n	p2: vec2(-60, 48),\n	p3: vec2(60, 48),\n	color: rgb(164, 250, 204),\n})\n  ".trim()},{img:"/public/images/kaboomdraw/circle.png",code:"\ndrawCircle({\n	pos: vec2(100, 100),\n	radius: 48,\n	color: rgb(181, 164, 250),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/ellipse.png",code:"\ndrawEllipse({\n	pos: vec2(120, 100),\n	radiusX: 64,\n	radiusY: 40,\n	color: rgb(164, 209, 250),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/polygon.png",code:"\ndrawPolygon({\n	pos: vec2(100, 100),\n	pts: [\n		vec2(0, -48),\n		vec2(-64, 0),\n		vec2(-32, 64),\n		vec2(32, 64),\n		vec2(64, 0),\n	],\n	color: rgb(250, 164, 226),\n})\n    ".trim()},{img:"/public/images/kaboomdraw/text.png",code:'\ndrawText({\n	text: "hi",\n	pos: vec2(60, 60),\n})\n    '.trim()}],eC=function(e){var t=e.img,n=e.code,r=(0,Z._)((0,eZ.c)({item:{type:ew.z.Code,code:n},type:ew.z.Code}),2)[1];return(0,C.tZ)("img",{alt:"kaboom shape",ref:r,src:t,css:[ea.l0.p(12),{userDrag:"none",height:"100%",cursor:"pointer",transition:"0.1s transform",":hover":{transform:"scale(1.2)"}}]})},eS=function(){return(0,C.tZ)(er.G,{css:[ea.l0.flex.row,ea.l0.justify.spaceEvenly,ea.l0.backgroundColor.backgroundHigher,ea.l0.borderRadius(8),ea.l0.width("calc(100% - 32px)"),ea.l0.height("64px"),ea.l0.position.absolute,ea.l0.overflowY("hidden"),{zIndex:5,left:16,bottom:16,border:"solid 1px var(--outline-dimmest)"}],children:ex.map(function(e){return(0,C.tZ)(eC,(0,b._)({},e),e.img)})})},ek=n(75533),e_=n(27387),eE=n(12285),eT=n(96583),eR=n(4687),eI=n(92631),eD=n(40497),eG=n(59510),eB=n.n(eG),eP=n(25202),eA=n(89798),eN=n(74106),eL=n(7612),eU=n(69521);function eO(e){var t,n;return null!==(n=null===(t=e.facet(eI.N))||void 0===t?void 0:t.isDocumentSymbolSupported)&&void 0!==n&&n}var eM=ek.Py.define(),eX=ek.QQ.define({create:function(){return null},update:function(e,t){var n=e;return(0,eD.j)(t,eM,function(e){n=e.value}),n}});function eF(){return(eF=(0,e_._)(function(e,t,n){var r,i,o,a,l,c,s,u,d;return(0,eT.Jh)(this,function(f){switch(f.label){case 0:return[4,e.request.documentSymbol(t,{signal:n})];case 1:if(!(r=f.sent())||r.cancelled||!(i="result"in r&&!r.cancelled?r.result:null))return[2,null];o=[],a=!0,l=!1,c=void 0;try{for(s=i[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)(d=u.value)&&"range"in d&&o.push(d)}catch(e){l=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(l)throw c}}return[2,o.length?o:null]}})})).apply(this,arguments)}function eW(e){if("Debounced function cancelled"!==e.message)throw e}var eH=ek.QQ.define({create:function(){return[]},update:function(e,t){if(!(0,eL.a)(t,eX,"selection"))return e;var n=t.state.field(eX);return n?function e(t,n,r){var i=r.find(function(e){var r=e.range;return(0,eN.RL)(t,r.end)>=n&&(0,eN.RL)(t,r.start)<=n});return null==i?[]:i.children?[i].concat(e(t,n,i.children)):[i]}(t.state.doc,t.state.selection.main.head,n):[]},compare:eB()}),eV=n(72912),ez=n(51828),ej=n(21158),eq=n(52686),eY=n(71104),eJ=n(93646),eK=n(84271),e$=n(71064),eQ=n(18514),e0=n(31270),e1=n(67337),e2=n(39810),e8=n(19012),e4=n(7225),e3=function(e){var t=new Set(e8.Z),n=new Map,r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=(0,Z._)(a.value,3),s=c[0],u=c[1],d=c[2];if(!t.has(s))throw Error("Symbol not supported by LSP client. Please add to the supported symbol icons array");if("string"==typeof u){var f=ez.s.get(u);if(!f)throw Error("Couldn't find matching icon for ".concat(u));u=f}n.set(s,[u,null!=d?d:ea.TV.foregroundDefault])}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}([[e4.SymbolKind.Array,eQ.Z],[e4.SymbolKind.Boolean,V.Z],[e4.SymbolKind.Class,"class",ea.TV.yellowDefault],[e4.SymbolKind.Constant,"constant",ea.TV.blueStronger],[e4.SymbolKind.Constructor,"method",ea.TV.blurpleDefault],[e4.SymbolKind.Enum,eY.Z,ea.TV.orangeDefault],[e4.SymbolKind.EnumMember,e2.Z,ea.TV.blueStronger],[e4.SymbolKind.Event,ej.Z],[e4.SymbolKind.Field,e1.Z],[e4.SymbolKind.File,eJ.Z],[e4.SymbolKind.Function,"function",ea.TV.blurpleStronger],[e4.SymbolKind.Interface,eK.Z,ea.TV.blueStronger],[e4.SymbolKind.Key,e$.Z],[e4.SymbolKind.Method,"method",ea.TV.blurpleDefault],[e4.SymbolKind.Module,e0.Z,ea.TV.purpleDefault],[e4.SymbolKind.Namespace,eq.Z],[e4.SymbolKind.Object,V.Z,ea.TV.blueDimmer],[e4.SymbolKind.Operator,V.Z],[e4.SymbolKind.Package,e0.Z,ea.TV.purpleDefault],[e4.SymbolKind.Property,e1.Z],[e4.SymbolKind.String,W.Z],[e4.SymbolKind.Struct,eq.Z],[e4.SymbolKind.TypeParameter,e2.Z],[e4.SymbolKind.Variable,e2.Z,ea.TV.blueStronger]]);function e5(e){var t,n=e.kind,r=(0,Z._)(null!==(t=e3.get(n))&&void 0!==t?t:[V.Z,ea.TV.foregroundDefault],2),i=r[0],o=r[1];return(0,C.tZ)(i,{color:o,size:16})}var e6=n(59868),e9=n(20399),e7=n(43312),te=n(93496),tt=n(98574),tn=n(59359),tr=n(59520),ti=(0,e7.iv)([te.gU.nofill,{transitionProperty:"background-color, box-shadow, opacity",opacity:.8,":focus":{zIndex:1,opacity:1}}]),to={button:(0,e7.iv)([ea.l0.reset.button,ea.l0.p(2),ea.l0.rowWithGap(4),ea.l0.align.center,ti]),text:(0,e7.iv)({fontSize:ea.TV.fontSizeSmall})},ta={opacity:1};function tl(e){var t=e.icon,n=e.text,r=e.innerRef,i=e.ariaProps,o=e.active,a=(0,tt.U)(i,r).buttonProps,l=(0,tn.XI)({}),c=l.hoverProps,s=l.isHovered;return(0,C.BX)(er.G,(0,w._)((0,b._)({tag:"button",css:to.button,style:s||o?ta:void 0,innerRef:r},(0,tr.dG)(a,c)),{children:[t?(0,J.cloneElement)(t,{size:16}):null,(0,C.tZ)(er.G,{css:to.text,children:n})]}))}var tc={root:(0,e7.iv)([ea.l0.p(4),ea.l0.rowWithGap(4),ea.l0.align.center]),text:(0,e7.iv)([ea.l0.truncate,ea.l0.flex.growAndShrink(1),{fontSize:ea.TV.fontSizeDefault}])};function ts(e){return(0,C.BX)(er.G,{css:[tc.root],children:[e.icon?(0,J.cloneElement)(e.icon,{size:16}):null,(0,C.tZ)(er.G,{css:tc.text,children:e.text})]})}var tu=n(88325),td=n(86936),tf=(0,e7.iv)([ea.l0.p(4)]);function th(e){var t=e.items,n=e.children,r=e.menuProps,i=e.selectedKeys,o=e.onAction,a=(0,tu.D)({items:t,children:n,selectedKeys:i,selectionMode:"single"}),l=(0,J.useRef)(null),c=(0,td.H9)((0,b._)({items:t,onAction:o},r),a,l);return(0,C.tZ)(er.G,(0,w._)((0,b._)({},c.menuProps),{innerRef:l,css:tf,children:(0,x._)(a.collection).map(function(e){return(0,C.tZ)(tv,{item:e,state:a},e.key)})}))}var tp={root:(0,e7.iv)([ea.l0.flex.row,ea.l0.align.center,ea.l0.position.relative,ti]),selected:(0,e7.iv)([{opacity:1,backgroundColor:te.vb.interactiveBackground}])},tm={opacity:1};function tv(e){var t=e.item,n=e.state,r=(0,J.useRef)(null),i=(0,td.iX)({key:t.key},n,r),o=i.menuItemProps,a=i.isSelected,l=(0,tn.XI)({}),c=l.hoverProps,s=l.isHovered;return(0,C.tZ)(er.G,(0,w._)((0,b._)({innerRef:r,css:[tp.root,a&&tp.selected],style:s||a?tm:void 0},(0,tr.dG)(o,c)),{children:t.rendered}))}var tg=n(10910),ty=n(38080),tb=n(32883),tw={underlay:(0,e7.iv)([ea.l0.coverContainer,ea.l0.position.fixed]),surface:(0,e7.iv)([ea.l0.borderRadius(8),{boxShadow:ea.TV.shadow2,border:"1px solid",borderColor:ea.TV.backgroundHighest}])};function tZ(e){var t=e.state,n=e.triggerRef,r=e.placement,i=e.children,o=(0,Z._)((0,tg.Z)(),2),a=o[0],l=o[1],c=(0,tb.Sv)({placement:r,triggerRef:n,popoverRef:a,offset:8},t),s=c.popoverProps,u=c.underlayProps;return(0,C.BX)(tb.aV,{children:[(0,C.tZ)(er.G,(0,w._)((0,b._)({},u),{css:tw.underlay})),(0,C.BX)(ty.Tg,(0,w._)((0,b._)({elevated:!0,css:tw.surface,innerRef:l},s),{children:[(0,C.tZ)(tb.U4,{onDismiss:t.close}),i,(0,C.tZ)(tb.U4,{onDismiss:t.close})]}))]})}function tx(e){return CSS.escape(e.name)}function tC(e){var t=e.selectedSymbol,n=e.symbols,r=e.moveCursor,i=e.icon,o=e.text,a=(0,eV.W)({onOpenChange:function(e){e&&(0,e6.j)(e6.U3.CODE_NAVIGATION_USED,{action:"opened"})}}),l=(0,J.useRef)(null),c=(0,td.u4)({},a,l),s=c.menuTriggerProps,u=c.menuProps,d=t?new Set([t.name]):void 0;return(0,C.BX)(C.HY,{children:[(0,C.tZ)(tl,{text:o,icon:i,innerRef:l,ariaProps:s,active:a.isOpen}),a.isOpen?(0,C.tZ)(tZ,{triggerRef:l,state:a,placement:"bottom left",children:(0,C.tZ)(th,{menuProps:u,items:n,selectedKeys:d,onAction:function(e){var t=n.find(function(t){return tx(t)===e});t&&(r(t.selectionRange.start),(0,e6.j)(e6.U3.CODE_NAVIGATION_USED,{action:"jumped"}))},children:function(e){return(0,C.tZ)(e9.ck,{children:(0,C.tZ)(ts,{icon:(0,C.tZ)(e5,{kind:e.kind}),text:e.name})},tx(e))}})}):null]})}var tS=J.memo(function(e){var t=e.symbols,n=e.symbolsPath,r=e.moveCursor,i=n.length?n[n.length-1]:null,o=i?i.children:t;return(0,C.BX)(C.HY,{children:[n.map(function(e,i){var o=0===i?t:n[i-1].children;return o?(0,C.BX)(J.Fragment,{children:[(0,C.tZ)(U.Z,{size:12}),(0,C.tZ)(tC,{symbols:o,icon:(0,C.tZ)(e5,{kind:e.kind}),text:e.name,selectedSymbol:e,moveCursor:r})]},tx(e)):null}),(null==o?void 0:o.length)?(0,C.BX)(C.HY,{children:[(0,C.tZ)(U.Z,{size:12}),(0,C.tZ)(tC,{symbols:o,text:"...",moveCursor:r})]}):null]})}),tk=(0,J.memo)(function(e){var t,n=e.view,r=(0,J.useCallback)(function(e){null==n||n.dispatch({scrollIntoView:!0,selection:ek.jT.cursor((0,eN.RL)(n.state.doc,e))}),null==n||n.focus()},[n]),i=(0,J.useDeferredValue)({symbols:(0,G.IK)(n,eX),symbolsPath:(0,G.IK)(n,eH)});return(null===(t=i.symbols)||void 0===t?void 0:t.length)?(0,C.tZ)(tS,{symbols:i.symbols,symbolsPath:i.symbolsPath||[],moveCursor:r}):null}),t_=n(12506),tE=n(66995);function tT(e){var t=e.path,n=e.performPaneOperation,r=(0,es.uN)(),i=(0,J.useCallback)(function(e){n({operation:"open",pane:(0,t_.$E)(e)})},[n]);return(0,C.tZ)(t_.h4,{children:(0,C.tZ)(t_.Qc,{children:(0,C.tZ)(tE.tr,{path:t,onFileClick:i,children:(0,C.tZ)(tk,{view:r})})})})}var tR=n(75023),tI=n(16643),tD=n(66349),tG=n(54916),tB=n(91039),tP=n(57111),tA=new tR.j(function(e,t,n,r){return(0,tP.Rr)(e,t?(0,tB.ZF)("/home/runner/".concat(t.slug,"/").concat(n)):null,r)}),tN=n(16783),tL=n.n(tN),tU="".concat('url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><circle cx="10" cy="10" r="10" fill="black" /></svg>\')',", linear-gradient(transparent, transparent)"),tO="".concat('url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none" d="M2.5 10H15.5M15.5 10L9.5 5M15.5 10L9.5 15M18 4V16"/></svg>\')',", linear-gradient(transparent, transparent)"),tM=eR.tk.theme({".cm-vws-space":{backgroundColor:ea.TV.foregroundDimmest,maskImage:tU,maskSize:"0.375ch",maskPosition:"center",maskRepeat:"no-repeat","-webkit-mask-image":tU,"-webkit-mask-size":"0.375ch","-webkit-mask-position":"center","-webkit-mask-repeat":"no-repeat","&.cm-vws-leading":{opacity:.325},"&.cm-vws-enclosed":{opacity:.5},"&.cm-vws-trailing":{opacity:.5},"&.cm-vws-selected":{opacity:.75}},".cm-vws-tab":{backgroundColor:ea.TV.foregroundDimmest,maskImage:tO,maskSize:"1.75ch 1.75ch",maskPosition:"center",maskRepeat:"no-repeat","-webkit-mask-image":tO,"-webkit-mask-size":"1.75ch 1.75ch","-webkit-mask-position":"center","-webkit-mask-repeat":"no-repeat","&.cm-vws-leading":{opacity:.325,maskPosition:"left min(95%, 0.25ch) top 50%","-webkit-mask-position":"left min(95%, 0.25ch) top 50%"},"&.cm-vws-enclosed, &.cm-vws-trailing":{opacity:.5,maskPosition:"calc(50% - 0.25ch) 50%","-webkit-mask-position":"calc(50% - 0.25ch) 50%"},"&.cm-vws-selected":{opacity:.75}}}),tX=tL()(function(e,t,n){var r="cm-vws-".concat(" "===e?"space":"tab"," cm-vws-").concat(t).concat(n?" cm-vws-selected":"");return eR.p.mark({class:r})},function(e,t,n){return"".concat(e,"-").concat(t,"-").concat(n)});function tF(e,t,n){var r=e.facet(tV);if(!r.leading&&!r.enclosed&&!r.trailing&&!r.selected)return[];for(var i=[],o=e.doc.lineAt(t),a=e.doc.lineAt(n),l=o.number;l<=a.number;l++)!function(o){var a=e.doc.line(o),l=a.text.length;if(0!==l){var c=0===a.text.trim().length,s=!!r.selected&&e.selection.ranges.some(function(e){return!e.empty&&e.from<a.to&&e.to>=a.from});if(r.leading||r.enclosed||r.trailing||s){if(c){if(r.leading||r.trailing||s)for(var u=0;u<l;u++)!function(o){var l=a.text[o],c=a.from+o;if(!(c<t)&&!(c>=n)&&(" "===l||"	"===l)){var u=s&&e.selection.ranges.some(function(e){return e.from<=c&&e.to>c});(r.leading||r.trailing||u)&&i.push(tX(l,"trailing",u).range(c,c+1))}}(u);return}for(var d=l-a.text.trimStart().length,f=a.text.trim().length,h=0;h<l;h++)!function(o){var l=a.text[o],c=a.from+o;if(!(c<t)&&!(c>=n)&&(" "===l||"	"===l)){var u=void 0;u=o>=d+f?"trailing":o>d?"enclosed":"leading";var h=s&&e.selection.ranges.some(function(e){return e.from<=c&&e.to>c});(r[u]||h)&&i.push(tX(l,u,h).range(c,c+1))}}(h)}}}(l);return i}var tW=function(){"use strict";function e(t){(0,eE._)(this,e),this.decorations=eR.p.set(tF(t.state,0,t.state.doc.length))}return e.prototype.update=function(e){if((0,eL.a)(e,tV)){this.decorations=eR.p.set(tF(e.state,0,e.state.doc.length));return}var t=e.state.facet(tV);if(e.docChanged||e.selectionSet&&t.selected){var n=this.decorations,r=null,i=null;if(e.selectionSet&&t.selected){var o=e.startState.selection.ranges.filter(function(e){return!e.empty}),a=(0,x._)(e.state.selection.ranges).concat((0,x._)(e.startState.selection.map(e.changes).ranges)).filter(function(e){return!e.empty});o.length&&(r=ek.jT.create(o)),a.length&&(i=ek.jT.create(a))}if(e.docChanged&&e.changes.iterChangedRanges(function(t,n,o,a){var l=ek.jT.range(e.startState.doc.lineAt(t).from,e.startState.doc.lineAt(n).to);r=r?r.addRange(l):ek.jT.create([l]);var c=ek.jT.range(e.state.doc.lineAt(o).from,e.state.doc.lineAt(a).to);i=i?i.addRange(c):ek.jT.create([c])}),r){var l=r.ranges;n=n.update({filter:function(e,t){return!l.some(function(n){return n.from<=e&&n.to>=t})},filterFrom:l[0].from,filterTo:l[l.length-1].to})}e.docChanged&&(n=n.map(e.changes)),i&&(n=n.update({add:i.ranges.map(function(t){return tF(e.state,t.from,t.to)}).flat()})),this.decorations=n}},e}(),tH=eR.lg.fromClass(tW,{decorations:function(e){return e.decorations}}),tV=ek.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:{}},enables:[tM,ek.Wl.highest(tH)]}),tz=new tR.j(function(e,t,n,r){return e||t||n||r?tV.of({leading:e,enclosed:t,trailing:n,selected:r}):null}),tj=n(39426),tq=n(55534),tY=n(23394),tJ=n(72067),tK=n(41500),t$=new tR.j(function(e,t,n,r,i){if(!t||!n)return[];var o,a=R.Lf.of({deprecated:!0,format:(o=(0,e_._)(function(n){var r;return(0,eT.Jh)(this,function(i){return 0===n.length?[2,{result:n.toString()}]:(r=tK.Z.from(n.toString()).toBuffer(),[2,t.request({file:{path:e,content:r}}).then(function(e){return e.error||!e.file?{error:!0}:{result:tK.Z.from(e.file.content).toString()}})])})}),function(e){return o.apply(this,arguments)}),supportsRangeFormatting:!1,identifier:"formatter_service",onError:function(){r("Sorry, formatting ".concat(e," failed"),1500)},onSuccess:function(){i("Formatted ".concat(e," successfully"),1500)}});return ek.Wl.lowest(a)}),tQ=n(20435),t0=n(9069),t1=n(23896),t2=n(21084),t8=n(49418),t4=n(56729),t3=n(15482),t5=n(1660),t6=new tR.j(function(e,t,n,r,i,o,a,l,c,s){return e?e.formatters.map(function(e){var u;if(2===(u=e.id.split("/")).length&&u[1].includes("languageServer")){var d,f,h=n.find(function(t){return t.clientId===e.id});return h&&h&&h.isSupportedFile(l)&&r&&r.isFormatSupported&&(0,eU.Z)(h).isFormatSupported&&a?t0.Lf.of({format:(d=(0,e_._)(function(e,t){return(0,eT.Jh)(this,function(n){return[2,(t?h.request.formatRange(l,(0,eN.Ih)(e,t),{insertSpaces:i,tabSize:o}):h.request.format(l,{insertSpaces:i,tabSize:o})).then(function(t){return"error"in t||t.cancelled?{error:!0}:t.result?{result:(0,t2.Z)(t.result,e.toString())}:{result:ek.as.empty(e.length)}})]})}),function(e,t){return d.apply(this,arguments)}),supportsRangeFormatting:(0,eU.Z)(h).isFormatRangeSupported,identifier:h.clientId,name:h.clientName,onError:function(){s("Sorry, formatting ".concat(l," failed"),1500)},onSuccess:function(){c("Formatted ".concat(l," successfully"),1500)}}):[]}return(0,t3.F)(l,e)?t0.Lf.of({format:(f=(0,e_._)(function(n,r){var i,o,a,c,s;return(0,eT.Jh)(this,function(u){switch(u.label){case 0:if(!e.startCommand)throw Error("Expected formatter command");return i=(0,t5.Z)({container:t}),o=e.startCommand.args.map(function(e){return"$file"===e?l:e}),r&&e.id.includes("prettier")&&o.push("--range-start",String(r.main.from),"--range-end",String(r.main.to)),a="",c="",s=[i.onOutput(function(e){return a+=e}),i.onStderr(function(e){return c+=e}),i.dispose],[4,i.request((0,w._)((0,b._)({},e.startCommand),{args:o,lifecycle:tQ.api.Exec.Lifecycle.STDIN,stdin:n.toString()})).then(function(e){var t=e.error;return s.forEach(function(e){return e()}),t?{error:!0,message:c}:{result:a}})];case 1:return[2,u.sent()]}})}),function(e,t){return f.apply(this,arguments)}),supportsRangeFormatting:e.id.includes("prettier"),identifier:e.id,name:e.name,onSuccess:c,onError:s}):null}).filter(Boolean):null}),t9=n(54001),t7=n(12448),ne=n(4955),nt=n(9670),nn=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).type=e,r}return n.from=function(e){switch(e){case"yours":return this.yours;case"base":return this.base;case"middle":return this.middle;case"theirs":return this.theirs}},n.range=function(e,t,n){return this.from(e).range(t,n)},n}(ek.uU);function nr(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,i=[],o=n;o<=r;){var a=e.lineAt(o),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7;if(e.text.length<t)return null;var n=e.text[0],r=function(e){switch(e){case"<":return"yours";case"|":return"base";case"=":return"middle";case">":return"theirs";default:return null}}(n);if(!r)return null;var i=n.repeat(t);return e.text.slice(0,t)!==i||e.text.length>t&&" "!==e.text[t]?null:r}(a,t);l&&i.push(nn.range(l,a.from,a.to)),o=a.to+1}return i}nn.yours=new nn("yours"),nn.base=new nn("base"),nn.middle=new nn("middle"),nn.theirs=new nn("theirs");var ni=["yours","base","middle","theirs"];function no(e){Array.isArray(e)&&(e=ek.Xs.of(e));var t=[],n=[];if(0===e.size)return{hunks:t,hanging:n};for(var r=e.iter();null!==r.value;){var i,o,a,l={},c={},s=[],u=!0,d=!1,f=void 0;try{for(var h,p=ni[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value,v=r.value,g=r.from,y=r.to;if("base"!==m||v.type===m){if(v.type===m)l[m]={from:g,to:y},s.push({from:g,to:y,type:v.type});else if("yours"!==v.type)s.push({from:g,to:y,type:v.type});else break;if(r.next(),null===r.value)break}}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}if(!l.yours||!l.middle||!l.theirs){n.push.apply(n,(0,x._)(s));continue}null!==(i=l.base)&&void 0!==i||(l.base=null),null!==(o=c.base)&&void 0!==o||(c.base=null);var b=null!==(a=l.base)&&void 0!==a?a:l.middle,w=l.yours.to+1,Z=b.from-1;if(c.yours=w<Z?{from:w,to:Z}:null,l.base){var C=l.base.to+1,S=l.middle.from-1;c.base=C<S?{from:C,to:S}:null}var k=l.middle.to+1,_=l.theirs.from-1;c.theirs=k<_?{from:k,to:_}:null;var E={from:l.yours.from,to:l.theirs.to,markers:l,content:c};t.push(E)}return{hunks:t,hanging:n}}var na=ek.r$.define({combine:function(e){return e.length?e[0]:7}}),nl=ek.QQ.define({create:function(e){var t=e.doc,n=e.facet(na),r=ek.Xs.of(nr(t,n)),i=no(r);return{markers:r,hunks:i.hunks,hanging:i.hanging}},update:function(e,t){var n=t.newDoc,r=t.startState.facet(na),i=t.state.facet(na);if(r!==i){var o=ek.Xs.of(nr(n,i)),a=no(o);return{markers:o,hunks:a.hunks,hanging:a.hanging}}if(!t.docChanged)return e;var l=null,c=null,s=null,u=null;t.changes.iterChangedRanges(function(e,t,n,r){l=null===l?e:Math.min(l,e),c=null===c?t:Math.max(c,t),s=null===s?n:Math.min(s,n),u=null===u?r:Math.max(u,r)});var d=e.markers;if(null!==l&&null!==c){var f=t.startState.doc.lineAt(l).from,h=t.startState.doc.lineAt(c).to;d=d.update({filter:function(){return!1},filterFrom:f,filterTo:h})}d=d.map(t.changes),null!==s&&null!==u&&(d=d.update({add:nr(n,i,s,u)}));var p=no(d);return{markers:d,hunks:p.hunks,hanging:p.hanging}}}),nc=eR.tk.atomicRanges.from(nl,function(e){return function(){return e.markers}}),ns=ek.yy.changeFilter.of(function(e){var t=e.startState.field(nl);if(!e.docChanged||0===t.markers.size)return!0;var n=e.startState.doc,r=[];return e.changes.iterChanges(function(e,i,o,a,l){var c=l.length,s=Math.max(n.lineAt(e).from-1,0),u=Math.min(n.lineAt(i).to+1,n.length);t.markers.between(s,u,function(t,s){e<=t&&i>=s||0!==c&&(e===s&&"\n"===l.sliceString(0,1)||i===t&&"\n"===l.sliceString(c-1,c))||o===a&&(i===s+1&&0===n.lineAt(i).length||e===t-1&&0===n.lineAt(e).length)||r.push(t-1,s+1)})}),!(r.length>0)||r}),nu=ek.yy.transactionFilter.of(function(e){var t=e.docChanged?e.state.field(nl):e.startState.field(nl);if(0===t.markers.size)return e;var n=e.newSelection,r=!1,i=!1;do{i=!1;for(var o=0;o<n.ranges.length&&"break"!==function(e){var o=n.ranges[e],a=o.from,l=o.to,c=a,s=l;if(t.markers.between(a,l,function(e,t){var n=(e+t)/2;a>e&&a<t&&(c=a<n?e:t),l>e&&l<t&&(s=l<n?e:t)}),c!==a||s!==l){var u,d=o.anchor<o.head?c:s,f=o.anchor<o.head?s:c,h=o.goalColumn,p=null!==(u=o.bidiLevel)&&void 0!==u?u:void 0,m=ek.jT.range(d,f,h,p);return n=n.replaceRange(m,e),i=!0,r=!0,"break"}}(o);o++);}while(i);return r?[e,{selection:n,sequential:!0}]:e}),nd=n(42516),nf="cm-git-conflict-marker-yours",nh="cm-git-conflict-marker-base",np="cm-git-conflict-marker-middle",nm="cm-git-conflict-marker-theirs",nv="cm-git-conflict-marker-hanging",ng="cm-git-conflict-content-yours",ny="cm-git-conflict-content-base",nb="cm-git-conflict-content-theirs";function nw(e){var t=e.background,n=e.color,r=e.noBorder,i={color:n,backgroundColor:t,backgroundClip:"padding-box",paddingTop:ea.TV.space4,paddingBottom:ea.TV.space4,fontWeight:ea.TV.fontWeightBold};return void 0!==r&&r||(i.borderLeft="4px solid rgba(0, 150, 255, 0.1)",i.paddingLeft="2px"),i}function nZ(e){return{backgroundColor:e.background,backgroundClip:"padding-box",borderLeft:"4px solid rgba(0, 150, 255, 0.1)",paddingLeft:"2px"}}var nx=eR.tk.theme((d={},(0,nd._)(d,".".concat(nf),nw({background:"rgba(0, 150, 255, 0.1)",color:ea.TV.blueStrongest,noBorder:!0})),(0,nd._)(d,".".concat(np),nw({background:"rgba(255, 0, 0, 0.1)",color:ea.TV.redStrongest})),(0,nd._)(d,".".concat(nh),nw({background:"rgba(255, 165, 0, 0.1)",color:ea.TV.orangeStrongest})),(0,nd._)(d,".".concat(nm),nw({background:"rgba(0, 150, 255, 0.1)",color:ea.TV.blueStrongest,noBorder:!0})),(0,nd._)(d,".".concat(nv),nw({background:"rgba(100, 150, 255, 0.1)",color:ea.TV.blueStrongest,noBorder:!0})),(0,nd._)(d,".".concat(ng),nZ({background:"rgba(0, 255, 0, 0.1)"})),(0,nd._)(d,".".concat(nb),nZ({background:"rgba(255, 0, 0, 0.1)"})),(0,nd._)(d,".".concat(ny),nZ({background:"rgba(255, 165, 0, 0.1)"})),d)),nC={yours:{marker:eR.p.line({class:nf}),content:eR.p.line({class:ng})},base:{marker:eR.p.line({class:nh}),content:eR.p.line({class:ny})},middle:{marker:eR.p.line({class:np})},theirs:{marker:eR.p.line({class:nm}),content:eR.p.line({class:nb})},hanging:{marker:eR.p.line({class:nv})}},nS=function(){"use strict";function e(t){(0,eE._)(this,e),this.builder=new ek.f_,this.doc=t}var t=e.prototype;return t.add=function(e,t){var n=this.doc.lineAt(e.from);if(n.to>=e.to){this.builder.add(n.from,n.from,t);return}for(var r=n.from;r<=e.to;)this.builder.add(r,r,t),r=this.doc.lineAt(r).to+1},t.finish=function(){return this.builder.finish()},e}(),nk=eR.tk.decorations.from(nl,function(e){return function(t){var n=new nS(t.state.doc),r=!0,i=!1,o=void 0;try{for(var a,l=e.hunks[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;t.viewport.from>c.to||t.viewport.to<c.from||(n.add(c.markers.yours,nC.yours.marker),c.content.yours&&n.add(c.content.yours,nC.yours.content),c.markers.base&&n.add(c.markers.base,nC.base.marker),c.content.base&&n.add(c.content.base,nC.base.content),n.add(c.markers.middle,nC.middle.marker),c.content.theirs&&n.add(c.content.theirs,nC.theirs.content),n.add(c.markers.theirs,nC.theirs.marker))}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n.finish()}}),n_=eR.tk.decorations.from(nl,function(e){return function(){var t=new ek.f_,n=!0,r=!1,i=void 0;try{for(var o,a=e.hanging[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;t.add(l.from,l.from,nC.hanging.marker)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t.finish()}}),nE=[nl,[nc,ns,nu],[ek.Wl.lowest(nx),nk,n_]],nT=n(31157),nR=function(){"use strict";function e(t,n,r,i,o,a){(0,eE._)(this,e),this.original=t,this.current=n,this.chunks=r,this.desc=i,this.pending=o,this.ranges=a}var t=e.prototype;return t.hasChanges=function(){return this.ranges.length>0},t.update=function(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.original,a=this.chunks,l=this.desc,c=this.pending,s=this.ranges;if(Math.abs((this.pending?this.pending.length:this.current.length)-t.length)>=250||i){var u=(0,nT.Gj)(l,c,n).pending;a=(0,nT.U_)(o,t,{chunks:a,changesB:u}),l=(0,nT.fu)(a,o.length),c=null,s=(0,nT.Hu)(l)}else c=(r=(0,nT.Gj)(l,c,n)).pending,l=r.desc,s=(0,nT.Hu)(l);return c&&t.eq(o)&&(a=[],l=ek.as.empty(o.length),c=null,s=[]),new e(o,t,a,l,c,s)},t.isAccurate=function(){return null===this.pending},t.getLineChangeType=function(e){var t=this.current.line(e);return 0===this.original.length&&this.current.length>0?nT.dQ.COVERED:(0,nT.dx)(t,nT.MF.B,this.ranges)},t.iterRanges=function(){return(0,eT.Jh)(this,function(e){switch(e.label){case 0:return[5,(0,eT.XA)(this.ranges)];case 1:return e.sent(),[2]}})},e.create=function(t,n){var r=(0,nT.U_)(t,n),i=(0,nT.fu)(r,t.length),o=(0,nT.Hu)(i);return new e(t,n,r,i,null,o)},e}(),nI=ek.r$.define({combine:function(e){var t;return null!==(t=e.filter(Boolean)[0])&&void 0!==t?t:null}}),nD=ek.QQ.define({create:function(){return null},update:function(e,t){var n=t.state.facet(nI);return!n||Math.max(n.lines,t.newDoc.lines)>5e3?null:(e&&e.original.eq(n)?t.docChanged&&(e=e.update(t.newDoc,t.changes,!(t.isUserEvent("input.type")||t.isUserEvent("delete.forward")||t.isUserEvent("delete.backward")))):e=nR.create(n,t.newDoc),e)}}),nG=n(92708),nB=(0,eR.v5)({class:nG.Tr,renderEmptyElements:!0,lineMarker:function(e,t){var n=e.state.field(nD,!1);if(!n||!n.hasChanges())return null;if(0===n.original.length)return nG.Vt;var r=e.state.doc.lineAt(t.from);switch(n.getLineChangeType(r.number)){case nT.dQ.COVERED:return nG.vP;case nT.dQ.MODIFIED:return nG.wp;default:return null}},initialSpacer:function(e){return e.state.field(nD,!1)?nG.Vt:nG.Do},updateSpacer:function(e,t){var n=t.state.field(nD,!1)?nG.Vt:nG.Do;return e===n?e:n}}),nP=ek.r$.define({enables:function(e){return[nI.computeN([e],function(t){return t.facet(e)}),nG.Lw,nD,ek.Wl.highest(nB)]}}),nA=n(10814);(o=f||(f={})).GUTTER_DIFF="GUTTER_DIFF",o.INLINE_DIFF="INLINE_DIFF";var nN=ek.Py.define(),nL=ek.Py.define(),nU=ek.QQ.define({create:function(){return{head:null,mode:"GUTTER_DIFF"}},update:function(e,t){var n=e.head,r=e.mode,i=!0,o=!1,a=void 0;try{for(var l,c=t.effects[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.is(nN)?n=s.value:s.is(nL)&&(r=s.value)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return n!==e.head||r!==e.mode?{head:n,mode:r}:e},provide:function(e){return[nP.from(e,function(e){return"GUTTER_DIFF"===e.mode?e.head:null}),nA.p.from(e,function(e){return"INLINE_DIFF"===e.mode?e.head:null})]}}),nO=function(){"use strict";function e(t,n,r){var i=this;(0,eE._)(this,e),this.view=t,this.git=n,this.path=r,this.disposed=!1,this.dispose=n.onRefresh(function(){return i.fetchThenUpdateState()}),this.fetchThenUpdateState()}var t=e.prototype;return t.fetchThenUpdateState=function(){var e=this;return(0,e_._)(function(){var t,n,r,i,o;return(0,eT.Jh)(this,function(a){switch(a.label){case 0:return[4,e.git.getFileContents({path:e.path,revision:"HEAD"})];case 1:if(t=a.sent(),e.disposed||!(n=e.view.state.field(nU,!1)))return[2];return(!(o=null===(i=t.error?null:null!==(r=t.content)&&void 0!==r?r:"")?null:e.view.state.toText(i))!=!n.head||o&&n.head&&!o.eq(n.head))&&e.view.dispatch({effects:nN.of(o)}),[2]}})})()},t.destroy=function(){this.dispose(),this.disposed=!0},e}(),nM=n(25425),nX=new tR.j(function(e,t,n,r){var i=[];return n||i.push(t?[nU,eR.lg.define(function(n){return new nO(n,e,t)})]:[]),(r||i.push(nE),0===i.length)?null:i}),nF=n(12569),nW=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e,r){var i;return(0,eE._)(this,n),(i=t.call(this)).src=e,i.pos=r,i}var r=n.prototype;return r.eq=function(e){return this.src===e.src&&this.pos===e.pos},r.toDOM=function(){var e=document.createElement("img");return e.src=this.src,e.dataset.pos=this.pos.toString(),e.style.maxHeight="64px",e.style.maxWidth="256px",e},r.ignoreEvent=function(){return!1},n}(eR.l9),nH=/"data:image\/\w+;base64,[^"\s]+"/g,nV=Number.MAX_VALUE,nz=new tR.j(function(e){return e?eR.lg.define(function(e){var t=new eR.Y1({regexp:nH,decoration:function(e,t,n){if(void 0===e[0])throw Error("Failed to match image");var r=e[0].substring(1,e[0].length-1);return eR.p.replace({widget:new nW(r,n)})},maxLength:nV});return{matcher:t,deco:t.createDeco(e),update:function(e){e.docChanged&&(this.deco=t.updateDeco(e,this.deco))}}},{decorations:function(e){return e.deco},provide:function(e){return eR.tk.atomicRanges.of(function(t){var n=t.plugin(e);return n?n.deco:eR.p.none})}}):null}),nj=n(8131),nq=n(29457),nY=n(73367),nJ=n(69543),nK=n(11669),n$=n(54472),nQ=n(89835),n0=n(74833),n1=n(93918),n2=n(73030),n8=n(96132),n4="cm-ghostwriter-hint-tooltip",n3=eR.tk.theme((0,nd._)({".cm-ghostwriter-hint":{display:"none",width:"100%",backgroundColor:ea.TV.backgroundHigher,borderTop:"solid 1px ".concat(ea.TV.outlineDefault)}},".cm-tooltip-autocomplete.".concat(n4," .cm-ghostwriter-hint"),{display:"block"})),n5=(0,n1.X)({hint:[ea.l0.p(4),ea.l0.rowWithGap(8),ea.l0.align.center,ea.l0.font.default,{opacity:.6}],prompt:[ea.l0.rowWithGap(4),ea.l0.align.center]});function n6(){return(0,C.BX)(er.G,{css:n5.hint,children:[(0,C.tZ)(n2.Z,{width:8,height:8}),(0,C.BX)(er.G,{css:n5.prompt,children:[(0,C.tZ)(n8.ZP,{size:"small",dimmed:!1,shortcut:{key:"tab"}}),(0,C.tZ)(n0.xv,{variant:"small",multiline:!1,children:"to use AI suggestion."})]})]})}var n9=eR.lg.define(function(e){var t=function(){var t,n,r;return(0,x._)(e.dom.children).concat((0,x._)(null!==(r=null===(n=nQ.yb.get(e))||void 0===n?void 0:null===(t=n.children[0])||void 0===t?void 0:t.children)&&void 0!==r?r:[])).filter(function(e){return e.classList.contains("cm-tooltip-autocomplete")})},n=function(e){return Array.from(e.children).filter(function(e){return e.classList.contains("cm-ghostwriter-hint")})},r=!1;return{update:function(){null!==(0,nY.LR)(e.state)&&Promise.resolve().then(function(){if(!r){var e=!0,i=!1,o=void 0;try{for(var a,l=t()[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var c=a.value,s=n(c);if(0===s.length){var u=(0,n$.V)((0,C.tZ)(n6,{}));u.className="cm-ghostwriter-hint",c.appendChild(u)}}}catch(e){i=!0,o=e}finally{try{e||null==l.return||l.return()}finally{if(i)throw o}}}})},destroy:function(){var e=!0,i=!1,o=void 0;try{for(var a,l=t()[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var c=a.value,s=!0,u=!1,d=void 0;try{for(var f,h=n(c)[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value;c.removeChild(p)}}catch(e){u=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw d}}}}catch(e){i=!0,o=e}finally{try{e||null==l.return||l.return()}finally{if(i)throw o}}r=!0}}}),n7=ek.Py.define(),re=ek.QQ.define({create:function(){return null},update:function(e,t){null!==(0,nY.LR)(t.state)?e&&(e=(0,w._)((0,b._)({},e),{missed:e.missed.compose(t.changes)})):e=null;var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)o.value.is(n7)&&(e={original:t.state.doc,missed:ek.as.empty(t.state.doc.length)})}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e}});function rt(e,t){var n=e.field(re,!1);if(n){var r=(0,eN.RL)(n.original,t);return n.missed.mapPos(r)}return(0,eN.RL)(e.doc,t)}var rn=n(34791),rr=n(2689),ri=n(45400),ro=n(44478),ra=n(74207),rl=n(68333),rc=n(53326),rs=(0,n1.X)({styles0:[{p:{whiteSpace:"pre-wrap"}}]}),ru={p:{padding:"".concat(ea.TV.space2," ").concat(ea.TV.space8),lineHeight:1.4,marginBottom:"".concat(ea.TV.space8," !important")},"p:first-of-type":{marginTop:"".concat(ea.TV.space4," !important")},"p:last-of-type":{marginBottom:"".concat(ea.TV.space4," !important")},pre:{margin:"".concat(ea.TV.space2," ").concat(ea.TV.space8)},"pre + p":{borderTop:"1px solid ".concat(ea.TV.outlineDimmest),paddingTop:ea.TV.space4},"h1, h2, h3":{margin:"".concat(ea.TV.space8," !important"),marginTop:"".concat(ea.TV.space12," !important"),padding:"0 !important",paddingBottom:"".concat(ea.TV.space4," !important"),fontSize:"100% !important",borderBottom:"1px solid ".concat(ea.TV.backgroundHighest," !important"),lineHeight:1},"h1:first-of-type, h2:first-of-type, h3:first-of-type":{marginTop:"".concat(ea.TV.space4," !important")},hr:{margin:"".concat(ea.TV.space8," !important"),borderTop:"2px solid ".concat(ea.TV.backgroundHighest," !important")},li:{margin:"".concat(ea.TV.space2," ").concat(ea.TV.space8)},".lsp-completion-detail":{borderBottom:"1px solid ".concat(ea.TV.backgroundHighest),marginBottom:ea.TV.space4},".cm-line":{paddingLeft:ea.TV.space4,paddingRight:ea.TV.space4},".cm-content":{paddingLeft:ea.TV.space4,paddingRight:ea.TV.space4}},rd=(0,J.memo)(function(e){var t=e.content,n=e.className;return(0,C.tZ)(er.G,{css:ru,children:(0,C.tZ)(rl.ZP,{className:n,components:{code:function(e){return(0,C.tZ)(rc.Z,(0,b._)({minimal:!0,disableCopy:!0},e))}},children:t})})});function rf(e){var t=e.content,n=e.className;return"string"==typeof t?(0,C.tZ)(rd,{css:rs.styles0,className:n,content:t}):t.kind===e4.MarkupKind.PlainText?(0,C.tZ)(er.G,{children:(0,C.tZ)(n0.xv,{className:n,children:t.value})}):(0,C.tZ)(rd,{className:n,content:t.value})}var rh=n(98924),rp=n(4384),rm=n(83176),rv=n(25490);(a=h||(h={}))[a.Dollar=0]="Dollar",a[a.Colon=1]="Colon",a[a.Comma=2]="Comma",a[a.CurlyOpen=3]="CurlyOpen",a[a.CurlyClose=4]="CurlyClose",a[a.Backslash=5]="Backslash",a[a.Forwardslash=6]="Forwardslash",a[a.Pipe=7]="Pipe",a[a.Int=8]="Int",a[a.VariableName=9]="VariableName",a[a.Format=10]="Format",a[a.Plus=11]="Plus",a[a.Dash=12]="Dash",a[a.QuestionMark=13]="QuestionMark",a[a.EOF=14]="EOF";var rg=function(){"use strict";function e(){(0,eE._)(this,e),this.value="",this.pos=0}var t=e.prototype;return t.text=function(e){this.value=e,this.pos=0},t.tokenText=function(e){return this.value.substr(e.pos,e.len)},t.next=function(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};var t,n=this.pos,r=0,i=this.value.charCodeAt(n);if("number"==typeof(t=e._table[i]))return this.pos+=1,{type:t,pos:n,len:1};if(e.isDigitCharacter(i)){t=8;do r+=1,i=this.value.charCodeAt(n+r);while(e.isDigitCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}}if(e.isVariableCharacter(i)){t=9;do i=this.value.charCodeAt(n+ ++r);while(e.isVariableCharacter(i)||e.isDigitCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}}t=10;do r+=1,i=this.value.charCodeAt(n+r);while(!isNaN(i)&&void 0===e._table[i]&&!e.isDigitCharacter(i)&&!e.isVariableCharacter(i));return this.pos+=r,{type:t,pos:n,len:r}},e.isDigitCharacter=function(e){return e>=48&&e<=57},e.isVariableCharacter=function(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90},e}();rg._table=(p={},(0,nd._)(p,36,0),(0,nd._)(p,58,1),(0,nd._)(p,44,2),(0,nd._)(p,123,3),(0,nd._)(p,125,4),(0,nd._)(p,92,5),(0,nd._)(p,47,6),(0,nd._)(p,124,7),(0,nd._)(p,43,11),(0,nd._)(p,45,12),(0,nd._)(p,63,13),p);var ry=function(){"use strict";function e(){(0,eE._)(this,e),this._children=[],function(e,t){t.forEach(function(t){Object.defineProperty(e,t,{enumerable:!1,writable:!0})})}(this,["parent"])}var t=e.prototype;return t.appendChild=function(e){return e instanceof rb&&this._children[this._children.length-1]instanceof rb?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this},t.replace=function(e,t){var n=e.parent,r=n.children.indexOf(e),i=n.children.slice(0);i.splice.apply(i,[r,1].concat((0,x._)(t))),n._children=i,function e(t,n){var r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;c.parent=n,e(c.children,c)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}}(t,n)},t.toString=function(){return this.children.reduce(function(e,t){return e+t.toString()},"")},t.len=function(){return 0},t.match=function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=Object.entries(rR)[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=(0,Z._)(i.value,2),l=a[0],c=a[1];if(this instanceof c&&l in e)return e[l](this)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}},(0,rp._)(e,[{key:"children",get:function(){return this._children}},{key:"rightMostDescendant",get:function(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}},{key:"snippet",get:function(){for(var e=this;;){if(!e)return;if(e instanceof rE)return e;e=e.parent}}}]),e}(),rb=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).value=e,r}var r=n.prototype;return r.toString=function(){return this.value},r.toTextmateString=function(){return n.escape(this.value)},r.len=function(){return this.value.length},r.clone=function(){return new n(this.value)},n.escape=function(e){return e.replace(/\$|}|\\/g,"\\$&")},n}(ry),rw=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(){return(0,eE._)(this,n),t.apply(this,arguments)}return n}(ry),rZ=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).index=e,r}var r=n.prototype;return r.toTextmateString=function(){var e="";return(this.transform&&(e=this.transform.toTextmateString()),0!==this.children.length||this.transform)?0===this.children.length?"${".concat(this.index).concat(e,"}"):this.choice?"${".concat(this.index,"|").concat(this.choice.toTextmateString(),"|").concat(e,"}"):"${".concat(this.index,":").concat(this.children.map(function(e){return e.toTextmateString()}).join("")).concat(e,"}"):"$".concat(this.index)},r.clone=function(){var e=new n(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(function(e){return e.clone()}),e},n.compareByIndex=function(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0},(0,rp._)(n,[{key:"isFinalTabstop",get:function(){return 0===this.index}},{key:"choice",get:function(){return 1===this._children.length&&this._children[0]instanceof rx?this._children[0]:void 0}}]),n}(rw),rx=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(){var e;return(0,eE._)(this,n),e=t.apply(this,arguments),e.options=[],e}var r=n.prototype;return r.appendChild=function(e){return e instanceof rb&&(e.parent=this,this.options.push(e)),this},r.toString=function(){return this.options[0].value},r.toTextmateString=function(){return this.options.map(function(e){return e.value.replace(/\||,|\\/g,"\\$&")}).join(",")},r.len=function(){return this.options[0].len()},r.clone=function(){var e=new n;return this.options.forEach(e.appendChild,e),e},n}(ry),rC=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(){var e;return(0,eE._)(this,n),e=t.apply(this,arguments),e.regexp=RegExp(""),e}var r=n.prototype;return r.resolve=function(e){var t=this,n=!1,r=e.replace(this.regexp,function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return n=!0,t._replace(r.slice(0,-2))});return!n&&this._children.some(function(e){return e instanceof rS&&!!e.elseValue})&&(r=this._replace([])),r},r._replace=function(e){var t="",n=!0,r=!1,i=void 0;try{for(var o,a=this._children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l instanceof rS){var c=e[l.index]||"";c=l.resolve(c),t+=c}else t+=l.toString()}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t},r.toString=function(){return""},r.toTextmateString=function(){return"/".concat(this.regexp.source,"/").concat(this.children.map(function(e){return e.toTextmateString()}),"/").concat((this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":""))},r.clone=function(){var e=new n;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(function(e){return e.clone()}),e},n}(ry),rS=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e,r,i,o){var a;return(0,eE._)(this,n),(a=t.call(this)).index=e,a.shorthandName=r,a.ifValue=i,a.elseValue=o,a}var r=n.prototype;return r.resolve=function(e){if("upcase"===this.shorthandName)return e?e.toLocaleUpperCase():"";if("downcase"===this.shorthandName)return e?e.toLocaleLowerCase():"";if("capitalize"===this.shorthandName)return e?e[0].toLocaleUpperCase()+e.substr(1):"";if("pascalcase"===this.shorthandName)return e?this._toPascalCase(e):"";if("camelcase"===this.shorthandName)return e?this._toCamelCase(e):"";if(e&&"string"==typeof this.ifValue)return this.ifValue;if(!e&&"string"==typeof this.elseValue)return this.elseValue;else return e||""},r._toPascalCase=function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map(function(e){return e.charAt(0).toUpperCase()+e.substr(1)}).join(""):e},r._toCamelCase=function(e){var t=e.match(/[a-z0-9]+/gi);return t?t.map(function(e,t){return 0===t?e.charAt(0).toLowerCase()+e.substr(1):e.charAt(0).toUpperCase()+e.substr(1)}).join(""):e},r.toTextmateString=function(){var e="${";return e+=this.index,this.shorthandName?e+=":/".concat(this.shorthandName):this.ifValue&&this.elseValue?e+=":?".concat(this.ifValue,":").concat(this.elseValue):this.ifValue?e+=":+".concat(this.ifValue):this.elseValue&&(e+=":-".concat(this.elseValue)),e+="}"},r.clone=function(){return new n(this.index,this.shorthandName,this.ifValue,this.elseValue)},n}(ry),rk=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).name=e,r}var r=n.prototype;return r.resolve=function(e){var t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),void 0!==t&&(this._children=[new rb(t)],!0)},r.toTextmateString=function(){var e="";return(this.transform&&(e=this.transform.toTextmateString()),0===this.children.length)?"${".concat(this.name).concat(e,"}"):"${".concat(this.name,":").concat(this.children.map(function(e){return e.toTextmateString()}).join("")).concat(e,"}")},r.clone=function(){var e=new n(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(function(e){return e.clone()}),e},n}(rw);function r_(e,t){for(var n=(0,x._)(e);n.length>0;){var r=n.shift();if(!t(r))break;n.unshift.apply(n,(0,x._)(r.children))}}var rE=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(){return(0,eE._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.offset=function(e){var t=0,n=!1;return(this.walk(function(r){return r===e?(n=!0,!1):(t+=r.len(),!0)}),n)?t:-1},r.fullLen=function(e){var t=0;return r_([e],function(e){return t+=e.len(),!0}),t},r.enclosingPlaceholders=function(e){for(var t=[],n=e.parent;n;)n instanceof rZ&&t.push(n),n=n.parent;return t},r.resolveVariables=function(e){var t=this;return this.walk(function(n){return n instanceof rk&&n.resolve(e)&&delete t._placeholders,!0}),this},r.appendChild=function(e){return delete this._placeholders,(0,rm._)((0,rv._)(n.prototype),"appendChild",this).call(this,e)},r.replace=function(e,t){return delete this._placeholders,(0,rm._)((0,rv._)(n.prototype),"replace",this).call(this,e,t)},r.toTextmateString=function(){return this.children.reduce(function(e,t){return e+t.toTextmateString()},"")},r.clone=function(){var e=new n;return this._children=this.children.map(function(e){return e.clone()}),e},r.walk=function(e){r_(this.children,e)},(0,rp._)(n,[{key:"placeholderInfo",get:function(){if(!this._placeholders){var e,t=[];this.walk(function(n){return n instanceof rZ&&(t.push(n),e=!e||e.index<n.index?n:e),!0}),this._placeholders={all:t,last:e}}return this._placeholders}},{key:"placeholders",get:function(){return this.placeholderInfo.all}}]),n}(ry),rT=function(){"use strict";function e(){(0,eE._)(this,e),this._scanner=new rg,this._token={type:14,pos:0,len:0}}var t=e.prototype;return t.text=function(e){return this.parse(e).toString()},t.parse=function(e,t,n){var r=new rE;return this.parseFragment(e,r),this.ensureFinalTabstop(r,null!=n&&n,null!=t&&t),r},t.parseFragment=function(e,t){var n=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););var r=new Map,i=[];t.walk(function(e){return e instanceof rZ&&(e.isFinalTabstop?r.set(0,void 0):!r.has(e.index)&&e.children.length>0?r.set(e.index,e.children):i.push(e)),!0});var o=function(e,n){var i=r.get(e.index);if(i){var a=new rZ(e.index);a.transform=e.transform;var l=!0,c=!1,s=void 0;try{for(var u,d=i[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value.clone();a.appendChild(f),f instanceof rZ&&r.has(f.index)&&!n.has(f.index)&&(n.add(f.index),o(f,n),n.delete(f.index))}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}t.replace(e,[a])}},a=new Set,l=!0,c=!1,s=void 0;try{for(var u,d=i[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;o(f,a)}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}return t.children.slice(n)},t.ensureFinalTabstop=function(e,t,n){(t||n&&e.placeholders.length>0)&&!e.placeholders.find(function(e){return 0===e.index})&&e.appendChild(new rZ(0))},t._accept=function(e,t){if(void 0===e||this._token.type===e){var n=!t||this._scanner.tokenText(this._token);return this._token=this._scanner.next(),n}return!1},t._backTo=function(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1},t._until=function(e){for(var t=this._token;this._token.type!==e;){if(14===this._token.type)return!1;if(5===this._token.type){var n=this._scanner.next();if(0!==n.type&&4!==n.type&&5!==n.type)return!1}this._token=this._scanner.next()}var r=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),r},t._parse=function(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)},t._parseEscaped=function(e){var t;return!!(t=this._accept(5,!0))&&(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new rb(t)),!0)},t._parseTabstopOrVariableName=function(e){var t,n=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new rZ(Number(t)):new rk(t)),!0):this._backTo(n)},t._parseComplexPlaceholder=function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(n);var r=new rZ(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new rb("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(r.index>0&&this._accept(7))for(var i=new rx;;){if(this._parseChoiceElement(i)){if(this._accept(2))continue;if(this._accept(7)&&(r.appendChild(i),this._accept(4)))return e.appendChild(r),!0}return this._backTo(n),!1}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)},t._parseChoiceElement=function(e){for(var t=this._token,n=[];2!==this._token.type&&7!==this._token.type;){var r=void 0;if(!(r=(r=this._accept(5,!0))?this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||r:this._accept(void 0,!0)))return this._backTo(t),!1;n.push(r)}return 0===n.length?(this._backTo(t),!1):(e.appendChild(new rb(n.join(""))),!0)},t._parseComplexVariable=function(e){var t,n=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(n);var r=new rk(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(r),!0;if(!this._parse(r))return e.appendChild(new rb("${"+t+":")),r.children.forEach(e.appendChild,e),!0}else if(this._accept(6))return this._parseTransform(r)?(e.appendChild(r),!0):(this._backTo(n),!1);else if(this._accept(4))return e.appendChild(r),!0;else return this._backTo(n)},t._parseTransform=function(e){for(var t=new rC,n="",r="";!this._accept(6);){var i=void 0;if(i=this._accept(5,!0)){n+=i=this._accept(6,!0)||i;continue}if(14!==this._token.type){n+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){var o=void 0;if(o=this._accept(5,!0)){o=this._accept(5,!0)||this._accept(6,!0)||o,t.appendChild(new rb(o));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(14!==this._token.type){r+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(n,r)}catch(e){return!1}return e.transform=t,!0},t._parseFormatString=function(e){var t=this._token;if(!this._accept(0))return!1;var n=!1;this._accept(3)&&(n=!0);var r=this._accept(8,!0);if(!r)return this._backTo(t),!1;if(!n||this._accept(4))return e.appendChild(new rS(Number(r))),!0;if(!this._accept(1))return this._backTo(t),!1;if(this._accept(6)){var i=this._accept(9,!0);return i&&this._accept(4)?(e.appendChild(new rS(Number(r),i)),!0):(this._backTo(t),!1)}if(this._accept(11)){var o=this._until(4);if(o)return e.appendChild(new rS(Number(r),void 0,o,void 0)),!0}else if(this._accept(12)){var a=this._until(4);if(a)return e.appendChild(new rS(Number(r),void 0,void 0,a)),!0}else if(this._accept(13)){var l=this._until(1);if(l){var c=this._until(4);if(c)return e.appendChild(new rS(Number(r),void 0,l,c)),!0}}else{var s=this._until(4);if(s)return e.appendChild(new rS(Number(r),void 0,void 0,s)),!0}return this._backTo(t),!1},t._parseAnything=function(e){return 14!==this._token.type&&(e.appendChild(new rb(this._scanner.tokenText(this._token))),this._accept(void 0),!0)},e.escape=function(e){return e.replace(/\$|}|\\/g,"\\$&")},e.asInsertText=function(t){return new e().parse(t).toString()},e.guessNeedsClipboard=function(e){return/\${?CLIPBOARD/.test(e)},e}(),rR={Text:rb,Placeholder:rZ,Variable:rk,FormatString:rS,Choice:rx},rI=function(){"use strict";function e(t){(0,eE._)(this,e),this.lines=t.split(/\r\n?|\n/).map(function(e){return new rT().parse(e).children})}return e.prototype.apply=function(t){var n=t.view,r=t.from,i=t.to,o=e.instantiate(this.lines,t),a=o.text,l=o.ranges,c={from:r,to:i,insert:ek.xv.of(a)},s={changes:c,scrollIntoView:!0,annotations:nY.Jv.of(t.completion)};if(l.length&&(s.selection=rL(l,0)),l.length>1){var u=new rB(l,0),d=s.effects=[rP.of(u)];void 0===n.state.field(rN,!1)&&d.push(ek.Py.appendConfig.of([rN,rO,rM]))}if(r===i&&!l.length){var f=ek.as.of(c,n.state.doc.length),h=n.state.selection.ranges.map(function(e){return e.map(f,0)});s.selection=ek.jT.create(h,n.state.selection.mainIndex)}return s},e.resolveVariable=function(e,t){var n=t.view,r=t.from,i=t.path;switch(e){case"TM_FILENAME":return(0,ri.basename)(i);case"TM_FILENAME_BASE":return(0,ri.basename)(i,(0,ri.extname)(i));case"TM_DIRECTORY":return(0,ri.dirname)(i);case"TM_FILEPATH":return i;case"TM_LINE_INDEX":return(n.state.doc.lineAt(r).number-1).toString();case"TM_LINE_NUMBER":return n.state.doc.lineAt(r).number.toString();default:return e}},e.instantiate=function(t,n){var r=n.view,i=n.from,o=r.state,a=[],l=[],c=o.doc.lineAt(i),s=/^\s*/.exec(c.text)[0],u=o.facet(S.c),d=!0,f=!1,h=void 0;try{for(var p,m,v=t[Symbol.iterator]();!(d=(m=v.next()).done);d=!0)!function(){var t=m.value,r=0,o="",c=function(e){var t=0,n=r;if(0===r&&(t=/^\t*/.exec(e)[0].length)){var i=s+u.repeat(t);e=i+e.slice(t),n+=i.length}return o+=e,r+=e.length,{line:a.length,from:n,to:r}},d=function(t){var o=!0,s=!1,u=void 0;try{for(var f,h=t[Symbol.iterator]();!(o=(f=h.next()).done);o=!0)f.value.match({Text:function(e){c(e.value)},Variable:function(t){var r=t.name,i=t.transform,o=e.resolveVariable(r,n);i&&(o=o.replace(i.regexp,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.children.map(function(e){return e.match({Text:function(e){return e.value},FormatString:function(e){return e.resolve(t[e.index])}})}).filter(Boolean).join("")})),c(o)},Choice:function(e){c(e.options[0].value)},Placeholder:function(e){var t,n=a.length?i+a.map(function(e){return e.length}).reduce(function(e,t){return e+t}):i;if(null===(t=e.children)||void 0===t?void 0:t.length){var o={field:e.index,from:n+r,to:null};l.push(o),d(e.children),o.to=n+r}else{c("");var s=n+r;l.push({field:e.index,from:s,to:s})}}})}catch(e){s=!0,u=e}finally{try{o||null==h.return||h.return()}finally{if(s)throw u}}};d(t),a.push(o)}()}catch(e){f=!0,h=e}finally{try{d||null==v.return||v.return()}finally{if(f)throw h}}var g=(p=Math).max.apply(p,(0,x._)(l.map(function(e){return e.field})));return{text:a,ranges:l.map(function(e){var t=e.field,n=(0,rh._)(e,["field"]);return(0,w._)((0,b._)({},n),{field:0===t?g:t-1})})}},e}(),rD=eR.p.widget({widget:new(function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(){return(0,eE._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.toDOM=function(){var e=document.createElement("span");return e.className="cm-snippetFieldPosition",e},r.ignoreEvent=function(){return!1},n}(eR.l9))}),rG=eR.p.mark({class:"cm-snippetField"}),rB=function(){"use strict";function e(t,n){(0,eE._)(this,e),this.ranges=t,this.active=n,this.deco=eR.p.set(t.map(function(e){return(e.from===e.to?rD:rG).range(e.from,e.to)}))}var t=e.prototype;return t.map=function(t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=this.ranges[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value,s=function(e,t){var n=t.mapPos(e.from,-1,ek.gc.TrackDel),r=t.mapPos(e.to,1,ek.gc.TrackDel);return null==n||null==r?null:{field:e.field,from:n,to:r}}(c,t);if(!s)return null;n.push(s)}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return new e(n,this.active)},t.isSelectionInsideField=function(e){var t=this;return e.ranges.every(function(e){return t.ranges.some(function(n){return n.field===t.active&&n.from<=e.from&&n.to>=e.to})})},e}(),rP=ek.Py.define({map:function(e,t){return null==e?void 0:e.map(t)}}),rA=ek.Py.define(),rN=ek.QQ.define({create:function(){return null},update:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.effects[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;if(l.is(rP))return l.value;if(l.is(rA)&&e)return new rB(e.ranges,l.value)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.isSelectionInsideField(t.selection)&&(e=null),e},provide:function(e){return eR.tk.decorations.from(e,function(e){return e?e.deco:eR.p.none})}});function rL(e,t){var n=e.filter(function(e){return e.field===t}).map(function(e){return ek.jT.range(e.from,e.to)});if(0!==n.length)return ek.jT.create(n)}function rU(e){return function(t){var n,r=t.state,i=t.dispatch,o=r.field(rN,!1);if(!o||e<0&&0===o.active)return!1;var a=o.active+e,l=(n=Math).max.apply(n,(0,x._)(o.ranges.map(function(e){return e.field}))),c=e>0&&o.active>=l;return i(r.update({selection:rL(o.ranges,a),effects:rP.of(c?null:new rB(o.ranges,a))})),!0}}var rO=ek.Wl.highest(eR.$f.of([{key:"Tab",run:rU(1),shift:rU(-1)},{key:"Escape",run:function(e){var t=e.state,n=e.dispatch;return!!t.field(rN,!1)&&(n(t.update({effects:rP.of(null)})),!0)}}])),rM=eR.tk.domEventHandlers({mousedown:function(e,t){var n,r=t.state.field(rN,!1);if(!r||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;var i=r.ranges.find(function(e){return e.from<=n&&e.to>=n});return!!i&&i.field!==r.active&&(t.dispatch({selection:rL(r.ranges,i.field),effects:rP.of(r.ranges.some(function(e){return e.field>i.field})?new rB(r.ranges,i.field):null)}),!0)}});function rX(e){var t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),"[".concat(n?"\\w":"").concat(t.replace(".","").replace(/[^\w\s]/g,"\\$&"),"]")}var rF=Object.entries(e4.CompletionItemKind).reduce(function(e,t){var n=(0,Z._)(t,2),r=n[0],i=n[1];return(0,b._)((0,nd._)({},i,r.toLowerCase()),e)},{});function rW(e,t){return{from:rt(e,t.start),to:rt(e,t.end)}}function rH(e,t){var n=rW(e.state,t.range),r=n.from,i=n.to;if(null!==r&&null!==i)return{from:r,to:i,insert:t.newText}}var rV=eR.tk.baseTheme({".lsp-completion-keyboard-shortcuts":{display:"none"},'[aria-selected="true"] .lsp-completion-keyboard-shortcuts':{float:"right",display:"inline-block"}}),rz=n(30609);function rj(e){var t=e.content,n=e.className,r=e.showHoveredVariable,i=(0,B.Gn)("fontSize").preferences;if("string"!=typeof t&&"kind"in t)return(0,C.tZ)(rf,{content:t});var o=(Array.isArray(t)?t:[t]).map(function(e){return"string"==typeof e?e:"```"+e.language+"\n"+e.value+"\n```"}).join("\n");return(0,C.tZ)(rl.ZP,{css:[{p:{fontSize:i.fontSize}},r?[ea.l0.maxHeight(rq),ea.l0.overflowY("auto")]:void 0],className:n,components:{code:function(e){return(0,C.tZ)(rc.Z,(0,b._)({minimal:!0,disableCopy:!0},e))}},children:o})}var rq=100;function rY(e){var t=e.className,n=e.content,r=e.textHovered,i=(0,nM.P5)({controlName:"flag-debugger-hover-variable",logFlagToAnalytics:!1}),o=(0,tG.Z)().debuggest,a=(0,tI.Z)(o.mainClient),l=a&&("running"===a.state.current||"paused"===a.state.current),c=(0,Z._)((0,J.useState)(!1),2),s=c[0],u=c[1],d=(0,Z._)((0,J.useState)(void 0),2),f=d[0],h=d[1],p=i&&l&&f;return(0,J.useEffect)(function(){function e(){return(e=(0,e_._)(function(){var e,t;return(0,eT.Jh)(this,function(n){switch(n.label){case 0:if(!(i&&l))return[3,4];u(!0),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,a.evaluate({expression:r,context:"hover"})];case 2:return(null===(e=(t=n.sent()).body)||void 0===e?void 0:e.result)&&h((0,b._)({name:r,value:t.body.result},t.body)),[3,4];case 3:return u(!1),[7];case 4:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[i,a,l,r]),(0,C.BX)(er.G,{css:[ru,p?ea.l0.maxHeight(rq+190):ea.l0.maxHeight(190),ea.l0.minHeight(30),ea.l0.overflowY("auto"),ea.l0.borderRadius(4),ea.l0.backgroundColor.backgroundHigher],children:[s?void 0:(0,C.tZ)(rj,{content:n,className:t,showHoveredVariable:!!p}),p?(0,C.tZ)(er.G,{css:[ea.l0.maxHeight(190),ea.l0.overflowY("auto")],children:(0,C.tZ)(rz._,{depth:0,client:a,variable:f})}):void 0]})}var rJ=n(22031),rK=n(82200),r$=n(22421),rQ=n(23758),r0=n(59620),r1=n(81031),r2=n(95032),r8=n(22487),r4=n(58719),r3=n(50831),r5=(0,n1.X)({snippetGroupText:[ea.l0.pl(8),ea.l0.py(8)],snippetGroupContainer:[ea.l0.p(4)],loadingContainer:[ea.l0.width(128),ea.l0.height(128),ea.l0.display.flex,ea.l0.align.center,ea.l0.justify.center],lspTooltipContainer:[ea.l0.minWidth("375px"),ea.l0.maxWidth("500px"),ea.l0.pt(4),ea.l0.overflowY("scroll")],firstReferenceDivider:[ea.l0.border({direction:"bottom",color:ea.TV.backgroundHighest})],headerGroup:[ea.l0.p(4)],headerContainer:[ea.l0.flex.row,ea.l0.justify.spaceBetween,ea.l0.align.center,ea.l0.pr(4)],header:[ea.l0.p(4),ea.l0.pl(8)],referencesGroups:[ea.l0.p(4)],referencesHeader:[ea.l0.p(4),ea.l0.pl(8)]});function r6(e){var t=e.matchesMap,n=e.fileToContents,r=e.type,i=e.onClose,o=e.jumpToPosition,a=Object.keys(t);return 0===a.length?(0,C.tZ)(n0.xv,{color:"dimmer",css:r5.snippetGroupText,multiline:!1,children:"REFERENCES"===r?"No references found":"No definitions found"}):(0,C.tZ)(er.G,{children:a.map(function(e){var r=t[e],l=n[e],c=(0,r2.Z)(r,l);return(0,C.tZ)(er.G,{css:r5.snippetGroupContainer,children:(0,C.tZ)(r1.V,{path:e,extensions:[c],doc:l,numMatches:r.length,initiallyExpanded:1===a.length,onNavigateToCode:function(t){if(null!==t)o({path:e,line:t.line+1,col:t.character});else{var n=(0,Z._)(r,1)[0],a=l.lineAt(n.from),c=n.from-a.from;o({path:e,line:a.number,col:c})}i()}})},e)})})}function r9(e){var t=e.files,n=e.onClose,r=e.references,i=e.definitions,o=e.currentFile,a=e.currentFileContents,l=e.jumpToPosition,c=(0,tG.Z)().fs,s=(0,t8.Z)(o)[0],u=(0,r8.Z)(n,[]),d=(0,Z._)((0,J.useState)((0,nd._)({},o,ek.xv.of(a.split("\n")))),2),f=d[0],h=d[1];(0,J.useEffect)(function(){if(t.length){var e=!1;return!function(){n.apply(this,arguments)}(),function(){e=!0}}function n(){return(n=(0,e_._)(function(){var n;return(0,eT.Jh)(this,function(r){switch(r.label){case 0:var i;return n={},[4,Promise.all(t.map((i=(0,e_._)(function(e){var t;return(0,eT.Jh)(this,function(r){switch(r.label){case 0:return[4,c.readFile(e)];case 1:if((t=r.sent()).error)throw Error("Something went wrong reading file with path ".concat(e,". Received error: ").concat(t.error));return n[e]=ek.xv.of(t.content.toString().split("\n")),[2]}})}),function(e){return i.apply(this,arguments)})))];case 1:if(r.sent(),e)return[2];return h(function(e){return(0,b._)({},e,n)}),[2]}})})).apply(this,arguments)}},[c,t]);var p=(0,x._)(r).concat((0,x._)(i));if(!s||p.some(function(e){return!(s.documentUriToPath(e.uri) in f)}))return(0,C.tZ)(er.G,{css:r5.loadingContainer,children:(0,C.tZ)(H.Z,{size:32})});var m={},v={};function g(e,t){if(!s)throw Error("Expected LSP Client");var n=s.documentUriToPath(e.uri),r=e.range,i=r.start,o=r.end;n in t||(t[n]=[]);var a=f[n],l=a.line(i.line+1),c=a.line(o.line+1);t[n].push({from:l.from+i.character,to:c.from+o.character})}return r.forEach(function(e){g(e,m)}),i.forEach(function(e){g(e,v)}),(0,C.BX)(er.G,{innerRef:u,css:r5.lspTooltipContainer,children:[(0,C.tZ)(er.G,{css:r5.firstReferenceDivider,children:(0,C.BX)(er.G,{css:r5.headerGroup,children:[(0,C.BX)(er.G,{css:r5.headerContainer,children:[(0,C.tZ)(n0.h4,{level:2,variant:"subheadDefault",css:r5.header,children:"Definitions"}),(0,C.tZ)(r3.Z,{filled:!1,border:!1,onClick:n,children:(0,C.tZ)(r4.Z,{})})]}),(0,C.tZ)(r6,{matchesMap:v,fileToContents:f,type:"DEFINITION",onClose:n,currentFile:o,jumpToPosition:l})]})}),(0,C.tZ)(er.G,{children:(0,C.BX)(er.G,{css:r5.referencesGroups,children:[(0,C.tZ)(n0.h4,{level:2,variant:"subheadDefault",css:r5.referencesHeader,children:"References"}),(0,C.tZ)(r6,{matchesMap:m,fileToContents:f,type:"REFERENCES",onClose:n,currentFile:o,jumpToPosition:l})]})})]})}(l=m||(m={})).DEFINITION="DEFINITION",l.REFERENCES="REFERENCES";var r7=n(13358),ie=(0,n(62609).B)(),it=ek.Py.define(),ir=ek.QQ.define({create:function(){return null},update:function(e,t){if(t.isUserEvent("select")||t.isUserEvent("undo")||t.isUserEvent("redo"))return null;if(!t.isUserEvent("input.type")||t.changes.empty)return e;var n="";return t.changes.iterChanges(function(e,t,r,i,o){n=o.sliceString(0,1)}),n||null}}),ii=new n$.J(function(e){var t,n,r=e.help,i=e.index,o="1px solid ".concat(ea.TV.outlineDimmer),a="min(425px, 80vw)",l=r.signatures[i],c=r.signatures.length>1;if(!l)return null;var s=l.documentation,u=null!=r.activeParameter&&(null===(n=l.parameters)||void 0===n?void 0:null===(t=n[r.activeParameter])||void 0===t?void 0:t.documentation);return(0,C.BX)(er.G,{css:[ea.l0.flex.row,ea.l0.backgroundColor.backgroundHigher,{width:"max-content"}],children:[c?(0,C.tZ)(er.G,{css:[ea.l0.flex.row,ea.l0.pl(4),{borderRight:o,paddingBottom:5}],children:(0,C.BX)("span",{css:[{alignSelf:"flex-end"},ea.l0.p(4)],children:[i+1,"/",r.signatures.length]})}):null,(0,C.BX)(er.G,{children:[(0,C.tZ)(er.G,{css:[ea.l0.py(4),ea.l0.pl(c?4:8),ea.l0.pr(8),ea.l0.maxHeight(100),ea.l0.overflowY("scroll"),ea.l0.font.code,{lineHeight:ea.TV.lineHeightSmall,maxWidth:a}],children:(0,C.tZ)(io,{signature:l,activeParameter:r.activeParameter})}),!!(s||u)&&(0,C.BX)(er.G,{css:[ea.l0.px(c?4:8),ea.l0.py(2),ea.l0.maxHeight(200),ea.l0.overflow("scroll"),{borderTop:o,maxWidth:a}],children:[u?(0,C.tZ)(rf,{content:u}):null,s?(0,C.tZ)(rf,{content:s}):null]})]})]})});function io(e){var t,n=e.signature,r=n.label,i=n.parameters,o=e.activeParameter;if(null==o||!i)return(0,C.tZ)("span",{children:r});var a=null===(t=i[o])||void 0===t?void 0:t.label;if(!a)return(0,C.tZ)("span",{children:r});var l=(0,Z._)("string"==typeof a?[r.indexOf(a),r.indexOf(a)+a.length]:a,2),c=l[0],s=l[1];return(0,C.BX)("div",{children:[(0,C.tZ)("span",{children:r.slice(0,c)}),(0,C.tZ)("strong",{children:a}),(0,C.tZ)("span",{children:r.slice(s)})]})}function ia(){return(ia=(0,e_._)(function(e,t,n,r,i){var o,a;return(0,eT.Jh)(this,function(l){switch(l.label){case 0:return i.current&&n.notify.cancelRequest(i.current),o=n.generateId(),i.current=o,[4,n.request.signatureHelp(r,(0,eN.sg)(e.doc,t),{id:o})];case 1:if(a=l.sent(),i.current=null,"error"in a)return[2,null];return[2,a.result]}})})).apply(this,arguments)}var il=n(8701),ic=n(92674),is=n.n(ic),iu=new Map,id=n(445),ih=n(22488),ip=n(99071),im=n(36625),iv=n(49932),ig=eR.tk.theme({"& .cm-gutters.cm-minimap-gutter":{backgroundColor:iv.TV.backgroundDefault,borderLeft:"1px solid ".concat(iv.TV.backgroundHigher)},"& .cm-minimap-box-shadow":{boxShadow:"unset"}}),iy=ek.QQ.define({create:function(e){return 0===e.doc.length||e.doc.lines>1e3},update:function(e,t){return t.docChanged?0===t.state.doc.length||t.state.doc.lines>1e3:e}}),ib=new tR.j(function(e,t,n){var r=function(){return{dom:document.createElement("div")}};return e?null:[ig,iy,im.a.compute([nD,iy],function(e){if(e.field(iy,!1)||"blocks"!==t&&"characters"!==t)return null;var i=e.field(nD,!1),o={};if(i)for(var a=1;a<=e.doc.lines;a++)switch(i.getLineChangeType(a)){case nT.dQ.COVERED:o[a]=n.values.global.greenDefault;break;case nT.dQ.MODIFIED:o[a]=n.values.global.blueDefault}return{create:r,displayText:t,gutters:[o]}})]}),iw=n(48652),iZ=n(85234),ix=n.n(iZ),iC=n(17542),iS="cm-multiplayer-selection-green",ik="cm-multiplayer-selection-red",i_="cm-multiplayer-selection-blue",iE="cm-multiplayer-selection-gold",iT="cm-multiplayer-selection-purple",iR="cm-multiplayer-selection-teal",iI="cm-multiplayer-selection-pink",iD=eR.tk.theme((v={},(0,nd._)(v,".".concat(iS),{background:"rgba(27, 196, 125, 0.2)"}),(0,nd._)(v,".".concat(ik),{background:"rgba(239, 85, 51, 0.2)"}),(0,nd._)(v,".".concat(i_),{background:"rgba(24, 160, 251, 0.2)"}),(0,nd._)(v,".".concat(iE),{background:"rgba(255, 199, 0, 1)"}),(0,nd._)(v,".".concat(iT),{background:"rgba(144, 124, 255, 0.2)"}),(0,nd._)(v,".".concat(iR),{background:"rgba(0, 181, 206, 0.2)"}),(0,nd._)(v,".".concat(iI),{background:"rgba(238, 70, 211, 0.2)"}),v)),iG={"#1BC47D":iS,"#EF5533":ik,"#18A0FB":i_,"#FFC700":iE,"#907CFF":iT,"#00B5CE":iR,"#EE46D3":iI},iB=ek.Py.define(),iP=ek.Py.define(),iA=ek.Py.define(),iN=ek.QQ.define({create:function(){return{}},update:function(e,t){if(!t.changes.empty){var n=function(e){return t.changes.mapPos(Math.min(t.changes.length,e))},r={},i=!0,o=!1,a=void 0;try{for(var l,c=Object.values(e)[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;r[s.id]=(0,w._)((0,b._)({},s),{position:n(s.position),selectionStart:n(s.selectionStart),selectionEnd:n(s.selectionEnd)})}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}e=r}var u=!0,d=!1,f=void 0;try{for(var h,p=t.effects[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value;if(m.is(iC.R)&&(e=(0,b._)({},e)),m.is(iB)&&m.value.position<=t.newDoc.length&&((e=(0,b._)({},e))[m.value.id]=(0,b._)({},m.value)),m.is(iP)&&(e=(0,b._)({},e),m.is(iP)&&delete e[m.value]),m.is(iA)){e=(0,b._)({},e);var v=!0,g=!1,y=void 0;try{for(var x,C=Object.entries(e)[Symbol.iterator]();!(v=(x=C.next()).done);v=!0){var S=(0,Z._)(x.value,2),k=S[0];S[1].username===m.value&&delete e[k]}}catch(e){g=!0,y=e}finally{try{v||null==C.return||C.return()}finally{if(g)throw y}}}}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}return e},provide:function(e){return[iD,ek.Wl.high((0,eR.EY)({above:!1,class:"cm-multiplayer-cursor-layer",update:function(t){return(0,eL.a)(t,e)},markers:function(t){var n=t.state.field(e,!1);if(!n)return[];var r=[],i=!0,o=!1,a=void 0;try{for(var l,c=Object.values(n)[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value,u=s.selectionStart,d=s.selectionEnd,f=s.color.selection;if(u!==d){var h=ek.jT.range(u,d);r.push.apply(r,(0,x._)(eR.dc.forRange(t,f,h)))}}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return r}}))]}}),iL=eR.tk.theme({".multiplayer-cursor":{width:"2px",left:"0",top:"0"},".multiplayer-cursor .multiplayer-label":{boxShadow:ea.TV.shadow1,borderRadius:ea.TV.borderRadius4,padding:"1px",position:"absolute",left:"0px",animation:"fadeOut 2s ease-in forwards",color:"white",display:"inline-block",whiteSpace:"nowrap"},".multiplayer-cursor:hover .multiplayer-label":{animation:"auto"}});function iU(e){e.style.transform="translate(-10000px, -10000px)"}var iO=/iPhone|iPad|iPod/i;function iM(){return!!window.navigator.userAgent.match(iO)||"ontouchstart"in window&&window.navigator.userAgent.includes("Macintosh")}function iX(e){var t=document.createElement("div");t.textContent=e.username,t.style.backgroundColor=e.color.cursor,t.classList.add("multiplayer-label");var n=document.createElement("div");return n.classList.add("multiplayer-cursor"),n.style.backgroundColor=e.color.cursor,n.style.position=iM()?"absolute":"fixed",n.appendChild(t),{dom:n,label:t}}var iF=new Map,iW=[iL,eR.lg.define(function(e){var t=e.state.field(iN,!1),n=new Map((t?Object.values(t):[]).map(function(e){return[e.id,{view:iX(e),cursor:e}]})),r=!0,i=0,o="function"==typeof IntersectionObserver?new IntersectionObserver(function(e){Date.now()>i-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&s()},{threshold:[1]}):null;function a(){o&&(o.disconnect(),n.forEach(function(e){o.observe(e.view.dom)}))}function l(){t&&0!==Object.values(t).length&&(e.inView&&e.requestMeasure(u),r!==e.inView)&&!(r=e.inView)&&n.forEach(function(e){iU(e.view.dom)})}a();var c=null;function s(){null===c&&(c=setTimeout(function(){c=null,l()},50))}window.addEventListener("resize",s);var u={read:function(){return{editorRect:e.scrollDOM.getBoundingClientRect(),dimensions:new Map((t?Object.values(t):[]).map(function(t){var r=n.get(t.id),i=r?function(e,t){var n=iF.get(e);if(n)return n;var r=t.getBoundingClientRect().width;return iF.set(e,r),r}(t.username,r.view.label):null;return[t.id,{position:e.coordsAtPos(t.position),labelWidth:i}]}))}},write:function(e){n.forEach(function(t,n){var r=e.dimensions.get(n);!function(e){var t=e.cursorView,n=e.position,r=e.labelWidth,i=e.editorRect,o=t.dom,a=t.label;if(!n||!r){iU(o);return}var l=n.bottom-n.top;if(n.bottom<=i.top+l||n.top+l>=i.bottom||n.right<i.left-.1||n.left>i.right+.1){iU(o);return}var c=n.left+r-i.right,s="0px";c>0?(s="-".concat(c,"px"),a.style.borderBottomLeftRadius="4px"):a.style.borderBottomLeftRadius="0px",a.style.pointerEvents="none",a.style.transform="translate(".concat(s,", -100%)");var u=iM()?{x:n.left-i.left+"px",y:n.top-i.top+"px"}:{x:"calc(".concat(n.left,"px + var(--fixed-position-offset-x))"),y:"calc(".concat(n.top,"px + var(--fixed-position-offset-y))")},d=u.x,f=u.y;o.style.transform="translate(".concat(d,", ").concat(f,")"),o.style.height=l+"px"}({cursorView:t.view,position:(null==r?void 0:r.position)||null,labelWidth:(null==r?void 0:r.labelWidth)||null,editorRect:e.editorRect})})},key:"multiplayer-cursors-plugin-".concat(ix()())};return{update:function(r){r.transactions.length&&(i=Date.now());var o=r.state.field(iN,!1);if(!(o!==r.startState.field(iN,!1))){r.geometryChanged&&l();return}var c=new Map,s=new Set;if(o){var u=new Map((0,x._)(n.values()).map(function(e){return[e.cursor.id,e.view]}));Object.values(o).forEach(function(t){var n=u.get(t.id);if(n)s.add(n),c.set(t.id,{view:n,cursor:t});else{var r=iX(t);c.set(t.id,{view:r,cursor:t}),e.dom.appendChild(r.dom)}})}n.forEach(function(e){s.has(e.view)||e.view.dom.remove()}),n=c,t=o,a(),l()},destroy:function(){window.removeEventListener("resize",s),n.forEach(function(e){e.view.dom.remove()}),t=void 0,n=new Map,null==o||o.disconnect(),c&&clearTimeout(c)},maybeMeasure:l}},{eventHandlers:{scroll:function(){this.maybeMeasure()}}})],iH=function(){"use strict";function e(t,n,r,i){var o=this;(0,eE._)(this,e),this.view=t,this.destroyed=!1,this.colors=this.getColorMapFromUsers(i.getActiveUsers()),this.disposes=[],this.updateSelections=null,this.disposes.push(i.onUserLeave(function(e){o.destroyed||o.view.dispatch({effects:iA.of(e.username)})}),i.onActiveUsersChange(function(e){o.destroyed||(o.colors=o.getColorMapFromUsers(e))}),r.watchTextFile(n,{onReady:function(e){var t=e.updateSelections;o.destroyed||(o.updateSelections=t)},onCursor:function(e){if(!o.destroyed){var t=function(e){var t,n=e.cursor,r=e.usernameColorsMap,i=null===(t=n.user)||void 0===t?void 0:t.name;if(i){var o=n.id,a=n.position,l=n.selectionStart,c=n.selectionEnd,s=r[i];if(s&&o&&"number"==typeof a&&"number"==typeof l&&"number"==typeof c)return iB.of({id:o,username:i,position:a,color:{cursor:s,selection:iG[s]||""},selectionStart:l,selectionEnd:c})}}({cursor:e,usernameColorsMap:o.colors});t&&o.view.dispatch({effects:t})}},onRemoveCursor:function(e){o.destroyed||o.view.dispatch({effects:iP.of(e)})},onError:function(){o.updateSelections=null},onMoveOrDelete:function(){o.updateSelections=null}}))}var t=e.prototype;return t.getColorMapFromUsers=function(e){return e.reduce(function(e,t){return t.username&&t.color?(0,w._)((0,b._)({},e),(0,nd._)({},t.username,t.color)):e},{})},t.postUpdate=function(e){if(!(!e.selectionSet||e.transactions.every(function(e){return e.annotation(ek.YW.remote)}))&&this.updateSelections){var t=e.state.selection.ranges.map(function(e){return{position:e.head,selectionStart:e.from,selectionEnd:e.to}});this.updateSelections(t)}},t.destroy=function(){this.destroyed=!0,this.disposes.forEach(function(e){return e()})},e}(),iV=new tR.j(function(e,t,n){return[iW,iN,eR.lg.define(function(r){return new iH(r,e,t,n)},{provide:function(e){return eR.tk.updateListener.of(function(t){var n;return null===(n=t.view.plugin(e))||void 0===n?void 0:n.postUpdate(t)})}})]}),iz=function(){"use strict";function e(t,n){var r=this;(0,eE._)(this,e),this.view=t,this.presence=n,this.destroyed=!1,this.followed=null,this.dispose=n.onFollowedUserChanged(function(e){return r.onFollowedUserChanged(e)}),Promise.resolve().then(function(){r.onFollowedUserChanged(n.getFollowedUser())})}var t=e.prototype;return t.onFollowedUserChanged=function(e){var t=this;if(!this.destroyed&&(this.followed=e,this.followed)){var n=this.view.state.field(iN,!1);if(n){var r=Object.values(n).find(function(e){var n;return e.username===(null===(n=t.followed)||void 0===n?void 0:n.username)});r&&this.jumpToPosition(r.position)}}},t.jumpToPosition=function(e){this.view.dispatch({effects:[eR.tk.scrollIntoView(ek.jT.cursor(e),{x:"center",y:"center"})]})},t.unfollow=function(){this.presence.getFollowedUser()&&this.presence.unfollowUser()},t.postUpdate=function(e){if(this.followed){var t=void 0,n=!0,r=!1,i=void 0;try{for(var o,a=e.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=!0,s=!1,u=void 0;try{for(var d,f=l.effects[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value;h.is(iB)&&h.value.username===this.followed.username&&(t=h)}}catch(e){s=!0,u=e}finally{try{c||null==f.return||f.return()}finally{if(s)throw u}}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}t&&this.jumpToPosition(t.value.position)}},t.destroy=function(){this.destroyed=!0,this.dispose()},e}(),ij=new tR.j(function(e){return eR.lg.define(function(t){return new iz(t,e)},{provide:function(e){return eR.tk.updateListener.of(function(t){var n;return null===(n=t.view.plugin(e))||void 0===n?void 0:n.postUpdate(t)})},eventHandlers:{click:function(){this.unfollow()},wheel:function(){this.unfollow()},keydown:function(e){"Control"!==e.key&&"Meta"!==e.key&&this.unfollow()}}})}),iq=n(54450),iY=eR.lg.define(function(e){var t=e.state.facet(iJ),n=[];return{update:function(e){t=e.state.facet(iJ);var n=!0,r=!1,i=void 0;try{for(var o,a=e.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;l.changes.empty||this.pushTransaction(l)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}},flush:function(){n=[]},logs:function(){return n},pushEvent:function(t){var n={anchor:e.state.selection.main.anchor,head:e.state.selection.main.head,docLength:e.state.doc.length,time:Date.now(),type:t.type};t instanceof KeyboardEvent&&(n.key=t.key,n.metaKey=t.metaKey,n.shiftKey=t.shiftKey,n.altKey=t.altKey,n.ctrlKey=t.ctrlKey),t instanceof InputEvent&&(n.data=t.data,n.inputType=t.inputType,n.isComposing=t.isComposing),t instanceof CompositionEvent&&(n.data=t.data),this.pushLog(n)},pushTransaction:function(e){this.pushLog({userEvent:e.annotation(ek.YW.userEvent),changes:JSON.stringify(e.changes),time:Date.now(),type:"transaction"})},pushLog:function(e){t&&(n.push(e),n=n.slice(Math.max(0,n.length-100)))}}},{provide:function(e){var t=function(t,n){var r;return null===(r=n.plugin(e))||void 0===r?void 0:r.pushEvent(t)};return ek.Wl.highest(eR.tk.domEventHandlers({keypress:t,keydown:t,keyup:t,beforeinput:t,input:t,compositionstart:t,compositionupdate:t,compositionend:t}))}}),iJ=ek.r$.define({combine:function(e){return!!e.length&&e[0]}}),iK=new tR.j(function(e){return iJ.of(e)}),i$=n(63009),iQ=n(87584),i0=n(30084),i1=ek.q6.define(),i2=ek.Py.define(),i8=ek.QQ.define({create:function(){return!0},update:function(e,t){return!(0,eL.a)(t,i2)&&e},provide:function(e){return iw.o.from(e)}}),i4=function(){"use strict";function e(t,n,r,i){var o=this;(0,eE._)(this,e),this.view=t,this.path=n,this.fs=r,this.writeChange=null,this.destroyed=!1,this.debug=(0,w._)((0,b._)({},i),{latestReceivedVersion:0,openVersion:0,initiatedChanges:0,previousInitiatedChanges:null}),this.dispose=r.watchTextFile(n,{onReady:function(e){var n=e.initialContent,r=e.writeChange,i=e.version;o.destroyed||(o.debug.latestReceivedVersion=i,o.debug.openVersion=i,o.debug.setBsodFilePathVersion({filePath:o.path,version:i}),o.debug.trackTimeToLoadFileEnd(o.path),o.writeChange=r,t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n},effects:i2.of(null),annotations:[ek.YW.addToHistory.of(!1),ek.YW.remote.of(!0),i1.of(!0)]}))},onChange:function(e){var n=e.changes,r=e.changeSource,i=e.version;if(!o.destroyed){o.debug.latestReceivedVersion=i,o.debug.setBsodFilePathVersion({filePath:o.path,version:i});try{t.dispatch({changes:n,annotations:[ek.YW.remote.of(r===i0.Fl.Container),ek.YW.addToHistory.of(r===i0.Fl.Local),i1.of(!0)]})}catch(e){o.debugThrowSyncRemoteOpError(n,r,e)}}},onError:function(){o.destroyed||(o.dispose=null,o.writeChange=null)},onMoveOrDelete:function(){o.destroyed||(o.dispose=null,o.writeChange=null)}})}var t=e.prototype;return t.postUpdate=function(e){if(e.docChanged&&this.writeChange){var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(!(a.annotation(ek.YW.remote)||a.annotation(i1))){this.debug.initiatedChanges++;var l=a.annotation(iq.Z)?{author:"ghostwriter"}:{};try{this.writeChange(a.changes,l),this.debug.previousInitiatedChanges=a.changes}catch(t){this.debugThrowWriteChangeError(e,a,t);break}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},t.destroy=function(){var e;this.destroyed=!0,null===(e=this.dispose)||void 0===e||e.call(this),this.dispose=null,this.writeChange=null,this.debug.deleteBsodFilePathVersion({filePath:this.path})},t.debugThrowSyncRemoteOpError=function(e,t,n){var r=this;this.fs.readFile(this.path,{fromDisk:!1}).then(function(i){var o="replitReadError: "+i.error;i.error||(o=i.content.toString());var a=r.view.contentDOM.innerText;r.debug.throwBsod({origin:"Codemirror: ot/syncRemoteOp",error:n,tags:{ot:!0},extras:{filePath:r.path,previousChanges:JSON.stringify(r.debug.previousInitiatedChanges),changes:JSON.stringify(e),changeSource:t,otClientDoc:o,domText:a,cmDoc:r.view.state.doc.sliceString(0),openVersion:r.debug.openVersion,version:r.debug.latestReceivedVersion,initiatedChanges:r.debug.initiatedChanges}}),(0,eR.OO)(r.view.state,n)})},t.debugThrowWriteChangeError=function(e,t,n){var r=this;this.fs.readFile(this.path,{fromDisk:!1}).then(function(i){var o="replitReadError: "+i.error;i.error||(o=i.content.toString());var a=e.view.contentDOM.innerText,l=e.view.plugin(iY),c=null==l?void 0:l.logs();null==l||l.flush(),r.debug.throwBsod({origin:"Codemirror: ot/writeChange",error:n,tags:{ot:!0},extras:{filePath:r.path,previousChanges:JSON.stringify(r.debug.previousInitiatedChanges),transactionChanges:JSON.stringify(t.changes),otherTransactionChanges:JSON.stringify(e.transactions.filter(function(e){return e!==t}).map(function(e){return e.changes})),transactionDoc:t.newDoc.sliceString(0),updateDoc:e.state.doc.sliceString(0),otClientDoc:o,domText:a,openVersion:r.debug.openVersion,latestReceivedVersion:r.debug.latestReceivedVersion,keystrokes:JSON.stringify(c)}})}),(0,eR.OO)(e.state,n)},e}(),i3=new tR.j(function(e,t,n){return eR.lg.define(function(r){return new i4(r,e,t,n)},{provide:function(e){return[i8,eR.tk.updateListener.of(function(t){var n;return null===(n=t.view.plugin(e))||void 0===n?void 0:n.postUpdate(t)})]}})}),i5=n(61018),i6=n(35895),i9=n(45077),i7=n(60417),oe=n(28009),ot=n(75595),on=n(1498),or=n(15146),oi=n(18836),oo=n(49344),oa=n(88032),ol=(0,n1.X)({buttons:[ea.l0.display.flex,ea.l0.rowWithGap(4),ea.l0.justify.end],input:[ea.l0.colWithGap(4),ea.l0.flex.grow(1)],gap:[ea.l0.colWithGap(16)],label:[ea.l0.color.foregroundDimmer,ea.l0.fontSize(12),ea.l0.height(24),ea.l0.justify.center],flexRow:[ea.l0.display.flex,ea.l0.rowWithGap(8),ea.l0.align.center]}),oc={fontFamily:"text-security-disc"},os=er.K.label;function ou(e){var t=(0,tG.Z)().secrets,n=(0,J.useId)(),r=(0,J.useId)(),i=(0,Z._)((0,J.useState)(""),2),o=i[0],a=i[1],l=(0,Z._)((0,J.useState)(e.initialValue),2),c=l[0],s=l[1],u=(0,Z._)((0,J.useState)(!1),2),d=u[0],f=u[1],h=(0,J.useRef)(null);return(0,J.useEffect)(function(){if(e.isOpen){var t;null===(t=h.current)||void 0===t||t.focus(),(0,e6.j)(e6.U3.PASTE_SCANNER_USED,{action:"modal_opened",provider:null==e?void 0:e.provider})}},[e.isOpen,null==e?void 0:e.provider]),(0,C.tZ)(oa.MT,{contain:!0,children:(0,C.tZ)(oo.u,{isOpen:e.isOpen,onRequestClose:e.onCancel,children:(0,C.BX)(er.G,{css:ol.gap,children:[(0,C.tZ)(n0.xv,{variant:"subheadBig",multiline:!1,children:"Add a key name for your secret value"}),(0,C.BX)(er.G,{css:ol.flexRow,children:[(0,C.BX)(er.G,{css:ol.input,children:[(0,C.tZ)(os,{css:ol.label,htmlFor:n,children:"Key"}),(0,C.tZ)(oi.II,{id:n,ref:h,value:o,onChange:function(e){return a(e.target.value)}})]}),(0,C.BX)(er.G,{css:ol.input,children:[(0,C.BX)(er.G,{css:ol.flexRow,children:[(0,C.tZ)(os,{css:ol.label,htmlFor:r,children:"Value"}),(0,C.tZ)(or.hU,{alt:"Toggle Secret",onClick:function(){return f(function(e){return!e})},tooltipPlacement:"top",children:d?(0,C.tZ)(M.Z,{}):(0,C.tZ)(O.Z,{})})]}),(0,C.tZ)(oi.II,{id:r,value:c,onChange:function(e){return s(e.target.value)},style:d?void 0:oc})]})]}),(0,C.BX)(er.G,{css:ol.buttons,children:[(0,C.tZ)(on.zx,{text:"Cancel",onClick:e.onCancel}),(0,C.tZ)(on.zx,{colorway:"primary",text:"Save Secret",disabled:0===o.length||0===c.length,onClick:(0,e_._)(function(){return(0,eT.Jh)(this,function(n){switch(n.label){case 0:return[4,t.writeSecret({key:o,value:c})];case 1:return n.sent(),e.onSaveSecret(o,c),(0,e6.j)(e6.U3.PASTE_SCANNER_USED,{action:"secret_created",provider:null==e?void 0:e.provider}),[2]}})})})]})]})})})}var od=n(97411),of=n(20573),oh=n(74652),op=(0,n1.X)({hint:[ea.l0.align.center,ea.l0.border({color:ea.TV.outlineDimmer,direction:"top"}),ea.l0.color.foregroundDimmest,ea.l0.display.flex,ea.l0.flex.row,ea.l0.px(8),ea.l0.py(4),ea.l0.rowWithGap(8)],info:[ea.l0.p(8)],key:[ea.l0.px(4)],wrapper:[ea.l0.backgroundColor.backgroundHigher,ea.l0.borderRadius(4),ea.l0.cursor.default,ea.l0.font.default],mobileButtons:[ea.l0.flex.grow(1)],mobileHint:[ea.l0.justify.center]}),om={borderTop:"1px solid ".concat(ea.TV.outlineDimmer),borderBottom:"1px solid ".concat(ea.TV.outlineDimmer),borderRadius:0};function ov(e){return(0,C.BX)(er.G,{css:op.wrapper,style:e.onMobile?om:void 0,children:[(0,C.BX)(er.G,{css:op.info,style:{textAlign:e.onMobile?"center":"inherit"},children:[(0,C.tZ)(er.G,{children:"The value you pasted looks like a secret."}),(0,C.tZ)(er.G,{children:e.supportsSecrets?"Store it securely using our Secrets feature.":"Anyone will be able to see this."})]}),e.onMobile?(0,C.tZ)(oy,(0,b._)({},e)):(0,C.tZ)(og,(0,b._)({},e))]})}function og(e){return(0,C.BX)(C.HY,{children:[e.supportsSecrets?(0,C.BX)(er.G,{css:op.hint,onClick:e.onClickUseSecrets,children:[(0,C.tZ)(od.Z,{}),"Press",(0,C.tZ)(er.G,{css:op.key,children:(0,C.tZ)(oh.bM,{keyCombo:"Tab",small:!0})}),"to use Secrets"]}):null,(0,C.BX)(er.G,{css:op.hint,onClick:e.onClickPasteAnyway,children:[(0,C.tZ)(of.Z,{}),"Press",(0,C.tZ)(er.G,{css:op.key,children:(0,C.tZ)(oh.bM,{keyCombo:"Enter",small:!0})}),"to paste anyway"]}),e.supportsSecrets?null:(0,C.BX)(er.G,{css:op.hint,onClick:e.onClickUndo,children:[(0,C.tZ)(of.Z,{}),"Press",(0,C.tZ)(er.G,{css:op.key,children:(0,C.tZ)(oh.bM,{keyCombo:"Escape",small:!0})}),"to undo"]})]})}function oy(e){return(0,C.BX)(er.G,{css:[op.hint,op.mobileHint],children:[e.supportsSecrets?(0,C.tZ)(on.zx,{css:op.mobileButtons,iconLeft:(0,C.tZ)(od.Z,{}),text:"Use Secrets",onClick:e.onClickUseSecrets,colorway:"primary"}):null,(0,C.tZ)(on.zx,{css:op.mobileButtons,iconLeft:(0,C.tZ)(of.Z,{}),text:"Paste Anyway",onClick:e.onClickPasteAnyway}),e.supportsSecrets?null:(0,C.tZ)(on.zx,{css:op.mobileButtons,iconLeft:(0,C.tZ)(od.Z,{}),text:"Undo",onClick:e.onClickUndo})]})}var ob=n(30249),ow=(0,n1.X)({border:[ea.l0.border({color:iv.TV.accentPrimaryDefault,direction:"y",width:1})],title:[ea.l0.display.flex,ea.l0.rowWithGap(8),ea.l0.align.center,ea.l0.justify.spaceBetween,ea.l0.px(8),ea.l0.pt(4),ea.l0.font.default],wrapper:[ea.l0.backgroundColor.backgroundRoot,ea.l0.py(0),ea.l0.position.relative,ea.l0.zIndex(200)]});function oZ(e){var t;return t=e.onClose,(0,J.useEffect)(function(){var e=function(e){"Escape"===e.key&&t(e)};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}},[t]),(0,C.tZ)(oa.MT,{autoFocus:!0,contain:!0,children:(0,C.tZ)(er.G,{css:ow.wrapper,children:(0,C.BX)(er.G,{css:ow.border,children:[(0,C.BX)(er.G,{css:ow.title,children:[(0,C.BX)(n0.xv,{multiline:!1,children:["Access the secret ",(0,C.tZ)("strong",{children:e.keyName}),":"]}),(0,C.tZ)(or.hU,{alt:"Close",onClick:e.onClose,children:(0,C.tZ)(r4.Z,{})})]}),(0,C.tZ)(ty.Tg,{background:"root",children:(0,C.tZ)(ob.Z,{keyName:e.keyName,filePath:e.filePath,onInsert:e.onInsert})})]})})})}var ox=i7.V.compute([i6.xg],function(e){var t=e.field(i6.xg).iter();if(null===t.value)return null;for(var n=[];null!==t.value;){var r=t.from,i=t.to,o=t.value;n.push({from:r,to:i,insert:o.result.secret}),t.next()}return n}),oC=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e,r){var i;return(0,eE._)(this,n),(i=t.call(this)).secret=e,i.as=r,i}var r=n.prototype;return r.toDOM=function(e){var t=this,n=(0,n$.V)((0,C.tZ)(ov,{supportsSecrets:e.state.facet(i6.$X),onMobile:"pocket"===this.as,onClickUseSecrets:function(){e.dispatch({effects:i6.Lo.of(t.secret)})},onClickPasteAnyway:function(){(0,i6.Pz)(e),e.focus()},onClickUndo:function(){e.dispatch({effects:i6.uh.of(t.secret.id)}),e.focus()}}));return"pocket"===this.as&&(n.style.zIndex="200",n.style.position="relative",this.adjustForGutter(n,e)),n},r.updateDOM=function(e,t){return this.adjustForGutter(e,t),!0},r.adjustForGutter=function(e,t){var n=t.dom.querySelector(".cm-gutters");e.style.marginLeft=n?"-".concat(n.clientWidth,"px"):"inherit"},n}(eR.l9),oS=ot.t.compute([i6.xv],function(e){var t=e.facet(eA.Yp),n=e.field(i6.xv);return n&&t?{key:"pasteScannerModal",node:function(e){var t;return(0,C.tZ)(ou,{isOpen:!0,initialValue:n.result.secret,provider:n.result.provider,onSaveSecret:(t=(0,e_._)(function(t){var r,i,o,a,l;return(0,eT.Jh)(this,function(c){for(r=e.state.field(i6.xg).iter(),i=[];r.value;)o=r.from,a=r.to,(l=r.value).id===n.id&&(i.push(i6.uh.of(l.id)),i.push(i6.Yt.of({secret:t,from:o,to:a}))),r.next();return e.dispatch({effects:(0,x._)(i).concat([i6.ZB.of(null)])}),[2]})}),function(e){return t.apply(this,arguments)}),onCancel:function(){return e.dispatch({effects:i6.ZB.of(null)})}})}}:null}),ok=eR.tk.decorations.compute([i6.Do],function(e){var t=e.field(i6.Do).iter(),n=t.from,r=t.to,i=t.value,o=e.facet(eA.Yp);return i&&o?eR.p.set(eR.p.widget({widget:new o_(i.key,o),side:1,block:!0}).range(n,r)):eR.p.none}),o_=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e,r){var i;return(0,eE._)(this,n),(i=t.call(this)).key=e,i.filePath=r,i}var r=n.prototype;return r.toDOM=function(e){var t=(0,n$.V)((0,C.tZ)(oZ,{keyName:this.key,filePath:this.filePath,onClose:function(){return e.dispatch({effects:i6.qs.of(null)})},onInsert:function(t){e.dispatch(e.state.changeByRange(function(e){return{range:ek.jT.cursor(e.from+t.length),changes:{from:e.from,to:e.to,insert:t}}})),e.focus(),(0,e6.j)(e6.U3.PASTE_SCANNER_USED,{action:"secret_key_inserted"})}}));return this.adjustForGutter(t,e),t},r.updateDOM=function(e,t){return this.adjustForGutter(e,t),!0},r.adjustForGutter=function(e,t){var n=t.dom.querySelector(".cm-gutters");e.style.marginLeft=n?"-".concat(n.clientWidth,"px"):"inherit"},n}(eR.l9),oE=[ox,(c=[i6.xv,i6.xg],s=function(e){return null!=e.field(i6.xv,!1)?null:e.field(i6.xg,!1)||null},[eR.hJ.compute(c,function(e){var t=s(e);if(!t||e.facet(oe.h))return null;for(var n=t.iter();n.value;){var r=function(){var e=new oC(n.value,"tooltip");return{v:{arrow:!0,pos:n.to,create:function(t){return{dom:e.toDOM(t)}}}}}();if("object"===(0,i9._)(r))return r.v}return null}),eR.tk.decorations.compute(c,function(e){var t=s(e);if(!t||!e.facet(oe.h))return eR.p.none;for(var n=t.iter();n.value;){var r=new oC(n.value,"pocket");return eR.p.set(eR.p.widget({widget:r,side:1,block:!0}).range(n.to,n.to))}return eR.p.none})]),oS,ok],oT=new tR.j(function(e){return[i6.$X.of(!e),i6.Do,i6.xg,i6.xv,oE,i6.Gv]});function oR(e,t){var n=performance.now();rr.kg.time(e,n-t)}var oI=new tR.j(function(e){var t=e?.01:.001;return ek.Wl.highest(eR.tk.domEventHandlers({keydown:function(e){if(Math.random()<t){var n=e.timeStamp;requestAnimationFrame(function(){oR("editor input latency",n),"undefined"!=typeof requestIdleCallback?requestIdleCallback(function(){oR("editor input latency after layout",n)}):setTimeout(function(){oR("editor input latency after layout",n)})})}}}))}),oD=n(20142),oG=n(9762),oB=function(e){var t=parseInt(e.substring(1),16);return[t>>16&255,t>>8&255,255&t]},oP=n(32508),oA=n.n(oP);function oN(e){var t=RegExp("".concat(e,"\\(-?\\b\\d+\\.?\\d*\\b\\s*(,\\s*-?\\b\\d+\\.?\\d*\\b)?"),"g"),n=new RegExp("".concat(e,"\\((?<x>-?\\b\\d+\\.?\\d*\\b)\\s*(,\\s*(?<y>-?\\b\\d+\\.?\\d*\\b))?"));return{regexp:t,cursor:"move",onDrag:function(t,r,i){var o,a,l=n.exec(t),c=Number(null==l?void 0:null===(o=l.groups)||void 0===o?void 0:o.x),s=Number(null==l?void 0:null===(a=l.groups)||void 0===a?void 0:a.y);isNaN(c)||(isNaN(s)&&(s=c),r("".concat(e,"(").concat(c+i.movementX,", ").concat(s+i.movementY)))}}}var oL=oN("vec2");function oU(e){var t=RegExp("".concat(e,"\\(.*\\)"),"g"),n=new RegExp("".concat(e,"\\((?<r>\\d+)\\s*,\\s*(?<g>\\d+)\\s*,\\s*(?<b>\\d+)\\)"));return{regexp:t,cursor:"pointer",onClick:function(t,r){var i,o,a,l=n.exec(t),c=Number(null==l?void 0:null===(i=l.groups)||void 0===i?void 0:i.r),s=Number(null==l?void 0:null===(o=l.groups)||void 0===o?void 0:o.g),u=Number(null==l?void 0:null===(a=l.groups)||void 0===a?void 0:a.b),d=document.createElement("input");d.type="color",isNaN(c+s+u)||(d.value="#"+c.toString(16)+s.toString(16)+u.toString(16)),d.addEventListener("input",function(t){var n=t.target;if(n.value){var i=(0,Z._)(oB(n.value),3),o=i[0],a=i[1],l=i[2];r("".concat(e,"(").concat(o,", ").concat(a,", ").concat(l,")"))}}),d.click()}}}oN("ellipse"),oN("circle"),oN("point"),oN("rect"),oN("square"),oN("vertex");var oO=oU("rgb");oU("background"),oU("fill"),oU("stroke");var oM={regexp:/https?:\/\/[^\s)"']+/g,cursor:"pointer",onClick:function(e){oA()(e)&&window.open(e,"_blank")}},oX=[{regexp:/-?\b\d+\.?\d*\b/g,cursor:"ew-resize",onDrag:function(e,t,n){var r=Number(e)+n.movementX;isNaN(r)||t(r.toString())}},{regexp:/true|false/g,cursor:"pointer",onClick:function(e,t){switch(e){case"true":return t("false");case"false":return t("true")}}},oL,oO,oM],oF=[oM],oW=new tR.j(function(e,t){return t?null:(0,oG.ZP)({key:"mod",rules:e?oX:oF})}),oH=n(30826),oV=n.n(oH),oz=new Set,oj=oV()(function(){var e=!0,t=!1,n=void 0;try{for(var r,i=oz[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;(0,e6.j)(e6.U3.WS_TYPED,{fileExt:o})}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}oz.clear()},18e4),oq=eR.tk.updateListener.of(function(e){if(e.docChanged){var t=e.state.facet(eA.Yp);if(t){var n=(0,K.r6)(t)||(0,K.UO)(t);!e.transactions.some(function(e){return e.annotation(ek.YW.remote)})&&(oz.has(n)||(oz.add(n),oj()))}}}),oY=n(81013),oJ=eR.tk.theme({".cm-ruler-element":{backgroundColor:ea.TV.backgroundHigher}}),oK=ek.QQ.define({create:function(e){return 0===e.doc.length},update:function(e,t){return t.docChanged?0===t.state.doc.length:e}}),o$=(0,eR.EY)({above:!1,class:"cm-ruler-layer",update:function(e){return(0,eL.a)(e,oQ,oK,iC.R)},markers:function(e){if(e.state.field(oK,!1))return[];var t=e.state.facet(oQ);if(0===t.length)return[];var n=[],r=e.dom.getBoundingClientRect(),i=e.contentDOM.getBoundingClientRect().left-r.left,o=r.width-2,a=Math.max(r.height,e.contentHeight),l=!0,c=!1,s=void 0;try{for(var u,d=t[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value,h=i+e.defaultCharacterWidth*f;h<o&&n.push(new eR.dc("cm-ruler-element",h,0,2,a))}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}return n}}),oQ=ek.r$.define({enables:[oK,o$,oJ]}),o0=new tR.j(function(e){return e.map(function(e){return oQ.of(e)})}),o1=n(5786),o2=n(7444),o8=n(26508),o4=n(95571),o3=n(50626),o5=n(6303),o6=n(94655),o9=n(68681);function o7(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;if(!e.valid)return[];for(var r=[],i=e.getCursor(t),o=i.next();!o.done&&r.length<n;)r.push(o.value),o=i.next();return r}var ae=n(32893);function at(e){return e>420?"large":"small"}var an=er.K.div,ar=(0,n1.X)({root:[ea.l0.rowWithGap(4),ea.l0.px(4),ea.l0.py(6),{borderBottom:"1px solid",borderColor:ea.TV.outlineDimmest}],panelButtonWrapper:[ea.l0.center,ea.l0.height(32)],content:[ea.l0.display.grid,ea.l0.flex.growAndShrink(1),{gridTemplateAreas:'"search search-controls"',gridTemplateRows:"1fr",gridTemplateColumns:"1fr max-content",gap:ea.TV.space8}],contentExpanded:[{gridTemplateAreas:'"search search-controls" "replace replace-controls"',gridTemplateRows:"1fr 1fr",gridTemplateColumns:"1fr max-content"}],contentExpandedSmall:[{gridTemplateAreas:'"search" "search-controls" "replace" "replace-controls"',gridTemplateRows:"1fr max-content 1fr max-content",gridTemplateColumns:"1fr"}],contentSmall:[{gridTemplateAreas:'"search" "search-controls"',gridTemplateRows:"1fr max-content",gridTemplateColumns:"1fr"}],matchLabel:[ea.l0.position.absolute,ea.l0.top(0),ea.l0.right(0),ea.l0.height("100%"),ea.l0.center,ea.l0.pr(4)],inputControlsSmall:[ea.l0.colWithGap(8),ea.l0.flex.growAndShrink(1)],searchInputWrapper:[ea.l0.position.relative,{gridArea:"search"}],searchControls:[ea.l0.display.flex,ea.l0.align.center,ea.l0.rowWithGap(8),ea.l0.flex.wrap,{gridArea:"search-controls"}],replaceInputWrapper:[{gridArea:"replace"}],replaceControls:[ea.l0.display.flex,ea.l0.align.center,ea.l0.rowWithGap(8),ea.l0.flex.wrap,{gridArea:"replace-controls"}],searchSettings:ea.l0.flex.row,jumpIconButton:[ea.l0.height(32),ea.l0.width(32)]}),ai=new n$.J(J.forwardRef(function(e,t){var n=e.view,r=e.query,i=e.updateQuery,o=(0,Z._)((0,J.useState)(!1),2),a=o[0],l=o[1],c=(0,Z._)((0,J.useState)([]),2),s=c[0],u=c[1],d=(0,Z._)((0,J.useState)(null),2),f=d[0],h=d[1],p=s.length,m=(0,o2.Z)(r),v=(0,o2.Z)(s);function g(){(0,o1.g)(n);var e=n.state.selection.main;n.dispatch({effects:eR.tk.scrollIntoView(e.from,{y:"center",x:"center"})}),p<=1||h(function(t){if(null===t){var n=s.findIndex(function(t){return t.from===e.from&&t.to===e.to});return -1===n?1:n+1}return t>=p?1:t+1})}function y(){(0,o1.a7)(n);var e=n.state.selection.main;n.dispatch({effects:eR.tk.scrollIntoView(e.from,{y:"center",x:"center"})}),p<=1||h(function(t){if(null===t){var n=s.findIndex(function(t){return t.from===e.from&&t.to===e.to});return -1===n?1:n+1}return t<=1?p||1:t-1})}(0,J.useImperativeHandle)(t,function(){return{onSelectionSet:function(){var e=n.state.selection.main,t=v.current.findIndex(function(t){return t.from<=e.anchor&&t.to>=e.anchor});h(-1!==t?t+1:null)},onDocChanged:function(){u(o7(m.current,n.state.doc)),h(null)},onExpandRequested:function(){l(!0)}}},[n,m,v]),(0,J.useEffect)(function(){var e=o7(r,n.state.doc);u(e);var t=n.state.selection.main,i=e.findIndex(function(e){return e.from<=t.anchor&&e.to>=t.anchor});h(-1!==i?i+1:null)},[n,r]);var b=(0,Z._)((0,J.useState)(at(0)),2),w=b[0],x=b[1],S=(0,o8.Z)(function(e){e.width&&x(at(e.width))});function k(e){return(0,eR.$1)(n,e,"search-panel")}var _=p>0,E=r.search.length>0?"0 / 0":null,T=_?"".concat(f||1," / ").concat(p):E,R=T?8*T.length:null,I=(0,C.BX)(er.G,{css:ar.searchSettings,children:[(0,C.tZ)(o9.Z,{alt:"case sensitive",icon:(0,C.tZ)(o3.Z,{}),checked:r.caseSensitive,onClick:function(){i({caseSensitive:!r.caseSensitive})}}),(0,C.tZ)(o9.Z,{alt:"regular expressions",icon:(0,C.tZ)(o5.Z,{}),checked:r.regexp,onClick:function(){i({regexp:!r.regexp})}}),(0,C.tZ)(o9.Z,{alt:"whole words",icon:(0,C.tZ)(ae.Z,{}),checked:r.wholeWord,onClick:function(){i({wholeWord:!r.wholeWord})}})]}),D=[ar.content];return"small"!==w&&a?D.push(ar.contentExpanded):"small"===w&&a?D.push(ar.contentExpandedSmall):"small"!==w||a||D.push(ar.contentSmall),(0,C.tZ)(an,{ref:S,onKeyDown:function(e){k(e)&&e.preventDefault()},children:(0,C.BX)(ty.Tg,{elevated:!0,css:ar.root,children:[(0,C.tZ)(er.G,{css:ar.panelButtonWrapper,children:(0,C.tZ)(or.hU,{alt:a?"Close replace panel":"Show replace panel",css:ar.jumpIconButton,onClick:function(){l(function(e){return!e})},children:(0,C.tZ)(U.Z,{rotate:a?90:0,style:{transition:"200ms ease"}})})}),(0,C.BX)(er.G,{css:D,children:[(0,C.BX)(er.G,{css:ar.searchInputWrapper,children:[(0,C.tZ)(o6.h,{style:{padding:4,paddingRight:null!=R?R:void 0},placeholder:"Search",value:r.search,name:"search","main-field":"true",onKeyDown:function(e){if((0,o4.jh)(e)&&"f"===e.key){e.currentTarget.select();return}if(!("enter"!==e.key.toLowerCase()||k(e))){if(e.preventDefault(),e.shiftKey){y();return}g()}},onChange:function(e){i({search:e})}}),T?(0,C.tZ)(er.G,{css:ar.matchLabel,children:(0,C.tZ)(n0.xv,{variant:"small",color:"dimmest",multiline:!1,children:T})}):null]}),(0,C.BX)(er.G,{css:ar.searchControls,children:[(0,C.BX)(er.G,{css:ea.l0.flex.row,children:[(0,C.tZ)(or.hU,{css:ar.jumpIconButton,alt:"Previous",onClick:function(){y()},children:(0,C.tZ)(U.Z,{rotate:-90})}),(0,C.tZ)(or.hU,{css:ar.jumpIconButton,alt:"Next",onClick:function(){g()},children:(0,C.tZ)(U.Z,{rotate:90})})]}),(0,C.tZ)(on.zx,{text:"Select all",onClick:function(){(0,o1.i3)(n),n.focus()}}),I]}),a?(0,C.BX)(C.HY,{children:[(0,C.tZ)(er.G,{css:ar.replaceInputWrapper,children:(0,C.tZ)(oi.II,{style:{padding:4},placeholder:"Replacement",name:"replace",value:r.replace,onKeyDown:function(e){"enter"!==e.key.toLowerCase()||k(e)||(e.preventDefault(),(0,o1.K9)(n))},onChange:function(e){i({replace:e.target.value})}})}),(0,C.BX)(er.G,{css:ar.replaceControls,children:[(0,C.tZ)(on.zx,{text:"Replace",onClick:function(){(0,o1.K9)(n)}}),(0,C.tZ)(on.zx,{text:"Replace all",onClick:function(){(0,o1.ko)(n)}})]})]}):null]}),(0,C.tZ)(er.G,{css:ar.panelButtonWrapper,children:(0,C.tZ)(or.hU,{alt:"Close Search Panel",tooltipHidden:!0,onClick:function(){(0,o1.N$)(n)},children:(0,C.tZ)(r4.Z,{})})})]})})})),ao=ek.Py.define(),aa=[(0,o1.yC)({createPanel:function(e){var t=!1,n=!1,r=!1,i=!1,o=!1,a=function(t){var n,r,i,o,a,l,c=(0,o1.uP)(e.state),s=new o1.Jb({search:null!==(n=t.search)&&void 0!==n?n:c.search,caseSensitive:null!==(r=t.caseSensitive)&&void 0!==r?r:c.caseSensitive,literal:null!==(i=t.literal)&&void 0!==i?i:c.literal,regexp:null!==(o=t.regexp)&&void 0!==o?o:c.regexp,replace:null!==(a=t.replace)&&void 0!==a?a:c.replace,wholeWord:null!==(l=t.wholeWord)&&void 0!==l?l:c.wholeWord});s.eq(c)||e.dispatch({effects:o1.ql.of(s)})},l=ai.create({view:e,query:(0,o1.uP)(e.state),updateQuery:a});return{dom:l,top:!0,update:function(t){(0,eL.a)(t,o1.ql)&&ai.set(l,{view:e,query:(0,o1.uP)(t.state),updateQuery:a}),t.selectionSet&&!i&&(i=!0,requestAnimationFrame(function(){if(!n){var e;i=!1,null===(e=ai.ref(l))||void 0===e||e.onSelectionSet()}})),t.docChanged&&!r&&(r=!0,requestAnimationFrame(function(){if(!n){var e;r=!1,null===(e=ai.ref(l))||void 0===e||e.onDocChanged()}})),(0,eL.a)(t,ao)&&!o&&(o=!0,requestAnimationFrame(function(){if(!n){var e;o=!1,null===(e=ai.ref(l))||void 0===e||e.onExpandRequested()}}))},mount:function(){t||(t=!0,requestAnimationFrame(function(){if(!n){t=!1;var e=l.querySelector("[main-field]");e&&(e.focus(),e.select())}}))},destroy:function(){return n=!0}}}}),eR.$f.of([{win:"Ctrl-h",linux:"Ctrl-h",preventDefault:!0,run:function(e){return!!((0,o1.Ep)(e.state)||(0,o1.nx)(e))&&(e.dispatch({effects:ao.of(null)}),!0)}}])],al=n(50782),ac=n(11570),as=null!==(g=globalThis.requestIdleCallback)&&void 0!==g?g:globalThis.requestAnimationFrame;function au(e,t,n){var r=e.field(t,!1);if(void 0===r){if(void 0===n)throw Error("Field is not mounted on state");return n}return t.spec.toJSON(r,e)}function ad(e){for(var t=e.sliceString(0,200)+e.length,n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r)|0;return(n>>>0).toString(36)}var af=function(){"use strict";function e(t,n,r,i){var o=this;(0,eE._)(this,e),this.view=t,this.replId=n,this.cache=r,this.compartment=i,this.historyIsMounted=!1,this.destroyed=!1,this.pending=!1,this.scheduleCacheUpdate=this.scheduleCacheUpdate.bind(this),this.view.scrollDOM.addEventListener("scroll",this.scheduleCacheUpdate),this.view.state.field(i8,!1)||Promise.resolve().then(function(){o.destroyed||o.apply()})}var t=e.prototype;return t.apply=function(){if(!this.historyIsMounted&&this.view.state.field(ee.cE,!1)){(0,eR.OO)(this.view.state,Error("History was preconfigured on this view, if you want to use state cache, please make sure history is not already configured for this view"));return}if(!this.key||this.view.state.field(i8,!1)){if(this.historyIsMounted){var e,t,n=this.key?iw.o.of(!0):[];this.view.dispatch({effects:this.compartment.reconfigure(n)}),this.historyIsMounted=!1}return}var r=this.cache.get(this.key);if(!r||r.hash!==ad(this.view.state.doc)){this.view.dispatch({effects:this.compartment.reconfigure((0,ee.m8)())}),this.historyIsMounted=!0;return}var i=ek.jT.fromJSON(r.selection),o=[(e=r.scroll,(t=eR.tk.scrollIntoView(e.pos,{y:"start",x:"start",yMargin:e.yDiff,xMargin:e.scrollLeft})).value.isSnapshot=!0,t),this.compartment.reconfigure([ee.cE.init(function(e){var t,n;return t=ee.cE,n=r.history,t.spec.fromJSON(n,e)}),(0,ee.m8)()])];if(this.view.state.field(S.iQ,!1))for(var a=0;a<r.folds.length;a+=2){var l=r.folds[a],c=r.folds[a+1];o.push(S.SW.of({from:l,to:c}))}this.view.dispatch({selection:i,effects:o}),this.historyIsMounted=!0},t.scheduleCacheUpdate=function(){var e=this;this.pending||(this.pending=!0,as(function(){e.pending&&!e.destroyed&&(e.pending=!1,e.historyIsMounted&&e.key&&e.cache.set(e.key,{hash:ad(e.view.state.doc),scroll:function(e){var t=e.scrollDOM.scrollTop,n=e.scrollDOM.scrollLeft;if(0===t&&0===n)return{pos:0,yDiff:0,scrollLeft:0};var r=e.lineBlockAtHeight(t+8),i=r.from>=e.viewport.from||e.viewportLineBlocks[0].top-t>200?r:e.viewportLineBlocks[0];return{pos:i.from,yDiff:i.top-t,scrollLeft:n}}(e.view),selection:e.view.state.selection.toJSON(),history:au(e.view.state,ee.cE),folds:au(e.view.state,S.iQ,[])}))}))},t.postUpdate=function(e){if((0,eL.a)(e,eA.Yp,i8)){this.apply();return}!this.pending&&this.historyIsMounted&&(0,eL.a)(e,"doc","selection",ee.cE,S.iQ)&&this.scheduleCacheUpdate()},t.destroy=function(){this.destroyed=!0,this.view.scrollDOM.removeEventListener("scroll",this.scheduleCacheUpdate)},(0,rp._)(e,[{key:"key",get:function(){var e=this.view.state.facet(eA.Yp);return e?"".concat(this.replId,":").concat(e):null}}]),e}(),ah=new tR.j(function(e,t){var n=new ek.F6,r=eR.lg.define(function(r){return new af(r,e,t,n)},{provide:function(e){return eR.tk.updateListener.of(function(t){var n;null===(n=t.view.plugin(e))||void 0===n||n.postUpdate(t)})}});return[n.of(iw.o.of(!0)),r]}),ap=eR.tk.theme({"&":{contain:"size"},"& > .cm-scroller":{contain:"strict"}}),am=n(8482),av=n(17491);function ag(e,t,n,r){var i=(0,tq.Z)().showError,o=(0,al.Z)(),a=(0,av.eR)({variables:{replId:o,path:e},onError:function(e){i(e.message)},skip:!r||t});return(0,J.useMemo)(function(){var r;return t||a.loading||a.error||!a.data||(null===(r=a.data.threadsByFile)||void 0===r?void 0:r.__typename)!=="ThreadsByFileResult"?{}:a.data.threadsByFile.threads.filter(function(t){return t.path===e&&(!n||!t.isResolved)}).reduce(function(e,t){return(0,w._)((0,b._)({},e),(0,nd._)({},t.id,t))},{})},[a.loading,a.data,a.error,e,t,n])}var ay=n(23291),ab=n(66610),aw=n(96179),aZ=n(77615),ax=n(41831),aC=n(32377),aS=n(39511),ak=function(e){var t=e.caretSize,n=void 0===t?[8,12]:t,r=(0,rh._)(e,["caretSize"]);return(0,C.BX)("svg",(0,w._)((0,b._)({width:n[0],height:n[1],viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r),{children:[(0,C.tZ)("mask",{id:"outline",fill:"white",children:(0,C.tZ)("path",{d:"M0 8L5.2 1.06667C5.6 0.533333 6.40033 0.533776 6.80033 1.06711C8.67223 3.56297 9.93719 5.24959 12 8H0Z"})}),(0,C.tZ)("path",{d:"M0 8L5.2 1.06667C5.6 0.533333 6.40033 0.533776 6.80033 1.06711C8.67223 3.56297 9.93719 5.24959 12 8H0Z",fill:"url(#gradient-fill)"}),(0,C.tZ)("path",{d:"M0 8L-0.8 7.4L-2 9H0V8ZM12 8V9H14L12.8 7.4L12 8ZM5.2 1.06667L4.4 0.466667L5.2 1.06667ZM6.80033 1.06711L6.00033 1.66711L6.80033 1.06711ZM12 7H0V9H12V7ZM0.8 8.6L6 1.66667L4.4 0.466667L-0.8 7.4L0.8 8.6ZM6.00033 1.66711C7.87223 4.16297 9.13719 5.84959 11.2 8.6L12.8 7.4C10.7372 4.64959 9.47223 2.96297 7.60033 0.467109L6.00033 1.66711ZM6 1.66667L6.00033 1.66711L7.60033 0.467109C6.80082 -0.598902 5.20049 -0.600655 4.4 0.466667L6 1.66667Z",fill:"#0079F2",mask:"url(#outline)"}),(0,C.tZ)("defs",{children:(0,C.BX)("linearGradient",{id:"gradient-fill",x1:"5.07692",y1:"0",x2:"5.07692",y2:"21.3333",gradientUnits:"userSpaceOnUse",children:[(0,C.tZ)("stop",{stopColor:"#57ABFF"}),(0,C.tZ)("stop",{offset:"1",stopColor:"#0079F2"})]})})]}))},a_=n(24837),aE=n(39327),aT=n(59725),aR=n(30456),aI=n(46056),aD=n(43704),aG=n(15542),aB=n(12435),aP=n(11516),aA=n(93049),aN=n(87599),aL=n(82104),aU=n(35972),aO=n(21371),aM=n(67795),aX=n(50220),aF=function(e){var t,n,r=e.isCreating,i=e.threadId,o=e.filePath,a=e.isResolved,l=e.isLoading,c=e.isPlaceholder,s=e.caretPosition,u=e.onRequestClose,d=e.onResolveThread,f=e.openThreadsInbox,h={viewAll:"Inbox",next:"Next thread",previous:"Previous thread",dismiss:"Collapse"},p=ag(null===o?"":o,l,!0,!0),m=(0,B.Gn)("fontSize").preferences.fontSize,v=[12,8];switch(m){case 10:v=[8,6];break;case 14:v=[10,6];break;case 18:v=[12,8];break;case 24:v=[14,10]}var g=(0,J.useMemo)(function(){return Object.values(p).sort(function(e,t){return e.indexStart-t.indexStart})},[p]),y=(0,J.useMemo)(function(){return g.findIndex(function(e){return e.id===i})},[g,i]),b=(0,aE.a9)(),w=(t=(0,e_._)(function(){return(0,eT.Jh)(this,function(e){return b(y===g.length-1?g[0].id:g[y+1].id),[2]})}),function(){return t.apply(this,arguments)}),Z=(n=(0,e_._)(function(){return(0,eT.Jh)(this,function(e){return b(0===y?g[g.length-1].id:g[y-1].id),[2]})}),function(){return n.apply(this,arguments)});return(0,C.BX)(ty.Tg,{background:"root",css:[ea.l0.flex.row,ea.l0.align.center,ea.l0.justify.spaceBetween,ea.l0.position.relative,ea.l0.px(12),ea.l0.py(8),{borderBottomWidth:ea.TV.borderWidthDefault,borderBottomStyle:"solid",borderBottomColor:ea.TV.outlineDimmest}],children:[null!==s&&(0,C.tZ)("span",{css:[ea.l0.position.absolute,ea.l0.top(-v[1]),ea.l0.left(s),ea.l0.height("fit-content"),ea.l0.display.flex,ea.l0.flex.row,ea.l0.align.center],children:(0,C.tZ)(ak,{caretSize:v})}),(0,C.tZ)(on.zx,{iconLeft:(0,C.tZ)(aL.Z,{}),onClick:function(){f()},text:h.viewAll,size:"small"}),g.length>1?(0,C.BX)(er.G,{css:[ea.l0.flex.row,ea.l0.align.center,ea.l0.rowWithGap(4)],children:[(0,C.tZ)(or.hU,{alt:h.previous,onClick:Z,children:(0,C.tZ)(ax.Z,{})}),(0,C.BX)(n0.xv,{color:"dimmest",variant:"small",multiline:!1,children:[y+1,"/",g.length]}),(0,C.tZ)(or.hU,{alt:h.next,onClick:w,children:(0,C.tZ)(aZ.Z,{})})]}):null,(0,C.BX)(er.G,{css:[ea.l0.flex.row,ea.l0.align.center,ea.l0.rowWithGap(4)],children:[r||a||c?null:(0,C.tZ)(on.zx,{onClick:void 0===d?function(){}:d,text:"Resolve",size:"small",iconLeft:(0,C.tZ)(aC.Z,{})}),!r&&a?(0,C.tZ)(ay.D,{text:"Resolved",colorway:"positive"}):null,(0,C.tZ)(on.zx,{onClick:void 0===u?function(){}:u,text:h.dismiss,size:"small",iconLeft:(0,C.tZ)(aN.Z,{})})]})]})},aW=function(e){var t,n,r=e.threadId,i=e.isResolved,o=e.onMessageChange,a=e.onMessageSubmit,l=e.isPlaceholder,c=e.onRequestClose,s=void 0===c?function(){}:c,u=(0,Z._)((0,J.useState)(""),2),d=u[0],f=u[1],h=(0,Z._)((0,J.useState)(is().v4()),2),p=h[0],m=h[1],v=(0,aD.Z)(),g=v.ref,y=v.update,x=(0,J.useRef)(null),S={input:{placeholder:function(){return l?"Start a new thread (Markdown is supported)":i?"Reply to re-open thread":"Reply (Markdown is supported)"}},submit:"Post reply",cancel:"Cancel"},k=function(){var e=d.trim();0!==e.length&&(a({message:e,messageId:p}),f(""),m(is().v4()))},_=(0,aG.d)(),E=(0,aR.Z)(),T=(0,Z._)((0,aB.Z)({"@":(t=(0,e_._)(function(e){var t,n;return(0,eT.Jh)(this,function(r){return t=E.filter(function(e){return e.id!==_}),e&&(n=e.toLowerCase(),t=t.filter(function(e){return e.username.toLowerCase().startsWith(n)})),[2,t.slice(0,5).map(function(e){return{icon:(0,C.tZ)(aI.Z,{username:e.username,fullName:e.fullName,url:e.image,style:{height:"24px",width:"24px",minWidth:"24px",minHeight:"24px"}}),value:e.username}})]})}),function(e){return t.apply(this,arguments)})}),2),R=T[0].suggestions,I=T[1],D=(0,aO.Kb)({items:(null==R?void 0:R.results)||[],defaultHighlightedIndex:0,isOpen:(null!==(n=null==R?void 0:R.results.length)&&void 0!==n?n:0)>0,onSelectedItemChange:function(e){var t=e.selectedItem;if(R&&t){var n=R.applySuggestion({targetValue:d,suggestionValue:t.value}),r=n.fullValue,i=n.cursorIndex;f(r),setTimeout(function(){x.current&&(x.current.setSelectionRange(i,i),x.current.focus(),y())})}}}),G=D.isOpen,B=D.getInputProps,P=D.getMenuProps,A=D.getItemProps,N=D.highlightedIndex,L=D.getComboboxProps;return(0,J.useEffect)(function(){var e="threads/drafts/".concat(r),t=aP.Z.get(e,"string");t&&f(t);var n=x.current;return function(){if(n){var t=n.value;if(0===t.length){aP.Z.remove(e);return}aP.Z.set(e,t)}}},[r]),(0,C.BX)(ty.Tg,{background:"root",css:[ea.l0.px(12),ea.l0.pb(8),ea.l0.pt(8),{borderTop:"1px solid ".concat(ea.TV.outlineDimmest)}],className:"inline-thread-input",children:[(0,C.BX)("div",(0,w._)((0,b._)({css:[ea.l0.flex.row,ea.l0.align.start,ea.l0.rowWithGap(8),ea.l0.width("full")]},L()),{className:"jsx-45ff32690e481e34",children:[l?(0,C.tZ)(on.zx,{text:S.cancel,onClick:s}):null,(0,C.BX)("div",{css:[{width:"100%"}],className:"jsx-45ff32690e481e34",children:[(0,C.tZ)(oi.B,(0,b._)({},B({ref:function(e){x.current=e,g(e),I(e)},value:d,onChange:function(e){var t=e.target.value;f(t),o({message:t,messageId:p})},onKeyDown:function(e){!G&&(e.preventDownshiftDefault=!0,"Enter"!==e.key||e.shiftKey||(e.stopPropagation(),e.preventDefault(),k(),requestAnimationFrame(function(){y()})))},onKeyUp:function(e){"Escape"===e.key&&(e.stopPropagation(),e.preventDefault(),s())},placeholder:S.input.placeholder(),css:[ea.l0.height(32),ea.l0.align.start,{resize:"vertical",width:"100%",flexGrow:1,caretColor:"auto"}],autoFocus:!0}))),(0,C.tZ)("div",{css:{position:"relative"},className:"jsx-45ff32690e481e34",children:(0,C.tZ)("div",(0,w._)((0,b._)({},P({css:[{position:"absolute",top:ea.TV.space2,overflow:"hidden"},ea.l0.borderRadius(16),ea.l0.shadow(1),ea.l0.backgroundColor.backgroundDefault]})),{className:"jsx-45ff32690e481e34",children:null==R?void 0:R.results.map(function(e,t){return(0,e7.az)("div",(0,w._)((0,b._)({},A({item:e,index:t})),{key:e.value,className:"jsx-45ff32690e481e34"}),(0,C.BX)(aU.Ug,{spacing:2,css:[N===t?ea.l0.backgroundColor.backgroundHighest:null,ea.l0.p(8)],children:[e.icon,(0,C.tZ)("div",{className:"jsx-45ff32690e481e34",children:e.value})]}))})}))})]}),(0,C.tZ)(er.G,{css:[ea.l0.pt(4)],children:(0,C.tZ)(or.hU,{alt:S.submit,tooltipDelay:"long",onClick:k,children:(0,C.tZ)(aS.Z,{})})})]})),(0,C.tZ)(Q(),{id:"45ff32690e481e34",children:".inline-thread-input .popover-control-container{-webkit-box-flex:1;-webkit-flex-grow:1;-moz-box-flex:1;-ms-flex-positive:1;flex-grow:1}"})]})},aH=function(e){var t,n,r=e.threadId,i=e.isCreating,o=e.isResolved,a=void 0!==o&&o,l=e.view,c=e.filePath,s=e.openThreadsInbox,u=(0,ab.Z)(r,l,c),d=u.thread,f=u.loading,h=u.isPlaceholder,p=u.getLatestAnchor,m=u.updateThread,v=u.changeThreadMessage,g=u.finalizeThreadMessage,y=function(){null==l||l.dispatch({effects:[aX.YM.of(null)]})},b=(0,B.Gn)("fontSize").preferences.fontSize,w=(0,J.useRef)(null);(0,aT.Z)(d);var Z=p(),S=l&&!f&&"number"==typeof(null==Z?void 0:Z.indexEnd)&&Z.indexEnd<=l.state.doc.length?null===(n=l.coordsAtPos(Z.indexEnd))||void 0===n?void 0:n.left:null,k=(null==l?void 0:l.dom.getBoundingClientRect().left)||null,_=b;switch(b){case 10:_=13;break;case 14:_=19;break;case 18:_=25;break;case 24:_=34}var E=(0,tq.Z)().showConfirm,T=(0,al.Z)(),R=(0,J.useRef)(null),I=function(){R.current&&(R.current.scrollTop=R.current.scrollHeight)};(0,J.useEffect)(function(){setTimeout(function(){I()},0)},[null==d?void 0:d.messages]);var D=(0,J.useMemo)(function(){return(null==d?void 0:d.messages)?(0,x._)(d.messages).sort(function(e,t){return Date.parse(e.timeCreated)-Date.parse(t.timeCreated)}):[]},[null==d?void 0:d.messages]),G=(t=(0,J.useRef)(0),(0,o8.Z)(function(e){var n=e.height;n!==t.current&&(null==l||l.requestMeasure()),t.current=n}));return(0,C.tZ)("div",{css:[ea.l0.width("100%"),ea.l0.backgroundColor.backgroundRoot],children:(0,C.BX)(er.G,{innerRef:(0,aA.l)(w,G),css:[ea.l0.font.default,{borderTopWidth:ea.TV.borderWidthDefault,borderBottomWidth:ea.TV.borderWidthDefault,borderStyle:"solid",borderColor:ea.TV.accentPrimaryDefault}],children:[h||f?null:(0,C.tZ)(aF,{isCreating:i,isResolved:a,isLoading:f,threadId:r,filePath:c,caretPosition:S&&k?S-k-6:null,isPlaceholder:h,onRequestClose:y,onResolveThread:function(){m({changes:{isResolved:!0}}),E("Thread resolved. You can reopen it from the inbox.")},openThreadsInbox:s}),f&&!h?(0,C.tZ)(er.G,{css:[ea.l0.height(_)],children:(0,C.tZ)(aw.Z,{viewBox:"0 0 400 21",backgroundColor:ea.TV.accentPrimaryDimmest,backgroundOpacity:0,foregroundColor:ea.TV.accentPrimaryDimmest,foregroundOpacity:.2,speed:1,children:(0,C.tZ)("rect",{x:"0",y:"0",width:"100%",height:"100%"})})}):(0,C.BX)(C.HY,{children:[!i&&D.length>0?(0,C.tZ)("div",{css:[ea.l0.px(12),ea.l0.py(12),ea.l0.maxHeight(300),ea.l0.overflowY("auto"),ea.l0.colWithGap(16),ea.l0.fontSize(b)],ref:R,children:D.map(function(e){return(0,C.tZ)(a_.Z,{thread:d,message:e},e.id)})}):null,(0,C.tZ)(aW,{threadId:r,isPlaceholder:h,isResolved:a,onRequestClose:y,onMessageChange:v,onMessageSubmit:function(e){g(e),(0,e6.j)(aM.U3.MESSAGE_SENT,{replId:T,source:"threads",newThread:h})}})]})]})})},aV=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(){return(0,eE._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.compare=function(e){return this==e||this.constructor==e.constructor&&this.eq(e)},r.eq=function(e){return!1},r.destroy=function(e){},n}(ek.uU);aV.prototype.elementClass="",aV.prototype.toDOM=void 0,aV.prototype.mapMode=ek.gc.TrackBefore,aV.prototype.startSide=aV.prototype.endSide=-1,aV.prototype.point=!0;var az=ek.r$.define(),aj=ek.r$.define(),aq=ek.r$.define({combine:function(e){return e.some(function(e){return e})}}),aY=eR.lg.fromClass(function(){"use strict";function e(t){(0,eE._)(this,e),this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-right-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.width="0px",this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(aj).map(function(e){return new aQ(t,e)});var n=!0,r=!1,i=void 0;try{for(var o,a=this.gutters[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value;this.dom.appendChild(l.dom)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this.fixed=!t.state.facet(aq),this.fixed&&(this.dom.style.position="sticky",this.dom.style.right="0"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM.nextSibling)}var t=e.prototype;return t.update=function(e){if(e.viewportChanged){var t=this.view.contentDOM.nextElementSibling;t&&t!==this.dom&&t.classList.contains("cm-minimap-gutter")&&e.view.scrollDOM.insertBefore(this.dom,e.view.contentDOM.nextSibling)}if(this.updateGutters(e)){var n=this.prevViewport,r=e.view.viewport,i=Math.min(n.to,r.to)-Math.max(n.from,r.from);this.syncGutters(i<(r.to-r.from)*.8)}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(aq)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport},t.syncGutters=function(e){var t=this,n=this.dom.nextSibling;e&&this.dom.remove();var r=ek.Xs.iter(this.view.state.facet(az),this.view.viewport.from),i=[],o=this.gutters.map(function(e){return new a$(e,t.view.viewport,-t.view.documentPadding.top)}),a=!0,l=!1,c=void 0;try{for(var s,u=this.view.viewportLineBlocks[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value,f=void 0;if(Array.isArray(d.type)){var h=!0,p=!1,m=void 0;try{for(var v,g=d.type[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value;if(y.type==eR.kH.Text){f=y;break}}}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}}else f=d.type==eR.kH.Text?d:void 0;if(f){i.length&&(i=[]),aK(r,i,d.from);var b=!0,w=!1,Z=void 0;try{for(var x,C=o[Symbol.iterator]();!(b=(x=C.next()).done);b=!0)x.value.line(this.view,f,i)}catch(e){w=!0,Z=e}finally{try{b||null==C.return||C.return()}finally{if(w)throw Z}}}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}var S=!0,k=!1,_=void 0;try{for(var E,T=o[Symbol.iterator]();!(S=(E=T.next()).done);S=!0)E.value.finish()}catch(e){k=!0,_=e}finally{try{S||null==T.return||T.return()}finally{if(k)throw _}}e&&this.view.scrollDOM.insertBefore(this.dom,n)},t.updateGutters=function(e){var t=e.startState.facet(aj),n=e.state.facet(aj),r=e.docChanged||e.heightChanged||e.viewportChanged||!ek.Xs.eq(e.startState.facet(az),e.state.facet(az),e.view.viewport.from,e.view.viewport.to);if(t==n){var i=!0,o=!1,a=void 0;try{for(var l,c=this.gutters[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)l.value.update(e)&&(r=!0)}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}else{r=!0;var s=[],u=!0,d=!1,f=void 0;try{for(var h,p=n[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value,v=t.indexOf(m);v<0?s.push(new aQ(this.view,m)):(this.gutters[v].update(e),s.push(this.gutters[v]))}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}var g=!0,y=!1,b=void 0;try{for(var w,Z=this.gutters[Symbol.iterator]();!(g=(w=Z.next()).done);g=!0){var x=w.value;x.dom.remove(),0>s.indexOf(x)&&x.destroy()}}catch(e){y=!0,b=e}finally{try{g||null==Z.return||Z.return()}finally{if(y)throw b}}var C=!0,S=!1,k=void 0;try{for(var _,E=s[Symbol.iterator]();!(C=(_=E.next()).done);C=!0){var T=_.value;this.dom.appendChild(T.dom)}}catch(e){S=!0,k=e}finally{try{C||null==E.return||E.return()}finally{if(S)throw k}}this.gutters=s}return r},t.destroy=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.gutters[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.destroy()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.dom.remove()},e}(),{provide:function(e){return eR.tk.scrollMargins.of(function(t){var n=t.plugin(e);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==eR.Nm.LTR?{left:n.dom.offsetWidth}:{right:n.dom.offsetWidth}:null})}});function aJ(e){return Array.isArray(e)?e:[e]}function aK(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next()}var a$=function(){"use strict";function e(t,n,r){(0,eE._)(this,e),this.gutter=t,this.height=r,this.localMarkers=[],this.i=0,this.cursor=ek.Xs.iter(t.markers,n.from)}var t=e.prototype;return t.line=function(e,t,n){this.localMarkers.length&&(this.localMarkers=[]),aK(this.cursor,this.localMarkers,t.from);var r=n.length?this.localMarkers.concat(n):this.localMarkers,i=this.gutter.config.lineMarker(e,t,r);i&&r.unshift(i);var o=this.gutter;if(0!=r.length||o.config.renderEmptyElements){var a=t.top-this.height;if(this.i==o.elements.length){var l=new a0(e,t.height,a,r);o.elements.push(l),o.dom.appendChild(l.dom)}else o.elements[this.i].update(e,t.height,a,r);this.height=t.bottom,this.i++}},t.finish=function(){for(var e=this.gutter;e.elements.length>this.i;){var t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}},e}(),aQ=function(){"use strict";function e(t,n){var r=this,i=function(e){r.dom.addEventListener(e,function(r){var i=t.lineBlockAtHeight(r.clientY-t.documentTop);n.domEventHandlers[e](t,i,r)&&r.preventDefault()})};for(var o in(0,eE._)(this,e),this.view=t,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:""),n.domEventHandlers)i(o);this.markers=aJ(n.markers(t)),n.initialSpacer&&(this.spacer=new a0(t,0,0,[n.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}var t=e.prototype;return t.update=function(e){var t=this.markers;if(this.markers=aJ(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){var n=this.config.updateSpacer(this.spacer.markers[0],e);n!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[n])}var r=e.view.viewport;return!ek.Xs.eq(this.markers,t,r.from,r.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)},t.destroy=function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.elements[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.destroy()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},e}(),a0=function(){"use strict";function e(t,n,r,i){(0,eE._)(this,e),this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,n,r,i)}var t=e.prototype;return t.update=function(e,t,n,r){this.height!=t&&(this.dom.style.height=(this.height=t)+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),!function(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0}(this.markers,r)&&this.setMarkers(e,r)},t.setMarkers=function(e,t){for(var n="cm-gutterElement",r=this.dom.firstChild,i=0,o=0;;){var a=o,l=i<t.length?t[i++]:null,c=!1;if(l){var s=l.elementClass;s&&(n+=" "+s);for(var u=o;u<this.markers.length;u++)if(this.markers[u].compare(l)){a=u,c=!0;break}}else a=this.markers.length;for(;o<a;){var d=this.markers[o++];if(d.toDOM){d.destroy(r);var f=r.nextSibling;r.remove(),r=f}}if(!l)break;l.toDOM&&(c?r=r.nextSibling:this.dom.insertBefore(l.toDOM(e),r)),c&&o++}this.dom.className=n,this.markers=t},t.destroy=function(){this.setMarkers(null,[])},e}(),a1=ek.r$.define(),a2=ek.r$.define({combine:function(e){return(0,ek.BO)(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers:function(e,t){var n=Object.assign({},e);for(var r in t)!function(e){var r=n[e],i=t[e];n[e]=r?function(e,t,n){return r(e,t,n)||i(e,t,n)}:i}(r);return n}})}}),a8=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e){var r;return(0,eE._)(this,n),(r=t.call(this)).number=e,r}var r=n.prototype;return r.eq=function(e){return this.number==e.number},r.toDOM=function(){return document.createTextNode(this.number)},n}(aV);function a4(e,t){return e.state.facet(a2).formatNumber(t,e.state)}function a3(e){for(var t=9;t<e;)t=10*t+9;return t}aj.compute([a2],function(e){return{class:"cm-lineNumbers",renderEmptyElements:!1,markers:function(e){return e.state.facet(a1)},lineMarker:function(e,t,n){return n.some(function(e){return e.toDOM})?null:new a8(a4(e,e.state.doc.lineAt(t.from).number))},lineMarkerChange:function(e){return e.startState.facet(a2)!=e.state.facet(a2)},initialSpacer:function(e){return new a8(a4(e,a3(e.state.doc.lines)))},updateSpacer:function(e,t){var n=a4(t.view,a3(t.view.state.doc.lines));return n==e.number?e:new a8(n)},domEventHandlers:e.facet(a2).domEventHandlers}});var a5=new(function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(){var e;return(0,eE._)(this,n),e=t.apply(this,arguments),e.elementClass="cm-activeLineGutter",e}return n}(aV));az.compute(["selection"],function(e){var t=[],n=-1,r=!0,i=!1,o=void 0;try{for(var a,l=e.selection.ranges[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;if(c.empty){var s=e.doc.lineAt(c.head).from;s>n&&(n=s,t.push(a5.range(s)))}}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return ek.Xs.of(t)});var a6=n(11134),a9=n(91433),a7=function(e){var t=e.isOpen,n=e.threadId,r=(0,Z._)((0,J.useState)(!1),2),i=r[0],o=r[1],a=(0,a9.GD)({variables:{id:n},skip:"initial-spacer"===n});(0,J.useEffect)(function(){if(a&&!a.error){var e,t=null===(e=a.data)||void 0===e?void 0:e.thread;t&&o((null==t?void 0:t.__typename)==="AnnotationAnchor"&&(null==t?void 0:t.messages.some(function(e){return!e.seen})))}},[a]);var l={button:{alt:{default:"View threads",close:"Dismiss thread"}}};return(0,C.tZ)(or.hU,{alt:t?l.button.alt.close:l.button.alt.default,size:24,className:"thread-indicator",css:[ea.l0.width(20),ea.l0.height(20),ea.l0.transition.snappy,ea.l0.cursor.pointer,ea.l0.display.flex,ea.l0.borderRadius(8),ea.l0.position.relative,ea.l0.overflow("visible"),t?ea.l0.color.accentPrimaryStrongest:ea.l0.color.foregroundDimmest,{borderWidth:ea.TV.borderWidthDefault,borderStyle:"solid",borderColor:t?ea.TV.accentPrimaryDefault:"transparent",backgroundColor:t?ea.TV.accentPrimaryDimmer:ea.TV.backgroundHigher,outline:0},{":hover":{borderColor:t?ea.TV.accentPrimaryStronger:ea.TV.outlineDimmer,color:t?ea.TV.accentPrimaryStrongest:ea.TV.foregroundDimmer,background:t?ea.TV.accentPrimaryDefault+" !important":ea.TV.backgroundHighest},svg:{width:12,height:12}}],children:(0,C.BX)(C.HY,{children:[i?(0,C.tZ)("div",{css:[ea.l0.width(8),ea.l0.height(8),ea.l0.backgroundColor.redStronger,ea.l0.position.absolute,ea.l0.top(-1),ea.l0.left(-1),ea.l0.borderRadius("full")]}):null,(0,C.tZ)(a6.Z,{})]})})};function le(e,t,n){var r=t.clientWidth,i=n.clientWidth;e.style.maxWidth="".concat(r,"px"),e.style.position="sticky",e.style.zIndex="201",e.style.marginLeft="-".concat(i,"px")}var lt=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e,r,i){var o;return(0,eE._)(this,n),(o=t.call(this)).id=e,o.filePath=r,o.openThreadsInbox=i,o}var r=n.prototype;return r.eq=function(e){return e.id===this.id},r.toDOM=function(e){var t=(0,n$.V)((0,C.tZ)(aH,{threadId:this.id,view:e,filePath:this.filePath,openThreadsInbox:this.openThreadsInbox}));t.className="cm-thread-portal-widget";var n=e.dom.querySelector(".cm-scroller"),r=e.dom.querySelector(".cm-gutters");return n&&r&&le(t,n,r),t},r.ignoreEvent=function(){return!0},n}(eR.l9),ln=function(e){"use strict";(0,ne._)(n,e);var t=(0,nt._)(n);function n(e,r){var i;return(0,eE._)(this,n),(i=t.call(this)).id=e,i.active=r,i}var r=n.prototype;return r.toDOM=function(e){var t=this,n=(0,n$.V)((0,C.tZ)(a7,{isOpen:this.active,threadId:this.id}));return n.className="cm-thread-indicator",n.style.display="inline",n.style.cursor="pointer",n.setAttribute("aria-hidden","true"),n.onclick=function(n){n.stopPropagation(),n.preventDefault(),e.dispatch({effects:[aX.YM.of(e.state.field(aX.PQ)===t.id?null:t.id)]})},n},r.eq=function(e){return e.id===this.id&&e.active===this.active},n}(aV),lr=[(i=[aY],r&&!1===r.fixed&&i.push(aq.of(!0)),i),aj.of((0,b._)({},{class:"",renderEmptyElements:!1,elementStyle:"",markers:function(){return ek.Xs.empty},lineMarker:function(){return null},lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},{class:"cm-thread-indicator-gutter",markers:function(e){var t=e.state.field(aX.OQ),n=e.state.field(aX.PQ);return ek.Xs.of(Object.values(t).filter(function(e){return e.indexEnd!==e.indexStart}).map(function(t){var r=e.state.doc.lineAt(Math.min(t.indexStart,t.indexEnd)).from;return new ln(t.id,t.id===n).range(r)}),!0)},initialSpacer:function(){return new ln("initial-spacer",!1)}}))],li=n(70671),lo=function(e,t,n,r,i){if(t===n)return null;var o=(0,Z._)(r,2),a=o[0],l=o[1];return eR.p.mark({class:"replit-thread-highlight cm-thread-".concat(e),attributes:{style:"background-color: ".concat(i?l:a)},id:e}).range(t,n)},la=new tR.j(function(e,t,n){return e&&n?[ek.Wl.highest(lr),aX.cR,aX.OQ,aX.ZS,aX.PQ,eR.tk.decorations.compute([aX.OQ,aX.ZS,aX.PQ],function(e){var n=e.field(aX.OQ),r=e.field(aX.ZS),i=e.field(aX.PQ),o=r||Object.values(n).find(function(e){return e.id===i});return eR.p.set((0,x._)(Object.values(n)).map(function(e){var n=o&&e.id===o.id;return lo(e.id,e.indexStart,e.indexEnd,t,n)}).filter(function(t){return null!==t&&t.from!==t.to&&t.from<=e.doc.length&&t.to<=e.doc.length}),!0)}),eR.tk.decorations.compute([aX.OQ,aX.ZS,aX.PQ,eA.Yp],function(e){var t=e.field(aX.OQ),r=e.field(aX.ZS),i=e.field(aX.PQ),o=e.facet(eA.Yp);if(void 0===o)return eR.p.none;var a=(0,x._)(Object.values(t)).concat((0,x._)(r?[r]:[])).filter(Boolean).find(function(e){return e.id===i});return a?eR.p.set([eR.p.widget({widget:new lt(a.id,o,n),block:!0,side:1}).range(a.indexEnd)],!0):eR.p.none}),eR.tk.updateListener.of(function(e){(0,eD.j)(e,iC.R,function(){var t=(0,x._)(e.view.dom.querySelectorAll(".cm-thread-portal-widget")),n=e.view.dom.querySelector(".cm-scroller"),r=e.view.dom.querySelector(".cm-gutters");if(t.length&&n&&r){var i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;le(s,n,r)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}})}),eR.tk.updateListener.of(function(e){(0,eD.j)(e,aX.eR,function(t){var n=t.value,r=e.state.field(aX.OQ)[n];r&&e.view.dispatch({selection:{anchor:r.indexStart,head:r.indexStart},effects:[eR.tk.scrollIntoView(r.indexStart,{x:"center",y:"center"})]})})})]:null}),ll=n(92994),lc=n(40028),ls=n(77589),lu=n(77858),ld=n(9669);function lf(e){return{filePath:e,text:"",selections:[],hasFocus:!1}}function lh(e,t){var n;return null==t?lf(e):{filePath:e,text:null!==(n=t.state.doc.toString())&&void 0!==n?n:"",selections:t.state.selection.ranges.map(function(e){var t=e.from;return{location:t,length:e.to-t}}),hasFocus:t.hasFocus}}function lp(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ix()(),i=lh(e,t),o={messageType:ld.cF.TEXT_EDITOR_STATE,filePath:e,text:i.text,selections:i.selections,hasFocus:i.hasFocus,hasGhostwriterSuggestion:n.hasGhostwriterSuggestion,revisionId:n.revisionId};(0,ls.bG)(o,r)}function lm(e,t,n,r,i){return r===e&&r===n.textEditorState.filePath&&t===n.textEditorState.filePath&&i===n.revisionId}function lv(e){var t=e.map(function(e){return ek.jT.range(e.location,e.location+e.length)});return ek.jT.create(t)}function lg(e,t,n,r,i){var o=i.payload;if((0,ld.Se)(o))return function(e,t,n,r,i){if(!lm(e,t,r,i.filePath,i.revisionId))return!1;var o=lv(i.selections);return n.dispatch({selection:o,scrollIntoView:!0}),!0}(e,t,n,r,o);if((0,ld.m7)(o))return function(e,t,n,r,i){if(!lm(e,t,r,i.filePath,i.revisionId))return!1;var o=lh(e,n),a=lv(i.selections);return n.dispatch({changes:{from:0,to:o.text.length,insert:i.text},selection:a,scrollIntoView:!0}),!0}(e,t,n,r,o);if((0,ld.ac)(o))return function(e,t,n,r,i){if(!lm(e,t,r,i.filePath,i.revisionId))return!1;var o=i.insertionRange,a=lv(i.selections);return n.dispatch({changes:{from:o.location,to:o.location+o.length,insert:i.text},selection:a,scrollIntoView:!0}),!0}(e,t,n,r,o);if((0,ld.fz)(o))return!!lm(e,t,r,o.filePath,o.revisionId)&&(n.dispatch(n.state.replaceSelection(o.text)),!0);if((0,ld.T$)(o))lm(e,t,r,o.filePath,o.revisionId)&&(0,i5.l)({filePath:e,view:n,clipboardText:o.text});else if((0,ld.aB)(o))switch(o.action){case ld.b9.REQUEST_BLUR:return function(e,t,n,r,i,o){if(!lm(e,t,r,i,o))return!1;n.contentDOM.blur()}(e,t,n,r,o.filePath,o.revisionId);case ld.b9.REQUEST_UNDO:return!!lm(e,t,r,o.filePath,o.revisionId)&&((0,ee.Yw)(n),!0);case ld.b9.REQUEST_REDO:return!!lm(e,t,r,o.filePath,o.revisionId)&&((0,ee.KX)(n),!0);case ld.b9.REQUEST_INDENT_SELECTION:return!!lm(e,t,r,o.filePath,o.revisionId)&&(ee.at(n),!0);case ld.b9.REQUEST_DEDENT_SELECTION:return!!lm(e,t,r,o.filePath,o.revisionId)&&(ee.xi(n),!0);case ld.b9.REQUEST_TOGGLE_COMMENT:return!!lm(e,t,r,o.filePath,o.revisionId)&&(ee.O8(n),!0);case ld.b9.REQUEST_ACCEPT_GHOSTWRITER_SUGGESTION:return!!lm(e,t,r,o.filePath,o.revisionId)&&(0,lu.o)(n);case ld.b9.REQUEST_FOCUS:return n.focus(),!0;default:throw Error("Unknown BridgeTextEditorAction.")}else throw Error("Invalid payload.")}var ly=n(26851),lb=new tR.j(function(e){var t=eR.tk.domEventHandlers({scroll:ec()(function(t,n){var r=0,i=0,o=!0,a=!1,l=void 0;try{for(var c,s=n.visibleRanges[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;r=Math.min(r,u.from),i=Math.max(r,u.to)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}e("user:scroll",{visibleLines:{from:n.state.doc.lineAt(r).number,to:n.state.doc.lineAt(i).number}})},250)}),n=ec()(function(t,n,r){e("user:selection",{inputMethod:r,from:t,to:n})},250);return[t,eR.tk.updateListener.of(function(t){var r=t.transactions,i=!0,o=!1,a=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;s.isUserEvent("input.paste")&&e("user:paste",{}),s.isUserEvent("input.drop")&&e("user:new-drop",{}),s.isUserEvent("move.drop")&&e("user:move-drop",{}),s.isUserEvent("delete.cut")&&e("user:cut",{}),s.isUserEvent("input.complete")&&e("user:complete",{}),s.isUserEvent("select")&&n(s.newSelection.main.from,s.newSelection.main.to,s.isUserEvent("select.pointer")?"pointer":"keyboard"),s.isUserEvent("undo")&&e("user:undo",{}),s.isUserEvent("redo")&&e("user:redo",{})}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}})]}),lw=n(1323),lZ=n(52590),lx=n(67696);function lC(e){var t=e.selection.main.head,n=e.doc.lineAt(t);return{offset:t,line:n.number,column:t-n.from+1}}var lS=new tR.j(function(e){return eR.tk.focusChangeEffect.of(function(t,n){var r=t.facet(eA.Yp);return r&&e(r,n?{type:"focus",position:lC(t)}:{type:"blur"}),null})}),lk=new tR.j(function(e){return eR.tk.updateListener.of(function(t){if(t.selectionSet){var n=t.state.facet(eA.Yp);n&&e(n,{type:"update",hasFocus:t.view.hasFocus,position:lC(t.state)})}})}),l_=n(58091),lE=n(68956),lT=n(62808),lR=n(31384),lI=n(17428),lD=n(37054),lG=n(89446),lB=n(32148),lP=n(6191),lA=n(38041),lN=n(45549),lL=n(50586),lU=n(11398),lO=n(5018),lM=new tR.j(function(){return(0,eR.CT)()});function lX(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y,S,k,_,E,T,N,L,U,O,M,X,F,W,H,V,q,Y,$,Q,ee,et,en,er,ei,eo,ea,el,ed,ef,eh,ep,em,eg,ey,eb,eZ,ex,eC,eS,eG,eB,eV,ez,ej,eq,eY,eJ,eK,e$,eQ,e0,e1,e2,e8,e3,e5,e9,e7,te,tt,tn,tr,ti,to,ta,tl,tc,ts,tu,td,tf,th,tp,tm,tv,tg,ty,tb,tw,tZ,tx,tC,tS,tk,t_,tE=e.filePath,tT=e.autoFocus,tR=e.isHidden,tB=e.deeplink,tP=e.onDeeplinkUpdated,tN=e.openFile,tL=e.openThreadsInbox,tU=e.openPane,tO=e.performPaneOperation,tM=(0,tG.Z)(),tX=tM.fs,tF=tM.debuggest,tW=tM.presence,tH=tM.runner,tV=(0,B.Gn)("rulers","minimapDisplay","showLeadingWhitespace","showEnclosedWhitespace","showTrailingWhitespace","showSelectedWhitespace").preferences,tK=(0,oY.Z)(),tQ=tK.ref,t0=tK.view;(0,es.VD)(t0),(0,lZ.g)(t0);var t2=(0,i$.uV)(),t3=(0,eu.FS)(),t5=iK.use(!!(null==t3?void 0:t3.match(/Chrome/i))&&!!(null==t3?void 0:t3.match(/Android/i))),ne=(0,nM.P5)({controlName:"flag-ultra-hardcore",logFlagToAnalytics:!1}),nt="/replEnvironmentDesktop"===j().pathname,nn=(0,J.useContext)(lE.B3),nr=(0,i$.jT)(),ni=(n=(t={path:tE,isHidden:tR}).path,r=t.isHidden,i=(0,lx.NH)(),o=lS.use(i),a=lk.use(i),(0,J.useEffect)(function(){i(n,{type:r?"hidden":"unhidden"})},[r,i,n]),(0,J.useEffect)(function(){return function(){i(n,{type:"unmount"})}},[i,n]),(0,J.useMemo)(function(){return[o,a]},[o,a])),no=(s=(l={view:t0,presence:tW,fs:tX,filePath:tE}).view,u=l.presence,d=l.fs,f=l.filePath,h=iV.use(f,d,u),p=ij.use(u),m=(0,iQ.Z)().trackTimeToLoadFileEnd,v=(0,i$.uV)(),g=(0,i$.Id)(),y=(0,i$.I7)(),S=(0,J.useMemo)(function(){return{trackTimeToLoadFileEnd:m,throwBsod:v,setBsodFilePathVersion:g,deleteBsodFilePathVersion:y}},[y,g,v,m]),k=i3.use(f,d,S),_=null===(c=(0,G.IK)(s,iw.o))||void 0===c||c,E=(0,J.useMemo)(function(){return[k,h,p]},[k,h,p]),(0,J.useMemo)(function(){return{isLoading:_,extensions:E}},[_,E])),na=no.isLoading,nl=no.extensions;N=(T={view:t0,autoFocus:tT,isLoading:na}).view,L=T.isLoading,U=T.autoFocus,(0,J.useEffect)(function(){U&&N&&!L&&N.focus()},[N,L,U]);var nc=function(){var e=(0,al.Z)(),t=(0,J.useContext)(ac.d);if(!t)throw Error("Expected codemirror state to be in codemirror state context");return ah.use(e,t)}();(0,lT.Y)({view:t0});var ns=(M=(O={filePath:tE,isLoading:na,openFile:tN}).filePath,X=O.isLoading,F=O.openFile,W=(0,tG.Z)().fs,H=(0,t8.Z)(M),V=(0,B.Gn)("codeIntelligence").preferences,q=X||!V.codeIntelligence||!H.find(function(e){return e.isSupportedFile(M)}),Y=(0,J.useMemo)(function(){return new nq.R(q?[]:function(e,t,n,r){if(!t.length)return[];var i,o,a,l,c,s=[(o=(i={lspClients:t,path:n}).lspClients,a=i.path,eR.lg.define(function(e){var t,n,r,i,l,c;return n=(t={lspClients:o,path:a,view:e}).lspClients,r=t.path,i=t.view,l=is().v4(),c=function(e){var t,n=iu.get(e.clientId);return(null!==(t=null==n?void 0:n.get(r))&&void 0!==t?t:[])[0]===l},function(){var e=!0,t=!1,o=void 0;try{for(var a,c=n[Symbol.iterator]();!(e=(a=c.next()).done);e=!0){var s,u=a.value,d=iu.get(u.clientId),f=null!==(s=null==d?void 0:d.get(r))&&void 0!==s?s:[];d?d.set(r,(0,x._)(f).concat([l])):iu.set(u.clientId,new Map([[r,[l]]])),u.notify.didOpen(r,i.state.doc.toString())}}catch(e){t=!0,o=e}finally{try{e||null==c.return||c.return()}finally{if(t)throw o}}}(),{id:l,destroy:function(){var e=!0,t=!1,i=void 0;try{for(var o,a=n[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var c,s=o.value,u=iu.get(s.clientId),d=(null!==(c=null==u?void 0:u.get(r))&&void 0!==c?c:[]).filter(function(e){return e!==l});s.getServerState()===il.a.INITIALIZED&&s.isOpen(r)&&s.notify.didClose(r),0===d.length?null==u||u.delete(r):null==u||u.set(r,d)}}catch(e){t=!0,i=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw i}}},update:function(e){var t=!0,i=!1,o=void 0;try{for(var a,l,s=n[Symbol.iterator]();!(t=(l=s.next()).done);t=!0){var u,d=l.value;if(!c(d)||!e.docChanged)return;var f=null===(u=d.getServerCapabilities())||void 0===u?void 0:u.textDocumentSync;if(f===ra.TextDocumentSyncKind.None||!d.isOpen(r))return;if(f===ra.TextDocumentSyncKind.Full){var h=e.view.state.doc.toString();d.notify.didChange(r,[{text:h}]);return}a||(a=function(e,t){var n=[],r=t;return e.iterChanges(function(e,t,i,o,a){var l=a.sliceString(0),c=t-e,s=c+i;n.push({range:{start:(0,eN.sg)(r,i),end:(0,eN.sg)(r,s)},rangeLength:c,text:l}),r=r.replace(i,s,a)}),n}(e.changes,e.startState.doc)),d.notify.didChange(r,a)}}catch(e){i=!0,o=e}finally{try{t||null==s.return||s.return()}finally{if(i)throw o}}}}})),(0,D.Fq)({lspClients:t,path:n}),function(e,t){function n(e){return(0,eU.Z)(e).isTextDocumentSyncSupported}return eR.lg.fromClass(function(){"use strict";function r(e){(0,eE._)(this,r),this.dispose=this.listen(e.state.facet(eA.Yp))}var i=r.prototype;return i.update=function(e){(0,eL.a)(e,eA.Yp)&&(this.dispose=this.listen(e.state.facet(eA.Yp)))},i.destroy=function(){this.dispose&&this.dispose()},i.listen=function(r){if(this.dispose&&this.dispose(),r&&t.find(function(e){return n(e)}))return e.watchTextFile(r,{onFlush:function(){var e=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(e=(a=l.next()).done);e=!0){var c=a.value;n(c)&&c.isOpen(r)&&c.notify.didSave(r)}}catch(e){i=!0,o=e}finally{try{e||null==l.return||l.return()}finally{if(i)throw o}}}})},r}())}(e,t),[eX,eH,eR.lg.fromClass(function(){"use strict";function e(n){(0,eE._)(this,e),this.abortControllers=[];var r=this;this.getSymbolMap=(0,eP.Z)((0,e_._)(function(){var e,i,o;return(0,eT.Jh)(this,function(a){switch(a.label){case 0:if(!(e=n.state.facet(eA.Yp)))return[2];return r.abortControllers=[],[4,Promise.all(t.map(function(t){if(!(0,eU.Z)(t).isDocumentSymbolSupported)return null;var n=new AbortController;return r.abortControllers.push(n),function(e,t,n){return eF.apply(this,arguments)}(t,e,n.signal)}))];case 1:return i=a.sent(),n.dispatch({effects:eM.of(null!==(o=i.find(Boolean))&&void 0!==o?o:null)}),[2]}})}),{wait:200}),eO(n.state)&&this.getSymbolMap().catch(eW)}var n=e.prototype;return n.update=function(e){e.docChanged&&eO(e.state)&&(this.abortControllers.forEach(function(e){return e.abort()}),this.getSymbolMap().catch(eW))},n.destroy=function(){this.abortControllers.forEach(function(e){return e.abort()}),this.getSymbolMap.isScheduled()&&this.getSymbolMap.cancel()},e}())]];return(0,ih.isMobile)()||s.push((l=t[0],new nq.R(function(e){return function(e){var t=e.lspClient,n=e.view,r=n.state.facet(eA.Yp),i=.01>Math.random(),o=0,a=function(e,n){if(i&&r){var o=t.getLanguageId(r);return rr.kg.info("lsp:autocomplete:".concat(e),(0,b._)({languageId:o},n)),(0,e6.j)(e6.U3.LSP_COMPLETION_USED,(0,b._)({type:e,sampleRate:.01},n))}};function l(){return(l=(0,e_._)(function(e){var i,l,c,s,u;return(0,eT.Jh)(this,function(d){switch(d.label){case 0:if(!(l=t.getServerCapabilities())||!(null==l?void 0:l.completionProvider)||!(c=function(e,t){var n=e.state,r=e.pos;if(e.explicit)return{triggerKind:ra.CompletionTriggerKind.Invoked};var i=n.doc.lineAt(r),o=i.text[r-i.from-1],a=i.text.substring(0,r-i.from);return(null==t?void 0:t.includes(o))?{triggerKind:ra.CompletionTriggerKind.TriggerCharacter,triggerCharacter:o}:a.match(/\w$/)?{triggerKind:ra.CompletionTriggerKind.Invoked}:null}(e,(null==l?void 0:null===(i=l.completionProvider)||void 0===i?void 0:i.triggerCharacters)||[])))return[2,null];if(o&&t.notify.cancelRequest(o),!r)throw Error("path not found");return o=t.generateId(),n.dispatch({effects:[n7.of(null)]}),[4,t.request.completion(r,(0,eN.sg)(e.state.doc,e.pos),c,{id:o})];case 1:if("error"in(s=d.sent())||(u=s.result,e.aborted||!u))return[2,null];return[2,function(e){for(var t=e.context,n=e.items,r=e.client,i=e.path,o=e.trackCompletion,a=0,l=null!==(B=(0,nK.Z)(t.state))&&void 0!==B?B:"unknown",c=(T=n.filter(function(e){return!!e.label}),R=["label","kind"],I=new Set,T.filter(function(e){var t=R.map(function(t){return e[t]}).join("");return!I.has(t)&&(I.add(t),!0)})).map(function(e){var t=e.additionalTextEdits,n={label:e.label,detail:e.detail,apply:function(n,a,c,s){if(e.insertTextFormat===e4.InsertTextFormat.Snippet){var u=[];t&&u.push({changes:t.map(function(e){return rH(n,e)})});var d=new rI(null!==(p=null!==(h=null===(f=e.textEdit)||void 0===f?void 0:f.newText)&&void 0!==h?h:e.insertText)&&void 0!==p?p:e.label);if(e.textEdit&&("range"in e.textEdit)){var f,h,p,m,v=s;c=(m=rW(n.state,e.textEdit.range)).from,s=Math.max(s=m.to,v)}var g=d.apply({view:n,from:c,to:s,path:i,completion:a});n.dispatch.apply(n,(0,x._)(u).concat([g])),o("completion-accepted",{language:l,completionKind:e.kind,insertTextFormat:e.insertTextFormat});return}var y=function(e){var t,n=e.view,r=e.item,i=e.from,o=e.to,a=n.state,l=a.doc,c=a.selection,s=[];if(r.textEdit){if(!("range"in r.textEdit))return;var u=rH(n,r.textEdit);if(!u)return;u.to=Math.max(u.to,c.main.to),s.push(u)}else{var d=r.insertText||r.label,f=n.state.wordAt(o);f&&f.to>o&&d.includes(n.state.doc.sliceString(o,f.to))&&(o=f.to),s.push({from:i,to:o,insert:d})}var h=(0,Z._)(s,1)[0],p="";null===(t=r.additionalTextEdits)||void 0===t||t.forEach(function(e){var t=rH(n,e);t&&(("from"in h)&&t.from===h.from&&(p=t.insert),s.push(t))});var m=o-i;c.ranges.forEach(function(e){if(e!==c.main){if(!("insert"in h)||!h.insert)throw Error("Expected insert in mainChange");var t=e.from-m,n=p+h.insert;s.push({from:t,to:e.to,insert:n})}});var v=s.map(function(e){return("from"in e)&&void 0!==e.to?(0,w._)((0,b._)({},e),{from:Math.min(e.from,e.to),to:Math.max(e.from,e.to)}):e}),g=ek.as.of(v,l.length),y=c.ranges.map(function(e){return e.map(g,0)});return{changes:g,selection:ek.jT.create(y,c.mainIndex)}}({view:n,item:(0,w._)((0,b._)({},e),{additionalTextEdits:t}),to:s,from:c});y&&(o("completion-accepted",{language:l,completionKind:e.kind,insertTextFormat:e.insertTextFormat}),n.dispatch({changes:y.changes,selection:y.selection,annotations:nY.Jv.of(a)}),e.command&&r.request.executeCommand(e.command.command,e.command.arguments))},type:e.kind&&rF[e.kind],filterText:(e.filterText||e.label).toLowerCase(),sortText:(e.sortText||e.label).toLowerCase()};return r&&(0,eU.Z)(r).isCompletionItemResolveSupported?n.info=(0,e_._)(function(){var n,c,s,u,d;return(0,eT.Jh)(this,function(f){switch(f.label){case 0:return[4,r.request.resolveCompletionItem(e)];case 1:if(c=("cancelled"in(n=f.sent()))&&n.cancelled,s=("result"in n)?n.result:null,c||!s||(s.additionalTextEdits&&(t=s.additionalTextEdits),a++,u=[],s.detail&&s.detail!==e.detail&&s.detail!==e.label&&(d=["```"+(0,ri.extname)(i).slice(1),s.detail,"```"].join("\n"),u.push((0,C.tZ)(rf,{className:"lsp-completion-detail",content:{value:d,kind:"markdown"}},"".concat(a,"-detail")))),s.documentation&&u.push((0,C.tZ)(rf,{content:s.documentation},"".concat(a,"-documentation"))),0===u.length))return[2,null];return o("resolution-presented",{language:l,resolutionSource:"request",completionKind:e.kind}),[2,(0,n$.V)((0,C.tZ)("div",{children:u}))]}})}):e.documentation&&(n.info=function(){return e.documentation?(o("resolution-presented",{language:l,resolutionSource:"documentation",completionKind:e.kind}),(0,n$.V)((0,C.tZ)("div",{children:(0,C.tZ)(rf,{content:e.documentation})}))):null}),n}),s=((c=c.sort(function(e,t){return e.sortText<t.sortText?-1:e.sortText>t.sortText?1:0})).length%2?c.length-1:c.length)/2,u=0;u<=s;u++){if(0===u&&c[s]){c[s].boost=0;continue}var d=c[s-u];if(d){var f=c[s-u+1],h=f.sortText,p=f.boost,m=void 0===p?0:p;d.boost=d.sortText===h?m:m+1}var v=c[s+u];if(v){var g=c[s+u-1],y=g.sortText,S=g.boost,k=void 0===S?0:S;v.boost=v.sortText===y?k:k-1}}var _=null!==(P=null===(D=c[0])||void 0===D?void 0:D.boost)&&void 0!==P?P:0,E=null!==(A=null===(G=c[c.length-1])||void 0===G?void 0:G.boost)&&void 0!==A?A:0;if(_>99||E<-99)for(var T,R,I,D,G,B,P,A,N,L=99/Math.max(Math.abs(_),Math.abs(E)),U=0;U<c.length;U++)c[U].boost=(null!==(N=c[U].boost)&&void 0!==N?N:0)*L;var O=(0,Z._)(function(e){var t=Object.create(null),n=Object.create(null),r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value.filterText;t[c[0]]=!0;for(var s=1;s<c.length;s++)n[c[s]]=!0}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}var u=rX(t)+rX(n)+"*$";return[RegExp("^"+u),new RegExp(u)]}(c),2),M=O[0],X=O[1],F=t.matchBefore(X),W=t.pos;return F&&(W=F.from),c.length&&o("completion-options-presented",{language:l}),{from:W,options:c,validFor:M}}({context:e,items:Array.isArray(u)?u:u.items,client:t,path:r,trackCompletion:a})]}})})).apply(this,arguments)}return[n3,n9,re,(0,nY.ys)({defaultKeymap:!1,closeOnBlur:!1,tooltipClass:function(e){return(0,nJ.o)(e)?n4:""},addToOptions:[{render:function(e,t){if(!(0,nJ.o)(t))return null;var n=document.createElement("div");return n.className="lsp-completion-keyboard-shortcuts",(0,ro.createRoot)(n).render((0,C.tZ)(rn.C,{children:(0,C.tZ)(n8.ZP,{size:"inherit",shortcut:{key:""}})})),n},position:200}],override:[(0,nY.eC)(["LineComment","BlockComment"],function(e){return l.apply(this,arguments)})]}),rV]}({lspClient:l,view:e})})),function(e){var t=e.lspClient,n=e.path,r={current:null};function i(){return(i=(0,e_._)(function(e,i){var a,l,c,s,u,d,f;return(0,eT.Jh)(this,function(h){switch(h.label){case 0:if(s=(null===(l=t.getServerCapabilities())||void 0===l?void 0:null===(a=l.signatureHelpProvider)||void 0===a?void 0:a.triggerCharacters)||[],u=e.field(o,!1),d=e.field(ir,!1),!u&&(null==d||!s.includes(d)))return[2,null];return[4,function(e,t,n,r,i){return ia.apply(this,arguments)}(e,i,t,n,r)];case 1:if(!(null==(f=h.sent())?void 0:null===(c=f.signatures)||void 0===c?void 0:c.length))return[2,null];return[2,f]}})})).apply(this,arguments)}var o=ek.QQ.define({create:function(){return null},update:function(e,t){return t.isUserEvent("select.pointer")?null:(e&&t.newSelection.main.from!==e.pos&&(e=(0,w._)((0,b._)({},e),{pos:t.newSelection.main.from})),(0,eD.j)(t,ie.effect,function(n){var r=n.value;e=r?{pos:t.newSelection.main.from,help:r,index:0}:null}),(0,eD.j)(t,it,function(t){var n=t.value;if(e){var r=e.help.signatures.length,i=(r+e.index+n)%r;e=i>=e.help.signatures.length||i<0?null:(0,w._)((0,b._)({},e),{index:i})}}),e)},provide:function(e){var t=function(t){var n=t.state.field(e);if(!n)throw Error("expected nonnull field");var r=ii.create({help:n.help,index:n.index});return{dom:r,update:function(t){ii.update(r,function(r){var i=t.state.field(e);return i&&i!==n?{help:i.help,index:i.index}:r})}}};return eR.hJ.compute([e],function(n){var r=n.field(e);return r?{pos:r.pos,create:t,above:!0}:null})}}),a=eR.lg.define(function(){var e,n=ec()((e=(0,e_._)(function(e){var t,n,r;return(0,eT.Jh)(this,function(o){switch(o.label){case 0:if(!(t=e.state.selection.main).empty)return[3,2];return n=e.state.field(ie.state,!1),[4,function(e,t){return i.apply(this,arguments)}(e.state,t.from)];case 1:(r=o.sent())&&!n&&(0,nY._B)(e),e.dispatch({effects:ie.effect.of(r)}),o.label=2;case 2:return[2]}})}),function(t){return e.apply(this,arguments)}),0);return{update:function(e){(0,eU.Z)(t).isSignatureHelpSupported&&e.transactions.some(function(e){return e.selection})&&e.state.selection.main.empty&&n(e.view)}}});function l(e,t){var n=e.state.field(ie.state,!1);return"active"!==(0,nY.LR)(e.state)&&null!=n&&("navigate"!==t||n.signatures.length>1)}var c=function(e){return function(t){return!!l(t,"navigate")&&(t.dispatch({effects:it.of(e)}),!0)}},s=[{key:"ArrowDown",run:c(1)},{key:"ArrowUp",run:c(-1)},{key:"Escape",run:function(e){return!!l(e,"dismiss")&&(e.dispatch({effects:ie.effect.of(null)}),!0)}}];return[o,ie.state,ir,a,ek.Wl.high(eR.$f.of(s))]}({lspClient:t[0],path:n}),(c=function(e){var t,n=null;return(0,eR.bF)((t=(0,e_._)(function(t,r){var i,o,a,l,c,s;return(0,eT.Jh)(this,function(u){switch(u.label){case 0:if(!(0,eU.Z)(e).isHoverSupported||!(i=t.state.facet(eA.Yp)))return[2,null];o=(0,eN.sg)(t.state.doc,r);try{a=t.state.wordAt(r)}catch(e){return[2,null]}if(n){if(n.from===(null==a?void 0:a.from)&&n.to===(null==a?void 0:a.to))return[2,null];e.notify.cancelRequest(n.id)}return n={id:l=e.generateId(),from:null==a?void 0:a.from,to:null==a?void 0:a.to},[4,e.request.hover(i,o,{id:l})];case 1:if(c=u.sent(),n=null,"error"in c||null===(s=c.result))return[2,null];return[2,function(e){var t,n,r=e.hover,i=e.state,o=e.offset;if((Array.isArray(r.contents)||"string"==typeof r.contents)&&0===r.contents.length)return null;var a="",l=i.doc;if(r.range)t=(0,eN.RL)(l,r.range.start),n=(0,eN.RL)(l,r.range.end),a=l.sliceString(t,n);else if(n=void 0,(t=o)<=i.doc.length){var c=i.wordAt(t);c?(a=l.sliceString(c.from,c.to),t=Math.min(t,c.from),n=c.to):a=l.sliceString(t,t+1)}return{pos:t,end:n,create:function(e){var t=(0,n$.V)((0,C.tZ)(rY,{content:r.contents,textHovered:a}));return t.classList.add("hover-tooltip"),t.style.padding="0",{dom:t,mount:function(){!function(e,t){t.forEach(function(t){return setTimeout(e,t)})}(function(){(0,eR.E2)(e)},[0,50,200,1e3])}}},above:!0}}({hover:s,offset:r,state:t.state})]}})}),function(e,n){return t.apply(this,arguments)}),{hideOn:function(e){return!e.annotation(ek.YW.remote)&&!!(e.isUserEvent("input")||e.isUserEvent("delete")||e.isUserEvent("select"))},hoverTime:0})},[t.map(function(e){return c(e)}),eR.tk.domEventObservers({mousedown:function(e,t){!(e.target instanceof HTMLElement&&e.target.matches(".cm-tooltip *"))&&(0,eR.Dm)(t.state)&&t.dispatch({effects:eR.E8})},keydown:function(e,t){"Escape"===e.key&&(0,eR.Dm)(t.state)&&t.dispatch({effects:eR.E8})},scroll:function(e,t){(0,eR.Dm)(t.state)&&t.dispatch({effects:eR.E8})}})]),(0,id.DZ)(t,e),(0,rJ.jd)({lspClients:t,openFile:r}),function(e){var t,n=e.lspClient,r=e.path,i=e.openFile;if(!i)return[];var o=ek.Py.define(),a=ek.Py.define();return[eR.tk.updateListener.of((t=(0,e_._)(function(e){var t,i,l,c,s,u,d,f,h,p,m,v,g,y,b,w,C,S,k,_,E,T,R,I,D,G,B,P,A,N,L,U;return(0,eT.Jh)(this,function(O){switch(O.label){case 0:if(!(t=(0,eU.Z)(n)).isFindReferencesSupported&&!t.isFindDefinitionSupported)return[2];i=null,l=!0,c=!1,s=void 0;try{for(u=e.transactions[Symbol.iterator]();!(l=(d=u.next()).done);l=!0){f=d.value,h=!0,p=!1,m=void 0;try{for(v=f.effects[Symbol.iterator]();!(h=(g=v.next()).done);h=!0)(y=g.value).is(r$.h)&&(i=y.value)}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}}}catch(e){c=!0,s=e}finally{try{l||null==u.return||u.return()}finally{if(c)throw s}}if(!i)return[2];return b=e.state.doc,w=(0,eN.sg)(b,i),C=Promise.all([t.isFindReferencesSupported?n.request.findReferences(r,w,{includeDeclaration:!1}):{result:null},t.isFindDefinitionSupported?n.request.findDefinitions(r,w):{result:null}]),(0,rK.SC)(e.view,C),[4,C];case 1:if(k=(S=Z._.apply(void 0,[O.sent(),2]))[0],_=S[1],"error"in k)throw Error("Something went wrong fetching references: ".concat(k.error.message));if("error"in _)throw Error("Something went wrong fetching definition: ".concat(_.error.message));if(E=k.result,T=_.result,R=(0,r0.g)(T),I=E&&E.length>0,D=R&&R.length>0,!I&&!D)return(0,rQ.J)(e.view,{message:"No references found",offset:i}),e.view.dispatch({effects:a.of(null)}),[2];return G=[],B=[],E&&E.length>0&&(P=G).push.apply(P,(0,x._)(E)),R&&R.length>0&&(A=B).push.apply(A,(0,x._)(R)),N=(0,x._)(G).concat((0,x._)(B)).map(function(e){return n.documentUriToPath(e.uri)}).filter(function(e){return e!==r}),L=(0,x._)(new Set(N)),U=b.toJSON().join("\n"),e.view.dispatch({effects:o.of({references:G,definitions:B,currentFile:r,currentFileContents:U,files:L})}),[2]}})}),function(e){return t.apply(this,arguments)})),ek.QQ.define({create:function(){return null},update:function(e,t){var n=e,r=!0,i=!1,l=void 0;try{for(var c,s=t.effects[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){var u=c.value;u.is(o)&&(n=u.value),u.is(a)&&(n=null)}}catch(e){i=!0,l=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw l}}return n},provide:function(e){return eR.hJ.compute([e],function(t){var n=t.field(e);if(!n)return null;var o=t.selection.asSingle().main;return{pos:o.from,end:o.to,create:function(e){var t=(0,n$.V)((0,C.tZ)("div",{children:(0,C.tZ)(r9,(0,w._)((0,b._)({},n),{onClose:function(){e.dispatch({effects:a.of(null)})},jumpToPosition:function(t){if(i){if(t.path!==r){i(t);return}var n=t.line,o=t.col;(0,nF.S)({view:e,line:n,col:o}),e.focus()}}}))}));return t.classList.add("cm-lsp-tooltip"),t.classList.add("replit-tooltip"),t.style.padding="0",t.style.overflow="scroll",{dom:t}}}})}})]}({lspClient:t[0],path:n,openFile:r}),(0,r7.f)(e,t)),s}(W,H,M,F))},[H,M,W,F,q]),$=(0,J.useMemo)(function(){return new nq.R(function(){return eI.T.of(H.map(function(e){return(0,eU.Z)(e)}))})},[H]),(0,J.useEffect)(function(){return!H.length||q?Y.set(null):(0,ip.uf)(H.map(function(e){return e.onServerCapabilitiesChange(function(){$.set(eI.T.of(H.map(function(e){return(0,eU.Z)(e)})))})}))},[$,H,Y,q]),[$.extension,Y.extension,(0,D.wB)(H,V.codeIntelligence)]),nu=(ee=(Q={debuggest:tF,filePath:tE}).debuggest,et=Q.filePath,en=(0,tG.Z)().fs,er=(0,tD.Z)(),ei=(0,tI.Z)(ee.mainClient),tA.use(ei,er,et,en));(0,nF.Z)({filePath:tE,view:t0,isLoading:na,deeplink:tB,onDeeplinkUpdated:tP});var nd=nz.use((0,ev.f6)()),nf=(el=(eo={view:t0,filePath:tE}).view,ed=eo.filePath,ef=(0,tG.Z)().fs,eh=(0,ev.xZ)(null!==(ea=null==el?void 0:el.state.facet(eA.Yp))&&void 0!==ea?ea:null),(0,Z._)((0,lB.L)({accept:[ew.z.Code,lP.FILE],drop:function(e,t){if(el){var n=t.getClientOffset(),r=n?el.posAtCoords(n):null;if(null!==r){var i=function(e){el.focus(),el.dispatch({changes:{from:r,insert:e},selection:{anchor:r,head:r+e.length}})};if(e.type===ew.z.Code)i(e.code);else{var o=!0,a=!1,l=void 0;try{for(var c,s=e.files[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;eh?(0,lG.L0)(u).then(function(e){return i('"'+e+'"')}):ed&&(0,K.gK)(ed)&&(0,lA.r)(u,ef,ed).then(i)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}}}}}}),2)[1]),nh=(0,t9.Z)({filePath:tE}),np=(em=(ep={view:t0,filePath:tE,isLoading:na,enable:nt,openThreadsInbox:tL}).view,eg=ep.filePath,ey=ep.isLoading,eb=ep.enable,eZ=ep.openThreadsInbox,ex=(0,aE.kM)(),(0,J.useEffect)(function(){em&&ex&&em.dispatch({effects:[aX.YM.of(ex),aX.eR.of(ex)]})},[em,ex]),eC=(0,li.F)().theme,eG=(eS=(0,Z._)((0,J.useState)([iv.TV.accentPrimaryDimmest,iv.TV.accentPrimaryDimmer]),2))[0],eB=eS[1],(0,J.useEffect)(function(){var e=oB(eC.values.global.accentPrimaryDimmest);eB(["rgba(".concat(e.join(","),", 0.5)"),iv.TV.accentPrimaryDimmer])},[eC]),eV=ag(eg,ey,!0,eb),ez=(0,tG.Z)().fs,eq=(ej=(0,am.kL)(eg)).contentRef,eY=ej.loadedFile,eJ=ej.transformSelectionRef,(0,J.useEffect)(function(){var e=!1,t=eJ.current,n=eq.current;if(eY&&t&&n&&!ey&&em){var r=Object.values(eV);if(0===r.length){em.dispatch({effects:aX.qi.of({})});return}Promise.all(r.map(function(e){return(0,am.Ft)({anchor:e,version:ez.getOTVersion(eg),transformSelection:t,content:n})})).then(function(t){if(!e){var n=t.filter(function(e){return!!e}).map(function(e){if(!e)throw Error("expected resolved anchor");return(0,b._)({},e.anchor,null==e?void 0:e.newSelection)});return em.dispatch({effects:aX.qi.of(n.reduce(function(e,t){return e[t.id]=t,e},{}))}),function(){e=!0,em&&em.dispatch({effects:aX.qi.of({})})}}})}},[eV,em,eY,ez,eJ,eq,eg,ey]),la.use(eb,eG,eZ));e$=(eK={view:t0,filePath:tE}).view,eQ=eK.filePath,e0=(0,z.useRouter)(),e1=(0,A.Vg)(e0),e2=(0,J.useRef)({revisionId:ix()(),textEditorState:lf(eQ),hasGhostwriterSuggestion:!1}),e8=(0,J.useRef)(eQ),e3=(0,ll.Z)({view:e$}),(0,J.useEffect)(function(){if(e$&&e1){var e=lh(eQ,e$);e2.current={revisionId:ix()(),textEditorState:e,hasGhostwriterSuggestion:e2.current.hasGhostwriterSuggestion},lp(eQ,e$,e2.current);var t=function(t){var n,r=(0,nJ.o)(e$.state),i=(null===(n=e2.current)||void 0===n?void 0:n.hasGhostwriterSuggestion)!==r;t.docChanged?(e2.current={revisionId:ix()(),textEditorState:e,hasGhostwriterSuggestion:r},lp(eQ,e$,e2.current)):(t.selectionSet||t.focusChanged||i)&&(e2.current={revisionId:e2.current.revisionId,textEditorState:e,hasGhostwriterSuggestion:r},lp(eQ,e$,e2.current))};return e$.dispatch({effects:e3.reconfigure(eR.tk.updateListener.of(function(e){t(e)}))}),function(){e$.dispatch({effects:e3.reconfigure([])})}}},[e$,eQ,e3,e1]),(0,J.useEffect)(function(){if(e$&&e1){var e=function(e){lp(eQ,e$,e2.current,e.messageId)},t=function(t){lg(eQ,e8.current,e$,e2.current,t)?e(t):(0,ls.pl)(t.messageId)},n=function(t){lg(eQ,e8.current,e$,e2.current,t)?e(t):(0,ls.pl)(t.messageId)},r=function(r){try{var i=r.data;if(!(0,ld.CF)(i)||i.protocolVersion!==ld.Wj)return;var o=i.payload;i.messageDirection===ld.s1.TO_NATIVE&&(0,ld.H7)(o)&&(e8.current=o.activePaneFilePath),(0,ls.fp)(r,function(r){var o=r.type;switch(o){case ld.cF.TEXT_EDITOR_STATE_REQUEST:e(i);break;case ld.cF.REQUEST_SET_SELECTION:case ld.cF.REQUEST_REPLACE_SELECTION:case ld.cF.REQUEST_SET_TEXT:case ld.cF.REQUEST_INSERT_TEXT:case ld.cF.REQUEST_PASTE_TEXT:t(i);break;case ld.cF.TEXT_EDITOR_REQUEST_ACTION:n(i);break;default:(0,lc.Z)(o)}})}catch(e){throw Error("Invalid message: ".concat(e))}};return window.addEventListener("message",r),lp(eQ,e$,e2.current),function(){(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ix()(),n={messageType:ld.cF.TEXT_EDITOR_CLOSED,filePath:e};(0,ls.bG)(n,t)})(eQ),window.removeEventListener("message",r)}}},[e$,eQ,e1]);var nm=(e5=(0,ly.K)((0,P.Z)(function(){return{path:tE}},[tE])),lb.use(e5)),nv=(e7=(e9={filePath:tE}).filePath,tt=void 0!==(te=e9.disableDiff)&&te,tr=void 0!==(tn=e9.disableConflicts)&&tn,ti=(0,nM.P5)({controlName:"flag-git-gud",logFlagToAnalytics:!1}),to=(0,nM.P5)({controlName:"flag-git-gud-gutter",logFlagToAnalytics:!1}),ta=(0,nM.P5)({controlName:"flag-editor-git-conflict-markers",logFlagToAnalytics:!1}),tl=(0,tG.Z)().git,tt=!ti||!to||tt,tr=!ti||!ta||tr,nX.use(tl,void 0===e7?null:e7,tt,tr)),ng=(0,A.T3)(),ny=(0,ev.xZ)(null!==(t_=null==t0?void 0:t0.state.facet(eA.Yp))&&void 0!==t_?t_:null),nb=oW.use(ny,ng),nw=i5.hx.use(ny,tX),nZ=oI.use(ng),nx=o0.use(tV.rulers),nC=(0,li.F)(),nS=ib.use(ng,tV.minimapDisplay,nC),nk=R.NS.use(tH),n_=(tc={filePath:tE},ts=(0,tG.Z)().container,td=(tu=(0,tq.Z)()).showError,tf=tu.showConfirm,th=(0,t1.T)(),tp=(0,B.Gn)("indentSize","indentIsSpaces","codeIntelligence").preferences,tm=(0,t8.Z)(tc.filePath),tv=(0,t4.Z)(tm),t6.use(th,ts,tm,tv,tp.indentIsSpaces,tp.indentSize,tp.codeIntelligence,tc.filePath,function(){return tf("Formatted ".concat(tc.filePath," successfully"),1500)},function(){return td("Sorry, formatting ".concat(tc.filePath," failed"),1500)})),nE=(tg=(0,tY.Z)(),ty=(0,tG.Z)().container,tw=(tb=(0,tq.Z)()).showError,tZ=tb.showConfirm,tx=tj.ZP.supportsFormatting(tg),tC=(0,tJ.Z)({container:ty,service:"format",skip:!tx}).channel,tS=t$.use(tE,tC,tx,tw,tZ),(0,J.useMemo)(function(){return tS},[tS])),nT=(0,nM.P5)({controlName:"flag-editor-visible-whitespace",logFlagToAnalytics:!1}),nR=tz.use(!!nT&&tV.showLeadingWhitespace,!!nT&&tV.showEnclosedWhitespace,!!nT&&tV.showTrailingWhitespace,!!nT&&tV.showSelectedWhitespace),nI=(0,lD.Ls)({path:tE}),nD=(0,lD.fD)({path:tE}),nG=(0,lD.jg)({path:tE}),nB=(0,J.useCallback)(function(){t0&&nI(t0)},[t0,nI]),nP=(0,lN.u)({isMobile:ng,generateCode:nI,filePath:tE,openPane:tU}),nA=(0,J.useCallback)(function(){tU({type:"ghostwriterChat"})},[tU]),nN=(0,J.useCallback)(function(e){tU({type:"searchReplace",data:{initialQuery:e}})},[tU]),nL=(0,t7.W)({onGenerateCode:nB,onReplyInChat:nA}),nU=(0,lR.av)(),nO=nU.onContextMenu,nW=nU.closeContextMenu,nH=nU.openContextMenu,nV=(0,J.useCallback)(function(e){t0&&(0,eR.$1)(t0,e,"context-menu")&&(nW(),e.stopPropagation(),e.preventDefault())},[nW,t0]),nQ=(0,lD.aT)({openFile:tN,openSearchAndReplace:nN,path:tE,view:t0,onCommand:function(e){if(t0){var t=t0.state.selection.main.head;if(t){var n=t0.coordsAtPos(t);n&&nH({target:{x:n.left,y:n.top},command:[nQ(),e],width:275,onKeyDownHandler:nV})}}}}),n0=(0,J.useCallback)(function(e){nO(e,{command:nQ(),width:275,onKeyDownHandler:nV})},[nQ,nO,nV]),n1=(0,J.useCallback)(function(e,t){nH({target:e,command:[nQ(),t],width:275,onKeyDownHandler:nV})},[nQ,nV,nH]),n2=lD.pZ.use(ng,n0),n5=lI.t.use(n1),n6=(0,J.useCallback)(function(e){nH({target:{x:e.right-275,y:e.top},width:275,command:nQ(),onKeyDownHandler:nV})},[nQ,nV,nH]),rt=(0,lL.W)({editCode:nG,explainCode:nD,generateCode:nI,onMoreClick:n6}),rl=(tk=(0,tY.T)(),oT.use(tk)),rc=(0,nM.P5)({controlName:"flag-problems-pane"}),rs=nj.y.use(rc),ru=lM.use(),rd=(0,lO.Fs)(tO);return(0,C.tZ)("div",{css:lU.ac,"data-cy":na?"workspace-cm-editor-loading":"workspace-cm-editor-".concat(tE),children:(0,C.tZ)(oD.ZP,{ref:tQ,elementRef:nf,css:lU.Mp,filePath:tE,hideTooltips:tR,extensions:[n2,n5,nl,nu,nc,ns,nP,ru,nb,t5,nZ,nv,nS,i5.sy,nw,iY,nL,rl,ap,nx,nR,nk,n_,nE,I.er,nm,nh,np,aa,oq,nd,ng?[]:rt,ni,rs,rd],onException:function(e){var t,n={filePath:tE,cursorPosition:JSON.stringify(null==nn?void 0:null===(t=nn.get(l_._s))||void 0===t?void 0:t.position),fileVersion:nr({filePath:tE})};if(t0){var r=t0.plugin(iY),i=null==r?void 0:r.logs();null==r||r.flush(),n.domText=t0.contentDOM.innerText,n.keystrokes=JSON.stringify(i),n.selection=JSON.stringify(t0.state.selection.main.toJSON()),n.updateDoc=t0.state.doc.sliceString(0)}if(ne){t2({error:e,tags:{codemirror:!0},extras:n,origin:"CodemirrorEditor: useEditor/onException"});return}(0,lw.O)(e,{tags:{origin:"CodemirrorEditor: useEditor/onException",codemirror:!0},extras:n})},noHistory:!0})})}var lF=n(21012),lW=n(87959),lH=n(57369),lV=n(19858),lz=(0,n1.X)({base:[ea.l0.backgroundColor.backgroundDefault,ea.l0.color.foregroundDimmer,ea.l0.borderRadius(0),ea.l0.height("auto"),ea.l0.py(8),ea.l0.px(6),{"> div":ea.l0.rowWithGap(4)}]}),lj=function(e){var t=e.css,n=e.innerRef,r=(0,rh._)(e,["css","innerRef"]);return(0,C.tZ)(ty.Tg,{background:"root",children:(0,C.tZ)(on.zx,(0,b._)({size:"small",css:[lz.base,t],ref:n},r))})};function lq(e){var t,n=e.performPaneOperation,r=(0,lV.Z)((t=(0,e_._)(function(e){var t,n,r,i;return(0,eT.Jh)(this,function(o){switch(o.label){case 0:return[4,e.getRepositoryState()];case 1:if((t=o.sent()).error)return[2,t];if(n=t.type,r=null,!(n!==lH.y5.INITIALIZING))return[3,3];return[4,e.status()];case 2:if((i=o.sent()).error)return[2,i];r=i,o.label=3;case 3:return[2,{branchName:null==r?void 0:r.branch,error:null}]}})}),function(e){return t.apply(this,arguments)})),i=!r||r.error?null:r.branchName;return i?(0,C.tZ)(lj,{onClick:function(){return null==n?void 0:n({operation:"open",pane:{type:"git"}})},text:i,iconLeft:(0,C.tZ)(lW.Z,{color:iv.TV.foregroundDimmer,size:12})}):null}var lY=n(27879),lJ=n(63185),lK=n(70408),l$=n(60769),lQ=n(40227),l0=n(30983),l1=n(67914),l2=n(50494),l8=n(75582),l4=n(80703),l3="StatusBar",l5=(0,n1.X)({root:[ea.l0.display.none,(0,nd._)({},ea.nC.max(550,l3),[ea.l0.display.flex])]});function l6(e){var t=e.children;return(0,C.tZ)(er.G,{css:l5.root,children:t})}var l9=(0,n1.X)({base:[ea.l0.backgroundColor.backgroundDefault,ea.l0.color.foregroundDimmer,ea.l0.borderRadius(0),ea.l0.height("100%"),ea.l0.py(8),ea.l0.px(12),{"> div":ea.l0.rowWithGap(4)}]}),l7=function(e){var t=e.css,n=e.size,r=(0,rh._)(e,["css","size"]);return(0,C.tZ)(ty.Tg,{background:"default",children:(0,C.tZ)(or.hU,(0,w._)((0,b._)({css:[l9.base,t]},r),{size:void 0===n?12:n}))})},ce=(0,n1.X)({root:[ea.l0.display.flex,(0,nd._)({},ea.nC.max(550,l3),[ea.l0.display.none])]});function ct(e){var t=e.children;return(0,C.tZ)(er.G,{css:ce.root,children:t})}var cn=n(21262),cr=n(71440),ci=n(58995);function co(){var e=(0,cn._)(["\n  query StatusBarGhostwriterCompleteCodeStatus {\n    currentUser {\n      id\n      userSubscriptionType\n    }\n  }\n"]);return co=function(){return e},e}var ca={},cl=(0,cr.Ps)(co()),cc=(0,n1.X)({roundedContainer:[{borderBottomLeftRadius:ea.TV.space6}],featureHeader:[ea.l0.rowWithGap(8),ea.l0.align.center],popover:[ea.l0.p(8),ea.l0.borderRadius(8),ea.l0.maxWidth(260),ea.l0.colWithGap(8)],featureTitle:[ea.l0.rowWithGap(4),ea.l0.align.center,ea.l0.flex.growAndShrink(1),ea.l0.fontWeight.medium],enableAutocomplete:[ea.l0.rowWithGap(4),ea.l0.align.center],text:[ea.l0.colWithGap(8)],hint:[ea.l0.rowWithGap(4),ea.l0.align.center]});function cs(e){var t=(0,J.useId)();return(0,C.BX)(ty.Tg,{css:cc.popover,children:[(0,C.BX)(er.G,{css:cc.featureHeader,children:[(0,C.BX)(er.G,{css:cc.featureTitle,children:[(0,C.tZ)(l1.Z,{color:ea.TV.blurpleDefault}),(0,C.tZ)(n0.xv,{children:"AI Autocomplete"})]}),(0,C.BX)(er.G,{css:cc.enableAutocomplete,children:[(0,C.tZ)(er.G,{tag:"label",htmlFor:t,children:(0,C.tZ)(n0.xv,{color:"dimmer",variant:"small",children:"Enable"})}),(0,C.tZ)(l$.X,{id:t,checked:e.checked,onChange:e.onChange})]})]}),(0,C.BX)(er.G,{css:cc.text,children:[(0,C.tZ)(n0.xv,{color:"dimmer",variant:"small",children:"Suggest lines of code as you type based on existing context."}),(0,C.BX)(er.G,{css:cc.hint,children:[(0,C.tZ)(n0.xv,{color:"dimmer",variant:"small",children:"Press"}),(0,C.tZ)(oh.bM,{small:!0,keyCombo:"Tab"}),(0,C.tZ)(n0.xv,{color:"dimmer",variant:"small",children:"to accept result"})]})]})]})}var cu=function(e){var t,n,r,i,o,a,l=e.rounded,c=void 0===l||l,s=(0,B.Gn)("codeSuggestion"),u=s.preferences.codeSuggestion,d=s.update,f=(0,Z._)((0,l4.KO)(lK.t),1)[0],h=(0,J.useRef)(!0),p=(0,l2.o)("ai-code-completion"),m=(t=(0,b._)({},ca,void 0),ci.a(cl,t)),v=m.data,g=m.loading,y=null==v?void 0:v.currentUser,w=(null==y?void 0:y.userSubscriptionType)===l8.HP.HackerPro,x=(0,J.useRef)(null),S=!p.isDone&&!w,k=(0,J.useRef)(!1),_=(0,lY.d)({onOpenChange:function(e){if(e){k.current=!0;return}setTimeout(function(){k.current=!1}),S&&p.setAsDone()}}),E=(0,es.uN)();r=(n={view:E,effect:lJ.OK,skip:!S}).view,i=n.skip,o=n.effect,a=(0,o2.Z)(function(e,t){var n=t.startState.field(lJ.WF),r=t.state.field(lJ.WF);!n.presented&&r.presented&&(h.current=!1,_.open())}),(0,J.useEffect)(function(){if(r&&!i){var e=new ek.F6,t=eR.tk.updateListener.of(function(e){(0,eD.j)(e,o,function(t){return a.current(t,e)})});return r.dispatch({effects:ek.Py.appendConfig.of(e.of(t))}),function(){r.dispatch({effects:e.reconfigure([])})}}},[r,i,a,o]);var T=(0,o2.Z)(_);(0,J.useEffect)(function(){f.tooltipOpen&&(null==E?void 0:E.hasFocus)&&(h.current=!1,T.current.open())},[f.tooltipOpen,E,T]);var R=(0,C.tZ)(n2.Z,{color:u?ea.TV.blurpleDefault:void 0});return g||p.isLoading?(0,C.BX)(C.HY,{children:[(0,C.tZ)(ct,{children:(0,C.tZ)(lj,{disabled:!0,text:"AI",iconLeft:R,css:c&&cc.roundedContainer})}),(0,C.tZ)(l6,{children:(0,C.tZ)(l7,{disabled:!0,alt:"AI",css:c&&cc.roundedContainer,children:R})})]}):(0,C.BX)(C.HY,{children:[(0,C.BX)(er.G,{innerRef:x,children:[(0,C.tZ)(ct,{children:(0,C.tZ)(lj,{text:"AI",iconLeft:R,css:c&&cc.roundedContainer,onClick:function(){k.current||_.open()}})}),(0,C.tZ)(l6,{children:(0,C.tZ)(l0.u,{tooltip:"AI",placement:"top-start",children:(0,C.tZ)(l7,{alt:"AI",css:c&&cc.roundedContainer,onClick:function(){k.current||_.open()},children:R})})})]}),_.isOpen?(0,C.tZ)(lQ.Bf,{placement:"top left",background:"default",triggerRef:x,onOpenChange:_.setOpen,isOpen:_.isOpen,children:(0,C.tZ)(lQ.Vq,{role:"dialog","aria-label":"AI Autocomplete",children:(0,C.tZ)(cs,{onChange:function(){d({codeSuggestion:!u}),(0,e6.j)(e6.U3.CODE_SUGGESTION_TOGGLED,{enabled:!u,source:"editor_footer"})},checked:u})})}):null]})},cd=n(10044),cf=n(27783);function ch(e,t,n){var r=[],i=0,o=!0,a=!1,l=void 0;try{for(var c,s=e.iterLines()[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,d=i;if(i=i+u.length+1,0!==u.length){var f=(0,cf.L)(u,t),h=u.trimStart(),p=d+(u.length-h.length);if(0!==f&&d!==p){var m="";if(n===cd.Q.TABS){var v=Math.floor(f/t),g=f%t;m="	".repeat(v)+" ".repeat(g)}else n===cd.Q.SPACES&&(m=" ".repeat(f));m+h!==u&&r.push({from:d,to:p,insert:m})}}}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return ek.as.of(r,e.length)}var cp=n(17907),cm=n(68514),cv=n(37109),cg=n(37951),cy=n(26),cb=n(73722),cw=n(58003),cZ=n(2532),cx=n(81662),cC=(0,n1.X)({surface:[ea.l0.height("100%")],cursorOverlay:{cursor:"pointer"},menu:[ea.l0.p(8),ea.l0.colWithGap(8),ea.l0.maxWidth(410)],close:[ea.l0.position.absolute,ea.l0.top(4),ea.l0.right(4)],file:[ea.l0.pl(4),ea.l0.display.inlineFlex,ea.l0.rowWithGap(4),ea.l0.align.center,{verticalAlign:"top"}],space:[ea.l0.width(2),ea.l0.color.foregroundDimmer,ea.l0.textAlign.center],section:[ea.l0.rowWithGap(8),ea.l0.align.center,ea.l0.justify.spaceBetween],header:[ea.l0.colWithGap(2),ea.l0.flex.shrink(1)],selects:[ea.l0.rowWithGap(4)],sizeInput:{border:"none"},buttonsGroup:[ea.l0.rowWithGap(8),ea.l0.align.center,ea.l0.justify.spaceBetween],saveButtons:[ea.l0.rowWithGap(4)]});function cS(e){var t,n=e.path,r=e.openSettings,i=(0,B.Gn)("indentDetection","indentSize").preferences,o=(0,es.uN)(),a=(0,G.IK)(o,iw.o),l=null!==a&&!!i.indentDetection&&a,c=(0,G.IK)(o,cp.K_),s=(0,G.IK)(o,cp.E2),u=(0,G.IK)(o,cp.vO),d=null!==(t=(0,G.IK)(o,ek.yy.tabSize))&&void 0!==t?t:i.indentSize,f="	"===(0,G.IK)(o,S.c)?cd.Q.TABS:cd.Q.SPACES,h=(0,Z._)((0,J.useState)(!1),2),p=h[0],m=h[1],v=(0,Z._)((0,J.useState)(f),2),g=v[0],y=v[1],k=(0,Z._)((0,J.useState)(d),2),_=k[0],E=k[1],T=(0,Z._)((0,J.useState)(!1),2),R=T[0],I=T[1],D=(0,Z._)((0,J.useState)(!1),2),P=D[0],A=D[1],L=(0,Z._)((0,J.useState)(!1),2),U=L[0],O=L[1],M=(0,Z._)((0,J.useState)(!1),2),X=M[0],F=M[1];(0,J.useEffect)(function(){R||(y(f),E(d))},[f,d,R]),(0,J.useEffect)(function(){p||(y(f),E(d),I(!1))},[p,f,d]),(0,J.useEffect)(function(){g===f&&_===d&&I(!1)},[g,_,f,d]),(0,J.useEffect)(function(){if(P||U||X){var e=setTimeout(function(){A(!1),O(!1),F(!1)},1e3);return function(){return clearTimeout(e)}}},[P,U,X]),l&&p&&m(!1);var W=(0,J.useCallback)(function(){if(o){var e=ch(o.state.doc,d,f);o.dispatch({changes:e,effects:cp.Fm.of(!0)}),O(!0)}},[o,f,d]),H=(0,J.useCallback)(function(){o&&(o.dispatch({effects:cp.Fm.of(!0)}),o.state.field(cp.E2)&&o.dispatch({effects:cp.O4.of({type:void 0,size:void 0})}),F(!0))},[o]),V=(0,J.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(o){var t=void 0,n=[cp.O4.of({type:g,size:_})];if(e){if(g!==f&&(t=ch(o.state.doc,d,g)),g===cd.Q.SPACES&&_!==d){var r=function(e,t,n,r){if(t===cd.Q.TABS)return ek.as.empty(e.length);var i=" ".repeat(r),o=[],a=0,l=!0,c=!1,s=void 0;try{for(var u,d=e.iterLines()[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value,h=a;if(a=a+f.length+1,0!==f.length){var p=(0,cf.L)(f,n),m=f.trimStart(),v=h+(f.length-m.length);if(0!==p&&h!==v){var g=Math.floor(p/n),y=p%n,b=i.repeat(g)+" ".repeat(y);b+m!==f&&o.push({from:h,to:v,insert:b})}}}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}return ek.as.of(o,e.length)}(t?t.apply(o.state.doc):o.state.doc,g,d,_);t=t?t.compose(r):r}t&&n.push(cp.Fm.of(!0))}o.dispatch({changes:t,effects:n}),I(!1),A(!0)}},[o,f,d,g,_]),z=(0,J.useCallback)(function(){m(!1),r()},[r]),j=(0,J.useMemo)(function(){if(s){var e=s.size,t=s.type===cd.Q.SPACES?"spaces":"tabs";return"This file appears to use a unit of ".concat(e," ").concat(t,".")}return u?"Indentation detection hasn't been run on this file yet.":"This file is too small for indentation detection."},[s,u]),q=(0,J.useMemo)(function(){var e=[ea.l0.p(4),ea.l0.rowWithGap(4),ea.l0.align.center,ea.l0.borderRadius(0)];return p?(e.push({pointerEvents:"none"}),e.unshift(te.gU.filled)):e.unshift(te.gU.nofill),(0,e7.iv)(e)},[p]);return(0,C.BX)(lQ.xo,{label:"File indentation",placement:"top",isOpen:p,onOpenChange:m,children:[function(e){return(0,C.tZ)(l0.u,{tooltip:"File indentation",isDisabled:p,children:(0,C.tZ)("div",{css:cC.cursorOverlay,children:(0,C.BX)(er.K.button,(0,w._)((0,b._)({},e),{ref:e.ref,css:q,children:[(0,C.tZ)(c_,{type:f,loading:l}),(0,C.tZ)(cE,{type:f,size:d,loading:l})]}))})})},(0,C.BX)(er.G,{css:cC.menu,children:[(0,C.tZ)(er.G,{css:cC.close,children:(0,C.tZ)(or.hU,{alt:"Close",onClick:function(){return m(!1)},children:(0,C.tZ)(r4.Z,{})})}),(0,C.BX)(n0.h4,{level:1,children:["Indentation for",(0,C.BX)("span",{css:cC.file,children:[(0,C.tZ)(N.Z,{path:n,size:16})," ",(0,C.tZ)("span",{children:(0,K.UO)(n)})]})]}),c?(0,C.tZ)(cg.E,{colorway:"warning",icon:(0,C.tZ)(of.Z,{}),text:"This file type requires that ".concat(c===cd.Q.SPACES?"spaces":"tabs"," be used for indentation.")}):null,(0,C.tZ)(cm.R,{}),(0,C.BX)(er.G,{css:cC.section,children:[(0,C.BX)(er.G,{css:cC.header,children:[(0,C.tZ)(n0.xv,{multiline:!1,children:"Indentation unit"}),(0,C.tZ)(n0.xv,{variant:"small",color:"dimmer",children:"The size and character to use when indenting lines."})]}),(0,C.BX)(er.G,{css:cC.selects,children:[(0,C.tZ)(cx.qm,{css:cC.sizeInput,size:_,onChange:function(e){e!==_&&(E(e),I(!0))}}),(0,C.tZ)(cv.P,{items:(0,x._)(cx.Ly),selectedItem:cx.Ly.find(function(e){return e.value===(g===cd.Q.SPACES?"spaces":"tabs")}),onChange:function(e){var t=(null==e?void 0:e.value)==="spaces"?cd.Q.SPACES:cd.Q.TABS;t!==g&&(y(t),I(!0))}})]})]}),(0,C.tZ)(cm.R,{}),i.indentDetection?(0,C.BX)(C.HY,{children:[(0,C.BX)(er.G,{css:cC.section,children:[(0,C.BX)(er.G,{css:cC.header,children:[(0,C.tZ)(n0.xv,{multiline:!1,children:"Detected indentation unit"}),(0,C.tZ)(n0.xv,{variant:"small",color:"dimmer",children:j})]}),X?(0,C.tZ)(on.zx,{colorway:"positive",text:"Detected!",iconLeft:(0,C.tZ)(aC.Z,{}),onClick:H}):(0,C.tZ)(on.zx,{text:s?"Re-detect":"Detect",iconLeft:(0,C.tZ)(cb.Z,{}),disabled:!u&&!s,onClick:H})]}),(0,C.tZ)(cm.R,{})]}):null,(0,C.BX)(er.G,{css:cC.buttonsGroup,children:[(0,C.tZ)(on.zx,{text:"Global settings",iconLeft:(0,C.tZ)(cw.Z,{}),onClick:z}),(0,C.tZ)(er.G,{css:cC.saveButtons,children:P||U?(0,C.tZ)(C.HY,{children:P?(0,C.tZ)(on.zx,{text:"Saved!",colorway:"positive",iconLeft:(0,C.tZ)(aC.Z,{}),onClick:function(){return V(!1)}}):(0,C.tZ)(on.zx,{text:"Re-indented!",colorway:"positive",iconLeft:(0,C.tZ)(aC.Z,{}),onClick:W})}):(0,C.tZ)(C.HY,{children:R?(0,C.BX)(C.HY,{children:[(0,C.tZ)(on.zx,{text:"Save and re-indent",colorway:"primary",iconLeft:(0,C.tZ)(cZ.Z,{}),onClick:function(){return V(!0)}}),(0,C.tZ)(on.zx,{text:"Save",iconLeft:(0,C.tZ)(aC.Z,{}),onClick:function(){return V(!1)}})]}):(0,C.tZ)(on.zx,{text:"Re-indent file",iconLeft:(0,C.tZ)(cZ.Z,{}),onClick:W})})})]})]})]})}function ck(e){var t=e.size,n=void 0===t?16:t,r=(0,rh._)(e,["size"]);return(0,C.tZ)(cy.Z,(0,w._)((0,b._)({size:n},r),{children:(0,C.tZ)("circle",{cx:n,cy:n,r:n/2,fillRule:"evenodd"})}))}function c_(e){var t=e.type;return e.loading?(0,C.tZ)(H.Z,{size:12}):t===cd.Q.SPACES?(0,C.tZ)(ck,{color:ea.TV.foregroundDimmer,size:12}):(0,C.tZ)(cZ.Z,{color:ea.TV.foregroundDimmer,size:12})}function cE(e){var t=e.type,n=e.size;if(e.loading)return(0,C.tZ)(n0.xv,{variant:"small",color:"dimmest",children:"Detecting..."});var r=t===cd.Q.SPACES?"Spaces":"Tabs";return(0,C.BX)(n0.xv,{variant:"small",color:"dimmer",children:[r,": ",n]})}var cT=n(31405),cR=(0,n1.X)({iconButtonToggled:[ea.l0.backgroundColor.accentPrimaryDimmer,{"&&:hover":[ea.l0.backgroundColor.accentPrimaryDefault]}]});function cI(){var e=(0,es.uN)(),t=(0,G.IK)(e,nU);if(!e||!t||null===t.head)return null;var n=t.mode===f.INLINE_DIFF,r=function(){e.dispatch({effects:nL.of(n?f.GUTTER_DIFF:f.INLINE_DIFF)})};return(0,C.BX)(C.HY,{children:[(0,C.tZ)(ct,{children:(0,C.tZ)(lj,{text:n?"Diffing":"Diff",colorway:n?"primary":void 0,iconLeft:(0,C.tZ)(cT.Z,{}),onClick:r})}),(0,C.tZ)(l6,{children:(0,C.tZ)(l0.u,{tooltip:"Toggle Diff",placement:"top-start",children:(0,C.tZ)(l7,{css:n&&cR.iconButtonToggled,alt:"Toggle Diff",onClick:r,colorway:n?"primary":void 0,children:(0,C.tZ)(cT.Z,{color:n?iv.TV.foregroundDefault:void 0})})})})]})}var cD=n(73164),cG=n(11718),cB=n(49615),cP=n(11470),cA=n(90648),cN=n(44471),cL=(0,n1.X)({surface:[ea.l0.height("100%")],cursorOverlay:{cursor:"pointer"},menu:[ea.l0.p(8),ea.l0.colWithGap(8),ea.l0.maxWidth(390),ea.l0.minWidth(390)],close:[ea.l0.position.absolute,ea.l0.top(4),ea.l0.right(4)],file:[ea.l0.pl(4),ea.l0.display.inlineFlex,ea.l0.rowWithGap(4),ea.l0.align.center,{verticalAlign:"top"}],space:[ea.l0.width(2),ea.l0.color.foregroundDimmer,ea.l0.textAlign.center],section:[ea.l0.rowWithGap(8),ea.l0.align.center,ea.l0.justify.spaceBetween],header:[ea.l0.colWithGap(2),ea.l0.flex.shrink(1)],selects:[ea.l0.rowWithGap(4)],sizeInput:{border:"none"},buttonsGroup:[ea.l0.rowWithGap(8),ea.l0.align.center,ea.l0.justify.spaceBetween],saveButtons:[ea.l0.rowWithGap(4)],red:[ea.l0.color.redDefault],row:[ea.l0.rowWithGap(8),ea.l0.align.center],staticWidth:[ea.l0.flex.grow(0),ea.l0.flex.shrink(1)],variableWidth:[ea.l0.flex.grow(1),ea.l0.flex.shrink(0),{flexBasis:0}],flexEnd:[ea.l0.align.end]});function cU(e){var t,n=(0,es.uN)(),r=null==n?void 0:null===(t=n.state)||void 0===t?void 0:t.facet(eA.Yp);return r?(0,C.tZ)(cO,{fileName:r,openSettings:e.openSettings}):null}function cO(e){var t=e.fileName,n=e.openSettings,r=(0,tG.Z)(),i=r.dotReplit,o=r.lspnix,a=(0,B.Gn)("codeIntelligence").preferences.codeIntelligence,l=(0,es.uN)(),c=(0,Z._)((0,J.useState)(!1),2),s=c[0],u=c[1],d=(0,t8.Z)(t)[0],f=(0,Z._)((0,J.useState)(null==d?void 0:d.getServerState()),2),h=f[0],p=f[1],m=(0,Z._)((0,J.useState)(null==d?void 0:d.getServerHealth()),2),v=m[0],g=m[1],y=(0,Z._)((0,J.useState)(!1),2),x=y[0],S=y[1],k=(0,J.useMemo)(function(){var e=[ea.l0.p(4),ea.l0.borderRadius(0),ea.l0.align.center,ea.l0.rowWithGap(4)];return s?(e.unshift(te.gU.filled),e.push({pointerEvents:"none"})):e.unshift(te.gU.nofill),(0,e7.iv)(e)},[s]),_=(0,G.IK)(l,eA.Q$),E=(0,J.useMemo)(function(){var e,n,r,i;return(r=null===(e=cD.$R.from(t))||void 0===e?void 0:e.name)?r:(r=null==_?void 0:null===(n=_.language)||void 0===n?void 0:n.name)&&r.length>0?(i=r).slice(0,1).toUpperCase()+i.slice(1).toLowerCase():(r=(0,K.r6)(t),_)?r:"Plain Text"},[t,_]),T=(0,J.useMemo)(function(){if(!a)return 6;if(null!==d&&v===il.N.STALLED)return 3;var e=null!=d&&v===il.N.READY;return x||h===il.a.INITIALIZING||h===il.a.INITIALIZED&&!e?0:e?1:h===il.a.EXITED?2:null!==_?4:5},[d,x,_,v,h,a]),I=(0,J.useCallback)(function(){a&&(o.disable(),o.enable(),S(!0))},[o,a]);(0,J.useEffect)(function(){if(d)return S(!1),p(d.getServerState()),g(d.getServerHealth()),(0,ip.uf)([d.onServerStateChange(function(e){p(e)}),d.onServerHealthChange(function(e){g(e)})])},[d]);var D=(0,G.IK)(l,t0.i5),P=(0,G.IK)(l,t0.dt),A=(0,Z._)((0,J.useState)(D?{title:D.name,value:D.id}:void 0),2),L=A[0],U=A[1],O=(0,J.useRef)(!1),M=(0,J.useMemo)(function(){var e;return null!==(e=null==P?void 0:P.map(function(e){return{title:e.name,value:e.id,icon:void 0}}))&&void 0!==e?e:[]},[P]);(0,J.useEffect)(function(){O.current||(null==L?void 0:L.value)===(null==D?void 0:D.id)||U(D?{title:D.name,value:D.id}:void 0)},[L,D]);var X=(0,Z._)((0,J.useState)(!1),2),F=X[0],W=X[1],V=(0,l2.e)("prettier-formatter");return(0,J.useEffect)(function(){var e,t=null!==(e=null==l?void 0:l.plugin(G.pE))&&void 0!==e?e:null;if(l&&t&&!t.destroyed){var n=null,r=t.bind({changed:function(e){return(0,eL.a)(e,R.pm)},callback:function(e){V.isDone||(n&&"Prettier"===n.name&&(W(!0),u(!0),V.setAsDone()),n=e.state.facet(R.pm))}});return function(){return r()}}},[V,l]),(0,C.BX)(lQ.xo,{label:"Language support",placement:"top",isOpen:s,onOpenChange:function(e){u(e),F&&W(!1)},children:[function(e){return(0,C.tZ)(l0.u,{tooltip:"Language support",isDisabled:s,children:(0,C.tZ)("div",{css:cL.cursorOverlay,children:(0,C.BX)(er.K.button,(0,w._)((0,b._)({},e),{css:k,children:[(0,C.tZ)(cW,{state:T}),(0,C.tZ)(cM,{text:E,color:"dimmer",variant:"small"})]}))})})},(0,C.BX)(er.G,{css:cL.menu,children:[(0,C.tZ)(er.G,{css:cL.close,children:(0,C.tZ)(or.hU,{alt:"Close",onClick:function(){return u(!1)},children:(0,C.tZ)(r4.Z,{})})}),(0,C.BX)(n0.h4,{level:1,children:["Language support for ",(0,C.BX)("span",{css:cL.file,children:[(0,C.tZ)(N.Z,{path:t,size:16})," ",(0,C.tZ)("span",{children:(0,K.UO)(t)})]})]}),(0,C.tZ)(cm.R,{}),(0,C.tZ)(cF,{client:d,restart:I,state:T,openSettings:n,filePath:t}),P&&L?(0,C.BX)(C.HY,{children:[(0,C.tZ)(cm.R,{}),(0,C.BX)(er.G,{css:cL.section,children:[(0,C.tZ)(er.G,{css:[cL.header,cL.staticWidth],children:(0,C.tZ)(n0.xv,{multiline:!1,children:"Code Formatter"})}),1===P.length?(0,C.tZ)(er.G,{css:[cL.header,cL.variableWidth,cL.flexEnd],children:(0,C.tZ)(n0.xv,{multiline:!1,children:L.title})}):(0,C.tZ)(er.G,{css:cL.selects,children:(0,C.tZ)(cv.P,{placement:"top",items:M,selectedItem:(0,w._)((0,b._)({},L),{icon:O.current?(0,C.tZ)(H.Z,{size:12}):void 0}),disabled:O.current,onChange:function(e){e.value!==L.value&&(O.current=!0,U(e),(function(e,t){return cH.apply(this,arguments)})(i,{path:t,formatterId:e.value}).finally(function(){return O.current=!1}))}})})]}),F?(0,C.tZ)(er.G,{css:cL.section,children:(0,C.tZ)(cg.E,{text:"".concat(L.title," was used to format this file. ").concat(P.length>1?"You can change your code formatter with the dropdown above.":""),closable:!0,closeAction:function(){return W(!1)}})}):null]}):null]})]})}function cM(e){var t=e.text,n=(0,rh._)(e,["text"]);return(0,C.tZ)(n0.xv,(0,w._)((0,b._)({},n),{children:t}))}function cX(e){var t=(0,C.tZ)("a",{tabIndex:0,role:"button",onClick:e.restart,onKeyDown:function(t){"Enter"===t.key&&e.restart()},children:"Restart"});switch(e.state){case 0:return(0,C.tZ)(n0.xv,{multiline:!1,color:"dimmer",children:"Loading"});case 1:return(0,C.tZ)(n0.xv,{multiline:!1,color:"dimmer",children:"Active"});case 3:return(0,C.BX)(er.G,{css:cL.row,children:[(0,C.tZ)(n0.xv,{css:cL.red,multiline:!1,children:"Stalled"})," ",t]});case 2:return(0,C.BX)(er.G,{css:cL.row,children:[(0,C.tZ)(n0.xv,{css:cL.red,multiline:!1,children:"Stopped"})," ",t]});default:return null}}function cF(e){var t=function(){switch(e.state){case 0:case 1:case 2:case 3:return(0,C.BX)(C.HY,{children:[(0,C.tZ)(er.G,{css:[cL.header,cL.variableWidth],children:(0,C.tZ)(n0.xv,{multiline:!1,children:e.client?e.client.clientName:"Language Server for ".concat(e.filePath)})}),(0,C.tZ)(er.G,{css:[cL.header,cL.staticWidth],children:(0,C.tZ)(cX,{restart:e.restart,state:e.state})})]});case 5:case 4:return(0,C.tZ)(er.G,{css:cL.header,children:(0,C.tZ)(n0.xv,{color:"dimmer",children:"Limited language support because the language server is not available."})});case 6:return(0,C.tZ)(er.G,{css:cL.header,children:(0,C.BX)(n0.xv,{multiline:!0,color:"dimmer",children:["Code intelligence is disabled. Enable it in settings.",(0,C.tZ)("br",{}),(0,C.tZ)("a",{tabIndex:0,role:"button",onClick:e.openSettings,onKeyDown:function(t){"Enter"===t.key&&e.openSettings()},children:"Open settings"})]})});default:return null}}();return t?(0,C.BX)(er.G,{css:cL.section,children:[" ",t," "]}):null}function cW(e){switch(e.state){case 3:case 6:case 4:return(0,C.tZ)(cA.Z,{size:16});case 0:return(0,C.tZ)(H.Z,{size:16,color:ea.TV.blueStronger});case 1:return(0,C.tZ)(er.G,{dataCy:"ws-code-intelligence-active",children:(0,C.tZ)(cB.Z,{size:16})});case 2:return(0,C.tZ)(cP.Z,{size:16});case 5:return(0,C.tZ)(cG.Z,{size:16})}}function cH(){return(cH=(0,e_._)(function(e,t){var n,r;return(0,eT.Jh)(this,function(i){return(n=".".concat((0,cN.mD)(t.path)),r="rules/formatter/fileExtensions/".concat(n,"/id"),t.formatterId)?[2,e.updateDotReplit([{path:"rules/formatter/fileExtensions",op:"add",value:JSON.stringify((0,nd._)({},"".concat(n),{id:t.formatterId}))}])]:[2,e.updateDotReplit([{path:r,op:"remove"}])]})})).apply(this,arguments)}function cV(e){if(e.facet(iw.o))return"";var t=e.selection,n="",r=0;if(t.ranges.length>1){r=t.ranges.reduce(function(e,t){return e+(t.to-t.from)},0);var i=t.ranges.length;n="".concat(i," selections")}else{var o=t.ranges[0],a=e.doc.lineAt(o.head),l=o.head-a.from;r=o.to-o.from,n="Ln ".concat(a.number,", Col ").concat(l+1)}return r>0&&(n+=" (".concat(r," chars)")),n}function cz(){var e,t=(0,J.useRef)(null),n=(0,es.uN)();return(0,J.useEffect)(function(){var e,r=t.current,i=null!==(e=null==n?void 0:n.plugin(G.pE))&&void 0!==e?e:null;if(r&&n&&i&&!i.destroyed){var o=null,a=n.state;r.textContent=cV(a);var l=i.bind({changed:function(e){return(0,eL.a)(e,"selection",iw.o)},callback:function(e){a=e.state,null===o&&(o=requestAnimationFrame(function(){o=null,r.textContent=a?cV(a):""}))}});return function(){l(),null!==o&&cancelAnimationFrame(o),r.textContent=""}}},[n]),!n&&(null===(e=t.current)||void 0===e?void 0:e.textContent)&&(t.current.textContent=""),(0,J.useMemo)(function(){return(0,C.tZ)(lj,{text:(0,C.tZ)("span",{ref:t,"data-cy":"current-position"}),css:[ea.l0.color.foregroundDimmest],onClick:n?function(){return(0,o1.zo)(n)}:void 0})},[n])}(u=y||(y={}))[u.Loading=0]="Loading",u[u.Ready=1]="Ready",u[u.Exited=2]="Exited",u[u.Stalled=3]="Stalled",u[u.Partial=4]="Partial",u[u.Missing=5]="Missing",u[u.Disabled=6]="Disabled";var cj=n(99418),cq=(0,n1.X)({rounded:[{borderBottomRightRadius:iv.TV.space6}]});function cY(e){var t=e.onOpen,n=e.rounded;return(0,C.tZ)(lj,{text:"History",iconRight:(0,C.tZ)(F.Z,{size:12}),onClick:function(){(0,cj.p)("historyOpened"),t()},css:(void 0===n||n)&&cq.rounded})}var cJ=n(73157),cK=n(70210),c$=n(34581),cQ=(0,n1.X)({group:[ea.l0.align.center,ea.l0.rowWithGap(4)],row:[ea.l0.align.center,ea.l0.rowWithGap(8)]});function c0(){var e,t=(0,es.uN)(),n=null==t?void 0:null===(e=t.state)||void 0===e?void 0:e.facet(eA.Yp);return n?(0,C.tZ)(c1,{fileName:n}):null}function c1(e){var t,n,r,i,o,a,l=e.fileName,c=(0,es.uN)(),s=(n=(t=(0,Z._)((0,J.useState)(null),2))[0],r=t[1],i=(0,t8.Z)(l),o=(0,c$.nC)(),a=(0,q.dr)(),(0,J.useEffect)(function(){var e=function(e){var t,n=o().find(function(e){var t=(0,Z._)(e,2);return"problems"===(t[0],t[1]).type});if(n){var r=a(n[0]);r&&"problems"===r.type&&(null===(t=r.updateProblems)||void 0===t||t.call(r,l,e))}},t=function(t){if(t.path===l){var n=[],o=!0,a=!1,c=void 0;try{for(var s,u=i[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var d=s.value;d.isOpen(l)&&n.push.apply(n,(0,x._)(d.getDiagnostics(t.path)))}}catch(e){a=!0,c=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw c}}r(n),e(n)}},n=[],c=!0,s=!1,u=void 0;try{for(var d,f=i[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var h=d.value;h.isOpen(l)&&n.push.apply(n,(0,x._)(h.getDiagnostics(l)))}}catch(e){s=!0,u=e}finally{try{c||null==f.return||f.return()}finally{if(s)throw u}}r(n),e(n);var p=[],m=!0,v=!1,g=void 0;try{for(var y,b=i[Symbol.iterator]();!(m=(y=b.next()).done);m=!0){var w=y.value;p.push(w.onDiagnostics(function(e){return t(e)}))}}catch(e){v=!0,g=e}finally{try{m||null==b.return||b.return()}finally{if(v)throw g}}return function(){p.forEach(function(e){return e()}),o().some(function(e){var t=(0,Z._)(e,2),n=(t[0],t[1]);return"codeEditor"===n.type&&n.data.path===l})||e([])}},[i,l,o,a]),n),u=(0,J.useMemo)(function(){var e;return s?(e=s.reduce(function(e,t){return void 0===t.severity||(e[t.severity]=(e[t.severity]||0)+1),e},{}),s.length>0&&0===Object.keys(e).length&&(e[e4.DiagnosticSeverity.Error]=s.length),e):null},[s]);if(!u)return null;var d=u[e4.DiagnosticSeverity.Error]||0,f=u[e4.DiagnosticSeverity.Warning]||0,h="";return 0===d&&0===f&&(h="No problems"),d>0&&(h+="".concat((0,cJ.Z)("Error",d),": ").concat(d)),f>0&&(h.length>0&&(h+=", "),h+="".concat((0,cJ.Z)("Warning",f),": ").concat(f)),(0,C.tZ)(l0.u,{tooltip:h,children:(0,C.tZ)(lj,{text:(0,C.BX)(er.G,{css:cQ.row,children:[(0,C.BX)(er.G,{css:cQ.group,children:[(0,C.tZ)(cK.Z,{severity:e4.DiagnosticSeverity.Error,size:12}),(0,C.tZ)(n0.xv,{color:"dimmer",variant:"small",multiline:!1,children:String(d)})]}),(0,C.BX)(er.G,{css:cQ.group,children:[(0,C.tZ)(cK.Z,{severity:e4.DiagnosticSeverity.Warning,size:12}),(0,C.tZ)(n0.xv,{color:"dimmer",variant:"small",multiline:!1,children:String(f)})]})]}),disabled:!c,onClick:c?function(){return(0,nj.C)(c)}:void 0})})}var c2=n(85621),c8=(0,n1.X)({text:[{textTransform:"capitalize"}]});function c4(){var e,t,r,i,o=(0,Z._)((0,J.useState)(null),2),a=o[0],l=o[1],c=(0,J.useRef)(null),s=(0,es.uN)(),u=(0,B.Gn)("keyboardHandler").preferences,d=(null==u?void 0:u.keyboardHandler)==="vim",f=(0,J.useCallback)(function(e){if(c.current){var t=null!=e?e:"";if(s&&a&&void 0===e){var n,r,i=a.getCM(s);t=null!==(r=null==i?void 0:null===(n=i.state.vim)||void 0===n?void 0:n.mode)&&void 0!==r?r:"normal"}c.current.innerText!==t&&(c.current.innerText=t||"")}},[s,a]);return(0,J.useEffect)(function(){d&&!a&&n.e(9383).then(n.bind(n,62843)).then(function(e){l(e),f()})},[d,a,f]),e=[f,d,a],t="ModeStatus",r=(0,Z._)((0,J.useState)(function(){return new ek.F6}),1)[0],i=(0,o2.Z)(function(){return d&&a?eR.tk.updateListener.of(function(){setTimeout(function(){f()},0)}):(f(null),null)}),(0,J.useEffect)(function(){if(s){var e=i.current();if(e){var n=void 0===r.get(s.state)?ek.Py.appendConfig.of(r.of(e)):r.reconfigure(e);try{s.dispatch({effects:n})}catch(e){(0,eR.OO)(s.state,e,t)}return function(){try{s.dispatch({effects:r.reconfigure([])})}catch(e){(0,eR.OO)(s.state,e,t)}}}}},[s,r,i,t].concat((0,x._)(e))),(0,C.tZ)(C.HY,{children:d?(0,C.tZ)(lj,{disabled:!0,iconLeft:(0,C.tZ)(c2.Z,{}),text:(0,C.tZ)("span",{css:c8.text,ref:c})}):null})}var c3=(0,n1.X)({root:[ea.l0.position.relative,ea.l0.rowWithGap(16),ea.l0.align.center,ea.l0.justify.spaceBetween,ea.l0.backgroundColor.backgroundDefault,ea.l0.container("StatusBar"),{borderTop:"1px solid ".concat(ea.TV.backgroundHigher)},{height:"29px",contain:"strict"}],group:[ea.l0.flex.row,ea.l0.flex.shrink(1),ea.l0.align.center]});function c5(e){var t=e.filePath,n=e.performPaneOperation,r=(0,nM.P5)({controlName:"flag-lsp-diagnostics-in-footer",logFlagToAnalytics:!1}),i=(0,et.d)(),o=(0,lF.ZP)(),a=(0,nM.P5)({controlName:"flag-status-bar-branch",logFlagToAnalytics:!1}),l=(0,nM.P5)({controlName:"flag-editor-git-inline-diff",logFlagToAnalytics:!1}),c=(0,A.T3)()?void 0:{borderBottomLeftRadius:7,borderBottomRightRadius:7},s=(0,P.Z)(function(){return function(){n({operation:"replace",pane:{type:"history",data:{path:t}}})}},[t,n]),u=(0,P.Z)(function(){return function(){n({operation:"open",pane:{type:"preferences"}})}},[n]);return(0,C.BX)(ty.Tg,{css:c3.root,style:c,children:[(0,C.BX)(er.G,{css:c3.group,children:[(0,lF.G_)(o)&&!i?(0,C.tZ)(cu,{}):null,i?null:(0,C.tZ)(cU,{openSettings:u}),!i&&r?(0,C.tZ)(c0,{}):null,a?(0,C.tZ)(lq,{performPaneOperation:n}):null,l?(0,C.tZ)(cI,{}):null,(0,C.tZ)(c4,{})]}),(0,C.BX)(er.G,{css:c3.group,children:[(0,C.tZ)(cz,{}),(0,C.tZ)(cS,{path:t,openSettings:u}),(0,C.tZ)(cY,{onOpen:s,rounded:!i})]})]})}function c6(e){var t=(0,ey.Z)(),n=(0,ev.xZ)(e.filePath),r=(0,eb.Z)(eg.y.Editor),i=(0,en.Z)(),o=e.performPaneOperation,a=(0,J.useCallback)(function(e){return o({operation:"open",pane:e,secondary:!0})},[o]);return(0,C.BX)("div",{ref:r,css:{position:"relative",display:"flex",flexDirection:"column",overflowY:"hidden",height:"100%",width:"100%",boxShadow:"".concat(t?"0 3px 0 3px ".concat(t):"0"),borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"},children:[e.performPaneOperation?(0,C.tZ)(tT,{performPaneOperation:e.performPaneOperation,path:e.filePath}):null,(0,C.BX)("div",{css:lU.ev,children:[(0,C.tZ)(lX,{openPane:a,openFile:e.openFile,openThreadsInbox:e.openThreadsInbox,filePath:e.filePath,autoFocus:e.autoFocus,hideMobileKeyboardToolbar:e.hideMobileKeyboardToolbar,isHidden:e.isHidden,deeplink:e.deeplink,onDeeplinkUpdated:e.onDeeplinkUpdated,performPaneOperation:e.performPaneOperation}),n?(0,C.tZ)(eS,{}):null]}),(0,C.tZ)("div",{css:{display:i?"none":"block"},children:(0,C.tZ)(c5,{filePath:e.filePath,performPaneOperation:e.performPaneOperation})}),e.hideMobileKeyboardToolbar?null:(0,C.tZ)(em,{filePath:e.filePath,isLoading:!1})]})}var c9=n(80259),c7=(0,n1.X)({root:[ea.l0.coverContainer,ea.l0.center,ea.l0.p(16)]});function se(e){var t=e.message;return(0,C.tZ)(er.G,{css:c7.root,children:(0,C.tZ)(er.G,{children:(0,C.tZ)(cg.E,{icon:(0,C.tZ)(of.Z,{}),colorway:"orange",text:t})})})}var st=n(31171),sn=_.Dy.Object({type:_.Dy.Literal("codeEditor"),data:_.Dy.Object({path:_.Dy.Union([_.Dy.String({minLength:1}),_.Dy.Null()]),line:_.Dy.Optional(_.Dy.Number()),col:_.Dy.Optional(_.Dy.Number())})}),sr={Content:function(e){var t=e.pane,n=e.options;return(0,C.tZ)(so,(0,w._)((0,b._)({},t.data),{isActive:n.isActive,isHidden:n.isHidden,performPaneOperation:n.performPaneOperation}))},Icon:function(e){var t=e.pane,n=e.size;return(0,C.tZ)(N.Z,{path:t.data.path||"",size:n})},getTitle:function(e){return e.data.path?(0,K.UO)(e.data.path):"No file open"},decode:function(e){return E.B4.Decode(sn,e)}};function si(e){var t,n,r,i,o,a=e.path,l=e.performPaneOperation,c=(0,es.uN)(),s=(0,P.Z)(function(){return c?{match:c9.pl,data:{type:"action",label:"Toggle all folds",icon:(0,C.tZ)(U.Z,{}),run:function(){0===(0,S.q2)(c.state).size?(0,S.g_)(c):(0,S.jZ)(c)}}}:null},[c]),u=(0,G.IK)(c,T.W),d=(0,G.IK)(c,R.Gz),f=(0,G.IK)(c,R.SD);(0,J.useEffect)(function(){u&&l({operation:"commit"})},[u,l]);var h=(0,P.Z)(function(){return c&&f?d?{type:"action",icon:(0,C.tZ)(H.Z,{}),label:"Formatting...",run:function(){}}:{dataCy:"ws-format-btn",type:"action",icon:(0,C.tZ)(X.Z,{}),label:"Format "+(0,K.UO)(a),run:function(){(0,R.z1)(c)}}:null},[c,f,d,a]),p=(0,t_.Mp)({path:a,performPaneOperation:l}),m=(t=(0,A.T3)(),r=(n=(0,B.Gn)("minimapDisplay")).preferences.minimapDisplay,i=n.update,(0,P.Z)(function(){return t?null:{match:c9.pl,data:{label:"Minimap",icon:(0,C.tZ)(L.Z,{}),type:"context"},commands:function(e){var t=e.active,n=e.search;return t||n?[{value:"none",label:"Hide",icon:(0,C.tZ)(M.Z,{})},{value:"characters",label:"Characters",icon:(0,C.tZ)(W.Z,{})},{value:"blocks",label:"Blocks",icon:(0,C.tZ)(V.Z,{})}].filter(function(e){return e.value!==r}).map(function(e){return{match:c9.pl,data:{type:"action",label:e.label,icon:e.icon,run:function(){i({minimapDisplay:e.value})}}}}):[]}}},[i,r,t])),v=(o=function(){return l({operation:"replace",pane:{type:"history",data:{path:a}}})},(0,P.Z)(function(){return{match:c9.pl,data:{label:"History",icon:(0,C.tZ)(F.Z,{}),type:"action",run:function(){o()}}}},[o]));return(0,q.L5)(function(){var e,t=function(e){return{label:"Preview",icon:(0,C.tZ)(O.Z,{}),type:"action",run:function(){l({operation:"replace",pane:{type:e,data:{path:a}}})}}};if(c){var n=[];return n.push(v),m&&n.push(m),s&&n.push(s),p&&n.push.apply(n,(0,x._)(p)),h&&(e=[h]),(0,K.B4)(a)&&(e=e&&e.length?[e[0],t("media")]:[t("media")]),(0,K.gK)(a)&&(e=e&&e.length?[e[0],t("markdown")]:[t("markdown")]),{type:"codeEditor",actions:e,commands:n,getEditorView:function(){return c},getCurrentSelectionText:function(){if(!c.state.selection.main.empty)return c.state.sliceDoc(c.state.selection.main.from,c.state.selection.main.to)},insertGhostwriterChatCode:function(e,t){(0,I.el)({view:c,insert:e,overwrite:t})},revertGhostwriterChatCode:function(){(0,I.iG)(c)},fetchProblems:function(){var e,t;return(0,k.j)(c),null!==(t=null===(e=c.state.field(D.G0,!1))||void 0===e?void 0:e.flatten())&&void 0!==t?t:[]}}}},[c,h,s,p,m,v,l,a]),(0,q.Wk)(function(){return c},[c]),null}function so(e){var t,n,r,i,o=e.path,a=e.line,l=e.col,c=e.isActive,s=e.isHidden,u=e.performPaneOperation,d=(0,Z._)((0,J.useState)(!s),2),f=d[0],h=d[1];f||s||h(!0);var p=(0,Z._)((0,J.useState)(function(){return(0,Y.MT)()}),1)[0],m=(0,Z._)((0,J.useState)(function(){return(0,Y.MT)()}),1)[0],v=(0,z.useRouter)(),g=!(j().query.embed||j().query.lite)&&!(0,A.Vg)(v)&&c,y=(t=(0,tG.Z)().fs,r=(n=(0,Z._)((0,J.useState)(null),2))[0],i=n[1],(0,J.useEffect)(function(){if(o){if(o.startsWith("/"))return i('Cannot open "'.concat(o,'"')),function(){i(null)};var e=t.watchPathStat(o,{onNewStat:function(e){if(!e.exists){i('No file found at "'.concat(o,'", it may have been deleted'));return}if(e.type===i0.Tv.Directory){i('"'.concat(o,'" is a directory'));return}i(null)},onError:function(){i('Unknown error occured while read "'.concat(o,'", try re-opening the editor'))}});return function(){e(),i(null)}}},[t,o]),r),b=(0,P.Z)(function(){return{line:a,col:l}},[a,l]),w=(0,P.Z)(function(){return function(){u({operation:"replace",pane:{type:"codeEditor",data:{path:o}}})}},[u,o]),x=(0,P.Z)(function(){return function(e){u({operation:"commit"}),u({operation:"open",pane:{type:"codeEditor",data:e}})}},[u]),S=(0,J.useCallback)(function(){u({operation:"open",secondary:!0,pane:{type:"threadInbox"}})},[u]);return o?y?(0,C.tZ)(se,{message:y}):s&&!f?null:(0,C.tZ)(es.Cl.Provider,{value:p,children:(0,C.BX)(st.ox.Provider,{value:m,children:[(0,C.tZ)(c6,{filePath:o,autoFocus:g,isHidden:null!=s&&s,deeplink:b,onDeeplinkUpdated:w,hideMobileKeyboardToolbar:!0,performPaneOperation:u,openFile:x,openThreadsInbox:S},o),(0,C.tZ)(si,{path:o,isActive:c,performPaneOperation:u})]})}):null}},94255:function(e,t,n){n.d(t,{J:function(){return a}});var r=n(74044),i=n(99149),o=r.Dy.Object({type:r.Dy.Literal("commands"),data:r.Dy.Object({autoFocus:r.Dy.Boolean()})}),a=function(e){return i.B4.Decode(o,e)}},13885:function(e,t,n){n.d(t,{R:function(){return ly}});var r,i,o,a,l,c,s,u=n(66626),d=n(74985),f=n(74044),h=n(99149),p=n(56596),m=n(88936),v=n(29287),g=n(50959),y=n(60427),b=n(37996),w=n(27387),Z=n(96583),x=n(50782),C=n(37951),S=n(93918),k=n(45087),_=n(7877),E=n(18514),T=n(58003),R=n(20573),I=n(75582),D=n(1498),G=n(93496),B=n(38080),P=n(50494),A=n(14186),N=(0,S.X)({root:[{borderBottom:"1px solid ".concat(v.TV.outlineDimmest)}],inner:[v.l0.position.relative,{"::before":{content:'""',display:"block",position:"absolute",left:0,width:8,height:"100%",background:"linear-gradient(90deg, ".concat(v.TV.backgroundDefault," 0%, rgba(0,0,0,0) 100%);"),zIndex:1},"::after":{content:'""',display:"block",position:"absolute",right:0,width:8,height:"100%",background:"linear-gradient(270deg, ".concat(v.TV.backgroundDefault," 0%, rgba(0,0,0,0) 100%);"),zIndex:1}}],tabs:[v.l0.flex.row,v.l0.align.center,v.l0.overflowX("auto"),v.l0.pl(8)],tab:[G.gU.nofill,v.l0.borderRadius(0),v.l0.px(12),v.l0.position.relative,{transition:"none",height:38,marginRight:1,"::after":{content:'""',display:"block",position:"absolute",right:-2,width:1,height:16,backgroundColor:v.TV.outlineDimmest},"&:last-child":{marginRight:0,"::after":{display:"none"}}}],dot:[v.l0.position.absolute,v.l0.borderRadius(16),v.l0.width(8),v.l0.height(8),v.l0.backgroundColor.accentPrimaryStronger,{top:8,right:8}]}),L=function(e){var t=e.tabs,n=e.activeView,r=e.onClick,i=(0,P.o)("deployment-analytics-dot"),o=i.isLoading,a=i.isDone;return(0,d.tZ)(B.Tg,{css:N.root,children:(0,d.tZ)(p.G,{css:N.inner,children:(0,d.tZ)(p.G,{css:N.tabs,children:t.map(function(e){return(0,d.BX)(p.G,{css:v.l0.position.relative,children:[(0,d.tZ)(D.zx,{style:{borderBottom:"1px solid "+(n===e.view?v.TV.foregroundDefault:"transparent")},css:N.tab,text:e.label,iconLeft:e.icon,onClick:function(){return r(e)}}),e.view!==A.k.Analytics||o||a?null:(0,d.tZ)(p.G,{css:N.dot})]},e.view)})})})})},U=n(41733),O=n(30509),M=n(98924),X=n(92977),F=[v.l0.px(8),v.l0.pt(16)],W=(0,S.X)({root:[F],rootMaxWidth:[F,X.Qw.maxWidth]}),H=function(e){var t=e.children,n=e.maxWidth,r=(0,M._)(e,["children","maxWidth"]);return(0,d.tZ)(p.G,(0,O._)((0,U._)({},r),{css:n?W.rootMaxWidth:W.root,children:t}))},V=n(42516),z=n(26881),j=n(43312),q=n(70671),Y=(0,j.iv)([v.l0.maxHeight(320),v.l0.minHeight(240),{aspectRatio:"2 / 1"}]);function J(){var e=(0,q.F)().values;return{animation:{duration:0},backgroundColor:e.global.backgroundHigher,borderColor:e.global.outlineDimmer,borderWidth:1,titleFont:{family:"'IBM Plex Sans', sans-serif"},bodyFont:{family:"'IBM Plex Sans', sans-serif"},footerFont:{family:"'IBM Plex Sans', sans-serif"},padding:8,cornerRadius:6}}var K=n(8279),$=n(74833),Q=n(85289),ee=n(21262),et=n(71440),en=n(58995);function er(){var e=(0,ee._)(["\n  fragment ReplAnalyticsDurationResult on ReplAnalyticsDuration {\n    __typename\n    results {\n      __typename\n      value\n      count\n    }\n  }\n"]);return er=function(){return e},e}function ei(){var e=(0,ee._)(["\n  query ReplAnalyticsDuration(\n    $id: String!\n    $input: ReplAnalyticsDurationInput!\n  ) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsDuration(input: $input) {\n          ... on ReplAnalyticsDuration {\n            ...ReplAnalyticsDurationResult\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return ei=function(){return e},e}var eo={},ea=(0,et.Ps)(er()),el=(0,et.Ps)(ei(),ea),ec=function(e){var t=e.data;z.kL.register(z.ZL);var n=(0,q.F)().values;return(0,d.tZ)(Q.$Q,{options:{responsive:!0,maintainAspectRatio:!1,datasets:{bar:{categoryPercentage:1,barPercentage:1}},plugins:{tooltip:J()},scales:{y:{title:{display:!0,text:"# Requests",color:n.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:n.global.foregroundDimmer,callback:function(e){if("number"==typeof e&&Math.floor(e)===e)return e}},grid:{color:n.global.outlineDimmest}},x:{title:{font:{family:"'IBM Plex Sans', sans-serif"},display:!0,text:"Duration (ms)",color:n.global.foregroundDimmer},ticks:{autoSkip:!1,maxRotation:20,color:n.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:n.global.outlineDimmest}}}},data:{labels:t.results.map(function(e){var t=e.value.replace("ms","").split("-"),n=t[t.length-1];return n.includes("s+")?n.replace("s+","000+"):"< "+n}),datasets:[{borderWidth:0,data:t.results.map(function(e){return e.count}),backgroundColor:Array(t.results.length).fill(n.global.tealDefault)}]}})},es=function(e){var t,n,r,i=e.replId,o=e.start,a=e.hours,l=(0,u._)((0,g.useState)(void 0),2),c=l[0],s=l[1],f=(t=(0,U._)({},eo,{variables:{id:i,input:{start:o,hours:a,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsDuration.__typename){case"UserError":case"NotFoundError":s(Error(e.repl.analyticsDuration.message))}}}),en.a(el,t)),h=f.data,m=f.loading,y=f.error;return y&&s(y),(0,d.BX)(p.G,{css:v.l0.colWithGap(8),children:[(0,d.tZ)($.xv,{variant:"subheadDefault",children:"Request Durations (ms)"}),(0,d.BX)(p.G,{children:[m?(0,d.tZ)(p.G,{css:[Y,v.l0.borderRadius(),K.p.backgroundPulse()]}):null,c?(0,d.tZ)(C.E,{text:c.message,colorway:"negative"}):null,(null==h?void 0:null===(n=h.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=h.repl.analyticsDuration)||void 0===r?void 0:r.__typename)==="ReplAnalyticsDuration"?(0,d.tZ)(p.G,{css:Y,children:(0,d.tZ)(ec,{data:h.repl.analyticsDuration})}):null]})]})},eu=n(86306),ed=n(56412),ef=n(81995);z.kL.register(z.uw,z.f$,z.od,z.jn,z.u);var eh=function(e){var t=e.labels,n=e.datasets,r=e.maintainAspectRatio,i=(0,q.F)().values,o={labels:t.map(function(e){return e.toISOString()}),datasets:n.map(function(e){return(0,O._)((0,U._)({},e),{data:e.data.map(function(e){var t=e.x,n=e.y;return{x:t.toISOString(),y:n}}),pointRadius:.5,tension:.1})})},a=t.length;return(0,d.tZ)(Q.x1,{options:{clip:4,interaction:{mode:"nearest",intersect:!1},transitions:{active:{animation:{duration:0}}},elements:{point:{hoverRadius:4},line:{borderWidth:2}},responsive:!0,maintainAspectRatio:void 0===r||r,plugins:{tooltip:(0,O._)((0,U._)({},J()),{callbacks:{title:function(e){var t=new Date(e[0].label);return(0,ed.Z)(t,"MMM d, HH:mm (z)")}}})},scales:{y:{title:{display:!0,text:"# Requests",color:i.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:i.global.outlineDimmest},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:i.global.foregroundDimmer,callback:function(e){if("number"==typeof e&&Math.floor(e)===e)return e}},min:0},x:{title:{display:!0,text:"Time",color:i.global.foregroundDimmer,font:{family:"'IBM Plex Sans', sans-serif"}},grid:{color:i.global.outlineDimmest},ticks:{font:{family:"'IBM Plex Sans', sans-serif"},color:i.global.foregroundDimmer,callback:function(e,n){var r=t[n];if(a<=24){if(r.getHours()%4!=0)return;return(0,ed.Z)(r,"HH:mm")}if(r.toISOString()===(0,ef.Z)(r).toISOString())return(0,ed.Z)(r,"MMM d")}}}}},data:o})};function ep(){var e=(0,ee._)(["\n  fragment ReplAnalyticsPageViewDataPoint on ReplAnalyticsPageViewsData {\n    __typename\n    timestamp\n    success\n    failure\n  }\n"]);return ep=function(){return e},e}function em(){var e=(0,ee._)(["\n  fragment ReplAnalyticsPageViews on ReplAnalyticsPageViews {\n    __typename\n    uniques\n    results {\n      ...ReplAnalyticsPageViewDataPoint\n    }\n  }\n  ","\n"]);return em=function(){return e},e}function ev(){var e=(0,ee._)(["\n  query ReplAnalyticsPageViews(\n    $id: String!\n    $input: ReplAnalyticsPageViewsInput!\n  ) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsPageViews(input: $input) {\n          ... on ReplAnalyticsPageViews {\n            ...ReplAnalyticsPageViews\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return ev=function(){return e},e}var eg={},ey=(0,et.Ps)(ep()),eb=(0,et.Ps)(em(),ey),ew=(0,et.Ps)(ev(),eb),eZ=function(e){var t=e.data,n=e.start,r=e.hours,i=(0,q.F)().values,o=Array(r).fill(0).map(function(e,t){return(0,eu.Z)(n,t)}),a=t.results.reduce(function(e,t){return e.set(t.timestamp,t),e},new Map),l=[{label:"Connected",data:o.map(function(e){var t;return{y:(null!==(t=a.get(e.toISOString()))&&void 0!==t?t:{success:0}).success,x:e}}),borderColor:i.global.accentPrimaryDefault,backgroundColor:i.global.accentPrimaryDefault},{label:"Failed",data:o.map(function(e){var t;return{y:(null!==(t=a.get(e.toISOString()))&&void 0!==t?t:{failure:0}).failure,x:e}}),borderColor:i.global.accentNegativeDefault,backgroundColor:i.global.accentNegativeDefault}];return(0,d.tZ)(eh,{labels:o,datasets:l,maintainAspectRatio:!1})},ex=function(e){var t,n,r,i=e.replId,o=e.start,a=e.hours,l=(0,u._)((0,g.useState)(void 0),2),c=l[0],s=l[1],f=(t=(0,U._)({},eg,{variables:{id:i,input:{start:o,hours:a,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsPageViews.__typename){case"UserError":case"NotFoundError":s(Error(e.repl.analyticsPageViews.message))}}}),en.a(ew,t)),h=f.data,m=f.loading,y=f.error,b=(null==h?void 0:null===(n=h.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=h.repl.analyticsPageViews)||void 0===r?void 0:r.__typename)==="ReplAnalyticsPageViews"?h.repl.analyticsPageViews:void 0,w=b?b.uniques:void 0;return y&&s(y),(0,d.BX)(p.G,{css:[v.l0.colWithGap(8)],children:[(0,d.BX)(p.G,{css:[v.l0.flex.row,v.l0.align.center,v.l0.justify.spaceBetween],children:[(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:"Requests"}),w?(0,d.BX)($.xv,{multiline:!1,children:[(0,d.tZ)("strong",{children:w})," unique visitors"]}):null]}),(0,d.BX)(p.G,{children:[m?(0,d.tZ)(p.G,{css:[v.l0.width("100%"),Y,v.l0.borderRadius(),K.p.backgroundPulse()]}):null,c?(0,d.tZ)(C.E,{text:c.message,colorway:"negative"}):null,b?(0,d.tZ)(p.G,{css:Y,children:(0,d.tZ)(eZ,{data:b,start:o,hours:a})}):null]})]})},eC=n(63257);function eS(){var e=(0,ee._)(["\n  fragment ReplAnalyticsTimeSeriesDataPoint on ReplAnalyticsTimeSeriesData {\n    __typename\n    timestamp\n    value\n    count\n  }\n"]);return eS=function(){return e},e}function ek(){var e=(0,ee._)(["\n  fragment ReplAnalyticsTimeSeries on ReplAnalyticsTimeSeries {\n    __typename\n    results {\n      ...ReplAnalyticsTimeSeriesDataPoint\n    }\n  }\n  ","\n"]);return ek=function(){return e},e}function e_(){var e=(0,ee._)(["\n  query ReplAnalyticsTimeSeries(\n    $id: String!\n    $input: ReplAnalyticsTimeSeriesInput!\n  ) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsTimeSeries(input: $input) {\n          ... on ReplAnalyticsTimeSeries {\n            ...ReplAnalyticsTimeSeries\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return e_=function(){return e},e}var eE={},eT=(0,et.Ps)(eS()),eR=(0,et.Ps)(ek(),eT),eI=(0,et.Ps)(e_(),eR),eD=function(e){var t=e.data,n=e.start,r=e.hours,i=e.colorFn,o=Array(r).fill(0).map(function(e,t){return(0,eu.Z)(n,t)}),a=t.results.reduce(function(e,t){var n,r=t.timestamp,i=t.value,o=t.count,a=null!==(n=e.get(i))&&void 0!==n?n:new Map;return a.set(r,o),e.set(i,a),e},new Map),l=(0,eC._)(a.keys()).map(function(e,t){var n=i(e,t),r=a.get(e);return{label:e,data:o.map(function(e){var t,n=null!==(t=null==r?void 0:r.get(e.toISOString()))&&void 0!==t?t:0;return{x:new Date(e),y:n}}),borderColor:n,backgroundColor:n}});return(0,d.tZ)(eh,{labels:o,datasets:l,maintainAspectRatio:!1})},eG=function(e){var t,n,r,i=e.replId,o=e.title,a=e.metric,l=e.start,c=e.hours,s=e.colorFn,f=(0,u._)((0,g.useState)(void 0),2),h=f[0],m=f[1],y=(t=(0,U._)({},eE,{variables:{id:i,input:{metric:a,start:l,hours:c,deployment:!0}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsTimeSeries.__typename){case"UserError":case"NotFoundError":m(Error(e.repl.analyticsTimeSeries.message))}}}),en.a(eI,t)),b=y.data,w=y.loading,Z=y.error,x=(null==b?void 0:null===(n=b.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=b.repl.analyticsTimeSeries)||void 0===r?void 0:r.__typename)==="ReplAnalyticsTimeSeries"?b.repl.analyticsTimeSeries:void 0;return Z&&m(Z),(0,d.BX)(p.G,{css:[v.l0.colWithGap(8)],children:[(0,d.tZ)(p.G,{css:[v.l0.flex.row,v.l0.align.center,v.l0.justify.spaceBetween],children:(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:o})}),(0,d.BX)(p.G,{children:[w?(0,d.tZ)(p.G,{css:[v.l0.width("100%"),Y,v.l0.borderRadius(),K.p.backgroundPulse()]}):null,h?(0,d.tZ)(C.E,{text:h.message,colorway:"negative"}):null,x?(0,d.tZ)(p.G,{css:Y,children:(0,d.tZ)(eD,{data:x,start:l,hours:c,colorFn:s})}):null]})]})},eB=n(15146),eP=n(87599),eA=n(35908),eN=n(26568),eL=n.n(eN),eU=n(60671);function eO(){var e=(0,ee._)(["\n  fragment ReplAnalyticsTopListResult on ReplAnalyticsTopList {\n    __typename\n    results {\n      __typename\n      value\n      count\n    }\n  }\n"]);return eO=function(){return e},e}function eM(){var e=(0,ee._)(["\n  query ReplAnalyticsTopList($id: String!, $input: ReplAnalyticsTopInput!) {\n    repl(id: $id) {\n      ... on Repl {\n        __typename\n        id\n        analyticsTopList(input: $input) {\n          ... on ReplAnalyticsTopList {\n            ...ReplAnalyticsTopListResult\n          }\n          ... on NotFoundError {\n            __typename\n            message\n          }\n          ... on UserError {\n            __typename\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return eM=function(){return e},e}var eX={},eF=(0,et.Ps)(eO()),eW=(0,et.Ps)(eM(),eF),eH=function(e){var t=e.data,n=e.variant;if(0===t.results.length)return(0,d.tZ)($.xv,{multiline:!1,children:"No results"});switch(n){case"map":return(0,d.tZ)(ej,{data:t});case"pie":return(0,d.tZ)(ez,{data:t,devices:!1});case"device-pie":return(0,d.tZ)(ez,{data:t,devices:!0});case"table":return(0,d.tZ)(eV,{data:t})}},eV=function(e){var t=e.data;return z.kL.register(z.qi),(0,d.tZ)(p.G,{children:t.results.map(function(e,t){return(0,d.BX)(p.G,{css:[v.l0.rowWithGap(16),v.l0.py(8),{borderBottom:"1px solid ".concat(v.TV.outlineDimmest)},{"&:last-of-type":{borderBottom:"none"}}],children:[(0,d.tZ)(p.G,{css:[v.l0.flex.grow(1),v.l0.maxWidth("90%")],children:(0,d.tZ)($.xv,{title:e.value,multiline:!1,children:e.value})}),(0,d.tZ)(p.G,{children:(0,d.tZ)($.xv,{multiline:!1,children:e.count})})]},t)})})},ez=function(e){var t=e.data,n=e.devices,r=(0,q.F)().values,i=[r.global.blueDefault,r.global.blurpleDefault,r.global.greenDefault,r.global.limeDefault,r.global.magentaDefault,r.global.orangeDefault,r.global.pinkDefault,r.global.purpleDefault,r.global.redDefault,r.global.tealDefault,r.global.yellowDefault],o=new Map;return n?t.results.forEach(function(e){var t=e.value,n=e.count,r=t.match(/\(.*\)/);if(r&&r.length){var i=r[0].substring(1,r[0].length-1),a=o.get(i)||0;o.set(i,a+n)}else{var l=o.get("Unknown")||0;o.set("Unknown",l+n)}}):t.results.forEach(function(e){var t=e.value,n=e.count,r=t.replace(/ \(.*\)/,""),i=o.get(r)||0;o.set(r,i+n)}),(0,d.tZ)(p.G,{css:Y,children:(0,d.tZ)(Q.by,{options:{radius:"90%",maintainAspectRatio:!1,plugins:{tooltip:J()}},data:{labels:(0,eC._)(o.keys()),datasets:[{borderWidth:(0,eC._)(o.keys()).length>1?1:0,borderColor:r.global.outlineDimmest,data:(0,eC._)(o.values()),backgroundColor:Array(o.size).fill(0).map(function(e,t){return i[t%i.length]})}]}})})},ej=function(e){var t=e.data,r=eL()(function(){return Promise.all([n.e(5381),n.e(4096),n.e(8742),n.e(8806)]).then(n.bind(n,8806))},{loadableGenerated:{webpack:function(){return[8806]}},ssr:!1}),i=t.results.map(function(e){return{country:e.value,numHits:e.count}});return(0,d.tZ)(r,{countries:i})},eq=function(e){var t,n,r,i=e.replId,o=e.start,a=e.hours,l=e.metric,c=e.count,s=e.variant,f=void 0===s?"table":s,h=e.expandable,m=(0,eU.CZ)(l),y=(0,u._)((0,g.useState)(void 0),2),b=y[0],w=y[1],Z=(0,u._)((0,g.useState)(!1),2),x=Z[0],S=Z[1],k=(t=(0,U._)({},eX,{variables:{id:i,input:{metric:l,start:o,hours:a,deployment:!0,count:x?3*c:c}},ssr:!1,onCompleted:function(e){if("Repl"===e.repl.__typename)switch(e.repl.analyticsTopList.__typename){case"UserError":case"NotFoundError":w(Error(e.repl.analyticsTopList.message))}}}),en.a(eW,t)),_=k.data,E=k.loading,T=k.error;return T&&w(T),(0,d.BX)(p.G,{css:v.l0.colWithGap(8),children:[(0,d.BX)(p.G,{css:v.l0.rowWithGap(8),children:[(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:"device-pie"===f?"Top Devices":"Top ".concat(m)}),void 0!==h&&h?(0,d.tZ)(eB.hU,{alt:x?"Collapse list":"Expand list",onClick:function(){return S(!x)},children:x?(0,d.tZ)(eP.Z,{}):(0,d.tZ)(eA.Z,{})}):null]}),(0,d.BX)(p.G,{children:[E?(0,d.tZ)(p.G,{css:[v.l0.height(80),v.l0.borderRadius(),K.p.backgroundPulse()]}):null,b?(0,d.tZ)(C.E,{text:b.message,colorway:"negative"}):null,(null==_?void 0:null===(n=_.repl)||void 0===n?void 0:n.__typename)==="Repl"&&(null===(r=_.repl.analyticsTopList)||void 0===r?void 0:r.__typename)==="ReplAnalyticsTopList"?(0,d.tZ)(eH,{variant:f,data:_.repl.analyticsTopList}):null]})]})},eY=n(20399),eJ=n(99741),eK=n(6543),e$=n(34017),eQ=n(59868),e0=function(e){var t=e.context;(0,eQ.j)(eQ.U3.DEPLOYMENT_SECTION_VIEWED,{context:t})},e1=[{label:"six hours",key:6},{label:"one day",key:24},{label:"five days",key:120},{label:"one week",key:168},{label:"two weeks",key:336},{label:"thirty days",key:720}],e2={label:"one week",key:168},e8=v.nC.min(600),e4=(0,S.X)({fullWidth:(0,V._)({},e8,{gridColumn:"span 2"})}),e3=(0,S.X)({container:(0,V._)({display:"grid",gap:32},e8,{gridTemplateColumns:"repeat(2, minmax(0, 1fr))"}),fullWidth:e4.fullWidth,map:[e4.fullWidth],pies:[e4.fullWidth,v.l0.flex.column,(0,V._)({gap:32},v.nC.min(480),[v.l0.flex.row,{" > *":{flex:1}}])]}),e5=function(e){var t=e.replId,n=(0,u._)((0,g.useState)(e2),2),r=n[0],i=r.key,o=r.label,a=n[1],l=(0,u._)((0,g.useState)((0,eK.Z)((0,e$.Z)(new Date),i-1)),2),c=l[0],s=l[1],f=(0,P.o)("deployment-analytics-dot"),h=f.isDone,m=f.setAsDone,y=(0,eK.Z)((0,e$.Z)(new Date),23),b=(0,q.F)().values,w=[b.global.redDefault,b.global.redDimmer,b.global.redStronger,b.global.redDimmest],Z=[b.global.orangeDefault,b.global.orangeDimmer,b.global.orangeStronger,b.global.orangeDimmest],x=[b.global.blueDefault,b.global.blueDimmer,b.global.blueStronger,b.global.blueDimmest],C=[b.global.greenDefault,b.global.greenDimmer,b.global.greenStronger,b.global.greenDimmest];return(0,g.useEffect)(function(){e0({context:A.k.Analytics})},[]),(0,g.useEffect)(function(){h||m()},[h,m]),(0,d.tZ)(H,{children:(0,d.BX)(p.G,{css:e3.container,children:[(0,d.tZ)(p.G,{css:e3.fullWidth,children:(0,d.tZ)(eY.ZE,{items:e1,label:"Past ".concat(o),icon:(0,d.tZ)(eJ.Z,{}),onAction:function(e){var t,n="string"==typeof e?parseInt(e,10):e;a(null!==(t=e1.find(function(e){return e.key===n}))&&void 0!==t?t:e2),s((0,eK.Z)((0,e$.Z)(new Date),n-1))},cssProps:[v.l0.width("fit-content")],children:e1.map(function(e){return(0,d.tZ)(eY.ck,{children:(0,d.tZ)(p.G,{css:[v.l0.rowWithGap(8),v.l0.align.center,v.l0.color.foregroundDefault],children:(0,d.tZ)($.xv,{multiline:!1,children:e.label})})},e.key)})})}),(0,d.tZ)(p.G,{css:e3.fullWidth,children:(0,d.tZ)(ex,{replId:t,start:c,hours:i})}),(0,d.tZ)(eq,{replId:t,metric:eU.Pc.Url,start:c,hours:i,count:4,expandable:!0}),(0,d.tZ)(eq,{replId:t,metric:eU.Pc.Referrer,start:c,hours:i,count:4,expandable:!0}),(0,d.tZ)(eG,{replId:t,title:"HTTP Statuses (24h)",metric:eU.RH.Statuses,start:y,hours:24,colorFn:function(e,t){var n=Number(e);return n<300?C[t%C.length]:n<400?x[t%x.length]:n<500?Z[t%Z.length]:w[t%w.length]}}),(0,d.tZ)(es,{replId:t,start:c,hours:i}),(0,d.BX)(p.G,{css:e3.pies,children:[(0,d.tZ)(eq,{replId:t,metric:eU.Pc.Browser,start:c,hours:i,count:100,variant:"pie"}),(0,d.tZ)(eq,{replId:t,metric:eU.Pc.Browser,start:c,hours:i,count:100,variant:"device-pie"})]}),(0,d.tZ)(p.G,{css:e3.map,children:(0,d.tZ)(eq,{replId:t,metric:eU.Pc.Country,start:c,hours:i,count:100,variant:"map"})})]})})},e6=(0,S.X)({line:{width:1,position:"absolute",left:3},circlePast:{position:"absolute",top:10,left:1,width:5,height:5,borderRadius:"100%",opacity:.5}}),e9=(0,S.X)({container:{width:7,position:"relative"},linePast:[e6.line,{backgroundColor:v.TV.outlineDimmest,top:15,bottom:-10}],linePresent:[e6.line,{backgroundImage:"linear-gradient(to top, ".concat(v.TV.outlineDimmest,", ").concat(v.TV.outlineDimmer,")"),top:27,bottom:-10}],lineFuture:[e6.line,{borderRight:"1px dashed "+v.TV.outlineDimmer,top:23,bottom:-20}],lineFutureFailClosed:[e6.line,{backgroundColor:v.TV.outlineDimmest,top:19,bottom:-20}],lineFutureFailOpen:[e6.line,{borderRight:"1px dashed "+v.TV.outlineDimmer,top:22,bottom:-18}],circlePastGreen:[e6.circlePast,v.l0.backgroundColor.accentPositiveDefault],circlePastRed:[e6.circlePast,v.l0.backgroundColor.accentNegativeDefault],circlePastGray:[e6.circlePast,v.l0.backgroundColor.outlineDimmer],circlePresent:[v.l0.backgroundColor.accentPrimaryStronger,{position:"absolute",top:20,left:0,width:7,height:7,borderRadius:"100%"}],circleFuture:{position:"absolute",top:12,left:-1,width:9,height:9},circleFutureFailClosed:[v.l0.backgroundColor.accentNegativeDefault,{position:"absolute",top:14,left:1,width:5,height:5,borderRadius:"100%",opacity:.6}]});function e7(e){var t,n;switch(e.type){case"pastSuccess":t=e9.linePast,n=(0,d.tZ)(p.G,{css:e9.circlePastGreen});break;case"pastFail":t=e9.linePast,n=(0,d.tZ)(p.G,{css:e9.circlePastRed});break;case"pastNeutral":t=e9.linePast,n=(0,d.tZ)(p.G,{css:e9.circlePastGray});break;case"present":t=e9.linePresent,n=(0,d.tZ)(p.G,{css:e9.circlePresent});break;case"future":t=e9.lineFuture,n=(0,d.tZ)("svg",{viewBox:"0 0 9 9",css:e9.circleFuture,children:(0,d.tZ)("circle",{cx:4.5,cy:4.5,r:4,fill:"none",stroke:v.TV.outlineStrongest,strokeDasharray:"2 1"})});break;case"futureFailClosed":t=e9.lineFutureFailClosed,n=(0,d.tZ)(p.G,{css:e9.circleFutureFailClosed});break;case"futureFailOpen":t=e9.lineFutureFailOpen,n=null}return(0,d.BX)(p.G,{css:e9.container,children:[(0,d.tZ)(p.G,{css:t,"data-timeline-line":!0}),n]})}var te=n(68514),tt=n(67313),tn=n(80502),tr=n(58200),ti=n(16572),to=n(62340),ta=n(23291),tl=n(32377),tc=n(81764),ts=n(49932),tu=function(e){var t=e.stage,n=e.activeStage;return t===e.erroredStage?(0,d.tZ)(R.Z,{alt:"error"}):t<n?(0,d.tZ)(tl.Z,{alt:"success"}):t===n?(0,d.tZ)(m.Z,{alt:"current"}):(0,d.tZ)(tc.Z,{alt:"waiting"})},td=function(e){var t=e.stage,n=e.activeStage,r=e.erroredStage;return n?t===r?"negative":t<n?"positive":t===n?"primary":null:null},tf=function(e){var t,n=e.stage,r=e.totalStagesWithTitle,i=e.activeStage,o=e.text,a=e.erroredStage,l=(0,to.d)({tablet:!0});return(0,d.tZ)(ta.D,{text:i?o:"",colorway:null!==(t=td({stage:n,activeStage:i,erroredStage:a}))&&void 0!==t?t:void 0,variant:"filled",css:[v.l0.border({color:ts.TV.backgroundDefault}),v.l0.overflow("hidden"),i||l?{}:K.p.foregroundPulse(),(0,V._)({flex:1,height:26,zIndex:r-n,":first-of-type":{paddingLeft:6,paddingRight:6},":not(:first-of-type)":{paddingLeft:24},":not(:last-of-type)":{marginRight:-24}," span":v.l0.display.none},v.nC.min(400),{" span":v.l0.display.flex,":first-of-type":{paddingLeft:16,paddingRight:0}})],iconRight:i?(0,d.tZ)(tu,{stage:n,activeStage:i,erroredStage:a}):void 0})};function th(){var e=(0,ee._)(["\n  query HostingDeployActionHistory(\n    $input: HostingBuildDeployActionHistoryInput!\n  ) {\n    hostingBuildDeployActionHistory(input: $input) {\n      ... on HostingBuildDeployActionHistoryResults {\n        results {\n          ... on HostingBuildDeployLogAction {\n            log\n          }\n          ... on HostingBuildDeployStatusAction {\n            status\n            message\n          }\n        }\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n"]);return th=function(){return e},e}var tp={},tm=(0,et.Ps)(th()),tv=[{id:0,title:"Provision",statusType:I.Fe.Pending},{id:1,title:"Build",statusType:I.Fe.Building},{id:2,title:"Bundle",statusType:I.Fe.Running},{id:3,title:"Promote",statusType:I.Fe.Promoting},{id:4,statusType:I.Fe.Success}],tg=tv.filter(function(e){return"title"in e}),ty=function(e){return tv.find(function(t){return t.statusType===e})},tb=(0,S.X)({base:{borderRadius:v.TV.borderRadiusDefault,paddingLeft:6,paddingRight:6,height:24},disabled:{pointerEvents:"none",color:v.TV.greyDefault}}),tw=[v.l0.borderRadius(),{border:"1px solid var(--outline-dimmest)"}],tZ=(0,S.X)({container:tw,top:[v.l0.colWithGap(12),v.l0.p(16),v.l0.pt(12)],header:[v.l0.rowWithGap(40)],started:[v.l0.rowWithGap(6),v.l0.flex.growAndShrink(1),v.l0.justify.end],cancel:tb.base,canceling:[tb.base,tb.disabled],stages:[v.l0.flex.row,v.l0.flex.grow(1),{zIndex:0}],bottom:[v.l0.borderRadius(0,0,4,4),v.l0.overflow("hidden")],logsOpen:[v.l0.overflow("hidden"),v.l0.height("auto")],logsClosed:[v.l0.overflow("hidden"),v.l0.height(0)],xterm:[v.l0.width("100%"),v.l0.maxWidth("100%"),v.l0.height(340)]}),tx=function(e){return(0,d.BX)(p.G,{css:tZ.top,children:[(0,d.BX)(p.G,{css:tZ.header,children:[(0,d.BX)(p.G,{css:v.l0.rowWithGap(8),children:[(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:"Deploying"}),(0,d.tZ)(D.zx,{style:{opacity:e.onCancel?1:0},size:"small",text:"Cancel",css:e.isCanceling?tZ.canceling:tZ.cancel,onClick:e.onCancel,iconRight:e.isCanceling?(0,d.tZ)(m.Z,{}):void 0})]}),(0,d.BX)(p.G,{css:tZ.started,children:[e.timeStarted&&e.userDisplayName?(0,d.BX)($.xv,{css:v.l0.color.greyStronger,multiline:!1,children:["Started ".concat((0,ti.Z)(new Date(e.timeStarted),Date.now(),{addSuffix:!0})," by "),(0,d.tZ)("span",{css:v.l0.color.foregroundDefault,children:e.userDisplayName})]}):null,e.onViewBuildLogs?(0,d.tZ)(eB.hU,{onClick:e.onViewBuildLogs,alt:"View deploy logs",children:e.viewBuildLogs?(0,d.tZ)(tt.Z,{}):(0,d.tZ)(eJ.Z,{})}):null]})]}),(0,d.tZ)(p.G,{css:tZ.stages,children:tg.map(function(t){var n=t.id,r=t.title;return(0,d.tZ)(tf,{stage:n,totalStagesWithTitle:tg.length,text:r,activeStage:e.activeStage,erroredStage:e.erroredStage},n)})})]})},tC=function(e){return(0,y.kW)()===b.z.Preparing?(0,d.tZ)(p.G,{css:tZ.container,children:(0,d.tZ)(tx,{})}):(0,d.tZ)(tS,(0,U._)({},e))},tS=function(e){var t,n,r,i,o,a,l,c,s,f,h,m,b,x=e.initialBuild,C=e.viewBuildLogsOnLoad,S=e.onViewLogs,k=e.onCanceled,_=e.onError,E=e.openFile,T=(0,y.rm)(),R=(0,y.pn)(),D=R?{id:R.id,status:R.status,provider:R.provider,timeStarted:R.timeCreated,userDisplayName:R.user.displayName}:void 0,G=(0,g.useRef)(x||D),B=(t={skip:!(null===(i=G.current)||void 0===i?void 0:i.id),variables:{input:{buildId:null!==(b=null===(o=G.current)||void 0===o?void 0:o.id)&&void 0!==b?b:""}},fetchPolicy:"network-only",ssr:!1,onCompleted:function(e){if(null==e?void 0:e.hostingBuildDeployActionHistory)switch(e.hostingBuildDeployActionHistory.__typename){case"NotFoundError":break;case"UnauthorizedError":_(e.hostingBuildDeployActionHistory.message);break;case"HostingBuildDeployActionHistoryResults":var t=e.hostingBuildDeployActionHistory.results;if(t&&t.length>0){var n=[],r=[],i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;switch(s.__typename){case"HostingBuildDeployLogAction":n.push(s.log);break;case"HostingBuildDeployStatusAction":r.push(s)}}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}Q({type:"history",payload:n});var u=!0,d=!1,f=void 0;try{for(var h,p=r[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var m=h.value;ee(m.status)}}catch(e){d=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(d)throw f}}}break;default:_("Unexpected typename.")}},onError:function(e){_(e.message)}},n=(0,U._)({},tp,t),en.a(tm,n)),P=B.loading,A=B.refetch;(0,y.U)(function(e){switch(e.__typename){case"HostingBuildDeployLogAction":Q({type:"update",payload:e.log});break;case"HostingBuildDeployStatusAction":ee(e.status)}});var N=(0,u._)((0,g.useState)(G.current?null===(a=ty(G.current.status))||void 0===a?void 0:a.id:void 0),2),L=N[0],O=N[1],M=(0,u._)((0,g.useState)((null===(l=G.current)||void 0===l?void 0:l.status)==="failed"?null===(c=ty(null===(s=G.current)||void 0===s?void 0:s.status))||void 0===c?void 0:c.id:void 0),2),X=M[0],F=M[1],W=(0,u._)((0,g.useState)(!1),2),H=W[0],V=W[1],z=(0,y.XZ)(),j=(0,u._)((0,tn.Z)({openFile:E,listFiles:z.listFiles}),2),q=j[0],Y=j[1],J=(0,tr.f)(),K=(0,u._)((0,g.useReducer)(function(e,t){switch(t.type){case"history":return q&&q.clear(),(0,eC._)(t.payload).concat((0,eC._)(e));case"update":return[t.payload];case"refetch":return q&&q.clear(),P||A(),[]}},[]),2),$=K[0],Q=K[1],ee=function(e){if(e===I.Fe.Failed)F(L);else{var t=ty(e);if(!t)return;O(t.id)}},et=(r=(0,w._)(function(){return(0,Z.Jh)(this,function(e){switch(e.label){case 0:return V(!0),[4,T()];case 1:return e.sent(),k(),[2]}})}),function(){return r.apply(this,arguments)}),er=(0,u._)((0,g.useState)(C||!1),2),ei=er[0],eo=er[1],ea=function(){eo(!ei),ei||e0({context:"deploy_progress_logs"})};(0,g.useEffect)(function(){e0({context:"deploy_progress"})},[]),(0,g.useEffect)(function(){var e;(null===(e=G.current)||void 0===e?void 0:e.id)&&R&&R.id!==G.current.id&&(G.current={id:R.id,status:R.status,provider:R.provider,timeStarted:R.timeCreated,userDisplayName:R.user.displayName},O(void 0),F(void 0),Q({type:"refetch"}))},[R,null===(f=G.current)||void 0===f?void 0:f.id,A]),(0,g.useEffect)(function(){var e;void 0!==L&&(null===(e=G.current)||void 0===e?void 0:e.status)==="failed"&&F(L)},[L,null===(h=G.current)||void 0===h?void 0:h.status]),(0,g.useEffect)(function(){q&&$.forEach(function(e){return q.write(e)})},[$,q]);var el=null===(m=tv.find(function(e){return e.id===L}))||void 0===m?void 0:m.statusType,ec=el!==I.Fe.Success&&!X;return G.current?(0,d.BX)(p.G,{css:tZ.container,children:[(0,d.tZ)(tx,{onCancel:ec?et:void 0,isCanceling:H,onViewBuildLogs:ea,viewBuildLogs:ei,timeStarted:G.current.timeStarted,userDisplayName:G.current.userDisplayName,activeStage:L,erroredStage:X}),(0,d.BX)(p.G,{css:tZ.bottom,children:[(0,d.BX)(p.G,{css:ei?tZ.logsOpen:tZ.logsClosed,children:[(0,d.tZ)(te.R,{}),(0,d.tZ)(p.G,{css:[v.l0.display.flex,v.l0.pt(12),v.l0.pl(16),v.l0.overflow("hidden"),{backgroundColor:null==J?void 0:J.background}],children:(0,d.tZ)(p.K.div,{css:tZ.xterm,ref:Y})})]}),X&&el?(0,d.BX)(d.HY,{children:[(0,d.tZ)(te.R,{}),el===I.Fe.Building?(0,d.tZ)(tT,{provider:G.current.provider,logs:$.slice(-3),openFile:E,viewBuildLogs:ei,onViewBuildLogs:ea}):null,el===I.Fe.Promoting?(0,d.tZ)(tE,{provider:G.current.provider,logs:$.slice(-3),openFile:E,viewBuildLogs:ei,onViewBuildLogs:ea,onViewApplicationLogs:S}):null]}):null]})]}):null},tk=(0,S.X)({errorContainer:[v.l0.p(12),v.l0.colWithGap(12)],warning:[v.l0.colWithGap(8)],warningTitle:[v.l0.rowWithGap(4),v.l0.align.center,v.l0.fontWeight.medium],link:{color:v.TV.foregroundDefault,textDecoration:"underline",":hover":{color:v.TV.accentPrimaryStronger}},xtermContainer:[v.l0.display.flex,v.l0.pt(12),v.l0.pl(16),v.l0.overflow("hidden"),v.l0.borderRadius(4,4,0,0)],xterm:[v.l0.width("100%"),v.l0.maxWidth("100%"),v.l0.height(120)],xtermButton:v.l0.borderRadius(0,0,4,4),list:[{listStyle:"inside"}],listCta:v.l0.display.inlineFlex}),t_=function(e){var t=e.title,n=e.description,r=e.logs,i=e.viewBuildLogs,o=e.onViewBuildLogs,a=e.openFile,l=(0,tr.f)(),c=(0,y.XZ)(),s=(0,u._)((0,tn.Z)({openFile:a,listFiles:c.listFiles}),2),f=s[0],h=s[1],m=(0,g.useRef)(r?r.slice(-3):[]);return(0,g.useEffect)(function(){m.current.length&&m.current.forEach(function(e){null==f||f.write(e)})},[f]),(0,d.BX)(B.Tg,{elevated:!0,css:tk.errorContainer,children:[(0,d.BX)(p.G,{css:tk.warning,children:[(0,d.BX)(p.G,{css:tk.warningTitle,children:[(0,d.tZ)(R.Z,{color:v.TV.accentNegativeStronger}),(0,d.tZ)($.xv,{multiline:!1,children:t})]}),(0,d.tZ)($.xv,{children:n})]}),void 0===i||i?null:(0,d.BX)(p.G,{children:[(0,d.tZ)(p.G,{css:tk.xtermContainer,style:{backgroundColor:null==l?void 0:l.background},children:(0,d.tZ)(p.K.div,{css:tk.xterm,ref:h})}),(0,d.tZ)(D.zx,{text:"View all",iconLeft:(0,d.tZ)(eA.Z,{}),onClick:o,css:tk.xtermButton})]})]})};function tE(e){var t=(0,y.am)();return(0,d.tZ)(t_,(0,U._)({title:"Your app failed to promote",description:(0,d.BX)(d.HY,{children:["Common issues for promote stage errors can be an error occurring while trying to run your run command, your application exiting unexpectedly, an error on your app server or a provisioning issue.",(0,d.tZ)("br",{}),(0,d.tZ)("br",{}),"Ways to debug:",(0,d.BX)("ul",{css:tk.list,children:[(null==t?void 0:t.isVnc)?(0,d.tZ)("li",{children:"This promotion may also be failing due to VNC incompatibilities."}):null,(0,d.tZ)("li",{children:"make sure your repl runs in the Workspace"}),(0,d.BX)("li",{children:["view our"," ",(0,d.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/troubleshooting",target:"_blank",css:tk.link,onClick:function(){return e0({context:"troubleshooting_doc"})},children:"troubleshooting tips"})]}),e.provider!==I.r4.Static&&e.onViewApplicationLogs?(0,d.BX)("li",{children:["look for errors in your application's server logs"," ",(0,d.tZ)(D.zx,{text:"Logs",size:"small",iconLeft:(0,d.tZ)(E.Z,{}),onClick:e.onViewApplicationLogs,css:v.l0.display.inlineFlex})," "]}):null,(0,d.tZ)("li",{children:"look for errors in your promote stage logs"})]})]})},e))}function tT(e){var t=(0,y.am)();return(0,d.tZ)(t_,(0,U._)({title:"Your app failed to build",description:(0,d.BX)(d.HY,{children:["Common issues for build stage errors can be an error occurring while trying to run your build command or an compilation issue with your application code.",(0,d.tZ)("br",{}),(0,d.tZ)("br",{}),"Ways to debug:",(0,d.BX)("ul",{css:tk.list,children:[(null==t?void 0:t.isVnc)?(0,d.tZ)("li",{children:"This promotion may also be failing due to VNC incompatibilities."}):null,(0,d.tZ)("li",{children:"make sure your repl runs in the Workspace"}),(0,d.BX)("li",{children:["view our"," ",(0,d.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/troubleshooting",target:"_blank",css:tk.link,onClick:function(){return e0({context:"troubleshooting_doc"})},children:"troubleshooting tips"})]}),(0,d.tZ)("li",{children:"look for errors in your build stage logs"})]})]})},e))}var tR=n(35597),tI=n(79217),tD=n(95891);(i||(i={})).Current="current";var tG=(0,V._)({},"current",{icon:(0,d.tZ)(function(e){var t=e.color;return(0,d.tZ)(p.G,{css:[v.l0.align.center,v.l0.rowWithGap(8),{textTransform:"capitalize"}],children:(0,d.tZ)(p.G,{tag:"span",css:[v.l0.width("8px"),v.l0.height("8px"),v.l0.borderRadius("full"),{backgroundColor:t,boxShadow:"0 0 12px ".concat(t)}]})})},{color:v.TV.blueStronger}),text:"Current deployment"}),tB=p.K.div,tP=function(e){var t=e.activityLogItem.type,n=(0,u._)((0,g.useState)(!1),2),r=n[0],i=n[1],o=(0,u._)((0,g.useState)(!1),2),a=o[0],l=o[1],c=(0,g.useRef)(!1);(0,g.useEffect)(function(){c.current=!0;var e=setTimeout(function(){l(r)},200);return function(){clearTimeout(e)}},[r]);var s=t in tG&&tG[t];if(!s)return null;var f=s.icon,h=s.text;return(0,d.tZ)(p.G,{css:[v.l0.p(8)],onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},children:(0,d.BX)(tD.Z,{isOpen:a,onClickOutside:function(){return l(!1)},padding:8,children:[(0,d.tZ)(tB,{css:v.l0.cursor.pointer,children:f}),(0,d.tZ)(p.G,{css:[v.l0.maxWidth(240)],children:(0,d.tZ)($.xv,{children:h})})]})})};function tA(){var e=(0,ee._)(["\n  fragment HostingActivityLogBuild on HostingBuild {\n    id\n    status\n    provider\n    timeCreated\n    user {\n      id\n      displayName\n    }\n  }\n"]);return tA=function(){return e},e}function tN(){var e=(0,ee._)(["\n  fragment HostingActivityLogLine2 on HostingActivityLog {\n    id\n    build {\n      ...HostingActivityLogBuild\n    }\n    type\n    user {\n      id\n      displayName\n    }\n    timeCreated\n  }\n  ","\n"]);return tN=function(){return e},e}function tL(){var e=(0,ee._)(["\n  query HostingDeploymentActivityLogs2(\n    $replId: String!\n    $after: String\n    $count: Int\n  ) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        hostingDeployment {\n          ... on HostingDeployment {\n            id\n            currentBuild {\n              id\n            }\n            activityLogs(after: $after, count: $count) {\n              items {\n                ...HostingActivityLogLine2\n              }\n              pageInfo {\n                hasNextPage\n                nextCursor\n              }\n            }\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on UnauthorizedError {\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return tL=function(){return e},e}function tU(){var e=(0,ee._)(["\n  query HostingActivityLogBuildHistory(\n    $input: HostingBuildDeployActionHistoryInput!\n  ) {\n    hostingBuildDeployActionHistory(input: $input) {\n      ... on HostingBuildDeployActionHistoryResults {\n        results {\n          ... on HostingBuildDeployStatusAction {\n            status\n            message\n          }\n          ... on HostingBuildDeployLogAction {\n            log\n          }\n        }\n      }\n    }\n  }\n"]);return tU=function(){return e},e}var tO={},tM=(0,et.Ps)(tA()),tX=(0,et.Ps)(tN(),tM),tF=(0,et.Ps)(tL(),tX),tW=(0,et.Ps)(tU()),tH=n(40102),tV=n(34396),tz=function(e){var t=e.build,n=t.id.slice(0,8),r=(0,u._)((0,g.useState)(!1),2),i=r[0],o=r[1],a=(0,u._)((0,g.useState)(!1),2),l=a[0],c=a[1],s=(0,g.useRef)(!1);return(0,g.useEffect)(function(){s.current=!0;var e=setTimeout(function(){c(i)},200);return function(){clearTimeout(e)}},[i]),(0,d.tZ)("span",{onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},children:(0,d.BX)(tD.Z,{isOpen:l,onClickOutside:function(){return c(!1)},padding:8,children:[(0,d.tZ)("span",{css:[G.gU.listItem,v.l0.display.inlineBlock,v.l0.px(2),v.l0.py(0),v.l0.borderRadius(4)],children:n}),(0,d.tZ)(p.G,{css:[v.l0.maxWidth(260)],children:(0,d.tZ)($.xv,{variant:"small",children:t.id})})]})})},tj=(o={},(0,V._)(o,tV.dD.Deploy,function(e){return(0,d.BX)(d.HY,{children:["deployed ",(0,d.tZ)(tz,{build:e})]})}),(0,V._)(o,tV.dD.Rollback,function(e){return(0,d.BX)(d.HY,{children:["rolled back ",(0,d.tZ)(tz,{build:e})]})}),(0,V._)(o,tV.dD.Fail,function(e){return(0,d.BX)(d.HY,{children:["failed to deploy ",(0,d.tZ)(tz,{build:e})]})}),o),tq=function(e){var t=e.activityLogItem,n=t.type,r=t.build,i=t.user.displayName,o=n in tj&&tj[n](r);return o?(0,d.BX)($.xv,{multiline:!1,children:[(0,d.tZ)("span",{css:v.l0.fontWeight.medium,children:i+" "}),o]}):null},tY=n(63388),tJ=n(73157);function tK(e){var t=e.onViewBuildLogs,n=e.type,r=(0,x.Z)();return(0,d.tZ)(t9,{replId:r,onSelect:t,type:void 0===n?"default":n})}var t$=tv.filter(function(e){return"title"in e}),tQ=(0,S.X)({root:[v.l0.flex.row,v.l0.px(8),v.l0.pb(8),{zIndex:0}]});function t0(e){var t=e.activeStage,n=e.erroredStage;return(0,d.tZ)(p.G,{css:tQ.root,children:t$.map(function(e){return(0,d.tZ)(tf,{stage:e.id,text:e.title,totalStagesWithTitle:t$.length,activeStage:t,erroredStage:n},e.id)})})}var t1=(0,S.X)({root:[v.l0.colWithGap(8),v.l0.height("100%")],header:[v.l0.pt(8),v.l0.px(8),v.l0.rowWithGap(8),v.l0.align.center],divider:[{marginLeft:8,marginRight:8,borderBottom:"1px solid "+v.TV.outlineDimmest}],name:[v.l0.color.foregroundDefault,v.l0.fontWeight.medium],content:[v.l0.p(8),v.l0.flex.growAndShrink(1),v.l0.position.relative],loading:[v.l0.coverContainer,v.l0.center],error:[v.l0.m(8),v.l0.borderRadius(8),v.l0.overflow("hidden")],xterm:[v.l0.coverContainer,{overflow:"hidden",borderBottomLeftRadius:8,borderBottomRightRadius:8,"& > div":[v.l0.coverContainer,v.l0.p(8)]}]});function t2(e){var t,n,r=e.build,i=e.onBack,o=e.fs,a=e.openFile,l=e.onViewAppLogs,c=(0,u._)((0,tn.Z)({openFile:a,listFiles:o.listFiles}),2),s=c[0],f=c[1],h=(t={variables:{input:{buildId:r.id}},ssr:!1,fetchPolicy:"cache-and-network"},n=(0,U._)({},tO,t),en.a(tW,n)),y=h.data,b=h.loading,w=(0,g.useMemo)(function(){if(!y)return null;var e=[],t="HostingBuildDeployActionHistoryResults"===y.hostingBuildDeployActionHistory.__typename?y.hostingBuildDeployActionHistory.results:null;if(t){var n=void 0,r=void 0,i=void 0,o=!0,a=!1,l=void 0;try{for(var c,s,u=t[Symbol.iterator]();!(o=(s=u.next()).done);o=!0)!function(){var t=s.value;if("HostingBuildDeployLogAction"===t.__typename)return e.push(t.log);tv.some(function(e){return e.statusType===t.status})&&(n=t.status),t.status===I.Fe.Failed&&(r=n)}()}catch(e){a=!0,l=e}finally{try{o||null==u.return||u.return()}finally{if(a)throw l}}var d=n?null===(c=ty(n))||void 0===c?void 0:c.id:void 0;return r&&(i=d),{logs:e,activeStage:d,erroredStage:i,erroredStatus:r}}},[y]);return(0,g.useEffect)(function(){if(s&&w){var e=!0,t=!1,n=void 0;try{for(var r,i=w.logs[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value;s.write(o)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},[s,w]),(0,d.BX)(p.G,{css:t1.root,children:[(0,d.BX)(p.G,{css:t1.header,children:[(0,d.tZ)(eB.hU,{alt:"Back to timeline",onClick:function(){return i()},children:(0,d.tZ)(tH.Z,{})}),(0,d.tZ)(p.G,{children:(0,d.BX)($.xv,{color:"dimmer",multiline:!1,children:[(0,d.tZ)("span",{css:t1.name,children:r.user.displayName+" "}),(0,tY.BX)(r.status)]})}),(0,d.tZ)(tz,{build:r})]}),(null==w?void 0:w.erroredStatus)?(0,d.BX)(p.G,{css:t1.error,children:[(null==w?void 0:w.erroredStatus)===I.Fe.Building?(0,d.tZ)(tT,{provider:r.provider,openFile:a}):null,(null==w?void 0:w.erroredStatus)===I.Fe.Promoting?(0,d.tZ)(tE,{provider:r.provider,openFile:a,onViewApplicationLogs:l}):null]}):null,(0,d.tZ)(t0,{activeStage:null==w?void 0:w.activeStage,erroredStage:null==w?void 0:w.erroredStage}),(0,d.tZ)(p.G,{css:t1.divider}),(0,d.BX)(B.Tg,{css:t1.content,children:[(0,d.tZ)(p.G,{css:t1.xterm,innerRef:f}),b||!s?(0,d.tZ)(p.G,{css:t1.loading,children:(0,d.tZ)(m.Z,{color:v.TV.white,size:24})}):null]})]})}var t8=(0,S.X)({item:v.l0.rowWithGap(12),past:{":last-of-type":{"[data-timeline-line]":{display:"none"}}},future:{":last-of-type":{"[data-timeline-line]":{bottom:-19}}},animate:{animation:(0,X.Gs)(36.4)+" 300ms ease-out forwards"}}),t4=(0,S.X)({root:[v.l0.colWithGap(8)],empty:[v.l0.pb(8),v.l0.center,v.l0.align.stretch],items:[],loadMore:[v.l0.center],item:[v.l0.rowWithGap(8),v.l0.pl(8),v.l0.pr(4),v.l0.pb(12),v.l0.align.center,v.l0.flex.growAndShrink(1),v.l0.color.foregroundDimmest,v.l0.hover(v.l0.color.foregroundDefault)],itemMainText:[v.l0.flex.growAndShrink(1),(0,V._)({},v.nC.min(640),v.l0.flex.growAndShrink(0))],itemLine:[v.l0.display.none,(0,V._)({},v.nC.min(640),[v.l0.display.flex,v.l0.flex.growAndShrink(1),v.l0.border({color:v.TV.outlineDimmest,direction:"top"})])],itemRight:[v.l0.rowWithGap(6),v.l0.justify.end,v.l0.textAlign.right],itemContent:[v.l0.rowWithGap(8),v.l0.flex.growAndShrink(1),v.l0.align.center],itemPast:[t8.item,t8.past],itemPastAnimate:[t8.item,t8.past,t8.animate],itemFuture:[t8.item,t8.future],itemFutureAnimate:[t8.item,t8.future,t8.animate]}),t3=(0,S.X)({button:[v.l0.reset.button,v.l0.cursor.pointer,v.l0.borderRadius(8),v.l0.display.flex,v.l0.rowWithGap(6),v.l0.align.center,v.l0.px(8),v.l0.color.foregroundDimmer,v.l0.height(32),v.l0.hover(v.l0.color.foregroundDefault)]}),t5=(0,S.X)({button:t3.button,buttonHighlight:[t3.button,v.l0.color.accentNegativeStrongest,v.l0.backgroundColor.accentNegativeDimmest,v.l0.border({color:v.TV.accentNegativeDimmer})],buttonOpen:v.l0.flex.growAndShrink(1),buttonClosed:[v.l0.flex.growAndShrink(1),v.l0.pb(12)],buttonContent:[v.l0.flex.growAndShrink(1),v.l0.rowWithGap(8),v.l0.align.center]});function t6(e){var t=e.items,n=e.onClick,r=(0,u._)((0,g.useState)(!1),2),i=r[0],o=r[1],a=(0,y.pn)(),l=(0,g.useRef)(void 0);(0,g.useEffect)(function(){(null==a?void 0:a.status)!==void 0&&(l.current=null==a?void 0:a.status)},[a,null==a?void 0:a.status]);var c=!a&&l.current!==I.Fe.Building&&l.current!==I.Fe.Success,s=c?v.TV.accentNegativeStronger:v.TV.foregroundDimmer;return 0===t.length?null:(0,d.BX)(p.G,{children:[(0,d.BX)(p.G,{css:v.l0.rowWithGap(12),children:[(0,d.tZ)(e7,{type:i?"futureFailOpen":"futureFailClosed"}),(0,d.tZ)(p.G,{css:i?t5.buttonOpen:t5.buttonClosed,children:(0,d.BX)("button",{onClick:function(){return o(!i)},css:c?t5.buttonHighlight:t5.button,children:[(0,d.BX)(p.G,{css:t5.buttonContent,children:[c?(0,d.tZ)(R.Z,{color:v.TV.accentNegativeStronger}):null,(0,d.BX)($.xv,{children:[t.length," ",(0,tJ.Z)("build",t.length)," failed"]}),i?null:(0,d.BX)($.xv,{children:[t.length>1?"Most recent: ":null,(0,ti.Z)(new Date(t[0].timeCreated),Date.now(),{addSuffix:!0})]})]}),i?(0,d.tZ)(tt.Z,{color:s}):(0,d.tZ)(eJ.Z,{color:s})]})})]}),i?(0,d.tZ)(p.G,{css:v.l0.pt(8),children:t.map(function(e){return(0,d.tZ)(t7,{item:e,onClick:function(){return n(e.build)},type:"future"},e.id)})}):null]})}function t9(e){var t,n,r,i=e.replId,o=e.onSelect,a=e.type,l=void 0===a?"default":a,c=(t=(0,U._)({},tO,{variables:{replId:i,count:20},fetchPolicy:"cache-and-network",ssr:!1}),en.a(tF,t)),s=c.data,u=c.previousData,f=c.loading,h=c.error,v=c.fetchMore,b=null!=s?s:u,x=(null==b?void 0:b.repl.__typename)==="Repl"?b.repl:null,S=(null==x?void 0:null===(r=x.hostingDeployment)||void 0===r?void 0:r.__typename)==="HostingDeployment"?x.hostingDeployment:null,k=(n=(0,w._)(function(){var e;return(0,Z.Jh)(this,function(t){switch(t.label){case 0:if(!(e=null==S?void 0:S.activityLogs.pageInfo.nextCursor))return[2];return[4,v({variables:{after:e,count:20}})];case 1:return t.sent(),[2]}})}),function(){return n.apply(this,arguments)}),_=(0,tR.Z)({onLoadMore:k,rootMargin:"0px 0px 300px 0px"}).targetRef,E=(0,g.useRef)(""),T=(0,y.$y)(),D=(0,y.pn)(),G=(0,g.useRef)(void 0);if((0,g.useEffect)(function(){(null==D?void 0:D.id)!==void 0&&(G.current=null==D?void 0:D.id)},[null==D?void 0:D.id]),f&&!S)return"failureQueue"===l?null:(0,d.tZ)(nt,{});if(!(null==S?void 0:S.activityLogs))return null;var B=S.activityLogs,P=B.items,A=B.pageInfo;if(0===P.length)return null;if(h)return(0,d.tZ)(p.G,{css:t4.empty,children:(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:"Something went wrong"})});P.length&&(P[0].build.id===(null==T?void 0:T.id)&&P[1]?E.current=P[1].build.id:E.current=P[0].build.id);var N=function(e,t){var n=[],r=(null==t?void 0:t.timeCreated)?new Date(t.timeCreated):null,i=!0,o=!1,a=void 0;try{for(var l,c=e[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;if(s.type!==I.dD.Fail||r&&r.getTime()>new Date(s.build.timeCreated).getTime()||(null==t?void 0:t.id)===s.build.id)break;n.push(s)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return n}(P,T);return"failureQueue"===l?(0,d.tZ)(X.un,{render:N.length>0,initialHeight:44,children:(0,d.tZ)(t6,{items:N,onClick:o})}):(0,d.BX)(p.G,{css:t4.root,"data-history-timeline-items":P.length-N.length,children:[(0,d.tZ)(p.G,{css:t4.items,children:P.map(function(e,t){return e.build.id===(null==T?void 0:T.id)||t<N.length?null:(0,d.tZ)(t7,{item:e,onClick:function(){return o(e.build)}},e.id)})}),A.nextCursor?(0,d.tZ)(p.G,{css:t4.loadMore,children:(0,d.tZ)(eB.hU,{disabled:f,tooltipHidden:!0,alt:"Show more",onClick:k,ref:_,children:f?(0,d.tZ)(m.Z,{}):(0,d.tZ)(tI.Z,{})})}):null]})}function t7(e){var t=e.item,n=e.onClick,r=e.timeline,i=e.type,o=(0,d.BX)(p.G,{css:t4.item,children:[(0,d.tZ)(p.G,{css:t4.itemMainText,children:(0,d.tZ)(tq,{activityLogItem:t})}),(0,d.tZ)(p.G,{css:t4.itemLine}),(0,d.BX)(p.G,{css:t4.itemRight,children:[(0,d.tZ)(tP,{activityLogItem:t}),(0,d.tZ)($.xv,{multiline:!1,children:(0,ti.Z)(new Date(t.timeCreated),Date.now(),{addSuffix:!0})}),(0,d.tZ)(eB.hU,{alt:"View deploy logs",onClick:n,children:(0,d.tZ)(E.Z,{})})]})]});return void 0===r||r?(0,d.BX)(p.G,{css:"past"===(void 0===i?"past":i)?t4.itemPast:t4.itemFuture,children:[(0,d.tZ)(e7,{type:t.type===I.dD.Fail?"pastFail":"pastSuccess"}),o]}):o}var ne=(0,S.X)({loading:[v.l0.rowWithGap(12),{":last-of-type":{"[data-timeline-line]":{display:"none"}}}],loadingItem:[K.p.backgroundPulse(),v.l0.height(20.4),v.l0.mt(2),v.l0.ml(4),v.l0.flex.growAndShrink(1),v.l0.borderRadius(6),{opacity:.5,marginBottom:14}]});function nt(){return(0,d.tZ)(p.G,{children:[,,,].fill(0).map(function(e,t){return(0,d.BX)(p.G,{css:ne.loading,children:[(0,d.tZ)(e7,{type:"pastNeutral"}),(0,d.tZ)(B.Tg,{elevated:!0,css:ne.loadingItem})]},t)})})}var nn=n(18836),nr=n(30983),ni=n(97615),no=(0,S.X)({self:[v.l0.colWithGap(8)],selfGrow:[v.l0.colWithGap(8),v.l0.flex.grow(1)],label:[v.l0.rowWithGap(8),v.l0.align.center],labelText:{},header:[v.l0.display.flex,v.l0.flex.row,v.l0.justify.spaceBetween,v.l0.align.center],actions:[v.l0.rowWithGap(4)],labelLoading:[v.l0.rowWithGap(8),v.l0.align.center,K.p.foregroundPulse(),v.l0.width(200),v.l0.borderRadius(8)],inputLoading:[K.p.foregroundPulse(),v.l0.borderRadius(8)]}),na=function(e){var t=e.id,n=e.title,r=e.information,i=e.optional,o=e.actions,a=e.children,l=e.grow;return(0,d.BX)(p.G,{css:void 0!==l&&l?no.selfGrow:no.self,children:[(0,d.BX)(p.G,{css:no.header,children:[(0,d.BX)(p.G,{tag:"label",htmlFor:t,css:no.label,children:[(0,d.tZ)($.xv,{color:"dimmer",multiline:!1,children:n}),(0,d.tZ)(nr.u,{tooltip:r,children:(0,d.tZ)(ni.Z,{color:v.TV.foregroundDimmest})}),void 0!==i&&i?(0,d.tZ)($.xv,{variant:"small",color:"dimmest",multiline:!1,children:"optional"}):null]}),o?(0,d.tZ)(p.G,{css:no.actions,children:o}):null]}),a]})},nl=function(){return(0,d.BX)(p.G,{css:no.self,children:[(0,d.tZ)(p.G,{css:no.header,children:(0,d.tZ)(p.G,{css:no.labelLoading,children:(0,d.tZ)($.xv,{color:"dimmer",multiline:!1,children:"\xa0"})})}),(0,d.tZ)(p.G,{css:no.inputLoading,children:(0,d.tZ)(nn.II,{disabled:!0})})]})},nc=function(e){return e.loading?(0,d.tZ)(p.G,{css:[v.l0.p(8),v.l0.center],children:(0,d.tZ)(m.Z,{})}):null},ns=(0,S.X)({error:[v.l0.flex.grow(0),v.l0.mt(0)]}),nu=function(e){var t=e.text;return(0,d.tZ)(H,{css:ns.error,children:(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:t})})},nd=(0,S.X)({back:[v.l0.flex.row,v.l0.align.center]}),nf=function(e){var t=e.onBack;return(0,d.tZ)(p.G,{css:nd.back,children:(0,d.tZ)(eB.hU,{alt:"Back",tooltipHidden:!0,onClick:t,children:(0,d.tZ)(tH.Z,{})})})},nh=n(4927);function np(){var e=(0,ee._)(["\n  query ReservedVMMachineConfigurations {\n    hostingMachineConfigurations(input: { provider: gce }) {\n      __typename\n      ... on HostingMachineConfigurationsResults {\n        results {\n          ...MachineConfiguration\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return np=function(){return e},e}var nm={},nv=(0,et.Ps)(np(),nh.bN),ng=n(37109),ny=n(12874),nb=n(73524),nw=n(23211),nZ=(0,S.X)({header:[v.l0.colWithGap(4),v.l0.mb(16)],costWrapper:[v.l0.rowWithGap(2),v.l0.align.center,v.l0.flex.shrink(1)],cost:[v.l0.rowWithGap(4),v.l0.align.baseline],selectWrapper:v.l0.rowWithGap(12),selectInner:[v.l0.flex.growAndShrink(1)],select:[v.l0.border({color:ts.TV.outlineDefault}),{flex:"1 1 auto"}]}),nx=function(e){var t,n=e.initialMachineConfiguration,r=e.isTeamRepl,i=e.onChange,o=e.onConfirm,a=e.onError,l=e.onBack,c=(0,u._)((0,g.useState)(n?(0,O._)((0,U._)({},n),{maxInstances:1}):void 0),2),s=c[0],f=c[1],h=(0,u._)((0,nw.gr)(null==s?void 0:s.configurationSlug),2),m=h[0],y=h[1],b=(0,u._)((0,g.useState)(!1),2),w=b[0],Z=b[1],x=(t=(0,U._)({},nm,{onCompleted:function(e){"HostingMachineConfigurationsResults"!==e.hostingMachineConfigurations.__typename&&a("Something went wrong")},onError:function(e){return a(e.message)}}),en.a(nv,t)),C=x.data,S=x.loading,k=(null==C?void 0:C.hostingMachineConfigurations.__typename)==="HostingMachineConfigurationsResults"?C.hostingMachineConfigurations.results:null;(0,g.useEffect)(function(){e0({context:A.k.AutoscaleMachineConfiguration})},[]),(0,g.useEffect)(function(){if(k&&!s){var e=r?k.find(function(e){return"e2-micro"===e.slug}):k.find(function(e){return"e2-small"===e.slug});if(!e){a("An error occurred trying to validate default machine configuration");return}var t={configurationId:e.id,configurationLabel:e.label,configurationSlug:e.slug,maxInstances:1};f(t),"function"==typeof i&&i(t)}},[k,s,r,i,a]);var _=k&&(null==k?void 0:k.length)>0,E=S||r||w||!_;return(0,d.BX)(d.HY,{children:[(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(nf,{onBack:l})}),(0,d.BX)(H,{maxWidth:!0,children:[(0,d.BX)(p.G,{css:nZ.header,children:[(0,d.tZ)($.xv,{variant:"subheadBig",children:"Reserved VM configuration"}),(0,d.tZ)($.xv,{variant:"small",color:"dimmer",children:"Reserved VM apps are always on and can have a dedicated machine. You are billed for the total number of hours your machines have been running for. The cost per hour changes depending on your machine configuration."})]}),(0,d.tZ)(na,{id:"machineConfiguration",title:"Machine Configuration",information:"Your machine configuration determines the number of vCPUs and memory available to your app. You can change it at any time.",children:s?(0,d.BX)(d.HY,{children:[(0,d.tZ)(p.G,{css:nZ.selectWrapper,children:r?(0,d.tZ)(nn.II,{value:s.configurationLabel,disabled:!0}):(0,d.BX)(d.HY,{children:[(0,d.tZ)(p.G,{css:nZ.selectInner,children:(0,d.tZ)(ng.P,{css:nZ.select,initialSelectedItem:{id:s.configurationId,title:s.configurationLabel},items:_?Object.values(k).map(function(e){var t=e.id;return{title:e.label,id:t}}):[],onChange:function(e){var t=e.id,n=null==k?void 0:k.find(function(e){return e.id===t});if(!n){a("An error occurred trying to validate selected machine configuration");return}var r={configurationId:n.id,configurationLabel:n.label,configurationSlug:n.slug,maxInstances:1};f(r),"function"==typeof i&&i(r)},disabled:E})}),(0,d.tZ)(p.G,{css:nZ.costWrapper,children:(0,d.BX)(p.G,{css:nZ.cost,children:[(0,d.BX)($.xv,{variant:"subheadDefault",multiline:!1,children:["$",y]}),(0,d.tZ)($.xv,{color:"dimmer",variant:"small",multiline:!1,children:"per month"}),(0,d.BX)($.xv,{color:"dimmer",variant:"small",multiline:!1,children:["($",m,"/hour)"]})]})})]})}),"function"==typeof o?(0,d.BX)(p.G,{css:[v.l0.colWithGap(8),v.l0.pt(8)],children:[(0,d.tZ)(D.zx,{colorway:"primary",text:"Approve and update",iconRight:(0,d.tZ)(ny.Z,{}),onClick:function(){if(!s){a("An error occurred trying to validate selected machine configuration");return}Z(!0),o(s)},loading:S,disabled:E}),(0,d.BX)($.xv,{color:"dimmest",children:["Your deployed app will incur charges for any resource usage."," ",(0,d.tZ)("a",{href:nb.TT.ABOUT_USAGE_BASED_BILLING,target:"_blank",rel:"noopener",children:"Learn more"})]})]}):null]}):(0,d.tZ)(p.G,{css:[K.p.foregroundPulse(),v.l0.borderRadius(8)],children:(0,d.tZ)(nn.II,{disabled:!0})})})]})]})},nC=n(40028),nS=n(40699);function nk(e,t){if(void 0!==t)switch(t){case I.DZ.HostingTierE2Micro:return e.hostingTierE2Micro;case I.DZ.HostingTierE2Small:return e.hostingTierE2Small;case I.DZ.HostingTierE2Medium:return e.hostingTierE2Medium;case I.DZ.HostingTierN1Custom_1_4:return e.hostingTierN1Custom1_4;case I.DZ.HostingTierE2Standard_2:return e.hostingTierE2Standard2;case I.DZ.HostingTierE2Standard_4:return e.hostingTierE2Standard4;default:(0,nC.Z)(t)}}function n_(e){var t=nS.r4[e],n=t.vCpu,r=t.ram,i=t.dedicated;return"".concat(i?"Dedicated ":"").concat(n," vCPU / ").concat(r," GiB RAM")}var nE=(a={},(0,V._)(a,I.r4.Gce,"Reserved VM"),(0,V._)(a,I.r4.CloudRun,"Autoscale"),(0,V._)(a,I.r4.Static,"Static"),(0,V._)(a,I.r4.Cron,"Scheduled"),a),nT=n(25425),nR=n(33988),nI=n.n(nR),nD=n(44620),nG=n(97411),nB=function(e){var t=e.currentBuild,n=(0,u._)((0,g.useState)([]),2),r=n[0],i=n[1];return(0,g.useEffect)(function(){var e=(null===(r=t.repl.hostingDeployment)||void 0===r?void 0:r.__typename)==="HostingDeployment"&&t.repl.hostingDeployment.id,n=[];switch(t.provider){case I.r4.Goval:n.push({href:"https://".concat(e,".id.repl.co"),private:!0});break;case I.r4.Gce:case I.r4.CloudRun:case I.r4.Static:var r,o,a,l,c,s,u=(null===(o=t.repl.hostingDeployment)||void 0===o?void 0:o.__typename)==="HostingDeployment"?null===(a=t.repl.hostingDeployment)||void 0===a?void 0:a.replitAppSubdomain:void 0;!u&&(null===(l=t.repl.owner)||void 0===l?void 0:l.username)&&(u="".concat(t.repl.slug,"-").concat(t.repl.owner.username)),u&&n.push({href:"https://".concat(u).concat((null===(s=window)||void 0===s?void 0:null===(c=s.location)||void 0===c?void 0:c.hostname)!=="replit.com"?".staging":"",".replit.app"),private:!1})}if(t.repl.domains){var d=t.repl.domains.filter(function(t){return(null==t?void 0:t.hosting_deployment_id)===e}),f=!0,h=!1,p=void 0;try{for(var m,v=d[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;g&&n.push({href:"https://".concat(g.domain),private:!1,state:"verified"!==g.state?g.state:void 0})}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}}i(n)},[t]),(0,d.tZ)(p.G,{css:[v.l0.colWithGap(2),v.l0.flex.growAndShrink(1)],children:r.map(function(e,t){return(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.align.center],children:[(0,d.tZ)($.xv,{css:[v.l0.flex.shrink(1)],multiline:!1,children:(0,d.tZ)("a",{href:e.href,target:"_blank",css:[v.l0.color.foregroundDefault],children:e.href})}),e.private?(0,d.tZ)(nG.Z,{color:v.TV.foregroundDefault}):null,(0,d.tZ)("a",{href:e.href,target:"_blank",css:[v.l0.display.flex,v.l0.align.center],children:(0,d.tZ)(nD.Z,{color:v.TV.foregroundDefault})}),e.state?(0,d.BX)($.xv,{multiline:!1,children:["(",e.state,")"]}):null]},"domains-".concat(t))})})},nP=(0,j.F4)("\n    50% {\n      background-color: ".concat(v.TV.accentPositiveDimmest,";\n      outline: 1px solid ").concat(v.TV.accentPositiveDimmer,";\n      box-shadow: 0px 0px 32px rgba(0, 145, 24, 0.3);\n    }\n")),nA=(0,S.X)({deploymentInfo:[v.l0.colWithGap(8),v.l0.p(16),v.l0.borderRadius(),{outline:"1px solid transparent"}]}),nN=(0,S.X)({textButton:[v.l0.cursor.pointer,v.l0.reset.button,v.l0.color.accentPrimaryStronger,v.l0.focusRing,v.l0.hover(v.l0.color.accentPrimaryStrongest),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}],textLink:v.l0.hover(v.l0.color.accentPrimaryStrongest),labeledSection:[v.l0.flex.growAndShrink(1),(0,V._)({},v.nC.min(400),[v.l0.flex.row,v.l0.align.baseline])],labeledSectionFullWidth:[v.l0.flex.growAndShrink(1),(0,V._)({},v.nC.min(400),[v.l0.flex.row,v.l0.align.baseline,v.l0.flex.grow(1),v.l0.justify.spaceBetween])],buildStatus:[v.l0.rowWithGap(4),v.l0.align.center],deploymentInfo:nA.deploymentInfo,deploymentInfoAnimate:[nA.deploymentInfo,{animation:"".concat(nP," 700ms ease-out")}],deploymentInfoContent:[v.l0.colWithGap(8),(0,V._)({},v.nC.min(400),v.l0.colWithGap(4))]}),nL=function(e){var t=e.text,n=e.onClick;return(0,d.tZ)("button",{css:nN.textButton,onClick:n,children:t})},nU=function(e){var t=e.name,n=e.sku,r=e.canManage,i=e.usageLink,o=e.onManageClick;return(0,d.BX)(p.G,{css:[v.l0.rowWithGap(6),v.l0.flex.wrap],children:[(0,d.tZ)($.xv,{multiline:!1,children:t}),n?(0,d.BX)($.xv,{color:"dimmest",multiline:!1,children:["(",n,")"]}):null,r?(0,d.tZ)(nL,{text:"Manage",onClick:o}):null,i?(0,d.tZ)(nI(),{legacyBehavior:!0,href:"/usage",passHref:!0,children:(0,d.tZ)("a",{css:nN.textLink,children:(0,d.tZ)($.xv,{children:"See all usage"})})}):null]})},nO=function(e){var t=e.label,n=e.children,r=e.fullWidth;return(0,d.BX)(p.G,{css:r?nN.labeledSectionFullWidth:nN.labeledSection,children:[(0,d.tZ)(p.G,{css:v.l0.minWidth(100),children:(0,d.tZ)($.xv,{css:v.l0.color.foregroundDimmer,multiline:!1,children:t})}),n]})},nM=function(e){var t,n,r=e.provider,i=e.machine,o=e.onViewBuildLogs,a=e.onManageClick,l=(0,y.kW)(),c=(0,y.Sl)((0,x.Z)()).hostingTier,s=(0,y.$y)(),u=(0,nT.P5)({controlName:nw.dD,logFlagToAnalytics:!1}),f=void 0!==s,h=r===I.r4.Gce&&f&&!u&&!c,m=r!==I.r4.Static&&f&&null===s.hasImageTag,v=!!((l===b.z.Ready||l===b.z.Suspended)&&!m),w=null,Z=null,S=null,k=null,_=(0,y.pn)(),E=(0,g.useRef)(void 0);(0,g.useEffect)(function(){_&&(E.current=null==_?void 0:_.id)},[_,null==_?void 0:_.id]);var T=(null==s?void 0:s.status)===I.Fe.Success,G=(null==s?void 0:s.id)===E.current,P=(null==s?void 0:s.provider)!==I.r4.Cron;switch(s&&(w=(0,d.BX)(d.HY,{children:[(0,d.tZ)(nO,{label:"Status",children:(0,d.tZ)(p.G,{css:nN.buildStatus,children:(0,d.tZ)(tY.hD,{onClick:function(){o(s)}})})}),P?(0,d.tZ)(nO,{label:"Domain",children:(0,d.tZ)(nB,{currentBuild:s})}):null]})),r){case I.r4.Gce:if(u){Z=(0,d.tZ)(nO,{label:"Type",fullWidth:!f,children:(0,d.tZ)(nU,{name:nE[r],sku:null==i?void 0:i.configurationLabel,canManage:v,onManageClick:a})});break}if(!c)break;Z=(0,d.tZ)(nO,{label:"Type",fullWidth:!f,children:(0,d.tZ)(nU,{name:nE[r],sku:(null==i?void 0:i.configurationLabel)||n_(c.sku),canManage:v,onManageClick:a})});break;case I.r4.CloudRun:Z=(0,d.tZ)(nO,{label:"Type",fullWidth:!f,children:(0,d.tZ)(nU,{name:nE[r],sku:i?"".concat(i.configurationLabel," / ").concat(i.maxInstances," Max"):"Beta",canManage:v,usageLink:!0,onManageClick:a})});break;case I.r4.Static:Z=(0,d.tZ)(nO,{label:"Type",fullWidth:!f,children:(0,d.tZ)(nU,{name:nE[r],sku:void 0,canManage:v&&f,onManageClick:a})});break;case I.r4.Cron:Z=(0,d.tZ)(nO,{label:"Type",fullWidth:!f,children:(0,d.tZ)(nU,{name:nE[r],sku:"".concat(null==s?void 0:null===(t=s.machineJob)||void 0===t?void 0:t.timezone," ").concat(null==s?void 0:null===(n=s.machineJob)||void 0===n?void 0:n.crontab),canManage:!1,onManageClick:a})});case I.r4.Goval:}return(m&&(S=(0,d.tZ)(p.G,{children:(0,d.tZ)(C.E,{icon:(0,d.tZ)(R.Z,{}),colorway:"warning",text:"To upgrade, please redeploy."})})),h&&(k=(0,d.tZ)(D.zx,{onClick:function(){a()},text:"Select hosting tier"})),w||Z||S||k)?(0,d.BX)(B.Tg,{elevated:!0,css:T&&G?nN.deploymentInfoAnimate:nN.deploymentInfo,style:{paddingTop:s?12:16},children:[s?(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:"Production"}):null,(0,d.BX)(p.G,{css:nN.deploymentInfoContent,children:[w,Z,S,k]})]}):null},nX=n(2038),nF=n(40664),nW=n(65143),nH=(0,S.X)({styles0:[v.l0.height(128),v.l0.width(128),v.l0.borderRadius(2),G.gU.nofill],styles1:[v.l0.position.absolute]}),nV=(0,S.X)({container:[v.l0.align.center,v.l0.colWithGap(4)],qrContainer:[v.l0.align.center,v.l0.justify.center]});function nz(e){var t=e.color;return(0,d.BX)(p.G,{css:nV.container,children:[(0,d.BX)(p.G,{css:nV.qrContainer,children:[(0,d.tZ)("svg",{viewBox:"0 0 128 128",css:nH.styles0,target:"_blank",onClick:function(){window.open("/mobile")},children:(0,d.tZ)("path",{fill:null!=t?t:v.TV.foregroundDefault,d:"m0,13.58v13.58h27.15V0H0v13.58ZM34.91,1.94v1.94h-3.88v3.88h3.88v-3.88h7.76v3.88h3.88v-3.88h-3.88V0h-7.76v1.94Zm31.03,0v1.94h-15.52v7.76h-15.52v3.88h7.76v7.76h-3.88v-3.88h-7.76v11.64h-15.52v7.76h-3.88v3.88h-3.88v-3.88H0v3.88h7.76v3.88H0v7.76h3.88v3.88H0v3.88h3.88v3.88H0v3.88h3.88v3.88H0v3.88h3.88v3.88H0v3.88h15.52v3.88h-3.88v7.76h3.88v-3.88h3.88v-3.88h7.76v-3.88h-7.76v-7.76h3.88v3.88h3.88v-3.88h3.88v-3.88h3.88v-19.39h7.76v-3.88h-3.88v-3.88h-3.88v-3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h3.88v-3.88h3.88v-7.76h3.88v3.88h3.88v7.76h-3.88v3.88h11.64v-3.88h3.88v3.88h15.52v3.88h-3.88v3.88h3.88v11.64h11.64v3.88h-11.64v3.88h-3.88v3.88h15.52v7.76h-3.88v-3.88h-3.88v3.88h-3.88v-3.88h-3.88v3.88h3.88v15.52h3.88v15.52h7.76v3.88h-3.88v3.88h-3.88v-3.88h-3.88v3.88h-7.76v-3.88h-3.88v3.88h3.88v3.88h-11.64v-3.88h3.88v-7.76h7.76v-3.88h7.76v-3.88h-3.88v-3.88h-3.88v-3.88h3.88v-11.64h-11.64v3.88h3.88v3.88h-7.76v-3.88h-7.76v-3.88h-7.76v3.88h7.76v7.76h-7.76v-3.88h-15.52v7.76h3.88v-3.88h7.76v3.88h3.88v3.88h-3.88v3.88h-11.64v-3.88h-3.88v-7.76h-3.88v15.52h3.88v3.88h3.88v-3.88h3.88v3.88h3.88v3.88h3.88v3.88h7.76v-3.88h-7.76v-3.88h15.52v-3.88h-3.88v-3.88h7.76v-7.76h11.64v7.76h-7.76v3.88h-3.88v7.76h-3.88v3.88h3.88v3.88h27.15v-7.76h3.88v7.76h7.76v-3.88h3.88v3.88h3.88v-3.88h-3.88v-7.76h3.88v3.88h3.88v-3.88h3.88v-3.88h-3.88v3.88h-3.88v-3.88h-3.88v-11.64h3.88v3.88h3.88v3.88h7.76v-3.88h-3.88v-3.88h-7.76v-7.76h-3.88v-7.76h7.76v7.76h7.76v-3.88h-3.88v-7.76h-7.76v-3.88h-7.76v3.88h-3.88v-11.64h3.88v3.88h7.76v-3.88h-7.76v-3.88h3.88v-7.76h3.88v-3.88h3.88v3.88h3.88v3.88h-3.88v15.52h3.88v-11.64h3.88v-7.76h-3.88v-7.76h3.88v-7.76h-3.88v-11.64h-3.88v11.64h3.88v3.88h-3.88v3.88h-7.76v-3.88h3.88v-3.88h-3.88v-3.88h3.88v-3.88h-3.88v3.88h-3.88v-7.76h-7.76v3.88h3.88v3.88h-11.64v-3.88h3.88v-11.64h-3.88v7.76h-3.88v-11.64h3.88v-3.88h-3.88v3.88h-3.88v-3.88h-3.88v-3.88h7.76V3.88h3.88v3.88h3.88V0h-7.76v3.88h-3.88V0h-3.88v3.88h-7.76V0h-7.76v1.94Zm34.91,11.64v13.58h27.15V0h-27.15v13.58Zm-31.03-5.82v3.88h-7.76v3.88h-3.88v7.76h3.88v3.88h-3.88v-3.88h-3.88v3.88h-3.88v3.88h-3.88v7.76h-3.88v-7.76h-3.88v7.76h-3.88v3.88h-3.88v-3.88h-11.64v-3.88h11.64v-3.88h3.88v-7.76h3.88v3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h3.88v-3.88h-7.76v-3.88h3.88v-3.88h3.88v3.88h3.88v-7.76h7.76v-3.88h3.88v3.88Zm-46.8,5.82v9.45H4.13V4.13h18.89v9.45Zm100.85,0v9.45h-18.89V4.13h18.89v9.45Zm-116.11,0v5.82h11.64V7.76H7.76v5.82Zm73.7-3.88v1.94h-3.88v7.76h-3.88v3.88h3.88v3.88h3.88v-7.76h3.88v7.76h-3.88v3.88h-3.88v-3.88h-3.88v3.88h-3.88v3.88h-3.88v-3.88h3.88v-3.88h-3.88v-11.64h3.88v3.88h3.88V7.76h7.76v1.94Zm27.15,3.88v5.82h11.64V7.76h-11.64v5.82Zm-38.79,11.64v1.94h3.88v-3.88h-3.88v1.94Zm-27.15,3.88v1.94h3.88v-3.88h-3.88v1.94Zm46.55,7.76v1.94h-11.64v-3.88h11.64v1.94Zm-62.06,7.76v1.94h-3.88v3.88h11.64v3.88h-11.64v3.88h3.88v3.88h3.88v11.64h-3.88v3.88h-3.88v-3.88h-3.88v3.88h-3.88v3.88h-3.88v-3.88h-3.88v-7.76h3.88v-11.64h3.88v3.88h3.88v-7.76h-7.76v-3.88h-3.88v-3.88h3.88v-3.88h15.52v1.94Zm81.45,1.94v3.88h3.88v7.76h-3.88v7.76h-3.88v3.88h-3.88v-3.88h3.88v-11.64h-3.88v-3.88h-3.88v-3.88h-3.88v-3.88h15.52v3.88Zm-96.97,1.94v1.94h3.88v-3.88h-3.88v1.94Zm89.21,0v1.94h3.88v3.88h3.88v-3.88h-3.88v-3.88h-3.88v1.94Zm-81.45,3.88v1.94h3.88v-3.88h-3.88v1.94Zm77.58,3.88v1.94h-3.88v-3.88h3.88v1.94Zm-77.58,9.7v3.88h-7.76v7.76h3.88v-3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h-3.88v-3.88h3.88v-3.88h-7.76v3.88Zm19.39-1.94v1.94h3.88v-3.88h-3.88v1.94Zm0,11.64v1.94h-3.88v7.76h-3.88v3.88h3.88v-3.88h3.88v3.88h3.88v-7.76h-3.88v-3.88h3.88v-3.88h-3.88v1.94Zm58.18,7.76v1.94h3.88v-3.88h3.88v11.64h-7.76v-3.88h-3.88v-7.76h3.88v1.94Zm15.52,0v1.94h-3.88v-3.88h3.88v1.94ZM0,95.03v1.94h7.76v-3.88H0v1.94Zm23.27,0v1.94h3.88v-3.88h-3.88v1.94Zm46.55,0v1.94h-3.88v-3.88h3.88v1.94Zm38.79,7.76v5.82h-11.64v-11.64h11.64v5.82ZM0,114.42v13.58h27.15v-27.15H0v13.58Zm65.94-11.64v1.94h-3.88v-3.88h3.88v1.94Zm34.91,0v1.94h3.88v-3.88h-3.88v1.94Zm-42.67,3.88v1.94h-3.88v3.88h-3.88v-3.88h3.88v-3.88h3.88v1.94Zm-35.16,7.76v9.45H4.13v-18.89h18.89v9.45Zm-15.26,0v5.82h11.64v-11.64H7.76v5.82Zm100.85,3.88v1.94h-3.88v-3.88h3.88v1.94Zm-69.82,3.88v1.94h-3.88v3.88h3.88v-3.88h3.88v3.88h3.88v-3.88h-3.88v-3.88h-3.88v1.94Zm54.3,0v1.94h-3.88v-3.88h3.88v1.94Zm31.03,3.88v1.94h3.88v-3.88h-3.88v1.94Z"})}),(0,d.tZ)(nW.Z,{size:32,css:nH.styles1,color:t})]}),(0,d.tZ)($.xv,{variant:"small",color:"dimmer",children:"Scan to install"})]})}var nj=n(49344),nq=n(58719),nY=n(31661),nJ=n(67795),nK=(0,S.X)({row:[v.l0.pb(12),v.l0.rowWithGap(2),v.l0.justify.center],buttonLeft:[v.l0.borderRadius(8,0,0,8),v.l0.flex.growAndShrink(1)],buttonRight:[v.l0.borderRadius(0,8,8,0)]});function n$(e){var t=e.shouldShow,n=e.onDismissTour,r=(0,u._)((0,g.useState)(!1),2),i=r[0],o=r[1];return(0,d.BX)(d.HY,{children:[t?(0,d.BX)(p.G,{css:nK.row,children:[(0,d.tZ)(D.zx,{iconLeft:(0,d.tZ)(nY.Z,{}),onClick:function(){(0,eQ.j)(nJ.U3.DEPLOYMENT_MOBILE_DOWNLOAD_QR_VIEWED),o(!0)},text:"Deploy with the Replit App!",css:nK.buttonLeft}),(0,d.tZ)(D.zx,{css:nK.buttonRight,text:"",iconLeft:(0,d.tZ)(nq.Z,{}),onClick:n})]}):null,(0,d.tZ)(nj.u,{isOpen:i,onRequestClose:function(){o(!1),n()},children:(0,d.tZ)(nz,{})})]})}var nQ=n(99656),n0=n(52489);function n1(e){var t=e.secrets,n=e.otherSecrets,r=new Map,i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=(0,u._)(l.value,2),d=s[0],f=s[1];t.has(d)||r.set(d,f)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return{missing:r}}var n2=(0,S.X)({root:[v.l0.borderRadius(8),{border:"1px solid "+v.TV.outlineDimmer}],button:[v.l0.reset.button,G.gU.nofill,v.l0.rowWithGap(8),v.l0.align.center,v.l0.height(32),v.l0.px(8),{border:"0 none",borderBottomLeftRadius:0,borderBottomRightRadius:0}],buttonText:[v.l0.flex.growAndShrink(1),v.l0.rowWithGap(8),v.l0.align.center],expanded:[v.l0.px(8),v.l0.pb(8)],missingItems:[v.l0.colWithGap(8)],missingItem:[v.l0.rowWithGap(8)],missingSecret:[v.l0.rowWithGap(8),v.l0.flex.growAndShrink(1)],subtitle:[{borderTop:"1px solid "+v.TV.outlineDimmest,top:-1},v.l0.py(8),v.l0.position.relative]});function n8(e){var t=e.secrets,n=e.otherSecrets,r=e.otherEnvName,i=e.onAddSecret,o=e.initialExpanded,a=n1({secrets:t,otherSecrets:n}).missing,l=(0,u._)((0,g.useState)(o),2),c=l[0],s=l[1],f=0===a.size;if((0,g.useEffect)(function(){f&&s(!1)},[f]),f)return null;var h="".concat(a.size," ").concat((0,tJ.Z)("secret",a.size)," out of sync"),m=1===a.size?"A ".concat(r," secret is missing from this environment"):"".concat(a.size," ").concat(r," secrets are missing from this environment");return(0,d.BX)(p.G,{css:n2.root,children:[(0,d.BX)(p.G,{css:n2.button,tag:"button",onClick:function(){return s(function(e){return!e})},children:[(0,d.BX)(p.G,{css:n2.buttonText,children:[(0,d.tZ)(R.Z,{color:v.TV.orangeDefault}),(0,d.tZ)($.xv,{multiline:!1,children:h})]}),c?(0,d.tZ)(tt.Z,{}):(0,d.tZ)(eJ.Z,{})]}),c?(0,d.BX)(p.G,{css:n2.expanded,children:[(0,d.tZ)($.xv,{css:n2.subtitle,color:"dimmer",children:m}),(0,d.tZ)(p.G,{css:n2.missingItems,children:(0,eC._)(a.entries()).map(function(e){var t=(0,u._)(e,2),n=t[0],r=t[1];return(0,d.BX)(p.G,{css:n2.missingItem,children:[(0,d.BX)(p.G,{css:n2.missingSecret,children:[(0,d.tZ)(n0.u_,{value:n}),(0,d.tZ)(n0.BH,{value:r})]}),r?(0,d.tZ)(D.zx,{iconLeft:(0,d.tZ)(nQ.Z,{}),variant:"outlined",text:"Add secret",onClick:function(){return i({key:n,value:r})}}):null]},n)})})]}):null]})}var n4=n(28268);function n3(e){var t=e.fs,n=(0,u._)((0,g.useState)(null),2),r=n[0],i=n[1],o=(0,u._)((0,g.useState)(null),2),a=o[0],l=o[1];return(0,g.useEffect)(function(){return t.watchFile(".env",{onChange:function(e){var t=n4.Z.parse(e.toString());i(new Map(Object.entries(t).map(function(e){var t=(0,u._)(e,2);return[t[0],t[1]]})))},onMoveOrDelete:function(){return i(null)},onError:l})},[t]),{devSecrets:r,error:a}}var n5=n(14207),n6=n(92741),n9=n(40107),n7=n.n(n9),re=n(16643),rt=n(75246),rn=n(87659),rr=n(35375),ri=n(1854),ro=n(15006),ra=v.nC.min(600),rl=(0,S.X)({self:[v.l0.colWithGap(8),v.l0.mt(8)],accordion:[v.l0.mb(0)],accordionItem:[v.l0.rowWithGap(4),v.l0.align.center],textButton:[v.l0.cursor.pointer,v.l0.reset.button,v.l0.color.accentPrimaryStronger,v.l0.focusRing,v.l0.hover(v.l0.color.accentPrimaryStrongest),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}],tableHeader:[v.l0.color.foregroundDimmer,v.l0.m(4),v.l0.textAlign.left],tableWrapper:[v.l0.mb(8),v.l0.colWithGap(8),(0,V._)({},ra,v.l0.rowWithGap(0))],table:[v.l0.flex.column,v.l0.width("100%"),(0,V._)({},ra,[v.l0.width("50%"),v.l0.colWithGap(6),{"&:first-child":{table:{borderRight:"1px solid "+v.TV.outlineDimmer}}}])],ghostRow:[v.l0.display.none,(0,V._)({},ra,v.l0.display.flex)]}),rc=function(e){var t=e.text,n=e.onClick;return(0,d.tZ)("button",{css:rl.textButton,onClick:n,children:t})};function rs(e){var t=e.hasPortsConfigured,n=e.hasPort80Configured,r=e.hasConflictingPorts,i=e.hasLocalhostPort80,o=e.openNetworkingPane;return t?n?r?(0,d.tZ)(C.E,{text:(0,d.BX)(d.HY,{children:["Potential port conflict. Make sure no External Ports have conflicts in your configuration and that you only have one External Port configured on port :80. Open the"," ",(0,d.tZ)(rc,{text:"Networking pane to resolve.",onClick:o})]}),colorway:"warning"}):i?(0,d.tZ)(C.E,{text:(0,d.BX)(d.HY,{children:["Hosting your deployment on localhost can cause security or performance issues in some cases. Open the"," ",(0,d.tZ)(rc,{text:"Networking pane to configure.",onClick:o})]}),colorway:"primary"}):(0,d.tZ)(C.E,{text:(0,d.BX)(d.HY,{children:["Deployment forwarding to External Port :80. Open the"," ",(0,d.tZ)(rc,{text:"Networking pane to configure.",onClick:o})]}),colorway:"primary"}):(0,d.tZ)(C.E,{text:(0,d.BX)(d.HY,{children:["Potential port issue. Deployments require an External Port configured on port :80. Open the"," ",(0,d.tZ)(rc,{text:"Networking pane to configure.",onClick:o})]}),colorway:"warning"}):(0,d.tZ)(C.E,{text:(0,d.BX)(d.HY,{children:["No ports configured. Deployments will automatically forward the first Internal Port that opens. Open the"," ",(0,d.tZ)(rc,{text:"Networking pane to configure.",onClick:o})]})})}var ru=function(e){return 80===(0,rr.OD)(e.configuration)};function rd(e){var t=e.portState,n=(0,rr.VZ)(t.configuration),r=(0,rr.OD)(t.configuration),i=ru(t);return(0,d.BX)(d.HY,{children:[(0,d.BX)(ri.sg,{width:"50%",children:[(0,d.tZ)($.xv,{children:n?"localhost":"0.0.0.0"}),i&&n?(0,d.tZ)(ro.Z,{size:16,color:rn.Br.primary.default}):null]}),(0,d.BX)(ri.sg,{width:"50%",children:[(0,d.BX)($.xv,{children:[":",r]}),i?(0,d.tZ)(tl.Z,{size:16,color:rn.Br.positive.default}):(0,d.tZ)(nq.Z,{size:16,color:rn.Br.negative.default})]})]})}function rf(e){var t=e.ports,n=e.openNetworkingPane,r=(0,re.Z)(t.portsState),i=(null==r?void 0:r.filter(function(e){return(0,rr.OD)(e.configuration)}).sort(function(e,t){var n,r;return(null!==(n=(0,rr.OD)(e.configuration))&&void 0!==n?n:0)-(null!==(r=(0,rr.OD)(t.configuration))&&void 0!==r?r:0)}))||null,o=null==i?void 0:i.find(ru),a=!!o,l=!!(i&&i.length>0),c=!!i&&!!o&&!!(i.filter(ru).length>1||i.some(function(e){return(0,rr.OD)(e.configuration)===o.configuration.localPort})),s=!!(o&&(0,rr.VZ)(o.configuration)),f=l&&!a||c,h=(0,u._)((0,g.useState)(!1),2),m=h[0],v=h[1];return(0,d.tZ)(rt.Q,{headerContent:(0,d.BX)(p.G,{css:rl.accordionItem,children:[(0,d.tZ)(na,{id:"deploymentPortConfiguration",title:"Port configuration",information:"Configure which port your deployment should use for incoming requests."}),f?(0,d.tZ)(R.Z,{size:16,color:rn.Br.warning.strongest}):null]}),expanded:m,onClick:function(){return v(!m)},css:rl.accordion,children:(0,d.BX)(p.G,{css:rl.self,children:[(0,d.tZ)(rs,{hasPortsConfigured:l,hasPort80Configured:a,hasConflictingPorts:c,hasLocalhostPort80:s,openNetworkingPane:n}),(0,d.tZ)(p.G,{children:(0,d.BX)(p.G,{css:rl.tableWrapper,children:[(0,d.BX)(p.G,{css:rl.table,children:[(0,d.tZ)($.xv,{css:rl.tableHeader,children:"Deployment expects:"}),(0,d.BX)(ri.iA,{children:[(0,d.BX)(ri.X2,{children:[(0,d.tZ)(ri.sg,{header:!0,width:"50%",children:"Host"}),(0,d.tZ)(ri.sg,{header:!0,width:"50%",children:"External Port"})]}),(0,d.BX)(ri.X2,{children:[(0,d.tZ)(ri.sg,{width:"50%",children:(0,d.tZ)($.xv,{children:"0.0.0.0"})}),(0,d.BX)(ri.sg,{width:"50%",children:[(0,d.tZ)($.xv,{children:":80"}),(0,d.tZ)(tl.Z,{size:16,color:rn.Br.positive.default})]})]}),l&&i?n7()((null==i?void 0:i.length)-1).map(function(e){return(0,d.tZ)(ri.X2,{css:rl.ghostRow,children:(0,d.tZ)(ri.sg,{children:(0,d.tZ)($.xv,{children:"\xa0"})})},e)}):null]})]}),(0,d.BX)(p.G,{css:rl.table,children:[(0,d.tZ)($.xv,{css:rl.tableHeader,children:"Your External Port configuration(s):"}),(0,d.BX)(ri.iA,{children:[(0,d.BX)(ri.X2,{children:[(0,d.tZ)(ri.sg,{header:!0,width:"50%",children:"Host"}),(0,d.tZ)(ri.sg,{header:!0,width:"50%",children:"External Port"})]}),l?null==i?void 0:i.map(function(e){return(0,d.tZ)(ri.X2,{children:(0,d.tZ)(rd,{portState:e})},e.configuration.localPort)}):(0,d.BX)(ri.X2,{children:[(0,d.tZ)(ri.sg,{width:"50%",children:(0,d.tZ)($.xv,{children:"-"})}),(0,d.tZ)(ri.sg,{width:"50%",children:(0,d.tZ)($.xv,{children:"-"})})]})]})]})]})})]})})}var rh=JSON.parse('[{"title":"ACDT"},{"title":"ACT"},{"title":"ACWST"},{"title":"ADT"},{"title":"AEDT"},{"title":"AEST"},{"title":"AET"},{"title":"AFT"},{"title":"AKDT"},{"title":"AKST"},{"title":"ALMT"},{"title":"AMST"},{"title":"AMT"},{"title":"ANAST"},{"title":"ANAT"},{"title":"AQTT"},{"title":"ART"},{"title":"AST"},{"title":"AT"},{"title":"AWDT"},{"title":"AWST"},{"title":"AZOST"},{"title":"AZOT"},{"title":"AZST"},{"title":"AZT"},{"title":"AoE"},{"title":"BNT"},{"title":"BOT"},{"title":"BRST"},{"title":"BRT"},{"title":"BST"},{"title":"BTT"},{"title":"CAST"},{"title":"CAT"},{"title":"CCT"},{"title":"CDT"},{"title":"CEST"},{"title":"CET"},{"title":"CHADT"},{"title":"CHAST"},{"title":"CHOST"},{"title":"CHOT"},{"title":"CHUT"},{"title":"CIDST"},{"title":"CIST"},{"title":"CKT"},{"title":"CLST"},{"title":"CLT"},{"title":"COT"},{"title":"CST"},{"title":"CT"},{"title":"CVT"},{"title":"CXT"},{"title":"ChST"},{"title":"DAVT"},{"title":"DDUT"},{"title":"EASST"},{"title":"EAST"},{"title":"EAT"},{"title":"ECT"},{"title":"EDT"},{"title":"EEST"},{"title":"EET"},{"title":"EGST"},{"title":"EGT"},{"title":"EST"},{"title":"ET"},{"title":"FET"},{"title":"FJST"},{"title":"FJT"},{"title":"FKST"},{"title":"FKT"},{"title":"FNT"},{"title":"GALT"},{"title":"GAMT"},{"title":"GET"},{"title":"GFT"},{"title":"GILT"},{"title":"GMT"},{"title":"GST"},{"title":"GYT"},{"title":"HDT"},{"title":"HKT"},{"title":"HOVST"},{"title":"HOVT"},{"title":"HST"},{"title":"ICT"},{"title":"IDT"},{"title":"IOT"},{"title":"IRDT"},{"title":"IRKST"},{"title":"IRKT"},{"title":"IRST"},{"title":"IST"},{"title":"JST"},{"title":"KGT"},{"title":"KOST"},{"title":"KRAST"},{"title":"KRAT"},{"title":"KST"},{"title":"KUYT"},{"title":"LHDT"},{"title":"LHST"},{"title":"LINT"},{"title":"MAGST"},{"title":"MAGT"},{"title":"MART"},{"title":"MAWT"},{"title":"MDT"},{"title":"MHT"},{"title":"MMT"},{"title":"MSD"},{"title":"MSK"},{"title":"MST"},{"title":"MT"},{"title":"MUT"},{"title":"MVT"},{"title":"MYT"},{"title":"NCT"},{"title":"NDT"},{"title":"NFT"},{"title":"NOVST"},{"title":"NOVT"},{"title":"NPT"},{"title":"NRT"},{"title":"NST"},{"title":"NUT"},{"title":"NZDT"},{"title":"NZST"},{"title":"OMSST"},{"title":"OMST"},{"title":"ORAT"},{"title":"PDT"},{"title":"PET"},{"title":"PETST"},{"title":"PETT"},{"title":"PGT"},{"title":"PHOT"},{"title":"PHT"},{"title":"PKT"},{"title":"PMDT"},{"title":"PMST"},{"title":"PONT"},{"title":"PST"},{"title":"PT"},{"title":"PWT"},{"title":"PYST"},{"title":"PYT"},{"title":"QYZT"},{"title":"RET"},{"title":"ROTT"},{"title":"SAKT"},{"title":"SAMT"},{"title":"SAST"},{"title":"SBT"},{"title":"SCT"},{"title":"SGT"},{"title":"SRET"},{"title":"SRT"},{"title":"SST"},{"title":"SYOT"},{"title":"TAHT"},{"title":"TFT"},{"title":"TJT"},{"title":"TKT"},{"title":"TLT"},{"title":"TMT"},{"title":"TOST"},{"title":"TOT"},{"title":"TRT"},{"title":"TVT"},{"title":"ULAST"},{"title":"ULAT"},{"title":"UTC"},{"title":"UYST"},{"title":"UYT"},{"title":"UZT"},{"title":"VET"},{"title":"VLAST"},{"title":"VLAT"},{"title":"VOST"},{"title":"VUT"},{"title":"WAKT"},{"title":"WARST"},{"title":"WAST"},{"title":"WAT"},{"title":"WEST"},{"title":"WET"},{"title":"WFT"},{"title":"WGST"},{"title":"WGT"},{"title":"WIB"},{"title":"WIT"},{"title":"WITA"},{"title":"WST"},{"title":"WT"},{"title":"YAKST"},{"title":"YAKT"},{"title":"YAPT"},{"title":"YEKST"},{"title":"YEKT"}]'),rp=(0,S.X)({self:{ul:{maxHeight:"300px"}}});function rm(e){var t=e.onChange,n=e.error,r=(0,u._)((0,g.useState)(),2),i=r[0],o=r[1],a=(0,g.useId)();return((0,g.useEffect)(function(){if(!i){var e=Intl.DateTimeFormat().resolvedOptions().timeZone,n=(0,nw.p8)(new Date,e),r=rh.find(function(e){return e.title===n});if(r){t(r.title),o(r);return}var a=rh.find(function(e){return"PST"===e.title});a&&(t(a.title),o(a))}},[t,i]),i)?(0,d.BX)(p.G,{css:rp.self,children:[(0,d.tZ)(ng.P,{placeholder:"Select timezone",initialSelectedItem:i,items:rh,onChange:function(e){return t(e.title)}}),n?(0,d.tZ)(p.G,{css:[v.l0.color.accentNegativeStronger],"aria-live":"polite","aria-atomic":"true",id:a,children:(0,d.tZ)("span",{children:n})}):null]}):null}var rv=n(7444),rg=n(55534),ry=n(64461),rb=n(8668),rw=n(30084),rZ=n(22487),rx=n(59639),rC=n(10981);function rS(){var e=(0,ee._)(["\n  query CheckReplitAppSubdomainAvailability(\n    $subdomain: String!\n    $deploymentId: String\n  ) {\n    replitAppSubdomainAvailability(\n      subdomain: $subdomain\n      deploymentId: $deploymentId\n    ) {\n      __typename\n      ... on ReplitAppSubdomainAvailabilityResult {\n        available\n        message\n      }\n      ... on UserError {\n        errorMessage: message\n      }\n    }\n  }\n"]);return rS=function(){return e},e}var rk={},r_=(0,et.Ps)(rS()),rE=function(e){var t=e.id,n=e.value,r=e.loading,i=e.disabled,o=e.onChange,a=e.error,l=(0,rb.Ar)(n),c=(0,g.useId)();return(0,d.BX)(p.G,{css:[v.l0.colWithGap(4)],children:[(0,d.tZ)(nn.II,{id:t,value:l?n:"",onChange:function(e){return o(e.target.value)},css:[v.l0.color.greyStrongest],disabled:r||i,"aria-describedby":c}),a?(0,d.tZ)(p.G,{css:[v.l0.color.accentNegativeStronger],"aria-live":"polite","aria-atomic":"true",id:c,children:(0,d.tZ)("span",{children:a})}):null]})},rT=(0,S.X)({root:[v.l0.rowWithGap(8),v.l0.align.center],iconButton:[v.l0.height("100%"),v.l0.borderRadius(8),{"& button":v.l0.height(32)}],keyInput:[v.l0.width("40%")],valueInput:[v.l0.flex.growAndShrink(1)]}),rR=function(e){var t=e.index,n=e.name,r=e.value,i=e.disabled,o=e.updateEnvVarName,a=e.updateEnvVarValue,l=e.removeEnvVar,c=e.otherKeys,s=(0,rC.U)(),f=(0,u._)((0,g.useState)(""===n||""===r),2),h=f[0],m=f[1],y=!!(n&&r),b=(0,rv.Z)(y),w=(0,rZ.Z)(function(){w.current&&b.current&&m(!1)},[b]);return h?(0,d.BX)(d.HY,{children:[(0,d.BX)(p.G,{css:rT.root,innerRef:w,children:[(0,d.tZ)(p.G,{css:rT.keyInput,children:(0,d.tZ)(nn.II,{placeholder:"Name",id:"".concat(s,"-name-").concat(t),value:n,onChange:function(e){return o(e.currentTarget.value)},onKeyDown:function(e){"Enter"===e.key&&y&&m(!1)},disabled:i})}),(0,d.tZ)(p.G,{css:rT.valueInput,children:(0,d.tZ)(nn.II,{placeholder:"Value",name:"".concat(s,"-value-").concat(t),value:r,onChange:function(e){return a(e.currentTarget.value)},onKeyDown:function(e){"Enter"===e.key&&y&&m(!1)},disabled:i})}),i?null:(0,d.tZ)(B.Tg,{elevated:!0,css:rT.iconButton,children:(0,d.tZ)(eB.hU,{alt:"Add",tooltipHidden:!0,onClick:function(){y?m(!1):l()},children:y?(0,d.tZ)(tl.Z,{}):(0,d.tZ)(nq.Z,{})})})]}),c.includes(n)?(0,d.BX)($.xv,{variant:"small",css:{color:v.TV.accentNegativeDefault},children:['Secret "',n,'" already exists']}):null]}):(0,d.BX)(p.G,{css:rT.root,children:[(0,d.tZ)(n0.u_,{value:n}),(0,d.tZ)(n0.BH,{value:r}),(0,d.tZ)(n0.$M,{onEdit:function(){return m(!0)},onDelete:function(){return l()}})]})},rI=function(e){var t,n,r,i,o,a=e.id,l=e.subdomain,c=e.deploymentId,s=e.onChange,u=e.updateValidity,f=(t={variables:{subdomain:l,deploymentId:c},skip:0===l.length},n=(0,U._)({},rk,t),en.a(r_,n)),h=f.data,y=f.loading,b=f.error,w=(null==h?void 0:h.replitAppSubdomainAvailability.__typename)==="ReplitAppSubdomainAvailabilityResult"&&h.replitAppSubdomainAvailability.available,Z=(null==h?void 0:h.replitAppSubdomainAvailability.__typename)==="ReplitAppSubdomainAvailabilityResult"?h.replitAppSubdomainAvailability.message:null==h?void 0:null===(r=h.replitAppSubdomainAvailability)||void 0===r?void 0:r.errorMessage;return((0,g.useEffect)(function(){u(w)},[w]),b)?(0,d.tZ)(C.E,{colorway:"negative",text:"Something went wrong, please try refreshing the page."}):(0,d.BX)(p.G,{children:[(0,d.BX)(p.G,{css:[v.l0.rowWithGap(4),v.l0.align.center],children:[(0,d.tZ)(nn.II,{id:a,placeholder:"subdomain",value:l,onChange:function(e){return s(e.target.value)}}),(0,d.BX)($.xv,{multiline:!1,children:[(null===(o=window)||void 0===o?void 0:null===(i=o.location)||void 0===i?void 0:i.hostname)!=="replit.com"?".staging":"",".replit.app"]})]}),(0,d.BX)(p.G,{css:[v.l0.rowWithGap(4),v.l0.align.center,v.l0.pt(4)],children:[y?(0,d.BX)(d.HY,{children:[(0,d.tZ)(m.Z,{}),(0,d.tZ)($.xv,{multiline:!1,children:"Checking availability"})]}):null,w?(0,d.BX)(d.HY,{children:[(0,d.tZ)(tl.Z,{color:"green"}),(0,d.tZ)($.xv,{css:[v.l0.color.greenDefault],multiline:!1,children:"Available"})]}):null,w||y?null:(0,d.BX)(d.HY,{children:[(0,d.tZ)(R.Z,{color:"red"}),(0,d.tZ)($.xv,{css:[v.l0.color.redDefault],multiline:!1,children:Z})]})]})]})},rD=function(e){var t=e.appType,n=e.onChange,r=(0,rC.U)();return(0,d.tZ)(rx.hE,{name:"deploymentTargetSelector",value:t,onChange:n,row:!0,css:[v.l0.width("100%"),v.l0.flex.row],children:[{value:I.Vp.Server,name:"Web Server",description:"ex. an API or website"},{value:I.Vp.Worker,name:"Background Worker",description:"ex. a Discord or Slack bot"}].map(function(e,t){return(0,d.tZ)(p.G,{css:[v.l0.flex.grow(1)],children:(0,d.tZ)(nr.u,{tooltip:e.description,children:(0,d.tZ)(rx.rK,{id:r(e.value),value:e.value,text:e.name})})},t)})})};function rG(){var e=(0,ee._)(["\n  fragment DeploymentsDeployOptionsDeployment on HostingDeployment {\n    id\n    replitAppSubdomain\n    currentBuild {\n      id\n      provider\n      envVars {\n        name\n        value\n      }\n      machineJob {\n        timezone\n        crontab\n      }\n    }\n  }\n"]);return rG=function(){return e},e}function rB(){var e=(0,ee._)(["\n  query DeploymentsDeployOptions($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...DeploymentsDeployOptionsDeployment\n      }\n    }\n  }\n  ","\n"]);return rB=function(){return e},e}var rP={},rA=(0,et.Ps)(rG()),rN=(0,et.Ps)(rB(),rA),rL={NEEDS_PAYMENT_METHOD:"A payment method is required. Navigate to Account > Billing to resolve.",NEEDS_SUBSCRIPTION:"A subscription is required. Navigate to Account > Billing to resolve.",NEEDS_SUBSCRIPTION_OR_PAYMENT_METHOD:"Either a subscription or payment method is required. Navigate to Account > Billing to resolve.",NEEDS_SMS_VERIFICATION:"A verified phone number is required. Navigate to Account > Verification to resolve.",NEEDS_UNBANNING:"Your account currently has restrictions in place. Please reach out to our support team for assistance.",INCLUDED_IN_SUBSCRIPTION:"Plan found.",HAS_PAYMENT_METHOD:"Payment method found.",INSUFFICIENT_BUDGET:"You've reached your monthly usage budget. Navigate to Account > Billing to increase your budget."};function rU(e){var t=e.deployability,n=e.ubbCapabilities,r=t.isDeployable,i=t.explanation;if(!t.disableDeployments)return null;if(!r)return(0,d.tZ)(C.E,{text:i,colorway:"warning",icon:(0,d.tZ)(R.Z,{})});var o=function(e){switch(e){case I.Fp.HasPaymentMethod:return"HAS_PAYMENT_METHOD";case I.Fp.IncludedInSubscription:return"INCLUDED_IN_SUBSCRIPTION";case I.Fp.InsufficientBudget:return"INSUFFICIENT_BUDGET";case I.Fp.NeedsPaymentMethod:return"NEEDS_PAYMENT_METHOD";case I.Fp.NeedsSmsVerification:return"NEEDS_SMS_VERIFICATION";case I.Fp.NeedsSubscription:return"NEEDS_SUBSCRIPTION";case I.Fp.NeedsSubscriptionOrPaymentMethod:return"NEEDS_SUBSCRIPTION_OR_PAYMENT_METHOD";case I.Fp.NeedsUnbanning:return"NEEDS_UNBANNING";default:return}}(null==n?void 0:n.explanation);return o?(0,d.tZ)(C.E,{text:"You are not eligible for this feature. ".concat(rL[o]),colorway:"warning",icon:(0,d.tZ)(R.Z,{})}):null}function rO(){return(rO=(0,w._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g;return(0,Z.Jh)(this,function(y){switch(y.label){case 0:t=["webpack.config.js","vite.config.js","webpack.config.ts","vite.config.ts"],n=!0,r=!1,i=void 0,y.label=1;case 1:y.trys.push([1,6,7,8]),o=t[Symbol.iterator](),y.label=2;case 2:if(n=(a=o.next()).done)return[3,5];return l=a.value,[4,e.stat(l)];case 3:if(!((c=y.sent()).exists&&c.type===rw.Tv.File))return[3,4];return[2,"dist"];case 4:return n=!0,[3,2];case 5:return[3,8];case 6:return s=y.sent(),r=!0,i=s,[3,8];case 7:try{n||null==o.return||o.return()}finally{if(r)throw i}return[7];case 8:u=["dist","build","public"],d=!0,f=!1,h=void 0,y.label=9;case 9:y.trys.push([9,14,15,16]),p=u[Symbol.iterator](),y.label=10;case 10:if(d=(m=p.next()).done)return[3,13];return v=m.value,[4,e.stat(v)];case 11:if(!((g=y.sent()).exists&&g.type===rw.Tv.Directory))return[3,12];return[2,v];case 12:return d=!0,[3,10];case 13:return[3,16];case 14:return s=y.sent(),f=!0,h=s,[3,16];case 15:try{d||null==p.return||p.return()}finally{if(f)throw h}return[7];case 16:return[2]}})})).apply(this,arguments)}var rM=(0,S.X)({self:v.l0.colWithGap(16),deployOptions:[v.l0.rowWithGap(12),v.l0.flex.growAndShrink(1),v.l0.width("100%")],footer:v.l0.colWithGap(0),ctaGroup:[v.l0.rowWithGap(8),v.l0.pt(12)],deployButton:v.l0.flex.grow(1),secretsModal:[v.l0.colWithGap(8)],secretsModalButtons:[v.l0.rowWithGap(8),v.l0.justify.end,v.l0.pt(8)]}),rX=function(e){var t,n,r,i,o,a,l,c,s,f,h,x,C,S,k,E,T,R=e.deploymentId,G=e.initialSubdomain,B=e.provider,P=e.machine,A=e.fs,N=e.ports,L=e.dotReplit,O=e.onDeploy,M=e.onCancel,X=e.onError,F=e.initialSecretsSyncExpanded,W=e.openNetworkingPane,H=(0,y.kW)(),V=(0,y.XA)(),z=(t=(0,U._)({},rP,{skip:!R,variables:{id:null!=R?R:""},fetchPolicy:"cache-and-network",ssr:!1,onCompleted:function(e){var t,n=(null===(t=e.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"?e.hostingDeployment:null;n&&(n.replitAppSubdomain&&(eo(n.replitAppSubdomain),ec(!0)),n.currentBuild.machineJob&&(ew(n.currentBuild.machineJob.timezone),e_(n.currentBuild.machineJob.crontab)),eG(n.currentBuild.envVars.map(function(e){return{name:e.name,value:e.value}})))}}),en.a(rN,t)),j=z.data,q=z.loading,Y=(r=(n={provider:B,fs:A,dotReplit:L,isNewDeployment:!R,onError:X,onOptions:function(e){e.appType&&et(e.appType),e.envVars&&eG(e.envVars),e.ignorePorts&&eN(e.ignorePorts),e.buildCommand&&ed(e.buildCommand),e.runCommand&&ep(e.runCommand),e.publicDir&&eO(e.publicDir)}}).isNewDeployment,i=n.provider,o=n.fs,a=n.onOptions,l=n.onError,c=n.dotReplit,f=(s=(0,u._)((0,g.useState)(!0),2))[0],h=s[1],x=(0,rv.Z)(l),C=(0,rv.Z)(a),(0,g.useEffect)(function(){var e=!1;function t(){return(t=(0,w._)(function(){var t,n,a,l,s,d,f,p,m;return(0,Z.Jh)(this,function(v){switch(v.label){case 0:return t=I.Vp.Server,n=null,a=null,l=null,s=null,[4,Promise.all([r?(0,n5.xk)(o):Promise.resolve(null),(0,n5.$f)(c)])];case 1:if(f=(d=u._.apply(void 0,[v.sent(),2]))[0],p=d[1],e)return[2];if(r)switch(i){case I.r4.Gce:t=p.ignorePorts?I.Vp.Worker:I.Vp.Server;break;case I.r4.CloudRun:t=I.Vp.CloudRun;break;case I.r4.Static:t=I.Vp.Static;break;case I.r4.Cron:t=I.Vp.Cron}else p.appType&&(t=p.appType);if(a=p.buildCommand,!(t!==I.Vp.Static))return[3,2];return n=p.runCommand,[3,5];case 2:if(!p.publicDir)return[3,3];return l=p.publicDir,[3,5];case 3:return[4,function(e){return rO.apply(this,arguments)}(o)];case 4:(m=v.sent())&&(l=m),v.label=5;case 5:return i===I.r4.Gce&&(s=p.ignorePorts),C.current({appType:t,envVars:f,buildCommand:a,runCommand:n,publicDir:l,ignorePorts:s}),h(!1),[2]}})})).apply(this,arguments)}try{!function(){t.apply(this,arguments)}()}catch(e){x.current(e.message),h(!1)}return function(){e=!0}},[i,o,c,x,C,r]),{loading:f}).loading,J=(null==j?void 0:null===(E=j.hostingDeployment)||void 0===E?void 0:E.__typename)==="HostingDeployment"?j.hostingDeployment:null,K=null==J?void 0:J.currentBuild,Q=(0,u._)((0,g.useState)(I.Vp.Server),2),ee=Q[0],et=Q[1],er=(0,u._)((0,g.useState)(G),2),ei=er[0],eo=er[1],ea=(0,u._)((0,g.useState)(!1),2),el=ea[0],ec=ea[1],es=(0,u._)((0,g.useState)(null),2),eu=es[0],ed=es[1],ef=(0,u._)((0,g.useState)(null),2),eh=ef[0],ep=ef[1],em=(0,u._)((0,g.useState)(void 0),2),ev=em[0],eg=em[1],ey=(0,u._)((0,g.useState)(null),2),eb=ey[0],ew=ey[1],eZ=(0,u._)((0,g.useState)(void 0),2),ex=eZ[0],eC=eZ[1],eS=(0,u._)((0,g.useState)(null),2),ek=eS[0],e_=eS[1],eE=(0,u._)((0,g.useState)(void 0),2),eT=eE[0],eR=eE[1],eI=(0,u._)((0,g.useState)(null!==(T=null==K?void 0:K.envVars.map(function(e){return{name:e.name,value:e.value}}))&&void 0!==T?T:[]),2),eD=eI[0],eG=eI[1],eP=(0,u._)((0,g.useState)(!1),2),eA=eP[0],eN=eP[1],eL=(0,u._)((0,g.useState)(null),2),eU=eL[0],eO=eL[1],eM=(0,u._)((0,g.useState)(void 0),2),eX=eM[0],eF=eM[1],eW=n3({fs:A}).devSecrets;(0,g.useEffect)(function(){e0({context:"deploy_options"})},[]);var eH=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.value;eG(function(e){return(0,ry.Uy)(e,function(e){e.push({name:null!=t?t:"",value:null!=n?n:""})})})},eV=function(e,t){eG(function(n){return(0,ry.Uy)(n,function(n){n[e].name=t})})},ez=function(e,t){eG(function(n){return(0,ry.Uy)(n,function(n){n[e].value=t})})},ej=function(e){eG(function(t){return(0,ry.Uy)(t,function(t){t.splice(e,1)})})},eq=ee!==I.Vp.Static,eY=B===I.r4.Gce,eJ=ee===I.Vp.Static,eK=B!==I.r4.Cron&&!(null==J?void 0:J.replitAppSubdomain),e$=B===I.r4.Cron,eQ=ee===I.Vp.Server||ee===I.Vp.CloudRun,e1=(S=(0,w._)(function(){var e,t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:if(!(e=(!eK||el)&&ei.length?ei:void 0))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,V({envVars:eD.filter(function(e){return(0,rb.GV)(e)}),subdomain:e,machineConfigurationId:(null==P?void 0:P.configurationId)||void 0,maxMachineInstances:(null==P?void 0:P.maxInstances)||void 0,machineJob:eb&&ek?{timezone:eb,crontab:ek}:void 0,config:{buildCommand:eu,runCommand:eh,appType:ee,ignorePorts:eA,publicDir:eU}})];case 2:return n.sent(),O(),[3,4];case 3:if((t=n.sent())instanceof n6.ZG)return eg("Run command cannot be empty."),[2];if(t instanceof n6.SF)return eF("Public directory cannot be empty."),[2];if(t instanceof n6.Iy)return eC(t.message||"Invalid timezone."),[2];if(t instanceof n6.Bz)return eR(t.message||"Invalid crontab."),[2];return X(t.message),[3,4];case 4:return[2]}})}),function(){return S.apply(this,arguments)}),e2=(0,u._)((0,g.useState)(!1),2),e8=e2[0],e4=e2[1],e3=(0,u._)((0,g.useState)(!1),2),e5=e3[0],e6=e3[1],e9=(0,y.BU)(),e7=e9.getDeployabilityByProvider,te=e9.usageBasedBillingCapabilities,tt=e7(B),tn=q||Y||tt.disableDeployments||H===b.z.Preparing,tr=tn||eK&&!el,ti=eD.map(function(e){return e.name}),to=(0,rg.Z)(),ta=(k=(0,w._)(function(){var e,t,n,r,i,o;return(0,Z.Jh)(this,function(a){switch(a.label){case 0:return e4(!0),e=eD.reduce(function(e,t){return e[t.name]=t.value,e},{}),[4,A.readFile(".env")];case 1:if(t=a.sent(),n="",t.error&&t.error!==rw.Df.NotFound)return to.showError("Failed to overwrite secrets"),e4(!1),[2];return t.error||(n=t.content.toString()),r=n4.Z.parse(n),i=(0,U._)({},r,e),o=n4.Z.serialize(i),[4,A.writeFile(".env",o)];case 2:return a.sent().error&&to.showError("Failed to overwrite secrets"),e4(!1),e6(!1),[2]}})}),function(){return k.apply(this,arguments)}),tl=Y?(0,d.BX)(d.HY,{children:[(0,d.tZ)(nl,{}),(0,d.tZ)(nl,{}),(0,d.tZ)(nl,{})]}):(0,d.BX)(d.HY,{children:[e$?(0,d.BX)(p.G,{css:rM.deployOptions,children:[(0,d.tZ)(na,{id:"timezone",title:"Timezone",information:"The selected timezone for your scheduled deployment",children:(0,d.tZ)(rm,{onChange:ew,error:ex})}),(0,d.tZ)(na,{id:"schedule",title:"Schedule",information:"Specify a valid cron expression for scheduling your deployment",grow:!0,children:(0,d.tZ)(rE,{id:"Schedule",value:ek,loading:!1,disabled:!1,onChange:e_,error:eT})})]}):null,eK?(0,d.tZ)(na,{id:"primaryDomain",title:"Primary domain",information:"You can add more custom domains after deploying",children:(0,d.tZ)(rI,{id:"primaryDomain",subdomain:ei,deploymentId:R||void 0,onChange:eo,updateValidity:ec})}):null,eJ?(0,d.tZ)(na,{id:"publicDir",title:"Public directory",information:"The public directory is the folder where the browser should start when serving your static site",children:(0,d.tZ)(rE,{id:"publicDir",value:eU,onChange:eO,loading:Y,disabled:tn,error:eX})}):null,(0,d.tZ)(na,{id:"buildCommand",title:"Build command",information:"The build command is the command-line statement that compiles your app at build time.",optional:!0,children:(0,d.tZ)(rE,{id:"buildCommand",value:eu,onChange:ed,loading:Y,disabled:tn})}),eq?(0,d.tZ)(na,{id:"runCommand",title:"Run command",information:"The run command is the command-line statement that launches your app after it has been built.",children:(0,d.tZ)(rE,{id:"runCommand",value:eh,onChange:ep,loading:Y,disabled:tn,error:ev})}):null,(0,d.tZ)(na,{id:"envVars",title:"Deployment secrets",information:"Secrets, or environment variables, are private keys you can use to access APIs and services",actions:R&&eD.length>0?(0,d.tZ)(eB.hU,{alt:"Copy all secrets from Deployment to Development.",disabled:e8,onClick:function(){e6(!0)},children:(0,d.tZ)(tH.Z,{})}):null,children:(0,d.BX)(p.G,{css:[v.l0.colWithGap(12)],children:[eD.length>0?eD.map(function(e,t){var n=e.name,r=e.value;return(0,d.tZ)(rR,{index:t,name:n,value:r,updateEnvVarName:function(e){return eV(t,e)},updateEnvVarValue:function(e){return ez(t,e)},removeEnvVar:function(){return ej(t)},disabled:tn,otherKeys:ti.filter(function(e,n){return n!==t})},t)}):null,eW?(0,d.tZ)(n8,{secrets:new Map(eD.map(function(e){return[e.name,e.value]})),otherSecrets:eW,otherEnvName:"workspace",onAddSecret:function(e){return eH({name:e.key,value:e.value})},initialExpanded:F}):null,(0,d.tZ)(D.zx,{onClick:function(){return eH()},text:"Add deployment secret",iconLeft:(0,d.tZ)(nQ.Z,{}),disabled:q})]})}),eY?(0,d.tZ)(na,{id:"deploymentAppType",title:"App type",information:"Configure your app based on whether it needs to serve traffic from the web.",children:(0,d.tZ)(rD,{appType:ee,onChange:function(e){et(e),eN((e===I.Vp.Server||e===I.Vp.Worker)&&e===I.Vp.Worker)}})}):null,eQ?(0,d.tZ)(rf,{ports:N,openNetworkingPane:W}):null]});return(0,d.BX)(d.HY,{children:[(0,d.BX)(p.G,{css:rM.self,children:[tl,(0,d.BX)(p.G,{css:rM.footer,children:[(0,d.tZ)(rU,{deployability:tt,ubbCapabilities:te}),(0,d.BX)(p.G,{css:rM.ctaGroup,children:[K?(0,d.tZ)(D.zx,{text:"Cancel",onClick:M}):null,(0,d.tZ)(p.G,{css:rM.deployButton,children:(0,d.tZ)(D.zx,{colorway:"primary",onClick:e1,text:H===b.z.Preparing&&"Preparing..."||Y&&"Fetching options..."||"Deploy",iconLeft:Y||H===b.z.Preparing?(0,d.tZ)(m.Z,{}):(0,d.tZ)(_.Z,{}),disabled:tr})})]})]})]}),(0,d.tZ)(nj.u,{isOpen:e5,onRequestClose:function(){e8||e6(!1)},children:(0,d.BX)(p.G,{css:rM.secretsModal,children:[(0,d.tZ)($.xv,{variant:"subheadBig",children:"Copy secrets from Deployment to Development?"}),(0,d.tZ)($.xv,{children:"Are you sure you want to copy all of your secrets from Deployment to Development? Secrets already present in Development will be overwritten and lost permanently."}),(0,d.BX)(p.G,{css:rM.secretsModalButtons,children:[(0,d.tZ)(D.zx,{text:"Cancel",disabled:e8,onClick:function(){e6(!1)}}),(0,d.tZ)(D.zx,{text:"Yes, copy secrets",colorway:"negative",disabled:e8,loading:e8,onClick:ta})]})]})})]})};function rF(){var e=(0,ee._)(["\n  query HostingDeploymentConfigRedeploy($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        replitAppSubdomain\n        activityLogs(count: 20) {\n          items {\n            id\n            ...HostingActivityLogLine2\n          }\n          pageInfo {\n            hasNextPage\n            nextCursor\n          }\n        }\n        currentBuild {\n          id\n          envVars {\n            name\n            value\n          }\n        }\n        ...DeploymentsDeployOptionsDeployment\n      }\n    }\n  }\n  ","\n  ","\n"]);return rF=function(){return e},e}var rW={},rH=(0,et.Ps)(rF(),tX,rA),rV=(0,S.X)({self:v.l0.colWithGap(8),ctaGroup:{flexDirection:"row",gap:8,flexWrap:"wrap"},loading:tw,deployOptions:[v.l0.p(16),v.l0.pt(12),v.l0.borderRadius(8),v.l0.border({color:v.TV.outlineDimmest})]}),rz=function(e){var t,n,r,i,o,a,l,c,s,f,h,m,v,x,S,k,E=e.deploymentId,T=e.dotReplit,I=e.fs,G=e.ports,B=e.onError,P=e.expanded,A=e.setExpanded,N=e.shouldShowMobileTour,L=e.onDismissMobileTour,O=e.openNetworkingPane,M=(0,y.XA)(),X=(i=(t={deploymentId:E,dotReplit:T}).deploymentId,o=t.dotReplit,l=(a=(0,u._)((0,g.useState)(null),2))[0],c=a[1],(0,g.useEffect)(function(){var e=!1;function t(){return(t=(0,w._)(function(){var t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:return[4,(0,n5.$f)(o)];case 1:if(t=n.sent(),e)return[2];return c(t),[2]}})})).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){e=!0}},[o]),h=(s=(0,U._)({},rW,{variables:{id:i},ssr:!1,fetchPolicy:"cache-and-network"}),f=en.a(rH,s)).data,m=f.loading,v=f.error,x=(null==h?void 0:null===(n=h.hostingDeployment)||void 0===n?void 0:n.__typename)==="HostingDeployment"?h.hostingDeployment:null,(null==h?void 0:null===(r=h.hostingDeployment)||void 0===r?void 0:r.__typename)==="NotFoundError"?{deployment:null,config:null,error:"Deployment not found",loading:!1}:null===l||!x&&m?{data:null,erorr:null,loading:!0}:v||!x?{deployment:null,config:null,error:"Something went wrong",loading:!1}:{deployment:x,config:l,error:null,loading:!1}),F=(0,y.BU)(),W=F.deployability,H=F.usageBasedBillingCapabilities,V=null===(S=X.deployment)||void 0===S?void 0:S.currentBuild,z=n3({fs:I}).devSecrets,j=null===(k=X.deployment)||void 0===k?void 0:k.currentBuild.envVars,q=(0,g.useMemo)(function(){return z?n1({secrets:new Map(null==j?void 0:j.map(function(e){return[e.name,e.value]})),otherSecrets:z}).missing.size:0},[z,j]),Y=(0,y.kW)();if(Y===b.z.Preparing||Y===b.z.Deploying)return(0,d.tZ)(p.G,{css:rV.loading,children:(0,d.tZ)(tx,{})});if(X.error)return(0,d.tZ)(nu,{text:X.error});if(P)return V?(0,d.tZ)(p.G,{css:rV.deployOptions,children:(0,d.tZ)(rX,{initialSubdomain:"",provider:V.provider,deploymentId:E,fs:I,dotReplit:T,ports:G,onCancel:function(){return A(!1)},onDeploy:function(){return A(!1)},onError:B,initialSecretsSyncExpanded:q>0,openNetworkingPane:O})}):(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:"Provider not found"});var J=X.loading||W.disableDeployments||!(Y===b.z.Ready||Y===b.z.Suspended);return(0,d.BX)(p.G,{css:rV.self,children:[(0,d.tZ)(rU,{deployability:W,ubbCapabilities:H}),(0,d.BX)(p.G,{css:rV.ctaGroup,children:[(0,d.tZ)(D.zx,{disabled:J,onClick:(0,w._)(function(){var e;return(0,Z.Jh)(this,function(t){switch(t.label){case 0:if(X.loading)return[2];return[4,M({subdomain:null!==(e=X.deployment.replitAppSubdomain)&&void 0!==e?e:void 0})];case 1:return t.sent(),[2]}})}),text:Y===b.z.Suspended?"Resume":"Redeploy",iconLeft:(0,d.tZ)(_.Z,{})}),(0,d.tZ)(D.zx,{disabled:J,text:q>0?"".concat(q," ").concat((0,tJ.Z)("secrets",q)," out of sync"):"Edit commands and secrets",iconLeft:q>0?(0,d.tZ)(R.Z,{}):void 0,onClick:function(){return A(!0)}}),(0,d.tZ)(n$,{shouldShow:N,onDismissTour:L})]})]})},rj=n(53937),rq=n(74440),rY=n(19713),rJ=[1,2,3,4,5,6,7,8,9,10],rK=rJ.length-1,r$=1/(2*rK),rQ=(0,rY.cn)(2),r0=(0,rY.cn)(function(e){return rJ[e(rQ)]}),r1=(0,rY.cn)(function(e){return(e(rq.Qc)*e(r0)).toFixed(6)}),r2=(0,rY.cn)(function(e){return e(rq.Ig)*e(r0)}),r8=(0,rY.cn)(0),r4=(0,rY.cn)(function(e){var t=0/rK,n=rJ.length-1/rK,r=0,i=0;return e(r8)<t&&(r=(t-e(r8))/r$,i=t-r$),e(r8)>n&&(r=(e(r8)-n)/r$,i=n+r$),{overage:r,point:i}});(r=l||(l={})).None="0ms",r.Normal="120ms";var r3=["ArrowLeft","ArrowRight","Home","End"],r5=(0,j.iv)({position:"relative",height:"16px",width:"100%",touchAction:"none"}),r6=(0,j.iv)({position:"absolute",zIndex:2,top:"0",width:"16px",height:"16px",backgroundColor:v.TV.white,borderRadius:"100%",outline:"none",cursor:"pointer",willChange:"left, transition",boxShadow:"0 0 8px rgba(0,0,0,0.15)",":focus":{outline:"2px solid ".concat(v.TV.accentPrimaryDefault),":not(:focus-visible)":{outlineColor:"transparent"}}}),r9=n(80703),r7=(0,g.forwardRef)(function(e,t){var n=(0,u._)((0,r9.KO)(r0),1)[0],r=(0,g.useRef)(null);return(0,g.useImperativeHandle)(t,function(){return r.current}),n&&r.current&&(r.current.setAttribute("aria-valuemin",String(rJ[0])),r.current.setAttribute("aria-valuemax",String(rJ[rJ.length-1])),r.current.setAttribute("aria-valuenow",String(n))),(0,g.useMemo)(function(){return(0,d.tZ)("div",{ref:r,role:"slider",tabIndex:0,css:[r6,{left:"calc((100% - 16px) * var(--max-instances-progress, 0))",transition:"left var(--max-instances-transition-time, 100ms) ease-out"}]})},[])}),ie=n(57330),it=n(44166),ir="min(var(--point), var(--position))",ii="max(var(--point), var(--position))",io=(0,g.forwardRef)(function(e,t){var n=(0,r9.Dv)(r4),r=n.overage,i=n.point,o=(0,r9.Dv)(r8),a=(0,g.useRef)(null);return(0,g.useEffect)(function(){(0,it.A)(a,"--opacity",String(r))},[r]),(0,g.useEffect)(function(){(0,it.A)(a,"--point",String(100*i)+"%")},[i]),(0,g.useEffect)(function(){(0,it.A)(a,"--position",String(100*o)+"%")},[o]),(0,g.useMemo)(function(){return(0,d.BX)(d.HY,{children:[(0,d.tZ)("div",{ref:t,"aria-hidden":!0,css:{position:"relative",top:"0",width:"100%",height:"16px",margin:"0",cursor:"pointer"}}),(0,d.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:"5px",left:"0",width:"100%",height:"6px",margin:"0",overflow:"hidden",pointerEvents:"none",backgroundColor:G.vb.interactiveBorder,borderRadius:"2px"},children:(0,d.tZ)("div",{ref:a,"aria-hidden":!0,css:{"--opacity":0,"--point":0,"--position":0,backgroundImage:"\n                linear-gradient(\n                  to right, transparent ".concat(ir,", \n                  ").concat(G.vb.interactiveBorderHover," ").concat(ir,", \n                  ").concat(G.vb.interactiveBorderHover," ").concat(ii,", \n                  transparent ").concat(ii," \n                )"),opacity:"var(--opacity)",width:"100%",height:"100%"}})})]})},[t])});function ia(e){var t=e.setAttrs,n=(0,u._)((0,r9.KO)(rQ),2),r=n[0],i=n[1],o=(0,u._)((0,g.useState)(!1),2),a=o[0],c=o[1],s=(0,g.useRef)(null),f=(0,g.useRef)(null),h=(0,g.useRef)(null),m=(0,g.useCallback)(function(e){t.setTransitionTime(e)},[t]),y=(0,g.useCallback)(function(e){t.setProgress(e)},[t]);return void 0===r||a||(y(r/rK),m(l.Normal)),(0,g.useEffect)(function(){if(void 0!==r&&f.current&&h.current&&!a){var e=f.current,t=h.current,n=function(n){if(0===n.button){c(!0),t.focus();var r=e.getBoundingClientRect(),o=t.getBoundingClientRect(),a=r.width,s=o.width,u=n.target===e?s/2:n.clientX-o.left,d=null,f=function(e){var t=Math.max(0,Math.min(1,(e-r.left-u)/(a-s)));t!==d&&(d=t,y(t),i(Math.round(t*rK)))};f(n.clientX);var h=function(e){m(l.None),f(e.clientX),e.preventDefault(),e.stopPropagation()},p=function(){window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",p),m(l.Normal),c(!1)};window.addEventListener("pointermove",h),window.addEventListener("pointerup",p),window.addEventListener("pointercancel",p),n.preventDefault(),n.stopPropagation()}};return e.addEventListener("pointerdown",n),t.addEventListener("pointerdown",n),function(){e.removeEventListener("pointerdown",n),t.removeEventListener("pointerdown",n)}}},[r,a,i,y,m]),(0,g.useEffect)(function(){if(void 0!==r&&h.current&&!a){var e=h.current,t=function(e){if(void 0!==r&&r3.includes(e.key)){var t=Math.max(0,r-1),n=Math.min(rK,r+1),o=null;switch(e.key){case"ArrowLeft":o=t;break;case"ArrowRight":o=n;break;case"Home":o=0;break;case"End":o=rK}null!==o&&(i(o),e.preventDefault(),e.stopPropagation())}};return e.addEventListener("keydown",t),function(){e.removeEventListener("keydown",t)}}},[a,r,i]),(0,g.useMemo)(function(){return(0,d.tZ)(p.G,{css:v.l0.colWithGap(8),children:(0,d.BX)(p.G,{innerRef:s,css:r5,children:[(0,d.tZ)(io,{ref:f}),(0,d.tZ)(r7,{ref:h})]})})},[])}var il=(0,S.X)({costInfo:[v.l0.rowWithGap(4),v.l0.flex.shrink(1),v.l0.align.center]});function ic(e){var t=e.setAttrs,n=(0,u._)((0,r9.KO)(r0),1)[0],r=(0,u._)((0,r9.KO)(r1),1)[0],i=(0,u._)((0,r9.KO)(r2),1)[0];return(0,d.BX)(p.G,{css:ie.B.container,children:[(0,d.BX)(p.G,{css:ie.B.label,children:[(0,d.BX)($.xv,{css:ie.B.resource,multiline:!1,children:[n," ",(0,tJ.Z)("machine",n)]}),(0,d.BX)(p.G,{css:il.costInfo,children:[(0,d.BX)(p.G,{css:ie.B.cost,children:[(0,d.BX)($.xv,{multiline:!1,children:[i," compute units"]}),(0,d.tZ)($.xv,{color:"dimmer",variant:"small",multiline:!1,children:"/s at max traffic"})]}),(0,d.tZ)(nr.u,{tooltip:(0,d.BX)(p.G,{css:ie.B.cost,children:[(0,d.BX)($.xv,{multiline:!1,children:["$",r]}),(0,d.tZ)($.xv,{variant:"small",color:"dimmest",multiline:!1,children:"/s"})]}),children:(0,d.tZ)(ni.Z,{color:v.TV.foregroundDimmest})})]})]}),(0,d.tZ)(ia,{setAttrs:t})]})}var is=n(10454),iu=[v.l0.colWithGap(12),v.l0.borderRadius("container"),v.l0.p(16)],id=(0,S.X)({container:[iu],disabled:[iu,{opacity:.5,pointerEvents:"none"}],text:[v.l0.colWithGap(4)],title:[v.l0.rowWithGap(4),v.l0.align.center],cost:[v.l0.flex.row,v.l0.align.baseline,v.l0.fontWeight.medium,{gap:3}],builder:[v.l0.colWithGap(8),v.l0.position.relative,{"--max-instances-transition-time":l.Normal,"--max-instances":1," *":{transitionTimingFunction:"ease"}}]});function ih(e){var t=e.maxMachineInstances,n=e.disabled,r=e.onError,i=(0,g.useRef)(null),o=(0,r9.b9)(r8),a=(0,r9.b9)(rQ);return(0,g.useEffect)(function(){if(t){var e=rJ.indexOf(t);if(-1===e){r("An error occurred while setting selected max machine instances.");return}a(e)}},[t,a,r]),(0,d.BX)(B.Tg,{elevated:!0,css:n?id.disabled:id.container,children:[(0,d.BX)(p.G,{css:id.text,children:[(0,d.BX)(p.G,{css:id.title,children:[(0,d.tZ)(is.Z,{}),(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:"Max number of machines"})]}),(0,d.tZ)($.xv,{multiline:!0,variant:"small",color:"dimmer",children:"The most machines that should ever spin up to handle your highest traffic. More machines means a faster experience for your users."})]}),(0,d.tZ)(p.G,{css:id.builder,innerRef:i,children:(0,d.tZ)(ic,{setAttrs:{setTransitionTime:function(e){(0,it.A)(i,"--max-instances-transition-time",e)},setProgress:function(e){(0,it.A)(i,"--max-instances-progress",e.toString()),o(e)}}})})]})}function ip(){var e=(0,ee._)(["\n  query AutoscaleMachineConfigurations {\n    hostingMachineConfigurations(input: { provider: cloud_run }) {\n      __typename\n      ... on HostingMachineConfigurationsResults {\n        results {\n          ...MachineConfiguration\n        }\n      }\n      ... on UnauthorizedError {\n        message\n      }\n    }\n  }\n  ","\n"]);return ip=function(){return e},e}var im={},iv=(0,et.Ps)(ip(),nh.bN),ig=function(e){var t,n,r=(0,y.kW)(),i=(0,y.hn)(),o=(0,y.$y)(),a=void 0!==(0,y.pn)(),l=!a&&"string"!=typeof i,c=(0,r9.Dv)(rq.aH),s=(0,r9.Dv)(rq.sA),u=(0,r9.Dv)(r0),f=(t=(0,U._)({},im,{onCompleted:function(t){"HostingMachineConfigurationsResults"!==t.hostingMachineConfigurations.__typename&&e.onError("Something went wrong")},onError:function(t){return e.onError(t.message)}}),en.a(iv,t)),h=f.data,m=f.loading,x=(null==h?void 0:h.hostingMachineConfigurations.__typename)==="HostingMachineConfigurationsResults"?h.hostingMachineConfigurations.results:null;(0,g.useEffect)(function(){e0({context:A.k.AutoscaleMachineConfiguration})},[]);var C=(n=(0,w._)(function(){var t,n,r,i;return(0,Z.Jh)(this,function(o){return(t=null==x?void 0:x.find(function(e){var t=e.vcpu,n=e.memory;return c.toString()===t&&s.toString()===n}))?(n=t.id,r=t.label,i=t.slug,e.onConfirm({configurationId:n,configurationLabel:r,configurationSlug:i,maxInstances:u})):e.onError("An error occurred trying to validate selected machine configuration"),[2]})}),function(){return n.apply(this,arguments)}),S=m||e.fetching||a||r!==b.z.Ready;return(0,d.BX)(d.HY,{children:[(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(nf,{onBack:e.onBack})}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.BX)(p.G,{css:v.l0.colWithGap(16),children:[(0,d.BX)(p.G,{css:v.l0.colWithGap(4),children:[(0,d.tZ)($.xv,{variant:"subheadBig",children:"Autoscale machine configuration"}),(0,d.tZ)($.xv,{variant:"small",color:"dimmer",children:"Autoscale apps spin up enough machines to meet demand at any point in time. You are billed for the total number of compute units across all machines."})]}),(0,d.BX)(p.G,{css:v.l0.colWithGap(16),children:[(0,d.tZ)(rj.Z,{machineConfiguration:null==o?void 0:o.machineConfiguration,disabled:S}),(0,d.tZ)(ih,{maxMachineInstances:null==o?void 0:o.maxMachineInstances,disabled:S,onError:e.onError})]}),(0,d.BX)(p.G,{css:[v.l0.colWithGap(8),v.l0.pt(8)],children:[(0,d.tZ)(D.zx,{colorway:"primary",text:l?"Approve and configure build settings":"Approve and update",iconRight:(0,d.tZ)(ny.Z,{}),onClick:C,loading:m}),(0,d.BX)($.xv,{color:"dimmest",children:["Your deployed app will utilize any available monthly free allotment before charging for additional resource usage."," ",(0,d.tZ)("a",{href:nb.TT.ABOUT_USAGE_BASED_BILLING,target:"_blank",rel:"noopener",children:"Learn more"})]})]})]})})]})},iy=(0,S.X)({deployOptionsWithCurrentBuild:[v.l0.p(16),v.l0.pt(12),v.l0.borderRadius(),v.l0.border({color:v.TV.outlineDimmest})],back:[v.l0.pb(8),v.l0.flex.growAndShrink(1)],subViewOuter:[v.l0.rowWithGap(12)],subView:[v.l0.pb(12),v.l0.flex.growAndShrink(1),v.l0.colWithGap(12)],deploymentInfoWrapper:[v.l0.rowWithGap(12),{':has( + [data-history-timeline-items="1"])':{"[data-timeline-line]":{display:"none"}}}],deploymentInfo:[v.l0.pb(16),v.l0.flex.growAndShrink(1),v.l0.colWithGap(12)]}),ib=function(e){var t=e.view,n=e.onViewAction,r=e.onError,i=e.openFile,o=(0,y.kW)(),a=(0,y.hn)(),l=(0,y.$y)(),c=(0,y.pn)(),s=(0,y.XZ)(),f=(0,nX.rv)(),h=void 0!==l,m=(0,x.Z)(),v=(0,y.l9)(m),w=null==l?void 0:l.provider,Z=h&&l.machineConfiguration?{configurationId:l.machineConfiguration.id,configurationLabel:l.machineConfiguration.label,configurationSlug:l.machineConfiguration.slug,maxInstances:null==l?void 0:l.maxMachineInstances}:void 0,C=(0,nF.Z)("deployments-pane","deployments-mobile-download"),S=C.shouldDisplay,k=C.dismiss,_=C.register;(0,g.useEffect)(function(){_()},[_]);var E=(null==l?void 0:l.status)&&l.status===I.Fe.Success&&S&&!f,T=(0,u._)((0,g.useState)(!1),2),R=T[0],D=T[1],G=o===b.z.Ready||o===b.z.Suspended,B=(0,u._)((0,g.useState)(null),2),P=B[0],N=B[1],L=(0,u._)((0,g.useState)(null),2),U=L[0],O=L[1];(0,g.useEffect)(function(){e0({context:A.k.Deployment})},[]),(0,g.useEffect)(function(){(o===b.z.Preparing||o===b.z.Deploying)&&(t===A.k.DeploymentInProgress||P||n({type:A.a.ChangeView,payload:{view:A.k.DeploymentInProgress}}))},[o,t,n,P]);var M=(0,g.useRef)(void 0);(0,g.useEffect)(function(){M.current=null==c?void 0:c.id},[null==c?void 0:c.id]);var X=(null==l?void 0:l.status)===I.Fe.Success,F=(null==l?void 0:l.id)===M.current;(0,g.useEffect)(function(){X&&F&&n({type:A.a.ChangeView,payload:{view:A.k.Deployment}})},[X,F,n]);var W=null==c?void 0:c.status,V=(0,g.useRef)(W);(0,g.useEffect)(function(){W&&(V.current=W)},[W]);var z=(0,y.v5)(),j=(0,y.t7)();if(P)return(0,d.tZ)(t2,{build:P,fs:s,openFile:i,onBack:function(){N(null)},onViewAppLogs:function(){n({type:A.a.ChangeView,payload:{view:A.k.Logs}})}});if(U===I.r4.CloudRun)return(0,d.tZ)(ig,{onError:r,onConfirm:function(e){n({type:A.a.SendDeploymentLifecycleCommand,payload:{command:I.Qc.UpdateMachineConfiguration,machineConfigurationId:e.configurationId,maxMachineInstances:e.maxInstances}})},onBack:function(){return O(null)}});if(U===I.r4.Gce)return(0,d.tZ)(nx,{isTeamRepl:v,initialMachineConfiguration:Z,onConfirm:function(e){n({type:A.a.SendDeploymentLifecycleCommand,payload:{command:I.Qc.UpdateMachineConfiguration,machineConfigurationId:e.configurationId,maxMachineInstances:e.maxInstances}})},onBack:function(){return O(null)},onError:r});var q=!h||!a;return(0,d.tZ)(d.HY,{children:(0,d.tZ)(H,{children:(0,d.BX)(p.G,{children:[(0,d.BX)(p.G,{css:iy.subViewOuter,children:[h?(0,d.tZ)(e7,{type:"future"}):null,(0,d.BX)(p.G,{css:iy.subView,children:[!q&&G?(0,d.tZ)(rz,{dotReplit:z,fs:s,ports:j,deploymentId:a,onError:r,expanded:R,setExpanded:D,shouldShowMobileTour:null!=E&&E,onDismissMobileTour:k,openNetworkingPane:function(){n({type:A.a.OpenPane,payload:{type:"networking"}})}}):null,t===A.k.DeploymentInProgress?(0,d.tZ)(tC,{openFile:i,viewBuildLogsOnLoad:!h,onViewLogs:function(){n({type:A.a.ChangeView,payload:{view:A.k.Logs}})},onCanceled:function(){n({type:A.a.ChangeView,payload:{view:A.k.Deployment}}),r("Build cancelled")},onError:r}):null]})]}),h?(0,d.BX)(d.HY,{children:[(0,d.tZ)(tK,{type:"failureQueue",onViewBuildLogs:N}),(0,d.BX)(p.G,{css:iy.deploymentInfoWrapper,children:[(0,d.tZ)(e7,{type:"present"}),(0,d.tZ)(p.G,{css:iy.deploymentInfo,children:(0,d.tZ)(nM,{provider:w,machine:Z,onViewBuildLogs:N,onManageClick:function(){if(w===I.r4.CloudRun||w===I.r4.Gce){O(w);return}w===I.r4.Static&&n({type:A.a.ChangeView,payload:{view:A.k.Settings}})}})})]}),(0,d.tZ)(tK,{onViewBuildLogs:N})]}):null]})})})},iw=n(66587),iZ=n(55330),ix=n(52932),iC=n(4513),iS=n(81340),ik=n(97764),i_=n(76566),iE=n(59811),iT=n(50946),iR=n(96239),iI=n(4773),iD=n(70078),iG=n(87001),iB=n(16560),iP=function(){var e=(0,y.gg)(),t=e.isDeployableRepl,n=e.reason;return t?null:(0,d.tZ)(C.E,{colorway:"warning",text:n})};function iA(){var e=(0,ee._)(["\n  fragment DeploymentsNewDeploymentRepl on Repl {\n    id\n    slug\n    owner {\n      ... on User {\n        id\n        username\n      }\n      ... on Team {\n        id\n        username\n      }\n    }\n    powerUps {\n      ... on ReplPowerUpTypes {\n        hostingTier {\n          sku\n        }\n      }\n    }\n  }\n"]);return iA=function(){return e},e}function iN(){var e=(0,ee._)(["\n  query DeploymentsNewDeployment($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        ...DeploymentsNewDeploymentRepl\n      }\n    }\n  }\n  ","\n"]);return iN=function(){return e},e}var iL={},iU=(0,et.Ps)(iA()),iO=(0,et.Ps)(iN(),iU);function iM(){var e=(0,ee._)(["\n  query DeploymentsPaneIntro($id: String!) {\n    repl(id: $id) {\n      ... on Repl {\n        id\n        owner {\n          __typename\n          ... on Team {\n            id\n          }\n        }\n        ...DeploymentsNewDeploymentRepl\n      }\n    }\n  }\n  ","\n"]);return iM=function(){return e},e}var iX={},iF=(0,et.Ps)(iM(),iU),iW=n(41588),iH=n(89960),iV=n(95109),iz=n(60814),ij=n(84460),iq=n(88211),iY=n(7755),iJ=n(74094);function iK(e){var t=e.amount,n=e.includeUsd,r=e.variant,i=e.color,o=void 0===i?"default":i,a=(0,iY.$E)(t),l=(0,iY.H2)(t);return(0,d.BX)(p.G,{css:[v.l0.rowWithGap(2),v.l0.align.center],children:[(0,d.tZ)(iJ.Z,{size:"small"===r?12:16,css:[$.E_[o]]}),(0,d.BX)($.xv,{variant:r,color:o,multiline:!1,children:[l,n?" (".concat(a,")"):""]})]})}var i$=n(44225),iQ={hosting_tier:I.kL.HostingTier},i0={hosting_tier_e2_micro:I.s2.HostingTierE2Micro,hosting_tier_e2_small:I.s2.HostingTierE2Small,hosting_tier_e2_medium:I.s2.HostingTierE2Medium,hosting_tier_n1_custom_1_4:I.s2.HostingTierN1Custom_1_4,hosting_tier_e2_standard_2:I.s2.HostingTierE2Standard_2,hosting_tier_e2_standard_4:I.s2.HostingTierE2Standard_4},i1=n(28585),i2=n(90777),i8=n(52924),i4=n(91685),i3=n(88817),i5=n(98965),i6=n(19762),i9=n(78711);function i7(){var e=(0,ee._)(["\n  query RefetchPowerUps($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        ...ReplPowerUpMutationReturnFields\n      }\n    }\n    currentUser {\n      ...PowerUpMutationReturnFields\n    }\n  }\n  ","\n  ","\n"]);return i7=function(){return e},e}var oe={},ot=(0,et.Ps)(i7(),i6.sh,i6.E_),on=function(e){var t,n=e.productCost,r=e.cyclesBalance;if(n<=r)return{cyclesToBePurchased:0,cyclesBalanceAfterUpgrade:r,excessPurchaseExplanation:"no-purchase"};var i=n-r,o="no-excess";i>=nS.gp?(t=i,o="no-excess"):(t=nS.gp,o="minimum");var a=r+t-n;return{cyclesToBePurchased:t,cyclesBalanceAfterUpgrade:a,excessPurchaseExplanation:o}};function or(e){var t=e.cycles,n=e.description;return(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.align.center],children:[(0,d.tZ)($.xv,{color:"dimmest",multiline:!1,children:n}),(0,d.tZ)(te.R,{}),(0,d.tZ)(iK,{amount:t,includeUsd:!1,color:"dimmest"})]})}var oi=(0,S.X)({iconBackground:[v.l0.width(40),v.l0.height(40),v.l0.borderRadius(8),v.l0.justify.center,v.l0.align.center,v.l0.backgroundColor.blueDimmer],loadingContainer:[v.l0.justify.center,v.l0.align.center,v.l0.minHeight(80)]});function oo(e){var t=e.powerUpCategory,n=e.cyclesCost,r=e.description,i=iW.S0[t];return(0,d.tZ)(p.G,{css:[v.l0.colWithGap(16)],children:(0,d.BX)(p.G,{css:[v.l0.flex.row,v.l0.justify.spaceBetween],children:[(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.align.center],children:[(0,d.tZ)(p.G,{css:oi.iconBackground,children:(0,d.tZ)(i.iconComponent,{size:24})}),(0,d.BX)(p.G,{css:[v.l0.px(8),v.l0.py(2),v.l0.colWithGap(4),v.l0.justify.spaceBetween],children:[(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:i.name}),(0,d.tZ)($.xv,{variant:"small",color:"dimmer",multiline:!1,children:r})]})]}),(0,d.BX)(p.G,{css:[v.l0.px(8),v.l0.py(2),v.l0.colWithGap(4),v.l0.justify.spaceBetween,v.l0.align.end],children:[(0,d.tZ)(iK,{amount:n,includeUsd:!0}),(0,d.BX)($.xv,{variant:"small",color:"dimmer",multiline:!1,children:["per / ",i.orderDuration]})]})]})})}function oa(e){var t,n,r,i=e.product,o=e.goToCheckoutSuccess,a=e.goToNewPaymentMethodForm,l=(0,iV.useStripe)(),c=(0,iz.Z)({forceFetch:!0}),s=c.cycles,f=c.loading,h=(0,i2.Q)(),y=h.paymentMethod,b=h.loading,x=iW.S0[i.powerUpCategory],C=iW.$[i.powerUpSku].provisionDescription,S=(0,u._)((0,g.useState)(null),2),k=S[0],_=S[1],E=(0,u._)((0,g.useState)(!1),2),T=E[0],R=E[1],I=(0,u._)((0,g.useState)(!1),2),G=I[0],B=I[1],P=(0,i1.M)().createCheckoutSession,A=(0,u._)((t={variables:{replId:i.replId}},n=(0,U._)({},oe,t),i9.t(ot,n)),1)[0],N=(0,i5.B)().startPolling,L=(0,ij.kr)({defaultAutoRefillEnabledValue:!0}),M=L.autoRefillEnabled,X=L.autoRefillMonthlyBudget,F=L.autoRefillHasError,W=L.autoRefillHasChanged,H=L.cardAutoRefillPreferencesProps,V=on({productCost:i.cyclesCostNow,cyclesBalance:null!=s?s:0}),z="This will purchase ".concat(V.cyclesToBePurchased.toLocaleString()," Cycles for ").concat((0,nS.qJ)(V.cyclesToBePurchased)," and activate your ").concat(x.name,".");"minimum"===V.excessPurchaseExplanation&&(z="This will purchase the minimum purchase amount of ".concat(V.cyclesToBePurchased.toLocaleString()," Cycles for ").concat((0,nS.qJ)(V.cyclesToBePurchased)," and activate your ").concat(x.name,"."));var j=(0,u._)((0,g.useState)("Processing..."),2),q=j[0],Y=j[1],J=(0,i3.i)(),K=J.isPurchaseAllowed,Q=J.reasonPurchaseNotAllowed;if(!K&&Q)return(0,d.tZ)(i4.Z,{reason:Q});var ee=function(){R(!1)},et=(r=(0,w._)(function(){return(0,Z.Jh)(this,function(e){switch(e.label){case 0:var t;if(R(!0),null==y)throw Error("paymentMethod is null");if(null==l)throw Error("stripe is null");return Y("Checking out..."),[4,P({input:{cyclesQuantity:V.cyclesToBePurchased,postPurchasePowerUp:{replPowerUp:{replId:i.replId,sku:i0[i.powerUpSku],type:iQ[i.powerUpCategory]}},cyclesAutoRefillConfiguration:W?{enabled:M,monthlyBudget:X}:null},onError:function(e){_(e),ee()},onSucceed:(t=(0,w._)(function(e){var t,n;return(0,Z.Jh)(this,function(r){switch(r.label){case 0:return Y("Processing payment..."),[4,l.confirmCardPayment(e.clientSecret)];case 1:if(t=r.sent().error)return _(null!==(n=t.message)&&void 0!==n?n:"An error occurred. Please try again."),ee(),[2];return Y("Provisioning Power Up..."),N({checkoutSessionId:{checkoutSessionId:e.checkoutSessionId}.checkoutSessionId,onSucceeded:function(){B(!0),A(),o(i)},onFailed:function(){_("Payment failed. Please try again."),ee(),A()},onError:function(e){_(e),ee(),A()}}),[2]}})}),function(e){return t.apply(this,arguments)})})];case 1:return e.sent(),[2]}})}),function(){return r.apply(this,arguments)}),en=b||f||null==s,er=null!=y&&!en&&!T;return(0,d.BX)(p.G,{css:[v.l0.colWithGap(16)],children:[(0,d.tZ)(oo,{powerUpCategory:i.powerUpCategory,cyclesCost:nS.z4[i.powerUpSku],description:C}),(0,d.tZ)(te.R,{}),en?(0,d.tZ)(p.G,{css:oi.loadingContainer,children:(0,d.tZ)(m.Z,{})}):(0,d.tZ)(p.G,{css:[v.l0.colWithGap(12),v.l0.align.start],children:null==y?(0,d.BX)(d.HY,{children:[(0,d.tZ)($.xv,{color:"dimmer",children:"You need to add a payment method to complete this purchase."}),(0,d.tZ)(D.zx,{iconLeft:(0,d.tZ)(nQ.Z,{}),text:"Add Payment Method",size:"big",onClick:a,colorway:"primary",stretch:!0})]}):(0,d.tZ)(d.HY,{children:(0,d.tZ)(p.G,{css:[v.l0.colWithGap(16)],children:(0,d.BX)(p.G,{css:[v.l0.colWithGap(4)],children:[(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.align.center],children:[(0,d.tZ)(eB.hU,{alt:"Update Payment Method",onClick:a,children:(0,d.tZ)(i8.Z,{})}),(0,d.tZ)(iq.R,{last4:y.last4})]}),(0,d.tZ)(p.G,{css:[v.l0.pl(24),v.l0.pr(16),v.l0.colWithGap(8)],children:(0,d.tZ)(ij.OK,(0,O._)((0,U._)({},H),{loading:H.loading||T,showSaveButton:!1}))})]})})})}),null!==y?(0,d.BX)(d.HY,{children:[(0,d.tZ)(te.R,{}),(0,d.tZ)($.xv,{variant:"small",css:[v.l0.color.foregroundDimmer],children:z}),(0,d.tZ)(i$.q,{isMakingPayment:!0,showSuccessState:G,showProcessingState:T,disabled:!er||F,initialStateTextOverride:"Purchase ".concat(V.cyclesToBePurchased.toLocaleString()," Cycles & Upgrade ").concat(x.name),processingStateTextOverride:q,size:"big",onClick:et}),null!=k?(0,d.tZ)($.xv,{css:[v.l0.color.accentNegativeDefault],children:k}):null,(0,d.BX)(p.G,{css:[v.l0.colWithGap(4)],children:[(0,d.tZ)(or,{description:"Cycles balance after purchase",cycles:V.cyclesToBePurchased}),(0,d.tZ)(or,{description:"1st ".concat(x.orderDuration," of ").concat(x.name),cycles:-1*i.cyclesCostNow}),(0,d.tZ)(or,{description:"Cycles balance after upgrade",cycles:V.cyclesBalanceAfterUpgrade})]})]}):null]})}function ol(){var e=(0,ee._)(["\n  query CheckOutSuccess($replId: String!) {\n    currentUser {\n      id\n      cyclesAutoRefillConfiguration {\n        ... on CyclesAutoRefillConfiguration {\n          id\n          enabled\n          refillAmount\n          monthlyBudget\n        }\n        ... on UnauthorizedError {\n          message\n        }\n      }\n    }\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        owner {\n          ... on Team {\n            id\n          }\n          ... on User {\n            id\n          }\n        }\n      }\n    }\n  }\n"]);return ol=function(){return e},e}var oc={},os=(0,et.Ps)(ol()),ou=n(57122),od=(0,S.X)({powerUpIconBackground:[v.l0.width(32),v.l0.height(32),v.l0.borderRadius(8),v.l0.justify.center,v.l0.align.center,v.l0.backgroundColor.blueDimmer],autoRefillIconBackground:[v.l0.width(32),v.l0.height(32),v.l0.borderRadius(8),v.l0.justify.center,v.l0.align.center,v.l0.backgroundColor.greyDimmer]});function of(e){var t,n,r,i,o,a,l,c=e.product,s=e.goToCardPreferences,u=e.goToPowerUpDetails,f=(0,iz.Z)({forceFetch:!0}).cycles,h=(t={variables:{replId:c.replId}},n=(0,U._)({},oc,t),en.a(os,n)),g=h.data,y=h.loading,b=(null==g?void 0:null===(a=g.currentUser)||void 0===a?void 0:null===(o=a.cyclesAutoRefillConfiguration)||void 0===o?void 0:o.__typename)==="CyclesAutoRefillConfiguration"?g.currentUser.cyclesAutoRefillConfiguration:null,w=(null==g?void 0:g.repl.__typename)==="Repl"&&(null===(l=g.repl.owner)||void 0===l?void 0:l.__typename)==="Team",Z=!!(null==b?void 0:b.enabled),x=iW.S0[c.powerUpCategory],S=iW.$[c.powerUpSku];return(0,d.BX)(p.G,{css:[v.l0.colWithGap(16)],children:[(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.justify.spaceBetween,v.l0.align.center],children:[(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.align.center],children:[(0,d.tZ)(p.G,{css:od.powerUpIconBackground,children:(0,d.tZ)(x.iconComponent,{size:20})}),(0,d.BX)(p.G,{css:[v.l0.flex.column],children:[(0,d.BX)($.xv,{multiline:!1,children:[x.name," activated"]}),(0,d.BX)(p.G,{css:v.l0.rowWithGap(8),children:[(0,d.tZ)($.xv,{variant:"small",color:"dimmer",multiline:!1,children:S.provisionDescription}),w?null:(0,d.BX)(p.G,{css:[v.l0.rowWithGap(4)],children:[(0,d.tZ)(iK,{amount:nS.z4[c.powerUpSku],includeUsd:!0,variant:"small",color:"dimmer"}),(0,d.BX)($.xv,{variant:"small",color:"dimmer",multiline:!1,children:["/ ",x.orderDuration]})]})]})]})]}),(0,d.tZ)($.xv,{multiline:!1,children:(0,d.tZ)("a",{role:"button",tabIndex:0,onKeyDown:function(){return u(c.powerUpCategory)},onClick:function(){return u(c.powerUpCategory)},css:[v.l0.color.foregroundDimmer,{textDecoration:"underline"}],children:"Edit"})})]}),w||y?null:(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.justify.spaceBetween,v.l0.align.center],children:[(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.align.center],children:[(0,d.tZ)(p.G,{css:od.autoRefillIconBackground,children:(0,d.tZ)(ou.Z,{size:20})}),(0,d.BX)(p.G,{css:[v.l0.flex.column],children:[(0,d.BX)($.xv,{multiline:!1,children:["Auto-Refill is"," ",(i=(r={autoRefillEnabled:Z,loadingAutoRefill:y}).autoRefillEnabled,r.loadingAutoRefill?"...":i?"on":"off")]}),(0,d.tZ)(p.G,{css:v.l0.rowWithGap(4),children:null==f?(0,d.tZ)(m.Z,{}):(0,d.BX)(d.HY,{children:[(0,d.tZ)(iK,{amount:f,includeUsd:!1,variant:"small",color:"dimmer"}),(0,d.tZ)($.xv,{variant:"small",color:"dimmer",multiline:!1,children:"left"})]})})]})]}),(0,d.tZ)($.xv,{multiline:!1,children:(0,d.tZ)("a",{role:"button",tabIndex:0,onKeyDown:function(){return s(c.powerUpCategory)},onClick:function(){return s(c.powerUpCategory)},css:[v.l0.color.foregroundDimmer,{textDecoration:"underline"}],children:"Edit"})})]}),y||Z||w?null:(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:"Add a payment method and enable Auto-Refill to prevent your ".concat(x.name," Power Up from being disabled when you run out of Cycles.")})]})}var oh=n(15670),op={tier:(0,j.iv)([v.l0.borderRadius(12),v.l0.colWithGap(12),v.l0.p(12)]),tierHeader:(0,j.iv)([v.l0.rowWithGap(8),v.l0.flex.grow(1),v.l0.justify.spaceBetween,v.l0.align.baseline]),tierHeaderTitle:(0,j.iv)(v.l0.rowWithGap(8)),tierHeaderCost:(0,j.iv)([v.l0.rowWithGap(4),v.l0.align.baseline]),tierFeatures:(0,j.iv)(v.l0.colWithGap(8)),tierFeature:(0,j.iv)(v.l0.rowWithGap(4),v.l0.align.center),tierPicker:(0,j.iv)([v.l0.border({color:v.TV.outlineDefault})])},om=function(e){var t=e.selectedOption,n=e.onChange,r=e.disabled,i=nS.r4[t.sku].egress,o="INCLUDED_IN_SUBSCRIPTION"!==t.cost.explanation&&"NOT_SUPPORTED_FOR_TEAMS"!==t.cost.explanation;return(0,d.BX)(B.Tg,{elevated:!0,css:op.tier,children:[(0,d.BX)(p.G,{css:op.tierHeader,children:[(0,d.tZ)(p.G,{css:op.tierHeaderTitle,children:(0,d.tZ)($.xv,{variant:"subheadBig",multiline:!1,children:"Reserved VM"})}),(0,d.tZ)(p.G,{css:v.l0.rowWithGap(4),children:o?(0,d.BX)(p.G,{css:[v.l0.rowWithGap(2),v.l0.align.center],children:[(0,d.tZ)(iJ.Z,{}),(0,d.BX)(p.G,{css:[op.tierHeaderCost],children:[(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:t.cost.cyclesCostRecurring}),(0,d.tZ)($.xv,{color:"dimmer",variant:"small",multiline:!1,children:"per day"})]})]}):null})]}),(0,d.tZ)(ng.P,{css:op.tierPicker,initialSelectedItem:{title:n_(t.sku),sku:t.sku},items:Object.keys(nS.r4).map(function(e){return{title:n_(e),sku:e}}),onChange:function(e){return n(e.sku)},disabled:r}),(0,d.tZ)(p.G,{css:op.tierFeatures,children:["".concat(i," GiB egress"),"Deploy to any URL, cover page optional","Configurable machine","Always on"].map(function(e,t){return(0,d.BX)(p.G,{css:op.tierFeature,children:[(0,d.tZ)(tl.Z,{}),(0,d.tZ)($.xv,{multiline:!1,children:e})]},t)})})]})},ov=n(43182),og=n(58378),oy=function(e){var t,n,r=e.context,i=e.selectedOption,o=e.currentOption,a=e.onBuyMoreCycles,l=e.onPowerUpUpdated,c=e.onPowerUpRequested,s=(0,x.Z)(),f=(0,rg.Z)().showError,h=(0,u._)((0,g.useState)(!1),2),p=h[0],m=h[1],y=(0,ij.kr)({}).autoRefillEnabled,b=(0,u._)((0,og.IN)({onCompleted:(t=(0,w._)(function(e){var t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:if("UserError"===(t=e.setHostingTier).__typename)return f(t.message),[2];return m(!0),[4,new Promise(function(e){return setTimeout(e,2e3)})];case 1:return n.sent(),l({type:"powerUp",powerUpCategory:"hosting_tier",powerUpSku:i.sku,cyclesCostNow:i.cost.cyclesCostNow,replId:s}),[2]}})}),function(e){return t.apply(this,arguments)}),onError:function(e){c(!1),ov.Tb(e),f(e.message)}}),2),C=b[0],S=b[1].loading;if(p)return(0,d.tZ)(D.zx,{text:"Tier Purchased",colorway:"positive",loading:!0,css:{color:"".concat(v.TV.accentPositiveStronger," !important")}});var k=(null==o?void 0:o.sku)===i.sku,_=!0;switch(i.cost.explanation){case I.Ch.IncludedInExistingOrder:case I.Ch.ActivateExistingOrder:case I.Ch.SpendCycles:case I.Ch.NeedsCycles:case I.Ch.IncludedInSubscription:_=!1}return S?(_=!0,n="Processing"):k?(_=!0,n="Current tier"):n="INCLUDED_IN_SUBSCRIPTION"===i.cost.explanation?"Activate and deploy":"NOT_SUPPORTED_FOR_TEAMS"===i.cost.explanation?"Not available for teams":"Purchase and deploy",(0,d.tZ)(D.zx,{text:n,disabled:_,loading:S,colorway:S||!_?"primary":void 0,iconRight:S?void 0:(0,d.tZ)(ny.Z,{}),onClick:function(){var e;if(c(!0),!S){if(i.cost.explanation===I.Ch.NeedsCycles){a({type:"powerUp",powerUpCategory:"hosting_tier",powerUpSku:i.sku,cyclesCostNow:i.cost.cyclesCostNow,replId:s});return}C({variables:{input:{replId:s,sku:i.sku}}}),null!==(e=i.cost.cyclesCostNow)&&void 0!==e&&e&&((0,eQ.j)(eQ.U3.CHECKOUT_REQUESTED,{source:r,powerUpCategory:"boost"}),(0,eQ.j)(eQ.U3.CYCLES_USED,{powerUp:"hosting_tier",sku:i.sku,source:r}),(0,eQ.j)(eQ.U3.CHECKOUT_COMPLETED,{source:r,powerUpCategory:"boost",autoRefill:y}))}},css:S&&{color:"".concat(v.TV.accentPrimaryStronger," !important")}})},ob=function(e){var t=e.context,n=e.onBuyMoreCycles,r=e.onPowerUpUpdated,i=(0,x.Z)(),o=(0,u._)((0,g.useState)("ready"),2),a=o[0],l=o[1],c=(0,u._)((0,g.useState)(null),2),s=c[0],f=c[1],h=(0,u._)((0,g.useState)(null),2),y=h[0],b=h[1],w=(0,u._)((0,g.useState)(null),2),Z=w[0],C=w[1];if((0,og.s7)({fetchPolicy:"network-only",ssr:!1,variables:{replId:i},onCompleted:function(e){if((null==e?void 0:e.repl.__typename)==="Repl"&&(null===(n=e.repl)||void 0===n?void 0:null===(t=n.powerUps)||void 0===t?void 0:t.__typename)==="ReplPowerUpTypes"&&(null===(i=e.repl)||void 0===i?void 0:null===(r=i.powerUpCosts)||void 0===r?void 0:r.__typename)==="PowerUpCostsType"){var t,n,r,i,o,a,l=null===(o=e.repl.powerUps.hostingTier)||void 0===o?void 0:o.sku,c=l||((null===(a=e.repl.owner)||void 0===a?void 0:a.__typename)==="Team"?I.DZ.HostingTierE2Micro:I.DZ.HostingTierE2Small),s=nk(e.repl.powerUpCosts,l),u=nk(e.repl.powerUpCosts,c);s&&l&&b({sku:l,cost:s}),u&&f({sku:c,cost:u}),C(e.repl.powerUpCosts)}}}).loading||!s||!Z)return(0,d.tZ)(p.G,{css:[v.l0.flex.row,v.l0.justify.center],children:(0,d.tZ)(m.Z,{})});var S=null;if("INCLUDED_IN_SUBSCRIPTION"===s.cost.explanation)S="Included in your subscription plan.";else if(s.cost.cyclesCostRecurring>0){var k=(0,iY.$E)(s.cost.cyclesCostRecurring),_=(0,iY.$E)(s.cost.cyclesCostRecurring*nb.Dj);S="".concat(k,"/day (Approximately ").concat(_,"/month).")}var E=null;switch(s.cost.explanation){case I.Ch.IncludedInExistingOrder:break;case I.Ch.NeedsCycles:E="You'll be able to purchase Cycles while activating.";break;case I.Ch.SpendCycles:E="Today's charge will be ".concat(s.cost.cyclesCostNow," Cycles.")}return(0,d.BX)(p.G,{css:v.l0.colWithGap(16),children:[(0,d.tZ)(om,{selectedOption:s,onChange:function(e){var t=nk(Z,e);t&&f({sku:e,cost:t})},disabled:"requesting"===a}),(0,d.tZ)(p.G,{css:[v.l0.colWithGap(12)],children:(0,d.BX)(p.G,{css:[v.l0.colWithGap(8)],children:[(0,d.BX)(p.G,{css:[v.l0.minHeight(50),v.l0.colWithGap(16),v.l0.justify.end,v.l0.mb(16)],children:[null!=S?(0,d.tZ)($.xv,{css:[v.l0.textAlign.center],multiline:!1,children:S}):null,null!=E?(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.justify.center,v.l0.color.foregroundDimmer],children:[(0,d.tZ)($.xv,{multiline:!1,children:E}),(0,d.tZ)(nr.u,{tooltip:"Upgrades and downgrades are immediate. Upgrading within a 24 hour period following a downgrade will incur a charge.",children:(0,d.tZ)(ni.Z,{})})]}):null]}),(0,d.tZ)(oy,{context:t,selectedOption:s,currentOption:y,onBuyMoreCycles:n,onPowerUpUpdated:r,onPowerUpRequested:function(e){return l(e?"requesting":"ready")}})]})})]})},ow=n(47957),oZ=n(56337),ox=n(70002);n(31850);var oC=n(28079),oS=n(5542),ok=n(89106),o_=n(30845),oE=n(39083),oT=n(16166),oR=(0,S.X)({self:[v.l0.flex.column],content:[v.l0.pt(16),v.l0.px(12),v.l0.pb(12),v.l0.colWithGap(16)],contentSlim:[v.l0.colWithGap(8)],header:[v.l0.p(12),v.l0.rowWithGap(8),v.l0.justify.start,v.l0.align.center,v.l0.border({color:v.TV.outlineDefault,width:1,style:"solid",direction:"bottom"})],actions:[v.l0.colWithGap(8)],footer:[v.l0.rowWithGap(16),v.l0.justify.spaceBetween,v.l0.align.center,v.l0.pt(4)],loadingWrapper:[v.l0.center],storageBarWrapper:[v.l0.colWithGap(8)],summaryWrapper:[v.l0.colWithGap(8),v.l0.align.start],totalSummaryDot:[v.l0.backgroundColor.backgroundHigher,v.l0.width(8),v.l0.height(8),{borderRadius:"50%"}],replSummaryDot:[v.l0.backgroundColor.accentPrimaryDefault,v.l0.width(8),v.l0.height(8),{borderRadius:"50%"}],summaryRow:[v.l0.rowWithGap(8),v.l0.justify.start,v.l0.align.center,v.l0.fontSize(14),v.l0.height(14)],replSummaryText:[v.l0.color.accentPrimaryStronger],replSummaryUsage:[v.l0.color.accentPrimaryStrongest],replUsagePlaceholder:[K.p.backgroundPulse(v.TV.backgroundHigher,v.TV.backgroundRoot),{opacity:.5},v.l0.borderRadius(4),v.l0.height("100%"),v.l0.width(64)],totalUsagePlaceholder:[K.p.backgroundPulse(v.TV.backgroundHigher,v.TV.backgroundRoot),{opacity:.5},v.l0.borderRadius(4),v.l0.height("100%"),v.l0.width(140)],availablePlaceholder:[K.p.backgroundPulse(v.TV.backgroundHigher,v.TV.backgroundRoot),{opacity:.5},v.l0.borderRadius(4),v.l0.height("100%"),v.l0.width(64)],availableText:[v.l0.color.foregroundDimmest]}),oI=function(e){var t,n=e.isInDesktopApp,r=e.loading,i=e.data,o=e.setShowUpgradeModal,a=e.slim;if((0,g.useEffect)(function(){var e;if(i&&(null===(e=i.currentUser)||void 0===e?void 0:e.__typename)==="CurrentUser"&&"StorageQuota"===i.currentUser.storageInfo.storageQuota.__typename&&"AccountStorageUtilization"===i.currentUser.storageInfo.accountStorageUtilization.__typename&&!r)try{var t=parseInt(i.currentUser.storageInfo.storageQuota.quota,10),n=parseInt(i.currentUser.storageInfo.accountStorageUtilization.total,10);(0,eQ.j)(nJ.U3.MODAL_VIEWED,{modalName:"workspace_storage_modal",storageQuota:t,storageUtilization:n,storageUtilizationPercentage:n/t})}catch(e){}},[i,r]),r&&!i)return(0,d.BX)(p.G,{css:a?oR.contentSlim:oR.content,children:[(0,d.tZ)(o_.M,{}),(0,d.tZ)(p.G,{css:oR.footer,children:n?(0,d.tZ)(D.zx,{onClick:function(){ok.X.openExternalUrl(oC.$I.as)},text:"Manage Repls"}):(0,d.tZ)(ox.Z,{href:oC.$I.href,as:oC.$I.as,text:"Manage Repls"})})]});if(i&&(null===(t=i.currentUser)||void 0===t?void 0:t.__typename)==="CurrentUser"&&"StorageQuota"===i.currentUser.storageInfo.storageQuota.__typename&&"AccountStorageUtilization"===i.currentUser.storageInfo.accountStorageUtilization.__typename){var l=i.currentUser.username,c=i.currentUser.userSubscriptionType===I.HP.HackerPro;return(0,d.BX)(p.G,{css:a?oR.contentSlim:oR.content,children:[i?(0,d.tZ)(o_.l,{data:i}):(0,d.tZ)(o_.M,{}),(0,d.BX)(p.G,{css:oR.footer,children:[(0,d.tZ)(ox.Z,(0,O._)((0,U._)({},(0,oS.Ru)(l)),{text:"Manage Repls"})),(0,d.tZ)(oT.U,{isPro:c,setShowUpgradeModal:o,source:"workspace_storage_modal_upgrade_button"})]})]})}return(0,d.BX)(p.G,{css:a?oR.contentSlim:oR.content,children:[(0,d.tZ)($.xv,{color:"dimmest",multiline:!1,children:"We had trouble loading your storage information. Please try again later."}),(0,d.tZ)(p.G,{css:oR.footer,children:(0,d.tZ)(ox.Z,{href:oC.$I.href,as:oC.$I.as,text:"Manage Repls"})})]})},oD=(0,S.X)({self:[v.l0.flex.column]}),oG=function(){var e=(0,oZ.Z)(),t=(0,u._)((0,g.useState)(!1),2),n=t[0],r=t[1],i=(0,ow.Pf)({fetchPolicy:"network-only",ssr:!1,notifyOnNetworkStatusChange:!0}),o=i.data,a=i.loading,l=i.refetch;return(0,d.BX)(d.HY,{children:[(0,d.tZ)(p.G,{css:oD.self,children:(0,d.tZ)(oI,{loading:a,isInDesktopApp:e,data:o,setShowUpgradeModal:r,slim:!0})}),(0,d.tZ)(oE.Z,{isOpen:n,context:"workspace_info_modal",powerUp:"storage",uponPurchaseGoTo:"workspace",onRequestClose:function(){l(),r(!1)}})]})},oB=n(47648),oP=n(92611),oA="workspace_info_modal";function oN(e){var t=e.powerUpCategory,n=e.goToCheckout,r=e.goToCheckoutSuccess,i=e.onRequestPowerUp,o=(0,u._)((0,g.useState)(null),2),a=o[0],l=o[1];switch(t){case"hosting_tier":return(0,d.tZ)(ob,{context:"workspace_hosting_pane",onPowerUpUpdated:r,onBuyMoreCycles:n});case"storage":return(0,d.tZ)(oG,{});case"always-on":return(0,d.BX)(d.HY,{children:[(0,d.tZ)(oB.Z,{initialTab:"default",isOpen:a===oP.x.BuyCycles,onRequestClose:function(){return l(null)},uponPurchaseGoTo:"workspace",context:oA,allowCyclesPage:!1}),(0,d.tZ)(oh.Z,{onRequestBuyMore:function(){return l(oP.x.BuyCycles)},powerUp:"always-on",context:oA,onRequestPowerUp:i})]});case"gpu":return(0,d.BX)(d.HY,{children:[(0,d.tZ)(oB.Z,{initialTab:"default",isOpen:a===oP.x.BuyCycles,onRequestClose:function(){return l(null)},uponPurchaseGoTo:"workspace",context:oA,allowCyclesPage:!1}),(0,d.tZ)(oh.Z,{onRequestBuyMore:function(){return l(oP.x.BuyCycles)},powerUp:"gpu",context:oA,onRequestPowerUp:i})]});default:throw Error("Unknown power up category: ".concat(t))}}function oL(e){var t=e.title,n=e.children,r=e.goBack,i=e.canGoBack,o=e.allowBack;return(0,d.BX)(d.HY,{children:[(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.p(8),v.l0.align.center],children:[(void 0===o||o)&&i?(0,d.tZ)(eB.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return r()},dataCy:"purchase-flow-back-button",children:(0,d.tZ)(tH.Z,{})}):null,"string"==typeof t?(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:t}):t]}),(0,d.tZ)(p.G,{css:[v.l0.colWithGap(8),v.l0.p(8)],children:n})]})}function oU(e){var t=e.currentStep,n=e.goBack,r=e.canGoBack,i=e.goTo,o=e.analyticsContext,a=e.onRequestPowerUp;switch(t.step){case"power_up_details":var l=t.powerUpCategory,c=iW.S0[l];return(0,d.tZ)(oL,{goBack:n,canGoBack:r,title:c.name,children:(0,d.tZ)(oN,{powerUpCategory:l,goToCheckout:function(e){i({step:"checkout",product:e}),(0,eQ.j)(eQ.U3.CHECKOUT_REQUESTED,{source:o,powerUpCategory:l})},goToCheckoutSuccess:function(e){i({step:"checkout_success",product:e})},onRequestPowerUp:a})});case"checkout":return(0,d.tZ)(oL,{goBack:n,canGoBack:r,title:"Checkout",children:(0,d.tZ)(oa,{product:t.product,goToCheckoutSuccess:function(e){i({step:"checkout_success",product:e})},goToNewPaymentMethodForm:function(){return i({step:"new_payment_method_form"})},context:o})});case"checkout_success":return(0,d.tZ)(oL,{goBack:n,canGoBack:r,allowBack:!1,title:(0,d.BX)(p.G,{css:[v.l0.rowWithGap(8),v.l0.align.center],children:[r?(0,d.tZ)(eB.hU,{tooltipHidden:!0,alt:"Back",onClick:function(){return n()},children:(0,d.tZ)(tH.Z,{})}):null,(0,d.tZ)($.xv,{multiline:!1,css:[v.l0.color.accentPositiveStronger],children:"Success"}),(0,d.tZ)(tl.Z,{color:v.TV.accentPositiveStronger})]}),children:(0,d.tZ)(of,{product:t.product,goToCardPreferences:function(e){return i({step:"card_preferences",powerUpCategory:e})},goToPowerUpDetails:function(e){return i({step:"power_up_details",powerUpCategory:e})}})});case"card_preferences":var s=t.powerUpCategory;return(0,d.tZ)(oL,{goBack:n,canGoBack:r,title:"Card Preferences",children:(0,d.tZ)(iH.t,{goToNewPaymentMethodForm:function(){return i({step:"new_payment_method_form",powerUpCategory:s})}})});case"new_payment_method_form":var u=t.powerUpCategory;return(0,d.tZ)(oL,{goBack:n,canGoBack:r,title:"Update Payment Method",children:(0,d.tZ)(ik.q,{onSuccess:function(){return r&&n()},powerUpCategory:u,context:o})});case"not_shown":throw Error("This step should never be rendered");default:(0,nC.Z)(t)}}var oO=n(71411),oM=n(14819),oX=n(56335),oF=n(27187),oW=n(70315),oH=n(52682),oV=(0,S.X)({container:v.l0.colWithGap(24),pauseAndResumeButtons:v.l0.colWithGap(8),sectionContainer:v.l0.colWithGap(8),sectionButton:[v.l0.color.accentNegativeStrongest,v.l0.transition.snappy,(0,V._)({backgroundColor:G.vb.interactiveBackground,borderColor:"transparent"},v.wl.hover,{borderColor:"transparent"})]}),oz=function(e){var t=e.hideResume,n=e.hideSuspend,r=e.onLifecycleCommand,i=(0,y.kW)(),o=(0,y.$y)(),a=(0,u._)((0,g.useState)(!1),2),l=a[0],c=a[1],s=(0,x.Z)(),f=(0,y.FN)(s),h=(null==o?void 0:o.status)===I.Fe.Resuming,v=(null==o?void 0:o.status)===I.Fe.Suspending,w=(null==o?void 0:o.status)===I.Fe.Suspended,Z=h||v||i===b.z.ProcessingLifecycleCommand||i===b.z.Deploying,C=!(void 0!==t&&t)&&f&&(w||h)&&(null==o?void 0:o.hasImageTag),S=!(void 0!==n&&n)&&!w&&!h&&(v||i===b.z.Deploying||i===b.z.Ready)&&(null==o?void 0:o.hasImageTag);return(0,d.tZ)(d.HY,{children:(0,d.BX)(p.G,{css:oV.container,children:[C||S?(0,d.BX)(p.G,{css:oV.pauseAndResumeButtons,children:[C?(0,d.BX)(d.HY,{children:[(0,d.tZ)(D.zx,{text:h?"Resuming":"Resume",onClick:function(){return r({command:I.Qc.Resume})},loading:h,disabled:Z,iconLeft:h?(0,d.tZ)(m.Z,{}):(0,d.tZ)(oF.Z,{})}),(0,d.tZ)($.xv,{color:"dimmer",children:"Your app will become accessible to users again"})]}):null,S?(0,d.BX)(d.HY,{children:[(0,d.tZ)(D.zx,{text:"Pause",onClick:function(){return r({command:I.Qc.Suspend})},loading:v,disabled:Z,iconLeft:v?(0,d.tZ)(m.Z,{}):(0,d.tZ)(oX.Z,{})}),(0,d.tZ)($.xv,{color:"dimmer",children:"Your deployment billing will continue, but all users will lose access to your app"})]}):null]}):null,(0,d.tZ)(oj,{setIsDestroying:c,onLifecycleCommand:r}),(0,d.tZ)(oq,{isDestroying:l,setIsDestroying:c,onLifecycleCommand:r})]})})};function oj(e){var t=e.setIsDestroying,n=e.onLifecycleCommand,r=(0,u._)((0,g.useState)(!1),2),i=r[0],o=r[1];return(0,d.BX)(d.HY,{children:[(0,d.BX)(p.G,{css:oV.sectionContainer,children:[(0,d.tZ)(D.zx,{text:"Change deployment type",onClick:function(){return o(!0)},iconLeft:(0,d.tZ)(oW.Z,{})}),(0,d.tZ)($.xv,{color:"dimmer",children:"To change your deployment type, you will need to shut down and create a new deployment."})]}),(0,d.tZ)(nj.u,{isOpen:i,onRequestClose:function(){return o(!1)},children:(0,d.tZ)(oM.Z,{confirmLabel:"Yes, delete my deployment",title:"Change Deployment Type",isDestructive:!0,onConfirm:function(){t(!0),o(!1),n({command:I.Qc.Destroy})},onCancel:function(){return o(!1)},children:"To change your deployment type, you will need to shut down and create a new deployment. This will destroy your deployment and any associated deployment tiers, saved replit.app domain and deployment history. You can always come back and redeploy your repl again."})})]})}function oq(e){var t=e.isDestroying,n=e.setIsDestroying,r=e.onLifecycleCommand,i=(0,u._)((0,g.useState)(!1),2),o=i[0],a=i[1];return(0,d.BX)(d.HY,{children:[(0,d.BX)(p.G,{css:oV.sectionContainer,children:[(0,d.tZ)(D.zx,{text:"Shut down",colorway:"negative",variant:"outlined",css:oV.sectionButton,onClick:function(){return a(!0)},disabled:t,iconLeft:(0,d.tZ)(oH.Z,{})}),(0,d.tZ)($.xv,{color:"dimmer",children:"Your deployment billing will be canceled, and your deployed app will cease to exist"})]}),(0,d.tZ)(nj.u,{isOpen:o,onRequestClose:function(){return a(!1)},children:(0,d.tZ)(oM.Z,{confirmLabel:"Yes, delete my deployment",title:"Delete Deployment",isDestructive:!0,onConfirm:function(){n(!0),a(!1),r({command:I.Qc.Destroy})},onCancel:function(){return a(!1)},children:"This will destroy your deployment and any associated deployment tiers, saved replit.app domain and deployment history. You can always come back and redeploy your repl again."})})]})}var oY=(0,S.X)({type:[v.l0.borderRadius(8),v.l0.p(8)],hostingTierFlow:v.l0.colWithGap(8),manageReserved:v.l0.colWithGap(16),manageReservedHeader:[v.l0.rowWithGap(8),v.l0.align.center]});function oJ(e){var t,n,r,i=e.replId,o=e.initialState,a=e.fs,l=e.dotReplit,c=e.ports,s=e.onBack,f=e.onDeploy,h=e.onError,m=e.onLifecycleCommand,v=e.openNetworkingPane,y=(0,u._)((0,g.useState)(o),2),b=y[0],w=y[1],Z=(t=(0,U._)({},iL,{variables:{replId:i},onError:function(e){return h(e.message)}}),en.a(iO,t)),x=Z.data,S=Z.loading,k=Z.refetch,_=(null==x?void 0:x.repl.__typename)==="Repl"?x.repl:null,E=_?(0,rb.Jw)({replSlug:_.slug,username:null===(n=_.owner)||void 0===n?void 0:n.username}):"",T=(null==_?void 0:_.powerUps.__typename)==="ReplPowerUpTypes"?_.powerUps.hostingTier:null,D=(0,nT.P5)({controlName:nw.dD,logFlagToAnalytics:!1}),G=(0,nT.P5)({controlName:nw.dA,logFlagToAnalytics:!1});if(S)return(0,d.tZ)(nc,{loading:!0});if(!_)return null;var P=(null==_?void 0:null===(r=_.owner)||void 0===r?void 0:r.__typename)==="Team";return b.type===I.r4.Static?(0,d.BX)(d.HY,{children:[(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(eB.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return s()},children:(0,d.tZ)(tH.Z,{})})}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(B.Tg,{css:oY.type,elevated:!0,children:(0,d.tZ)(nO,{label:"Type",fullWidth:!0,children:(0,d.tZ)(nU,{name:nE[b.type]})})})}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(rX,{initialSubdomain:E,deploymentId:null,provider:b.type,onError:h,onCancel:function(){return s()},onDeploy:f,fs:a,dotReplit:l,ports:c,openNetworkingPane:v})})]}):b.type===I.r4.Gce?T&&b.didCheckout?b.manage?(0,d.tZ)(H,{maxWidth:!0,children:(0,d.BX)(p.G,{css:oY.manageReserved,children:[(0,d.BX)(p.G,{css:oY.manageReservedHeader,children:[(0,d.tZ)(eB.hU,{alt:"Back",onClick:function(){return w({type:b.type,didCheckout:b.didCheckout,manage:!1})},children:(0,d.tZ)(tH.Z,{})}),(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:"To upgrade hosting tier, please deploy your repl first."})]}),(0,d.tZ)(oz,{hideResume:!0,hideSuspend:!0,onLifecycleCommand:m})]})}):(0,d.BX)(d.HY,{children:[(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(B.Tg,{css:oY.type,elevated:!0,children:(0,d.tZ)(nO,{label:"Type",fullWidth:!0,children:(0,d.tZ)(nU,{name:nE[b.type],sku:n_(T.sku),canManage:!0,onManageClick:function(){w({type:b.type,didCheckout:b.didCheckout,manage:!0})}})})})}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(rX,{initialSubdomain:E,deploymentId:null,provider:b.type,onError:h,onCancel:function(){return s()},onDeploy:f,fs:a,dotReplit:l,ports:c,openNetworkingPane:v})})]}):!T&&D?(0,d.BX)(d.HY,{children:[(0,d.tZ)(nx,{isTeamRepl:P,onBack:s,onError:h,onChange:function(e){w({type:I.r4.Gce,machine:e})}}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(rX,{initialSubdomain:E,deploymentId:null,provider:b.type,machine:b.machine,onError:h,onCancel:s,onDeploy:f,fs:a,dotReplit:l,ports:c,openNetworkingPane:v})}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.BX)($.xv,{color:"dimmest",children:["Your deployed app will incur charges for any resource usage."," ",(0,d.tZ)("a",{href:nb.TT.ABOUT_USAGE_BASED_BILLING,target:"_blank",rel:"noopener",children:"Learn more"})]})})]}):(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(oK,{onBack:s,onCheckout:function(){w({type:b.type,didCheckout:!0,manage:!1}),k()}})}):b.type===I.r4.Cron?G?(0,d.BX)(d.HY,{children:[(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(eB.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return s()},children:(0,d.tZ)(tH.Z,{})})}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(B.Tg,{css:oY.type,elevated:!0,children:(0,d.tZ)(nO,{label:"Type",fullWidth:!0,children:(0,d.tZ)(nU,{name:nE[b.type]})})})}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(rX,{initialSubdomain:E,deploymentId:null,provider:b.type,onError:h,onCancel:function(){return s()},onDeploy:f,fs:a,dotReplit:l,ports:c,openNetworkingPane:v})})]}):null:b.machine?(0,d.BX)(d.HY,{children:[(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(eB.hU,{alt:"Back",tooltipHidden:!0,onClick:function(){return w({type:I.r4.CloudRun,machine:null})},children:(0,d.tZ)(tH.Z,{})})}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(B.Tg,{css:oY.type,elevated:!0,children:(0,d.tZ)(nO,{label:"Type",fullWidth:!0,children:(0,d.tZ)(nU,{name:nE[b.type],sku:"".concat(b.machine.configurationLabel," / ").concat(b.machine.maxInstances," Max"),canManage:!0,onManageClick:function(){w({type:I.r4.CloudRun,machine:null})}})})})}),(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(rX,{initialSubdomain:E,deploymentId:null,provider:b.type,machine:b.machine,onError:h,onCancel:function(){return w({type:I.r4.CloudRun})},onDeploy:f,fs:a,dotReplit:l,ports:c,openNetworkingPane:v})})]}):(0,d.tZ)(H,{maxWidth:!0,children:(0,d.tZ)(ig,{onBack:s,onError:h,onConfirm:function(e){w({type:I.r4.CloudRun,machine:e})}})})}var oK=function(e){var t=e.onBack,n=e.onCheckout,r=(0,x.Z)(),i=(0,y.Sl)(r),o=i.hostingTier,a=i.refetch,l=(0,oO.P)({step:"power_up_details",powerUpCategory:"hosting_tier"}),c=l.currentStep.step;return(0,g.useEffect)(function(){"checkout_success"===c&&a()},[c,a]),(0,d.BX)(p.G,{css:oY.hostingTierFlow,children:[(0,d.tZ)(oU,{currentStep:l.currentStep,canGoBack:l.canGoBack||"power_up_details"===c,goTo:l.goTo,analyticsContext:"workspace_hosting_pane",goBack:function(){if("checkout_success"===l.currentStep.step){n();return}if("power_up_details"!==l.currentStep.step){l.goBack();return}t()}}),o?(0,d.tZ)(D.zx,{colorway:"primary",onClick:n,text:"Deploy your project"}):null]})},o$=v.nC.min(600),oQ={order:"--provider-order"},o0={order:"var(".concat(oQ.order,")")},o1=(0,j.iv)([v.l0.width("100%"),v.l0.maxWidth(340),(0,V._)({},o$,{order:o0.order})]),o2=(0,j.iv)([v.l0.reset.button,v.l0.overflow("hidden"),v.l0.position.relative,v.l0.focusRing,v.l0.borderRadius(),v.l0.width("100%")]),o8=(0,S.X)({self:[o1,{"&::after":{content:"none"}}],selfLoading:[o1,K.p.foregroundPulse(),v.l0.border({color:v.TV.backgroundHighest})],button:[o2,G.gU.filledAndOutlined,v.l0.border({color:v.TV.outlineDimmer})],buttonActive:[o2,v.l0.cursor.pointer,v.l0.backgroundColor.accentPrimaryDimmest,v.l0.border({color:v.TV.accentPrimaryStronger})],content:[v.l0.p(8),v.l0.colWithGap(4),(0,V._)({},o$,v.l0.py(12))],contentRecommended:[v.l0.p(8),v.l0.colWithGap(4),(0,V._)({},o$,{paddingTop:12,paddingBottom:20})],recommended:[v.l0.py(4),v.l0.backgroundColor.backgroundHighest],recommendedActive:[v.l0.py(4),v.l0.backgroundColor.accentPrimaryDimmer],icon:[v.l0.display.none,v.l0.color.foregroundDimmer,v.l0.center,(0,V._)({},o$,v.l0.display.flex)],iconActive:[v.l0.display.none,v.l0.color.accentPrimaryStrongest,v.l0.center,(0,V._)({},o$,v.l0.display.flex)],tiersTitle:[v.l0.rowWithGap(8),v.l0.align.center],title:[v.l0.rowWithGap(4),v.l0.center]});function o4(e){var t,n=e.loading,r=e.active,i=e.provider,o=e.onClick,a=e.title,l=e.description,c=e.recommended,s=e.index,u=(t={},(0,V._)(t,I.r4.CloudRun,(0,d.tZ)(iE.Z,{size:32})),(0,V._)(t,I.r4.Gce,(0,d.tZ)(is.Z,{size:32})),(0,V._)(t,I.r4.Static,(0,d.tZ)(iR.Z,{size:32})),(0,V._)(t,I.r4.Cron,(0,d.tZ)(tc.Z,{size:32})),t)[i];return(0,d.tZ)("span",{css:n?o8.selfLoading:o8.self,children:(0,d.BX)("button",{css:r?o8.buttonActive:o8.button,onClick:function(){return o(i)},disabled:n,style:(0,V._)({},oQ.order,s),children:[c?(0,d.tZ)(p.G,{css:r?o8.recommendedActive:o8.recommended,children:(0,d.tZ)($.xv,{variant:"small",children:"Recommended"})}):null,(0,d.BX)(p.G,{css:c?o8.contentRecommended:o8.content,children:[(0,d.tZ)(p.G,{css:r?o8.iconActive:o8.icon,children:u}),(0,d.BX)(p.G,{children:[(0,d.tZ)(p.G,{css:o8.title,children:(0,d.tZ)($.xv,{variant:"subheadDefault",multiline:!1,children:a})}),(0,d.tZ)($.xv,{multiline:!1,variant:"small",children:l})]})]})]})})}var o3=(0,S.X)({container:[v.l0.colWithGap(12),v.l0.maxWidth(400),{marginLeft:"auto",marginRight:"auto"}],item:[v.l0.align.center,{display:"grid",gridTemplateColumns:"56px auto",gap:20}],text:[v.l0.flex.growAndShrink(1),v.l0.textAlign.left]});function o5(e){var t=e.header,n=e.info;return(0,d.BX)(p.G,{css:o3.container,children:[(0,d.tZ)($.xv,{variant:"subheadDefault",children:t}),n.map(function(e,t){return(0,d.BX)(p.G,{css:o3.item,children:[e.icon,(0,d.tZ)($.xv,{css:o3.text,children:e.text})]},t)})]})}var o6=[I.r4.Gce,I.r4.CloudRun,I.r4.Static,I.r4.Cron],o9=(0,S.X)({container:[v.l0.colWithGap(32),v.l0.py(32),v.l0.textAlign.center,X.Qw.maxWidth],title:[v.l0.colWithGap(4),v.l0.width("100%"),v.l0.maxWidth(288),{marginLeft:"auto",marginRight:"auto"}],body:v.l0.colWithGap(16),providers:[v.l0.flex.column,v.l0.align.center,(0,V._)({gap:8},o$,[v.l0.flex.row,v.l0.align.center,{gap:12}])],providerDetails:v.l0.colWithGap(16),cta:[v.l0.width("100%"),v.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],ctaGroup:v.l0.colWithGap(8),secondaryCta:[v.l0.width("100%"),v.l0.maxWidth(320)],ctaContainer:[v.l0.colWithGap(8),v.l0.align.center],ctaStatusBanner:[v.l0.textAlign.left],oldCta:[v.l0.px(8),v.l0.colWithGap(16)],payment:[v.l0.p(16),v.l0.borderRadius("container"),v.l0.textAlign.left,v.l0.shadow(2)],budgetContainer:[v.l0.colWithGap(8),v.l0.border(),v.l0.borderRadius(),v.l0.p(8)],disabledBanner:[v.l0.py(6),{alignSelf:"center"}]}),o7=function(e){var t,n,r,i,o,a,l=e.replId,c=e.onError,s=e.onDeploy,f=e.onLifecycleCommand,h=e.onViewAction,m=e.initialSelectedProvider,b=(0,y.gg)().isDeployableRepl,x=(0,y.XZ)(),C=(0,y.v5)(),S=(0,y.t7)(),k=(0,u._)((0,g.useState)(void 0),2),_=k[0],E=k[1],T=(0,u._)((0,g.useState)(void 0),2),R=T[0],D=T[1],G=(0,u._)((0,g.useState)(!1),2),P=G[0],N=G[1],L=(0,u._)((0,g.useState)(!1),2),O=L[0],M=L[1],X=(0,u._)((0,g.useState)(null!=m?m:null),2),F=X[0],W=X[1],z=(0,y.BU)(),j=z.getDeployabilityByProvider,q=z.usageBasedBillingCapabilities,Y=z.refetch;(0,g.useEffect)(function(){e0({context:"intro"})},[]);var J=(t=(0,U._)({},iX,{variables:{id:l},onError:function(e){return c(e.message)}}),en.a(iF,t)),K=J.loading,Q=J.data,ee=(0,u._)((0,g.useState)(!1),2),et=ee[0],er=ee[1],ei=(null==Q?void 0:Q.repl.__typename)==="Repl"&&(null===(r=Q.repl.owner)||void 0===r?void 0:r.__typename)==="Team",eo=(null==Q?void 0:Q.repl.__typename)==="Repl"&&(null==Q?void 0:null===(i=Q.repl.owner)||void 0===i?void 0:i.id)&&(0,iD.xm)(null==Q?void 0:null===(o=Q.repl.owner)||void 0===o?void 0:o.id),ea=(0,nT.P5)({controlName:nw.dA,logFlagToAnalytics:!1});(0,g.useEffect)(function(){(0,w._)(function(){var e,t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:if(K)return[2];if(ei&&!eo)return E(I.r4.Gce),D(I.r4.Gce),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,(0,n5.$f)(C)];case 2:if(null===(e=n.sent()).appType)return E(I.r4.CloudRun),D(I.r4.CloudRun),[2];if((t=(0,ix.oU)(e.appType))===I.r4.Goval||t===I.r4.Extension)return c("Did not recognize template deployment provider"),[2];return E(t),D(t),[3,4];case 3:return n.sent(),c("Something went wrong"),[3,4];case 4:return[2]}})})()},[c,C,K,ei,eo]);var el=(0,g.useCallback)((0,w._)(function(){return(0,Z.Jh)(this,function(e){switch(e.label){case 0:return er(!0),[4,Y()];case 1:return e.sent(),er(!1),[2]}})}),[Y,er]);if(F)return(0,d.tZ)(oJ,{replId:l,initialState:F?{type:F}:{type:I.r4.Gce,didCheckout:!0},fs:x,dotReplit:C,ports:S,onDeploy:s,onBack:function(){return W(null)},onError:c,onLifecycleCommand:f,openNetworkingPane:function(){h({type:A.a.OpenPane,payload:{type:"networking"}})}});var ec=j(_),es=ec.isDeployable,eu=ec.explanation,ed=ec.isDeployableByProTeam,ef=K||et||void 0===_,eh=(a={title:"Deploy to production",subtitle:"Deploy a stable, public version of your project, unaffected by the changes you make in the workspace."},(0,V._)(a,I.r4.Gce,{display:!0,title:"Reserved VM",subtitle:"Servers that stay on",header:"Reserved VM is for apps that don't tolerate restarts",info:[{text:"Reserved VM apps have 99.9% uptime, preventing restarts that interrupt apps that rely on information between client sessions",icon:(0,d.tZ)(iC.lV,{})},{text:(n=(0,u._)((0,nw.gr)("e2-micro"),1)[0],"Reserved VMs are billed in compute hours starting at $".concat(n,"/hour.")),icon:(0,d.tZ)(iC.G8,{})},{text:"Perfect for Discord bots, Slack bots, stateful APIs, and long-running jobs",icon:(0,d.tZ)(iC.KU,{})}]}),(0,V._)(a,I.r4.CloudRun,{display:!0,title:"Autoscale",subtitle:"Meet demand exactly",header:"Autoscale is the best choice for most projects",info:[{text:"Automatically scales from zero to any level of demand, making it inexpensive for most apps and effortless for when you go viral",icon:(0,d.tZ)(iC.Qm,{})},{text:"Compute units are billed at $".concat(iB.m0," per compute unit"),icon:(0,d.tZ)(iC.fG,{})},{text:"Perfect for web apps, and stateless APIs",icon:(0,d.tZ)(iC.KU,{})}]}),(0,V._)(a,I.r4.Static,{display:!0,title:"Static",subtitle:"Easy client-side apps",header:"Static lets you share client-side apps fast",info:[{text:"No server compute means free usage  you are only responsible for outbound data transfer (included in Replit plans)",icon:(0,d.tZ)(iC.Lv,{})},{text:"Extremely fast deploy times allow you to move quickly on your production sites",icon:(0,d.tZ)(iC.lt,{})},{text:"Perfect for HTML sites and Static content",icon:(0,d.tZ)(iC.KU,{})}]}),(0,V._)(a,I.r4.Cron,{display:ea,title:"Scheduled",subtitle:"Easy scheduled runs",header:"Scheduled deployments let you run your app at specific times",info:[{text:"Schedule for your scripts to run at fixed time intervals",icon:(0,d.tZ)(iC.lt,{})},{text:"Usage-based pricing. Allotment included in Replit ".concat(iG.we," membership"),icon:(0,d.tZ)(iC.fG,{})},{text:"Good choice for internal tools and one-off jobs",icon:(0,d.tZ)(iC.KU,{})}]}),a);return(0,d.BX)(H,{children:[(0,d.tZ)(nj.u,{isOpen:O,onRequestClose:function(){return M(!1)},children:(0,d.tZ)(iZ.Z,{onRequestClose:function(){return M(!1)}})}),(0,d.BX)(p.G,{css:o9.container,children:[(0,d.BX)(p.G,{css:o9.title,children:[(0,d.tZ)($.xv,{variant:"subheadBig",children:eh.title}),(0,d.tZ)($.xv,{color:"dimmer",children:eh.subtitle}),(0,d.tZ)($.xv,{css:v.l0.textAlign.center,children:(0,d.tZ)("a",{href:"https://docs.replit.com/category/deployments",target:"_blank",rel:"noopener",children:"Learn more"})})]}),(0,d.BX)(p.G,{css:o9.body,children:[(0,d.tZ)(p.G,{css:o9.providers,children:o6.map(function(e,t){if(!eh[e].display)return null;var n=eh[e],r=n.title,i=n.subtitle;return(0,d.tZ)(o4,{provider:e,loading:ef,active:_===e,onClick:function(e){E(e),N(!1)},title:r,description:i,recommended:R===e,index:e===R&&0===t?1.5:e===R&&2===t?.5:t},e)})}),(0,d.BX)(p.G,{css:o9.ctaGroup,children:[(0,d.tZ)(ae,{loading:ef,isDeployable:es,isDeployableExplanation:eu,ubbExplanation:null==q?void 0:q.explanation,hasPaymentMethod:null==q?void 0:q.hasPaymentMethod,isDeployableRepl:b,isDeployableByProTeam:ed,handleOnProviderContinue:function(){_&&W(_)},refetchUbbCapabilitiesQueryData:el,setShowPaymentMethodForm:function(){return N(!0)},showPaymentMethodForm:P,setShowSupportForm:function(){return M(!0)}}),P?(0,d.tZ)(B.Tg,{elevated:!0,css:o9.payment,children:(0,d.tZ)(ik.q,{onSuccess:(0,w._)(function(){return(0,Z.Jh)(this,function(e){switch(e.label){case 0:return N(!1),[4,el()];case 1:return e.sent(),[2]}})}),context:"workspace_hosting_pane"})}):null]}),(0,d.tZ)(iP,{})]}),(0,d.tZ)(p.G,{css:o9.providerDetails,children:_?(0,d.tZ)(o5,{header:eh[_].header,info:eh[_].info}):null})]})]})};function ae(e){var t=e.isDeployable,n=e.isDeployableExplanation,r=e.isDeployableByProTeam,i=e.loading,o=e.ubbExplanation,a=e.hasPaymentMethod,l=e.isDeployableRepl,c=e.handleOnProviderContinue,s=e.refetchUbbCapabilitiesQueryData,u=e.setShowPaymentMethodForm,f=e.showPaymentMethodForm,h=e.setShowSupportForm,m=(0,nX.rv)();return t?r?(0,d.BX)(d.HY,{children:[(0,d.tZ)(D.zx,{colorway:"primary",onClick:c,text:"Included in your subscription",disabled:!l,loading:i,css:o9.cta}),(0,d.tZ)($.xv,{color:"dimmer",children:n})]}):o===I.Fp.NeedsSubscription||o===I.Fp.NeedsSubscriptionOrPaymentMethod?m?(0,d.tZ)(C.E,{text:"You need a subscription to deploy. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,d.tZ)(R.Z,{}),css:o9.ctaStatusBanner}):(0,d.BX)(p.G,{css:o9.ctaContainer,children:[(0,d.tZ)(iI.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to deploy",css:o9.cta,colorway:"primary",variant:"default",disabled:f,onPlanCheckoutComplete:s}),(0,d.tZ)(D.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:o9.cta,disabled:f,loading:i,iconLeft:(0,d.tZ)(iT.Z,{}),onClick:function(){return u()}})]}):o===I.Fp.NeedsSmsVerification?(0,d.tZ)(iw.Z,{context:I.jv.Deployments,onSuccess:s}):o===I.Fp.NeedsPaymentMethod?m?(0,d.tZ)(C.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,d.tZ)(R.Z,{}),css:o9.ctaStatusBanner}):(0,d.tZ)(D.zx,{colorway:"primary",text:"Add a payment method",css:o9.cta,disabled:f,loading:i,iconLeft:(0,d.tZ)(iT.Z,{}),onClick:function(){return u()}}):o===I.Fp.NeedsUnbanning?(0,d.tZ)(i_.u,{text:"Your account currently has restrictions on deploying. We're here to help! Please reach out to our support team for assistance.",colorway:"warning",icon:(0,d.tZ)(R.Z,{}),css:o9.ctaStatusBanner,onClick:function(){return h()}}):o===I.Fp.InsufficientBudget?(0,d.BX)(d.HY,{children:[(0,d.tZ)(C.E,{text:"You've reached your monthly usage budget. Increase your budget to continue deploying.",colorway:"warning",icon:(0,d.tZ)(R.Z,{}),css:o9.ctaStatusBanner}),(0,d.tZ)(p.G,{css:o9.budgetContainer,children:(0,d.tZ)(iS.L,{onUpdateSuccess:s})})]}):(0,d.BX)(d.HY,{children:[(0,d.tZ)(D.zx,{colorway:"primary",onClick:c,text:"Set up your deployment",disabled:!l,loading:i,css:o9.cta}),!1===a?(0,d.tZ)(i_.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,d.tZ)(R.Z,{}),css:o9.ctaStatusBanner,onClick:function(){return m?null:u()}}):null]}):(0,d.tZ)(d.HY,{children:(0,d.tZ)(C.E,{text:n,colorway:"grey",css:o9.disabledBanner})})}var at=n(47357);function an(){var e=(0,ee._)(["\n  fragment ReplLogLine2 on ReplLog {\n    __typename\n    timestamp\n    line\n  }\n"]);return an=function(){return e},e}function ar(){var e=(0,ee._)(["\n  query HostingDeploymentLogs2($replId: String!, $deploymentId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        __typename\n        hostingDeploymentLogs(deploymentId: $deploymentId) {\n          ... on ReplLogs {\n            result {\n              ...ReplLogLine2\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return ar=function(){return e},e}function ai(){var e=(0,ee._)(["\n  subscription HostingDeploymentLogUpdates(\n    $input: HostingDeploymentLogUpdatesInput!\n  ) {\n    hostingDeploymentLogUpdates(input: $input) {\n      ... on ReplLog {\n        line\n        timestamp\n      }\n    }\n  }\n"]);return ai=function(){return e},e}var ao={},aa=(0,et.Ps)(an()),al=(0,et.Ps)(ar(),aa),ac=(0,et.Ps)(ai()),as=(0,S.X)({root:[{overflow:"auto"},v.l0.coverContainer],rows:{width:"100%",position:"relative"},timestamp:[v.l0.p(6),{color:v.TV.foregroundDimmer,cursor:"pointer"}],logContainer:[v.l0.pl(6),v.l0.py(6),v.l0.pr(4),v.l0.flex.growAndShrink(1),v.l0.position.relative,v.l0.minHeight(26),{cursor:"pointer"}],logTruncated:[v.l0.flex.growAndShrink(1),v.l0.truncate],row:[v.l0.flex.row,v.l0.align.start,v.l0.font.code,v.l0.fontSize(12),{position:"absolute",top:0,left:0,width:"100%"}],noLogsContainer:[v.l0.colWithGap(8),v.l0.pt(4)],noLogsText:[v.l0.textAlign.center]}),au=function(e){var t=e.deploymentId,n=e.replId;return t?(0,d.tZ)(af,{replId:n,deploymentId:t}):(0,d.tZ)(H,{children:(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:"Deployment not found"})})};function ad(e){var t=e.log,n=e.y,r=e.height,i=e.resizeRef,o=e.index,a=(0,u._)((0,g.useState)(!1),2),l=a[0],c=a[1],s=(0,g.useRef)({x:0,y:0});function f(e){var t=s.current;e.clientY===t.y&&e.clientX===t.x&&c(function(e){return!e})}function h(e){s.current={x:e.clientX,y:e.clientY}}var m=o%2==0?"color-mix(in srgb, ".concat(v.TV.backgroundHigher,", transparent)"):void 0;return(0,d.BX)(p.G,{title:t.line,css:as.row,style:{height:r,backgroundColor:m,transform:"translateY(".concat(n,"px)")},children:[(0,d.BX)(p.G,{css:as.timestamp,onClick:f,onMouseDown:h,children:[new Date(t.timestamp).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})," ",new Date(t.timestamp).toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})]}),(0,d.tZ)(p.G,{css:as.logContainer,onClick:f,onMouseDown:h,innerRef:i,"data-index":o,children:(0,d.tZ)(p.G,{css:!l&&as.logTruncated,children:t.line})}),l?(0,d.tZ)(n0.qi,{value:t.line}):null]})}function af(e){var t,n,r,i=e.deploymentId,o=(t={variables:{replId:e.replId,deploymentId:i},fetchPolicy:"cache-and-network",ssr:!1},n=(0,U._)({},ao,t),en.a(al,n)),a=o.data,l=o.loading,c=o.error,s=o.subscribeToMore;(0,g.useEffect)(function(){return s({document:ac,variables:{input:{deploymentId:i}},updateQuery:function(e,t){var n=t.subscriptionData;return(0,ry.Uy)(e,function(e){var t=(null==e?void 0:e.repl.__typename)==="Repl"?e.repl.hostingDeploymentLogs.result:null;t&&t.unshift(n.data.hostingDeploymentLogUpdates)})}})},[s,i]);var u=(0,g.useRef)(null),f=(null==a?void 0:a.repl.__typename)==="Repl"?a.repl.hostingDeploymentLogs.result:null,h=(0,at.MG)({count:f?f.length:0,getScrollElement:function(){return u.current},estimateSize:function(){return 28},overscan:10});return((0,g.useEffect)(function(){e0({context:A.k.Logs})},[]),l)?(0,d.tZ)(nc,{loading:!0}):c?(0,d.tZ)(H,{children:(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:null!==(r=c.message)&&void 0!==r?r:"Something went wrong"})}):f&&(null==f?void 0:f.length)!==0?(0,d.tZ)(p.G,{innerRef:u,css:as.root,children:(0,d.tZ)(p.G,{style:{height:h.getTotalSize()},css:as.rows,children:h.getVirtualItems().map(function(e){var t=f[e.index];return t?(0,d.tZ)(ad,{log:t,height:e.size,y:e.start,resizeRef:h.measureElement,index:e.index},e.key):null})})}):(0,d.tZ)(H,{children:(0,d.tZ)(ah,{message:(null==f?void 0:f.length)===0?"No logs yet":"No logs are available because the most recent build failed before it was promoted."})})}var ah=function(e){var t=e.message;return(0,d.BX)(p.G,{css:as.noLogsContainer,children:[(0,d.tZ)($.xv,{css:as.noLogsText,children:t}),(0,d.BX)($.xv,{color:"dimmer",css:as.noLogsText,children:["Having trouble?"," ",(0,d.tZ)("a",{href:"https://docs.replit.com/hosting/deployments/troubleshooting",onClick:function(){return e0({context:"troubleshooting_doc"})},target:"_blank",children:"Troubleshooting tips"})]})]})},ap=(0,S.X)({sectionContainer:[v.l0.colWithGap(8)]});function am(e){var t=e.shouldShowDownloadQR,n=(0,u._)((0,g.useState)(t),2),r=n[0],i=n[1];return(0,d.tZ)(p.G,{children:(0,d.BX)(p.G,{css:ap.sectionContainer,children:[(0,d.tZ)(D.zx,{iconLeft:(0,d.tZ)(nY.Z,{}),text:"Install the Replit App",onClick:function(){return i(function(e){var t=!e;return t&&(0,eQ.j)(eQ.U3.DEPLOYMENT_MOBILE_DOWNLOAD_QR_VIEWED),t})}}),r?(0,d.tZ)(nz,{color:v.TV.foregroundDefault}):null]})})}var av=n(93302);function ag(){var e=(0,ee._)(["\n  query AutoscaleUsageSectionCurrentUser {\n    currentUser {\n      id\n      usageInterval {\n        ... on UsageInterval {\n          startDate\n          endDate\n          resources {\n            autoscaleComputeUnits {\n              usage\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return ag=function(){return e},e}var ay={},ab=(0,et.Ps)(ag()),aw=(0,S.X)({root:[v.l0.colWithGap(4),v.l0.p(8),v.l0.pt(12),v.l0.borderRadius(8),{outline:"1px solid transparent"}],outerRow:[v.l0.rowWithGap(12),v.l0.align.center],typeCol:[v.l0.colWithGap(4),v.l0.flex.growAndShrink(1)],configAndUsageRow:[v.l0.rowWithGap(12),v.l0.align.center,v.l0.flex.growAndShrink(1)],usageRow:[v.l0.rowWithGap(8)]}),aZ=function(e){var t,n=e.machineConfiguration,r=(t=(0,U._)({},ay,void 0),en.a(ab,t)).data,i=(0,g.useMemo)(function(){return function(e){var t,n,r=e.data;if((null==r?void 0:null===(t=r.currentUser)||void 0===t?void 0:t.__typename)==="CurrentUser"){var i=null==r?void 0:null===(n=r.currentUser)||void 0===n?void 0:n.usageInterval;if(i&&"UsageInterval"===i.__typename){var o=i.resources.autoscaleComputeUnits.usage,a=(0,av.fZ)(o,{resourceUsageType:"ComputeUnits"}),l=new Date(i.endDate).toLocaleString("default",{month:"short",day:"numeric"});return{description:"".concat(a," used this billing period"),renewalInfo:"Renews ".concat(l," ")}}}}({data:r})},[r]),o=(0,g.useMemo)(function(){if(null!=n)return"Autoscale (".concat(n.label,")")},[n]);return o&&i?(0,d.BX)(B.Tg,{elevated:!0,css:aw.root,children:[(0,d.BX)(p.G,{css:aw.outerRow,children:[(0,d.tZ)(p.G,{css:aw.typeCol,children:o?(0,d.tZ)($.xv,{multiline:!1,children:o}):null}),(0,d.tZ)(eB.hU,{alt:"Edit",onClick:e.onEditAutoscaleMachineConfiguration,children:(0,d.tZ)(i8.Z,{})})]}),i?(0,d.BX)(d.HY,{children:[(0,d.BX)(p.G,{css:aw.outerRow,children:[(0,d.tZ)($.xv,{multiline:!1,children:i.description}),(0,d.tZ)($.xv,{color:"dimmer",multiline:!1,children:i.renewalInfo})]}),(0,d.tZ)(p.G,{css:aw.outerRow,children:(0,d.tZ)(nI(),{legacyBehavior:!0,passHref:!0,href:"/usage",prefetch:!1,children:(0,d.tZ)("a",{role:"button",children:"View account resource limits"})})})]}):null]}):(0,d.tZ)(p.G,{css:[v.l0.justify.center,v.l0.flex.row],children:(0,d.tZ)(m.Z,{})})},ax=n(10041),aC=n(41859),aS=n(73722),ak=(0,n(91608).$)(["paddingRight"]),a_=ak.cssVars,aE=ak.styleTokens,aT=(0,S.X)({inputWrapper:[v.l0.position.relative,v.l0.flex.growAndShrink(1),{input:[{paddingRight:aE.paddingRight}]}],copyButton:[v.l0.position.absolute,v.l0.top("50%"),v.l0.right(4),{transform:"translateY(-50%)"}]});function aR(e){return(0,d.BX)(p.G,{css:aT.inputWrapper,style:(0,V._)({},a_.paddingRight,e.value?"36px":"8px"),children:[(0,d.tZ)(nn.II,(0,O._)((0,U._)({},e),{onClick:function(e){return e.currentTarget.select()}})),e.value?(0,d.tZ)(eB.hU,{css:aT.copyButton,alt:"Copy",tooltipHidden:!0,onClick:function(){return e.value&&(0,ax.Z)(e.value)},children:(0,d.tZ)(aC.Z,{})}):null]})}var aI=(0,S.X)({root:[v.l0.flex.column,(c={gap:8},(0,V._)(c,v.nC.min("mobileMax"),[v.l0.flex.row,{"& > div:nth-of-type(1)":{width:"30%"},"& > div:nth-of-type(2)":{maxWidth:50}}]),(0,V._)(c,"label",[v.l0.color.foregroundDimmer,{fontSize:v.TV.fontSizeSmall}]),c)],col:[v.l0.colWithGap(4),v.l0.flex.growAndShrink(1)],records:[v.l0.px(12),v.l0.pt(8),v.l0.pb(16),v.l0.colWithGap(16),v.l0.borderRadius(12),(0,V._)({},v.nC.min("mobileMax"),v.l0.colWithGap(12))],divider:(0,V._)({display:"flex",height:1,backgroundColor:v.TV.outlineDimmest},v.nC.min("mobileMax"),v.l0.display.none)});function aD(e){return(0,d.BX)(p.G,{css:aI.root,children:[(0,d.BX)(p.G,{css:aI.col,children:[(0,d.tZ)(p.G,{tag:"label",children:"Hostname"}),(0,d.tZ)(nn.II,{value:e.hostname,readOnly:!0})]}),(0,d.BX)(p.G,{css:aI.col,children:[(0,d.tZ)(p.G,{tag:"label",children:"Type"}),(0,d.tZ)(nn.II,{value:e.type,readOnly:!0})]}),(0,d.BX)(p.G,{css:aI.col,children:[(0,d.tZ)(p.G,{tag:"label",children:"Record"}),(0,d.tZ)(aR,{value:e.record,readOnly:!0})]})]})}function aG(e){var t="replit-verify=".concat(e.deploymentId);return(0,d.BX)(B.Tg,{background:"default",css:aI.records,children:[(0,d.tZ)(aD,{hostname:e.hostname,type:"A",record:e.apexProxy}),(0,d.tZ)(p.G,{css:aI.divider}),(0,d.tZ)(aD,{hostname:e.hostname,type:"TXT",record:t})]})}var aB=n(99165);function aP(){var e=(0,ee._)(["\n  mutation HostingDeploymentsUnlinkDomain(\n    $input: UnlinkHostingDeploymentDomainInput!\n  ) {\n    unlinkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        id\n        domains {\n          id\n        }\n      }\n    }\n  }\n"]);return aP=function(){return e},e}function aA(){var e=(0,ee._)(["\n  mutation HostingDeploymentsVerifyDomain(\n    $input: VerifyHostingDeploymentDomainInput!\n  ) {\n    verifyHostingDeploymentDomain(input: $input) {\n      ... on HostingDeploymentDomain {\n        id\n        state\n      }\n    }\n  }\n"]);return aA=function(){return e},e}var aN={},aL=(0,et.Ps)(aP()),aU=(0,et.Ps)(aA());function aO(){var e=(0,ee._)(["\n  fragment HostingDeploymentDomainsDomain on HostingDeploymentDomain {\n    id\n    state\n    domain\n  }\n"]);return aO=function(){return e},e}function aM(){var e=(0,ee._)(["\n  fragment HostingDeploymentDomainsHostingDeployment on HostingDeployment {\n    id\n    currentBuild {\n      id\n      status\n    }\n    repl {\n      id\n      apexProxy\n    }\n    domains {\n      id\n      ...HostingDeploymentDomainsDomain\n    }\n    legacyReplDomains {\n      id\n      ...HostingDeploymentDomainsDomain\n    }\n  }\n  ","\n"]);return aM=function(){return e},e}function aX(){var e=(0,ee._)(["\n  query HostingDeploymentDomains($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...HostingDeploymentDomainsHostingDeployment\n      }\n    }\n  }\n  ","\n"]);return aX=function(){return e},e}function aF(){var e=(0,ee._)(["\n  mutation LinkHostingDeploymentDomain(\n    $input: LinkHostingDeploymentDomainInput!\n  ) {\n    linkHostingDeploymentDomain(input: $input) {\n      ... on HostingDeployment {\n        id\n        domains {\n          ...HostingDeploymentDomainsDomain\n        }\n      }\n    }\n  }\n  ","\n"]);return aF=function(){return e},e}var aW={},aH=(0,et.Ps)(aO()),aV=(0,et.Ps)(aM(),aH),az=(0,et.Ps)(aX(),aV),aj=(0,et.Ps)(aF(),aH),aq="https://docs.replit.com/hosting/deployments/custom-domains",aY=(0,S.X)({root:[v.l0.colWithGap(8),v.l0.borderRadius(8),v.l0.pl(8),v.l0.pr(4),v.l0.height(32),v.l0.justify.center]}),aJ=(0,S.X)({root:aY.root,rootExpanded:[aY.root,v.l0.height("auto"),v.l0.pt(4),v.l0.pb(12),v.l0.justify.start],domainRow:[v.l0.reset.button,v.l0.rowWithGap(8),v.l0.align.center,v.l0.justify.spaceBetween],iconButtons:[v.l0.flex.row],expanded:[v.l0.colWithGap(12),v.l0.pl(4),v.l0.pr(8)],domainWrapper:[v.l0.rowWithGap(8),v.l0.align.center,v.l0.flex.shrink(1),v.l0.color.accentPrimaryStronger,{a:v.l0.hover(v.l0.color.accentPrimaryStrongest)}],statusDot:[v.l0.borderRadius("full"),v.l0.width(6),v.l0.height(6)],status:[v.l0.rowWithGap(4),v.l0.align.center],dnsRecords:[v.l0.colWithGap(6)],buttons:[v.l0.flex.column,v.l0.justify.spaceBetween,(s={gap:8},(0,V._)(s,v.nC.min("mobileMax"),v.l0.flex.row),(0,V._)(s,"button",[v.l0.flex.growAndShrink(1)]),s)],warning:[v.l0.rowWithGap(6),v.l0.align.center]}),aK={verified:{color:v.TV.accentPositiveDefault,text:"Verified"},verifying:{color:v.TV.orangeDefault,text:"Verifying"},failed:{color:v.TV.accentNegativeDefault,text:"Failed"}};function a$(e){var t,n,r,i=e.domain,o=e.deploymentId,a=e.apexProxy,l=(0,u._)((0,g.useState)(!1),2),c=l[0],s=l[1],f=(0,u._)((0,g.useState)(!1),2),h=f[0],y=f[1],b=(0,u._)((t=(0,U._)({},aW,{variables:{id:o},fetchPolicy:"network-only",ssr:!1}),i9.t(az,t)),2),w=b[0],Z=b[1].loading,x=(0,u._)((n=(0,U._)({},aN,void 0),aB.D(aL,n)),2),C=x[0],S=x[1].loading,k=(0,u._)((r=(0,U._)({},aN,void 0),aB.D(aU,r)),2),_=k[0],E=k[1].loading,T=i.state===I.zt.Failed,G=(0,u._)((0,g.useState)(!1),2),P=G[0],A=G[1];return(0,d.BX)(B.Tg,{elevated:!0,css:c?aJ.rootExpanded:aJ.root,children:[(0,d.BX)(p.G,{css:aJ.domainRow,style:{borderBottomLeftRadius:c?0:void 0,borderBottomRightRadius:c?0:void 0},children:[(0,d.BX)(p.G,{css:aJ.domainWrapper,children:[(0,d.tZ)($.xv,{multiline:!1,children:(0,d.tZ)("a",{target:"_blank",href:"https://"+i.domain,children:i.domain})}),(0,d.BX)(p.G,{css:aJ.status,children:[(0,d.tZ)(p.G,{css:aJ.statusDot,style:{backgroundColor:aK[i.state].color}}),(0,d.tZ)($.xv,{color:"dimmer",variant:"small",children:aK[i.state].text})]})]}),(0,d.BX)(p.G,{css:aJ.iconButtons,children:[(0,d.tZ)(eB.hU,{alt:P?"Copied":"Copy link",onClick:function(){(0,ax.Z)(i.domain),A(!0),setTimeout(function(){return A(!1)},1e3)},children:P?(0,d.tZ)(tl.Z,{color:v.TV.accentPositiveStronger}):(0,d.tZ)(aC.Z,{color:v.TV.foregroundDimmer})}),(0,d.tZ)(eB.hU,{alt:"Edit",tooltipHidden:!0,onClick:function(){y(!1),s(function(e){return!e})},css:v.l0.color.foregroundDimmer,children:c?(0,d.tZ)(tt.Z,{}):(0,d.tZ)(i8.Z,{})})]})]}),c?(0,d.tZ)(p.G,{css:aJ.expanded,children:h?(0,d.BX)(d.HY,{children:[(0,d.tZ)($.xv,{children:"Are you sure you want to unlink this domain?"}),(0,d.BX)(p.G,{css:aJ.buttons,children:[(0,d.tZ)(D.zx,{size:"small",variant:"outlined",text:"Cancel",onClick:function(){y(!1)}}),(0,d.tZ)(D.zx,{size:"small",disabled:S,text:"Yes, unlink "+i.domain,colorway:"negative",onClick:function(){C({variables:{input:{hostingDeploymentDomainId:i.id}}})}})]})]}):(0,d.BX)(d.HY,{children:[(0,d.BX)(p.G,{css:aJ.dnsRecords,children:[T?(0,d.BX)(d.HY,{children:[(0,d.BX)(p.G,{css:aJ.warning,children:[(0,d.tZ)(R.Z,{}),(0,d.tZ)($.xv,{children:"DNS Error"})]}),(0,d.BX)($.xv,{children:["Failed to link domain. Make sure your domain's DNS settings have these records."," ",(0,d.tZ)("a",{target:"_blank",href:aq,children:"Learn more"})]})]}):(0,d.BX)($.xv,{color:"dimmer",children:["Add these records to your domain's"," ",(0,d.tZ)("strong",{css:v.l0.color.foregroundDefault,children:"DNS settings"}),". This take up to 48 hours to fully apply."," ",(0,d.tZ)("a",{target:"_blank",href:aq,children:"Learn more"})]}),(0,d.tZ)(aG,{hostname:i.domain,apexProxy:a,deploymentId:o})]}),(0,d.BX)(p.G,{css:aJ.buttons,children:[(0,d.tZ)(D.zx,{iconLeft:Z||E?(0,d.tZ)(m.Z,{}):(0,d.tZ)(aS.Z,{}),size:"small",text:T?"Retry linking":"Check status",onClick:function(){T?_({variables:{input:{hostingDeploymentDomainId:i.id}}}):w()}}),(0,d.tZ)(D.zx,{iconLeft:(0,d.tZ)(oH.Z,{}),size:"small",disabled:S,text:T?"Remove domain":"Unlink domain",colorway:"negative",onClick:function(){y(!0)}})]})]})}):null]})}var aQ=n(8017);function a0(){var e=(0,ee._)(["\n  mutation HostingDeploymentsUnlinkLegacyReplDomain(\n    $input: UnlinkLegacyReplDomainInput!\n  ) {\n    unlinkLegacyReplDomain(input: $input) {\n      ... on Repl {\n        id\n        hostingDeployment {\n          ... on HostingDeployment {\n            id\n            legacyReplDomains {\n              id\n              ...HostingDeploymentDomainsDomain\n            }\n            domains {\n              id\n              ...HostingDeploymentDomainsDomain\n            }\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return a0=function(){return e},e}var a1={},a2=(0,et.Ps)(a0(),aH),a8=n(22699),a4=n(32508),a3=n.n(a4),a5=(0,S.X)({root:[v.l0.colWithGap(16),v.l0.p(8),v.l0.borderRadius(8),v.l0.border({color:v.TV.outlineDimmer})],labelRow:[v.l0.rowWithGap(8),v.l0.align.center],labelText:[v.l0.flex.growAndShrink(1)],controls:[v.l0.rowWithGap(8),v.l0.justify.spaceBetween,{"& > button":[v.l0.flex.growAndShrink(1)]}],domainSection:[v.l0.colWithGap(8)],error:[v.l0.rowWithGap(4),v.l0.align.center],recordsSection:[v.l0.colWithGap(8)],valueRow:[v.l0.borderRadius(8),v.l0.pl(8),v.l0.pr(4),v.l0.height(32),v.l0.rowWithGap(8),v.l0.align.center,v.l0.justify.spaceBetween,{a:v.l0.hover(v.l0.color.accentPrimaryStrongest)}]});function a6(e){var t,n=(0,u._)((0,g.useState)(!0),2),r=n[0],i=n[1],o=(0,u._)((0,g.useState)(""),2),a=o[0],l=o[1],c=(0,u._)((0,g.useState)(!1),2),s=c[0],f=c[1],h=(0,u._)((t=(0,U._)({},aW,{onCompleted:function(){e.onAdd()}}),aB.D(aj,t)),2),y=h[0],b=h[1].loading,w=(0,g.useRef)(null),Z=(0,g.useId)(),x=a3()(a,{require_valid_protocol:!1})&&a.split(".").length>=2,C=!x||b,S=x?null:"Enter a valid domain",k=b?(0,d.tZ)(m.Z,{}):(0,d.tZ)(ny.Z,{});return r||b||(k=(0,d.tZ)(aQ.Z,{})),(0,d.BX)(p.G,{tag:"form",css:a5.root,onSubmit:function(t){if(t.preventDefault(),r){var n;i(!1),null===(n=w.current)||void 0===n||n.focus();return}y({variables:{input:{hostingDeploymentId:e.deploymentId,domain:a}}})},children:[(0,d.BX)(p.G,{css:a5.domainSection,children:[(0,d.BX)(p.G,{tag:"label",htmlFor:Z,css:a5.labelRow,children:[x&&!r?(0,d.tZ)(tl.Z,{color:v.TV.accentPositiveDefault}):null,(0,d.tZ)($.xv,{color:"dimmer",children:"First, enter your domain"})]}),r?(0,d.tZ)(nn.II,{id:Z,autoFocus:!0,placeholder:"example.com",value:a,disabled:b,onChange:function(e){return l(e.currentTarget.value)},onBlur:function(e){return f(!!e.currentTarget.value)}}):(0,d.BX)(B.Tg,{elevated:!0,css:a5.valueRow,children:[(0,d.tZ)(p.G,{href:"https://"+a,tag:"a",target:"_blank",children:a}),(0,d.tZ)(eB.hU,{alt:"Edit",onClick:function(){return i(!0)},children:(0,d.tZ)(i8.Z,{color:v.TV.foregroundDimmer})})]}),S&&s?(0,d.BX)(p.G,{css:a5.error,children:[(0,d.tZ)(R.Z,{size:12,color:v.TV.orangeDefault}),(0,d.tZ)($.xv,{variant:"small",children:S})]}):null]}),!r&&x?(0,d.tZ)(a9,{apexProxy:e.apexProxy,domain:a,deploymentId:e.deploymentId}):null,(0,d.BX)(p.G,{css:a5.controls,children:[(0,d.tZ)(D.zx,{type:"button",text:"Cancel",onClick:e.onCancel}),(0,d.tZ)(D.zx,{ref:w,iconRight:k,colorway:"primary",type:"submit",disabled:C,text:r?"Next":"Link domain"})]})]})}function a9(e){return(0,d.BX)(p.G,{css:a5.recordsSection,children:[(0,d.BX)(p.G,{css:a5.labelRow,children:[(0,d.tZ)(a8.Z,{color:v.TV.foregroundDimmest}),(0,d.BX)($.xv,{multiline:!0,css:a5.labelText,children:["Next, add the following records your domain's DNS settings."," ",(0,d.tZ)("a",{target:"_blank",href:aq,children:"Learn more"})]})]}),(0,d.tZ)(aG,{apexProxy:e.apexProxy,hostname:e.domain,deploymentId:e.deploymentId})]})}var a7=(0,S.X)({root:[v.l0.py(12),v.l0.flex.column,(0,V._)({gap:6},v.nC.min("mobileMax"),[v.l0.py(4),v.l0.flex.row,v.l0.align.center,{gap:2,button:{border:"none"}}])],domainLink:[v.l0.flex.growAndShrink(1),v.l0.flex.row,v.l0.fontWeight.medium,{a:[v.l0.truncate,v.l0.flex.shrink(1)]}],confirm:[v.l0.p(8),v.l0.borderRadius(8),v.l0.colWithGap(8),v.l0.justify.spaceBetween],confirmButtons:[v.l0.rowWithGap(8),{button:[v.l0.flex.growAndShrink(1)]}],unlinkButton:[v.l0.color.foregroundDimmer,v.l0.hover(v.l0.backgroundColor.backgroundHighest)]}),le=function(e){var t=e.domain;return(0,d.tZ)("a",{target:"_bank",href:"https://"+t,children:t})};function lt(e){var t,n=e.deploymentId,r=e.domain,i=e.apexProxy,o=(0,u._)((t=(0,U._)({},a1,void 0),aB.D(a2,t)),2),a=o[0],l=o[1].loading,c=(0,u._)((0,g.useState)(!1),2),s=c[0],f=c[1],h=(0,u._)((0,g.useState)(!1),2),v=h[0],y=h[1];return s?(0,d.BX)(B.Tg,{elevated:!0,css:a7.confirm,children:[(0,d.BX)($.xv,{children:["Are you sure you want to remove ",(0,d.tZ)(le,{domain:r.domain}),"?"]}),(0,d.BX)(p.G,{css:a7.confirmButtons,children:[(0,d.tZ)(D.zx,{text:"Cancel",onClick:function(){return f(!1)},size:"small"}),(0,d.tZ)(D.zx,{size:"small",disabled:l,colorway:"negative",iconLeft:l?(0,d.tZ)(m.Z,{}):(0,d.tZ)(oH.Z,{}),text:"Unlink domain",onClick:function(){return a({variables:{input:{replDomainId:r.id}}})}})]})]}):v?(0,d.BX)(B.Tg,{elevated:!0,css:a7.confirm,children:[(0,d.BX)(p.G,{children:[(0,d.tZ)($.xv,{variant:"small",color:"dimmer",children:"Transfering"}),(0,d.tZ)(p.G,{css:a7.domainLink,children:(0,d.tZ)(le,{domain:r.domain})})]}),(0,d.tZ)(a9,{deploymentId:n,domain:r.domain,apexProxy:i}),(0,d.BX)(p.G,{css:a7.confirmButtons,children:[(0,d.tZ)(D.zx,{text:"Cancel",onClick:function(){return y(!1)},size:"small"}),(0,d.tZ)(D.zx,{size:"small",disabled:l,colorway:"primary",iconLeft:l?(0,d.tZ)(m.Z,{}):(0,d.tZ)(aQ.Z,{}),text:"Complete transfer",onClick:function(){return a({variables:{input:{replDomainId:r.id,transferToHostingDeploymentId:n}}})}})]})]}):(0,d.BX)(p.G,{css:a7.root,children:[(0,d.tZ)(p.G,{css:a7.domainLink,children:(0,d.tZ)(le,{domain:r.domain})}),(0,d.tZ)(D.zx,{size:"small",variant:"outlined",text:"Unlink",onClick:function(){return f(!0)},iconLeft:(0,d.tZ)(oH.Z,{}),css:a7.unlinkButton}),(0,d.tZ)(D.zx,{size:"small",variant:"outlined",disabled:l,iconRight:(0,d.tZ)(ny.Z,{}),colorway:"primary",text:"Transfer to deployment",onClick:function(){return y(!0)}})]})}var ln=(0,S.X)({root:[v.l0.colWithGap(4),v.l0.p(12),v.l0.pb(6),v.l0.borderRadius(12),v.l0.backgroundColor.backgroundHigher,v.l0.border({color:v.TV.outlineDimmer})],header:[v.l0.align.center,v.l0.rowWithGap(8)],list:[{"& > div:not(:first-of-type)":v.l0.border({color:v.TV.outlineDimmer,direction:"top"})}]});function lr(e){var t=e.domains,n=e.deploymentId,r=e.apexProxy,i=1===t.length?"domain":"domains";return(0,d.BX)(B.Tg,{css:ln.root,children:[(0,d.BX)(p.G,{css:v.l0.colWithGap(4),children:[(0,d.BX)(p.G,{css:ln.header,children:[(0,d.tZ)(R.Z,{color:v.TV.yellowStronger}),(0,d.BX)($.xv,{variant:"subheadDefault",children:["Transfer ",i]})]}),(0,d.BX)($.xv,{color:"dimmer",children:["You have attached ",t.length," custom ",i," to your development Repl. Please transfer ","domain"===i?"it":"them"," to your deployment for the best user experience."]})]}),(0,d.tZ)(p.G,{css:ln.list,children:t.map(function(e){return(0,d.tZ)(lt,{domain:e,deploymentId:n,apexProxy:r},e.id)})})]})}var li=(0,S.X)({root:[v.l0.colWithGap(8)],error:[v.l0.center,v.l0.rowWithGap(8)],loading:[v.l0.center],empty:[v.l0.px(16),v.l0.py(32),v.l0.borderRadius(8),v.l0.center,v.l0.colWithGap(8),{border:"1px dashed",borderColor:v.TV.outlineDimmer}],primaryDomain:[v.l0.rowWithGap(4),v.l0.height(32),v.l0.justify.spaceBetween,v.l0.align.center,v.l0.pl(8),v.l0.pr(4),v.l0.borderRadius(8)],primaryDomainLink:[v.l0.flex.shrink(1),v.l0.color.accentPrimaryStronger,{a:v.l0.hover(v.l0.color.accentPrimaryStrongest)}],icons:[v.l0.flex.row,v.l0.align.center],footer:[v.l0.flex.row]});function lo(e){var t,n,r,i,o=e.deployment,a=(0,u._)((0,g.useState)(!1),2),l=a[0],c=a[1],s=(0,u._)((0,g.useState)(void 0),2),f=s[0],h=s[1];t={variables:{id:o.id},fetchPolicy:"cache-and-network",ssr:!1,pollInterval:f,onCompleted:function(e){var t,n;h((null===(t=e.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"&&(null===(n=e.hostingDeployment.domains)||void 0===n?void 0:n.some(function(e){return e.state===tV.zt.Verifying}))?3e4:void 0)}},n=(0,U._)({},aW,t),en.a(az,n);var m=(null==o?void 0:null===(r=o.domains)||void 0===r?void 0:r.length)?o.domains:null,b=(null==o?void 0:o.currentBuild.status)===I.Fe.Success,w=null==o?void 0:o.repl.apexProxy,Z=(0,y.$y)(),x=function(){var e,t,n,r,i,o=(null==Z?void 0:null===(e=Z.repl.hostingDeployment)||void 0===e?void 0:e.__typename)==="HostingDeployment"?null===(t=Z.repl.hostingDeployment)||void 0===t?void 0:t.replitAppSubdomain:void 0;if(!o&&(null==Z?void 0:null===(n=Z.repl.owner)||void 0===n?void 0:n.username)&&(o="".concat(Z.repl.slug,"-").concat(Z.repl.owner.username)),o)return"https://".concat(o).concat((null===(i=window)||void 0===i?void 0:null===(r=i.location)||void 0===r?void 0:r.hostname)!=="replit.com"?".staging":"",".replit.app")}(),S=(0,u._)((0,g.useState)(!1),2),k=S[0],_=S[1];return(0,d.BX)(p.G,{css:li.root,children:[!l&&(null==o?void 0:null===(i=o.legacyReplDomains)||void 0===i?void 0:i.length)&&w?(0,d.tZ)(lr,{domains:o.legacyReplDomains,deploymentId:o.id,apexProxy:w}):null,(0,d.BX)(B.Tg,{elevated:!0,css:li.primaryDomain,children:[(0,d.tZ)($.xv,{multiline:!1,css:li.primaryDomainLink,children:(0,d.tZ)("a",{href:x,target:"_blank",rel:"noreferrer noopener",children:x})}),(0,d.BX)(p.G,{css:li.icons,children:[(0,d.tZ)(eB.hU,{alt:k?"Copied":"Copy link",onClick:function(){x&&((0,ax.Z)(x),_(!0),setTimeout(function(){return _(!1)},1e3))},children:k?(0,d.tZ)(tl.Z,{color:v.TV.accentPositiveStronger}):(0,d.tZ)(aC.Z,{color:v.TV.foregroundDimmer})}),(0,d.tZ)(nr.u,{tooltip:la,children:(0,d.tZ)(nG.Z,{"aria-label":la,color:v.TV.foregroundDimmer,css:v.l0.m(4)})})]})]}),m&&o?(0,d.tZ)(p.G,{css:v.l0.colWithGap(8),children:m.map(function(e){return(0,d.tZ)(p.G,{children:(0,d.tZ)(a$,{apexProxy:o.repl.apexProxy,deploymentId:o.id,domain:e})},e.domain)})}):null,l&&w?(0,d.tZ)(a6,{apexProxy:w,deploymentId:o.id,onAdd:function(){return c(!1)},onCancel:function(){return c(!1)}}):null,b?null:(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:"You must successfully deploy your project before linking a domain"}),!1===l?(0,d.tZ)(p.G,{css:li.footer,children:(0,d.tZ)(D.zx,{disabled:!b,iconLeft:(0,d.tZ)(nQ.Z,{}),text:"Link a domain",onClick:function(){return c(!0)},variant:"outlined",size:"small"})}):null]})}var la="Your primary domain cannot be changed";function ll(){var e=(0,ee._)(["\n  query HostingDeploymentSettings($id: String!) {\n    hostingDeployment(id: $id) {\n      ... on HostingDeployment {\n        id\n        ...HostingDeploymentDomainsHostingDeployment\n        currentBuild {\n          id\n          provider\n          machineConfiguration {\n            ...MachineConfiguration\n          }\n          envVars {\n            name\n            value\n          }\n        }\n      }\n    }\n  }\n  ","\n  ","\n"]);return ll=function(){return e},e}var lc={},ls=(0,et.Ps)(ll(),aV,nh.bN),lu=function(e){var t=e.deploymentId,n=e.onLifecycleCommand,r=e.onError;return t?(0,d.tZ)(ld,{deploymentId:t,onLifecycleCommand:n,onError:r}):(0,d.tZ)(H,{children:(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:"Deployment not found"})})};function ld(e){var t,n,r,i,o,a,l,c,s,f,h=(0,nX.rv)(),m=(0,u._)((0,g.useState)(!1),2),y=m[0],b=m[1];(0,g.useEffect)(function(){e0({context:A.k.Settings})},[]);var w=(a=(r={variables:{id:({deploymentId:e.deploymentId}).deploymentId},ssr:!1,fetchPolicy:"cache-and-network"},i=(0,U._)({},lc,r),o=en.a(ls,i)).data,l=o.loading,c=o.error,s=(null==a?void 0:null===(t=a.hostingDeployment)||void 0===t?void 0:t.__typename)==="HostingDeployment"?a.hostingDeployment:null,(null==a?void 0:null===(n=a.hostingDeployment)||void 0===n?void 0:n.__typename)==="NotFoundError"?{data:null,error:"Deployment not found",loading:!1}:!s&&l?{deployment:null,erorr:null,loading:!0}:c||!s?{deployment:null,error:"Something went wrong",loading:!1}:{deployment:s,error:null,loading:!1});if(y)return(0,d.tZ)(ig,{onError:e.onError,onConfirm:function(t){e.onLifecycleCommand({command:I.Qc.UpdateMachineConfiguration,machineConfigurationId:t.configurationId,maxMachineInstances:t.maxInstances})},onBack:function(){return b(!1)}});if(w.loading)return(0,d.tZ)(H,{children:(0,d.tZ)(nc,{loading:!0})});if(w.error)return(0,d.tZ)(nu,{text:w.error});var Z=w.deployment,x=Z.currentBuild,C=null!==(f=null==x?void 0:x.machineConfiguration)&&void 0!==f?f:void 0;return(0,d.tZ)(H,{children:(0,d.BX)(p.G,{css:[v.l0.colWithGap(32),X.Qw.maxWidth],children:[x.provider===I.r4.CloudRun?(0,d.BX)(p.G,{children:[(0,d.tZ)($.xv,{variant:"subheadDefault",css:[v.l0.pb(8)],children:"Resource usage"}),(0,d.tZ)(p.G,{css:[v.l0.colWithGap(16)],children:(0,d.tZ)(aZ,{machineConfiguration:C,onEditAutoscaleMachineConfiguration:function(){return b(!0)}})})]}):null,(0,d.BX)(p.G,{children:[(0,d.tZ)($.xv,{variant:"subheadDefault",css:[v.l0.pb(8)],children:"Domains"}),(0,d.tZ)(lo,{deployment:Z})]}),(0,d.BX)(p.G,{children:[(0,d.tZ)($.xv,{variant:"subheadDefault",css:[v.l0.pb(12)],children:"Manage deployment"}),(0,d.tZ)(oz,{onLifecycleCommand:e.onLifecycleCommand})]}),h?null:(0,d.BX)(p.G,{children:[(0,d.tZ)($.xv,{variant:"subheadDefault",css:[v.l0.pb(12)],children:"Deploy on the go"}),(0,d.tZ)(am,{shouldShowDownloadQR:!1})]})]})})}var lf=(0,S.X)({root:[{height:"100%"},v.l0.overflow("hidden"),v.l0.position.relative],content:[v.l0.overflow("auto"),v.l0.flex.growAndShrink(1),v.l0.position.relative,v.l0.pb(16)]}),lh=function(e){var t,n,r,i=e.onViewUpdate,o=e.onError,a=e.refetch,l=e.openFile,c=e.openPane,s=e.initialView,f=e.error,h=function(e){M({type:A.a.SendDeploymentLifecycleCommand,payload:e})},m=(0,x.Z)(),v=(0,y.hn)(),b=(0,y.pn)(),S=(0,y.$y)(),D=(0,y.XZ)(),G="string"==typeof v,B=!(void 0!==b)&&!G,P=(0,u._)((0,g.useState)(function(){return b?A.k.DeploymentInProgress:B?A.k.Intro:A.k.Deployment}),2),N=P[0],U=P[1],O=(0,y.mF)(),M=(t=(0,w._)(function(e){var t;return(0,Z.Jh)(this,function(n){switch(n.label){case 0:switch(i(),e.type){case A.a.SendDeploymentLifecycleCommand:return[3,1];case A.a.ChangeView:return[3,3];case A.a.OpenPane:return[3,4]}return[3,7];case 1:return[4,O(e.payload)];case 2:if(n.sent(),e.payload.command===I.Qc.Destroy)return U(A.k.Intro),a(),[2];return e.payload.command===I.Qc.UpdateMachineConfiguration&&a(),U(A.k.Deployment),[3,8];case 3:return U(e.payload.view),[3,8];case 4:if(!("codeEditor"===(t=e.payload).type&&".replit"===t.data.path))return[3,6];return[4,D.stat(".replit")];case 5:if(!n.sent().exists)return o("Could not find .replit configuration file."),[2];n.label=6;case 6:return c(t),[3,8];case 7:return[3,8];case 8:return[2]}})}),function(e){return t.apply(this,arguments)});if(N===A.k.Intro)return(0,d.tZ)(p.G,{css:lf.content,children:(0,d.tZ)(o7,{initialSelectedProvider:s===A.k.ReservedVMTierSelection?I.r4.Gce:void 0,onLifecycleCommand:h,onViewAction:M,onError:o,onDeploy:function(){M({type:A.a.ChangeView,payload:{view:A.k.DeploymentInProgress}})},replId:m})});var X=S?(n=S.provider,r=[{view:A.k.Deployment,label:"Overview",icon:(0,d.tZ)(_.Z,{})},{view:A.k.Analytics,label:"Analytics",icon:(0,d.tZ)(k.Z,{})},{view:A.k.Settings,label:"Settings",icon:(0,d.tZ)(T.Z,{})}],n!==I.r4.Static&&r.splice(1,0,{view:A.k.Logs,label:"Logs",icon:(0,d.tZ)(E.Z,{})}),r):null;return(0,d.BX)(p.G,{css:lf.root,children:[X?(0,d.tZ)(L,{onClick:function(e){M({type:A.a.ChangeView,payload:{view:e.view}})},tabs:X,activeView:N===A.k.DeploymentInProgress?A.k.Deployment:N}):null,(0,d.BX)(p.G,{css:lf.content,children:[f?(0,d.tZ)(H,{children:(0,d.tZ)(C.E,{colorway:"warning",icon:(0,d.tZ)(R.Z,{}),text:f})}):null,N===A.k.Analytics?(0,d.tZ)(e5,{replId:m}):null,N===A.k.Logs?(0,d.tZ)(au,{replId:m,deploymentId:v}):null,N===A.k.Settings?(0,d.tZ)(lu,{onError:o,deploymentId:v,onLifecycleCommand:h}):null,N===A.k.Deployment||N===A.k.DeploymentInProgress?(0,d.tZ)(ib,{view:N,refetch:a,onViewAction:M,onError:o,openFile:l,onLifecycleCommand:h}):null]})]})};function lp(e){var t=e.initialView,n=e.onViewUpdate,r=e.openFile,i=e.openPane,o=e.tabsNavRef,a=(0,y.m8)(),l=(0,y.kW)(),c=(0,y.ev)(),s=(0,u._)((0,g.useState)(null),2),f=s[0],h=s[1];return l===b.z.Loading?(0,d.tZ)(p.G,{css:[v.l0.center,v.l0.my(32)],children:(0,d.tZ)(m.Z,{size:16})}):(0,d.tZ)(lh,{tabsNavRef:o,initialView:t,onViewUpdate:function(){f&&h(null),n()},onError:h,refetch:a,openFile:r,openPane:i,error:f||c})}var lm=n(3947),lv=n(76568),lg=f.Dy.Object({type:f.Dy.Literal("deployments"),data:f.Dy.Optional(f.Dy.Object({view:f.Dy.Enum(A.k)}))}),ly={Content:function(e){var t=e.pane.data,n=e.options.performPaneOperation,r=(0,g.useRef)(function(e){if(e&&"object"==typeof e&&"view"in e&&e.view===A.k.ReservedVMTierSelection)return A.k.ReservedVMTierSelection}(t)),i=(0,g.useCallback)(function(e){return n({operation:"open",secondary:!0,pane:{type:(0,lm.Dp)(e),data:e}})},[n]),o=(0,u._)((0,g.useState)(null),2),a=o[0],l=o[1];return(0,lv.L5)(function(){if(a)return{type:"deployments",getTabs:a.getTabs,setTab:a.setTab}},[a]),(0,d.tZ)(lp,{tabsNavRef:l,initialView:r.current,onViewUpdate:function(){r.current&&(r.current=void 0,n({operation:"replace",pane:{type:"deployments"}}))},openFile:i,openPane:function(e){n({operation:"open",pane:e})}})},Icon:function(e){var t=e.size;return(0,d.tZ)(_.Z,{size:t})},getTitle:function(){return"Deployments"},decode:function(e){return h.B4.Decode(lg,e)}}},22111:function(e,t,n){n.d(t,{J:function(){return c}});var r=n(74044),i=n(99149),o=n(73524),a=r.Dy.Union(Object.values(o.TT).map(function(e){return r.Dy.Literal(e)})),l=r.Dy.Object({type:r.Dy.Literal("docs"),data:r.Dy.Optional(r.Dy.Object({url:r.Dy.Optional(r.Dy.Union([a,r.Dy.Null()]))}))}),c=function(e){return i.B4.Decode(l,e)}},15001:function(e,t,n){n.d(t,{J:function(){return a}});var r=n(74044),i=n(99149),o=r.Dy.Object({type:r.Dy.Literal("preferences")}),a=function(e){return i.B4.Decode(o,e)}},78564:function(e,t,n){n.d(t,{s:function(){return eW},G:function(){return ez}});var r,i=n(27387),o=n(66626),a=n(96583),l=n(74985),c=n(74044),s=n(99149),u=n(74833),d=n(56596),f=n(93918),h=n(47030),p=n(52682),m=n(29287),v=n(54916),g=n(74652),y=n(76568),b=n(50959),w=n(42516),Z=n(41733),x=n(30509),C=n(5621),S=n(6187),k=n(26508),_=n(91608),E=n(27592),T=n(2038),R=n(917),I=n(8279),D=n(37463),G=n(18107),B=n(41084),P=n(3947),A=n(58200),N=n(64461),L=n(32911),U=n(73157),O=n(1498),M=n(15146),X=n(23291),F=n(30983),W=n(32377),H=n(99741),V=n(9331),z=n(17216),j=n(1128),q=n(20573),Y=n(35375),J=n(56412),K=n(40028),$=n(8209);function Q(e){return e&&0!==e.length?e[0].toUpperCase()+e.substring(1).toLowerCase():""}var ee=(0,f.X)({outputBlockMetadataWrapper:[{containerType:"size"},m.l0.pl(4),m.l0.pr(8),m.l0.rowWithGap(4),m.l0.align.center,m.l0.justify.spaceBetween,m.l0.height(28),m.l0.backgroundColor.backgroundDefault,m.l0.border({direction:"bottom",width:1,style:"solid",color:m.TV.backgroundHigher}),m.l0.position.sticky,m.l0.top(0),m.l0.zIndex(1)],outputBlockMetadataWrapperLeft:[m.l0.rowWithGap(4),m.l0.align.center,m.l0.flex.shrink(1)],outputBlockMetadataWrapperRight:[m.l0.rowWithGap(4),m.l0.align.center],executionPill:[m.l0.flex.shrink(0),m.l0.display.flex,{"@container (max-width: 120px)":[m.l0.display.none]}],lastLineTextWrapper:[m.l0.flex.shrink(1)],lastLineText:[m.l0.display.block,m.l0.maxWidth("100%"),m.l0.overflow("hidden"),m.l0.font.code,m.l0.flex.shrink(1),{textOverflow:"ellipsis",whiteSpace:"nowrap"}],dateText:[m.l0.flex.row,{"@container (max-width: 260px)":[m.l0.display.none]}],verticalDivider:[m.l0.mx(6),{width:1,height:28,background:m.TV.backgroundHigher}],portInfoDomain:[m.l0.display.flex,m.l0.flex.row,m.l0.align.center,m.l0.m(0),{"@container (max-width: 400px)":m.l0.display.none}],portInfoPorts:[m.l0.display.flex,m.l0.flex.row,m.l0.align.center,m.l0.m(0),{"@container (max-width: 320px)":m.l0.display.none}],portTooltipHeader:[m.l0.color.foregroundDimmer,m.l0.fontWeight.normal,m.l0.px(2),m.l0.pb(2)],portTooltipColumnLeft:[m.l0.textAlign.right],portTooltipColumnMiddle:[m.l0.textAlign.center,m.l0.px(4)]}),et=(r={},(0,w._)(r,G.kH.DEBUGGER,"debugger"),(0,w._)(r,G.kH.PACKAGER,"packager"),(0,w._)(r,G.kH.UNIT_TEST,"tests"),(0,w._)(r,G.kH.EXECUTION,"run"),(0,w._)(r,G.kH.PORT_INFO,"port"),(0,w._)(r,G.kH.FORMATTER,"formatter"),r);function en(e){var t=e.openedPorts;return(0,l.tZ)(d.G,{children:(0,l.BX)("table",{children:[(0,l.BX)("tr",{children:[(0,l.tZ)("th",{css:ee.portTooltipHeader,children:"Internal"}),(0,l.tZ)("th",{}),(0,l.tZ)("th",{css:ee.portTooltipHeader,children:"External"})]}),(0,l.tZ)("tbody",{children:t.map(function(e){var t=e.configuration,n=!0,r=null;switch(t.type){case Y.DL.FORWARDED:n=!0,r=":".concat(t.externalPort);break;case Y.DL.INTERNAL_ONLY:n=!1,r=null;break;case Y.DL.NO_MORE_EXTERNAL_PORTS_AVAILABLE:case Y.DL.MISCONFIGURED:case Y.DL.CONFIG_MISSING:n=!0,r=(0,l.tZ)(q.Z,{})}return(0,l.BX)("tr",{children:[(0,l.BX)("td",{css:ee.portTooltipColumnLeft,children:[":",t.localPort]}),(0,l.tZ)("td",{css:ee.portTooltipColumnMiddle,children:n?"":null}),(0,l.tZ)("td",{children:r})]},t.localPort)})})]})})}function er(e){var t=e.isDone,n=e.error,r=e.finishedTooltipText,i=e.executionPillText,o=e.runningTooltipText,a=e.circleColor,c=void 0===a?m.TV.accentPositiveDefault:a,s=e.duration,f=e.time,h=e.openPane,p=e.isCollapsed,v=e.setIsCollapsed,g=e.lastMeaningfullLine,y=e.openedPorts,b=e.renderPortsIntegration,w=(0,J.Z)(new Date(f),"HH:mm:ss, MM/dd"),Z=void 0!==y&&y.length>0,x="";return Z&&(x=1===y.length?":".concat(y[0].configuration.localPort):"".concat(y.length," ").concat((0,U.Z)("port",y.length))),(0,l.BX)(d.G,{css:ee.outputBlockMetadataWrapper,onDoubleClick:function(){return v(!p)},children:[(0,l.BX)(d.G,{css:ee.outputBlockMetadataWrapperLeft,onDoubleClick:function(e){return e.stopPropagation()},children:[(0,l.tZ)(M.hU,{alt:p?"Expand":"Collapse",onClick:function(){return v(!p)},children:p?(0,l.tZ)(V.Z,{}):(0,l.tZ)(H.Z,{})}),(0,l.tZ)(X.D,{color:"grey",text:Q(i),css:ee.executionPill}),(0,l.tZ)(d.G,{css:ee.lastLineTextWrapper,children:p?(0,l.tZ)(u.xv,{css:ee.lastLineText,variant:"small",children:g}):null})]}),(0,l.BX)(d.G,{css:ee.outputBlockMetadataWrapperRight,onDoubleClick:function(e){return e.stopPropagation()},children:[b&&Z?(0,l.BX)(l.HY,{children:[(0,l.BX)(d.G,{css:ee.portInfoDomain,children:[(0,l.tZ)(u.xv,{color:"dimmer",css:m.l0.mr(0),children:(0,l.tZ)(F.u,{tooltip:"Open Webview",children:(0,l.tZ)(O.zx,{size:"small",variant:"underlinedOnHover",text:Z?"{...}.replit.dev":"",onClick:function(){h({type:"webview",data:Z?{portType:"local",port:y[0].configuration.localPort}:void 0},!0)}})})}),(0,l.tZ)(d.G,{css:ee.verticalDivider})]}),(0,l.BX)(d.G,{css:ee.portInfoPorts,children:[(0,l.tZ)(u.xv,{color:"dimmer",css:m.l0.mr(0),children:(0,l.tZ)(F.u,{tooltip:(0,l.tZ)(en,{openedPorts:y}),children:(0,l.tZ)(O.zx,{size:"small",variant:"underlinedOnHover",iconLeft:(0,l.tZ)(z.Z,{color:m.TV.accentPositiveStronger}),text:x,onClick:function(){h({type:"networking"},!0)}})})}),(0,l.tZ)(d.G,{css:ee.verticalDivider})]})]}):null,(0,l.BX)(u.xv,{color:"dimmer",variant:"small",css:ee.dateText,children:[s?(0,l.tZ)(F.u,{tooltip:"".concat(Math.round(s).toLocaleString(),"ms"),children:s<1e3?"".concat(Math.floor(s),"ms"):s<6e4?"".concat(Math.floor(s/1e3),"s"):"".concat(Math.floor(s/6e4),"m")}):null,s?"".concat("\xa0","on").concat("\xa0"):null,w]}),t?(0,l.tZ)(F.u,{tooltip:r,children:void 0!==n?(0,l.tZ)(q.Z,{}):(0,l.tZ)(W.Z,{})}):(0,l.tZ)(F.u,{tooltip:void 0===o?"Running...":o,children:(0,l.tZ)(j.Z,{color:c})})]})]})}function ei(e){var t,n,r=e.isCollapsed,i=e.setIsCollapsed,o=e.openPane,a=e.startTime,c=e.endTime,s=e.localStartTime,u=e.localEndTime,d=e.isDone,f=e.data,h=e.error,p=e.ports,m=e.renderPortsIntegration,v=ea(!d),g=el(f.onMessage),y=(0,D.r4)(p,f.cgroup);a&&c?t=c-a:!d&&s?t=v-s:d&&u&&(t=u-s);var b="Finished";return void 0!==h&&(b=void 0!==h?Q(h):"Finished with error"),(0,l.tZ)(er,{isDone:d,error:h,finishedTooltipText:b,executionPillText:null!==(n=f.executionMode)&&void 0!==n?n:"unknown",duration:t,time:null!=a?a:s,lastMeaningfullLine:g,openPane:o,isCollapsed:r,setIsCollapsed:i,openedPorts:y,renderPortsIntegration:m})}function eo(e){var t,n=e.isCollapsed,r=e.setIsCollapsed,i=e.openPane,o=e.localStartTime,a=e.localEndTime,c=e.isDone,s=e.type,d=e.error,f=e.data,h=ea(!c),p=el(f.onMessage),v=et[s],g=d?(0,l.BX)(u.xv,{multiline:!0,children:[Q(et[s])," error",(0,l.tZ)("br",{}),d]}):"Finished",y=m.TV.accentPositiveDefault,b="Running...";if(s===G.kH.DEBUGGER){var w=f.debugState;y="paused"===w?m.TV.yellowDefault:m.TV.accentPositiveDefault,b="paused"===w?"Paused":"Running..."}return a?t=a-o:!c&&o&&(t=h-o),(0,l.tZ)(er,{isCollapsed:n,setIsCollapsed:r,openPane:i,isDone:c,finishedTooltipText:g,executionPillText:v,duration:t,time:o,circleColor:y,runningTooltipText:b,lastMeaningfullLine:p,error:d})}function ea(e){var t=(0,o._)((0,b.useState)(function(){return Date.now()}),2),n=t[0],r=t[1];return(0,b.useEffect)(function(){if(e){var t=setInterval(function(){r(Date.now())},100);return function(){clearInterval(t)}}},[e]),n}function el(e){var t=(0,o._)((0,b.useState)(""),2),n=t[0],r=t[1];return(0,b.useEffect)(function(){return e(function(e){var t,n=null===(t=(0,$.Z)(e).split("\n").reverse().find(function(e){return e.trim().length>0}))||void 0===t?void 0:t.trim();n&&r(n)})}),n}function ec(e){var t=e.isCollapsed,n=e.setIsCollapsed,r=e.openPane,i=e.isDone,o=e.type,a=e.data,c=e.error,s=e.localStartTime,u=e.localEndTime,d=e.startTime,f=e.endTime,h=e.ports,p=e.renderPortsIntegration;switch(o){case G.kH.EXECUTION:return(0,l.tZ)(ei,{isCollapsed:t,setIsCollapsed:n,openPane:r,isDone:i,type:o,startTime:d,endTime:f,localStartTime:s,localEndTime:u,data:a,error:c,ports:h,renderPortsIntegration:p});case G.kH.DEBUGGER:case G.kH.PACKAGER:case G.kH.UNIT_TEST:case G.kH.FORMATTER:return(0,l.tZ)(eo,{isCollapsed:t,setIsCollapsed:n,openPane:r,isDone:i,type:o,localStartTime:s,localEndTime:u,data:a,error:c,ports:h,renderPortsIntegration:p});default:(0,K.Z)(o)}}var es=n(98924),eu=n(7444),ed=n(80502);function ef(e){for(var t=1,n=e.buffer.active._buffer.lines._array,r=e.buffer.active.length;r-- >0;){var i=n[r];if(i){for(var o=!1,a=0;a<e.cols;a++)if(0!==i.hasContent(a)){o=!0;break}if(o){t=r+1;break}}}return t}var eh=(0,_.$)(["topOffset"]),ep=eh.cssVars,em=eh.styleTokens,ev=(0,f.X)({wrapper:{display:"grid"},terminal:{gridRow:1,gridColumn:1,position:"sticky",top:em.topOffset,"& .xterm":[m.l0.py(8),m.l0.pl(8),m.l0.height("100%"),m.l0.overflow("hidden")],"& .xterm-viewport":[m.l0.overflow("hidden")]}});function eg(e){var t=e.autoFocus,n=e.wrapperResizeRef,r=e.xterm,i=e.bufferHeight,o=e.onInput,a=e.onMessage,c=e.onResizeTerminal,s=e.children,u=(0,es._)(e,["autoFocus","wrapperResizeRef","xterm","bufferHeight","onInput","onMessage","onResizeTerminal","children"]);return(0,b.useLayoutEffect)(function(){t&&r&&r.focus()},[r,t]),(0,b.useEffect)(function(){if(r){var e=r.onData(function(e){o(e)}),t=r.onResize(function(){c(r.getSize())});return function(){e.dispose(),t.dispose()}}},[r,o,c]),(0,b.useEffect)(function(){if(r)return a(function(e){return r.write(e)})},[a,r]),(0,l.tZ)(d.G,{innerRef:n,children:(0,l.tZ)(d.G,(0,x._)((0,Z._)({},u),{css:ev.wrapper,style:(0,Z._)({height:i},u.style),children:s}))})}function ey(e){var t=e.xtermRef,n=e.visibleHeight,r=e.maxHeight,i=(0,es._)(e,["xtermRef","visibleHeight","maxHeight"]);return(0,l.tZ)(d.G,(0,x._)((0,Z._)({innerRef:t,css:ev.terminal},i),{style:(0,x._)((0,Z._)({},i.style),{height:n,maxHeight:r})}))}var eb=n(31384),ew=n(19562),eZ=n(14675),ex=n(95571),eC=n(25425),eS=n(26851),ek={noScroll:!0},e_=(0,f.X)({terminal:{gridRow:1,gridColumn:1,position:"sticky",top:em.topOffset,"& .xterm":[m.l0.py(8),m.l0.pl(8),m.l0.height("100%"),m.l0.overflow("hidden")],"& .xterm-viewport":[m.l0.overflow("hidden")],"& .xterm-scroll-area":{height:"0px !important"}},searchWidget:{gridRow:1,gridColumn:1,position:"sticky",top:em.topOffset,height:30,margin:"2px 0 0 auto",zIndex:4}});function eE(e){var t,n,r,i,a,c,s,u,f,h,p,m,v,g,y,w,Z,x,C,S,_,E,T,R,I,D,G,B,P,A,N=e.onMessage,L=e.onInput,U=e.openFile,O=e.openAIWithMessage,M=e.openSearchAndReplace,X=e.openWebview,F=e.listFiles,W=e.autoFocus,H=e.maxHeight,V=e.onResizeTerminal,z=e.scrollPosition,j=e.scrollParent,q=(n=(t={maxHeight:H,openFile:U,listFiles:F,openWebview:X}).maxHeight,r=t.openFile,i=t.listFiles,a=t.openWebview,s=(c=(0,o._)((0,ed.Z)({autoFit:!1,size:{rows:10},openFile:r,listFiles:i,openWebview:a}),2))[0],u=c[1],f=(0,b.useMemo)(function(){return null==s?void 0:s._term},[s]),h=(0,b.useMemo)(function(){var e,t=null==f?void 0:f._core;return null!==(e=null==t?void 0:t._renderService.dimensions.css.cell)&&void 0!==e?e:{width:0,height:0}},[f]),p=(0,b.useMemo)(function(){return Math.floor((n-16)/h.height)},[n,h.height]),v=(m=(0,o._)((0,b.useState)("normal"),2))[0],g=m[1],w=(y=(0,o._)((0,b.useState)(1),2))[0],Z=y[1],C=(x=(0,o._)((0,b.useState)(1),2))[0],S=x[1],E=(_=(0,o._)((0,b.useState)(!1),2))[0],T=_[1],R=(0,eu.Z)(w),I=(0,eu.Z)(C),D=(0,eu.Z)(E),G=(0,eu.Z)(v),(0,b.useEffect)(function(){return function(){R.current=1,I.current=1,D.current=!1,G.current="normal"}},[R,I,D,G]),(0,b.useEffect)(function(){if(f){var e=f.buffer.onBufferChange(function(e){g(e.type),"alternate"===e.type&&(Z(p),S(p),T(!1))});return function(){e.dispose()}}},[f,p]),B=(0,k.Z)(function(e){var t=e.widthChanged;s&&t&&s.fit()},{type:"debounce",wait:200}),(0,b.useLayoutEffect)(function(){s&&s.fit()},[s]),(0,b.useEffect)(function(){var e=function(){if(f&&"alternate"!==G.current){var e=f.buffer.active.cursorY,t=f.buffer.active.viewportY,n=ef(f);n!==I.current&&S(n),e>R.current&&Z(e),t>0&&!1===D.current&&T(!0)}};if(f){var t=[f.onLineFeed(e),f.onCursorMove(e)];return function(){t.forEach(function(e){return e.dispose()})}}},[f,R,D,G,I,p]),(0,b.useEffect)(function(){if(f&&s){if(s.getSize().rows!==p&&f.resize(f.cols,p),"alternate"===G.current)Z(p);else{var e=ef(f);e!==I.current&&S(e),p<e?Z(p):e<p&&Z(e)}}},[f,s,p,Z,G,I]),P=(0,b.useMemo)(function(){return(Math.min(w,C)+1)*h.height+16},[w,C,h]),A=(0,b.useMemo)(function(){return E?(C+1)*h.height+16:P},[h,E,P,C]),{visibleHeight:P,visibleLines:w,bufferHeight:A,bufferMode:v,bufferLines:C,hasScrollback:E,wrapperResizeRef:B,xterm:s,xtermRef:u}),Y=q.visibleHeight,J=q.visibleLines,K=q.bufferHeight,$=q.bufferLines,Q=q.wrapperResizeRef,ee=q.xterm,et=q.xtermRef,en=q.hasScrollback,er=(0,b.useMemo)(function(){return null==ee?void 0:ee._term},[ee]),ei=(0,b.useMemo)(function(){var e,t=null==er?void 0:er._core;return null!==(e=null==t?void 0:t._renderService.dimensions.css.cell)&&void 0!==e?e:{width:0,height:0}},[er]),eo=(0,o._)((0,b.useState)(!1),2),ea=eo[0],el=eo[1],ec=(0,o._)((0,b.useState)(""),2),es=ec[0],eh=ec[1],ep=(0,o._)((0,b.useState)(!1),2),em=ep[0],ev=ep[1],eE=(0,b.useRef)(null),eT=(0,eC.P5)({controlName:"flag-output-userevents",logFlagToAnalytics:!1}),eR=(0,eS.K)();(0,b.useEffect)(function(){return function(){null!==eE.current&&clearTimeout(eE.current)}},[eE]),(0,b.useEffect)(function(){if(er){if(z<1||!en){er.scrollToLine(0);return}var e=K-Y,t=$-J;if(e<1){er.scrollToLine(0);return}er.scrollToLine(Math.round(z/e*t))}},[K,$,en,z,er,Y,J]);var eI=(0,b.useCallback)(function(){if(er){var e=er.getSelectionPosition();e&&j(e.start.y*ei.height-H/2)}},[er,H,j,ei.height]);(0,b.useEffect)(function(){if(eT)return N(function(e){return eR("repl:run:output",{output:e})})},[N,eT,eR]);var eD=(0,eb.av)().onContextMenu,eG=(0,ew.j)({xterm:ee,isOutputsTerminal:!0,openAIWithMessage:O,openShellSearch:function(e){el(!0),eh(e)},openSearchAndReplace:M});return(0,l.BX)(eg,{onInput:L,xterm:ee,wrapperResizeRef:Q,bufferHeight:K,onMessage:N,onResizeTerminal:V,autoFocus:W,style:{pointerEvents:em?"none":"all"},onWheel:function(){ev(!0),eE.current&&clearTimeout(eE.current),eE.current=setTimeout(function(){ev(!1)},200)},onKeyDown:function(e){"f"===e.key&&(0,ex.jh)(e)&&(el(!0),e.preventDefault())},children:[ea?(0,l.tZ)(d.G,{css:e_.searchWidget,children:(0,l.tZ)(eZ.R,{searchValue:es,setSearchValue:eh,findPrevious:function(e){(null==ee?void 0:ee.findPrevious(e,ek))&&eI()},findNext:function(e){(null==ee?void 0:ee.findNext(e,ek))&&eI()},exit:function(){return el(!1)}})}):null,(0,l.tZ)(ey,{xtermRef:et,visibleHeight:Y,maxHeight:H,css:e_.terminal,onContextMenu:function(e){return eD(e,{command:eG})}})]})}var eT=n(27187),eR=(0,f.X)({emptyStateWrapper:[m.l0.p(8),m.l0.display.block,{lineHeight:"32px"}],simpleRunButtonWrapper:[m.l0.rowWithGap(6),m.l0.backgroundColor.accentPositiveDimmest,m.l0.color.accentPositiveStrongest,m.l0.align.center,m.l0.borderRadius(8),m.l0.py(2),m.l0.px(6),m.l0.mx(4),m.l0.cursor.pointer,{"&:hover":[m.l0.color.white,m.l0.backgroundColor.accentPositiveDefault]}]});function eI(e){var t=e.runner;return(0,l.tZ)(d.G,{tag:"span",style:{display:"inline-block"},children:(0,l.BX)(d.G,{tag:"button",onClick:function(){return t.run()},css:eR.simpleRunButtonWrapper,children:[(0,l.tZ)(eT.Z,{size:12}),(0,l.tZ)(u.xv,{children:"Run"})]})})}function eD(e){var t=e.runner,n=(0,o._)((0,b.useState)(function(){return t.getRunState()}),2),r=n[0],i=n[1];return((0,b.useEffect)(function(){var e=t.onStateChanged(function(e){i(e)});return function(){return e()}},[t]),r===G.Ah.OFFLINE)?(0,l.tZ)(d.G,{css:eR.emptyStateWrapper,children:"The Repl is booting..."}):r===G.Ah.RUNNING||r===G.Ah.BEFORE_RUN?(0,l.tZ)(d.G,{css:eR.emptyStateWrapper,children:"Running..."}):(0,l.BX)(d.G,{css:eR.emptyStateWrapper,children:["Results of your code will appear here when you"," ",(0,l.tZ)(eI,{runner:t})," the project."]})}var eG=(0,_.$)(["blockMinHeight","terminalBackgroundColor","previewHeight"]),eB=eG.cssVars,eP=eG.styleTokens,eA=(0,f.X)({outputsListParent:[m.l0.height("100%"),m.l0.overflow("hidden"),m.l0.borderRadius(0,0,8,8)],outputsListWrapper:[m.l0.height("100%")],outputsList:[m.l0.height("100%"),m.l0.overflowY("scroll")],outputsListSnapToBottom:{scrollSnapType:"y mandatory"},scrollSnap:[m.l0.height(1),{marginTop:-1,pointerEvents:"none",scrollSnapAlign:"end"}],outputBlockCollapsingWrapper:[m.l0.minHeight(eP.blockMinHeight)],outputBlockTerminalWrapper:[m.l0.minHeight(eP.blockMinHeight),{backgroundColor:eP.terminalBackgroundColor}],outputBlockClosingBorder:[m.l0.height(1),m.l0.zIndex(1),m.l0.border({direction:"bottom",width:1,style:"solid",color:m.TV.backgroundHigher}),{marginTop:-1}],terminalLoadingWrapper:[m.l0.p(8),m.l0.height(eP.previewHeight)],terminalLoadingLine:[m.l0.borderRadius(2),I.p.foregroundPulse(),m.l0.height(16),m.l0.mb(4)]});function eN(e){var t=e.targetHeight,n=Math.min(Math.floor((t-8)/20),4),r=(0,b.useMemo)(function(){return Array.from({length:n}).map(function(e,t){return(0,l.tZ)(d.G,{css:[eA.terminalLoadingLine],style:{width:100*Math.random()+"%"}},t)})},[n]);return(0,l.tZ)(d.G,{css:eA.terminalLoadingWrapper,style:(0,w._)({},eB.previewHeight,t+"px"),children:(0,l.tZ)(d.G,{style:{position:"sticky",top:36},children:r})})}function eL(e){var t,n,r,i,a,c,s,u,f,h,p,m,v,g,y,C,_,T,R,I=e.onInput,B=e.openFile,P=e.openPane,N=e.openAIWithMessage,U=e.openSearchAndReplace,O=e.listFiles,M=e.autoFocus,X=e.rootRef,F=e.maxHeight,W=e.onResizeTerminal,H=e.isDone,V=e.data,z=e.error,j=e.localStartTime,q=e.localEndTime,Y=e.startTime,J=e.endTime,K=e.type,$=e.visualState,Q=e.onSetVisualState,ee=e.ports,et=e.renderPortsIntegration,en=e.onDontExposePort,er=e.onDoExposePort,ei=(0,b.useRef)(null),eo=(0,o._)((0,b.useState)(!0),2),ea=eo[0],el=eo[1],es=(0,o._)((0,b.useState)(!1),2),eu=es[0],ed=es[1],ef=(0,o._)((0,b.useState)(0),2),eh=ef[0],em=ef[1],ev=(0,A.f)(),eg=(0,S.Z)(ea,eu?6e4:500),ey=(0,D.r4)(ee,K===G.kH.EXECUTION?V.cgroup:void 0),eb=(0,o._)((0,b.useState)(0),2),ew=eb[0],eZ=eb[1],ex=(0,b.useCallback)(function(e,t){P({type:"webview",data:{portType:"local",path:e,port:t}},!0)},[P]),eC=(n=(t={maxHeight:F,visualState:$,onSetVisualState:Q}).visualState,r=t.onSetVisualState,i=t.maxHeight,c=(a=(0,o._)((0,b.useState)(0),2))[0],s=a[1],u=(0,b.useRef)(null),h=(f=(0,o._)((0,b.useState)(n===G.MZ.EXPANDED?"expanded":"collapsed"),2))[0],p=f[1],v=(m=(0,o._)((0,b.useState)(void 0),2))[0],g=m[1],y=(0,k.Z)(function(e){var t=e.height;"expanded"===h&&s(t)},{type:"debounce",wait:200}),(0,b.useEffect)(function(){if(u.current)switch(h){case"start-collapsing":p("is-collapsing");break;case"is-collapsing":g(0);break;case"start-expanding":p("is-expanding");break;case"is-expanding":g(c);break;case"expanded":g(void 0)}},[h,c]),C="expanded"!==h&&"is-expanding"!==h,_=(0,b.useCallback)(function(e){r(e?G.MZ.COLLAPSED:G.MZ.EXPANDED)},[r]),T=(0,b.useRef)(n),(0,b.useEffect)(function(){T.current===G.MZ.EXPANDED&&n===G.MZ.COLLAPSED&&u.current&&(p("start-collapsing"),g(Math.min(u.current.getBoundingClientRect().height,i)),p("start-collapsing")),T.current===G.MZ.COLLAPSED&&n===G.MZ.EXPANDED&&p("start-expanding"),T.current=n},[i,n]),{collapsedStep:h,isCollapsed:C,setIsCollapsed:_,blockWrapperRef:u,blockWrapperProps:{style:{height:v,transition:"height 120ms ease-out",overflow:"expanded"===h||"start-collapsing"===h?"visible":"hidden"},onTransitionEnd:function(){"is-collapsing"===h&&p("collapsed"),"is-expanding"===h&&p("expanded")}},blockResizeRef:y,measuredBlockHeight:c}),eS=eC.collapsedStep,ek=eC.isCollapsed,e_=eC.setIsCollapsed,eT=eC.blockWrapperRef,eR=eC.blockWrapperProps,eI=eC.blockResizeRef,eD=eC.measuredBlockHeight;(0,b.useEffect)(function(){if(X.current){var e,t=X.current,n=function(){var n,r;em(Math.max(0,t.scrollTop-(null!==(r=null===(n=ei.current)||void 0===n?void 0:n.offsetTop)&&void 0!==r?r:0))),ed(!0),e&&clearTimeout(e),e=setTimeout(function(){ed(!1)},500)};return t.addEventListener("scroll",n),function(){clearInterval(e),t.removeEventListener("scroll",n)}}},[X,ei]),(0,b.useEffect)(function(){if(ei.current&&X.current)return(0,E.j)(ei.current,function(){return el(!0),function(){el(!1)}},{root:X.current,threshold:0})},[X,ei]);var eG=(0,k.Z)(function(e){var t=e.height;"expanded"===eS&&eZ(t)},{type:"debounce",wait:200}),eP=!1;return"collapsed"===eS?eP=!1:(!H||eg)&&(eP=!0),(0,l.BX)(d.G,{innerRef:ei,children:[(0,l.tZ)(ec,{isCollapsed:ek,setIsCollapsed:e_,openPane:P,isDone:H,data:V,localStartTime:j,localEndTime:q,startTime:Y,endTime:J,type:K,error:z,ports:ee,renderPortsIntegration:et}),et?(0,l.tZ)(d.G,{innerRef:eG,style:{position:"sticky",top:28},children:(0,l.tZ)(L.ms,{configurations:ey.map(function(e){return e.configuration}),openWebview:function(){ex("/",ey[0].configuration.localPort)},openNetworkingTool:function(){P({type:"networking"},!0)},onDontExposePort:function(){1===ey.length&&en(ey[0].configuration.localPort)},onDoExposePort:function(){1===ey.length&&er(ey[0].configuration.localPort)}})}):null,(0,l.tZ)("div",(0,x._)((0,Z._)({ref:eT},eR),{children:(0,l.tZ)(d.G,{css:eA.outputBlockTerminalWrapper,style:(R={},(0,w._)(R,eB.blockMinHeight,eD+"px"),(0,w._)(R,eB.terminalBackgroundColor,null==ev?void 0:ev.background),(0,w._)(R,ep.topOffset,28+ew+"px"),R),children:eP?(0,l.tZ)(d.G,{innerRef:eI,children:(0,l.tZ)(eE,{onMessage:V.onMessage,onInput:I,openFile:B,openAIWithMessage:N,openSearchAndReplace:U,openWebview:ex,listFiles:O,maxHeight:F-28-ew,onResizeTerminal:W,scrollPosition:eh,scrollParent:function(e){var t,n,r,i=e+(null!==(r=null===(t=ei.current)||void 0===t?void 0:t.offsetTop)&&void 0!==r?r:0);null===(n=X.current)||void 0===n||n.scrollTo({top:i})},autoFocus:M})}):(0,l.tZ)(eN,{targetHeight:eD})})})),(0,l.tZ)(d.G,{css:eA.outputBlockClosingBorder})]})}function eU(e){var t=e.performPaneOperation,n=e.isActive,r=e.runner,i=e.ports,a=e.listFiles,c=e.renderEmptyStateMessage,s=e.renderSearchAndReplaceContextMenu,u=void 0===s||s,f=e.renderAIOptionsInContextMenu,h=void 0===f||f,p=e.renderPortsIntegration,m=void 0===p||p,v=e.sendGhostwriterChatMessage,g=e.onDontExposePort,y=e.onDoExposePort,w=(0,o._)((0,b.useState)([]),2),Z=w[0],x=w[1],S=(0,o._)((0,b.useState)(0),2),_=S[0],E=S[1],I=(0,o._)((0,b.useState)(!0),2),D=I[0],A=I[1],L=(0,b.useRef)(null),U=(0,B.Z)(R.y.Output),O=(0,o._)((0,b.useState)(!1),2),M=O[0],X=O[1],F=(0,b.useRef)(0),W=(0,T.T3)(),H=(0,k.Z)(function(e){E(e.height)},{type:"throttle",wait:200}),V=(0,b.useCallback)(function(e){t({operation:"open",secondary:!0,pane:{type:(0,P.Dp)(e),data:e}})},[t]),z=(0,b.useCallback)(function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t({operation:"open",secondary:n,pane:e})},[t]),j=(0,b.useCallback)(function(e){t({operation:"open",secondary:!0,pane:{type:"searchReplace",data:{initialQuery:e}}})},[t]),q=(0,b.useCallback)(function(e){v({chatMessage:e}),t({operation:"open",secondary:!0,pane:{type:"ghostwriterChat"}})},[t,v]);return(0,b.useEffect)(function(){return r.onStateChanged(function(e){X(e===G.Ah.BEFORE_RUN)})},[r]),(0,b.useEffect)(function(){x(r.getOutputBlocks())},[r]),(0,b.useEffect)(function(){var e=r.onAllBlocksChanged(function(e){x(e)}),t=r.onBlockChanged(function(e){!Z.find(function(t){return t.id===e.id})&&L.current&&(L.current.scrollTo(0,L.current.scrollHeight),A(!0)),x((0,N.Uy)(function(t){var n=t.findIndex(function(t){return t.id===e.id});n>=0?t[n]=e:t.push(e)}))});return function(){t(),e()}},[r,Z,L]),(0,l.BX)(d.G,{css:eA.outputsListParent,innerRef:U,children:[M?(0,l.tZ)(C.Z,{}):null,(0,l.BX)(d.G,{css:eA.outputsListWrapper,innerRef:H,children:[0===Z.length&&(void 0===c||c)?(0,l.tZ)(eD,{runner:r}):null,(0,l.BX)(d.G,{css:[eA.outputsList,D&&eA.outputsListSnapToBottom],innerRef:L,onScroll:function(){L.current&&(L.current.scrollTop<F.current?A(!1):A(L.current.scrollHeight-L.current.scrollTop-20<_),F.current=L.current.scrollTop)},children:[Z.map(function(e,t){var o=t===Z.length-1;return(0,l.tZ)(eL,{rootRef:L,maxHeight:_,onInput:r.sendInput,openFile:V,openAIWithMessage:h?q:void 0,openSearchAndReplace:u?j:void 0,openPane:z,listFiles:a,onResizeTerminal:function(t){e.isDone||e.type!==G.kH.EXECUTION||r.resizeTerminalForBlock(e.id,t)},autoFocus:n&&o&&!W,isDone:e.isDone,type:e.type,error:e.error,visualState:e.visualState,onSetVisualState:function(t){return r.setBlockVisualState(e.id,t)},localStartTime:e.localStartTime,localEndTime:e.localEndTime,startTime:e.startTime,endTime:e.endTime,data:e.data,ports:i,renderPortsIntegration:m,onDontExposePort:g,onDoExposePort:y},e.id)}),D?(0,l.tZ)(d.G,{css:eA.scrollSnap}):null]})]})]})}var eO=n(62507),eM=n(90719),eX=n(27173),eF=c.Dy.Object({type:c.Dy.Literal("runnerOutput")}),eW={id:"outputs.clear",name:"Clear console history",default:void 0};function eH(e){var t,n,r,c,s,u,d=e.runner,f=e.options,h=(n=(t=(0,v.Z)()).fs,r=t.ports,c=(0,b.useMemo)(function(){return[{type:"action",label:"Clear history",icon:(0,l.tZ)(p.Z,{}),run:function(){return d.clearBlockHistory()}}]},[d]),(0,y.L5)(function(){return{actions:c,type:"runnerOutput",startBlock:d.startBlock,endBlock:d.endBlock,writeOutputToBlock:d.writeOutputToBlock,writeErrorToBlock:d.writeErrorToBlock}},[d,c]),(0,g.Il)(function(){return[eW.id,d.clearBlockHistory]},[d]),s=(0,b.useCallback)(function(e){r.updateDotReplitPortsMapping(e,void 0)},[r]),{onDoExposePort:(0,b.useCallback)(function(e){r.tryExposingPortAutomatically(e)},[r]),onDontExposePort:s,ports:r,fs:n}),m=h.ports,w=h.fs,Z=h.onDontExposePort,x=h.onDoExposePort,C=(0,eO.bD)({onSession:function(e){f.performPaneOperation({operation:"open",secondary:!0,pane:{type:"ghostwriterChat",data:{sessionId:e}}})}}).sendMessage,S=(0,o._)((0,eM.Ni)(),1)[0],k=(0,b.useCallback)((u=(0,i._)(function(e){var t;return(0,a.Jh)(this,function(n){return(t=e.chatMessage).text&&C({kind:"message",message:t.text,intent:eX.$h.EXPLAIN,model:"advanced"===S?eX.BY.ADVANCED:eX.BY.BASIC}),[2]})}),function(e){return u.apply(this,arguments)}),[S,C]);return(0,l.tZ)(eU,{runner:d,ports:m,listFiles:w.listFiles,isActive:f.isActive,performPaneOperation:f.performPaneOperation,sendGhostwriterChatMessage:k,onDontExposePort:Z,onDoExposePort:x})}var eV=(0,f.X)({unavailable:[m.l0.p(8)]}),ez={Content:function(e){var t=e.options,n=(0,v.Z)().runner;return"outputs"!==n.mode?(0,l.tZ)(d.G,{css:eV.unavailable,children:(0,l.tZ)(u.xv,{children:"Console is not available."})}):(0,l.tZ)(eH,{options:t,runner:n})},Icon:function(e){var t=e.size;return(0,l.tZ)(h.Z,{size:t})},getTitle:function(){return"Console"},decode:function(e){return s.B4.Decode(eF,e)}}},19403:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(74985),i=n(56596),o=n(20573),a=n(63461),l={Content:function(){return(0,r.tZ)(i.G,{style:{padding:32},children:(0,r.tZ)(a.Z,{children:"Sorry, this feature is not supported."})})},Icon:function(){return(0,r.tZ)(o.Z,{})},getTitle:function(){return"Unsupported"},decode:function(){return{type:"commands",data:{autoFocus:!1}}}}},62393:function(e,t,n){n.d(t,{Jx:function(){return m},Rm:function(){return g},Sp:function(){return v}});var r=n(66626),i=n(74985),o=n(74044),a=n(99149),l=n(96239),c=n(37463),s=n(54916),u=n(85515),d=n(86793),f=n(45495),h=n(50959),p=o.Dy.Object({type:o.Dy.Literal("webview"),data:o.Dy.Optional(o.Dy.Union([o.Dy.Object({portType:o.Dy.Literal("local"),port:o.Dy.Number(),path:o.Dy.Optional(o.Dy.String())}),o.Dy.Object({portType:o.Dy.Literal("external"),port:o.Dy.Number(),path:o.Dy.Optional(o.Dy.String())})]))}),m=function(e){return a.B4.Decode(p,e)};function v(e,t){var n=void 0;if((null==e?void 0:e.portType)==="external")n=null==e?void 0:e.port;else if((null==e?void 0:e.portType)==="local"){var r=t.find(function(t){return t.configuration.localPort===e.port});n=null==r?void 0:r.configuration.externalPort}return n}var g={Content:function(e){var t=e.pane.data,n=e.options.performPaneOperation,o=(0,s.Z)(),a=o.container,l=o.runner,p=(0,r._)((0,h.useState)(function(){return function(){}}),2),m=p[0],g=p[1],y=(0,c.bg)();return(0,d.Z)({container:a,runner:l,refreshWebView:m}),(0,f.Z)({runner:l,refreshWebView:m}),(0,i.tZ)(u.e,{initialPort:v(t,y),initialPath:null==t?void 0:t.path,openPane:function(e){n({operation:"open",pane:e})},openNetworkingTool:function(){n({operation:"open",secondary:!0,pane:{type:"networking"}})},setRefreshCb:g})},Icon:function(e){var t=e.size;return(0,i.tZ)(l.Z,{size:t})},getTitle:function(){return"Webview"},decode:m}},10768:function(e,t,n){n.d(t,{U:function(){return wG}});var r,i,o,a,l,c,s,u=n(66626),d=n(63257),f=n(74985),h=n(74044),p=n(99149),m=n(15146),v=n(57468),g=n(74833),y=n(56596),b=n(93918),w=n(42463),Z=n(88936),x=n(29287),C=n(54916),S=n(12506),k=n(76568),_=n(50959),E=n(19659),T=(0,b.X)({text:{width:"100%",textAlign:"center"},loaderContainer:[x.l0.display.flex,x.l0.center,x.l0.height("100%")]}),R=h.Dy.Object({type:h.Dy.Literal("binary"),data:h.Dy.Object({path:h.Dy.String()})}),I={Content:function(e){var t=e.pane,n=e.options;return(0,f.tZ)(D,{path:t.data.path,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.pane,n=e.size;return(0,f.tZ)(v.Z,{path:t.data.path,size:n})},getTitle:function(e){return(0,E.UO)(e.data.path)},decode:function(e){return p.B4.Decode(R,e)}};function D(e){var t=e.path,n=e.performPaneOperation,r=(0,C.Z)().fs,i=(0,S.Mp)({path:t,performPaneOperation:n});(0,k.L5)(function(){if(i)return{commands:i?(0,d._)(i):[]}},[i]);var o=(0,u._)((0,_.useState)(null),2),a=o[0],l=o[1],c=(0,u._)((0,_.useState)(!0),2),s=c[0],h=c[1];return((0,_.useEffect)(function(){var e=r.watchFile(t,{onChange:function(e){l(e.toString("base64")),h(!1)},onError:function(){l(null),h(!1)},onMoveOrDelete:function(){l(null),h(!1)}});return function(){e(),h(!0),l(null)}},[r,t]),s)?(0,f.tZ)(y.G,{css:T.loaderContainer,children:(0,f.tZ)(Z.Z,{})}):null===a?(0,f.tZ)(g.xv,{multiline:!1,children:"Failed to load binary file"}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(S.HK,{path:t,performPaneOperation:n}),(0,f.BX)(S.VY,{centered:!0,children:[(0,f.tZ)(g.xv,{css:T.text,children:"The file is not displayed in the text editor because it is either binary or uses an unsupported text encoding."}),(0,f.tZ)(m.hU,{alt:"Download",css:[x.l0.position.absolute,x.l0.bottom(8),x.l0.right(8),x.l0.p(16)],children:(0,f.tZ)("a",{href:"data:text/plain;base64,".concat(a),download:(0,E.UO)(t),css:[x.l0.color.foregroundDimmer],children:(0,f.tZ)(w.Z,{})})})]})]})}var G=n(91190),B=n(10454),P=n(3947),A=n(58091),N=n(73524),L=n(50199),U=n(41733),O=n(30509),M=n(78950),X=n(18836),F=n(10041),W=n(1498),H=n(38080),V=n(12874),z=n(41859),j=n(88883),q=(0,b.X)({button:{width:"fit-content"}});function Y(e){var t=e.code,n=e.activeFile,r=(0,j.Z)(n),i=r?{text:"Insert",iconRight:(0,f.tZ)(V.Z,{}),onClick:function(){return r({code:t,insertAt:"end"})}}:{text:"Copy",iconLeft:(0,f.tZ)(z.Z,{}),onClick:function(){return(0,F.Z)(t)}};return(0,f.tZ)(H.Tg,{background:"default",children:(0,f.tZ)(W.zx,(0,U._)({size:"small",variant:"outlined",css:q.button},i))})}var J=(0,b.X)({self:x.l0.colWithGap(4),content:[x.l0.rowWithGap(4),x.l0.backgroundColor.backgroundRoot,x.l0.borderRadius(4),x.l0.p(4),x.l0.align.center,{width:"fit-content"}]});function K(e){var t=e.method,n=e.content,r=e.activeFile,i=(0,u._)((0,_.useState)(n),2),o=i[0],a=i[1];return(0,f.BX)(y.G,{css:J.self,children:[(0,f.tZ)(er,{title:t}),(0,f.tZ)(y.G,{css:J.content,children:o.map(function(e,n){var r="".concat(t,"-").concat(n);return"input"===e.type?(0,f.tZ)(Q,{i:n,value:e.value,placeholder:e.placeholder,setContent:a},r):(0,f.tZ)(et,{value:e.value},r)})}),(0,f.tZ)(Y,{code:o.reduce(function(e,t){return e+(t.value||("input"===t.type?t.placeholder:""))},""),activeFile:r})]})}var $=(0,b.X)({self:[x.l0.width(64),x.l0.height(24),x.l0.zIndex(1)]});function Q(e){var t=e.i,n=e.value,r=e.placeholder,i=e.setContent;return(0,f.tZ)(X.II,{onChange:function(e){i(function(n){return n.map(function(n,r){return t===r?(0,O._)((0,U._)({},n),{value:e.target.value}):n})})},placeholder:r,value:n||"",css:$.self})}var ee=(0,b.X)({self:[x.l0.borderRadius(0),x.l0.backgroundColor.backgroundRoot],code:[x.l0.font.code,x.l0.color.greyStronger,x.l0.p(4)]});function et(e){var t=e.value;return(0,f.tZ)(y.G,{css:ee.self,children:(0,f.tZ)(g.xv,{css:ee.code,multiline:!1,children:t})})}var en=(0,b.X)({self:x.l0.rowWithGap(4),bold:{fontWeight:x.TV.fontWeightMedium}});function er(e){var t=e.title,n=(0,u._)((0,L.Z)(function(){var e=(0,M._)(t.split(" "));return[e[0],e.slice(1).join(" ")]},[t]),2),r=n[0],i=n[1];return(0,f.BX)(y.G,{css:en.self,children:[(0,f.tZ)(g.xv,{css:en.bold,multiline:!1,children:r}),(0,f.tZ)(g.xv,{color:"dimmer",multiline:!1,children:i})]})}(gx=gN||(gN={})).IMPORT="Import the database",gx.CREATE="Create a new database",gx.SET="Set a key to a value",gx.GET="Get a key's value",gx.DELETE="Delete a key",gx.LIST="List all keys",gx.LIST_PREFIX="List keys with a prefix";var ei={language:"Bash",methods:[ec("Set a key to a value","curl $REPLIT_DB_URL -d '{{key}} = {{value}}'"),ec("Get a key's value","curl $REPLIT_DB_URL/{{key}}"),ec("Delete a key","curl -XDELETE $REPLIT_DB_URL/{{key}}"),ec("List all keys",'curl "$REPLIT_DB_URL?prefix={{key}}"')]},eo={language:"Node",methods:[ec("Import the database",'const Database = require("@replit/database")'),ec("Create a new database","const db = new Database()"),ec("Set a key to a value",'db.set("{{key}}", "{{value}}").then(() => {})'),ec("Get a key's value",'db.get("{{key}}").then(value => {})'),ec("Delete a key",'db.delete("{{key}}").then(() => {})'),ec("List all keys","db.list().then(keys => {})"),ec("List keys with a prefix",'db.list("{{prefix}}").then(matches => {})')]},ea={language:"Go",methods:[ec("Import the database",'import "github.com/replit/database-go"'),ec("Set a key to a value",'db.Set("{{key}}", "{{value}}")'),ec("Get a key's value",'value, _ := database.Get("{{key}}")'),ec("Delete a key",'database.Delete("{{key}}")'),ec("List all keys",'keys, _ := database.ListKeys("")'),ec("List keys with a prefix",'matches, _ := database.ListKeys("{{prefix}}")')]},el={language:"Python",methods:[ec("Import the database","from replit import db"),ec("Set a key to a value",'db["{{key}}"] = "{{value}}"'),ec("Get a key's value",'db["{{key}}"]'),ec("Delete a key",'del db["{{key}}"]'),ec("List all keys","keys = db.keys()"),ec("List keys with a prefix",'matches = db.prefix("{{prefix}}")')]};function ec(e,t){return{method:e,content:function(e){for(var t=[],n=0;n<e.length;){var r=e.indexOf("{{",n),i=e.indexOf("}}",n);if(-1===r||-1===i){t.push({type:"code",value:e.substring(n)});break}t.push({type:"code",value:e.substring(n,r)}),t.push({type:"input",placeholder:e.substring(r+2,i)}),n=i+2}return t}(t)}}var es=(0,b.X)({self:x.l0.colWithGap(24),code:[x.l0.font.code,x.l0.color.greyStronger,x.l0.backgroundColor.backgroundRoot,x.l0.p(4),x.l0.borderRadius(4)]});function eu(e){var t=e.activeFile,n=(0,L.Z)(function(){return function(e){switch(e?(0,E.r6)(e):"bash"){case"js":case"ts":case"tsx":case"jsx":case"mjs":return eo;case"go":return ea;case"py":return el;default:return ei}}(t)},[t]);return(0,f.BX)(y.G,{css:es.self,children:[(0,f.BX)(g.xv,{color:"dimmer",children:["You can use the Database from any Repl by making HTTP requests or a client library as outlined below. Weve set an environment variable called ",(0,f.tZ)("code",{css:es.code,children:"REPLIT_DB_URL"})," in your Repl if you'd like to interact with the database directly."]}),n.methods.map(function(e){return(0,f.tZ)(K,{method:e.method,content:e.content,activeFile:t},"".concat(n.language).concat(e.method))})]})}var ed=n(75246),ef=(0,b.X)({children:[x.l0.p(12),x.l0.colWithGap(8)]});function eh(e){var t=e.title,n=e.defaultExpanded,r=e.children;return(0,f.tZ)(ed.Q,{defaultExpanded:n,headerContent:(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:t}),children:(0,f.tZ)(y.G,{css:ef.children,children:r})})}var ep=n(43312),em=n(73157),ev=n(8279),eg=n(3630),ey=(0,ep.F4)("from{opacity:0}to{opacity:1}"),eb=(0,b.X)({self:[x.l0.colWithGap(8),{animation:"".concat(ey," 100ms forwards ease-in-out alternate")}],selfLoadingText:[x.l0.height(16),x.l0.width(48),x.l0.borderRadius(4),ev.p.backgroundPulse()],selfLoading:[x.l0.height(12),x.l0.borderRadius(16),ev.p.backgroundPulse()],text:[x.l0.rowWithGap(4)],textSpan:[x.l0.width("fit-content"),x.l0.display.inlineFlex]});function ew(e){var t,n,r=e.database,i=e.loading,o=(null==r?void 0:r.sizeMB)||0,a=(t=1e6*(t=o)/1048576,"".concat(t.toFixed(),"/50 MiB")),l=i||!r;return(0,f.tZ)(y.G,{css:eb.self,children:l?(0,f.BX)(f.HY,{children:[(0,f.tZ)(y.G,{css:eb.selfLoadingText}),(0,f.tZ)(y.G,{css:eb.selfLoading})]}):(0,f.BX)(f.HY,{children:[(0,f.BX)(g.xv,{color:"dimmer",css:eb.text,multiline:!1,children:[(0,f.tZ)(y.K.span,{css:eb.textSpan,children:a}),(0,f.tZ)(y.K.span,{css:eb.textSpan,children:"|"}),(0,f.tZ)(y.K.span,{css:eb.textSpan,children:(n=(n=null==r?void 0:r.keysCount)||0,"".concat(n," ").concat((0,em.Z)("key",n)))})]}),(0,f.tZ)(eg.J,{current:o,total:50,tooltip:a})]})},l?"databaseLoadingStats":"databaseLoadedStats")}var eZ=n(50782),ex=n(21262),eC=n(71440),eS=n(58995);function ek(){var e=(0,ex._)(["\n  fragment DatabaseUsage on Database {\n    id\n    keysCount\n    sizeMB\n  }\n"]);return ek=function(){return e},e}function e_(){var e=(0,ex._)(["\n  query Database($replID: String!) {\n    repl(id: $replID) {\n      ... on Repl {\n        id\n        database {\n          id\n          ...DatabaseUsage\n        }\n      }\n    }\n    currentUser {\n      id\n      isLoggedIn\n    }\n  }\n  ","\n"]);return e_=function(){return e},e}var eE={},eT=(0,eC.Ps)(ek()),eR=(0,eC.Ps)(e_(),eT),eI=(0,b.X)({self:[x.l0.colWithGap(16),x.l0.p(8),x.l0.backgroundColor.backgroundDefault,P.F3],link:[x.l0.color.accentPrimaryStronger,x.l0.pr(4)],sectionWrapper:[x.l0.colWithGap(16),x.l0.overflowY("auto"),x.l0.width("100%"),{flex:"1"}]});function eD(e){var t,n,r,i,o,a,l,c,s,u=e.performPaneOperation,d=(l=(i={variables:{replID:(0,eZ.Z)()},pollInterval:1e4},o=(0,U._)({},eE,i),a=eS.a(eR,o)).data,c=a.error,s=a.loading,l&&("Repl"===l.repl.__typename?n=null==l?void 0:null===(r=l.repl)||void 0===r?void 0:r.database:t="Could not fetch Database info"),c&&("GraphQL error: You don't have access to this database"===c.message?n=null:t=c.message),{db:n,loading:s,error:t}),h=d.db,p=d.error,m=d.loading,v=(0,A.R3)();return(0,f.BX)(y.G,{css:eI.self,children:[(0,f.tZ)(g.h4,{level:2,variant:"subheadBig",children:"Database"}),(0,f.BX)(y.G,{css:eI.sectionWrapper,children:[(0,f.BX)(y.G,{children:[(0,f.BX)(g.xv,{children:[(0,f.tZ)("a",{href:N.TT.REPL_DATABASE,target:"_blank",rel:"noopener",onClick:function(e){e.preventDefault(),u({operation:"open",pane:{type:"docs",data:{url:N.TT.REPL_DATABASE}}})},children:"Replit Database"})," ","is a free, easy to use key-value store. No configuration is necessary, so you can start using it right away."]}),p?(0,f.tZ)(g.xv,{css:[x.l0.color.accentNegativeStronger],children:p}):null]}),(0,f.tZ)(eh,{title:"Database Info",defaultExpanded:!0,children:(0,f.tZ)(ew,{database:h,loading:m})}),(0,f.tZ)(eh,{title:"Using the database",defaultExpanded:!0,children:(0,f.tZ)(eu,{activeFile:v})})]})]})}var eG=h.Dy.Object({type:h.Dy.Literal("database")}),eB={Content:function(e){var t=e.options.performPaneOperation;return(0,f.tZ)(eD,{performPaneOperation:t})},Icon:function(e){var t=e.size;return(0,f.tZ)(B.Z,{size:t})},getTitle:function(){return"Database"},decode:function(e){return p.B4.Decode(eG,e)}},eP=n(42516),eA=n(75533),eN=n(10814),eL=n(98924),eU=n(78639),eO=n(4687),eM=n(49932),eX="rgba(180, 0, 0, 0.125)",eF="rgba(0, 180, 0, 0.125)",eW=eO.tk.theme({"&.cm-merge-b .cm-changedLine":{background:"rgba(0, 180, 0, 0.075)"},"&.cm-merge-a .cm-changedLine":{background:"rgba(180, 0, 0, 0.075)"},"&.cm-merge-b .cm-changedLineGutter":{background:eF},"&.cm-merge-a .cm-changedLineGutter":{background:eX},"&.cm-merge-b .cm-changedText":{background:eF,outline:"solid 1px ".concat(eF),borderRadius:"2px"},"&.cm-merge-a .cm-changedText":{background:eX,outline:"solid 1px ".concat(eX),borderRadius:"2px"},".cm-collapsedLines":{color:eM.TV.accentPrimaryStrongest,background:eM.TV.accentPrimaryDimmest,transition:"background 250ms ease","&:hover":{background:eM.TV.accentPrimaryDimmer}}}),eH=[eO.tk.baseTheme({".cm-scroller":{height:"100% !important",overflowY:"auto !important"}}),eO.tk.theme({".cm-scroller":{height:"auto !important",overflowY:"visible !important"}})],eV=[eA.Wl.highest(eH),eW],ez=n(17542),ej=n(20142),eq=n(84054),eY=n(7444);function eJ(e){var t,n,r,i=e.a,o=e.b,a=e.style,l=e.className,c=(0,eL._)(e,["a","b","style","className"]),s=(0,u._)((0,_.useState)(null),2),h=s[0],p=s[1],m=(0,u._)((0,_.useState)(null),2),v=m[0],g=m[1],y=(0,_.useRef)(!1),b=(0,eY.Z)(c),w=(0,eY.Z)(i.doc),Z=(0,eY.Z)(o.doc),x=(0,ej.Xl)((0,O._)((0,U._)({},i),{readOnly:!0})),C=(0,ej.Xl)((0,O._)((0,U._)({},o),{readOnly:!0})),S=(t=(0,u._)((0,_.useState)(),2)[1],(0,_.useCallback)(function(e){t(function(){throw e})},[])),k=c.orientation,E=c.revertControls,T=c.renderRevertControl,R=c.collapseUnchanged,I=c.gutter,D=c.highlightChanges,G=void 0!==R,B=null==R?void 0:R.margin,P=null==R?void 0:R.minSize,A=null!==(n=null==v?void 0:v.a)&&void 0!==n?n:null,N=null!==(r=null==v?void 0:v.b)&&void 0!==r?r:null;return(0,ej.uF)(),(0,_.useEffect)(function(){var e=function(e){S(e)};if(h){var t=null;try{t=new eU.QK((0,O._)((0,U._)({},b.current),{parent:h,a:{doc:w.current,extensions:[eO.tk.exceptionSink.of(e),eV].concat((0,d._)(x))},b:{doc:Z.current,extensions:[eO.tk.exceptionSink.of(e),eV].concat((0,d._)(C))}}))}catch(t){e(t)}return t&&(g(t),y.current=!0),function(){if(t){g(null);try{t.destroy()}catch(t){e(t)}}}}},[h]),(0,_.useEffect)(function(){A&&!y.current&&A.dispatch({changes:{from:0,to:A.state.doc.length,insert:i.doc}})},[A,i.doc]),(0,_.useEffect)(function(){N&&!y.current&&N.dispatch({changes:{from:0,to:N.state.doc.length,insert:o.doc}})},[N,o.doc]),(0,_.useEffect)(function(){v&&!y.current&&eK(v,b.current.collapseUnchanged)},[v,b,i.doc,o.doc]),(0,_.useEffect)(function(){if(v&&!y.current){var e=G?{margin:B,minSize:P}:void 0;v.reconfigure({orientation:k,revertControls:E,renderRevertControl:T,collapseUnchanged:e,gutter:I,highlightChanges:D}),e&&eK(v,e)}},[v,k,E,T,G,B,P,I,D]),(0,ez.H)(A),(0,ez.H)(N),(0,_.useEffect)(function(){y.current=!1}),(0,f.BX)(f.HY,{children:[(0,f.tZ)("div",{ref:p,className:l,style:a}),(0,f.tZ)(eq.N1,{view:A}),(0,f.tZ)(eq.N1,{view:N})]})}function eK(e,t){e&&t&&(e.reconfigure({collapseUnchanged:void 0}),e.reconfigure({collapseUnchanged:(0,U._)({},t)}))}var e$=n(48528),eQ=n(59639),e0=n(99741),e1=n(67313),e2=n(55103),e8=(0,b.X)({container:[x.l0.width(60),x.l0.height(24),x.l0.display.flex,x.l0.center,x.l0.borderRadius(4),x.l0.fontSize(x.TV.fontSizeSmall)]});function e4(e){var t,n,r;switch(e.type){case e2.h.ADDED:case e2.h.UNTRACKED:t="Added",n=x.TV.greenDimmest,r=x.TV.greenStrongest;break;case e2.h.MODIFIED:t="Modified",n=x.TV.yellowDimmest,r=x.TV.yellowStrongest;break;case e2.h.DELETED:t="Deleted",n=x.TV.redDimmest,r=x.TV.redStrongest;break;case e2.h.RENAMED:t="Renamed",n=x.TV.tealDimmest,r=x.TV.tealStrongest;break;case e2.h.COPIED:t="Copy",n=x.TV.limeDimmest,r=x.TV.limeStrongest;break;default:return null}return(0,f.tZ)(y.G,{style:{backgroundColor:n,color:r},css:e8.container,children:(0,f.tZ)("span",{children:t})})}function e3(e){var t,n,r;switch(e.type){case"ADDED":t="Added",n=x.TV.greenDimmest,r=x.TV.greenStrongest;break;case"MODIFIED":t="Modified",n=x.TV.yellowDimmest,r=x.TV.yellowStrongest;break;case"DELETED":t="Deleted",n=x.TV.redDimmest,r=x.TV.redStrongest;break;case"RENAMED":t="Renamed",n=x.TV.tealDimmest,r=x.TV.tealStrongest;break;case"COPIED":t="Copy",n=x.TV.limeDimmest,r=x.TV.limeStrongest;break;default:return null}return(0,f.tZ)(y.G,{style:{backgroundColor:n,color:r},css:e8.container,children:(0,f.tZ)("span",{children:t})})}var e5=n(61601),e6=[{"& > span:first-child-of-type":[x.l0.flex.grow(1),x.l0.textAlign.left]},{"& > span":[x.l0.flex.shrink(1)]},x.l0.height("auto"),x.l0.p(8),x.l0.fontWeight.medium,x.l0.backgroundColor.backgroundHigher,x.l0.flex.row,x.l0.align.center,x.l0.justify.spaceBetween,x.l0.overflow("hidden"),x.l0.cursor.pointer],e9=(0,b.X)({buttonFolded:[e6,x.l0.borderRadius(8)],buttonUnfolded:[e6,x.l0.borderRadius(8,8,0,0)],rowContainer:[x.l0.align.center,x.l0.rowWithGap(8),x.l0.position.relative,x.l0.zIndex(1),x.l0.overflow("hidden")],diffContainer:[x.l0.flex.grow(1),x.l0.borderRadius(8)],bodyContainer:[x.l0.borderRadius(0,0,8,8),x.l0.p(8),x.l0.display.flex,x.l0.flex.row,x.l0.flex.wrap,x.l0.align.center,x.l0.justify.center,x.l0.backgroundColor.backgroundDefault,x.l0.border({color:x.TV.outlineDimmer,direction:"bottom"}),x.l0.border({color:x.TV.outlineDimmer,direction:"left"}),x.l0.border({color:x.TV.outlineDimmer,direction:"right"})],noChangesContainer:[x.l0.py(8),x.l0.px(8),x.l0.center,x.l0.width("100%")],innerContainer:[x.l0.display.flex,x.l0.align.center],splitContainer:[x.l0.p(8),x.l0.display.flex,x.l0.flex.row,x.l0.justify.spaceBetween,x.l0.maxWidth("100%"),x.l0.align.center],splitChild:[x.l0.align.center,x.l0.justify.center,{flexBasis:"50%"}],buttonGroupItem:[x.l0.width(64),x.l0.height(32)]}),e7=function(e){var t=e.value,n=e.onChange;return(0,f.BX)(eQ.hE,{name:"SplitOrUnifiedDiff",value:t,onChange:n,row:!0,children:[(0,f.tZ)(y.G,{css:e9.buttonGroupItem,children:(0,f.tZ)(eQ.rK,{value:"Unified",text:"Unified",id:"SplitOrUnifiedDiffUnified"})}),(0,f.tZ)(y.G,{css:e9.buttonGroupItem,children:(0,f.tZ)(eQ.rK,{value:"Split",text:"Split",id:"SplitOrUnifiedDiffSplit"})})]})},te=function(e){var t=e.folded,n=void 0!==t&&t,r=e.setFolded,i=e.diff,o="".concat(i.initial.path,"/").concat(i.initial.filename),a="".concat(i.final.path,"/").concat(i.final.filename);return(0,f.BX)(y.G,{css:n?e9.buttonFolded:e9.buttonUnfolded,onClick:function(){return r(!n)},children:[(0,f.BX)(y.G,{css:[e9.rowContainer,x.l0.flex.shrink(1)],children:["RENAMED"===i.status||"COPIED"===i.status?(0,f.BX)(f.HY,{children:[(0,f.tZ)(v.Z,{path:o}),(0,f.tZ)(g.xv,{multiline:!1,children:i.initial.filename}),""===i.initial.path?null:(0,f.tZ)(g.xv,{multiline:!1,color:"dimmest",css:[x.l0.fontWeight.normal],maxLines:1,children:i.initial.path}),(0,f.tZ)(V.Z,{}),(0,f.tZ)(v.Z,{path:a}),(0,f.tZ)(g.xv,{multiline:!1,children:i.final.filename}),""===i.final.path?null:(0,f.tZ)(g.xv,{multiline:!1,color:"dimmest",css:[x.l0.fontWeight.normal],children:i.final.path})]}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(v.Z,{path:a}),(0,f.tZ)(g.xv,{multiline:!1,children:i.final.filename}),""===i.final.path?null:(0,f.tZ)(g.xv,{multiline:!1,color:"dimmest",css:[x.l0.fontWeight.normal],children:i.final.path})]}),(0,f.tZ)(e$.j,{textToCopy:a,alt:"Copy Full Path",tooltip:"Copied!",tooltipPlacement:"bottom-end",timeout:2e3,children:(0,f.tZ)(z.Z,{})})]}),(0,f.BX)(y.G,{css:e9.rowContainer,children:[(0,f.tZ)(e3,{type:i.status}),(0,f.tZ)(m.hU,{alt:n?"Collapse diff":"Expand diff",onClick:function(){return r(!n)},children:n?(0,f.tZ)(e0.Z,{}):(0,f.tZ)(e1.Z,{})})]})]})},tt=function(e){var t=e.diff;return"Split"===e.splitOrUnified?(0,f.tZ)(eJ,{a:{filePath:t.initial.filename,doc:t.initial.content},b:{filePath:t.final.filename,doc:t.final.content},collapseUnchanged:{},style:{width:"100%"}}):(0,f.tZ)(ej.ZP,{filePath:t.final.filename,initialDoc:t.final.content,extensions:[eN.p.of(eA.xv.of(t.initial.content.split("\n")))],readOnly:!0,style:{width:"100%"}})},tn=function(e){return(0,E.T3)(e)?"media":(0,E.Mb)(e)?"ot":"binary"},tr=function(e){var t=e.content,n=e.type,r=e.filename;switch(n){case"media":return(0,f.tZ)(y.G,{css:[{display:"flex",height:"100%"}],children:(0,f.tZ)(e5.A,{content:t,mime:(0,E.yC)(r)})});case"ot":return(0,f.tZ)(ej.ZP,{filePath:r,initialDoc:t,readOnly:!0,style:{width:"100%"}});default:return(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"This binary file has changed."})}},ti=function(e){var t=e.diff,n=e.splitOrUnified;if(t.loading)return(0,f.tZ)(y.G,{css:e9.noChangesContainer,children:(0,f.tZ)(Z.Z,{size:20})});if(t.initial.content===t.final.content)return(0,f.tZ)(y.G,{css:e9.noChangesContainer,children:(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"There are no changes to show."})});if("DELETED"===t.status)return(0,f.tZ)(y.G,{css:e9.noChangesContainer,children:(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"This file has been deleted."})});var r=tn(t.initial.filename),i=tn(t.final.filename);if("ADDED"===t.status)switch(i){case"media":return(0,f.tZ)(y.G,{css:e9.noChangesContainer,children:(0,f.tZ)(y.G,{css:e9.innerContainer,children:(0,f.tZ)(e5.A,{content:t.final.content,mime:(0,E.yC)(t.final.filename)})})});case"ot":return(0,f.tZ)(y.G,{css:e9.noChangesContainer,children:(0,f.tZ)(ej.ZP,{filePath:t.final.filename,initialDoc:t.final.content,readOnly:!0,style:{width:"100%"}})});default:return(0,f.tZ)(y.G,{css:e9.noChangesContainer,children:(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"This binary file has been added."})})}return"binary"===r&&"binary"===i?(0,f.tZ)(y.G,{css:e9.noChangesContainer,children:(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"This binary file has changed."})}):"ot"===r&&"ot"===i?(0,f.tZ)(tt,{diff:t,splitOrUnified:n}):(0,f.BX)(y.G,{css:e9.splitContainer,children:[(0,f.tZ)(y.G,{css:e9.splitChild,children:(0,f.tZ)(tr,{content:t.initial.content,type:r,filename:t.initial.filename})}),(0,f.tZ)(y.G,{css:e9.splitChild,children:(0,f.tZ)(tr,{content:t.final.content,type:i,filename:t.final.filename})})]})},to=function(e){var t=e.diff,n=e.folded,r=e.setFolded,i=e.splitOrUnified;return(0,f.BX)(y.G,{css:e9.diffContainer,children:[(0,f.tZ)(te,{folded:n,setFolded:r,diff:t}),n?null:(0,f.tZ)(H.Tg,{css:e9.bodyContainer,elevated:!0,children:(0,f.tZ)(ti,{diff:t,splitOrUnified:i})})]},t.id)},ta=n(30983),tl=n(86309),tc=n(65307),ts=n(27387),tu=n(96583),td=n(19858),tf=n(43182),th=function(e){var t=e.context,n=e.gitService,r=e.result,i=e.data;tf.$e(function(e){e.setTag("service","git"),e.setTag("context",t),e.setExtra("env",n.getEnv()),i&&tf.sU("data",i),tf.Tb(r.error)})},tp=(gC=(0,ts._)(function(e,t,n,r){var i,o,a;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:if("git"!==r.type)return[3,2];return i=r.revision,[4,e.getFileContents({path:n,revision:i})];case 1:if((o=l.sent()).error)throw th({context:"use-file-at-revision-fetch-content",gitService:e,result:o,data:{path:n,revision:i}}),o.error;return[2,o.content||""];case 2:return[4,t.readFile(n,{fromDisk:!0})];case 3:if((a=l.sent()).error)throw a.error;return[2,a.content.toString("utf8")]}})}),function(e,t,n,r){return gC.apply(this,arguments)}),tm=function(e,t){var n,r=(0,u._)((0,_.useState)(null),2),i=r[0],o=r[1],a=(0,u._)((0,_.useState)(!0),2),l=a[0],c=a[1],s=(0,C.Z)().fs,d=(0,td.Z)((n=(0,ts._)(function(n){var r,i;return(0,tu.Jh)(this,function(o){switch(o.label){case 0:c(!0),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,tp(n,s,e,t)];case 2:return r=o.sent(),c(!1),[2,{content:r,error:null}];case 3:return i=o.sent(),c(!1),[2,{content:null,error:i}];case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),[e,t,s]);return(0,_.useEffect)(function(){d&&(d.error?o(null):o(d.content))},[d]),{fileContent:i,loading:l}},tv=h.Dy.Object({type:h.Dy.Literal("git"),revision:h.Dy.String()}),tg=h.Dy.Object({type:h.Dy.Literal("fs")}),ty=h.Dy.Object({type:h.Dy.Literal("diff"),data:h.Dy.Object({left:h.Dy.Object({path:h.Dy.String(),data:h.Dy.Union([tv,tg])}),right:h.Dy.Object({path:h.Dy.String(),data:h.Dy.Union([tv,tg])})})}),tb=(0,b.X)({container:[x.l0.colWithGap(16),x.l0.p(8)],header:[x.l0.mt(0),x.l0.mb(8)],emphasizedText:[x.l0.fontWeight.bold],bodyContainer:[x.l0.borderRadius(8),x.l0.p(8),x.l0.display.flex,x.l0.flex.row,x.l0.flex.wrap,x.l0.align.center,x.l0.justify.center,x.l0.backgroundColor.backgroundDefault,x.l0.border({color:x.TV.outlineDimmest,direction:"full"})],tooltipContainer:[x.l0.display.inlineBlock]}),tw=function(e){var t=e.filename,n=e.onFileClick;return(0,f.tZ)("span",{css:tb.tooltipContainer,children:(0,f.tZ)(ta.u,{tooltip:"View file",children:(0,f.tZ)("button",{css:[x.l0.reset.button,x.l0.linkStyle,x.l0.fontWeight.medium],onClick:n,children:t})})})},tZ=function(e){return"git"===e.type?e.revision:"working directory"},tx=function(e){var t,n,r=e.left,i=e.right,o=e.onFileClick,a=r.path===i.path,l=(t=r.data,n=i.data,t.type===n.type&&("git"!==t.type||t.revision===n.revision));return a?l?(0,f.BX)(g.h4,{level:1,variant:"text",css:tb.header,children:["Comparing"," ",(0,f.BX)("span",{css:tb.emphasizedText,children:[(0,f.tZ)(tw,{filename:r.path,onFileClick:o})," ",tZ(r.data)]})," ","to itself"]}):(0,f.BX)(g.h4,{level:1,variant:"text",css:tb.header,children:["Comparing"," ",(0,f.BX)("span",{css:tb.emphasizedText,children:[(0,f.tZ)(tw,{filename:r.path,onFileClick:o})," ",tZ(r.data)]})," ","to ",(0,f.tZ)("span",{css:tb.emphasizedText,children:tZ(i.data)})]}):l?(0,f.BX)(g.h4,{level:1,variant:"text",css:tb.header,children:["Comparing ",(0,f.tZ)("span",{css:tb.emphasizedText,children:r.path})," to"," ",(0,f.BX)("span",{css:tb.emphasizedText,children:[(0,f.tZ)(tw,{filename:i.path,onFileClick:o})," ",tZ(r.data)]})]}):(0,f.BX)(g.h4,{level:1,variant:"text",css:tb.header,children:["Comparing"," ",(0,f.BX)("span",{css:tb.emphasizedText,children:[r.path," ",tZ(r.data)]})," ","to"," ",(0,f.BX)("span",{css:tb.emphasizedText,children:[(0,f.tZ)(tw,{filename:i.path,onFileClick:o})," ",tZ(i.data)]})]})},tC=(gL={},(0,eP._)(gL,"Content",function(e){var t=e.pane.data,n=t.left,r=t.right,i=e.options.performPaneOperation,o=(0,u._)((0,_.useState)("Split"),2),a=o[0],l=o[1],c=tm(n.path,n.data),s=c.fileContent,d=c.loading,h=tm(r.path,r.data),p=h.fileContent,m=h.loading,v=(0,_.useMemo)(function(){return null===s&&null!==p?tc.y.ADDED:null!==s&&null===p?tc.y.DELETED:tc.y.MODIFIED},[s,p]);return(0,f.BX)(y.G,{css:tb.container,children:[(0,f.tZ)(tx,{left:n,right:r,onFileClick:function(){i({operation:"open",pane:{type:(0,P.Dp)({path:r.path}),data:{path:r.path}}})}}),(0,f.tZ)(e7,{value:a,onChange:l}),(0,f.tZ)(H.Tg,{css:tb.bodyContainer,children:(0,f.tZ)(ti,{diff:{id:"".concat(n.path,"-").concat(r.path),status:v,loading:d||m,initial:{filename:(0,E.UO)(n.path),path:(0,E.Il)(n.path),content:null!=s?s:""},final:{filename:(0,E.UO)(r.path),path:(0,E.Il)(r.path),content:null!=p?p:""}},splitOrUnified:a})})]})}),(0,eP._)(gL,"Icon",function(){return(0,f.tZ)(tl.Z,{})}),(0,eP._)(gL,"getTitle",function(){return"Diff"}),(0,eP._)(gL,"decode",function(e){return p.B4.Decode(ty,e)}),gL),tS=n(97168),tk=n(98655),t_=n(56337),tE=n(73660),tT=n(70671),tR=n(61405),tI=n(86763),tD=n.n(tI),tG=n(41500),tB=n(92674),tP=n.n(tB);function tA(){var e=(0,ex._)(["\n  query WorkspaceDrawCurrentUser {\n    currentUser {\n      id\n      username\n    }\n  }\n"]);return tA=function(){return e},e}var tN={},tL=(0,eC.Ps)(tA()),tU=function(e){return e.reduce(function(e,t){return e[t.id]=t,e},{})},tO=function(e,t,n){if(!e)return[];var r,i=t(e.getSceneElementsIncludingDeleted()),o=e.getAppState();return(r=n.reduce(function(e,t){var n,r,a;return t.id===(null===(n=o.editingElement)||void 0===n?void 0:n.id)||t.id===(null===(r=o.resizingElement)||void 0===r?void 0:r.id)||t.id===(null===(a=o.draggingElement)||void 0===a?void 0:a.id)||(i[t.id]&&i[t.id].version>t.version?e.push(i[t.id]):i[t.id]&&i[t.id].version===t.version&&i[t.id].versionNonce!==t.versionNonce&&i[t.id].versionNonce<t.versionNonce?e.push(i[t.id]):e.push(t),delete i[t.id]),e},[])).concat.apply(r,(0,d._)(Object.values(i)))},tM=function(){var e,t,n=new Promise(function(n,r){e=n,t=r});return n.resolve=e,n.reject=t,n},tX=(0,ep.iv)(".excalidraw.excalidraw-modal-container.excalidraw--mobile{margin-top:",tk.Mz-1,"px;}");function tF(e){var t,r,i,o,a=e.fs,l=e.broadcast,c=e.filePath,s=(0,u._)((0,_.useState)(void 0),2),h=s[0],p=s[1],m=(0,t_.Z)(),v=(0,_.useRef)(function(e){return(0,d._)(e)}),g=(0,_.useRef)(function(e){return -1}),b=(0,_.useRef)({readyPromise:tM()}),w=(0,_.useRef)({promise:null});(0,_.useEffect)(function(){Promise.all([n.e(6655),n.e(7454)]).then(n.t.bind(n,63668,23)).then(function(e){v.current=function(t){return t.filter(function(t){return t.isDeleted||!e.isInvisiblySmallElement(t)})},g.current=e.getSceneVersion,p(e.Excalidraw)})},[]);var Z=function(){return b.current},C=(t=(0,U._)({},tN,{ssr:!1}),eS.a(tL,t)),S=C.data,k=C.loading,E=(null==S?void 0:null===(o=S.currentUser)||void 0===o?void 0:o.username)||"",T=(0,tT.F)().isDarkColorScheme,R=(0,tR.aG)(),I=(0,tE.Z)(),D=null==I?void 0:I.color,G=(0,u._)((0,_.useState)(new Map),2),B=G[0],P=G[1],A=(0,u._)((0,_.useState)(-1),2),N=A[0],L=A[1],M=(0,_.useRef)(tP()()).current;(0,_.useEffect)(function(){function e(){return(e=(0,ts._)(function(){var e,t;return(0,tu.Jh)(this,function(n){switch(n.label){case 0:if(!S||!S.currentUser)return[2];return[4,b.current.readyPromise];case 1:return n.sent(),e=Z().getAppState().collaborators,t=new Map,R.forEach(function(n){if(n.username!==(null==S?void 0:null===(r=S.currentUser)||void 0===r?void 0:r.username)){var r,i=e.get(n.username)||{};t.set(n.username,(0,O._)((0,U._)({},i),{username:n.username,color:{background:n.color,foreground:n.color}}))}}),Z().updateScene({collaborators:t}),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[S,R]);var X=(r=(0,ts._)(function(e,t){var n,r,i,o,a,s;return(0,tu.Jh)(this,function(u){t||(e=e.filter(function(e){return!B.has(e.id)||e.version>B.get(e.id)})),n=!0,r=!1,i=void 0;try{for(o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)s=a.value,B.set(s.id,s.version),P(new Map(B))}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return l.broadcastMessage(M,{text:JSON.stringify({elements:e,path:c})}),[2]})}),function(e,t){return r.apply(this,arguments)});(0,_.useEffect)(function(){if(l)return l.onBroadcastReceived(M,function(e){var t=e.username,n=JSON.parse(e.text);if(n.path===c){if(n.collaborator&&b.current){var r=Z().getAppState().collaborators;r.set(t,(0,O._)((0,U._)({},r.get(t),n.collaborator),{username:t})),Z().updateScene({collaborators:r})}else if(n.elements){var i=tO(Z(),tU,n.elements);L(g.current(i)),Z().updateScene({elements:i})}else if(n.removePresence){var o=Z().getAppState().collaborators;o.delete(n.removePresence),Z().updateScene({collaborators:o})}}})},[l,c,M]),(0,_.useEffect)(function(){function e(){return(e=(0,ts._)(function(){return(0,tu.Jh)(this,function(e){var t;return c&&a&&(w.current.promise=new Promise((t=(0,ts._)(function(e){var t,n,r;return(0,tu.Jh)(this,function(i){switch(i.label){case 0:return[4,Promise.all([a.readFile(c),b.current.readyPromise])];case 1:return"content"in(t=u._.apply(void 0,[i.sent(),1])[0])&&(n=JSON.parse(t.content.toString()||"{}"),r=Z().getAppState(),n.appState=(0,U._)({},r),n.scrollToContent=!0,e(n)),[2]}})}),function(e){return t.apply(this,arguments)}))),[2]})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[c,a]);var F=(0,_.useCallback)(tD()((i=(0,ts._)(function(e,t){var n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:if(n=e.filter(function(e){return!e.isDeleted}),!c)return[3,2];return[4,a.writeFile(c,tG.Z.from(JSON.stringify({elements:n,files:t})))];case 1:r.sent(),r.label=2;case 2:return[2]}})}),function(e,t){return i.apply(this,arguments)}),350),[c]),W=function(e){g.current(e)>N&&(N>-1&&X(v.current(e),!1),L(g.current(e)))};return(0,f.BX)(y.G,{css:{position:"relative",height:"100%",width:"100%",flex:1,boxShadow:D?"0 3px 0 3px ".concat(D):"none",backgroundColor:x.TV.backgroundDefault,"& .excalidraw [title~=Library]":{display:"none"}},onMouseLeave:function(){l.broadcastMessage(M,{text:JSON.stringify({removePresence:E,path:c})})},children:[h&&!k?(0,f.tZ)(h,{ref:b,UIOptions:{canvasActions:{loadScene:!1}},isCollaborating:!0,theme:T?"dark":"light",initialData:w.current.promise,onPointerUpdate:function(e){var t=e.pointer,n=Z().getAppState().selectedElementIds||{};l.broadcastMessage(M,{text:JSON.stringify({collaborator:{pointer:t,selectedElementIds:n},path:c})})},onChange:function(e,t,n){W(e),L(g.current(e)),g.current(e)>N&&F(e,n)},name:E}):null,m?(0,f.tZ)(ep.xB,{styles:[tX]}):null]})}function tW(e){var t=e.fs,n=e.broadcast,r=e.filePath;return(0,f.tZ)(tF,{fs:t,broadcast:n,filePath:r},r)}var tH=h.Dy.Object({type:h.Dy.Literal("draw"),data:h.Dy.Object({path:h.Dy.String()})}),tV={Content:function(e){var t=e.pane,n=e.options.performPaneOperation;return(0,f.tZ)(tz,{path:t.data.path,performPaneOperation:n})},Icon:function(e){var t=e.size;return(0,f.tZ)(tS.Z,{size:t})},getTitle:function(e){return(0,E.UO)(e.data.path)},decode:function(e){return p.B4.Decode(tH,e)}};function tz(e){var t=e.path,n=e.performPaneOperation,r=(0,C.Z)(),i=r.fs,o=r.broadcast,a=(0,S.Mp)({path:t,performPaneOperation:n});return(0,k.L5)(function(){if(a)return{commands:a}},[a]),(0,f.BX)(f.HY,{children:[(0,f.tZ)(S.HK,{path:t,performPaneOperation:n}),(0,f.tZ)(S.VY,{children:(0,f.tZ)(tW,{fs:i,broadcast:o,filePath:t})})]})}var tj=n(97411),tq=n(52489),tY=h.Dy.Object({type:h.Dy.Literal("envEditor")}),tJ={Content:function(){return(0,f.tZ)(tK,{})},Icon:function(e){var t=e.size;return(0,f.tZ)(tj.Z,{size:t})},getTitle:function(){return"Secrets"},decode:function(e){return p.B4.Decode(tY,e)}};function tK(){var e=(0,C.Z)().fs,t=(0,C.Z)().runner;return(0,f.tZ)(tq.ZP,{readRawEnv:function(){return e.readFile(".env")},writeRawEnv:function(t){return e.writeFile(".env",t)},getRunState:t.getRunState})}var t$=n(8271),tQ=n(25425),t0=n(57369),t1=n(75647),t2=n(80703),t8=n(19713),t4=(0,_.createContext)(null);function t3(){var e=(0,_.useContext)(t4);if(!e)throw Error("Expected store in context");return e}var t5=(0,t8.cn)([]),t6=(0,t8.cn)(function(e){return e(t5)},function(e,t,n){var r=e(t5),i=Math.random().toString(36).substring(7);t(t5,[{id:i,type:n,dismiss:function(){var n=e(t5).filter(function(e){return e.id!==i});t(t5,n)}}].concat((0,d._)(r)))});function t9(){return(0,t2.b9)(t6,{store:t3()})}var t7=n(40028),ne=n(47357),nt=n(68514),nn=n(93496),nr=n(40227),ni=n(54843),no=n(57624),na=n(99656),nl=n(21076),nc=n(16405),ns=n(79378),nu=n(13051),nd=n(63043),nf=n(78711);function nh(){var e=(0,ex._)(["\n  query GitUserImageByUsername($username: String!) {\n    userByUsername(username: $username) {\n      id\n      image\n    }\n  }\n"]);return nh=function(){return e},e}var np={},nm=(0,eC.Ps)(nh()),nv=n(79032),ng=(0,b.X)({gitUserContainer:[x.l0.flex.row],gitUserText:[x.l0.fontWeight.medium],gitUserInnerContainer:[x.l0.align.center,x.l0.flex.row,{"& > :not(:first-child)":{marginLeft:x.TV.space4}}],gitUserInnerContainerFlipped:[x.l0.align.center,x.l0.flex.rowReverse,{"& > :not(:last-child)":{marginLeft:x.TV.space4}}],alignCenter:[x.l0.align.center]});function ny(e){var t=e.name,n=e.email,r=e.allowPlaceholderAvatar,i=void 0!==r&&r,o=e.color,a=void 0===o?"default":o,l=e.small,c=void 0!==l&&l,s=e.flip,u=void 0!==s&&s,d=e.placement,h=e.showTooltip;return void 0===h||h?(0,f.tZ)(y.G,{css:ng.gitUserContainer,children:(0,f.tZ)(ta.u,{placement:void 0===d?"bottom":d,tooltip:(0,f.tZ)(g.xv,{children:n}),children:(0,f.BX)(y.G,{css:u?ng.gitUserInnerContainerFlipped:ng.gitUserInnerContainer,children:[(0,f.tZ)(nb,{email:n,name:t,enablePlaceholder:i,small:c}),(0,f.tZ)(g.xv,{multiline:!1,css:ng.gitUserText,color:a,variant:c?"small":"text",children:t})]})})}):(0,f.tZ)(y.G,{css:ng.gitUserContainer,children:(0,f.BX)(y.G,{css:u?ng.gitUserInnerContainerFlipped:ng.gitUserInnerContainer,children:[(0,f.tZ)(nb,{email:n,name:t,enablePlaceholder:i,small:c}),(0,f.tZ)(g.xv,{multiline:!1,css:ng.gitUserText,color:a,variant:c?"small":"text",children:t})]})})}function nb(e){var t,n=e.name,r=e.email,i=e.enablePlaceholder,o=void 0!==i&&i,a=e.small,l=void 0!==a&&a,c=(0,u._)((t=(0,U._)({},np,{initialFetchPolicy:"cache-and-network",nextFetchPolicy:"cache-first",ssr:!1}),nf.t(nm,t)),1)[0],s=(0,u._)((0,_.useState)(null),2),d=s[0],h=s[1];return(0,_.useEffect)(function(){var e;(e=(0,ts._)(function(){var e,t,n,i,o,a,l,s,d,f;return(0,tu.Jh)(this,function(p){switch(p.label){case 0:if(!r.endsWith("@".concat(nd.O)))return[3,1];return e=r.split("@")[0],(t=(0,u._)(e.split("+"),2))[0],n=t[1],h((0,nc.vt)("https://github.com/".concat(n,".png"))),[3,4];case 1:if(!r.endsWith("@".concat(nd.J)))return[3,3];return a=r.split("@")[0],(l=(0,u._)(a.split("-"),2))[0],[4,c({variables:{username:l[1]}})];case 2:return(s=null===(o=p.sent().data)||void 0===o?void 0:null===(i=o.userByUsername)||void 0===i?void 0:i.image)&&h(s),[3,4];case 3:d=(0,nv.FB)(r),(f=new URL("https://gravatar.com/avatar/".concat(d))).searchParams.append("d","404"),h(f.toString()),p.label=4;case 4:return[2]}})}),function(){return e.apply(this,arguments)})()},[r,c]),(0,_.useMemo)(function(){var e=l?12:16;return null===d?o?(0,f.tZ)(nu.Z,{css:ng.alignCenter,size:e}):null:(0,f.tZ)(ns.q,{css:ng.alignCenter,username:n,src:d,onError:function(){return h(null)},size:e})},[d,o,l,n])}var nw=n(59868),nZ=n(67795);function nx(e,t){(0,nw.j)(nZ.U3.GIT_FEATURE_USED,(0,U._)({action:e,source:"git-pane"},t))}var nC=n(68333),nS=n(87959);(gS=gU||(gU={})).SUCCESS="SUCCESS",gS.WARNING="WARNING",gS.FAILED="FAILED",gS.OFF="OFF";var nk=(0,b.X)({root:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.py(4)],circle:[x.l0.width(8),x.l0.height(8),x.l0.borderRadius("full")]}),n_=function(e){var t,n,r,i=e.display,o=void 0===i?"inline":i,a=(0,eL._)(e,["display"]);switch(a.status){case"SUCCESS":t=x.TV.accentPositiveStronger,n=x.TV.accentPositiveStronger;break;case"WARNING":t=x.TV.yellowStronger,n=x.TV.yellowStronger;break;case"FAILED":t=x.TV.accentNegativeStronger,n=x.TV.accentNegativeStronger;break;case"OFF":t=x.TV.greyStronger,n=x.TV.greyStronger}var l=(0,f.BX)(y.G,{onClick:null!==(r=a.onClick)&&void 0!==r?r:function(){},css:[nk.root,a.onClick?{cursor:"pointer"}:{}],children:[(0,f.tZ)("div",{css:nk.circle,style:{backgroundColor:t,boxShadow:"0px 0px 6px ".concat(n)}}),"inline"===o?(0,f.tZ)(g.xv,{color:"dimmer",multiline:!1,children:a.content}):null]});return"tooltip"===o&&(l=(0,f.tZ)(ta.u,{tooltip:a.content,children:l})),l},nE=(0,b.X)({revertText:[x.l0.color.orangeStronger,x.l0.fontWeight.medium],mergeText:[x.l0.color.purpleStronger,x.l0.fontWeight.medium],pullRequestId:[x.l0.fontWeight.medium],hash:[x.l0.fontWeight.medium],filePathPrefix:[x.l0.color.foregroundDimmest],commitBody:[x.l0.font.code,{whiteSpace:"pre-wrap"},{fontSize:x.TV.fontSizeSmall}],clickableName:[x.l0.cursor.pointer,{"&:hover":{textDecoration:"underline"}}],tooltip:[x.l0.display.inlineFlex,x.l0.rowWithGap(4),x.l0.align.center],path:[{fontSize:x.TV.fontSizeSmall},x.l0.font.code],fixTooltipDisplay:{"& > span":{display:"inline-block"}},headingWrapper:[x.l0.display.inlineFlex,x.l0.rowWithGap(4),x.l0.align.center,x.l0.flex.shrink(1),x.l0.overflow("hidden")],headingRemote:[{verticalAlign:"text-bottom"},x.l0.mr(4),x.l0.color.foregroundDimmest],headingCurrent:[x.l0.px(4)],text:[x.l0.fontWeight.medium],remote:[{verticalAlign:"center"},{fontSize:x.TV.fontSizeSmall},x.l0.mr(4),x.l0.color.foregroundDimmest],current:[x.l0.position.relative,x.l0.top("-1px"),x.l0.display.inlineFlex,x.l0.pl(2),x.l0.pr(8)],icon:[{verticalAlign:"baseline !important"},x.l0.mr(4)],bodyContainer:[x.l0.border({color:x.TV.outlineDimmest,direction:"full"}),x.l0.borderRadius(8),x.l0.p(16)]});function nT(e){var t=e.text,n=e.className;return(0,f.tZ)("span",{className:n,css:nE.revertText,children:t})}function nR(e){var t=e.text,n=e.className;return(0,f.tZ)("span",{className:n,css:nE.mergeText,children:t})}function nI(e){var t,n=e.id,r=e.hash,i=e.className;return t=void 0===r||r?"string"==typeof n&&n.startsWith("#")?n:"#".concat(n):"string"==typeof n&&n.startsWith("#")?n.slice(1):"".concat(n),(0,f.tZ)("span",{className:i,css:nE.pullRequestId,children:t})}function nD(e){var t=e.hash,n=e.length,r=e.className;return(0,f.tZ)("span",{className:r,css:nE.hash,children:t.slice(0,(void 0===n?8:n)+1)})}function nG(e){var t=e.subject,n=e.remoteName,r=e.quoted,i=void 0!==r&&r,o=e.className;return n?(0,f.tZ)(nC.ZP,{className:o,background:!1,lineBreaks:!0,themed:!0,useRemarkGfm:!0,remarkGitHubOptions:{repository:n},children:i?'"'.concat(t,'"'):t}):(0,f.tZ)("span",{className:o,children:i?'"'.concat(t,'"'):t})}function nB(e){var t=e.body,n=e.view,r=e.className;return"Source"===(void 0===n?"Source":n)?(0,f.tZ)(y.G,{css:nE.bodyContainer,children:(0,f.tZ)("pre",{className:r,css:nE.commitBody,children:t})}):(0,f.tZ)(y.G,{css:nE.bodyContainer,children:(0,f.tZ)(nC.ZP,{className:r,background:!1,mentionsLink:!0,lineBreaks:!0,themed:!0,useRemarkGfm:!0,children:t})})}function nP(e){var t=e.name,n=e.remote,r=e.current,i=void 0!==r&&r,o=e.heading,a=void 0!==o&&o,l=e.icon,c=void 0!==l&&l,s=e.onClick,u=e.className,d=null;return(!0===c||!c&&i?d=i?(0,f.tZ)("span",{css:a?nE.headingCurrent:nE.current,children:(0,f.tZ)(n_,{display:"tooltip",content:"This is your current branch.",status:gU.SUCCESS})}):a?(0,f.tZ)(nS.Z,{size:16}):(0,f.tZ)(nS.Z,{css:nE.icon,size:12}):c&&(d=c),a)?(0,f.BX)("div",{css:nE.headingWrapper,children:[d,(0,f.BX)(g.xv,{variant:"subheadDefault",multiline:!1,children:[n?(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{css:nE.headingRemote,children:n}),(0,f.tZ)("span",{css:nE.headingRemote,children:"/"})]}):null,s?(0,f.tZ)(nL,{label:"View branch",onClick:s,children:t}):(0,f.tZ)("span",{children:t})]})]}):(0,f.BX)("span",{className:u,css:nE.text,children:[d,n?(0,f.tZ)("span",{css:nE.remote,children:n}):null,s?(0,f.tZ)(nL,{label:"View branch",onClick:s,children:t}):(0,f.tZ)("span",{children:t})]})}function nA(e){var t=e.path,n=e.prefix,r=e.onClick,i=e.className,o=(0,E.UO)(t),a=!r&&(o===t||null!==n&&n+o===t);return(0,f.tZ)("span",{css:nE.fixTooltipDisplay,children:(0,f.tZ)(ta.u,{maxWidth:"auto",tooltip:(0,f.tZ)(nN,{path:t,openable:!!r}),isDisabled:a,children:r?(0,f.BX)(nL,{label:"Open ".concat(o),onClick:r,className:i,children:[n?(0,f.tZ)("span",{css:nE.filePathPrefix,children:n}):null,(0,f.tZ)("span",{children:o})]}):(0,f.BX)("span",{className:i,children:[n?(0,f.tZ)("span",{css:nE.filePathPrefix,children:n}):null,(0,f.tZ)("span",{children:o})]})})})}function nN(e){var t=e.path,n=e.openable;return(0,f.BX)("span",{css:nE.tooltip,children:[void 0===n||n?(0,f.tZ)("span",{children:"Open"}):null,(0,f.tZ)("span",{css:nE.path,children:t})]})}function nL(e){var t=e.label,n=e.onClick,r=e.className,i=e.children;return(0,f.tZ)("span",{className:r,css:nE.clickableName,role:"button",tabIndex:-1,"aria-label":t,onClick:n,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&(null==n||n())},children:i})}(gk=gO||(gO={})).DASHBOARD="DASHBOARD",gk.BRANCH="BRANCH",gk.CURRENT_BRANCH="CURRENT_BRANCH",gk.SETTINGS="SETTINGS",gk.COMMIT="COMMIT";var nU=n(1169),nO=y.K.button,nM=(0,b.X)({container:[x.l0.display.flex,x.l0.flex.growAndShrink(1),x.l0.overflow("hidden")],cursorOverlay:{cursor:"pointer"},fullWidth:[x.l0.width("100%")],searchContainer:[x.l0.p(8)],paddedX:[x.l0.px(8)],loadingContainer:[x.l0.display.flex,x.l0.align.center,x.l0.justify.center,x.l0.py(48)],menu:[x.l0.maxWidth(390),x.l0.width(280),x.l0.display.flex,x.l0.maxHeight(300),x.l0.borderRadius(8),x.l0.overflow("hidden")],form:[x.l0.display.flex,x.l0.flex.growAndShrink(1),x.l0.flex.column,x.l0.overflow("hidden")],body:[x.l0.py(8),x.l0.colWithGap(8),x.l0.flex.growAndShrink(1),x.l0.overflow("auto")],branchMetadata:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.flex.shrink(1)],section:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.justify.spaceBetween],selector:[x.l0.display.flex,x.l0.align.center,x.l0.rowWithGap(4)],header:[x.l0.colWithGap(2),x.l0.width("100%")],menuItem:[{backgroundColor:"inherit"},nn.gU.listItem,x.l0.px(8),x.l0.py(6),x.l0.borderRadius(0),x.l0.colWithGap(8),x.l0.align.start],inputDisabled:[{opacity:.75}],padded:[x.l0.p(8)],virtualItem:[x.l0.position.absolute,x.l0.top(0),x.l0.left(0),x.l0.width("100%"),x.l0.overflow("hidden")],virtualList:[x.l0.position.relative],divider:[x.l0.mt(8),x.l0.mb(8),x.l0.ml(0),x.l0.mr(0)],errorText:[x.l0.color.accentNegativeStronger,x.l0.mt(4)],createBranchButton:[x.l0.height(32),x.l0.overflow("hidden"),{whiteSpace:"nowrap",textOverflow:"ellipsis"}]}),nX=function(e,t){var n,r,i,o=t9(),a=(0,C.Z)().git,l=(0,u._)((0,_.useState)(!0),2),c=l[0],s=l[1],d=(0,td.Z)((n=(0,ts._)(function(e){var t,n,r,i,a,l,c,u,d,f,h,p,m,v,g,y,b,w,Z,x,C;return(0,tu.Jh)(this,function(S){switch(S.label){case 0:return s(!0),[4,e.isInitialized()];case 1:if((t=S.sent()).error)return o(t.error),s(!1),[2,t];if(!t.initialized)return s(!1),[2,{active:[],stale:[],important:[],error:null}];return[4,e.listBranches()];case 2:if((n=S.sent()).error)return o(n.error),s(!1),[2,n];return[4,e.findDefaultBranches()];case 3:if((r=S.sent()).error)return o(r.error),s(!1),[2,r];i=n.branches,a=new Set,l=!0,c=!1,u=void 0;try{for(d=function(){var e=h.value,t=i.find(function(t){return(0,nl.Pi)(t,e)});t&&a.add(t)},f=r.refs[Symbol.iterator]();!(l=(h=f.next()).done);l=!0)d()}catch(e){c=!0,u=e}finally{try{l||null==f.return||f.return()}finally{if(c)throw u}}p=Date.now()-72e6,m=[],v=[],g=!0,y=!1,b=void 0;try{for(w=i[Symbol.iterator]();!(g=(Z=w.next()).done);g=!0)x=Z.value,a.has(x)||(x.commit.author.date>p?m.push(x):v.push(x))}catch(e){y=!0,b=e}finally{try{g||null==w.return||w.return()}finally{if(y)throw b}}return C=Array.from(a),s(!1),[2,{active:m,stale:v,important:C,error:null}]}})}),function(e){return n.apply(this,arguments)}),[o]),f=(r=(0,ts._)(function(t){var n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:if(c||(0,nl.Pi)(e,t))return[2];return s(!0),[4,a.switchBranch(t)];case 1:return(n=r.sent()).error?(o(n.error),s(!1)):(a.forceRefresh(),nx("branch-switched")),[2]}})}),function(e){return r.apply(this,arguments)}),h=(i=(0,ts._)(function(e){var t;return(0,tu.Jh)(this,function(n){switch(n.label){case 0:if(c||""===e)return[2];return s(!0),[4,a.createBranch({name:e,checkout:!0})];case 1:return(t=n.sent()).error?(o(t.error),s(!1)):(a.forceRefresh(),nx("branch-created")),[2]}})}),function(e){return i.apply(this,arguments)});if((0,_.useEffect)(function(){null!==e&&(s(!1),t({mode:gO.CURRENT_BRANCH}))},[e,t]),null===d||c)return{loading:c,active:[],stale:[],important:[],handleSwitchBranch:f,handleCreateBranch:h,error:null};if(d.error)return{loading:c,active:[],stale:[],important:[],handleSwitchBranch:f,handleCreateBranch:h,error:d.error};var p=d.active,m=d.stale,v=d.important;return{loading:c,active:null!=p?p:[],stale:null!=m?m:[],important:null!=v?v:[],handleSwitchBranch:f,handleCreateBranch:h,error:null}},nF=function(e){var t=e.branch,n=nX(t,e.switchMode),r=n.loading,i=n.active,o=n.important,a=n.stale,l=n.handleSwitchBranch,c=n.handleCreateBranch,s=(0,u._)((0,_.useState)(!1),2),d=s[0],h=s[1],p=(0,u._)((0,_.useState)(""),2),m=p[0],v=p[1],g=(0,u._)((0,_.useState)(!1),2),y=g[0],b=g[1];return(0,f.tZ)(nK,{isOpen:d,setIsOpen:h,important:o,active:i,stale:a,current:t,query:m,setQuery:v,onSwitchBranch:l,createBranchLoading:y,createBranch:(0,ts._)(function(){return(0,tu.Jh)(this,function(e){switch(e.label){case 0:return b(!0),[4,c(m)];case 1:return e.sent(),v(""),b(!1),[2]}})}),loading:r})},nW=function(e){var t=e.onClick,n=e.children,r=(0,_.useRef)(null),i=(0,u._)((0,nU.XZ)(r,!1),4),o=i[0],a=i[1],l=i[2],c=i[3];return(0,nU.Ym)(a,r),(0,f.tZ)(nO,{ref:r,role:"menuitem",css:nM.menuItem,onClick:function(e){c(),t(e)},onKeyDown:l,tabIndex:o,children:n})},nH=function(e){var t=e.branch;return(0,f.BX)(y.G,{css:nM.branchMetadata,children:[(0,f.tZ)(ny,{name:t.commit.author.name,email:t.commit.author.email,color:"dimmest",allowPlaceholderAvatar:!0,placement:"top",showTooltip:!1}),(0,f.tZ)(g.xv,{color:"dimmer",variant:"small",children:(0,no.lb)(t.commit.author.date)})]})},nV=function(e){var t=e.branch,n=e.current,r=e.onSwitchBranch,i=(0,_.useMemo)(function(){return(0,t1.p3)(t,n)},[t,n]);return(0,f.BX)(nW,{onClick:function(){return r(t)},children:[(0,f.tZ)(g.xv,{multiline:!1,variant:"small",children:(0,f.tZ)(nP,{name:t.name,remote:t.type===t1.HO.REMOTE?t.remote:null,current:i,icon:!0})}),(0,f.tZ)(nH,{branch:t})]})},nz=function(e,t){return t.filter(function(t){return(0,nl.Qj)(t).toLowerCase().includes(e.toLowerCase())})},nj=function(e,t,n){var r=0,i=[];if(e.length+t.length+n.length===0)return i;if(e.length>0){i.push({key:"heading-important-".concat(r++),type:"heading",title:"Important"});for(var o=0;o<e.length;++o)i.push({key:"branch-important-".concat(r++),type:"branch",branch:e[o]});t.length+n.length>0&&i.push({key:"divider-important-".concat(r++),type:"divider"})}if(t.length>0){i.push({key:"heading-active-".concat(r++),type:"heading",title:"Active"});for(var a=0;a<t.length;++a)i.push({key:"branch-active-".concat(r++),type:"branch",branch:t[a]});n.length>0&&i.push({key:"divider-active-".concat(r++),type:"divider"})}if(n.length>0){i.push({key:"heading-stale-".concat(r++),type:"heading",title:"Stale"});for(var l=0;l<n.length;++l)i.push({key:"branch-stale-".concat(r++),type:"branch",branch:n[l]})}return i},nq=function(e){var t=e.item,n=e.current,r=e.onSwitchBranch;return"heading"===t.type?(0,f.tZ)(y.G,{css:nM.paddedX,children:(0,f.tZ)(g.xv,{multiline:!1,children:t.title})}):"divider"===t.type?(0,f.tZ)(y.G,{css:nM.divider,children:(0,f.tZ)(nt.R,{})}):(0,f.tZ)(y.G,{children:(0,f.tZ)(nV,{branch:t.branch,current:n,onSwitchBranch:r})})},nY=function(e){var t=e.items,n=e.current,r=e.onSwitchBranch,i=(0,_.useRef)(null),o=(0,ne.MG)({overscan:10,count:t.length,getScrollElement:function(){return i.current},estimateSize:function(e){var n,r;return null!==(n=void 0===(r=t[e])?0:"heading"===r.type?30:"branch"===r.type?65:"divider"===r.type?20:void 0)&&void 0!==n?n:0}});return(0,f.tZ)(nU.uP,{options:{direction:"vertical"},children:(0,f.tZ)("div",{css:nM.body,ref:i,children:(0,f.tZ)("ul",{css:nM.virtualList,style:{height:"".concat(o.getTotalSize(),"px")},children:o.getVirtualItems().map(function(e){return(0,f.tZ)("div",{css:nM.virtualItem,style:{transform:"translateY(".concat(e.start,"px)")},"data-index":e.index,ref:o.measureElement,children:(0,f.tZ)(nq,{item:t[e.index],current:n,onSwitchBranch:r})},e.key)})})})})},nJ=function(e){var t=e.query,n=e.setQuery,r=e.filteredImportant,i=e.filteredActive,o=e.filteredStale,a=e.current,l=e.onSwitchBranch,c=e.createBranchLoading,s=e.createBranch,u=e.loading,h=(0,_.useMemo)(function(){return nj(r,i,o)},[r,i,o]),p='Create Branch "'.concat(t,'"'),m=(0,_.useMemo)(function(){return(0,d._)(r).concat((0,d._)(i),(0,d._)(o)).some(function(e){return e.name===t})},[t,r,i,o]);return(0,f.tZ)(y.G,{css:nM.menu,children:(0,f.tZ)("form",{onSubmit:function(e){e.preventDefault(),s()},css:nM.form,children:u?(0,f.tZ)(y.G,{css:nM.loadingContainer,children:(0,f.tZ)(Z.Z,{})}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(y.G,{css:nM.searchContainer,children:(0,f.tZ)(ni.E,{value:t,onChange:function(e){n(e.target.value)},onClear:function(){n("")},loading:!1,placeholder:"Find or create a branch..."})}),(0,f.tZ)(y.G,{css:nM.paddedX,children:(0,f.tZ)(nt.R,{})}),h.length>0?(0,f.tZ)(nY,{items:h,current:a,onSwitchBranch:l}):null,m||""===t?null:(0,f.BX)(y.G,{css:nM.padded,children:[(0,f.tZ)(W.zx,{text:p,size:"small",iconLeft:c?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(na.Z,{}),stretch:!0,css:nM.createBranchButton,disabled:c||!(0,nl.Dc)(t),type:"submit"}),(0,nl.Dc)(t)?null:(0,f.tZ)(g.xv,{variant:"small",css:nM.errorText,multiline:!1,children:"Invalid branch name"})]})]})})})},nK=function(e){var t=e.isOpen,n=e.setIsOpen,r=e.important,i=e.active,o=e.stale,a=e.current,l=e.query,c=e.setQuery,s=e.onSwitchBranch,u=e.createBranchLoading,d=e.createBranch,h=e.loading,p=(0,_.useMemo)(function(){return nz(l,r)},[l,r]),m=(0,_.useMemo)(function(){return nz(l,i)},[l,i]),v=(0,_.useMemo)(function(){return nz(l,o)},[l,o]);return(0,f.BX)(nr.xo,{label:"View Branches",placement:"bottom",isOpen:t,onOpenChange:function(e){n(e)},offset:16,children:[function(e){var n=e.onClick,r=(0,eL._)(e,["onClick"]);return(0,f.tZ)(W.zx,{variant:"nofill",text:(0,f.BX)(g.xv,(0,O._)((0,U._)({multiline:!1,variant:"small",css:nM.selector},r),{children:[(0,f.tZ)(nP,{name:a.name,remote:a.type===t1.HO.REMOTE?a.remote:null,current:!0,icon:!0}),t?(0,f.tZ)(e1.Z,{}):(0,f.tZ)(e0.Z,{})]})),size:"small",stretch:!0,alignment:"start",css:nM.fullWidth,onClick:n})},(0,f.tZ)(nJ,{query:l,setQuery:c,filteredImportant:p,filteredActive:m,filteredStale:v,current:a,onSwitchBranch:s,createBranchLoading:u,createBranch:d,loading:h})]})},n$=n(4995),nQ=n(66663),n0=n(58003),n1=n(73722);function n2(){var e,t,n,r,i,o=(0,u._)((0,_.useState)(!1),2),a=o[0],l=o[1],c=(0,C.Z)().git,s=(t=(e=(0,u._)((0,_.useState)(!1),2))[0],n=e[1],r=(0,C.Z)().git,(0,_.useEffect)(function(){return r.onBusyChange(n)},[r]),t),d=t9(),h=(0,td.Z)((i=(0,ts._)(function(e){var t,n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:return[4,e.isInitialized()];case 1:if((t=r.sent()).error)return d(t.error),[2,t];if(!t.initialized)return[2,{hasRemotes:!1,error:null}];return[4,e.getRemotes()];case 2:if((n=r.sent()).error)return d(n.error),[2,n];return[2,{hasRemotes:n.remotes.size>0,error:null}]}})}),function(e){return i.apply(this,arguments)}),[d]);if(null==h?void 0:h.error)return null;var p=!!h&&h.hasRemotes,v=s||a||null===h;function g(){return(g=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(c.isBusy()||v)return[2];if(l(!0),!p)return[3,2];return[4,c.fetch()];case 1:(e=t.sent()).error?d(e.error):nx("remote-fetched"),t.label=2;case 2:return[4,c.refreshProfiles()];case 3:return t.sent(),c.forceRefresh(),setTimeout(function(){return l(!1)},500),[2]}})})).apply(this,arguments)}return(0,f.tZ)(m.hU,{alt:p?"Refresh and Fetch":"Refresh",size:24,onClick:function(){return g.apply(this,arguments)},disabled:v,children:v?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(n1.Z,{})})}var n8=(0,b.X)({container:[x.l0.height(36),x.l0.px(8),x.l0.py(4),x.l0.rowWithGap(8),x.l0.backgroundColor.backgroundDefault,x.l0.align.center,x.l0.justify.spaceBetween,x.l0.zIndex(1),{borderBottom:"1px solid ".concat(x.TV.outlineDimmer)}],left:[x.l0.rowWithGap(4),x.l0.align.center,x.l0.flex.growAndShrink(1)],right:[x.l0.rowWithGap(8),x.l0.align.center],back:{marginLeft:-4}}),n4=function(e){var t=e.openSettings;return(0,f.BX)(y.G,{css:n8.container,children:[(0,f.BX)(y.G,{css:n8.left,children:[(0,f.tZ)(nQ.Z,{size:16}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Repository"})]}),(0,f.BX)(y.G,{css:n8.right,children:[(0,f.tZ)(rt,{openSettings:t}),(0,f.tZ)(n2,{})]})]})},n3=function(e){var t=e.branch,n=e.switchMode,r=e.openSettings;return(0,f.BX)(y.G,{css:n8.container,children:[(0,f.tZ)(y.G,{css:n8.left,children:(0,f.tZ)(nF,{branch:t,switchMode:n})}),(0,f.BX)(y.G,{css:n8.right,children:[(0,f.tZ)(rt,{openSettings:r}),(0,f.tZ)(n2,{})]})]})},n5=function(e){var t=e.onBack;return(0,f.BX)(y.G,{css:n8.container,children:[(0,f.BX)(y.G,{css:n8.left,children:[(0,f.tZ)(n7,{onBack:t,alt:"Back"}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Settings"})]}),(0,f.tZ)(y.G,{css:n8.right})]})},n6=function(e){var t=e.switchMode,n=e.openSettings;return(0,f.BX)(y.G,{css:n8.container,children:[(0,f.BX)(y.G,{css:n8.left,children:[(0,f.tZ)(re,{switchMode:t}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Commit"})]}),(0,f.BX)(y.G,{css:n8.right,children:[(0,f.tZ)(rt,{openSettings:n}),(0,f.tZ)(n2,{})]})]})};function n9(e){var t=e.mode,n=e.branch,r=e.switchMode,i=e.onBack,o=function(){return r({mode:gO.SETTINGS})};switch(t){case gO.DASHBOARD:return(0,f.tZ)(n4,{openSettings:o});case gO.BRANCH:case gO.CURRENT_BRANCH:if(null===n)throw Error("Tried to show branch in header, but branch is null");return(0,f.tZ)(n3,{branch:n,switchMode:r,openSettings:o});case gO.SETTINGS:return(0,f.tZ)(n5,{onBack:i});case gO.COMMIT:return(0,f.tZ)(n6,{switchMode:r,openSettings:o});default:return(0,f.BX)(y.G,{css:n8.container,children:[(0,f.tZ)(y.G,{css:n8.left}),(0,f.tZ)(y.G,{css:n8.right})]})}}function n7(e){var t=e.onBack,n=e.alt;return(0,f.tZ)(m.hU,{css:n8.back,alt:n,size:28,onClick:t,children:(0,f.tZ)(n$.Z,{})})}function re(e){var t=e.switchMode;return(0,f.tZ)(n7,{css:n8.back,onBack:function(){return t({mode:gO.CURRENT_BRANCH})},alt:"Back to current branch"})}function rt(e){var t=e.openSettings;return(0,f.tZ)(m.hU,{alt:"Settings",size:24,onClick:t,children:(0,f.tZ)(n0.Z,{})})}var rn=n(20573),rr=n(58719),ri=n(75813),ro=n(89106),ra=n(85340),rl=n(32377),rc=n(4391);function rs(){var e,t=(0,td.Z)((e=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){return[2,{connectedToGithub:ru(e),error:null}]})}),function(t){return e.apply(this,arguments)}));return null==t||t.error?null:t.connectedToGithub}function ru(e){return e.hasProfile(ri.rG.GITHUB)}function rd(e){var t=e.label,n=e.allowReconnect,r=e.callback,i=(0,u._)((0,_.useState)(!1),2),o=i[0],a=i[1],l=(0,C.Z)().git,c=rs(),s=(0,t_.Z)(),d=(0,ra.v)({onAuth:function(){nx("github-user-connected"),a(!1),l.refreshProfiles({preferredProvider:ri.rG.GITHUB}),null==r||r()},onClose:function(){return a(!1)}});return c&&!(void 0!==n&&n)?(0,f.tZ)(W.zx,{text:"Connected to GitHub",colorway:"primary",iconLeft:(0,f.tZ)(rl.Z,{}),disabled:!0}):(0,f.tZ)(W.zx,{text:o||null===c?"Connecting...":s?"Visit account page to connect to GitHub":void 0===t?"Connect to GitHub":t,colorway:"primary",iconLeft:o?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(rc.Z,{}),loading:o,onClick:function(){if(s){ro.X.openExternalUrl("/account#connected-services");return}a(!0),d()}})}var rf=n(50431),rh=n(95597);function rp(e){return!!e&&("string"==typeof e?e.includes(rh.Kd):e.fetch.includes(rh.Kd))}function rm(e){return e.endsWith(".git")?e.slice(0,-4):e}function rv(e){if(!e)return null;var t="string"==typeof e?e:e.fetch;return rp(t)?rm(t):null}function rg(e){var t="string"==typeof e?e:e.fetch;if(rp(t)){var n=(t=rm(t)).split("/");if(n.length<2)return null;var r=n[n.length-2],i=n[n.length-1];return"".concat(r,"/").concat(i)}return null}var ry=(0,b.X)({body:[x.l0.p(4),x.l0.colWithGap(8),x.l0.borderRadius(0,0,8,8)],remedies:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.justify.end]});function rb(e){var t=e.description,n=e.remedies,r=e.error;return(0,f.BX)(H.Tg,{css:ry.body,elevated:!0,children:[(0,f.tZ)(g.xv,{children:t}),(0,f.BX)(y.G,{css:ry.remedies,children:[n,(0,f.tZ)(W.zx,{text:"Dismiss",iconLeft:(0,f.tZ)(rr.Z,{}),onClick:r.dismiss})]})]})}function rw(e){var t,n=e.error,r=(0,td.Z)((t=(0,ts._)(function(e){var t,r,i,o,a,l,c,s,u,d;return(0,tu.Jh)(this,function(h){switch(h.label){case 0:switch(n.type){case ri.aq.UNKNOWN_NOT_GIT:return[3,1];case ri.aq.UNKNOWN:return[3,2];case ri.aq.CHANNEL_CLOSED:return[3,3];case ri.aq.NOT_INITIALIZED:return[3,4];case ri.aq.UNAUTHENTICATED:return[3,5];case ri.aq.INDEX_FILE_CORRUPT:return[3,7];case ri.aq.UNKNOWN_REMOTE:return[3,8];case ri.aq.INDEX_LOCKED:return[3,9];case ri.aq.NO_COMMITS:return[3,10];case ri.aq.PATH_MATCHED_NO_FILES:return[3,11];case ri.aq.USER_NOT_CONFIGURED:return[3,12];case ri.aq.INVALID_REFERENCE:return[3,13];case ri.aq.BRANCH_ALREADY_EXISTS:return[3,14];case ri.aq.MERGE_CONFLICT:return[3,15];case ri.aq.UPSTREAM_NOT_SET:return[3,16];case ri.aq.HEAD_DETACHED:return[3,17];case ri.aq.DIRTY_WORKTREE:return[3,18];case ri.aq.PROTECTED_BRANCH:return[3,19];case ri.aq.PUSH_REJECTED:return[3,20];case ri.aq.REMOTE_ALREADY_EXISTS:return[3,21];case ri.aq.TIMEOUT:return[3,22];case ri.aq.ALREADY_INITIALIZED:return[3,23]}return[3,24];case 1:return t="Unknown error from the Git service. This is probably a bug in the app.",r=null,[3,25];case 2:return t="There was an unrecognized fatal error with Git. This is probably a bug in the app.",r=null,[3,25];case 3:return t="The command was interrupted. Please try again.",r=null,[3,25];case 4:return t="There isn't a Git repository in the Repl's root directory.",r=null,[3,25];case 5:return[4,e.getRemotes()];case 6:if((i=h.sent()).error)return[2,i];if(0!==i.remotes.size){o=!1,a=!0,l=!1,c=void 0;try{for(s=i.remotes.values()[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)if(d=u.value,rp(d)){o=!0;break}}catch(e){l=!0,c=e}finally{try{a||null==s.return||s.return()}finally{if(l)throw c}}if(o){if(ru(e))return t="Failed to authenticate with the remote. Please ensure that Replit has access to this repository on GitHub.",r=(0,f.tZ)(rd,{label:"Update GitHub Repository Access",callback:n.dismiss,allowReconnect:!0}),[3,25];return t="Failed to authenticate with the remote. You have not connected your Replit account to GitHub, so Replit may not have access to the remote repository. Please connect your account to GitHub and try again.",r=(0,f.tZ)(rd,{label:"Connect to GitHub",callback:n.dismiss,allowReconnect:!0}),[3,25]}}return t="Failed to authenticate with the remote.",r=null,[3,25];case 7:return t="The Git index file is corrupt. This can happen if the index file is manually edited, or if the Git repository is corrupted.",r=null,[3,25];case 8:return t="The remote specified isn't configured.",r=null,[3,25];case 9:return t="Git tried to perform an action but the index lockfile still exists. This means Git either crashed previously or is still running an action.",r=null,[3,25];case 10:return t="There are no commits in the repository.",r=null,[3,25];case 11:return t="The path specified didn't match any files.",r=null,[3,25];case 12:return t="There isn't any user information configured for Git.",r=null,[3,25];case 13:return t="An unknown/invalid reference was specified. This is usually a branch, but it could be something else, such as a tag.",r=null,[3,25];case 14:return t="The branch specified already exists.",r=null,[3,25];case 15:return t="There was an unexpected merge conflict.",r=null,[3,25];case 16:return t="The upstream branch isn't set.",r=null,[3,25];case 17:return t="The HEAD is detached. You have a commit checked out, not a branch.",r=null,[3,25];case 18:return t="There are uncommitted changes.",r=null,[3,25];case 19:return t="This operation cannot be performed on a protected branch.",r=null,[3,25];case 20:return t="The push was rejected by the remote. This is usually because the remote has commits that aren't in the local repository.",r=null,[3,25];case 21:return t="The remote specified already exists.",r=null,[3,25];case 22:return t="The remote operation timed out.",r=null,[3,25];case 23:return t="There is already a Git repository in the Repl's root directory.",r=null,[3,25];case 24:return t="We ran into an unknown error that we don't have a description for. This is probably a bug with the app.",r=null,[3,25];case 25:return[2,{description:t,remedies:r,error:null}]}})}),function(e){return t.apply(this,arguments)}),[n],{refresh:!1});if(!r)return(0,f.tZ)(rb,{description:null,remedies:null,error:n});if(r.error)return(0,f.tZ)(rb,{description:"Unknown error from the Git service. This is probably a bug in the app.",remedies:null,error:n});var i=r.description,o=r.remedies;return(0,f.tZ)(rb,{description:i,remedies:o,error:n})}var rZ=(0,b.X)({errorNotification:[{pointerEvents:"all"},x.l0.p(1),x.l0.backgroundColor.accentNegativeDimmer,x.l0.borderRadius(8),x.l0.shadow(3)],header:[x.l0.py(4),x.l0.px(8),x.l0.display.flex,x.l0.flex.row,x.l0.align.center,x.l0.justify.spaceBetween,x.l0.color.accentNegativeStrongest],headerText:[x.l0.rowWithGap(4),x.l0.align.center],errorType:[x.l0.font.code,{opacity:.75}],body:[x.l0.pt(4),x.l0.pb(8),x.l0.px(8),x.l0.colWithGap(8),x.l0.backgroundColor.backgroundHigher,x.l0.borderRadius(0,0,8,8)]});function rx(e){var t=e.error;return(0,f.BX)(y.G,{css:rZ.errorNotification,children:[(0,f.BX)(y.G,{css:rZ.header,children:[(0,f.BX)(y.G,{css:rZ.headerText,children:[(0,f.tZ)(rn.Z,{}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:function(e){switch(e.type){case ri.aq.UNKNOWN_NOT_GIT:return"Unknown Error";case ri.aq.UNKNOWN:return"Unknown Git Error";case ri.aq.NOT_INITIALIZED:case ri.aq.UNAUTHENTICATED:case ri.aq.INDEX_FILE_CORRUPT:case ri.aq.UNKNOWN_REMOTE:case ri.aq.INDEX_LOCKED:case ri.aq.NO_COMMITS:case ri.aq.PATH_MATCHED_NO_FILES:case ri.aq.USER_NOT_CONFIGURED:case ri.aq.INVALID_REFERENCE:case ri.aq.BRANCH_ALREADY_EXISTS:case ri.aq.MERGE_CONFLICT:case ri.aq.HEAD_DETACHED:case ri.aq.DIRTY_WORKTREE:case ri.aq.PUSH_REJECTED:case ri.aq.PROTECTED_BRANCH:case ri.aq.REMOTE_ALREADY_EXISTS:case ri.aq.ALREADY_INITIALIZED:case ri.aq.TIMEOUT:return"Git Error";default:return"Unknown Error"}}(t)})]}),(0,f.tZ)(g.xv,{css:rZ.errorType,multiline:!1,children:t.type})]}),(0,f.tZ)(y.G,{css:rZ.body,children:(0,f.tZ)(rw,{error:t})})]})}var rC=(0,b.X)({errorList:[{pointerEvents:"none"},{transition:"background-color 100ms"},x.l0.position.absolute,x.l0.top(0),x.l0.bottom(0),x.l0.left(0),x.l0.right(0),x.l0.p(8),x.l0.colWithGap(16),x.l0.zIndex(10)]});function rS(){var e=(0,t2.Dv)(t6,{store:t3()});return(0,f.tZ)(y.G,{style:{backgroundColor:e.length>0?"rgba(0, 0, 0, 0.25)":"transparent"},css:rC.errorList,children:e.map(function(e){return(0,f.tZ)(rx,{error:e},e.id)})})}function rk(){return(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Unsupported state: you are applying a mailbox patch."}),(0,f.tZ)(g.xv,{multiline:!1,children:"Please finish the patch manually."})]})}function r_(){return(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a bisect."}),(0,f.tZ)(g.xv,{multiline:!1,children:"Please finish the bisect manually."})]})}var rE=n(49344),rT=n(37951),rR=n(59811),rI=(0,b.X)({modalContainer:[x.l0.colWithGap(24)],statusText:[x.l0.display.flex,x.l0.flex.row,x.l0.textAlign.left],settingsButton:[x.l0.reset.button,x.l0.linkStyle,x.l0.fontWeight.medium,x.l0.textAlign.left,x.l0.ml(4)]}),rD=function(e){var t=e.onViewSettingsClick;return(0,f.tZ)("button",{css:rI.settingsButton,onClick:t,children:"Settings view."})};function rG(e){var t,n,r=e.branch,i=e.onViewSettingsClick,o=(0,u._)((0,_.useState)(!1),2),a=o[0],l=o[1],c=(0,u._)((0,_.useState)(!1),2),s=c[0],d=c[1],h=(0,u._)((0,_.useState)(null),2),p=h[0],m=h[1],v=(0,u._)((0,_.useState)(!1),2),b=v[0],w=v[1],x=t9(),S=(0,C.Z)().git,k=(0,td.Z)((t=(0,ts._)(function(e){var t,n,r,i,o,a,l,c;return(0,tu.Jh)(this,function(s){switch(s.label){case 0:return[4,e.isInitialized()];case 1:if((t=s.sent()).error)return x(t.error),th({context:"publish-branch-button-initialized",gitService:e,result:t}),[2,{remote:null,error:t.error}];if(!t.initialized)return[2,{remote:null,error:null}];return[4,e.getRemotes()];case 2:if((n=s.sent()).error)return th({context:"publish-branch-button-get-remotes",gitService:e,result:n}),x(n.error),[2,n];return r=n.remotes,i="",(null==r?void 0:r.size)&&(i=r.has("origin")?"origin":r.keys().next().value),[4,e.status()];case 3:if((o=s.sent()).error)return x(o.error),th({context:"publish-branch-button-status",gitService:e,result:o}),[2,o];if(!(o.branch&&i))return[3,5];return a=(0,rf.C)(o.branch),l="refs/remotes/".concat(i,"/").concat(a),[4,e.branchExists(l)];case 4:(c=s.sent()).error?(th({context:"publish-branch-button-branch-exists",gitService:e,result:c,data:{upstream:a,fullRemoteRef:l}}),x(c.error)):c.exists&&m("".concat(i,"/").concat(a)),s.label=5;case 5:return[2,{remote:i,error:null}]}})}),function(e){return t.apply(this,arguments)}),[x],{keepStaleResult:!1});if((0,_.useEffect)(function(){function e(){return(e=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(!(b&&p))return[3,2];return[4,S.setBranchUpstream({upstream:p})];case 1:(e=t.sent()).error&&(th({context:"publish-branch-button-set-branch-upstream",gitService:S,result:e,data:{upstream:p}}),x(e.error)),w(!1),m(null),t.label=2;case 2:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[S,x,b,p]),null==k?void 0:k.error)return null;var E=k?k.remote:null,T=null===E,R=r.type!==t1.HO.LOCAL||!E||b;function I(){return(I=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(!E||a)return[2];if(p)return d(!0),[2];return l(!0),[4,S.push({publish:{remote:E}})];case 1:return(e=t.sent()).error?(l(!1),x(e.error),th({context:"publish-branch-button-push",gitService:S,result:e,data:{remote:E}})):(S.forceRefresh(),nx("branch-published-to-remote")),[2]}})})).apply(this,arguments)}var D="".concat(E,"/").concat(r.name);return n=a?"Pushing to '".concat(D,"'..."):r.type!==t1.HO.LOCAL?"Branch has already been pushed to '".concat(D,"'"):T?"Checking if branch ".concat(r.name," can be pushed..."):E?"Push branch as '".concat(D,"'"):"No remotes to push to",(0,f.BX)(f.HY,{children:[p?(0,f.tZ)(rE.u,{isOpen:s,onRequestClose:function(){return d(!1)},children:(0,f.BX)(y.G,{css:rI.modalContainer,children:[(0,f.tZ)(g.xv,{variant:"headerDefault",children:"Branch already exists"}),(0,f.tZ)(g.xv,{children:"Upstream branch '".concat(p,"' already exists.\n          To push the branch, please confirm you would like to set upstream branch to it.")}),(0,f.tZ)(W.zx,{text:"Set upstream to '".concat(p,"'"),onClick:function(){p&&(w(!0),d(!1))}})]})}):null,T||E?null:(0,f.tZ)(rT.E,{text:(0,f.tZ)(y.G,{css:rI.statusText,children:(0,f.BX)("span",{children:["No remote repositories configured. To push your changes, add a remote repository in the",(0,f.tZ)(rD,{onViewSettingsClick:i})]})}),colorway:"warning",closable:!1}),(0,f.tZ)(W.zx,{text:n,iconLeft:T||a?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(rR.Z,{}),onClick:function(){return I.apply(this,arguments)},loading:T||a,disabled:R})]})}var rB=n(70002),rP=n(44620),rA=(0,b.X)({remoteUrl:[{border:"none"},x.l0.height("auto"),x.l0.py(4),x.l0.px(8)]});function rN(e){var t=e.branch,n=e.remotes,r=(0,u._)((0,_.useMemo)(function(){if(t.type===t1.HO.LOCAL)return[null,null,null];var e=n.get(t.remote);if(!e)return[null,null,null];var r=rv(e),i=rg(e),o=rp(r);return[r,i,o]},[t,n]),3),i=r[0],o=r[1],a=r[2];return i&&o?(0,f.tZ)(rB.Z,{css:rA.remoteUrl,text:o,href:i,target:"_blank",iconLeft:a?(0,f.tZ)(rc.Z,{}):void 0,iconRight:(0,f.tZ)(rP.Z,{}),variant:"outlined",size:"small"}):null}var rL=n(65260),rU=n(6620),rO=(0,b.X)({warning:[x.l0.align.start],header:[x.l0.fontWeight.bold]});function rM(){return(0,f.BX)(f.HY,{children:[(0,f.tZ)(rT.E,{css:rO.warning,icon:(0,f.tZ)(rn.Z,{}),colorway:"warning",text:(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{css:rO.header,children:"Can't push or pull from GitHub"}),(0,f.tZ)("br",{}),(0,f.tZ)("span",{children:"This Repl has a GitHub repository as a remote, but you are not connected to GitHub."})]})}),(0,f.tZ)(rd,{})]})}var rX=n(2447),rF=(0,b.X)({text:[x.l0.flex.shrink(1)]});function rW(e){var t=e.date,n=(0,u._)((0,_.useState)(null),2),r=n[0],i=n[1];return((0,_.useEffect)(function(){if(t){var e=function(){var e=new Date,n="just now";e.getTime()-t.getTime()>6e4&&(n=(0,rX.Z)(t,e,{addSuffix:!0})),i(n=n.replace(/minutes?/,"min"))};e();var n=setInterval(e,6e4);return function(){clearInterval(n),i(null)}}},[t]),r)?(0,f.BX)(g.xv,{css:rF.text,color:"dimmest",variant:"small",multiline:!1,children:["last fetched ",r]}):null}var rH=n(91075);function rV(e){var t=e.hasRemoteMergeConflict,n=e.hasUnpulledCommits,r=e.hasUnpushedCommits,i=e.workTreeDirty,o=[];return i&&n&&o.push("Can't pull: you have uncommitted changes"),t&&(n||r)&&(n&&r?(i||o.push("Warning: pulling will start a merge with conflicts"),o.push("Can't push: unpulled changes must be merged first")):n?i||o.push("Warning: pulling will start a merge with conflicts"):r&&o.push("Can't push: merge conflict with remote")),(0,f.tZ)(f.HY,{children:o.map(function(e){return(0,f.tZ)(rT.E,{text:e,colorway:"warning",icon:(0,f.tZ)(rn.Z,{})},e)})})}var rz=(0,b.X)({divider:[x.l0.mx(8)]});function rj(e){var t=e.ahead,n=e.behind;if(!t&&!n)return(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"Nothing to pull or push"});var r=null,i=null;if(n){var o=(0,em.Z)("commit",n);r="".concat(n," ").concat(o," to pull")}if(t){var a=(0,em.Z)("commit",t);i="".concat(t," ").concat(a," to push")}return(0,f.BX)(g.xv,{color:"dimmer",variant:"small",multiline:!1,children:[r?(0,f.tZ)("span",{children:r}):null,r&&i?(0,f.tZ)("span",{css:rz.divider,children:""}):null,i?(0,f.tZ)("span",{children:i}):null]})}var rq=(0,b.X)({container:[x.l0.flex.grow(1)],branch:[x.l0.mr(4),x.l0.color.foregroundDefault,x.l0.fontWeight.medium,{"&:hover":{textDecoration:"underline"}}],divider:[x.l0.color.foregroundDimmest],text:[x.l0.ml(4),x.l0.color.foregroundDimmest]});function rY(e){var t=e.upstream,n=e.remotes,r=(0,_.useMemo)(function(){return function(e,t){var n=null,r=null;if(e instanceof Map){var i=(0,rf.Tg)(t),o=i[0];if(n=i[1],!o||!n)return null;var a=e.get(o);if(!a)return null;r=rv(a)}else n=t,r=rv(e);return r&&rp(r)?"".concat(r,"/tree/").concat(n):null}(n,t)},[t,n]);return(0,f.BX)(g.xv,{css:rq.container,variant:"small",multiline:!1,children:[r?(0,f.tZ)("a",{css:rq.branch,href:r,target:"_blank",children:t}):(0,f.tZ)("span",{css:rq.branch,children:t}),(0,f.tZ)("span",{css:rq.divider,children:""}),(0,f.tZ)("span",{css:rq.text,children:"upstream"})]})}var rJ=(0,b.X)({container:[x.l0.borderRadius(8)],loading:[x.l0.height(64),ev.p.backgroundPulse(),x.l0.borderRadius(8)],header:[x.l0.py(4),x.l0.px(8),x.l0.rowWithGap(8),x.l0.align.center,x.l0.flex.shrink(1),x.l0.border({color:x.TV.outlineDimmer,direction:"bottom"})],fetch:{border:"none"},body:[x.l0.px(8),x.l0.pt(8),x.l0.pb(12),x.l0.colWithGap(8)],buttons:[x.l0.rowWithGap(8),x.l0.flex.grow(1)],sync:[x.l0.flex.grow(1)],pullPush:[x.l0.flex.row],pull:[x.l0.pr(12),x.l0.borderRadius(8,0,0,8),x.l0.border({color:x.TV.outlineDefault,direction:"right"})],push:[x.l0.borderRadius(0,8,8,0)]});function rK(e){return r$.apply(this,arguments)}function r$(){return(r$=(0,ts._)(function(e){var t,n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:return t=null,[4,Promise.race([e,new Promise(function(e){return t=setTimeout(function(){tf.$e(function(e){e.setTag("gitPane",!0),tf.Tb(Error("Remote update operation timed out"))}),e({error:ri.aq.TIMEOUT})},9e4)})])];case 1:return n=r.sent(),t&&clearTimeout(t),[2,n]}})})).apply(this,arguments)}function rQ(e){var t,n=e.remotes,r=e.gotoPendingState,i=(0,u._)((0,_.useState)(!1),2),o=i[0],a=i[1],l=(0,u._)((0,_.useState)(!1),2),c=l[0],s=l[1],d=(0,u._)((0,_.useState)(!1),2),h=d[0],p=d[1],m=(0,u._)((0,_.useState)(!1),2),v=m[0],g=m[1],b=(0,C.Z)().git,x=(0,td.Z)((t=(0,ts._)(function(e){var t,n,r,i,o,a,l,c,s,u,d,f,h,p,m,v,g,y;return(0,tu.Jh)(this,function(b){switch(b.label){case 0:return i={upstream:null,hasUnpulledCommits:!1,hasUnpushedCommits:!1,hasRemoteMergeConflict:!1,pullMode:rH.T.FF_ONLY,canPull:!1,canPush:!1,workTreeDirty:!1,needGitHubConnection:!1,ahead:0,behind:0,lastFetched:null},[4,e.getRepositoryState()];case 1:if((o=b.sent()).error)return[2,o];if(a=o.state,o.type!==t0.y5.NORMAL)return[2,{error:ri.aq.INVALID_STATE}];return(a===t0.yG.DIRTY_WORKTREE||a===t0.yG.DIRTY_INDEX)&&(i.workTreeDirty=!0),[4,e.status()];case 2:if((l=b.sent()).error)return[2,l];if(c=l.branch,s=null===(t=l.upstream)||void 0===t?void 0:t.branch,d=null!==(u=null===(n=l.upstream)||void 0===n?void 0:n.ahead)&&void 0!==u?u:0,h=null!==(f=null===(r=l.upstream)||void 0===r?void 0:r.behind)&&void 0!==f?f:0,!c)return[2,{error:ri.aq.HEAD_DETACHED}];if(i.ahead=d,i.behind=h,!s)return[3,7];return i.upstream=s,i.hasUnpulledCommits=h>0,i.hasUnpushedCommits=d>0,[4,e.lastFetched()];case 3:if((p=b.sent()).error)return[2,p];return i.lastFetched=p.lastFetched,[4,e.canMergeBranches(c,s)];case 4:if((m=b.sent()).error)return[2,m];if(m.canMerge||(i.hasRemoteMergeConflict=!0),e.hasProfile(ri.rG.GITHUB))return[3,6];if(!(v=(0,nl.CH)(s)))return[2,{error:ri.aq.INVALID_REFERENCE}];return[4,e.getRemotes()];case 5:if((g=b.sent()).error)return[2,g];if(!(y=g.remotes.get(v)))return[2,{error:ri.aq.INVALID_REFERENCE}];rp(y)&&(i.needGitHubConnection=!0),b.label=6;case 6:i.workTreeDirty||i.needGitHubConnection||(i.canPull=!0),!i.hasUnpushedCommits||i.hasUnpulledCommits||i.needGitHubConnection||(i.canPush=!0),d>0&&(i.pullMode=i.hasRemoteMergeConflict?rH.T.MERGE:rH.T.REBASE),b.label=7;case 7:return[2,(0,O._)((0,U._)({},i),{error:null})]}})}),function(e){return t.apply(this,arguments)})),S=t9();if((0,_.useEffect)(function(){(null==x?void 0:x.error)&&S(x.error)},[null==x?void 0:x.error,S]),!x)return(0,f.tZ)(H.Tg,{css:rJ.loading,elevated:!0});if(x.error||!x.upstream)return null;var k=x.upstream,E=x.hasUnpulledCommits,T=x.hasUnpushedCommits,R=x.hasRemoteMergeConflict,I=x.pullMode,D=x.canPull,G=x.canPush,B=x.workTreeDirty,P=x.needGitHubConnection,A=x.ahead,N=x.behind,L=x.lastFetched;if(P)return(0,f.BX)(H.Tg,{css:rJ.container,elevated:!0,children:[(0,f.BX)(y.G,{css:rJ.header,children:[(0,f.tZ)(rY,{upstream:k,remotes:n}),(0,f.tZ)(W.zx,{css:rJ.fetch,text:"Fetch",iconLeft:(0,f.tZ)(n1.Z,{}),disabled:!0,variant:"outlined",size:"small"})]}),(0,f.tZ)(y.G,{css:rJ.body,children:(0,f.tZ)(rM,{})})]});var M=o||c||h||v,X=!k||P||M,F=!D||M,V=!G||M,z=!D&&!G||R||M;function j(){return(j=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(X)return[2];return a(!0),[4,rK(b.fetch())];case 1:return e=t.sent(),b.forceRefresh(),a(!1),e.error?S(e.error):nx("remote-fetched"),[2]}})})).apply(this,arguments)}function q(){return(q=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(F)return[2];return s(!0),[4,rK(b.pull({mode:I,allowConflicts:!0}))];case 1:return e=t.sent(),s(!1),e.error?S(e.error):(e.hasConflicts&&r(),b.forceRefresh(),nx("upstream-pulled")),[2]}})})).apply(this,arguments)}function Y(){return(Y=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(V)return[2];return p(!0),[4,rK(b.push())];case 1:return e=t.sent(),b.forceRefresh(),p(!1),e.error?S(e.error):nx("upstream-pushed"),[2]}})})).apply(this,arguments)}function J(){return(J=(0,ts._)(function(){var e,t;return(0,tu.Jh)(this,function(n){switch(n.label){case 0:if(z)return[2];if(g(!0),!D)return[3,2];return[4,rK(b.pull({mode:I}))];case 1:if((e=n.sent()).error)return S(e.error),g(!1),[2];nx("upstream-pulled"),n.label=2;case 2:if(!G)return[3,4];return[4,b.push()];case 3:if((t=n.sent()).error)return S(t.error),g(!1),[2];nx("upstream-pushed"),n.label=4;case 4:return b.forceRefresh(),g(!1),[2]}})})).apply(this,arguments)}return(0,f.BX)(H.Tg,{css:rJ.container,elevated:!0,children:[(0,f.BX)(y.G,{css:rJ.header,children:[(0,f.tZ)(rY,{upstream:k,remotes:n}),(0,f.tZ)(rW,{date:L}),(0,f.tZ)(W.zx,{css:rJ.fetch,text:"Fetch",iconLeft:o?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(n1.Z,{}),onClick:function(){return j.apply(this,arguments)},loading:o,disabled:X,variant:"outlined",size:"small"})]}),(0,f.BX)(y.G,{css:rJ.body,children:[(0,f.tZ)(rV,{hasRemoteMergeConflict:R,hasUnpulledCommits:E,hasUnpushedCommits:T,workTreeDirty:B}),(0,f.tZ)(rj,{ahead:A,behind:N}),(0,f.BX)(y.G,{css:rJ.buttons,children:[(0,f.tZ)("div",{css:rJ.sync,children:(0,f.tZ)(ta.u,{tooltip:"Pull & push the latest changes",children:(0,f.tZ)(W.zx,{css:rJ.sync,text:"Sync with Remote",iconLeft:v?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(rL.Z,{rotate:90}),onClick:function(){return J.apply(this,arguments)},loading:v,disabled:z,size:"small"})})}),(0,f.BX)(y.G,{css:rJ.pullPush,children:[(0,f.tZ)(W.zx,{css:rJ.pull,text:"Pull",iconLeft:c?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(w.Z,{}),onClick:function(){return q.apply(this,arguments)},loading:c,disabled:F,size:"small"}),(0,f.tZ)(W.zx,{css:rJ.push,text:"Push",iconLeft:h?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(rU.Z,{}),onClick:function(){return Y.apply(this,arguments)},loading:h,disabled:V,size:"small"})]})]})]})]})}var r0=n(24890),r1=n(64992),r2=(0,b.X)({path:[x.l0.rowWithGap(8),x.l0.flex.growAndShrink(1),x.l0.align.center],source:[x.l0.color.foregroundDimmest],sourceArrow:[x.l0.mx(8)]});function r8(e){var t=e.path,n=e.prefix,r=e.source,i=e.onClick;return(0,f.BX)(y.G,{css:r2.path,children:[(0,f.tZ)(v.Z,{path:t}),(0,f.BX)(g.xv,{multiline:!1,children:[(0,f.tZ)(nA,{path:t,prefix:n,onClick:i}),r?(0,f.BX)("span",{css:r2.source,children:[(0,f.tZ)("span",{css:r2.sourceArrow,children:""}),(0,f.tZ)(nA,{path:r})]}):null]})]})}var r4=(0,b.X)({container:[x.l0.colWithGap(8)],buttons:[x.l0.rowWithGap(8),x.l0.justify.end],restoringBoth:[x.l0.colWithGap(12)],listContainer:[x.l0.colWithGap(4)],list:[x.l0.px(4),x.l0.colWithGap(2)]});function r3(e){var t=e.show,n=e.files,r=e.pathMap,i=e.callback,o=(0,eY.Z)(i),a=(0,_.useCallback)(function(){var e;null===(e=o.current)||void 0===e||e.call(o,!0)},[o]),l=(0,_.useCallback)(function(){var e;null===(e=o.current)||void 0===e||e.call(o,!1)},[o]);return(0,f.tZ)(rE.u,{isOpen:t,onRequestClose:l,children:t?(0,f.BX)(y.G,{css:r4.container,children:[(0,f.BX)(g.h4,{level:2,children:["Discard ",(0,em.Z)("Change",n.length)]}),(0,f.tZ)(r5,{files:n,pathMap:r}),(0,f.BX)(y.G,{css:r4.buttons,children:[(0,f.tZ)(W.zx,{text:"Cancel",iconLeft:(0,f.tZ)(r0.Z,{}),onClick:l}),(0,f.tZ)(W.zx,{text:"Discard ".concat((0,em.Z)("Change",n.length)),iconLeft:(0,f.tZ)(r1.Z,{}),colorway:"negative",onClick:a})]})]}):null})}function r5(e){var t=e.files,n=e.pathMap,r=[],i=[],o=!0,a=!1,l=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;u.type.worktree===e2.h.UNTRACKED?i.push(u):r.push(u)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return!r.length&&i.length?(0,f.BX)(y.G,{css:r4.listContainer,children:[(0,f.tZ)(g.xv,{children:1===i.length?"Do you want to permanently delete this file?":"Do you want to permanently delete these files?"}),(0,f.tZ)(r6,{files:i,pathMap:n})]}):r.length&&!i.length?(0,f.BX)(y.G,{css:r4.listContainer,children:[(0,f.tZ)(g.xv,{children:1===r.length?"Do you want to undo the changes to this file?":"Do you want to undo the changes to these files?"}),(0,f.tZ)(r6,{files:r,pathMap:n})]}):(0,f.BX)(y.G,{css:r4.restoringBoth,children:[r.length?(0,f.BX)(y.G,{css:r4.listContainer,children:[(0,f.BX)(g.h4,{level:3,children:["Tracked ",(0,em.Z)("File",r.length)]}),(0,f.tZ)(g.xv,{multiline:!1,children:1===r.length?"This file will have its changes undone.":"These files will have their changes undone."}),(0,f.tZ)(r6,{files:r,pathMap:n})]}):null,i.length?(0,f.BX)(y.G,{css:r4.listContainer,children:[(0,f.BX)(g.h4,{level:3,children:["Untracked ",(0,em.Z)("File",i.length)]}),(0,f.tZ)(g.xv,{multiline:!1,children:1===i.length?"This file will be permanently deleted.":"These files will be permanently deleted."}),(0,f.tZ)(r6,{files:i,pathMap:n})]}):null]})}function r6(e){var t=e.files,n=e.pathMap,r=(0,_.useMemo)(function(){return t.length>20?t.slice(0,20):t},[t]);return(0,f.tZ)(y.G,{children:(0,f.BX)("ul",{css:r4.list,children:[r.map(function(e){var t;return(0,f.tZ)("li",{children:(0,f.tZ)(r8,{path:e.path,prefix:n.get(e.path),source:null===(t=e.source)||void 0===t?void 0:t.path})},e.path)}),t.length<=20?null:(0,f.tZ)("li",{children:(0,f.BX)(g.xv,{color:"dimmer",children:["... ",t.length-20," more"," ",(0,em.Z)("file",t.length-20)]})})]})})}function r9(e){var t=(0,u._)((0,_.useState)(function(){return{show:!1,files:[]}}),2),n=t[0],r=t[1];return{openRestoreConfirmationModal:(0,_.useCallback)(function(e){return new Promise(function(t){0===e.length&&t(!1),r({show:!0,files:e,callback:function(e){r({show:!1,files:[],callback:void 0}),t(e)}})})},[]),restoreConfirmationModal:(0,_.useMemo)(function(){return(0,f.tZ)(r3,(0,O._)((0,U._)({},n),{pathMap:e}))},[n,e])}}var r7=n(31498),ie=(0,b.X)({actionsIndex:[x.l0.height(24),x.l0.align.center,x.l0.borderRadius(4)],actionsWorktree:[x.l0.height(24),x.l0.flex.row,x.l0.align.center,x.l0.borderRadius(4)],unstage:[x.l0.height(24),x.l0.width(24),x.l0.borderRadius(2)],stage:[x.l0.px(12),x.l0.height(24),x.l0.width(24),x.l0.borderRadius(2)],discard:[x.l0.pl(16),x.l0.pr(12),x.l0.height(24),x.l0.width(24),x.l0.borderRadius(2)],discardIcon:{transform:"scale(0.85)"},divider:[x.l0.height("75%"),x.l0.width(1),x.l0.backgroundColor.outlineStronger]});function it(e){var t=e.file,n=e.list,r=e.stageFiles,i=e.restoreFiles,o=e.disabled,a=void 0!==o&&o,l=(0,u._)((0,_.useState)(!1),2),c=l[0],s=l[1],d=(0,u._)((0,_.useState)(!1),2),h=d[0],p=d[1];function v(){return(v=(0,ts._)(function(){return(0,tu.Jh)(this,function(e){switch(e.label){case 0:if(a)return[2];return s(!0),[4,r({reset:[t.path]})];case 1:return e.sent(),s(!1),[2]}})})).apply(this,arguments)}function g(){return(g=(0,ts._)(function(){return(0,tu.Jh)(this,function(e){switch(e.label){case 0:if(a)return[2];return s(!0),[4,r({add:[t.path]})];case 1:return e.sent(),s(!1),[2]}})})).apply(this,arguments)}function y(){return(y=(0,ts._)(function(){return(0,tu.Jh)(this,function(e){switch(e.label){case 0:if(a||"worktree"!==n)return[2];return p(!0),[4,i(t.path)];case 1:return e.sent(),p(!1),[2]}})})).apply(this,arguments)}return a=a||h||c,"index"===n?(0,f.tZ)(H.Tg,{elevated:!0,css:ie.actionsIndex,children:(0,f.tZ)(m.hU,{css:ie.unstage,alt:"Unstage changes",size:18,tooltipDelay:"long",onClick:function(){return v.apply(this,arguments)},disabled:a,children:c?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(r7.Z,{})})}):(0,f.BX)(H.Tg,{elevated:!0,css:ie.actionsWorktree,children:[(0,f.tZ)(m.hU,{css:ie.discard,alt:"Discard changes",size:18,tooltipDelay:"long",onClick:function(){return y.apply(this,arguments)},disabled:a,children:h?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(r1.Z,{css:ie.discardIcon})}),(0,f.tZ)("div",{css:ie.divider}),(0,f.tZ)(m.hU,{css:ie.stage,alt:"Stage changes",size:18,tooltipDelay:"long",onClick:function(){return g.apply(this,arguments)},disabled:a,children:c?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(na.Z,{})})]})}var ir=(0,b.X)({modifiedFile:[x.l0.py(2),x.l0.rowWithGap(4),x.l0.align.center]});function ii(e){var t,n=e.file,r=e.list,i=e.stageFiles,o=e.restoreFiles,a=e.pathMap,l=e.disabled,c=e.onFilePathClick,s=null==a?void 0:a.get(n.path),u=null===(t=n.source)||void 0===t?void 0:t.path,d="index"===r?n.type.index:n.type.worktree,h=(0,L.Z)(function(){if(d!==e2.h.DELETED)return function(){return c(n.path)}},[n.path,c,d]);return(0,f.BX)(y.G,{css:ir.modifiedFile,children:[(0,f.tZ)(r8,{path:n.path,prefix:s,source:u,onClick:h}),(0,f.tZ)(e4,{type:d}),(0,f.tZ)(it,{file:n,list:r,stageFiles:i,restoreFiles:o,disabled:void 0!==l&&l})]})}var io=(0,b.X)({actions:[x.l0.rowWithGap(2),x.l0.backgroundColor.backgroundHighest,x.l0.borderRadius(8)],buttonDiscard:[x.l0.borderRadius(8,0,0,8)],buttonStage:[x.l0.borderRadius(0,8,8,0)],divider:[x.l0.my(8),x.l0.width(1),x.l0.backgroundColor.outlineStronger]});function ia(e){var t=e.type,n=e.stageFiles,r=e.restoreFiles,i=e.disabled,o=void 0!==i&&i,a=(0,u._)((0,_.useState)(!1),2),l=a[0],c=a[1],s=(0,u._)((0,_.useState)(!1),2),d=s[0],h=s[1];function p(){return m.apply(this,arguments)}function m(){return(m=(0,ts._)(function(){return(0,tu.Jh)(this,function(e){switch(e.label){case 0:if(o)return[2];return c(!0),[4,n({all:"index"!==t})];case 1:return e.sent(),c(!1),[2]}})})).apply(this,arguments)}function v(){return(v=(0,ts._)(function(){return(0,tu.Jh)(this,function(e){switch(e.label){case 0:if(o||"worktree"!==t)return[2];return h(!0),[4,r(!0)];case 1:return e.sent(),h(!1),[2]}})})).apply(this,arguments)}return o=o||d||l,"index"===t?(0,f.tZ)(W.zx,{text:"Unstage All",iconLeft:l?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(r7.Z,{}),onClick:p,disabled:o,loading:l,size:"small"}):(0,f.BX)(y.G,{css:io.actions,children:[(0,f.tZ)(W.zx,{css:io.buttonDiscard,text:"Discard All",iconLeft:d?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(r1.Z,{}),onClick:function(){return v.apply(this,arguments)},disabled:o,loading:d,size:"small"}),(0,f.tZ)("div",{css:io.divider}),(0,f.tZ)(W.zx,{css:io.buttonStage,text:"Stage All",iconLeft:l?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(na.Z,{}),onClick:p,disabled:o,loading:l,size:"small"})]})}var il=(0,b.X)({list:[x.l0.pt(4),x.l0.pb(8),x.l0.colWithGap(4)],listFolded:[x.l0.py(4)],header:[x.l0.px(8),x.l0.rowWithGap(4),x.l0.align.center],headerFoldable:[x.l0.py(4),x.l0.pl(4),x.l0.pr(8),x.l0.rowWithGap(4),x.l0.align.center],headerText:[x.l0.flex.grow(1)],body:[x.l0.px(8),x.l0.maxHeight("25vh"),x.l0.overflowY("auto")]});function ic(e){var t,n=e.files,r=e.type,i=e.stageFiles,o=e.restoreFiles,a=e.onFilePathClick,l=e.pathMap,c=e.foldable,s=void 0!==c&&c,d=e.disabled,h=void 0!==d&&d,p=(0,u._)((0,_.useState)(!1),2),m=p[0],v=p[1],g=(0,_.useRef)(null),b=(0,_.useRef)(null),w=(0,ne.MG)({count:n.length,getScrollElement:function(){return b.current},getItemKey:function(e){return n[e].path},estimateSize:function(){return 28},overscan:20}),Z=w.getVirtualItems();return s&&m?(0,f.tZ)(y.G,{css:il.listFolded,children:(0,f.BX)(y.G,{css:s?il.headerFoldable:il.header,children:[(0,f.tZ)(is,{files:n,type:r,setFolded:v,foldable:!0,folded:!0}),(0,f.tZ)(ia,{type:r,stageFiles:i,restoreFiles:o,disabled:h})]})}):(0,f.BX)(y.G,{innerRef:g,css:il.list,children:[(0,f.BX)(y.G,{css:s?il.headerFoldable:il.header,children:[(0,f.tZ)(is,{files:n,type:r,setFolded:v,foldable:s}),(0,f.tZ)(ia,{type:r,stageFiles:i,restoreFiles:o,disabled:h})]}),(0,f.tZ)(y.K.div,{ref:b,css:il.body,children:(0,f.tZ)("div",{style:{minHeight:w.getTotalSize()},children:(0,f.tZ)("div",{style:{transform:"translateY(".concat(null===(t=Z[0])||void 0===t?void 0:t.start,"px)"),willChange:"transform"},children:Z.map(function(e){var t=n[e.index];return(0,f.tZ)("div",{"data-index":e.index,children:(0,f.tZ)(ii,{file:t,list:r,stageFiles:i,restoreFiles:o,onFilePathClick:a,pathMap:l,disabled:h},t.path)},e.key)})})})})]})}function is(e){var t=e.files,n=e.type,r=e.setFolded,i=e.foldable,o=void 0!==i&&i,a=e.folded,l=(0,em.Z)("file",t.length),c="".concat(t.length," ").concat("index"===n?"staged":"changed"," ").concat(l);return o&&void 0!==a&&a?(0,f.BX)(f.HY,{children:[(0,f.tZ)(m.hU,{alt:"Show list",onClick:function(){return r(!1)},children:(0,f.tZ)(e0.Z,{})}),(0,f.tZ)(g.xv,{css:il.headerText,multiline:!1,children:c})]}):(0,f.BX)(f.HY,{children:[o?(0,f.tZ)(m.hU,{alt:"Hide list",onClick:function(){return r(!0)},children:(0,f.tZ)(e1.Z,{color:x.TV.foregroundDimmest})}):null,(0,f.tZ)(g.xv,{css:il.headerText,color:"dimmest",multiline:!1,children:c})]})}var iu=n(15592),id=[{"& > span:first-child":[x.l0.flex.grow(1),x.l0.textAlign.left]},{"& > span":[x.l0.flex.shrink(1)]}],ih=(0,b.X)({buttonFolded:[id,x.l0.height("auto"),x.l0.py(8),x.l0.fontWeight.medium],buttonUnfolded:[id,x.l0.height("auto"),x.l0.py(8),x.l0.fontWeight.medium,x.l0.border({color:x.TV.outlineDimmer,direction:"bottom"}),x.l0.borderRadius(8,8,0,0)],container:[x.l0.flex.grow(1),x.l0.borderRadius(8)],lists:[x.l0.borderRadius(0,0,8,8)],divider:[x.l0.height(1),x.l0.minHeight(1),x.l0.width("100%"),x.l0.backgroundColor.outlineDimmer],autoStageMessage:[x.l0.pt(4),x.l0.pb(8),x.l0.px(4),x.l0.center],noChangesMessage:[x.l0.py(16),x.l0.px(4),x.l0.center],buttonText:[x.l0.flex.grow(1)],details:[x.l0.rowWithGap(4),x.l0.fontWeight.normal,x.l0.color.foregroundDimmest]});function ip(e){var t,n,r=e.status,i=e.stageFiles,o=e.restoreFiles,a=e.onStagedFileClick,l=e.disabled,c=void 0!==l&&l,s=(0,u._)((0,_.useState)(!1),2),d=s[0],h=s[1],p=(0,u._)((0,_.useState)(!1),2),m=p[0],v=p[1],b=(0,u._)((0,_.useState)(!1),2),w=b[0],Z=b[1],x=(0,_.useMemo)(function(){return(0,iu.w)(r.changes.map(function(e){return e.path}))},[r]),C=(0,u._)((0,_.useMemo)(function(){var e=[],t=[],n=!0,i=!1,o=void 0;try{for(var a,l=r.changes[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;c.staged&&e.push(c),c.type.worktree!==e2.h.UNMODIFIED&&t.push(c)}}catch(e){i=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}return[e,t]},[r.changes]),2),S=C[0],k=C[1],E=S.length>0&&k.length>0,T=r9(x),R=T.openRestoreConfirmationModal,I=T.restoreConfirmationModal,D=(0,_.useCallback)((t=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(!("all"in e))return[3,2];return v(!0),[4,i(e)];case 1:return t.sent(),v(!1),[3,4];case 2:return[4,i(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),[i]),G=(0,_.useCallback)((n=(0,ts._)(function(e){var t,n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:if(!0!==e)return[3,4];return Z(!0),[4,R(k)];case 1:if(!r.sent())return[3,3];return[4,o(e)];case 2:r.sent(),r.label=3;case 3:return Z(!1),[3,8];case 4:if("string"==typeof e){if(!(n=k.find(function(t){return t.path===e})))throw Z(!1),Error("Could not find file in worktree list");t=[n]}else t=k.filter(function(t){return e.includes(t.path)});return[4,R(t)];case 5:if(!r.sent())return[3,7];return[4,o(e)];case 6:r.sent(),r.label=7;case 7:Z(!1),r.label=8;case 8:return[2]}})}),function(e){return n.apply(this,arguments)}),[R,o,k]);return d?(0,f.tZ)(im,{setFolded:h,changeCount:k.length,stagedCount:S.length,disabled:c,folded:!0}):0===S.length&&0===k.length?(0,f.BX)(y.G,{style:{opacity:c?.725:void 0},css:ih.container,children:[(0,f.tZ)(im,{setFolded:h,changeCount:k.length,stagedCount:S.length,disabled:c}),(0,f.tZ)(H.Tg,{css:ih.lists,elevated:!0,children:(0,f.tZ)(y.G,{css:ih.noChangesMessage,children:(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"No changed or staged files."})})})]}):(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,{style:{opacity:c?.725:void 0},css:ih.container,children:[(0,f.tZ)(im,{setFolded:h,changeCount:k.length,stagedCount:S.length,disabled:c}),(0,f.BX)(H.Tg,{css:ih.lists,elevated:!0,children:[0===S.length?null:(0,f.tZ)(ic,{type:"index",files:S,stageFiles:D,restoreFiles:G,onFilePathClick:a,pathMap:x,foldable:E,disabled:c||m||w}),E?(0,f.tZ)("div",{css:ih.divider}):null,0===k.length?null:(0,f.BX)(f.HY,{children:[(0,f.tZ)(ic,{type:"worktree",files:k,stageFiles:D,restoreFiles:G,onFilePathClick:a,pathMap:x,foldable:E,disabled:c||m||w}),E?null:(0,f.tZ)(y.G,{css:ih.autoStageMessage,children:(0,f.tZ)(g.xv,{variant:"small",color:"dimmest",multiline:!1,children:"Committing will automatically stage your changes."})})]})]})]}),I]})}function im(e){var t=e.folded,n=void 0!==t&&t,r=e.setFolded,i=e.changeCount,o=e.stagedCount,a=e.disabled;return(0,f.tZ)(W.zx,{css:n?ih.buttonFolded:ih.buttonUnfolded,text:"Review Changes",secondaryText:(0,f.tZ)(iv,{folded:n,changeCount:i,stagedCount:o}),onClick:function(){return r(!n)},iconRight:n?(0,f.tZ)(e0.Z,{}):(0,f.tZ)(e1.Z,{}),disabled:void 0!==a&&a,size:"small"})}function iv(e){var t=e.folded,n=e.changeCount,r=e.stagedCount;if(!t)return null;var i=n>0,o=r>0;return i||o?(0,f.BX)("span",{css:ih.details,children:[i?(0,f.BX)("span",{children:[n," ",(0,em.Z)("change",n)]}):null,i&&o?(0,f.tZ)("span",{children:"/"}):null,o?(0,f.BX)("span",{children:[r," staged"]}):null]}):(0,f.tZ)("span",{css:ih.details,children:(0,f.tZ)("span",{children:"no changes"})})}var ig=n(43704),iy=n(62340),ib=n(93049),iw=n(46868),iZ=n(74652),ix=n(96003),iC={height:32,width:"100%",resize:"none",border:"none"},iS={width:"100%",resize:"none",border:"none"},ik=(0,b.X)({surface:[x.l0.p(8),x.l0.colWithGap(12),x.l0.borderRadius(0,0,8,8)],button:[x.l0.height("auto"),x.l0.py(8),x.l0.fontWeight.medium,x.l0.borderRadius(8,8,0,0),x.l0.justify.start,x.l0.border({color:x.TV.outlineDimmer,direction:"bottom"}),{"> span:first-child":{flexGrow:1,textAlign:"start"}}],requiredText:[x.l0.display.inlineFlex,x.l0.rowWithGap(4)],subjectField:[x.l0.colWithGap(8)],bodyField:[x.l0.colWithGap(8)],subjectInput:iC,bodyInput:iS,subjectInputDisabled:[iC,{opacity:.5}],bodyInputDisabled:[iS,{opacity:.5}],required:[x.l0.color.accentNegativeStronger],keyCombo:[x.l0.display.inlineFlex,x.l0.rowWithGap(4),x.l0.flex.grow(1),x.l0.align.center],keyComboText:[x.l0.fontWeight.normal,x.l0.color.foregroundDimmest]});function i_(e){var t=e.message,n=e.disabled,r=void 0!==n&&n,i=e.onMessageChange,o=e.onCommitShortcut,a=(0,u._)((0,_.useState)(!0),2),l=a[0],c=a[1],s=(0,u._)((0,_.useState)(!1),2),d=s[0],h=s[1],p=(0,u._)((0,_.useState)(!1),2),m=p[0],v=p[1],g=(0,_.useRef)(null),b=(0,_.useRef)(null),w=(0,M._)(t.split("\n\n")),Z=w[0],x=void 0===Z?"":Z,C=w.slice(1).join("\n\n"),S=(0,iy.d)();function k(e,t){i((e=e.replaceAll("\n"," "))+(t?"\n\n"+t:""))}var E=(0,iZ.gf)(iw.CN.gitCommit.id);return(0,ix.ow)(iw.CT,m),(0,iZ.Il)(function(){return[iw.CN.gitCommit.id,{run:function(){null==o||o()},scope:iw.CT,bubble:!1}]},[o]),(0,f.BX)(y.G,{children:[(0,f.tZ)(W.zx,{css:ik.button,text:(0,f.BX)("span",{css:ik.requiredText,children:[(0,f.tZ)("span",{children:"Message"}),l?(0,f.tZ)(iR,{}):null]}),secondaryText:S||!E?void 0:(0,f.BX)("span",{css:ik.keyCombo,children:[(0,f.tZ)("span",{css:ik.keyComboText,children:"Commit:"}),(0,f.tZ)(iZ.bM,{keyCombo:E,small:!0})]}),iconRight:l?(0,f.tZ)(e0.Z,{}):(0,f.tZ)(e1.Z,{}),onClick:function(){return c(function(e){return!e})},size:"small"}),(0,f.BX)(H.Tg,{css:ik.surface,elevated:!0,children:[(0,f.tZ)(iE,{ref:g,value:x,compact:l,disabled:r,onChange:function(e){k(e,C)},onNewline:function(){if(l)c(!1),h(!0);else{if(!b.current)return;b.current.focus(),b.current.setSelectionRange(0,0)}},onFocus:function(){v(!0)},onBlur:function(){v(!1)}}),l&&!C?null:(0,f.tZ)(iT,{ref:b,value:C,compact:l,disabled:r,onChange:function(e){if(k(x,e),l&&!e){var t;null===(t=g.current)||void 0===t||t.focus()}else l&&c(!1)},onBackspaceWhenEmpty:function(){g.current&&g.current.focus()},onFocus:function(){d&&h(!1),v(!0)},onBlur:function(){v(!1)},autoFocus:d})]})]})}var iE=(0,_.forwardRef)(function(e,t){var n=e.value,r=e.compact,i=e.disabled,o=void 0!==i&&i,a=e.onChange,l=e.onNewline,c=e.onFocus,s=e.onBlur;return(0,f.BX)(y.G,{css:ik.subjectField,children:[void 0!==r&&r?null:(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",multiline:!1,children:(0,f.BX)("span",{css:ik.requiredText,children:[(0,f.tZ)("span",{children:"Summary"}),(0,f.tZ)(iR,{})]})}),(0,f.tZ)(X.B,{ref:t,css:o?ik.subjectInputDisabled:ik.subjectInput,placeholder:"Summary of your commit...",value:n,disabled:o,onChange:function(e){return null==a?void 0:a(e.currentTarget.value)},onKeyDown:function(e){"Enter"!==e.key||e.defaultPrevented||(e.preventDefault(),e.stopPropagation(),null==l||l())},onFocus:c,onBlur:s})]})}),iT=(0,_.forwardRef)(function(e,t){var n=e.value,r=e.compact,i=void 0!==r&&r,o=e.disabled,a=void 0!==o&&o,l=e.autoFocus,c=e.onChange,s=e.onBackspaceWhenEmpty,u=e.onFocus,d=e.onBlur,h=(0,ig.Z)().ref;return(0,f.BX)(y.G,{css:ik.bodyField,children:[i?null:(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",multiline:!1,children:"Description"}),(0,f.tZ)(X.B,{ref:i?t:(0,ib.l)(t,h),css:a?ik.bodyInputDisabled:ik.bodyInput,placeholder:"Description of your commit...",value:n,disabled:a,onChange:function(e){return null==c?void 0:c(e.currentTarget.value)},onKeyDown:function(e){"Backspace"===e.key&&""===n&&(e.preventDefault(),e.stopPropagation(),null==s||s())},onFocus:u,onBlur:d,autoFocus:void 0!==l&&l})]})});function iR(){return(0,f.tZ)(ta.u,{tooltip:"This field is required.",placement:"top",children:(0,f.tZ)("span",{css:ik.required,children:"*"})})}var iI=(0,b.X)({commitArea:[x.l0.colWithGap(8)]});function iD(e){var t=e.status,n=e.onStagedFileClick,r=e.defaultMessage,i=(0,u._)((0,_.useState)(t),2),o=i[0],a=i[1],l=(0,u._)((0,_.useState)(null!=r?r:""),2),c=l[0],s=l[1],d=(0,u._)((0,_.useState)(0),2),h=d[0],p=d[1],m=(0,u._)((0,_.useState)(!1),2),v=m[0],b=m[1],w=t9();(0,_.useEffect)(function(){return a(t)},[t]);var Z=(0,C.Z)().git;if(!o||!o.changes.length)return(0,f.tZ)(y.G,{css:iI.commitArea,children:(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"There are no changes to commit."})});var x=o.changes.length,S=o.changes.filter(function(e){return e.staged}).length;function k(){return(k=(0,ts._)(function(e){var t,n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:if(v)return[2];return p(function(e){return e+1}),[4,Z.stageFiles(e)];case 1:if((t=r.sent()).error)return[3,3];return[4,Z.status()];case 2:return(n=r.sent()).error?(th({context:"commit-area-status",gitService:Z,result:n,data:{opts:e}}),w(n.error)):a(n),Z.forceRefresh(),[3,4];case 3:w(t.error),th({context:"commit-area-stage-files",gitService:Z,result:t,data:{opts:e}}),r.label=4;case 4:return p(function(e){return e-1}),[2]}})})).apply(this,arguments)}function E(){return(E=(0,ts._)(function(e){var t,n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:if(v)return[2];return p(function(e){return e+1}),[4,Z.restoreFiles(e)];case 1:if((t=r.sent()).error)return[3,3];return[4,Z.status()];case 2:return(n=r.sent()).error?(th({context:"commit-area-status",gitService:Z,result:n,data:{files:e}}),w(n.error)):a(n),Z.forceRefresh(),[3,4];case 3:th({context:"commit-area-restore-files",gitService:Z,result:t,data:{files:e}}),w(t.error),r.label=4;case 4:return p(function(e){return e-1}),[2]}})})).apply(this,arguments)}function T(){return R.apply(this,arguments)}function R(){return(R=(0,ts._)(function(){var e,t;return(0,tu.Jh)(this,function(n){switch(n.label){case 0:if(""===c||v||0===x||h>0)return[2];if(b(!0),0!==S)return[3,2];return[4,Z.stageFiles({all:!0})];case 1:n.sent(),n.label=2;case 2:return[4,Z.commit({message:c})];case 3:if(!(e=n.sent()).error)return[3,4];return b(!1),w(e.error),th({context:"commit-area-commit",gitService:Z,result:e,data:{message:c}}),[3,6];case 4:return nx("commit-created",{hasDescription:-1!==c.trim().indexOf("\n\n")}),[4,Z.status()];case 5:t=n.sent(),b(!1),t.error?(w(t.error),th({context:"commit-area-status",gitService:Z,result:t,data:{message:c}})):(s(""),a(t)),Z.forceRefresh(),n.label=6;case 6:return[2]}})})).apply(this,arguments)}var I="Nothing to commit";if(v)I="Committing...";else if(S>0&&S<x){var D=(0,em.Z)("change",S);I="Commit ".concat(S," staged ").concat(D)}else x>0&&(I="Stage and commit all changes");var G=!c||0===x||h>0||v;return(0,f.BX)(y.G,{css:iI.commitArea,children:[(0,f.tZ)(i_,{message:c,disabled:v,onMessageChange:s,onCommitShortcut:T}),(0,f.tZ)(ip,{status:o,stageFiles:function(e){return k.apply(this,arguments)},restoreFiles:function(e){return E.apply(this,arguments)},onStagedFileClick:n,disabled:v}),G?(0,f.tZ)(ta.u,{tooltip:h>0?"Changes in progress":0===x?"There are no changes to commit.":"You must enter a commit message before you can commit.",children:(0,f.tZ)(W.zx,{text:I,onClick:T,disabled:G,loading:v,colorway:"primary",iconLeft:(0,f.tZ)(rl.Z,{}),stretch:!0})}):(0,f.tZ)(W.zx,{text:I,onClick:T,disabled:G,loading:v,colorway:"primary",iconLeft:(0,f.tZ)(rl.Z,{}),stretch:!0})]})}var iG=/\s\(#(\d+)\)$/,iB=/^Revert "(.+)"/,iP=/^This reverts commit ([a-f0-9]+)(?:, reversing changes made to ([a-f0-9]+))?\./;function iA(e){var t=iB.exec(e.subject),n=iP.exec(e.body);if(t&&n){var r,i=n[1],o=t[1],a=iG.exec(o);return a&&(r=parseInt(a[1],10)),{hash:i,subject:o,pr:r}}return null}var iN=/\B#\d+\b/g,iL=/^Merged? pull request (#\d+\b)/,iU=/^Merge branch '(.+)'/,iO=/into (.+)$/;function iM(e){if("GitHub"===e.committer.name&&"noreply@github.com"===e.committer.email){var t=e.subject.match(iN);if(t){var n,r=parseInt(t[t.length-1].slice(1),10);if(r)return iG.test(e.subject)&&(n=e.subject.replace(iG,"").trim()),!n&&iL.test(e.subject)&&e.body&&-1===e.body.indexOf("\n")&&(n=e.body),{type:"pull-request",id:r,subject:n,reverts:iA(e)}}}if(iL.test(e.subject)){var i,o=iL.exec(e.subject);if(o)return e.body&&-1===e.body.indexOf("\n")&&(i=e.body),{type:"pull-request",id:parseInt(o[1].slice(1),10),subject:i,reverts:iA(e)}}if(iU.test(e.subject)){var a=iU.exec(e.subject);if(a){var l=iO.exec(e.subject);return{type:"branch",source:a[1],target:l?l[1]:null}}}return e.parents&&e.parents.length>2?{type:"octopus",parents:e.parents}:e.parents&&e.parents.length>1?{type:"simple",a:e.parents[0],b:e.parents[1]}:null}var iX=n(77615),iF={position:"absolute",top:0,height:9,width:9,border:"1px solid ".concat(x.TV.purpleStrongest),borderRadius:"50%"},iW=(0,b.X)({markerContainer:[x.l0.display.flex,x.l0.align.center,x.l0.justify.center,x.l0.minHeight(20),x.l0.minWidth(20)],commitMarker:[x.l0.height(4),x.l0.width(4),x.l0.backgroundColor.foregroundDefault,x.l0.borderRadius("full")],collapsedMarkerIconDot:[x.l0.height(3),x.l0.width(3),x.l0.backgroundColor.foregroundDimmer,x.l0.borderRadius("full")],collapsedMarkerIconContainer:[x.l0.display.flex,x.l0.align.center,x.l0.justify.center,{"div + div":{marginLeft:1}}],collapsedMarker:[x.l0.display.flex,x.l0.align.center,x.l0.justify.center,x.l0.height(20),x.l0.width(20),x.l0.backgroundColor.backgroundHighest,x.l0.borderRadius("full")],revertMarker:[x.l0.display.flex,x.l0.height(20),x.l0.width(20),x.l0.backgroundColor.orangeDimmest,x.l0.borderRadius("full"),x.l0.align.center,x.l0.justify.center],mergeMarker:[x.l0.display.flex,x.l0.height(20),x.l0.width(20),x.l0.backgroundColor.purpleDimmest,x.l0.borderRadius("full"),x.l0.align.center,x.l0.justify.center],mergeMarkerIconContainer:[x.l0.position.relative,x.l0.height(9),x.l0.width(13)],mergeMarkerIconLeft:[(0,U._)({},iF),x.l0.left(0)],mergeMarkerIconRight:[(0,U._)({},iF),x.l0.right(0)],boundaryMarker:[x.l0.height(6),x.l0.width(6),x.l0.backgroundColor.backgroundDefault,x.l0.borderRadius("full"),{border:"1px solid ".concat(x.TV.backgroundHighest)}]});function iH(e){var t=function(e){switch(e){case"none":default:return null;case"commit":return(0,f.tZ)(iV,{});case"revert":return(0,f.tZ)(iz,{});case"merge":return(0,f.tZ)(ij,{});case"boundary":return(0,f.tZ)(iq,{});case"collapsed":return(0,f.tZ)(iY,{})}}(e.type);return t?(0,f.tZ)("div",{css:iW.markerContainer,children:t}):null}function iV(){return(0,f.tZ)("div",{css:iW.commitMarker})}function iz(){return(0,f.tZ)("div",{css:iW.revertMarker,children:(0,f.tZ)(r1.Z,{size:12,color:x.TV.orangeStrongest})})}function ij(){return(0,f.tZ)("div",{css:iW.mergeMarker,children:(0,f.BX)("div",{css:iW.mergeMarkerIconContainer,children:[(0,f.tZ)("div",{css:iW.mergeMarkerIconLeft}),(0,f.tZ)("div",{css:iW.mergeMarkerIconRight})]})})}function iq(){return(0,f.tZ)("div",{css:iW.boundaryMarker})}function iY(){return(0,f.tZ)("div",{css:iW.collapsedMarker,children:(0,f.BX)("div",{css:iW.collapsedMarkerIconContainer,children:[(0,f.tZ)("div",{css:iW.collapsedMarkerIconDot}),(0,f.tZ)("div",{css:iW.collapsedMarkerIconDot}),(0,f.tZ)("div",{css:iW.collapsedMarkerIconDot})]})})}var iJ=[x.l0.position.absolute,x.l0.left(0),x.l0.width(18)],iK=(0,b.X)({connectorSegmentBorderSolid:[iJ,{borderRight:"1px solid ".concat(x.TV.outlineDimmest)}],connectorSegmentBorderDashed:[iJ,{borderRight:"1px dashed ".concat(x.TV.outlineDimmest)}]});function i$(e){var t=e.boundaryTop,n=void 0!==t&&t,r=e.boundaryBottom,i=void 0!==r&&r,o=e.joint,a=void 0===o?"top":o,l=e.hideTop,c=void 0!==l&&l,s=e.hideBottom,u=void 0!==s&&s;if(c&&u)return null;if(n===i&&!c&&!u)return(0,f.tZ)(i0,{top:0,bottom:0,dashed:n&&i});var d=c?null:(0,f.tZ)(iQ,{start:"top",joint:a,dashed:n}),h=u?null:(0,f.tZ)(iQ,{start:"bottom",joint:a,dashed:i});return(0,f.BX)(f.HY,{children:[d,h]})}function iQ(e){var t,n,r=e.start,i=e.joint,o=e.dashed,a="center"===i?(t={},(0,eP._)(t,r,0),(0,eP._)(t,"height","50%"),t):(n={},(0,eP._)(n,r,0),(0,eP._)(n,r===i?"height":i,8),n);return(0,f.tZ)(i0,(0,O._)((0,U._)({},a),{dashed:void 0!==o&&o}))}function i0(e){var t=e.top,n=e.bottom,r=e.height,i=e.dashed;return(0,f.tZ)("div",{css:void 0!==i&&i?iK.connectorSegmentBorderDashed:iK.connectorSegmentBorderSolid,style:{top:t,bottom:n,height:r}})}var i1=(0,b.X)({container:{position:"relative",marginLeft:30,marginRight:4,paddingLeft:6,userSelect:"none"},containerInteractive:[nn.gU.nofill,{position:"relative",marginLeft:30,marginRight:4,paddingLeft:6,userSelect:"none"}],nodeFoldedIconContainer:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:8,zIndex:1,opacity:0,"div:hover > &":{transition:"opacity 120ms ease-out",opacity:1}},nodeUnFoldedIconContainer:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:8,zIndex:1},nodeContentContainer:[x.l0.colWithGap(4),{position:"relative",paddingTop:8,paddingBottom:8,paddingRight:8}],nodeHeader:{display:"block",height:20},nodeUnfoldedContentSurface:[x.l0.mt(4),x.l0.mb(8),x.l0.p(8),x.l0.borderRadius(8),{marginLeft:36,marginRight:8,overflowX:"hidden"}],unfoldedContentContainer:[x.l0.position.relative]});function i2(e){var t=e.boundaryTop,n=e.boundaryBottom,r=void 0!==n&&n,i=e.hideConnectorTop,o=e.hideConnectorBottom,a=void 0!==o&&o,l=e.joint,c=void 0===l?"top":l,s=e.marker,d=e.header,h=e.unfoldedContent,p=e.children,m=e.className,v=(0,u._)((0,_.useState)(!0),2),g=v[0],b=v[1];return(0,f.BX)(y.G,{className:m,css:x.l0.position.relative,children:[(0,f.tZ)(i$,{boundaryTop:void 0!==t&&t,boundaryBottom:r,joint:c,hideTop:void 0!==i&&i,hideBottom:a}),s?(0,f.tZ)(i4,{joint:c,children:s}):null,h?(0,f.BX)(y.G,{css:i1.containerInteractive,role:"button",tabIndex:0,onClick:function(){b(!g)},onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&b(!g)},children:[g?(0,f.tZ)("div",{css:i1.nodeFoldedIconContainer,children:(0,f.tZ)(e0.Z,{})}):(0,f.tZ)("div",{css:i1.nodeUnFoldedIconContainer,children:(0,f.tZ)(e1.Z,{})}),(0,f.BX)(y.G,{css:i1.nodeContentContainer,children:[d?(0,f.tZ)(y.G,{css:i1.nodeHeader,children:d}):null,p?(0,f.tZ)(y.G,{children:p}):null]})]}):(0,f.tZ)(y.G,{css:i1.container,children:(0,f.BX)(y.G,{css:i1.nodeContentContainer,children:[d?(0,f.tZ)(y.G,{css:i1.nodeHeader,children:d}):null,p?(0,f.tZ)(y.G,{children:p}):null]})}),!h||g?null:(0,f.BX)(y.G,{css:i1.unfoldedContentContainer,children:[a?null:(0,f.tZ)(i0,{top:0,bottom:0,dashed:r}),(0,f.tZ)(H.Tg,{css:i1.nodeUnfoldedContentSurface,elevated:!0,children:h})]})]})}var i8=(0,b.X)({top:{position:"absolute",top:8,left:18,transform:"translateX(-50%)"},bottom:{position:"absolute",bottom:8,left:18,transform:"translateX(-50%)"},center:{position:"absolute",top:"50%",left:18,transform:"translateX(-50%) translateY(-50%)"}});function i4(e){var t=e.joint,n=e.children;return(0,f.tZ)("div",{css:i8[void 0===t?"top":t],children:n})}var i3=(0,b.X)({container:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.justify.spaceBetween,x.l0.height("100%")],textContainer:[x.l0.rowWithGap(4),x.l0.center],text:[x.l0.flex.shrink(0)]});function i5(e){var t=e.text,n=(0,eL._)(e,["text"]);return(0,f.tZ)(i2,(0,U._)({marker:(0,f.tZ)(iH,{type:"boundary"}),joint:"center",header:(0,f.BX)(y.G,{css:i3.container,children:[(0,f.tZ)(nt.R,{}),(0,f.BX)(y.G,{css:i3.textContainer,children:[(0,f.tZ)(iX.Z,{size:12,color:x.TV.foregroundDimmest}),(0,f.tZ)(g.xv,{css:i3.text,variant:"small",color:"dimmest",multiline:!1,children:t})]}),(0,f.tZ)(nt.R,{})]})},n))}var i6=(0,b.X)({definitionList:{display:"grid",gridTemplateColumns:"auto 1fr",paddingLeft:x.TV.space4,"> dt":{display:"flex",alignItems:"center",paddingBottom:x.TV.space2},"> dd":{marginLeft:x.TV.space12,paddingBottom:x.TV.space2}},listHeader:[x.l0.fontWeight.medium],content:[x.l0.colWithGap(8)],description:[x.l0.colWithGap(8)],commitList:[x.l0.colWithGap(2),x.l0.pl(4)]}),i9=function(e,t){var n=!e.body,r=null,i=null;return t&&"type"in t?(r=t,"pull-request"===t.type&&(t.reverts&&(i=t.reverts),t.subject&&(n=!0))):t&&(i=t),{hideBody:n,merge:r,revert:i}},i7=function(e){var t=e.hash;return(0,f.tZ)(e$.m,{size:"small",iconLeft:(0,f.tZ)(z.Z,{}),textToCopy:t,text:t.slice(0,7),tooltip:"Hash copied!"})},oe=function(e){var t=e.onClick,n=e.text,r=e.loading;return(0,f.tZ)(ta.u,{tooltip:"Discard current changes and restore files to time of commit",children:(0,f.tZ)(W.zx,{text:n,onClick:t,size:"small",iconLeft:void 0!==r&&r?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(r1.Z,{})})})},ot=function(e,t){return!(e.name===t.name&&e.email===t.email)},on=function(e,t){return!(6e4>Math.abs(e-t))};function or(e){var t=e.commit,n=e.info,r=ot(t.committer,t.author),i=on(t.author.date,t.committer.date),o=i9(t,void 0===n?null:n),a=o.hideBody,l=o.merge,c=o.revert;return(0,f.BX)(y.G,{css:i6.content,children:[a?null:(0,f.BX)(y.G,{css:i6.description,children:[(0,f.tZ)(g.xv,{children:(0,f.tZ)(nB,{body:t.body})}),(0,f.tZ)(nt.R,{css:x.l0.backgroundColor.outlineDimmer})]}),(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{css:i6.listHeader,multiline:!1,children:"Author"}),(0,f.BX)("dl",{css:i6.definitionList,children:[(0,f.tZ)("dt",{children:"Name:"}),(0,f.tZ)("dd",{children:t.author.name}),(0,f.tZ)("dt",{children:"Email:"}),(0,f.tZ)("dd",{children:t.author.email})]})]}),r?(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{css:i6.listHeader,multiline:!1,children:"Committer"}),(0,f.BX)("dl",{css:i6.definitionList,children:[(0,f.tZ)("dt",{children:"Name:"}),(0,f.tZ)("dd",{children:t.committer.name}),(0,f.tZ)("dt",{children:"Email:"}),(0,f.tZ)("dd",{children:t.committer.email})]})]}):null,(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{css:i6.listHeader,multiline:!1,children:"Commit"}),(0,f.BX)("dl",{css:i6.definitionList,children:[i?(0,f.BX)(f.HY,{children:[(0,f.tZ)("dt",{children:"Authored:"}),(0,f.tZ)("dd",{children:(0,f.tZ)(no.EK,{date:t.author.date,dateFormat:"absolute"})}),(0,f.tZ)("dt",{children:"Committed:"}),(0,f.tZ)("dd",{children:(0,f.tZ)(no.EK,{date:t.committer.date,dateFormat:"absolute"})})]}):(0,f.BX)(f.HY,{children:[(0,f.tZ)("dt",{children:"Date:"}),(0,f.tZ)("dd",{children:(0,f.tZ)(no.EK,{date:t.author.date,dateFormat:"absolute"})})]}),(0,f.tZ)("dt",{children:"Hash:"}),(0,f.tZ)("dd",{children:(0,f.tZ)(i7,{hash:t.hash})}),l&&"pull-request"===l.type?(0,f.BX)(f.HY,{children:[(0,f.tZ)("dt",{children:"PR:"}),(0,f.BX)("dd",{children:["#",l.id]})]}):null,l&&"branch"===l.type?(0,f.BX)(f.HY,{children:[(0,f.tZ)("dt",{children:"Merged:"}),(0,f.tZ)("dd",{children:l.source}),l.target?(0,f.BX)(f.HY,{children:[(0,f.tZ)("dt",{children:"Into:"}),(0,f.tZ)("dd",{children:l.target})]}):null]}):null,c?(0,f.BX)(f.HY,{children:[(0,f.tZ)("dt",{children:"Reverted:"}),(0,f.tZ)("dd",{children:c.hash})]}):null]})]}),l&&"simple"===l.type?(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{css:i6.listHeader,multiline:!1,children:"Merged"}),(0,f.BX)(y.G,{css:i6.commitList,children:[(0,f.tZ)(g.xv,{multiline:!1,children:l.a}),(0,f.tZ)(g.xv,{multiline:!1,children:l.b})]})]}):null,l&&"octopus"===l.type?(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{css:i6.listHeader,multiline:!1,children:"Merged"}),(0,f.tZ)(y.G,{css:i6.commitList,children:l.parents.map(function(e,t){return(0,f.tZ)(g.xv,{multiline:!1,children:e},t)})})]}):null]})}var oi=(0,b.X)({authorContainer:[x.l0.rowWithGap(8),x.l0.align.center],headerText:[x.l0.rowWithGap(4),x.l0.align.center,x.l0.fontWeight.medium],headerContainer:[x.l0.colWithGap(4),x.l0.align.start,x.l0.justify.start],button:[x.l0.reset.button,x.l0.linkStyle,x.l0.color.foregroundDefault,x.l0.fontWeight.medium,{display:"block",width:"100%",textAlign:"left"}]}),oo=function(e){var t=e.author;return(0,f.BX)(y.G,{css:oi.authorContainer,children:[(0,f.tZ)(ny,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,f.tZ)(no.EK,{date:t.date,textColor:"dimmest",textVariant:"small"})]})},oa=function(e){var t=e.children;return(0,f.tZ)(g.xv,{css:oi.headerText,multiline:!1,maxLines:1,children:t})},ol=function(e){var t=e.commit,n=e.onViewCommitClick,r=e.children;return(0,f.tZ)(y.G,{css:oi.headerContainer,children:(0,f.tZ)(ta.u,{tooltip:"View ".concat(t.hash.slice(0,7)),children:(0,f.tZ)("button",{css:oi.button,onClick:function(){return n(t.hash)},children:r})})})};function oc(e){var t=e.commit,n=(0,eL._)(e,["commit"]);return(0,f.tZ)(i2,(0,O._)((0,U._)({marker:(0,f.tZ)(iH,{type:"commit"}),header:(0,f.tZ)(oa,{children:(0,f.tZ)(nG,{subject:t.subject})}),unfoldedContent:(0,f.tZ)(or,{commit:t})},n),{children:(0,f.tZ)(oo,{author:t.author})}))}var os=function(e){var t=e.commit,n=e.onViewCommitClick,r=(0,eL._)(e,["commit","onViewCommitClick"]);return(0,f.tZ)(i2,(0,O._)((0,U._)({marker:(0,f.tZ)(iH,{type:"commit"}),header:(0,f.tZ)(ol,{commit:t,onViewCommitClick:function(){return n(t.hash)},children:(0,f.tZ)(oa,{children:(0,f.tZ)(nG,{subject:t.subject})})})},r),{children:(0,f.tZ)(oo,{author:t.author})}))};function ou(e){var t,n=e.commit,r=e.info,i=(0,eL._)(e,["commit","info"]);return"branch"!==r.type&&(t="pull-request"===r.type&&r.subject?r.subject:n.subject),(0,f.tZ)(i2,(0,O._)((0,U._)({marker:(0,f.tZ)(iH,{type:"merge"}),header:(0,f.BX)(oa,{children:[(0,f.tZ)(nR,{text:"merged"}),(0,f.tZ)(of,{info:r,hash:n.hash,subject:n.subject})]}),unfoldedContent:(0,f.tZ)(or,{commit:n,info:r})},i),{children:(0,f.BX)(y.G,{css:[x.l0.colWithGap(8)],children:[t?(0,f.tZ)(g.xv,{color:"dimmer",variant:"small",multiline:!1,children:(0,f.tZ)(nG,{subject:t})}):null,(0,f.tZ)(oo,{author:n.author})]})}))}var od=function(e){var t,n=e.commit,r=e.info,i=e.onViewCommitClick,o=(0,eL._)(e,["commit","info","onViewCommitClick"]);return"branch"!==r.type&&(t="pull-request"===r.type&&r.subject?r.subject:n.subject),(0,f.tZ)(i2,(0,O._)((0,U._)({marker:(0,f.tZ)(iH,{type:"merge"}),header:(0,f.tZ)(ol,{commit:n,onViewCommitClick:function(){return i(n.hash)},children:(0,f.BX)(oa,{children:[(0,f.tZ)(nR,{text:"merged"}),(0,f.tZ)(of,{info:r,hash:n.hash,subject:n.subject})]})})},o),{children:(0,f.BX)(y.G,{css:[x.l0.colWithGap(8)],children:[t?(0,f.tZ)(g.xv,{color:"dimmer",variant:"small",multiline:!1,children:(0,f.tZ)(nG,{subject:t})}):null,(0,f.tZ)(oo,{author:n.author})]})}))};function of(e){var t=e.info,n=e.hash,r=e.subject,i=(0,f.tZ)("span",{css:x.l0.fontWeight.medium,children:r});switch(t.type){case"pull-request":return(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{children:"pull request"}),(0,f.tZ)(nI,{id:t.id}),t.reverts&&t.reverts.pr?(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{children:"-"}),(0,f.tZ)(nT,{text:"reverts"}),(0,f.tZ)(nI,{id:t.reverts.pr})]}):null]});case"branch":if(!t.target)return(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{children:"branch"}),(0,f.tZ)(nP,{name:t.source})]});return(0,f.BX)(f.HY,{children:[(0,f.tZ)(nP,{name:t.source}),(0,f.tZ)("span",{children:"into"}),(0,f.tZ)(nP,{name:t.target})]});case"simple":return(0,f.BX)(f.HY,{children:[(0,f.tZ)(nD,{hash:t.a}),(0,f.tZ)(rL.Z,{css:{alignSelf:"center"},size:12}),(0,f.tZ)(nD,{hash:t.b})]});case"octopus":return(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{children:"commit"}),(0,f.tZ)(nD,{hash:n}),(0,f.BX)("span",{children:["(",t.parents.length," parents)"]})]});default:return i}}function oh(e){var t=e.commit,n=e.info,r=(0,eL._)(e,["commit","info"]);return(0,f.tZ)(i2,(0,O._)((0,U._)({marker:(0,f.tZ)(iH,{type:"revert"}),header:(0,f.BX)(oa,{children:[(0,f.tZ)(nT,{text:"reverted"}),(0,f.tZ)(nD,{hash:n.hash}),(0,f.tZ)(nG,{subject:n.subject,quoted:!0})]}),unfoldedContent:(0,f.tZ)(or,{commit:t,info:n})},r),{children:(0,f.tZ)(oo,{author:t.author})}))}var op=function(e){var t=e.commit,n=e.info,r=e.onViewCommitClick,i=(0,eL._)(e,["commit","info","onViewCommitClick"]);return(0,f.tZ)(i2,(0,O._)((0,U._)({marker:(0,f.tZ)(iH,{type:"revert"}),header:(0,f.tZ)(ol,{commit:t,onViewCommitClick:function(){return r(t.hash)},children:(0,f.BX)(oa,{children:[(0,f.tZ)(nT,{text:"reverted"}),(0,f.tZ)(nD,{hash:n.hash}),(0,f.tZ)(nG,{subject:n.subject,quoted:!0})]})})},i),{children:(0,f.tZ)(oo,{author:t.author})}))},om=(0,b.X)({body:[x.l0.flex.growAndShrink(1)],virtualItem:[x.l0.position.absolute,x.l0.top(0),x.l0.left(0),x.l0.width("100%"),x.l0.overflow("hidden")],virtualList:[x.l0.position.relative]}),ov=function(){return 60};function og(e){var t=e.items,n=(0,_.useRef)(null),r=(0,ne.MG)({overscan:10,count:t.length,getScrollElement:function(){return n.current},estimateSize:ov});return(0,f.tZ)("div",{ref:n,css:om.body,children:(0,f.tZ)("div",{css:om.virtualList,style:{height:"".concat(r.getTotalSize(),"px")},children:r.getVirtualItems().map(function(e){return(0,f.tZ)("div",{css:om.virtualItem,style:{transform:"translateY(".concat(e.start,"px)")},"data-index":e.index,ref:r.measureElement,children:(0,f.tZ)(oy,{items:t,index:e.index})},e.key)})})})}function oy(e){var t=e.items,n=e.index,r=t[n],i=0===n,o=n===t.length-1;if("boundary"===r.type)return(0,f.tZ)(i5,{text:r.text,hideConnectorTop:i,hideConnectorBottom:o,boundaryTop:!0,boundaryBottom:!0},r.text);var a=t[n-1]?t[n-1].type:null,l=t[n+1]?t[n+1].type:null;return(0,f.tZ)(ob,{commit:r.commit,hideConnectorTop:i,hideConnectorBottom:o,boundaryTop:"commit"!==a,boundaryBottom:"commit"!==l,onViewCommitClick:r.onViewCommitClick},r.commit.hash)}function ob(e){var t=e.commit,n=e.onViewCommitClick,r=(0,eL._)(e,["commit","onViewCommitClick"]),i=iM(t);if(i)return n?(0,f.tZ)(od,(0,U._)({info:i,commit:t,onViewCommitClick:n},r)):(0,f.tZ)(ou,(0,U._)({info:i,commit:t},r));var o=iA(t);return o?n?(0,f.tZ)(op,(0,U._)({info:o,commit:t,onViewCommitClick:n},r)):(0,f.tZ)(oh,(0,U._)({info:o,commit:t},r)):n?(0,f.tZ)(os,(0,U._)({commit:t,onViewCommitClick:n},r)):(0,f.tZ)(oc,(0,U._)({commit:t},r))}var ow=(0,ep.F4)({from:{opacity:0},to:{opacity:1}}),oZ=(0,b.X)({loadingView:[{animation:"".concat(ow," 0.125s 0.25s linear backwards")},x.l0.flex.grow(1),x.l0.display.flex,x.l0.center]});function ox(){return(0,f.tZ)(y.G,{css:oZ.loadingView,children:(0,f.tZ)(Z.Z,{size:48})})}var oC=(0,b.X)({view:[x.l0.pt(4),x.l0.pb(8),x.l0.px(4),x.l0.colWithGap(8),x.l0.flex.grow(1)],sectionContainer:[x.l0.colWithGap(8)],section:[x.l0.pt(8),x.l0.pb(16),x.l0.px(8),x.l0.colWithGap(8),x.l0.border({color:x.TV.outlineDimmest,direction:"bottom"})],remoteUpdatesHeader:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.justify.spaceBetween],reviewChangesHeader:[x.l0.rowWithGap(8),x.l0.align.center],headerText:[x.l0.fontWeight.medium],switchToBranch:[x.l0.p(4),x.l0.flex.row,x.l0.align.center,x.l0.justify.spaceBetween,x.l0.mt(0),x.l0.mb(0)]});function oS(e){var t,n,r,i,o,a=e.status,l=e.remotes,c=e.branch,s=e.onStagedFileClick,h=e.onViewCommitClick,p=e.onViewSettingsClick,m=e.gotoPendingState,v=e.current,b=void 0!==v&&v,w=b?null==a?void 0:null===(i=a.upstream)||void 0===i?void 0:i.behind:void 0,Z=b?null==a?void 0:null===(o=a.upstream)||void 0===o?void 0:o.ahead:void 0,x=(t=t9(),r=(0,td.Z)((n=(0,ts._)(function(e){var t,n,r,i,o,a,l,s,d;return(0,tu.Jh)(this,function(f){switch(f.label){case 0:return[4,e.isInitialized()];case 1:if((t=f.sent()).error)return th({context:"use-branch-commits",gitService:e,result:t}),[2,{error:t.error}];if(!t.initialized)return[2,{log:[],onlyRemote:[],onlyLocal:[],error:null}];if(!c)return[2,{error:null}];if(!(!c.tracking||0===w&&0===Z))return[3,3];return n=(0,nl.bF)(c,!0),[4,e.log({max:100,revRange:n})];case 2:if((r=f.sent()).error)return th({context:"use-branch-commits",gitService:e,result:r,data:{branch:c,behind:w,ahead:Z,revision:n}}),[2,r];return[2,{log:r.commits,error:null}];case 3:return i=(0,nl.bF)(c),[4,Promise.all([e.log({max:100,revRange:c.name}),e.log({max:100,revRange:"".concat(c.name,"..").concat(i)}),e.log({max:100,revRange:"".concat(i,"..").concat(c.name)})])];case 4:if(o=f.sent(),l=(a=(0,u._)(o,3))[0],s=a[1],d=a[2],l.error)return th({context:"use-branch-commits-log",gitService:e,result:l,data:{branch:c,behind:w,ahead:Z,remoteBranch:i}}),[2,{error:l.error}];if(s.error)return th({context:"use-branch-commits-only-remote",gitService:e,result:s,data:{branch:c,behind:w,ahead:Z,remoteBranch:i}}),[2,{error:s.error}];if(d.error)return th({context:"use-branch-commits-only-local",gitService:e,result:d,data:{branch:c,behind:w,ahead:Z,remoteBranch:i}}),[2,{error:d.error}];return[2,{log:l.commits,onlyRemote:s.commits,onlyLocal:d.commits,error:null}]}})}),function(e){return n.apply(this,arguments)}),[c,w,Z]),(0,_.useMemo)(function(){if(!r)return null;if(r.error)return t(r.error),{error:r.error};var e=r.log,n=r.onlyRemote,i=r.onlyLocal;if(!n&&!i)return{log:e,error:null};if(e){var o=new Set;if(n){var a=!0,l=!1,c=void 0;try{for(var s,u=n[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value;o.add(d.hash)}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}}if(i){var f=!0,h=!1,p=void 0;try{for(var m,v=i[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var g=m.value;o.add(g.hash)}}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}}e=e.filter(function(e){return!o.has(e.hash)})}return{log:e,onlyRemote:n,onlyLocal:i,error:null}},[t,r])),C=!!l&&l.size>0,S=(null==c?void 0:c.type)===t1.HO.LOCAL,k=(0,_.useMemo)(function(){if(!x||x.error)return[];var e=[],t=x.log,n=void 0===t?[]:t,r=x.onlyRemote,i=void 0===r?[]:r,o=x.onlyLocal,a=void 0===o?[]:o,l=n.length>0,c=i.length>0,s=a.length>0;return c&&(e.push({type:"boundary",text:"Not pulled from remote"}),e.push.apply(e,(0,d._)(ok(i,h)))),s&&(e.push({type:"boundary",text:"Not pushed to remote"}),e.push.apply(e,(0,d._)(ok(a,h)))),l&&((c||s)&&e.push({type:"boundary",text:"Up to date with remote"}),e.push.apply(e,(0,d._)(ok(n,h)))),e},[x,h]);return c?(0,f.BX)(y.G,{css:oC.view,children:[(0,f.BX)(y.G,{css:oC.sectionContainer,children:[S?(0,f.tZ)(y.G,{css:oC.section,children:(0,f.tZ)(rG,{branch:c,onViewSettingsClick:p})}):null,b&&!S&&l&&C?(0,f.BX)(y.G,{css:oC.section,children:[(0,f.BX)(y.G,{css:oC.remoteUpdatesHeader,children:[(0,f.tZ)(g.xv,{css:oC.headerText,multiline:!1,children:"Remote Updates"}),(0,f.tZ)(rN,{branch:c,remotes:l})]}),(0,f.tZ)(rQ,{remotes:l,gotoPendingState:m})]}):null,b&&a?(0,f.BX)(y.G,{css:oC.section,children:[(0,f.tZ)(y.G,{css:oC.reviewChangesHeader,children:(0,f.tZ)(g.xv,{css:oC.headerText,multiline:!1,children:"Commit"})}),(0,f.tZ)(iD,{status:a,onStagedFileClick:s})]}):null]}),x?(0,f.tZ)(og,{items:k}):(0,f.tZ)(ox,{})]}):(0,f.tZ)("div",{children:"No branch"})}function ok(e,t){return e.map(function(e){return{type:"commit",commit:e,onViewCommitClick:t}})}function o_(){return(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a cherry-pick."}),(0,f.tZ)(g.xv,{multiline:!1,children:"Please finish the cherry-pick manually."})]})}var oE=(0,b.X)({branch:[nn.gU.nofill,x.l0.py(12),x.l0.px(8),x.l0.colWithGap(2),x.l0.justify.center,x.l0.borderRadius(8),x.l0.flex.shrink(1)],branchMetadata:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.flex.shrink(1)]});function oT(e){var t=e.branch,n=e.current,r=e.onClick;return(0,f.BX)(y.G,{css:oE.branch,tabIndex:0,role:"button","aria-label":"Switch to branch ".concat((0,nl.bF)(t,!0)),onClick:r,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&(null==r||r())},children:[(0,f.tZ)(g.xv,{multiline:!1,children:(0,f.tZ)(nP,{name:t.name,remote:t.type===t1.HO.REMOTE?t.remote:null,current:void 0!==n&&n,onClick:r,icon:!0})}),(0,f.tZ)(oR,{branch:t})]})}function oR(e){var t=e.branch;return(0,f.BX)(y.G,{css:oE.branchMetadata,children:[(0,f.tZ)(ny,{name:t.commit.author.name,email:t.commit.author.email,color:"dimmest",allowPlaceholderAvatar:!0}),(0,f.tZ)(no.EK,{date:t.commit.author.date,textColor:"dimmest",textVariant:"small"})]})}var oI=(0,b.X)({expandButton:[{verticalAlign:"middle"},x.l0.justify.spaceBetween],branchListContainer:[x.l0.display.flex],topRow:[x.l0.p(4),x.l0.flex.row,x.l0.align.center,x.l0.justify.spaceBetween],topRowInteractive:[{verticalAlign:"middle"},x.l0.justify.spaceBetween,x.l0.borderRadius(8,8,0,0)],branchList:[x.l0.borderRadius(8)],branchListFoldable:[x.l0.borderRadius(0,0,8,8)]});function oD(e){var t=e.name,n=e.branches,r=e.current,i=void 0===r?null:r,o=e.foldable,a=void 0!==o&&o,l=e.folded,c=e.switchBranch,s=(0,u._)((0,_.useState)(!!a&&void 0!==l&&l),2),d=s[0],h=s[1],p=(0,_.useMemo)(function(){return n.map(function(e){return(0,f.tZ)(oT,{branch:e,current:(0,t1.p3)(e,i),onClick:function(){return c(e)}},(0,nl.Qj)(e))})},[n,i,c]);return d?(0,f.tZ)(W.zx,{css:oI.expandButton,text:t,iconRight:(0,f.tZ)(e0.Z,{}),onClick:function(){return h(!1)},size:"big"}):a?(0,f.BX)(y.G,{css:oI.branchListContainer,children:[(0,f.tZ)(W.zx,{css:oI.topRowInteractive,text:t,iconRight:(0,f.tZ)(e1.Z,{}),onClick:function(){return h(!0)},size:"big"}),(0,f.tZ)(H.Tg,{css:oI.branchListFoldable,elevated:!0,children:p})]}):(0,f.BX)(y.G,{css:oI.branchListContainer,children:[(0,f.tZ)(y.G,{css:oI.topRow,children:(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:t})}),(0,f.tZ)(H.Tg,{css:oI.branchList,elevated:!0,children:p})]})}var oG=(0,b.X)({container:[x.l0.p(8),x.l0.colWithGap(8),x.l0.borderRadius(8)],buttonContainer:[x.l0.rowWithGap(4)],button:[x.l0.flex.grow(1)],inputDisabled:[{opacity:.75}]});function oB(){var e=(0,u._)((0,_.useState)(!0),2),t=e[0],n=e[1],r=(0,u._)((0,_.useState)(""),2),i=r[0],o=r[1],a=(0,u._)((0,_.useState)(!1),2),l=a[0],c=a[1],s=t9(),d=(0,C.Z)().git;function h(){n(!0),o("")}function p(){return m.apply(this,arguments)}function m(){return(m=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:if(t||!i||l)return[2];return c(!0),[4,d.createBranch({name:i,checkout:!0})];case 1:return(e=r.sent()).error?(s(e.error),c(!1)):(d.forceRefresh(),c(!1),o(""),n(!0),nx("branch-created")),[2]}})})).apply(this,arguments)}if(t)return(0,f.tZ)(W.zx,{text:"Create Branch",iconLeft:(0,f.tZ)(na.Z,{}),onClick:function(){return n(!1)}});var v=!i||!(0,nl.Dc)(i);return(0,f.BX)(H.Tg,{css:oG.container,elevated:!0,children:[(0,f.tZ)(oP,{value:i,onChange:o,onSubmit:p,onCancel:h,disabled:l}),(0,f.BX)(y.G,{css:oG.buttonContainer,children:[(0,f.tZ)(W.zx,{css:oG.button,text:"Cancel",onClick:h,disabled:l}),(0,f.tZ)(W.zx,{css:oG.button,text:"Create Branch",colorway:"primary",iconLeft:(0,f.tZ)(na.Z,{}),onClick:p,loading:l,disabled:v})]})]})}function oP(e){var t=e.value,n=e.disabled,r=e.onChange,i=e.onSubmit,o=e.onCancel;function a(e){(0,nl.dC)(e)&&(null==r||r(e))}return(0,f.tZ)(X.II,{value:t,css:n?oG.inputDisabled:void 0,disabled:n,placeholder:"Enter a name for your new branch",onChange:function(e){return a(e.currentTarget.value)},onKeyDown:function(e){return function(e,n){switch(e){case"Enter":null==i||i(),n();break;case"Escape":null==o||o(),n();break;case" ":if(""===t){n();break}a(t+"-"),n()}}(e.key,function(){return e.preventDefault()})},onBlur:function(){""===t&&(null==o||o())},autoFocus:!0})}function oA(e){var t,n,r=e.currentBranch,i=e.switchMode,o=t9(),a=(0,C.Z)().git,l=(0,u._)((0,_.useState)(null),2),c=l[0],s=l[1],d=(0,td.Z)((t=(0,ts._)(function(e){var t,n,r,i,a,l,c,s,u,d,f,h,p,m,v,g,y,b,w;return(0,tu.Jh)(this,function(Z){switch(Z.label){case 0:return[4,e.listBranches()];case 1:if((t=Z.sent()).error)return o(t.error),th({context:"dashboard-view",gitService:e,result:t}),[2,t];return[4,e.findDefaultBranches()];case 2:if((n=Z.sent()).error)return o(n.error),[2,n];r=t.branches,i=new Set,a=!0,l=!1,c=void 0;try{for(s=function(){var e=d.value,t=r.find(function(t){return(0,nl.Pi)(t,e)});t&&i.add(t)},u=n.refs[Symbol.iterator]();!(a=(d=u.next()).done);a=!0)s()}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}f=Date.now()-5184e6,h=[],p=[],m=!0,v=!1,g=void 0;try{for(y=r[Symbol.iterator]();!(m=(b=y.next()).done);m=!0)w=b.value,i.has(w)||(w.commit.author.date>f?h.push(w):p.push(w))}catch(e){v=!0,g=e}finally{try{m||null==y.return||y.return()}finally{if(v)throw g}}return[2,{active:h,stale:p,important:Array.from(i),error:null}]}})}),function(e){return t.apply(this,arguments)}),[o]),h=(n=(0,ts._)(function(e){var t;return(0,tu.Jh)(this,function(n){switch(n.label){case 0:if(null!==c)return[2];return(0,nl.Pi)(r,e)&&i({mode:gO.CURRENT_BRANCH}),s(e),[4,a.switchBranch(e)];case 1:return(t=n.sent()).error?(o(t.error),th({context:"dashboard-view",gitService:a,result:t,data:{branch:e.name}}),s(null)):(a.forceRefresh(),nx("branch-switched")),[2]}})}),function(e){return n.apply(this,arguments)});if((0,_.useEffect)(function(){null!==c&&(0,nl.Pi)(r,c)&&(s(null),i({mode:gO.CURRENT_BRANCH}))},[r,c,i]),!d||null!==c)return(0,f.tZ)(ox,{});if(d.error)return(0,f.tZ)("div",{children:d.error});var p=d.active,m=d.stale,v=d.important;return(0,f.tZ)(y.G,{css:[x.l0.colWithGap(8)],children:(0,f.BX)(y.G,{css:[x.l0.pb(8),x.l0.px(8),x.l0.colWithGap(16)],children:[r?(0,f.BX)(y.G,{css:x.l0.colWithGap(8),children:[(0,f.tZ)(oD,{branches:[r],current:r,name:"Current Branch",switchBranch:h}),(0,f.tZ)(oB,{})]}):null,(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,css:oC.switchToBranch,children:"Switch Branch"}),0===v.length?null:(0,f.tZ)(oD,{branches:v,current:r,name:"Important",switchBranch:h,foldable:!0}),0===p.length?null:(0,f.tZ)(oD,{branches:p,current:r,name:"Active",switchBranch:h,foldable:!0}),0===m.length?null:(0,f.tZ)(oD,{branches:m,current:r,name:"Stale",switchBranch:h,foldable:!0,folded:!0})]})})}function oN(){return(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Unsupported state: your HEAD is currently detached."}),(0,f.tZ)(g.xv,{multiline:!1,children:"Please checkout a branch."})]})}var oL=n(76588),oU=n(60769),oO=(0,b.X)({checkboxLabel:x.l0.rowWithGap(8)});function oM(){var e=(0,_.useId)(),t=(0,u._)((0,_.useState)(!0),2),n=t[0],r=t[1],i=(0,u._)((0,_.useState)(!1),2),o=i[0],a=i[1],l=t9(),c=(0,C.Z)().git;function s(){return(s=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(o)return[2];return a(!0),[4,c.init({initialCommit:n,includeAllInitialFiles:!0})];case 1:return(e=t.sent()).error?(a(!1),l(e.error)):(c.forceRefresh(),nx("repository-initialized")),[2]}})})).apply(this,arguments)}return(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,{css:oO.checkboxLabel,tag:"label",children:[(0,f.tZ)(oU.X,{id:e,checked:n,onChange:function(e){return r(e.target.checked)}}),(0,f.tZ)(g.xv,{multiline:!1,children:"Create initial commit with all changes"})]}),(0,f.tZ)(W.zx,{text:o?"Initializing...":"Initialize Git Repository",iconLeft:o?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(t$.Z,{}),colorway:"primary",loading:o,onClick:function(){return s.apply(this,arguments)}})]})}var oX=(0,b.X)({container:[x.l0.height("100%"),x.l0.p(16),x.l0.colWithGap(16),x.l0.center],imageTagline:[x.l0.colWithGap(16),x.l0.center,x.l0.flex.shrink(1)]});function oF(){return(0,f.BX)(y.G,{css:oX.container,children:[(0,f.BX)(y.G,{css:oX.imageTagline,children:[(0,f.tZ)(oL.Z,{alt:"A potted plant morphing into a branching graph like structure",src:"/public/images/git/git_uninitialized_art.svg",height:300,width:280,objectFit:"contain",priority:!0}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Version control for your Repl."})]}),(0,f.tZ)(oM,{})]})}function oW(){return(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a rebase."}),(0,f.tZ)(g.xv,{multiline:!1,children:"Please finish the rebase manually."})]})}function oH(){return(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Unsupported state: you are in the middle of a revert."}),(0,f.tZ)(g.xv,{multiline:!1,children:"Please finish the revert manually."})]})}var oV=(0,b.X)({container:[x.l0.colWithGap(16),x.l0.p(8),x.l0.pt(16)],fakePaneHeader:[x.l0.px(8),x.l0.py(4),x.l0.rowWithGap(8),x.l0.backgroundColor.backgroundDefault,x.l0.align.center,{borderBottom:"1px solid ".concat(x.TV.outlineDimmer)}]});function oz(e){var t=e.onFileClick,n=e.status;return(0,f.BX)(y.G,{children:[(0,f.tZ)(oj,{}),(0,f.BX)(y.G,{css:oV.container,children:[(0,f.tZ)(rT.E,{colorway:"orange",icon:(0,f.tZ)(rn.Z,{}),text:"Your current branch doesn't have any commits. You need to make an initial commit before continuing."}),(0,f.BX)(y.G,{css:oC.section,children:[(0,f.tZ)(y.G,{css:oC.reviewChangesHeader,children:(0,f.tZ)(g.xv,{css:oC.headerText,multiline:!1,children:"Commit"})}),(0,f.tZ)(iD,{status:n,onStagedFileClick:t,defaultMessage:"Initial commit"})]})]})]})}function oj(){var e,t=t9(),n=(0,td.Z)((e=(0,ts._)(function(e){var n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:return[4,e.status()];case 1:return(n=r.sent()).error&&(th({context:"unborn-branch-view-status",gitService:e,result:n}),t(n.error)),[2,n]}})}),function(t){return e.apply(this,arguments)}),[t]);return(null==n?void 0:n.error)?null:(0,f.tZ)(y.G,{css:oV.fakePaneHeader,children:(null==n?void 0:n.branch)?(0,f.tZ)(nP,{name:n.branch,current:!0,heading:!0}):null})}function oq(e){var t=e.error;return(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Failed to start the Git pane."}),(0,f.BX)(g.xv,{multiline:!1,children:["Error: ",t]})]})}var oY=function(e){var t,n=(0,td.Z)((t=(0,ts._)(function(t){var n,r,i;return(0,tu.Jh)(this,function(o){switch(o.label){case 0:return[4,t.isInitialized()];case 1:if((n=o.sent()).error)return[2,{error:n.error}];if(!n.initialized)return[2,{error:ri.aq.NOT_INITIALIZED}];return[4,t.log({max:1,revRange:e})];case 2:if((r=o.sent()).error)return[2,{error:r.error}];if(0===r.commits.length)return[2,{error:ri.aq.NO_COMMITS}];return[2,{commit:null!==(i=r.commits[0])&&void 0!==i?i:null,error:null}]}})}),function(e){return t.apply(this,arguments)}),[e]);return(0,_.useMemo)(function(){return n?n.error?{error:n.error}:n:null},[n])},oJ=n(2158),oK=n(80339),o$=[{"& > span:first-child":[x.l0.flex.grow(1),x.l0.textAlign.left]},{"& > span":[x.l0.flex.shrink(1)]}],oQ=(0,b.X)({container:[x.l0.colWithGap(16)],splitOrUnisonContainer:[x.l0.colWithGap(8),x.l0.display.flex,x.l0.flex.row,x.l0.flex.wrap,x.l0.align.center,x.l0.justify.spaceBetween],emphasizedText:[x.l0.fontWeight.medium],buttonFolded:[o$,x.l0.height("auto"),x.l0.py(8),x.l0.fontWeight.medium],buttonUnfolded:[o$,x.l0.height("auto"),x.l0.py(8),x.l0.fontWeight.medium,x.l0.borderRadius(8,8,0,0)],buttonGroupItem:[x.l0.width(64),x.l0.height(32)],textContainer:[x.l0.mt(8),x.l0.overflow("break-all")]}),o0=function(e){var t=e.children;return(0,f.tZ)(y.G,{css:oQ.splitOrUnisonContainer,children:t})},o1=function(e){var t=e.value,n=e.onChange;return(0,f.BX)(eQ.hE,{name:"SplitOrUnifiedDiff",value:t,onChange:n,row:!0,children:[(0,f.tZ)(y.G,{css:oQ.buttonGroupItem,children:(0,f.tZ)(eQ.rK,{value:"Unified",text:"Unified",id:"SplitOrUnifiedDiffUnified"})}),(0,f.tZ)(y.G,{css:oQ.buttonGroupItem,children:(0,f.tZ)(eQ.rK,{value:"Split",text:"Split",id:"SplitOrUnifiedDiffSplit"})})]})},o2=function(e){var t=e.value,n=e.onChange;return(0,f.tZ)(m.hU,{alt:"Markdown"===t?"View Source":"View Markdown",onClick:function(){return n("Markdown"===t?"Source":"Markdown")},children:"Markdown"===t?(0,f.tZ)(oJ.Z,{}):(0,f.tZ)(oK.Z,{})})},o8=function(e){var t=e.files,n=e.totalFiles;return t===n?(0,f.BX)(g.xv,{css:oQ.textContainer,children:["Showing"," ",(0,f.BX)("span",{css:oQ.emphasizedText,children:[n," changed ",(0,em.Z)("file",n),"."]})]}):(0,f.BX)(g.xv,{css:oQ.textContainer,children:["Showing"," ",(0,f.BX)("span",{css:oQ.emphasizedText,children:[t," of ",n," changed ",(0,em.Z)("file",n),"."]})]})},o4=function(e){var t=e.query,n=e.setQuery,r=e.totalDiffs,i=e.diffs,o=e.splitOrUnified,a=e.setSplitOrUnified,l=e.folded,c=e.setFolded,s=(0,_.useMemo)(function(){return i.filter(function(e){var n="".concat(e.final.path,"/").concat(e.final.filename),r="".concat(e.initial.path,"/").concat(e.initial.filename);return n.toLowerCase().includes(t.toLowerCase())||r.toLowerCase().includes(t.toLowerCase())})},[t,i]);return(0,f.BX)(y.G,{css:oQ.container,children:[(0,f.tZ)(ni.E,{value:t,onChange:function(e){n(e.target.value)},onClear:function(){n("")},loading:!1,placeholder:"Filter changed files"}),(0,f.BX)(o0,{children:[(0,f.tZ)(o8,{files:s.length,totalFiles:r}),i.length>0?(0,f.tZ)(o1,{value:o,onChange:function(e){return a(e)}}):null]}),s.map(function(e){var t;return(0,f.tZ)(to,{folded:null===(t=l[e.id])||void 0===t||t,setFolded:function(t){return c(e.id,t)},diff:e,splitOrUnified:o},e.id)})]})},o3=(0,b.X)({metaContainer:[x.l0.rowWithGap(4),x.l0.align.center,x.l0.flex.wrap]}),o5=function(e){var t=e.author,n=e.committer,r=ot(n,t),i=on(n.date,t.date);return(0,f.BX)(y.G,{css:o3.metaContainer,children:[r&&i?(0,f.BX)(f.HY,{children:[(0,f.tZ)(ny,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,f.tZ)(g.xv,{variant:"small",children:"authored"}),(0,f.tZ)(no.EK,{date:t.date,textColor:"dimmest",textVariant:"small"}),(0,f.tZ)(g.xv,{variant:"small",children:"and"})]}):null,r&&!i?(0,f.BX)(f.HY,{children:[(0,f.tZ)(ny,{name:t.name,email:t.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),(0,f.tZ)(g.xv,{variant:"small",children:"authored"}),(0,f.tZ)(g.xv,{variant:"small",children:"and"})]}):null,(0,f.tZ)(ny,{name:n.name,email:n.email,color:"dimmer",allowPlaceholderAvatar:!0,small:!0}),!r&&i?(0,f.BX)(f.HY,{children:[(0,f.tZ)(g.xv,{variant:"small",children:"authored "}),(0,f.tZ)(no.EK,{date:t.date,textColor:"dimmest",textVariant:"small"}),(0,f.tZ)(g.xv,{variant:"small",children:"and "})]}):null,(0,f.tZ)(g.xv,{variant:"small",children:"committed"}),(0,f.tZ)(no.EK,{date:n.date,textColor:"dimmest",textVariant:"small"})]})},o6=(0,b.X)({dullText:[x.l0.color.foregroundDimmest],tooltipContainer:[x.l0.display.inlineBlock]}),o9=function(e){var t=e.onViewCommitClick,n=e.hash;return(0,f.tZ)("span",{css:o6.tooltipContainer,children:(0,f.tZ)(ta.u,{tooltip:"View commit",children:(0,f.tZ)("button",{css:[x.l0.reset.button,x.l0.linkStyle,x.l0.fontWeight.medium],onClick:function(){return t(n)},children:n.slice(0,7)})})})},o7=function(e){var t=e.parents,n=e.grafted,r=e.onViewCommitClick;return(0,f.BX)(g.xv,{variant:"small",children:[(0,f.BX)("span",{css:o6.dullText,children:[n?"Grafted with ":null,t.length," ",(0,em.Z)("parent",t.length)," "]}),0===t.length?null:t.map(function(e,n){return(0,f.BX)(_.Fragment,{children:[(0,f.tZ)(o9,{hash:e,onViewCommitClick:r}),n===t.length-1?"":(0,f.tZ)("span",{css:o6.dullText,children:", "})]},e)})]})},ae=function(e){var t=e.source,n=e.target;return(0,f.tZ)("span",{children:n?(0,f.BX)(f.HY,{children:["Branch ",(0,f.tZ)(nP,{name:t})," into ",(0,f.tZ)(nP,{name:n})," "]}):(0,f.BX)(f.HY,{children:["Branch ",(0,f.tZ)(nP,{name:t})]})})},at="gitCommitSubject",an=(0,ep.iv)([x.l0.display.inline,{fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit"}]),ar=(0,b.X)({header:[(gM={},(0,eP._)(gM,"& .".concat(at),an),(0,eP._)(gM,"& .".concat(at," > div"),an),(0,eP._)(gM,"& .".concat(at," p"),an),gM)],markerContainer:[x.l0.display.inlineFlex,x.l0.mr(4)]}),ai=function(e){var t=e.merge,n=e.revert,r=e.subject,i=e.remotes,o=e.onViewCommitClick,a=(0,_.useMemo)(function(){var e,r=null;if((null==t?void 0:t.type)==="pull-request"?r=t.id:n&&(null==n?void 0:n.pr)&&(r=n.pr),r&&i){var o=i.get("origin");if(!o){var a=Array.from(i.values());if(1!==a.length)return;o=a[0]}return null!==(e=rg(o))&&void 0!==e?e:void 0}},[t,i,n]);return(0,f.BX)(g.h4,{level:2,variant:"subheadDefault",multiline:!0,css:ar.header,children:[t?(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{css:ar.markerContainer,children:(0,f.tZ)(iH,{type:"merge"})}),(0,f.tZ)(nR,{text:"merged"})," "]}):null,(null==t?void 0:t.type)==="pull-request"?(0,f.BX)(f.HY,{children:["PR ",(0,f.tZ)(nI,{id:t.id,hash:!0})," ",(null==n?void 0:n.pr)?(0,f.BX)(f.HY,{children:[(0,f.tZ)(nT,{text:"reverts"})," ",(0,f.tZ)(nI,{id:n.pr,hash:!0})]}):null," - "]}):null,(null==t?void 0:t.type)==="branch"?(0,f.BX)(f.HY,{children:[(0,f.tZ)(ae,{source:t.source,target:t.target})," -"," "]}):null,n&&!t?(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{css:ar.markerContainer,children:(0,f.tZ)(iH,{type:"revert"})}),(0,f.tZ)(nT,{text:"reverted"})," ",(0,f.tZ)("button",{css:[x.l0.reset.button,x.l0.linkStyle,x.l0.fontWeight.medium],onClick:function(){(null==n?void 0:n.hash)!==void 0&&o(n.hash)},children:n.hash.slice(0,7)})," - "]}):null,(0,f.tZ)(nG,{className:at,subject:r,remoteName:a})]})},ao=n(55534),aa=function(e){var t,n=t9(),r=(0,td.Z)((t=(0,ts._)(function(t){var n,r,i,o,a,l;return(0,tu.Jh)(this,function(c){switch(c.label){case 0:return i=e.hash,[4,t.getFilesForCommit(i)];case 1:if(null==(o=c.sent())?void 0:o.error)return th({context:"use-commit-diffs",gitService:t,result:o,data:{commit:e}}),[2,{error:o.error,diffs:[]}];return a=(null==o?void 0:null===(n=o.files)||void 0===n?void 0:n.filter(function(e){return["ADDED","MODIFIED","COPIED","RENAMED","TYPE_CHANGED"].includes(e.type)}))||[],l=(null==o?void 0:null===(r=o.files)||void 0===r?void 0:r.filter(function(e){return["DELETED","MODIFIED","COPIED","RENAMED","TYPE_CHANGED"].includes(e.type)}))||[],[2,{error:null,diffs:Array.from(new Set((0,d._)(a).concat((0,d._)(l)))).map(function(e){var t,n;return{id:(0,tB.v4)(),status:e.type,loading:!1,initial:{filename:(0,E.UO)(null!==(t=e.originalPath)&&void 0!==t?t:e.path),path:(0,E.Il)(null!==(n=e.originalPath)&&void 0!==n?n:e.path),content:""},final:{filename:(0,E.UO)(e.path),path:(0,E.Il)(e.path),content:""}}})}]}})}),function(e){return t.apply(this,arguments)}),[e]);return(0,_.useMemo)(function(){return r?r.error?(n(r.error),null):r:null},[n,r])},al=(g_=(0,ts._)(function(e,t,n,r){var i,o,a;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:return i=""===t?n:"".concat(t,"/").concat(n),[4,e.getFileContents({path:i,revision:r})];case 1:if((o=l.sent()).error)throw o.error;return[2,null!==(a=null==o?void 0:o.content)&&void 0!==a?a:""]}})}),function(e,t,n,r){return g_.apply(this,arguments)}),ac=(gE=(0,ts._)(function(e,t,n){var r,i,o,a;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:return i=t.hash,[4,al(e,n.final.path,n.final.filename,i)];case 1:if(o=l.sent(),a="",!(!t.grafted&&(null===(r=t.parents)||void 0===r?void 0:r.length)))return[3,3];return[4,al(e,n.initial.path,n.initial.filename,"".concat(i,"^"))];case 2:a=l.sent(),l.label=3;case 3:return[2,(0,O._)((0,U._)({},n),{loading:!1,initial:(0,O._)((0,U._)({},n.initial),{content:a}),final:(0,O._)((0,U._)({},n.final),{content:o})})]}})}),function(e,t,n){return gE.apply(this,arguments)}),as=(0,b.X)({content:[x.l0.colWithGap(16),x.l0.p(16)],splitContainer:[x.l0.display.flex,x.l0.flex.row,x.l0.flex.shrink(1),x.l0.flex.wrap,x.l0.justify.spaceBetween,x.l0.maxWidth("100%"),x.l0.border({color:x.TV.outlineDimmest,direction:"bottom"}),x.l0.pb(16)]}),au=function(e){var t,n,r=e.git,i=e.commit,o=e.info,a=e.onViewCommitClick,l=void 0===a?function(){}:a,c=e.remotes,s=e.status,h=(0,_.useMemo)(function(){return(0,iu.w)(s?s.changes.map(function(e){return e.path}):[])},[s]),p=(0,_.useMemo)(function(){if(!s)return[];var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=s.changes[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;a.type.worktree!==e2.h.UNMODIFIED&&e.push(a)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e},[s]),m=(0,ao.Z)().showConfirm,v=t9(),b=(0,u._)((0,_.useState)(!1),2),w=b[0],Z=b[1],C=(0,u._)((0,_.useState)(""),2),S=C[0],k=C[1],E=(0,u._)((0,_.useState)("Split"),2),T=E[0],R=E[1],I=(0,u._)((0,_.useState)("Markdown"),2),D=I[0],G=I[1],B=(0,u._)((0,_.useState)({}),2),P=B[0],A=B[1],N=(0,u._)((0,_.useState)([]),2),L=N[0],M=N[1],X=i9(i,o),F=X.hideBody,W=X.merge,H=X.revert,V=i.hash,z=i.subject,j=i.body,q=i.committer,Y=i.author,J=i.grafted,K=null!==(n=i.parents)&&void 0!==n?n:[],$=aa(i),Q=(0,_.useCallback)((0,ts._)(function(){var e,t,n,o=arguments;return(0,tu.Jh)(this,function(a){switch(a.label){case 0:return e=!(o.length>0)||void 0===o[0]||o[0],[4,r.restoreFiles(e,i.hash)];case 1:if((t=a.sent()).error)return[3,3];return[4,r.status()];case 2:return(n=a.sent()).error?(v(n.error),th({context:"commit-view",gitService:r,result:n,data:{files:e,commit:i.hash}})):m("Restored commit!"),r.forceRefresh(),[3,4];case 3:v(t.error),th({context:"commit-view",gitService:r,result:t,data:{files:e,commit:i.hash}}),a.label=4;case 4:return[2]}})}),[i.hash,r,v,m]),ee=r9(h),et=ee.openRestoreConfirmationModal,en=ee.restoreConfirmationModal,er=(0,_.useCallback)((0,ts._)(function(){var e,t,n,r=arguments;return(0,tu.Jh)(this,function(i){switch(i.label){case 0:if(!0!==(e=!(r.length>0)||void 0===r[0]||r[0]))return[3,6];if(Z(!0),0!==p.length)return[3,2];return[4,Q()];case 1:return i.sent(),Z(!1),[2];case 2:return[4,et(p)];case 3:if(!i.sent())return[3,5];return[4,Q()];case 4:i.sent(),i.label=5;case 5:return Z(!1),[3,10];case 6:if("string"==typeof e){if(!(n=p.find(function(t){return t.path===e})))throw Z(!1),Error("Could not find file in worktree list");t=[n]}else t=p.filter(function(t){return e.includes(t.path)});return[4,et(t)];case 7:if(!i.sent())return[3,9];return[4,Q(e)];case 8:i.sent(),i.label=9;case 9:Z(!1),i.label=10;case 10:return[2]}})}),[et,Q,p]);(0,_.useEffect)(function(){var e;M(null!==(e=null==$?void 0:$.diffs.map(function(e){return(0,O._)((0,U._)({},e),{loading:!0})}))&&void 0!==e?e:[])},[$]),(0,_.useEffect)(function(){null!==$&&$.error&&v($.error)},[$,v]);var ei=(t=(0,ts._)(function(e,t){var n,o,a;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:if(A(function(n){var r=(0,U._)({},n);return r[e]=t,r}),!(n=L.find(function(t){return t.id===e})))return v(ri.aq.INVALID_STATE),th({context:"commit-view",gitService:r,result:{error:ri.aq.INVALID_STATE},data:{diffId:e}}),[2];if(!(!t&&n.loading))return[3,4];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,ac(r,i,n)];case 2:return o=l.sent(),M(function(t){var n=(0,d._)(t),r=n.findIndex(function(t){return t.id===e});return n[r]=o,n}),[3,4];case 3:return th({context:"commit-view",gitService:r,result:a=l.sent(),data:{diffId:e}}),v(a),[2];case 4:return[2]}})}),function(e,n){return t.apply(this,arguments)});return(0,f.BX)(y.G,{css:as.content,children:[(0,f.tZ)(ai,{remotes:c,merge:W,revert:H,subject:z,onViewCommitClick:l}),(0,f.BX)(o0,{children:[(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8),x.l0.align.start,x.l0.flex.shrink(1)],children:[(0,f.tZ)(i7,{hash:V}),(0,f.tZ)(oe,{onClick:function(){return er()},text:"Restore All",loading:w})]}),F?null:(0,f.tZ)(o2,{value:D,onChange:function(e){G(e)}})]}),F?null:(0,f.tZ)(nB,{body:j,view:D}),(0,f.BX)(y.G,{css:as.splitContainer,children:[(0,f.tZ)(o5,{author:Y,committer:q}),(0,f.tZ)(o7,{parents:K,grafted:J,onViewCommitClick:l})]}),null!==W?(0,f.tZ)(g.xv,{variant:"small",color:"dimmest",children:"There is more than one parent, diffing against the first parent."}):null,null===$?(0,f.tZ)(ox,{}):(0,f.tZ)(o4,{query:S,setQuery:k,totalDiffs:$.diffs.length,diffs:L,splitOrUnified:T,setSplitOrUnified:R,folded:P,setFolded:ei}),en]})};function ad(e){var t=e.hash,n=e.remotes,r=e.onViewCommitClick,i=e.switchMode,o=e.status,a=(0,C.Z)().git,l=t9(),c=oY(null!=t?t:"");if(null===c)return(0,f.tZ)(ox,{});if(c.error)return c.error===ri.aq.NOT_INITIALIZED?i({mode:gO.CURRENT_BRANCH}):(l(c.error),(c.error===ri.aq.UNKNOWN||c.error===ri.aq.UNKNOWN_NOT_GIT)&&th({context:"commit-view",gitService:a,result:c,data:{hash:t}})),null;if(null===c.commit)return l(ri.aq.UNKNOWN),null;var s=c.commit,u=iM(s)||iA(s);return(0,f.tZ)(au,{git:a,commit:s,info:u,onViewCommitClick:r,remotes:n,status:o})}var af=n(42960),ah=(0,b.X)({container:[x.l0.colWithGap(4)],file:[x.l0.rowWithGap(8),x.l0.align.center],fileLeft:[x.l0.rowWithGap(8),x.l0.flex.grow(1),x.l0.align.center],filePrefix:[x.l0.color.foregroundDimmest]});function ap(e){var t=e.files,n=e.uniquePathMap,r=e.onFileClick,i=[];if(t instanceof Map){var o=!0,a=!1,l=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var d=(0,u._)(c.value,2),h=d[0],p=d[1],m=n.get(h);i.push({path:h,prefix:m,resolved:p})}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}}else{var b=!0,w=!1,Z=void 0;try{for(var C,S=t[Symbol.iterator]();!(b=(C=S.next()).done);b=!0){var k=C.value,_=n.get(k);i.push({path:k,prefix:_,resolved:!0})}}catch(e){w=!0,Z=e}finally{try{b||null==S.return||S.return()}finally{if(w)throw Z}}}return(0,f.tZ)(y.G,{css:ah.container,children:i.map(function(e){var t=e.path,n=e.prefix,i=e.resolved;return(0,f.BX)(y.G,{css:ah.file,children:[(0,f.BX)(y.G,{css:ah.fileLeft,children:[(0,f.tZ)(v.Z,{path:t}),(0,f.tZ)(g.xv,{multiline:!1,children:(0,f.tZ)(nA,{path:t,prefix:n,onClick:function(){return r(t)}})})]}),i?(0,f.tZ)(rl.Z,{color:x.TV.greenStronger}):(0,f.tZ)(rn.Z,{color:x.TV.orangeStronger})]},t)})})}function am(e){var t=e.hasConflicts?(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{css:x.l0.fontWeight.medium,children:"Resolve all conflicts to complete merge."}),(0,f.tZ)("br",{}),(0,f.tZ)("span",{children:"You can't do anything else until the merge has been completed or aborted."})]}):(0,f.BX)(f.HY,{children:[(0,f.tZ)("span",{css:x.l0.fontWeight.medium,children:"You are in the middle of a merge."}),(0,f.tZ)("br",{}),(0,f.tZ)("span",{children:"You can't do anything else until the merge has been completed or aborted. You have no conflicts to resolve, so the merge can be completed without any further action."})]});return(0,f.tZ)(rT.E,{colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),text:t})}var av=(0,b.X)({container:[x.l0.rowWithGap(4),x.l0.align.center,x.l0.justify.spaceBetween],left:[{flexBasis:0,flexGrow:1},x.l0.colWithGap(8)],right:{flexBasis:0,flexGrow:1},branch:[x.l0.p(8),x.l0.rowWithGap(4),x.l0.flex.grow(1),x.l0.center,x.l0.borderRadius(8)]});function ag(e){var t,n=e.branch,r=e.refs,i=e.refsAreBranches,o=e.isUpstreamPull;if(!r.length)return null;if(o){var a=(0,u._)((0,rf.Tg)(r[0]),2),l=a[0],c=a[1];l&&c&&(t=(0,f.tZ)(H.Tg,{css:av.branch,elevated:!0,children:(0,f.tZ)(nP,{remote:l,name:c,icon:!0,heading:!0})}))}return t||(t=r.map(function(e){return(0,f.tZ)(H.Tg,{css:av.branch,elevated:!0,children:(0,f.tZ)(nP,{name:e,icon:!!i||(0,f.tZ)(tl.Z,{size:16}),heading:!0})},e)})),(0,f.BX)(y.G,{css:av.container,children:[(0,f.tZ)(y.G,{css:av.left,children:t}),(0,f.tZ)(V.Z,{size:24,color:x.TV.foregroundDimmest}),(0,f.tZ)(y.G,{css:av.right,children:(0,f.tZ)(H.Tg,{css:av.branch,elevated:!0,children:(0,f.tZ)(nP,{name:n,icon:!0,current:!0,heading:!0})})})]})}var ay=(0,b.X)({container:[x.l0.colWithGap(12),x.l0.pt(16),x.l0.pb(8),x.l0.px(8)],fakePaneHeader:[x.l0.p(8),x.l0.rowWithGap(8),x.l0.backgroundColor.backgroundDefault,x.l0.align.center,{borderBottom:"1px solid ".concat(x.TV.outlineDimmer)}],conflictResolution:[x.l0.colWithGap(16)],listContainer:[x.l0.p(8),x.l0.colWithGap(8),x.l0.borderRadius(8)],list:[x.l0.pb(8),x.l0.colWithGap(8)],listDisabled:[{opacity:.5},x.l0.pb(8),x.l0.colWithGap(8)],listHeader:[x.l0.pb(4),x.l0.flex.grow(1),x.l0.border({color:x.TV.outlineDimmer,direction:"bottom"})],listFiles:[x.l0.px(8)],includeOtherFiles:[{cursor:"pointer",maxWidth:"max-content",userSelect:"none"},x.l0.rowWithGap(8)],buttons:[x.l0.colWithGap(8)]});function ab(e){var t,n=e.onFileClick,r=e.gotoPendingState,i=(0,u._)((0,_.useState)(!0),2),o=i[0],a=i[1],l=(0,u._)((0,_.useState)(!1),2),c=l[0],s=l[1],h=(0,u._)((0,_.useState)(!1),2),p=h[0],m=h[1],v=c||p,b=t9(),w=(0,C.Z)().git,S=(0,_.useId)(),k=(0,td.Z)((t=(0,ts._)(function(e){var t,n,r,i,o,a,l,c,s,d,f,h,p,m,v,g,y,b,w,Z;return(0,tu.Jh)(this,function(x){switch(x.label){case 0:return[4,e.status()];case 1:if((t=x.sent()).error)return th({context:"use-merging-view-state-status",gitService:e,result:t}),[2,t];if(!(n=t.branch))return[2,{error:ri.aq.HEAD_DETACHED}];return[4,e.getConflictingFiles()];case 2:if((r=x.sent()).error)return[2,r];return i=r.files,[4,e.getMergingRefs()];case 3:if((o=x.sent()).error)return th({context:"use-merging-view-state-merging-refs",gitService:e,result:o,data:{status:t,conflictingFiles:i}}),[2,o];a=o.commits,s=(c=(l=o.branches).length>0)?l:a,d=t.changes.filter(function(e){return!e.unmerged}).map(function(e){return e.path}),f=!0,h=!0,p=!1,m=void 0;try{for(v=i[Symbol.iterator]();!(h=(g=v.next()).done);h=!0)if(!(0,u._)(g.value,2)[1]){f=!1;break}}catch(e){p=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(p)throw m}}return y=(0,iu.w)(t.changes.map(function(e){return e.path})),b=i.size>0,w=d.length>0,Z=null!==t.upstream&&1===l.length&&l[0]===t.upstream.branch,[2,{refs:s,branch:n,conflictingFiles:i,otherChangedFiles:d,refsAreBranches:c,allIsResolved:f,uniquePathMap:y,hasConflicts:b,hasOtherChanges:w,isUpstreamPull:Z,error:null}]}})}),function(e){return t.apply(this,arguments)}));if((0,_.useEffect)(function(){(null==k?void 0:k.error)&&b(k.error)},[null==k?void 0:k.error,b]),!k)return(0,f.tZ)(ox,{});if(k.error)return null;var E=k.refs,T=k.branch,R=k.conflictingFiles,I=k.otherChangedFiles,D=k.refsAreBranches,G=k.allIsResolved,B=k.uniquePathMap,P=k.hasConflicts,A=k.hasOtherChanges,N=k.isUpstreamPull;function L(){return(L=(0,ts._)(function(){var e,t,n,i,a,l,c,u,f,h,p;return(0,tu.Jh)(this,function(m){switch(m.label){case 0:if(!G||v)return[2];s(!0),e=[],t=!0,n=!1,i=void 0;try{for(a=R.keys()[Symbol.iterator]();!(t=(l=a.next()).done);t=!0)c=l.value,e.push(c)}catch(e){n=!0,i=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw i}}return o&&(u=e).push.apply(u,(0,d._)(I)),[4,w.stageFiles({all:!1})];case 1:if((f=m.sent()).error)return b(f.error),s(!1),[2];return[4,w.stageFiles({add:e})];case 2:if((h=m.sent()).error)return b(h.error),s(!1),[2];return[4,w.mergeContinue()];case 3:if(!(p=m.sent()).error)return[3,5];return[4,w.stageFiles({all:!1})];case 4:return m.sent(),b(p.error),s(!1),[3,6];case 5:r(),w.forceRefresh(),m.label=6;case 6:return[2]}})})).apply(this,arguments)}function U(){return(U=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(v)return[2];return m(!0),[4,w.mergeAbort()];case 1:return(e=t.sent()).error?(b(e.error),m(!1),th({context:"merging-view-abort",gitService:w,result:e,data:{branch:T}})):(r(),w.forceRefresh()),[2]}})})).apply(this,arguments)}var O=N?"Complete in-progress pull":"Complete in-progress merge";return P&&(O=N?"Resolve pull conflicts":"Resolve merge conflicts"),(0,f.BX)(y.G,{children:[(0,f.BX)(y.G,{css:ay.fakePaneHeader,children:[(0,f.tZ)(af.Z,{}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:O})]}),(0,f.BX)(y.G,{css:ay.container,children:[(0,f.tZ)(ag,{branch:T,refs:E,refsAreBranches:D,isUpstreamPull:N}),(0,f.tZ)(am,{hasConflicts:P}),(0,f.BX)(H.Tg,{css:ay.listContainer,elevated:!0,children:[(0,f.BX)(y.G,{css:ay.list,children:[(0,f.tZ)(y.G,{css:ay.listHeader,children:(0,f.tZ)(g.xv,{css:x.l0.fontWeight.medium,multiline:!1,children:"Conflicting Files"})}),(0,f.tZ)(y.G,{css:ay.listFiles,children:P?(0,f.tZ)(ap,{files:R,uniquePathMap:B,onFileClick:n}):(0,f.tZ)(g.xv,{variant:"small",color:"dimmest",multiline:!1,children:"There are no conflicting files in this merge."})})]}),A?(0,f.BX)(y.G,{css:o?ay.list:ay.listDisabled,children:[(0,f.tZ)(y.G,{css:ay.listHeader,children:(0,f.tZ)(g.xv,{css:x.l0.fontWeight.medium,multiline:!1,children:"Other Changed Files"})}),(0,f.tZ)(y.G,{css:ay.listFiles,children:(0,f.tZ)(ap,{files:I,uniquePathMap:B,onFileClick:n})})]}):null]}),(0,f.BX)(y.G,{css:ay.includeOtherFiles,tag:"label",children:[(0,f.tZ)(oU.X,{id:S,checked:o,onChange:function(e){return a(e.target.checked)}}),(0,f.tZ)(g.xv,{multiline:!1,children:"Include other changed files in commit"})]}),(0,f.BX)(y.G,{css:ay.buttons,children:[(0,f.tZ)(W.zx,{text:N?"Complete pull":"Complete merge and commit",colorway:"primary",iconLeft:c?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(af.Z,{}),disabled:!G||v,loading:c,onClick:function(){return L.apply(this,arguments)}}),(0,f.tZ)(W.zx,{text:N?"Abort pull":"Abort merge",colorway:"negative",iconLeft:p?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(r0.Z,{}),disabled:v,loading:p,onClick:function(){return U.apply(this,arguments)}})]})]})]})}var aw=n(56050),aZ=n(2038),ax=n(85195),aC=n(47611),aS=(0,b.X)({gitProfileTitle:[x.l0.rowWithGap(8),x.l0.align.center]});function ak(e){var t=e.username,n=e.avatar;return(0,f.BX)(y.G,{css:aS.gitProfileTitle,children:[(0,f.tZ)(ns.q,{src:null!=n?n:"/images/evalbot/evalbot_24",username:t}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:t})]})}var a_=(0,b.X)({list:{"> div:first-child":x.l0.borderRadius(8,8,0,0),"> div:last-child":[x.l0.borderRadius(0,0,8,8),{border:"none"}]},profile:[nn.gU.filled,x.l0.flex.row,x.l0.justify.spaceBetween,x.l0.p(12),x.l0.borderRadius(0),x.l0.border({color:x.TV.outlineDefault,direction:"bottom"})],information:[x.l0.colWithGap(4),x.l0.flex.shrink(1)],informationRow:[x.l0.rowWithGap(8),x.l0.align.center],email:[x.l0.flex.shrink(1)],connectToGithubContainer:[x.l0.colWithGap(4),x.l0.p(12),x.l0.backgroundColor.backgroundHigher],divider:[x.l0.backgroundColor.outlineDefault],connectToGitHubTitle:[x.l0.rowWithGap(4),x.l0.align.center],notConnectedText:[x.l0.pb(4)],settingsButton:{background:"transparent",border:"none","&:hover":{textDecoration:"underline"}},radio:{pointerEvents:"none"}});function aE(e){var t=e.profiles,n=e.current,r=e.showConnectToGithub,i=e.onSelectProvider,o=(0,aC.useRouter)(),a=(0,aZ.Vg)(o),l=(0,_.useId)();return(0,f.BX)(ax.E,{name:l,css:a_.list,value:null!=n?n:"",children:[t.map(function(e){t=e.provider===ri.rG.GITHUB?"GitHub":"Default Profile";var t,r=void 0;return e.provider===ri.rG.GITHUB&&(r=a?"/mobile/auth/github/app_permissions":"/auth/github/app_permissions?close=1"),(0,f.tZ)(aT,{profile:e,providerName:t,current:e.provider===n,onSelectProvider:i,settingsURL:r},e.provider)}),r?(0,f.BX)(y.G,{css:a_.connectToGithubContainer,children:[(0,f.tZ)(y.G,{css:a_.connectToGitHubTitle,children:(0,f.tZ)(ak,{username:"GitHub Account"})}),(0,f.tZ)(g.xv,{color:"dimmest",css:a_.notConnectedText,multiline:!1,children:"Your GitHub account is not connected."}),(0,f.tZ)(rd,{})]}):null]})}function aT(e){var t=e.profile,n=e.current,r=e.providerName,i=e.settingsURL,o=e.onSelectProvider,a=t.provider,l=t.username,c=t.email,s=t.avatar,u=(0,_.useId)();return(0,f.BX)(y.G,{onClick:function(){return o(a)},css:a_.profile,children:[(0,f.BX)(y.G,{css:a_.information,children:[(0,f.BX)(y.G,{css:a_.informationRow,children:[(0,f.tZ)(ak,{username:l,avatar:s}),i?(0,f.tZ)(rB.Z,{css:a_.settingsButton,text:"".concat(r," Settings"),iconRight:(0,f.tZ)(rP.Z,{}),href:i,target:"_blank",variant:"outlined",size:"small"}):(0,f.tZ)(g.xv,{color:"dimmest",variant:"small",multiline:!1,children:r})]}),(0,f.tZ)(g.xv,{color:"dimmest",css:a_.email,multiline:!1,children:c})]}),(0,f.tZ)(ax.Y,{css:a_.radio,id:u,checked:n,value:a})]})}var aR=(0,b.X)({profileContainer:[x.l0.flex.column]});function aI(){var e,t=(0,C.Z)().git,n=(0,td.Z)((e=(0,ts._)(function(e){var t,n;return(0,tu.Jh)(this,function(r){return t=e.getCurrentProfile(),[2,{profiles:e.getProfiles(),current:null!==(n=null==t?void 0:t.provider)&&void 0!==n?n:null,hasGitHub:!e.hasProfile(ri.rG.GITHUB),error:null}]})}),function(t){return e.apply(this,arguments)}));if(!n)return null;if(null!==n.error)return th({context:"git-profiles",gitService:t,result:{error:n.error}}),null;var r=n.profiles,i=n.current,o=n.hasGitHub;return(0,f.tZ)(y.G,{css:aR.profileContainer,children:(0,f.tZ)(aE,{profiles:r,current:i,showConnectToGithub:o,onSelectProvider:function(e){t.setCurrentProfile(e),e===ri.rG.REPLIT_DEFAULT?nx("profile-changed",{profile:"replit"}):e===ri.rG.GITHUB&&nx("profile-changed",{profile:"github"})}})})}var aD=n(39390),aG=n(10981),aB=n(75582),aP=n(99165);function aA(){var e=(0,ex._)(["\n  query GithubRemoteConfigRepl($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        description\n        isPrivate\n        slug\n        url\n      }\n    }\n  }\n"]);return aA=function(){return e},e}function aN(){var e=(0,ex._)(['\n  query GithubRemoteConfigUser {\n    currentUser {\n      ... on CurrentUser {\n        id\n        gitHubInfo {\n          accessToken\n        }\n        repositories(count: 1, after: "0") {\n          ... on RepositoryConnection {\n            items {\n              id\n            }\n          }\n        }\n      }\n    }\n  }\n']);return aN=function(){return e},e}function aL(){var e=(0,ex._)(["\n  mutation GithubRemoteConfigCreateGithubRepo($input: CreateGithubRepoInput!) {\n    createGithubRepo(input: $input) {\n      ... on CreateGithubRepoResult {\n        remoteUrl\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return aL=function(){return e},e}var aU={},aO=(0,eC.Ps)(aA());aN();var aM=(0,eC.Ps)(aL()),aX=(0,b.X)({errorText:[x.l0.color.accentNegativeStronger,x.l0.pl(4)]});function aF(e){var t,n,r,i,o=e.remoteName,a=e.updateRemote,l=(0,ao.Z)().showConfirm,c=(0,C.Z)().git,s=(0,t_.Z)(),d=rs(),h=(0,aG.U)(),p=(0,eZ.Z)(),m=(0,_.useRef)(null),v=(0,_.useRef)(null),b=(0,u._)((0,_.useState)(),2),w=b[0],Z=b[1],S=(t=(0,U._)({},aU,{variables:{replId:p}}),eS.a(aO,t)).data,k=(null==S?void 0:S.repl.__typename)==="Repl"?S.repl:{slug:void 0,description:void 0,isPrivate:void 0,url:void 0},E=k.slug,T=k.description,R=k.isPrivate,I=k.url,D=(0,u._)((n=(0,U._)({},aU,void 0),aP.D(aM,n)),2),G=D[0],B=D[1].loading,P=(0,ra.v)({onAuth:function(){nx("github-user-connected")}}),A=(0,u._)((0,_.useState)(null==R||R),2),N=A[0],L=A[1],O=(0,u._)((0,_.useState)(E),2),M=O[0],F=O[1],H=(0,u._)((0,_.useState)(),2),V=H[0],z=H[1],j=(0,u._)((0,_.useState)(null!=T?T:I&&"Repository for https://replit.com".concat(I)),2),q=j[0],Y=j[1],J=(0,u._)((0,_.useState)(),2),K=J[0],$=J[1],Q=function(){z(void 0),$(void 0),Z(void 0)},ee=(r=(0,ts._)(function(e){var t,n,r;return(0,tu.Jh)(this,function(i){switch(i.label){case 0:return[4,c.getRemotes()];case 1:if((t=i.sent()).error)return Z("Error finding current remotes, ".concat(t.error)),[2];if(!t.remotes.has(o))return[3,3];return[4,c.setRemoteURL({remote:o,url:e})];case 2:if((n=i.sent()).error)return Z("Error (".concat(n.error,") setting ").concat(o," to use ").concat(e," as a remote.")),[2];return a(e),nx("remote-edited"),[2];case 3:return[4,c.addRemote({name:o,url:e})];case 4:if((r=i.sent()).error)return Z("Error (".concat(r.error,") adding ").concat(o," ").concat(e," as a remote.")),[2];return a(e),nx("remote-added"),[2]}})}),function(e){return r.apply(this,arguments)}),et=(i=(0,ts._)(function(){var e,t,n,r;return(0,tu.Jh)(this,function(i){switch(i.label){case 0:if(Q(),!M)return[2];if(!(0,nl.GE)(M))return z("Invalid remote name."),[2];return[4,G({variables:{input:{name:M,description:null!=T?T:null,homepage:"replit.com".concat(I),isPrivate:N,ownerType:aB.xJ.User}}})];case 1:if((null===(e=(r=i.sent()).data)||void 0===e?void 0:e.createGithubRepo.__typename)==="UnauthorizedError"||(null===(t=r.data)||void 0===t?void 0:t.createGithubRepo.__typename)==="UserError")return Z(r.data.createGithubRepo.message),[2];return(null===(n=r.data)||void 0===n?void 0:n.createGithubRepo.__typename)==="CreateGithubRepoResult"&&(ee(r.data.createGithubRepo.remoteUrl),nx("github-repository-published"),l("Created repository on Github")),[2]}})}),function(){return i.apply(this,arguments)});return d?(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"Repository name"}),(0,f.tZ)(X.II,{ref:m,placeholder:"Enter repository name",value:M,onChange:function(e){z(void 0),F(e.target.value)},onKeyDown:function(e){if("Enter"===e.key){var t;e.preventDefault(),null===(t=v.current)||void 0===t||t.focus()}}}),(0,f.tZ)(g.xv,{css:aX.errorText,multiline:!1,children:V}),(0,f.tZ)(aw.Z,{height:1}),(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"Repository description"}),(0,f.tZ)(X.B,{ref:v,maxLength:350,name:"Repository description",placeholder:"Enter repository description",value:null!=q?q:void 0,onChange:function(e){$(void 0),Y(e.target.value)}}),(0,f.tZ)(g.xv,{css:aX.errorText,multiline:!1,children:K}),(0,f.tZ)(aw.Z,{height:1}),(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"Privacy"}),(0,f.BX)(eQ.hE,{tag:"fieldset",id:h("privacy"),name:h("privacy"),value:N,onChange:function(e){return L(e)},row:!0,css:[x.l0.width("100%")],children:[(0,f.tZ)(eQ.rK,{id:h("false"),value:!1,text:"Public",icon:(0,f.tZ)(aD.Z,{})}),(0,f.tZ)(eQ.rK,{id:h("true"),value:!0,text:"Private",icon:(0,f.tZ)(tj.Z,{})})]}),(0,f.tZ)(aw.Z,{height:2}),(0,f.tZ)(W.zx,{text:B?"Creating Repository on GitHub":"Create Repository on GitHub",colorway:"primary",iconLeft:(0,f.tZ)(rc.Z,{}),onClick:et,loading:B}),w?(0,f.tZ)(g.xv,{css:aX.errorText,maxLines:2,multiline:!1,children:w}):null]}):s?(0,f.tZ)(y.G,{children:(0,f.tZ)(W.zx,{colorway:"primary",iconLeft:(0,f.tZ)(rc.Z,{}),text:"Open Account page to connect to GitHub",onClick:function(){ro.X.openExternalUrl("/account#connected-services")}})}):(0,f.tZ)(y.G,{children:(0,f.tZ)(W.zx,{colorway:"primary",iconLeft:(0,f.tZ)(rc.Z,{}),text:"Connect to GitHub",onClick:P})})}var aW=(0,ep.iv)(x.l0.border({width:1,color:x.TV.outlineDimmer}),x.l0.borderRadius(8)),aH=(0,ep.iv)(nn.gU.filled,x.l0.flex.row,x.l0.justify.spaceBetween,x.l0.align.center,x.l0.px(8),x.l0.py(4),x.l0.borderRadius(8,8,0,0)),aV=(0,ep.iv)(x.l0.borderRadius(8,8,0,0)),az=(0,ep.iv)(x.l0.borderRadius(8)),aj=(0,ep.iv)(x.l0.p(8)),aq=(0,ep.iv)(x.l0.flex.growAndShrink(1));function aY(e){var t=e.title,n=e.expanded,r=e.content,i=e.onClick;return(0,f.BX)(y.G,{css:aW,children:[(0,f.BX)(y.G,{css:[aH,n?aV:az],onClick:i,children:[(0,f.tZ)(y.G,{css:aq,children:(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:t})}),n?(0,f.tZ)(e1.Z,{size:20}):(0,f.tZ)(e0.Z,{size:20})]}),n?(0,f.tZ)(y.G,{css:aj,children:r}):null]})}var aJ=(0,ep.iv)(x.l0.rowWithGap(4)),aK=(0,ep.iv)(x.l0.flex.growAndShrink(1)),a$=(0,ep.iv)(x.l0.color.accentNegativeStronger,x.l0.pl(4));function aQ(e){var t,n=e.initialRemoteUrl,r=e.remoteName,i=e.updateRemote,o=(0,C.Z)().git,a=(0,u._)((0,_.useState)(),2),l=a[0],c=a[1];(0,_.useEffect)(function(){c(void 0)},[n]);var s=(0,u._)((0,_.useState)(),2),d=s[0],h=s[1],p=(0,u._)((0,_.useState)(!1),2),m=p[0],v=p[1],b=(t=(0,ts._)(function(){var e,t,n;return(0,tu.Jh)(this,function(a){switch(a.label){case 0:if(a.trys.push([0,5,6,7]),!l)return[2];if(v(!0),!(0,nl.LY)(l))throw Error("Invalid remote url.");return[4,o.getRemotes()];case 1:if((e=a.sent()).error)throw Error("Error finding current remotes, ".concat(e.error));if(!e.remotes.has(r))return[3,3];return[4,o.setRemoteURL({remote:r,url:l})];case 2:if((t=a.sent()).error)throw th({context:"remote-input",gitService:o,result:t,data:{remote:r,url:l}}),Error("Error (".concat(t.error,") setting ").concat(r," to use ").concat(l," as a remote."));return nx("remote-edited"),i(l),[2];case 3:return[4,o.addRemote({name:r,url:l})];case 4:if((n=a.sent()).error)throw th({context:"remote-input",gitService:o,result:n,data:{remote:r,url:l}}),Error("Error (".concat(n.error,") adding ").concat(r," ").concat(l," as a remote."));return nx("remote-added"),[3,7];case 5:return h(a.sent().message),[3,7];case 6:return v(!1),[7];case 7:return[2]}})}),function(){return t.apply(this,arguments)});return(0,f.BX)(y.G,{children:[(0,f.tZ)(X.II,{name:"Remote URL",placeholder:"Enter Remote URL",value:null!=l?l:n,autoComplete:"off",autoCorrect:"off",onChange:function(e){h(void 0),c(e.target.value)},inputMode:"url","aria-label":"Remote URL",onKeyDown:function(e){"Enter"===e.key&&b()}}),d?(0,f.tZ)(g.xv,{variant:"small",css:a$,multiline:!1,children:d}):null,l&&l!==n?(0,f.BX)(f.HY,{children:[(0,f.tZ)(aw.Z,{height:1}),(0,f.BX)(y.G,{css:aJ,children:[(0,f.tZ)(W.zx,{css:aK,text:"Cancel",iconLeft:(0,f.tZ)(rr.Z,{}),onClick:function(){return c(void 0)}}),(0,f.tZ)(W.zx,{css:aK,text:m?"Saving":"Save",loading:m,colorway:"primary",iconLeft:(0,f.tZ)(rl.Z,{}),onClick:b})]})]}):null]})}var a0="origin";function a1(){var e,t=(0,td.Z)((e=(0,ts._)(function(e){var t,n,r,i;return(0,tu.Jh)(this,function(o){switch(o.label){case 0:return[4,e.getRemotes()];case 1:if((t=o.sent()).error)return th({context:"remote-config",gitService:e,result:t}),[2,{url:void 0,name:a0,error:t.error}];if(!(r=(0,u._)(null!==(n=t.remotes.values())&&void 0!==n?n:void 0,1)[0]))return[2,{url:void 0,name:a0,error:null}];return[2,{url:r.push||r.fetch,name:null!==(i=r.name)&&void 0!==i?i:a0,error:null}]}})}),function(t){return e.apply(this,arguments)}));return null==t?(0,f.BX)(y.G,{css:x.l0.center,children:[(0,f.tZ)(g.xv,{color:"dimmest",multiline:!1,children:"Loading remote information."}),(0,f.tZ)(ox,{})]}):(null==t?void 0:t.error)?null:(0,f.tZ)(a2,{initialRemoteUrl:null==t?void 0:t.url,remoteName:null==t?void 0:t.name})}function a2(e){var t=e.initialRemoteUrl,n=e.remoteName,r=(0,u._)((0,_.useState)(t),2),i=r[0],o=r[1],a=(0,u._)((0,_.useState)(""===t||void 0===t?0:void 0),2),l=a[0],c=a[1],s=function(e){o(e)};return(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Remote"}),(0,f.tZ)(aw.Z,{height:1}),(0,f.tZ)(aQ,{remoteName:n,initialRemoteUrl:i,updateRemote:s}),(0,f.tZ)(aw.Z,{height:2}),(0,f.tZ)(aY,{title:"GitHub",expanded:0===l,onClick:function(){return c(function(e){return 0===e?void 0:0})},content:(0,f.tZ)(aF,{remoteName:n,updateRemote:s})})]})}(gT=gX||(gX={}))[gT.GitHub=0]="GitHub";var a8=(0,ep.iv)(x.l0.px(16));function a4(){return(0,f.BX)(y.G,{css:a8,children:[(0,f.tZ)(aw.Z,{height:2}),(0,f.tZ)(a1,{}),(0,f.tZ)(aw.Z,{height:2}),(0,f.tZ)(a3,{})]})}function a3(){return(0,f.BX)(y.G,{children:[(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Commit author"}),(0,f.tZ)(aw.Z,{height:1}),(0,f.tZ)(aI,{})]})}var a5=(0,b.X)({gitPane:[x.l0.position.relative,x.l0.display.flex,x.l0.minHeight("100%")],gitPaneContent:[x.l0.flex.growAndShrink(1),x.l0.overflow("auto")]});function a6(e){var t,n,r,i=e.isActive,o=e.performPaneOperation,a=(0,tQ.P5)({controlName:"flag-git-commit-view",logFlagToAnalytics:!1}),l=(0,_.useRef)(),c=(0,u._)((0,_.useState)(gO.CURRENT_BRANCH),2),s=c[0],d=c[1],h=(0,u._)((0,_.useState)(null),2),p=h[0],m=h[1],v=(0,u._)((0,_.useState)(null),2),g=v[0],y=v[1],b=(0,u._)((0,_.useState)(!1),2),w=b[0],Z=b[1];t=void 0!==i&&i,n=(0,C.Z)().git,(0,_.useEffect)(function(){t&&n.forceRefresh()},[t,n]);var x=(0,td.Z)((r=(0,ts._)(function(e){var t,n,r,i,o,a,l,c,s,u;return(0,tu.Jh)(this,function(d){switch(d.label){case 0:return[4,e.getRepositoryState()];case 1:if((t=d.sent()).error)return[2,t];if(n=t.state,r=t.type,i=null,o=null,a=null,!(r!==t0.y5.INITIALIZING))return[3,6];return[4,e.status()];case 2:if((l=d.sent()).error)return th({context:"git-pane-status",gitService:e,result:l,data:{state:n,type:r}}),[2,l];return i=l,[4,e.getRemotes()];case 3:if((c=d.sent()).error)return th({context:"git-pane-remotes",gitService:e,result:c,data:{state:n,type:r}}),[2,c];if(o=c.remotes,!i.branch)return[3,5];return[4,e.getBranch(i.branch)];case 4:if((s=d.sent()).error)return th({context:"git-pane-branch",gitService:e,result:s,data:{state:n,type:r}}),[2,s];a=s.branch,d.label=5;case 5:return[3,8];case 6:return[4,e.status()];case 7:if((u=d.sent()).error)return th({context:"git-pane-status-initializing",gitService:e,result:u,data:{state:n,type:r}}),[2,{state:n,type:r,status:i,remotes:o,currentBranch:a,error:null}];i=u,d.label=8;case 8:return[2,{state:n,type:r,status:i,remotes:o,currentBranch:a,error:null}]}})}),function(e){return r.apply(this,arguments)})),S=!x||x.error?null:x.currentBranch,k=(0,_.useCallback)(function(e){switch(d(e),e){case gO.DASHBOARD:nx("pane-mode-changed",{mode:"dashboard"});break;case gO.BRANCH:nx("pane-mode-changed",{mode:"branch"});break;case gO.CURRENT_BRANCH:nx("pane-mode-changed",{mode:"current-branch"});break;case gO.SETTINGS:nx("pane-mode-changed",{mode:"settings"})}},[]),E=(0,_.useCallback)(function(){l.current?(k(l.current),l.current=void 0):k(gO.CURRENT_BRANCH)},[k]),T=(0,_.useCallback)(function(e){var t=function(e){l.current=s,k(e)};switch(e.mode){case gO.DASHBOARD:t(gO.DASHBOARD);break;case gO.BRANCH:if((0,t1.p3)(e.branch,S)){t(gO.CURRENT_BRANCH);break}y(e.branch),t(gO.BRANCH);break;case gO.CURRENT_BRANCH:t(gO.CURRENT_BRANCH);break;case gO.SETTINGS:t(gO.SETTINGS);break;case gO.COMMIT:m(e.hash),t(gO.COMMIT)}},[k,s,S]),R=(0,_.useCallback)(function(e){var t=(0,P.Dp)({path:e});"codeEditor"===t?o({operation:"open",pane:{type:"diff",data:{left:{path:e,data:{type:"git",revision:"HEAD"}},right:{path:e,data:{type:"fs"}}}}}):o({operation:"open",pane:{type:t,data:{path:e}}})},[o]),I=(0,_.useCallback)(function(e){T({mode:gO.COMMIT,hash:e})},[T]),D=(0,_.useCallback)(function(){Z(!0)},[]);if(s===gO.BRANCH&&(0,t1.p3)(g,S)&&k(gO.CURRENT_BRANCH),(0,_.useEffect)(function(){return Z(!1)},[x]),w||!x||x.error)return(0,f.tZ)(a9,{children:(null==x?void 0:x.error)?(0,f.tZ)(oq,{error:x.error}):(0,f.tZ)(ox,{})});switch(x.type){case t0.y5.INITIALIZING:case t0.y5.INTERMEDIATE:case t0.y5.DETACHED_HEAD:return(0,f.tZ)(a9,{children:(0,f.tZ)(a7,{state:x.state,status:x.status,onFileClick:R,gotoPendingState:D})});case t0.y5.NORMAL:if(s===gO.BRANCH&&!g||s===gO.CURRENT_BRANCH&&!S)return(0,f.tZ)(a9,{header:(0,f.tZ)(n9,{mode:gO.DASHBOARD,branch:null,switchMode:T,onBack:E}),children:(0,f.tZ)(oA,{currentBranch:null,switchMode:T})});return(0,f.tZ)(a9,{header:(0,f.tZ)(n9,{mode:s,branch:s===gO.CURRENT_BRANCH?S:g,switchMode:T,onBack:E}),children:(0,f.tZ)(le,{mode:s,status:x.status,remotes:x.remotes,previewBranch:g,previewCommit:p,currentBranch:S,switchMode:T,onStagedFileClick:R,onViewCommitClick:a?I:void 0,onViewSettingsClick:function(){return T({mode:gO.SETTINGS})},gotoPendingState:D})})}}function a9(e){var t=e.header,n=e.children,r=(0,u._)((0,_.useState)(function(){return(0,t8.MT)()}),1)[0];return(0,f.tZ)(t4.Provider,{value:r,children:(0,f.BX)(y.G,{css:a5.gitPane,children:[(0,f.tZ)(rS,{}),t,(0,f.tZ)(y.G,{css:a5.gitPaneContent,children:n})]})})}function a7(e){var t=e.state,n=e.status,r=e.onFileClick,i=e.gotoPendingState;switch(t){case t0.yG.NOT_INITIALIZED:return(0,f.tZ)(oF,{});case t0.yG.ON_UNBORN_BRANCH:return(0,f.tZ)(oz,{onFileClick:r,status:n});case t0.yG.MERGING:return(0,f.tZ)(ab,{onFileClick:r,gotoPendingState:i});case t0.yG.REBASING:return(0,f.tZ)(oW,{});case t0.yG.REVERTING:return(0,f.tZ)(oH,{});case t0.yG.CHERRY_PICKING:return(0,f.tZ)(o_,{});case t0.yG.APPLYING_MAILBOX:return(0,f.tZ)(rk,{});case t0.yG.BISECTING:return(0,f.tZ)(r_,{});case t0.yG.DETACHED_HEAD:return(0,f.tZ)(oN,{});default:return null}}function le(e){var t=e.mode,n=e.status,r=e.remotes,i=e.previewBranch,o=e.previewCommit,a=e.currentBranch,l=e.switchMode,c=e.onStagedFileClick,s=e.onViewCommitClick,u=e.onViewSettingsClick,d=e.gotoPendingState;switch(t){case gO.DASHBOARD:return(0,f.tZ)(oA,{currentBranch:a,switchMode:l});case gO.BRANCH:return(0,f.tZ)(oS,{status:n,branch:i,remotes:r,onStagedFileClick:c,onViewCommitClick:s,onViewSettingsClick:u,gotoPendingState:d});case gO.CURRENT_BRANCH:return(0,f.tZ)(oS,{status:n,remotes:r,branch:a,onStagedFileClick:c,onViewCommitClick:s,onViewSettingsClick:u,gotoPendingState:d,current:!0});case gO.SETTINGS:return(0,f.tZ)(a4,{});case gO.COMMIT:return(0,f.tZ)(ad,{status:n,remotes:r,onViewCommitClick:s,hash:o,switchMode:l});default:(0,t7.Z)(t)}}var lt=h.Dy.Object({type:h.Dy.Literal("git")}),ln={Content:function(e){var t=e.options,n=t.isActive,r=t.performPaneOperation;return(0,f.tZ)(a6,{isActive:n,performPaneOperation:r})},Icon:function(e){var t=e.size;return(0,f.tZ)(t$.Z,{size:t})},getTitle:function(){return"Git"},decode:function(e){return p.B4.Decode(lt,e)}},lr=n(80711),li=n(99418);function lo(e){var t=e.onClose;return(0,f.tZ)(W.zx,{text:"Cancel",onClick:function(){(0,li.p)("historyExplicitlyClosed"),t()}})}var la=n(10099),ll=n(31171),lc=(0,ep.iv)({filter:"grayscale(100%) opacity(0.5)",pointerEvents:"none"});function ls(){var e,t="/replEnvironmentMobile"===(0,aC.useRouter)().pathname,n=(0,ll.bA)(),r=(0,ll._Z)(),i=(0,aG.U)(),o=!n||0===n.count;return(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8),x.l0.align.center,o?lc:null],children:[(0,f.tZ)(la.Z,{id:i("diffButton"),isOn:null!==(e=null==n?void 0:n.comparing)&&void 0!==e&&e,onChange:function(e){o||r({comparing:e.target.checked})}}),(0,f.tZ)("label",{css:[{cursor:"pointer",userSelect:"none"},x.l0.flex.column,x.l0.align.center],htmlFor:i("diffButton"),children:(0,f.tZ)(g.xv,{multiline:!1,children:t?"Compare":"Compare Latest"})})]})}function lu(){var e=(0,ll.bA)();if(!e||0===e.count)return null;var t=e.changes[e.version].timestamp;return(0,f.tZ)(no.EK,{textColor:"dimmer",dateFormat:"switch",date:t})}var ld=n(28908);function lf(e){var t=e.reversed,n=void 0!==t&&t,r=e.hideName,i=void 0!==r&&r,o=e.color,a=void 0===o?"default":o,l=(0,ll.bA)(),c=(0,_.useMemo)(function(){return[n?x.l0.rowReverseWithGap(4):x.l0.rowWithGap(4),x.l0.align.center]},[n]);if(!l)return null;if(0===l.count)return(0,f.BX)(y.G,{css:c,children:[(0,f.tZ)(ld.Z,{size:24}),(0,f.tZ)(g.xv,{color:a,multiline:!1,children:"Server Authored"})]});var s=l.changes[l.version];if(!l.users)return(0,f.BX)(y.G,{css:c,children:[(0,f.tZ)(ns.q,{size:24,src:"/public/images/ghost.svg",username:"Unknown"}),i?null:(0,f.tZ)(g.xv,{color:a,multiline:!1,children:"Unknown"})]});var u=l.users[s.userId];return u?(0,f.BX)(y.G,{css:c,children:[(0,f.tZ)(ns.q,{size:24,src:u.image,username:u.username}),i?null:(0,f.tZ)(g.xv,{color:a,multiline:!1,children:u.username})]}):s.timestamp>16546464e5?(0,f.BX)(y.G,{css:c,children:[(0,f.tZ)(ld.Z,{size:24}),i?null:(0,f.tZ)(g.xv,{color:a,multiline:!1,children:"Server Authored"})]}):(0,f.BX)(y.G,{css:c,children:[(0,f.tZ)(ns.q,{size:24,src:"/public/images/ghost.svg",username:"Unknown"}),i?null:(0,f.tZ)(g.xv,{color:a,multiline:!1,children:"Unknown"})]})}var lh=n(97615),lp=n(12285),lm=n(4955),lv=n(14105),lg=n(9670),ly=function(e){"use strict";(0,lm._)(n,e);var t=(0,lg._)(n);function n(e){var r;return(0,lp._)(this,n),(r=t.call(this,e)).name="UserError",r}return n}((0,lv._)(Error)),lb=n(94376);function lw(){var e=(0,ex._)(["\n  query WorkspaceHistory2Users($ids: [Int!]!) {\n    currentUser {\n      id\n      username\n      image\n    }\n    usersByIds(ids: $ids) {\n      id\n      username\n      image\n    }\n  }\n"]);return lw=function(){return e},e}function lZ(){var e=(0,ex._)(["\n  query WorkspaceHistory2CurrentUserDate {\n    currentUser {\n      id\n      timeCreated\n    }\n  }\n"]);return lZ=function(){return e},e}var lx=(0,eC.Ps)(lw());function lC(e,t,n){return new Promise(function(r,i){try{var o,a=e.watchTextFile(t,{onReady:(o=(0,ts._)(function(e){var t,o;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,n(e)];case 1:return t=l.sent(),r(t),[3,3];case 2:return o=l.sent(),i(o),[3,3];case 3:return a(),[2]}})}),function(e){return o.apply(this,arguments)})})}catch(e){i(e)}})}lZ();var lS=lb.I;function lk(){return(lk=(0,ts._)(function(e,t){var n,r,i,o,a,l,c,s,u,f,h,p,m,v,g,y,b,w;return(0,tu.Jh)(this,function(Z){switch(Z.label){case 0:n=new Set,r=!0,i=!1,o=void 0;try{for(a=t[Symbol.iterator]();!(r=(l=a.next()).done);r=!0)(c=l.value).userId&&n.add(c.userId)}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}if(0===n.size)return[2,{}];if(n.size>=lS)return[2,"too_many_users"];return[4,e.query({query:lx,variables:{ids:Array.from(n)}})];case 1:if(u=(s=Z.sent()).data,f=s.error)throw f;h=u.currentUser?[u.currentUser].concat((0,d._)(u.usersByIds)):u.usersByIds,p={},m=!0,v=!1,g=void 0;try{for(y=h[Symbol.iterator]();!(m=(b=y.next()).done);m=!0)p[(w=b.value).id]={id:w.id,username:w.username,image:w.image}}catch(e){v=!0,g=e}finally{try{m||null==y.return||y.return()}finally{if(v)throw g}}return[2,p]}})})).apply(this,arguments)}function l_(){return(l_=(0,ts._)(function(e,t,n){var r,i,o;return(0,tu.Jh)(this,function(a){switch(a.label){case 0:var l;return[4,lC(e,n,(l=(0,ts._)(function(e){var t,n;return(0,tu.Jh)(this,function(r){return(t=e.fetchChanges,0===(n=e.version))?[2,{isDisposed:!1,result:[]}]:[2,t(1,n,"")]})}),function(e){return l.apply(this,arguments)}))];case 1:if((r=a.sent()).isDisposed)return[2,{data:null,handledError:"File deleted or removed."}];return[4,function(e,t){return lk.apply(this,arguments)}(t,i=r.result)];case 2:if("too_many_users"===(o=a.sent()))return[2,{data:{changes:i,users:null},handledError:null}];return[2,{data:{changes:i,users:o},handledError:null}]}})})).apply(this,arguments)}(gF||(gF={})).TooManyUsersRequestedError="too_many_users";var lE=(0,ep.iv)({display:"grid",gridTemplateColumns:"auto 1fr",rowGap:"0.5rem",columnGap:"1rem","> dt":{display:"flex",alignItems:"center",fontWeight:"bold"}});function lT(e){var t=e.onCloseHistory,n=(0,ao.Z)().showError,r=(0,u._)((0,_.useState)(!1),2),i=r[0],o=r[1],a=(0,u._)((0,_.useState)(!1),2),l=a[0],c=a[1],s=(0,C.Z)().fs,d=(0,ll.bA)(),h=(0,li.j)(),p="Reset",m=!0;function v(){return(v=(0,ts._)(function(){var e,r;return(0,tu.Jh)(this,function(i){switch(i.label){case 0:if(!d||!s||l)return[2];i.label=1;case 1:var a,u;return i.trys.push([1,3,4,5]),c(!0),(0,li.p)("versionRestored"),e=d.filePath,[4,(a=d.version+1,lC(s,e,(u=(0,ts._)(function(e){var t,n,r,i,o,l,c,u;return(0,tu.Jh)(this,function(d){switch(d.label){case 0:if(t=e.fetchChanges,n=e.writeChange,a>(r=e.version))throw Error("Cannot reset to a version that does not exist");if(a===r)return[2];i=null,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,t(1,r,"")];case 2:if((o=d.sent()).isDisposed)throw new ly("File deleted or removed.");return i=o.result,[3,4];case 3:throw d.sent(),new ly("Something went wrong while resetting the file. It is possible that a bad connection is to blame. Please try again.");case 4:c=(l=(0,M._)(i.slice(a,i.length).reverse()))[0],u=l.slice(1).reduce(function(e,t){return e.compose(t.invertedChanges)},c.invertedChanges);try{n(u)}catch(e){throw tf.Tb(e),new ly("Something went wrong while resetting the file. Maybe the file changed while you were restoring it? Please try again.")}return[4,s.flush()];case 5:return d.sent(),[2]}})}),function(e){return u.apply(this,arguments)})))];case 2:return i.sent(),t(),[3,5];case 3:if((r=i.sent())instanceof ly)return n(r.message),[2];return h(r,"restore"),[3,5];case 4:return o(!1),c(!1),[7];case 5:return[2]}})})).apply(this,arguments)}return d?0===d.count?(p="No history",m=!0):l||i?(p="Resetting...",m=!0):d.playing?(p="Playing...",m=!0):d.version===d.count-1?(p="Viewing latest",m=!0):(p="Reset editor to here",m=!1):(p="Loading...",m=!0),(0,f.BX)(f.HY,{children:[(0,f.tZ)(W.zx,{text:p,disabled:m,onClick:function(){return o(!0)},colorway:"primary",iconLeft:(0,f.tZ)(lr.Z,{})}),d&&0!==d.count&&(0,f.tZ)(rE.u,{isOpen:i,onRequestClose:function(){l||o(!1)},children:(0,f.BX)(y.G,{css:x.l0.colWithGap(24),children:[(0,f.tZ)(g.h4,{variant:"headerDefault",level:2,children:"Reset file version"}),(0,f.tZ)(H.Tg,{elevated:!0,css:[x.l0.px(16),x.l0.py(12),x.l0.borderRadius(8)],children:(0,f.BX)("dl",{css:lE,children:[(0,f.tZ)("dt",{children:"File"}),(0,f.tZ)("dd",{children:d.filePath}),(0,f.tZ)("dt",{children:"Version"}),(0,f.BX)("dd",{children:[d.version+1,(0,f.BX)("span",{css:[x.l0.color.foregroundDimmest],children:[(0,f.tZ)("span",{css:x.l0.mx(8),children:"/"}),d.count]})]}),(0,f.tZ)("dt",{children:"Date"}),(0,f.tZ)("dd",{children:(0,f.tZ)(no.EK,{date:d.changes[d.version].timestamp,dateFormat:"absolute"})}),(0,f.tZ)("dt",{children:"Author"}),(0,f.tZ)("dd",{children:(0,f.tZ)(lf,{})})]})}),(0,f.tZ)(rT.E,{icon:(0,f.tZ)(lh.Z,{}),colorway:"positive",text:"Resetting is non-destructive. The reset content will become a new version at the end of history. You can always go back to the version you just had."}),(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8),x.l0.justify.end],children:[(0,f.tZ)(W.zx,{text:"Cancel",disabled:l,onClick:function(){return o(!1)}}),(0,f.tZ)(W.zx,{text:l?"Resetting Version...":"Reset Version",disabled:l,colorway:"primary",onClick:function(){return v.apply(this,arguments)},iconLeft:(0,f.tZ)(lr.Z,{})})]})]})})]})}var lR=n(44166),lI=(0,_.forwardRef)(function(e,t){var n=(0,ll.bA)(),r=(0,_.useRef)(null);(0,_.useImperativeHandle)(t,function(){return r.current}),n&&r.current&&(r.current.setAttribute("aria-valuemin","1"),r.current.setAttribute("aria-valuemax",String(n.count)),r.current.setAttribute("aria-valuenow",String(n.version+1)));var i=(0,_.useMemo)(function(){return(0,f.tZ)("div",{ref:r,role:"slider",tabIndex:0,css:{position:"absolute",top:"0",left:"calc((100% - 16px) * var(--scrubber-progress, 0))",width:"16px",height:"16px",backgroundColor:x.TV.accentPrimaryDefault,borderRadius:"100%",outline:"none",cursor:"pointer",transition:"left var(--scrubber-transition-time, 100ms) ease-out",willChange:"left, transition",":focus":{boxShadow:"0 0 0 1px ".concat(x.TV.foregroundDefault," inset")}}})},[]);return n&&n.count>1?i:null}),lD=(0,_.forwardRef)(function(e,t){var n=(0,ll.bA)(),r=(0,_.useMemo)(function(){return(0,f.BX)(f.HY,{children:[(0,f.tZ)("div",{ref:t,"aria-hidden":!0,css:{position:"relative",top:"0",width:"100%",height:"16px",margin:"0",cursor:"pointer"}}),(0,f.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:"6px",left:"0",width:"100%",height:"4px",margin:"0",overflow:"hidden",pointerEvents:"none",backgroundColor:x.TV.backgroundHighest,borderRadius:"2px"},children:(0,f.tZ)("div",{"aria-hidden":!0,css:{position:"absolute",top:"0",left:"0",width:"100%",height:"4px",margin:"0",pointerEvents:"none",backgroundColor:x.TV.accentPrimaryDefault,transformOrigin:"left",transform:"scaleX(var(--scrubber-progress, 0))",transition:"transform var(--scrubber-transition-time, 100ms) ease-out",willChange:"transform, transition"}})})]})},[t]),i=(0,_.useMemo)(function(){return(0,f.tZ)("div",{ref:t,"aria-hidden":!0,css:{width:"100%",height:"16px",pointerEvents:"none"},children:(0,f.tZ)("div",{css:{position:"absolute",width:"100%",height:"4px",top:"6px",left:"0",backgroundColor:x.TV.backgroundHighest,borderRadius:"2px"}})})},[t]);return n&&n.count>1?r:i}),lG=["ArrowLeft","ArrowRight","Home","End"];function lB(){var e=(0,ll.bA)(),t=(0,ll._Z)(),n=(0,u._)((0,_.useState)(!1),2),r=n[0],i=n[1],o=(0,_.useRef)(null),a=(0,_.useRef)(null),l=(0,_.useRef)(null),c=function(e){(0,lR.A)(o,"--scrubber-transition-time",e)},s=function(e){(0,lR.A)(o,"--scrubber-progress",e.toString())};return e&&!r&&(s(e.version/(e.count-1)),e.playing?c("50ms"):c("100ms")),(0,_.useEffect)(function(){if(e&&a.current&&l.current&&!r){var n=a.current,o=l.current,u=function(r){if(0===r.button){i(!0),o.focus();var a=n.getBoundingClientRect(),l=o.getBoundingClientRect(),u=a.width,d=l.width,f=r.target===n?d/2:r.clientX-l.left,h=null,p=function(n){var r=Math.max(0,Math.min(1,(n-a.left-f)/(u-d)));r!==h&&(h=r,s(r),t({version:Math.round(r*(e.count-1)),playing:!1}))};p(r.clientX);var m=function(e){c("0ms"),p(e.clientX),e.preventDefault(),e.stopPropagation()},v=function(){window.removeEventListener("pointermove",m),window.removeEventListener("pointerup",v),window.removeEventListener("pointercancel",v),c("100ms"),i(!1)};window.addEventListener("pointermove",m),window.addEventListener("pointerup",v),window.addEventListener("pointercancel",v),r.preventDefault(),r.stopPropagation()}};return n.addEventListener("pointerdown",u),o.addEventListener("pointerdown",u),function(){n.removeEventListener("pointerdown",u),o.removeEventListener("pointerdown",u)}}},[e,t,r]),(0,_.useEffect)(function(){if(e&&l.current&&!r){var n=l.current,i=function(n){if(e&&lG.includes(n.key)){var r=n.shiftKey?10:1,i=e.version,o=e.count-1,a=null;switch(n.key){case"ArrowLeft":a=Math.max(0,i-r);break;case"ArrowRight":a=Math.min(o,i+r);break;case"Home":a=0;break;case"End":a=o}null!==a&&(t({version:a,playing:!1}),n.preventDefault(),n.stopPropagation())}};return n.addEventListener("keydown",i),function(){n.removeEventListener("keydown",i)}}},[e,t,r]),(0,_.useMemo)(function(){return(0,f.BX)(y.G,{innerRef:o,css:{position:"relative",height:"16px",width:"100%",touchAction:"none","--scrubber-progress":1,"--scrubber-transition-time":"100ms",":hover, :focus-within":{filter:"brightness(1.1)"},":hover:focus-within":{filter:"brightness(1.2)"}},children:[(0,f.tZ)(lD,{ref:a}),(0,f.tZ)(lI,{ref:l})]})},[])}var lP=n(9331);function lA(){var e=(0,ll.bA)(),t=0,n=0;return e&&0!==e.count&&(t=e.version+1,n=e.count),(0,f.BX)(y.G,{css:[x.l0.rowWithGap(4),x.l0.justify.spaceBetween],children:[(0,f.tZ)(g.xv,{css:{minWidth:"2ch",textAlign:"right"},color:e?"default":"dimmer",multiline:!1,children:t}),(0,f.tZ)(g.xv,{css:{width:"1ch",textAlign:"center"},color:"dimmer",multiline:!1,children:"/"}),(0,f.tZ)(g.xv,{css:{minWidth:"2ch",textAlign:"left"},color:"dimmer",multiline:!1,children:n})]})}var lN=n(56335),lL=n(27187);function lU(e){if(e<0)throw Error('Require at least zero ops to compute pace, got "'+e+'"');return 1/Math.log(e+2)*100}function lO(){var e,t,n,r,i=(0,ll.bA)(),o=(0,ll._Z)(),a=(null!==(t=null==i?void 0:null===(e=i.changes)||void 0===e?void 0:e.length)&&void 0!==t?t:1)-1,l=null!==(n=null==i?void 0:i.version)&&void 0!==n?n:0,c=null!==(r=null==i?void 0:i.playing)&&void 0!==r&&r,s=!i||0===i.count,d=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:lU,i=(0,u._)((0,_.useState)(!1),2),o=i[0],a=i[1],l=(0,_.useCallback)(function(){t(1)},[t]),c=(0,_.useCallback)(function(){if(e+1>n){a(!1);return}t(e+1)},[t,e,n]);return(0,_.useEffect)(function(){if(o){var e=setTimeout(function(){c()},r(n));return function(){return clearTimeout(e)}}},[o,c,r,n]),{isPlaying:o,start:function(){a(!0)},stop:function(){a(!1)},reset:l}}(l,function(e){return o({version:e})},a),h=d.isPlaying,p=d.start,v=d.stop;(0,_.useEffect)(function(){h&&!c?v():!h&&c&&p()},[c,h,p,v]);var g="Loading...";return i&&(h?g="Pause":i.version===i.count-1?g="Play file history from beginning":0===i.version?g="Play file history":i.version>0&&(g="Play file history from here")),(0,f.tZ)(m.hU,{alt:g,size:24,disabled:s,onClick:function(){l===a?o({version:0,playing:!0}):o({playing:!c})},children:h?(0,f.tZ)(lN.Z,{}):(0,f.tZ)(lL.Z,{})})}function lM(){return(0,f.BX)(y.G,{css:[x.l0.rowWithGap(4),x.l0.align.center],children:[(0,f.tZ)(lO,{}),(0,f.tZ)(lX,{}),(0,f.tZ)(lA,{}),(0,f.tZ)(lF,{})]})}function lX(){var e=(0,ll.bA)(),t=(0,ll._Z)(),n=!e||0===e.version||0===e.count;return(0,f.tZ)(m.hU,{alt:"Move backwards one version",size:24,disabled:n,onClick:function(){e&&e.version>0&&t({version:e.version-1})},children:(0,f.tZ)(n$.Z,{})})}function lF(){var e=(0,ll.bA)(),t=(0,ll._Z)(),n=!e||e.version===e.count-1||0===e.count;return(0,f.tZ)(m.hU,{alt:"Move forwards one version",size:24,disabled:n,onClick:function(){e&&e.version<e.count-1&&t({version:e.version+1})},children:(0,f.tZ)(lP.Z,{})})}var lW=n(907);function lH(e){var t,n,r,i,o,a=e.filePath,l=e.onCloseHistory,c="/replEnvironmentMobile"===(0,aC.useRouter)().pathname,s=c?x.l0.borderRadius(0):x.l0.borderRadius(0,0,8,8),d=(0,ll.bA)(),h=(0,ll._Z)(),p=(0,ll.Ai)(),m=(0,li.j)(),v=(n=(t=(0,u._)((0,_.useState)({data:null,loading:!0,error:null,handledError:null}),2))[0],r=t[1],i=(0,C.Z)().fs,o=(0,lW.x)(),(0,_.useEffect)(function(){if(!a){r({data:null,loading:!1,error:null,handledError:null});return}r({data:null,loading:!0,error:null,handledError:null});var e=!1;return(function(e,t,n){return l_.apply(this,arguments)})(i,o,a).then(function(t){var n=t.data,i=t.handledError;if(!e){if(i){r({data:null,loading:!1,error:null,handledError:i});return}r({data:n,loading:!1,error:null,handledError:null})}}).catch(function(t){e||(t instanceof Error||(t=Error(t)),r({data:null,loading:!1,error:t,handledError:null}))}),function(){e=!0}},[a,i,o]),n),b=v.data,w=v.loading,Z=v.error;return(0,_.useEffect)(function(){if(Z){m(Z,"history2-index",{filePath:a});return}if(b&&!w)return h({filePath:a,changes:b.changes,users:b.users}),(0,li.p)("historyLoaded"),function(){p()}},[a,b,w,Z,m,h,p]),(0,f.BX)(y.G,{css:[x.l0.colWithGap(8),x.l0.p(8),x.l0.zIndex(3),x.l0.overflow("hidden"),s,x.l0.backgroundColor.backgroundDefault,{borderTop:"2px solid ".concat(x.TV.backgroundHigher),boxShadow:"rgba(2, 2, 3, 0.125) 0px -16px 32px 0px"}],children:[(0,f.BX)(H.Tg,{css:[x.l0.position.relative,x.l0.colWithGap(4),x.l0.px(12),x.l0.pt(8),x.l0.pb(8),x.l0.align.center,x.l0.borderRadius(8),x.l0.overflow("hidden")],elevated:!0,children:[(0,f.tZ)(lB,{}),(0,f.BX)(y.G,{css:[x.l0.display.flex,x.l0.flex.row,x.l0.align.center,x.l0.justify.spaceBetween,x.l0.width("100%")],children:[(0,f.tZ)(lM,{}),d&&d.count>0?(0,f.BX)(y.G,{css:[x.l0.rowWithGap(4),x.l0.align.center],children:[(0,f.tZ)(lu,{}),w||c?null:(0,f.tZ)(g.xv,{color:"dimmer",multiline:!1,children:""}),(0,f.tZ)(lf,{color:"dimmer",hideName:c,reversed:!0})]}):null]})]}),(0,f.BX)(y.G,{css:[x.l0.display.flex,x.l0.flex.row],children:[(0,f.tZ)(lV,{justify:"flex-start",children:(0,f.tZ)(ls,{})}),(0,f.BX)(lV,{justify:"flex-end",children:[(0,f.tZ)(lo,{onClose:l}),(0,f.tZ)(lT,{onCloseHistory:l})]})]})]})}function lV(e){var t=e.children,n=e.justify;return(0,f.tZ)("div",{css:{display:"flex",flexGrow:1,flexBasis:0,alignItems:"center",justifyContent:n,columnGap:x.TV.space8,minWidth:0},children:t})}var lz=n(99517),lj=n(41691),lq=n(62609),lY=n(54340),lJ=(0,lq.B)();function lK(e){if(!(e instanceof eA.YW))return{compareTo:e.field(lJ.state,!1),changed:!1};var t=e.state.field(lJ.state,!1),n=e.startState.field(lJ.state,!1)!==t;return{compareTo:t,changed:n}}function l$(e,t){e.state.field(lJ.state,!1)!==t&&e.dispatch({effects:lJ.effect.of(t)})}var lQ=eA.QQ.define({create:function(){return null},update:function(e,t){var n=lK(t),r=n.compareTo,i=n.changed;if(!r)return null;if(!t.docChanged&&!i)return e;var o=t.state.doc.toString();return new lY.PO(o,r)}}),l0=null!==(gW=globalThis.requestIdleCallback)&&void 0!==gW?gW:globalThis.requestAnimationFrame,l1=null!==(gH=globalThis.cancelIdleCallback)&&void 0!==gH?gH:globalThis.cancelAnimationFrame,l2=eO.p.line({class:"cm-diff-deleted"}),l8=function(e){"use strict";(0,lm._)(n,e);var t=(0,lg._)(n);function n(e,r){var i;return(0,lp._)(this,n),(i=t.call(this)).insertion=e,i.highlight=r,i}var r=n.prototype;return r.destroy=function(){this.pendingHighlight&&l1(this.pendingHighlight)},r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-inserted cm-line",this.updateDOM(e),e},r.eq=function(e){return!e.pendingHighlight&&this.insertion===e.insertion},r.updateDOM=function(e){var t=this;return this.pendingHighlight&&(l1(this.pendingHighlight),this.pendingHighlight=null),this.insertion.length?e.textContent=this.insertion:e.innerHTML="&nbsp;",this.highlight&&this.insertion.length&&(this.pendingHighlight=l0(function(){if(t.highlight){t.pendingHighlight=null;try{var n=t.highlight();e.innerHTML="",e.append(n)}catch(e){}}})),!0},n}(eO.l9),l4=eA.QQ.define({create:function(){return eO.p.none},update:function(e,t){var n=t.state.field(lQ,!1);if(!n)return eO.p.none;var r=lK(t).changed;if(!t.docChanged&&!r)return e.map(t.changes);var i=[],o=function(e,t){i.push({from:e,to:e,value:t})},a=n.startInsertions();if(a){var l=!0,c=!1,s=void 0;try{for(var u,d=a[Symbol.iterator]();!(l=(u=d.next()).done);l=!0)!function(){var e=u.value,n=new l8(e.content,function(){return l3(t.state,e.content)});o(0,eO.p.widget({widget:n,side:-1,block:!0}))}()}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}var f=!0,h=!1,p=void 0;try{for(var m,v=n.lines()[Symbol.iterator]();!(f=(m=v.next()).done);f=!0)!function(){var e=m.value;if(e.isDeleted&&o(e.from,l2),e.insertions){var n=!0,r=!1,i=void 0;try{for(var a,l=e.insertions[Symbol.iterator]();!(n=(a=l.next()).done);n=!0)!function(){var n=a.value,r=new l8(n.content,function(){return l3(t.state,n.content)});o(e.to,eO.p.widget({widget:r,side:1,block:!0}))}()}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}}}()}catch(e){h=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(h)throw p}}return eO.p.set(i,!0)},provide:function(e){return eO.tk.decorations.from(e)}});function l3(e,t){var n,r=document.createDocumentFragment(),i=null===(n=e.facet(lz.dK))||void 0===n?void 0:n.parser;if(!i){var o=document.createElement("span");return o.textContent=t,r.append(o),r}var a=i.parse(t),l=0;if((0,lj.bW)(a,{style:function(t){return(0,lz.QN)(e,t)}},function(e,n,i){if(e>l){var o=document.createElement("span");o.textContent=t.slice(l,e),r.append(o)}var a=document.createElement("span");a.className=i,a.textContent=t.slice(e,n),r.append(a),l=n}),l<t.length){var c=document.createElement("span");c.textContent=t.slice(l),r.append(c)}return r}var l5=function(e){"use strict";(0,lm._)(n,e);var t=(0,lg._)(n);function n(e){var r;return(0,lp._)(this,n),(r=t.call(this)).line=e,r}var r=n.prototype;return r.eq=function(e){return this.line===e.line},r.toDOM=function(){var e=document.createElement("div");return e.className="cm-diff-gutter-element-fallback",e.innerText=this.line.toString(),e},n}(eO.SJ),l6=function(e){"use strict";(0,lm._)(n,e);var t=(0,lg._)(n);function n(e,r){var i;return(0,lp._)(this,n),(i=t.call(this)).elementClass="cm-diff-gutter-block",i.lines=e,r&&(i.preceding=r),i}var r=n.prototype;return r.eq=function(e){var t,n,r,i;if((null===(t=this.lines)||void 0===t?void 0:t.length)!==(null==e?void 0:null===(n=e.lines)||void 0===n?void 0:n.length)||(null===(r=this.preceding)||void 0===r?void 0:r.length)!==(null==e?void 0:null===(i=e.preceding)||void 0===i?void 0:i.length))return!1;if(this.preceding&&e.preceding)for(var o=0;o<this.preceding.length;o++){var a=this.preceding[o],l=e.preceding[o];if(a.height!==l.height||a.left!==l.left||a.right!==l.right)return!1}if(this.lines&&e.lines)for(var c=0;c<this.lines.length;c++){var s=this.lines[c],u=e.lines[c];if(s.height!==u.height||s.left!==u.left||s.right!==u.right)return!1}return!0},r.toDOM=function(){var e=this,t=document.createElement("div");if(this.preceding){var n=this.preceding.slice().reverse(),r=0,i=!0,o=!1,a=void 0;try{for(var l,c=n[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;r+=s.height;var u=this.piece(s);u.style.position="absolute",u.style.top="-".concat(r,"px"),t.prepend(u)}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}}var f=this.lines.map(function(t){return e.piece(t)});return t.append.apply(t,(0,d._)(f)),t},r.piece=function(e){var t=e.height,n=e.left,r=e.right,i=document.createElement("span");i.className="cm-diff-gutter-part",null!==n&&(i.innerText=n.toString());var o=document.createElement("span");o.className="cm-diff-gutter-part",null!==r&&(o.innerText=r.toString());var a=document.createElement("div");return a.className="cm-diff-gutter-element",a.style.height="".concat(t,"px"),a.append(i,o),(null===n||null===r)&&(null===r&&a.classList.add("cm-diff-gutter-deleted"),null===n&&a.classList.add("cm-diff-gutter-inserted")),a},n}(eO.SJ),l9=(0,eO.v5)({class:"cm-lineNumbers cm-diff-gutter",markers:function(e){var t=e.viewportLineBlocks,n=[],r=lK(e.state).compareTo,i=e.state.field(lQ,!1),o=function(e,t){n.push({from:e,to:e,value:t})};if(!r||!i){var a=!0,l=!1,c=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=s.value,f=e.state.doc.lineAt(d.from).number;if(d.type===eO.kH.Text)o(d.from,new l5(f));else if(Array.isArray(d.type)){var h=!0,p=!1,m=void 0;try{for(var v,g=d.type[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value;if(y.type===eO.kH.Text){o(y.from,new l5(f));break}}}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}return eA.Xs.of(n,!0)}var b=!0,w=!1,Z=void 0;try{for(var x,C=t[Symbol.iterator]();!(b=(x=C.next()).done);b=!0){var S=x.value,k=[],_=e.state.doc.lineAt(S.from).number,E=i.line(_);if(E){var T=e.defaultLineHeight,R=E.offset,I=E.isDeleted,D=E.insertions,G=1===_?i.startInsertions():null,B=G?G.length:0,P=G?[]:null;if(!(Array.isArray(S.type)&&S.type.length>=B+(null!==(U=null==D?void 0:D.length)&&void 0!==U?U:0)+1)){if(G&&P){var A=!0,N=!1,L=void 0;try{for(var U,O,M=G[Symbol.iterator]();!(A=(O=M.next()).done);A=!0){var X=O.value;P.push({height:T,left:null,right:X.number})}}catch(e){N=!0,L=e}finally{try{A||null==M.return||M.return()}finally{if(N)throw L}}}if(k.push({height:S.height,left:_,right:I?null:_+R}),D){var F=!0,W=!1,H=void 0;try{for(var V,z=D[Symbol.iterator]();!(F=(V=z.next()).done);F=!0){var j=V.value;k.push({height:T,left:null,right:j.number})}}catch(e){W=!0,H=e}finally{try{F||null==z.return||z.return()}finally{if(W)throw H}}}o(S.from,new l6(k,P));continue}for(var q=0;q<S.type.length;q++){var Y=S.type[q];if((null==Y?void 0:Y.type)===eO.kH.Text){if(G&&P)for(var J=0;J<G.length;J++){var K,$=G[J],Q=S.type[q-J-1];P.push({height:null!==(K=null==Q?void 0:Q.height)&&void 0!==K?K:T,left:null,right:$.number})}if(k.push({height:Y.height,left:_,right:I?null:_+R}),D)for(var ee=0;ee<D.length;ee++){var et,en=D[ee],er=S.type[q+ee+1];k.push({height:null!==(et=null==er?void 0:er.height)&&void 0!==et?et:T,left:null,right:en.number})}break}}o(S.from,new l6(k,P))}}}catch(e){w=!0,Z=e}finally{try{b||null==C.return||C.return()}finally{if(w)throw Z}}return eA.Xs.of(n,!0)},lineMarkerChange:function(e){if(e.docChanged)return!0;var t=!0,n=!1,r=void 0;try{for(var i,o=e.transactions[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value;if(lK(a).changed)return!0}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!1},initialSpacer:function(e){return new l5(e.state.doc.lines)},updateSpacer:function(e,t){var n=t.state.doc.lines;return lK(t.state).compareTo?new l6([{height:0,left:n,right:n}]):new l5(n)}}),l7="#0053A644",ce="#c93c3733",ct=[eO.tk.theme({".cm-diff-inserted":{backgroundColor:l7},".cm-diff-deleted":{backgroundColor:ce},".cm-diff-gutter .cm-diff-gutter-block":{position:"relative",padding:"0"},".cm-diff-gutter-element":{display:"flex",width:"100%",alignItems:"center",columnGap:"8px",padding:"0 6px",borderLeft:"4px solid transparent"},".cm-diff-gutter-part":{display:"inline-block",height:"100%",width:"50%",textAlign:"center"},".cm-diff-gutter-inserted":{backgroundColor:l7,borderLeftColor:"#0053A6"},".cm-diff-gutter-deleted":{backgroundColor:ce,borderLeftColor:"#c93c37"},".cm-diff-gutter + .cm-foldGutter":{width:"0",transform:"translateX(-12px)",overflow:"visible"},".cm-diff-gutter .cm-diff-gutter-element":{paddingRight:"16px"},".cm-diff-gutter .cm-diff-gutter-element-fallback":{paddingRight:"12px"}}),lJ.state,lQ,l4,l9,(0,lz.mi)({openText:"",closedText:""})],cn=n(4384),cr=function(){"use strict";function e(t){var n=this;(0,lp._)(this,e),this.view=t,this.overlay=document.createElement("div"),this.overlay.className="cm-overlay-generic",this.overlay.style.pointerEvents="none",this.overlay.style.contain="size style",this.overlay.setAttribute("aria-hidden","true"),this.view.scrollDOM.appendChild(this.overlay),this.elements=new Map,this.measureRequest={key:this,read:function(){var e=[],t=n.view.scrollDOM.getBoundingClientRect(),r=n.view.scrollDOM.scrollTop,i=n.view.scrollDOM.scrollLeft,o=!0,a=!1,l=void 0;try{for(var c,s=n.elements.values()[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value,d=u.dom,f=u.pos,h=u.offsetX,p=u.offsetY,m=n.view.coordsAtPos(f),v=n.view.lineBlockAt(f);if(!m){e.push({dom:d,x:null,y:null});continue}var g=v.top-r+t.top+n.view.documentPadding.top,y=Math.round((m.top-g)/n.view.defaultLineHeight)*n.view.defaultLineHeight+g,b=i+m.left-t.left+h,w=r+y-t.top+p;e.push({dom:d,x:b,y:w})}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return e},write:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)!function(){var e=i.value,t=e.dom,n=e.x,r=e.y;if(null===n||null===r)return t.style.visibility="hidden",t.style.transition="none";t.style.visibility="",t.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),t.style.transition.startsWith("none")&&requestAnimationFrame(function(){t.style.transition=""})}()}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}}var t=e.prototype;return t.destroy=function(){this.view.scrollDOM.removeChild(this.overlay)},t.map=function(e){if(e.geometryChanged||e.viewportChanged){if(e.docChanged){var t=Array.from(this.elements.values()),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value,c=e.changes.mapPos(l.pos,-1,eA.gc.TrackDel);if(!c){this.removeElement(l.dom);continue}l.pos=c}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}this.view.requestMeasure(this.measureRequest)}},t.addElement=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!this.elements.has(e)){var i={dom:e,pos:t,offsetX:n,offsetY:r};return this.elements.set(e,i),this.overlay.appendChild(e),e.style.visibility="hidden",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.willChange="transform",e.style.transition="none",this.view.requestMeasure(this.measureRequest),i}},t.removeElement=function(e){this.elements.has(e)&&(this.elements.delete(e),e.parentNode===this.overlay&&this.overlay.removeChild(e))},t.updateElement=function(e,t){var n=t.pos,r=t.offsetX,i=t.offsetY,o=this.elements.get(e);o&&(void 0!==n&&(o.pos=n),void 0!==r&&(o.offsetX=r),void 0!==i&&(o.offsetY=i),this.view.requestMeasure(this.measureRequest))},t.clear=function(){this.elements.clear(),this.overlay.innerHTML=""},e}();(gR=gV||(gV={}))[gR.Insertion=0]="Insertion",gR[gR.Deletion=1]="Deletion";var ci=function(){"use strict";function e(t){(0,lp._)(this,e),this.map=new Map,this.duration=t}var t=e.prototype;return t.set=function(e,t,n,r,i){var o=this.map.get(e);o||(o=new Map,this.map.set(e,o)),o.set(t,{from:e,to:t,time:n,type:r,cursor:i})},t.get=function(e,t){var n=this.map.get(e);if(n)return n.get(t)},t.update=function(t){var n=Date.now(),r=new e(this.duration),i=!0,o=!1,a=void 0;try{for(var l,c=this[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=l.value;if(!(n-s.time>this.duration)){var u=t.changes.mapPos(s.from,-1,eA.gc.TrackDel),d=t.changes.mapPos(s.to,-1,eA.gc.TrackDel);if(null!==u&&null!==d){var f=s.cursor;t.docChanged&&(f=!1),r.set(u,d,s.time,s.type,f)}}}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return t.changes.iterChangedRanges(function(e,t,i,o){r.set(i,o,n,i!==o?0:1,!0)},!0),r},t.cursors=function(){var e,t,n,r,i,o,a;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:e=!0,t=!1,n=void 0,l.label=1;case 1:l.trys.push([1,6,7,8]),r=this[Symbol.iterator](),l.label=2;case 2:if(e=(i=r.next()).done)return[3,5];if(!(o=i.value).cursor)return[3,4];return[4,{type:o.type,pos:o.to}];case 3:l.sent(),l.label=4;case 4:return e=!0,[3,2];case 5:return[3,8];case 6:return a=l.sent(),t=!0,n=a,[3,8];case 7:try{e||null==r.return||r.return()}finally{if(t)throw n}return[7];case 8:return[2]}})},t[Symbol.iterator]=function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.map.values()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=i.value,l=!0,c=!1,s=void 0;try{for(var u,d=a.values()[Symbol.iterator]();!(l=(u=d.next()).done);l=!0){var f=u.value;e.push(f)}}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return e[Symbol.iterator]()},e}(),co="cm-flash-insertion",ca="cm-flash-deletion",cl="cm-flash-element",cc=eO.tk.theme((0,eP._)({},".".concat(co,", .").concat(ca),{display:"inline-block"})),cs=function(e){"use strict";(0,lm._)(n,e);var t=(0,lg._)(n);function n(){return(0,lp._)(this,n),t.apply(this,arguments)}var r=n.prototype;return r.isNested=function(){for(var e=this.parentElement;e&&!e.classList.contains("cm-line");){if(e instanceof n&&e.type===this.type)return!0;e=e.parentElement}return!1},r.stop=function(){var e,t;null===(t=this.animation)||void 0===t||null===(e=t.cancel)||void 0===e||e.call(t)},r.play=function(){var e=this.isPlaying;if(this.stop(),!this.isNested()){var t=Date.now()-parseInt(this.getAttribute("data-time")||"0",10);if(!(t>1e3)){var n=this.type===gV.Insertion?"rgba(100, 255, 0, 0.3)":"rgba(255, 32, 32, 0.25)";this.animate&&(this.animation=this.animate({backgroundColor:e?[n,n,"transparent"]:["transparent",n,"transparent"],offset:[0,.05,1]},{id:"cm-flash-anim",duration:1e3,easing:"ease-in-out",delay:-t}))}}},r.connectedCallback=function(){this.play()},r.attributeChangedCallback=function(e,t,n){"data-time"===e&&n&&this.play()},(0,cn._)(n,[{key:"type",get:function(){return this.classList.contains(co)?gV.Insertion:gV.Deletion}},{key:"isPlaying",get:function(){var e;return(null===(e=this.animation)||void 0===e?void 0:e.playState)==="running"}}],[{key:"observedAttributes",get:function(){return["data-time"]}}]),n}((0,lv._)(HTMLElement));customElements.get(cl)||customElements.define(cl,cs);var cu=function(){"use strict";function e(t){(0,lp._)(this,e),this.view=t,this.prevFlashes=new ci(1e3),this.decorations=eO.p.set([]),this.hasRenderedOnce=!1,this.overlay=new cr(t)}var t=e.prototype;return t.destroy=function(){this.overlay.destroy()},t.update=function(e){if(!this.hasRenderedOnce){e.docChanged&&(this.hasRenderedOnce=!0);return}var t=this.prevFlashes.update(e),n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var c=a.value;switch(c.type){case gV.Insertion:n.push({from:c.from,to:c.to,value:(s=c.time,eO.p.mark({class:co,tagName:cl,attributes:{"data-time":s.toString()}}))});break;case gV.Deletion:var s,u,d=e.state.wordAt(c.from);d&&n.push({from:d.from,to:c.to,value:(u=c.time,eO.p.mark({class:ca,tagName:cl,attributes:{"data-time":u.toString()}}))})}}}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}this.overlay.clear();var f=this.view.defaultLineHeight.toString()+"px",h=!0,p=!1,m=void 0;try{for(var v,g=t.cursors()[Symbol.iterator]();!(h=(v=g.next()).done);h=!0){var y=v.value,b=y.type,w=y.pos,Z=function(e,t){var n=e===gV.Insertion?"rgba(0, 100, 255, 1)":"rgba(255, 32, 32, 1)",r=document.createElement("div");return r.style.width="3px",r.style.height=t,r.style.borderRadius="1px",r.style.backgroundColor=n,r.animate&&r.animate({opacity:[1,0]},{duration:500,delay:400,fill:"forwards"}),r}(b,f);this.overlay.addElement(Z,w)}}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}this.prevFlashes=t,this.decorations=eO.p.set(n,!0)},e}(),cd=eO.lg.fromClass(cu,{decorations:function(e){return e.decorations}}),cf=eA.Wl.lowest([cc,cd]),ch=n(81013),cp=n(75023),cm=n(3574),cv=n(62808),cg=n(11398),cy=function(){"use strict";function e(t){(0,lp._)(this,e),this.changes=[],this.forward=[],this.inverted=[],this.locations=[];var n=!0,r=!1,i=void 0;try{for(var o,a=this,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0)!function(){var e=o.value,t=e.changes,n=e.invertedChanges,r=null,i=!1;t.iterChangedRanges(function(e,t,n,o){i||(r||(r=o),n===o||(i=!0))}),a.forward.push(t),a.inverted.push(n),a.locations.push(r)}()}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}}var t=e.prototype;return t.slice=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;if(t>this.length||n>this.length||t<0||n<0)throw Error("Invalid version range");if(t===n){if(0===this.length)return[eA.as.empty(0),null];var r=this.forward[t].newLength;return[eA.as.empty(r),null]}var i=t<n?cb(this.forward.slice(t,n)):cb(this.inverted.slice(n,t).reverse()),o=t<n?t:n-1,a=null!==(e=this.locations[o])&&void 0!==e?e:null;return null!==a&&a>i.newLength&&(a=i.newLength),[i,a]},t.get=function(e){if(e>this.length||e<0)throw Error("Invalid version");return this.changes[e]},t.documentFor=function(e){if(e>this.length||e<0)throw Error("Invalid version");if(0===this.length)return"";var t=(0,u._)(this.slice(0,e),1)[0],n=eA.xv.of([""]);return t.apply(n).sliceString(0)},(0,cn._)(e,[{key:"length",get:function(){return this.forward.length}}]),e}();function cb(e){if(0===e.length)return eA.as.empty(0);if(1===e.length)return e[0];var t=(0,M._)(e),n=t[0],r=t.slice(1),i=n,o=!0,a=!1,l=void 0;try{for(var c,s=r[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;i=i.compose(u)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}return i}var cw=new cp.j(function(){return(0,eO.CT)()}),cZ=[cf,ct];function cx(e){var t,n,r,i=e.filePath,o=(0,ll.bA)(),a=(0,ch.Z)(),l=a.ref,c=a.view;(0,cm.VD)(c),(0,ll._H)(c);var s=(0,li.j)();(0,cv.Y)({view:c}),t=(0,_.useMemo)(function(){return(null==o?void 0:o.changes)?new cy(o.changes):null},[null==o?void 0:o.changes]),n=(0,_.useMemo)(function(){return t?t.documentFor(t.length):null},[t]),r=(0,_.useRef)({current:-1,next:0,pending:!1}),(0,_.useEffect)(function(){if(c)return function(){r.current.pending=!1,r.current={current:-1,next:0,pending:!1}}},[c]),(0,_.useEffect)(function(){if(c&&o&&t){o.comparing?l$(c,n):l$(c,null);var e=r.current;e.next=o.version,e.pending||e.current===e.next||(e.pending=!0,requestAnimationFrame(function(){!1!==e.pending&&(e.pending=!1,c&&t&&e.current!==e.next&&(function(e,t,n,r){var i=(0,u._)(t.slice(n+1,r+1),2),o=i[0],a=i[1];if(o.length!==e.state.doc.length){var l=(0,u._)(t.slice(0,r+1),1)[0];if(l.length!==e.state.doc.length)throw Error("Unresolvable mismatch between changes and document");e.dispatch({changes:{from:0,to:e.state.doc.length}}),e.dispatch({changes:l});return}e.dispatch({changes:o,effects:a?eO.tk.scrollIntoView(a,{yMargin:10}):void 0})}(c,t,e.current,e.next),e.current=e.next))}))}},[c,o,t,n]);var d=cw.use();return(0,f.tZ)("div",{css:cg.ev,children:(0,f.tZ)("div",{css:cg.ac,children:o&&0===o.count?(0,f.tZ)(cC,{}):(0,f.tZ)("div",{css:cg.ac,children:(0,f.tZ)(ej.ZP,{ref:l,css:cg.Mp,filePath:i,extensions:[d,cZ],initializing:!o,onException:function(e){s(e,"viewer-codemirror")},readOnly:!0,noHistory:!0,hideGutter:!0})})})})}function cC(){return(0,f.tZ)("div",{css:[cg.ac,{display:"flex",alignItems:"center",justifyContent:"center"}],children:(0,f.tZ)("span",{children:"This file has no history."})})}var cS=h.Dy.Object({type:h.Dy.Literal("history"),data:h.Dy.Object({path:h.Dy.Union([h.Dy.String(),h.Dy.Null()])})}),ck={Content:function(e){var t=e.pane,n=e.options;return(0,f.tZ)(c_,(0,O._)((0,U._)({},t.data),{performPaneOperation:n.performPaneOperation}))},Icon:function(e){var t=e.size;return(0,f.tZ)(lr.Z,{size:t})},getTitle:function(e){return e.data.path?"History - ".concat((0,E.UO)(e.data.path)):"History - no file open"},decode:function(e){return p.B4.Decode(cS,e)}};function c_(e){var t=e.path,n=e.performPaneOperation,r=(0,u._)((0,_.useState)(function(){return(0,t8.MT)()}),1)[0],i=(0,u._)((0,_.useState)(function(){return(0,t8.MT)()}),1)[0],o=(0,S.Mp)({path:t,performPaneOperation:n});(0,k.L5)(function(){if(o)return{commands:o}},[o]);var a=(0,L.Z)(function(){return function(){n({operation:"replace",pane:{type:"codeEditor",data:{path:t}}})}},[t,n]);return t?(0,f.tZ)(cm.Cl.Provider,{value:r,children:(0,f.tZ)(ll.ox.Provider,{value:i,children:(0,f.BX)("div",{css:{position:"relative",display:"flex",flexDirection:"column",overflowY:"hidden",height:"100%",width:"100%"},children:[(0,f.tZ)(S.HK,{path:t,performPaneOperation:n}),(0,f.tZ)(cx,{filePath:t}),(0,f.tZ)(lH,{filePath:t,onCloseHistory:a})]})})}):null}var cE=n(74928),cT=n(48796),cR=n(26508),cI=n(29479),cD=n(36102),cG=n(71914),cB=n(30826),cP=n.n(cB),cA=n(34495),cN=n(30084),cL=n(67696),cU=(0,_.memo)(cD.Z),cO=(0,b.X)({root:[x.l0.colWithGap(8),x.l0.height("100%"),x.l0.width("100%"),x.l0.overflow("auto"),x.l0.zIndex(2),x.l0.align.center,x.l0.py(16),x.l0.px(16),x.l0.borderRadius(8),(0,eP._)({margin:"0 auto"},"@media only screen and (min-width: ".concat(cI.j.tabletMin,"px)"),x.l0.px(32))],header:[x.l0.rowWithGap(4),x.l0.height(30),x.l0.width("100%"),x.l0.align.center],markdownContainer:[x.l0.width("100%"),{"& .rendered-markdown":[x.l0.flex.column,x.l0.center],"& .rendered-markdown > *":[x.l0.maxWidth(840),x.l0.width("100%")],"& .rendered-markdown > table":x.l0.maxWidth("100%")}]});function cM(e){var t,n,r=(0,C.Z)().fs,i=(0,u._)((t=(0,_.useRef)(!1),n=(0,_.useRef)(null),[(0,cR.Z)(function(){t.current=!0,n.current&&clearTimeout(n.current),n.current=setTimeout(function(){t.current=!1},150)},{type:"throttle",wait:37.5}),t]),2),o=i[0],a=i[1],l=(0,_.useRef)(null),c=(0,cT.T)(),s=e.path,d=e.performPaneOperation;(0,k.L5)(function(){return{actions:[{label:"Open in Editor",icon:(0,f.tZ)(oJ.Z,{}),type:"action",run:function(){d({operation:"replace",pane:{type:"codeEditor",data:{path:s}}})}}]}},[d,s]);var h=e.isHidden,p=(0,cL.p5)();(0,_.useEffect)(function(){if(!h){var e=cP()(function(e){(0,cA.Z)(e,{behavior:c?"auto":"smooth",scrollMode:"if-needed"})},100),t=cP()(function(t){if(s===(null==t?void 0:t.path)&&t&&!a.current){var n=l.current?function(e,t){var n=e.querySelectorAll(".rendered-markdown [data-sourcepos]");if(!(null==n?void 0:n.length))return null;var r=Array.from(n).reverse(),i=t.line,o=t.column,a=!0,l=!1,c=void 0;try{for(var s,d=r[Symbol.iterator]();!(a=(s=d.next()).done);a=!0){var f=s.value,h=f.dataset.sourcepos;if(!h)throw Error("Expected data source pos on selected element");var p=(0,u._)(h.split("-"),2),m=p[0],v=p[1],g=(0,u._)(m.split(":").map(Number),2),y=g[0],b=g[1],w=(0,u._)(v.split(":").map(Number),2),Z=w[0],x=w[1];if(i>=y&&o>=b&&(i<Z||i===Z&&o<=x))return f}}catch(e){l=!0,c=e}finally{try{a||null==d.return||d.return()}finally{if(l)throw c}}}(l.current,t.position):null;n&&e(n)}},200),n=p.subscribe(t);return function(){t.cancel(),e.cancel(),n()}}},[p,h,c,s]);var m=(0,u._)((0,_.useState)(null),2),v=m[0],b=m[1];return((0,_.useEffect)(function(){return b(null),r.watchTextFile(s,{onReady:function(e){b(e.initialContent.toString())},onChange:function(e){b(e.latestContent)},onMoveOrDelete:function(e){e.eventType===cN.kS.Delete&&d({operation:"replace",pane:{type:"commands",data:{autoFocus:!0}}})}})},[s,r,d]),null===v)?(0,f.tZ)(cG.Z,{preventHighlightBorder:!0}):(0,f.BX)(y.G,{css:cO.root,innerRef:o,children:[(0,f.BX)(y.G,{css:cO.header,children:[(0,f.tZ)(oK.Z,{}),(0,f.BX)(g.xv,{color:"dimmer",multiline:!1,children:["Preview of ",(0,f.tZ)("a",{href:"#".concat(s),children:s})]})]}),(0,f.tZ)(y.G,{innerRef:l,css:cO.markdownContainer,children:(0,f.tZ)(cU,{path:s,source:v,fs:r,sourcePos:!0})})]})}var cX=h.Dy.Object({type:h.Dy.Literal("markdown"),data:h.Dy.Object({path:h.Dy.String({minLength:1})})}),cF={Content:function(e){var t=e.pane,n=e.options;return(0,f.tZ)(cM,{path:t.data.path,isHidden:!!n.isHidden,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.size;return(0,f.tZ)(cE.Z,{fill:"currentColor",size:t})},getTitle:function(e){return e.data.path?(0,E.UO)(e.data.path):"Markdown"},decode:function(e){return p.B4.Decode(cX,e)}},cW=n(80259),cH=h.Dy.Object({type:h.Dy.Literal("media"),data:h.Dy.Object({path:h.Dy.String()})}),cV={Content:function(e){var t=e.pane,n=e.options;return(0,f.tZ)(cz,{path:t.data.path,performPaneOperation:n.performPaneOperation})},Icon:function(e){var t=e.pane,n=e.size;return(0,f.tZ)(v.Z,{path:t.data.path,size:n})},getTitle:function(e){return(0,E.UO)(e.data.path)},decode:function(e){return p.B4.Decode(cH,e)}};function cz(e){var t=e.path,n=e.performPaneOperation,r=(0,C.Z)().fs,i=(0,S.Mp)({path:t,performPaneOperation:n}),o=i?(0,d._)(i):[],a={match:cW.pl,data:{label:"Open in Editor",icon:(0,f.tZ)(oJ.Z,{}),type:"action",run:function(){n({operation:"replace",pane:{type:"codeEditor",data:{path:t}}})}}};return(0,E.B4)(t)&&o.push(a),(0,k.L5)(function(){if(i)return{commands:o}},[i]),(0,f.BX)(f.HY,{children:[(0,f.tZ)(S.HK,{path:t,performPaneOperation:n}),(0,f.tZ)(S.VY,{centered:!0,children:(0,f.tZ)(e5.Z,{filePath:t,fs:r})})]})}var cj=n(26544),cq=n(48728),cY=n(28268),cJ=function(e){(0,nw.j)(nw.U3.DATABASE_USED,(0,U._)({type:"PostgreSQL",provider:"neon"},e))},cK="DATABASE_URL",c$="PGDATABASE",cQ="PGHOST",c0="PGPORT",c1="5432",c2="PGUSER",c8="PGPASSWORD",c4=function(e){var t=e.envVarKey,n=e.envVarValue,r=e.isSecret,i=(0,aG.U)()("db-env-var-".concat(t)),o=(0,u._)((0,_.useState)(!1),2),a=o[0],l=o[1];return(0,f.BX)(y.G,{css:[x.l0.flex.row,x.l0.flex.wrap,x.l0.align.end,x.l0.pb(8),{gap:x.TV.space8}],children:[(0,f.BX)(y.G,{css:[x.l0.colWithGap(8),{flexBasis:250},x.l0.flex.grow(0),x.l0.flex.shrink(1)],children:[(0,f.tZ)("label",{css:x.l0.color.foregroundDimmer,htmlFor:i,children:t}),(0,f.tZ)(X.II,{id:i,type:!r||a?"text":"password",readOnly:!0,value:n})]}),(0,f.tZ)(W.zx,{text:"Copy",iconLeft:(0,f.tZ)(cq.Z,{}),onClick:function(){(0,F.Z)(n),cJ({action:"envVarCopied",envVarKey:t,envVarType:"value"})}}),r?(0,f.tZ)(W.zx,{text:"View",iconLeft:(0,f.tZ)(oK.Z,{}),onClick:function(){return l(function(e){return!e})}}):null]})},c3=function(e){var t,n=e.connectionString,r=e.databaseName,i=new URL(n.replace("postgres://","https://")),o=i.host,a=i.username,l=i.password;return t={},(0,eP._)(t,cK,n),(0,eP._)(t,c$,r),(0,eP._)(t,cQ,o),(0,eP._)(t,c0,c1),(0,eP._)(t,c2,a),(0,eP._)(t,c8,l),t},c5=function(){var e=(0,C.Z)().fs;return(0,_.useCallback)(function(t){var n=c3({connectionString:t.connectionString,databaseName:t.databaseName});function r(){return(r=(0,ts._)(function(){var t,r,i,o,a,l,c,s,d,f,h,p,m,v;return(0,tu.Jh)(this,function(g){switch(g.label){case 0:return[4,e.readFile(".env")];case 1:if(t=g.sent(),r="",t.error){if(t.error===cN.Df.NotFound)r="";else throw Error("Error getting .env")}else r=t.content;i=cY.Z.parse(r.toString()),o=!1,a=(0,U._)({},i),l=!0,c=!1,s=void 0;try{for(d=Object.entries(n)[Symbol.iterator]();!(l=(f=d.next()).done);l=!0)p=(h=(0,u._)(f.value,2))[0],m=h[1],a[p]!==m&&(o=!0,a[p]=m)}catch(e){c=!0,s=e}finally{try{l||null==d.return||d.return()}finally{if(c)throw s}}if(!o)return[2];return v=cY.Z.serialize(a),[4,e.writeFile(".env",tG.Z.from(v))];case 2:return g.sent(),[2]}})})).apply(this,arguments)}!function(){r.apply(this,arguments)}()},[e])},c6=function(e){var t=e.connectionString,n=e.databaseName,r=(0,L.Z)(function(){return c3({connectionString:t,databaseName:n})},[t,n]),i=r[cQ],o=r[c2],a=r[c8],l=c5();return(0,_.useEffect)(function(){l({connectionString:t,databaseName:n})},[t,n,l]),(0,f.BX)(y.G,{css:[x.l0.colWithGap(8)],children:[(0,f.tZ)(c4,{envVarKey:cK,envVarValue:t,isSecret:!0}),(0,f.tZ)(c4,{envVarKey:c$,envVarValue:n}),(0,f.tZ)(c4,{envVarKey:cQ,envVarValue:i}),(0,f.tZ)(c4,{envVarKey:c0,envVarValue:c1}),(0,f.tZ)(c4,{envVarKey:c2,envVarValue:o}),(0,f.tZ)(c4,{envVarKey:c8,envVarValue:a,isSecret:!0})]})},c9=n(52682),c7=n(63999),se=n(66587),st=n(55330),sn=n(81340),sr=n(76566),si=n(50946),so=n(4773),sa=n(63623);function sl(){var e=(0,ex._)(["\n  query DatabaseFrozen {\n    currentUser {\n      id\n      userSubscriptionType\n      ...CurrentUserUsageBasedBillingSummary\n    }\n  }\n  ","\n"]);return sl=function(){return e},e}var sc={},ss=(0,eC.Ps)(sl(),sa.eD);function su(){var e=(0,ex._)(["\n  mutation CreateNeonDatabase($input: CreateNeonDatabaseInput!) {\n    createNeonDatabase(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on CreateNeonDatabaseResult {\n        databaseId\n        databaseName\n        projectId\n        connectionString\n        isFrozen\n      }\n    }\n  }\n"]);return su=function(){return e},e}function sd(){var e=(0,ex._)(["\n  mutation DeleteNeonDatabase($input: DeleteNeonDatabaseInput!) {\n    deleteNeonDatabase(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on DeleteNeonDatabaseResult {\n        success\n      }\n    }\n  }\n"]);return sd=function(){return e},e}function sf(){var e=(0,ex._)(["\n  query GetNeonDatabases($input: GetNeonDatabasesInput!) {\n    getNeonDatabases(input: $input) {\n      __typename\n      ... on UserError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on GetNeonDatabasesResult {\n        databases {\n          databaseId\n          databaseName\n          projectId\n          connectionString\n          isFrozen\n        }\n      }\n    }\n  }\n"]);return sf=function(){return e},e}function sh(){var e=(0,ex._)(["\n  mutation UnfreezeNeonDatabase($input: UnfreezeNeonDatabaseInput!) {\n    unfreezeNeonDatabase(input: $input) {\n      ... on UnfreezeNeonDatabaseResult {\n        success\n      }\n    }\n  }\n"]);return sh=function(){return e},e}var sp={},sm=(0,eC.Ps)(su()),sv=(0,eC.Ps)(sd()),sg=(0,eC.Ps)(sf()),sy=(0,eC.Ps)(sh()),sb=(0,b.X)({self:[],title:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.color.foregroundDimmest],status:[x.l0.width(8),x.l0.height(8),x.l0.backgroundColor.foregroundDimmer,x.l0.borderRadius("full")],main:[x.l0.colWithGap(8),x.l0.align.center],icon:x.l0.mt(32),subTitle:x.l0.my(16),cta:[x.l0.width("100%"),x.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],ctaContainer:[x.l0.colWithGap(8),x.l0.align.center],ctaStatusBanner:[x.l0.textAlign.left],budgetContainer:[x.l0.colWithGap(8),x.l0.border(),x.l0.borderRadius(8),x.l0.p(8)]});function sw(e){var t=e.loading,n=e.ubbExplanation,r=e.hasPaymentMethod,i=e.handleOnUnpause,o=e.refetchUbbCapabilitiesQueryData,a=e.setShowPaymentMethodForm,l=e.showPaymentMethodForm,c=e.setShowSupportForm,s=(0,aZ.rv)();return n===aB.Fp.NeedsSubscription||n===aB.Fp.NeedsSubscriptionOrPaymentMethod?s?(0,f.tZ)(rT.E,{text:"You need a subscription to use PostgreSQL databases. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:sb.ctaStatusBanner}):(0,f.BX)(y.G,{css:sb.ctaContainer,children:[(0,f.tZ)(so.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to unpause database",css:sb.cta,colorway:"primary",variant:"outlined",disabled:l,onPlanCheckoutComplete:o}),(0,f.tZ)(W.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:sb.cta,disabled:l,loading:t,iconLeft:(0,f.tZ)(si.Z,{}),onClick:function(){return a()}})]}):n===aB.Fp.NeedsSmsVerification?(0,f.tZ)(se.Z,{context:aB.jv.Neon,onSuccess:o}):n===aB.Fp.NeedsPaymentMethod?s?(0,f.tZ)(rT.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:sb.ctaStatusBanner}):(0,f.tZ)(W.zx,{colorway:"primary",text:"Add a payment method",css:sb.cta,disabled:l,loading:t,iconLeft:(0,f.tZ)(si.Z,{}),onClick:function(){return a()}}):n===aB.Fp.NeedsUnbanning?(0,f.tZ)(sr.u,{text:"Your account currently has restrictions on use PostgreSQL databases. We're here to help! Please reach out to our support team for assistance.",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:sb.ctaStatusBanner,onClick:function(){return c()}}):n===aB.Fp.InsufficientBudget?(0,f.BX)(f.HY,{children:[(0,f.tZ)(rT.E,{text:"You've reached your monthly usage budget. Increase your budget to unpause your database.",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:sb.ctaStatusBanner}),(0,f.tZ)(y.G,{css:sb.budgetContainer,children:(0,f.tZ)(sn.L,{onUpdateSuccess:o})})]}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(W.zx,{colorway:"primary",onClick:i,text:"Unpause database",loading:t,css:sb.cta}),!1===r?(0,f.tZ)(sr.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:sb.ctaStatusBanner,onClick:function(){return s?null:a()}}):null]})}function sZ(e){var t,n,r,i=e.replId,o=e.neonProjectId,a=e.onDatabaseUnfreezed,l=(0,u._)((0,_.useState)(!1),2),c=l[0],s=l[1],d=(0,u._)((0,_.useState)(!1),2),h=d[0],p=d[1],m=(0,ao.Z)().showError,v=(t=(0,U._)({},sc,{notifyOnNetworkStatusChange:!0,onError:function(e){m(e.message)}}),eS.a(ss,t)),b=v.loading,w=v.data,Z=v.refetch,C=(0,u._)((n=(0,U._)({},sp,{onError:function(e){m("Error when unfreezing Neon database: ".concat(e.message)),cJ({action:"unfreeze",success:!1})},onCompleted:function(e){if((null==e?void 0:e.unfreezeNeonDatabase.__typename)!=="UnfreezeNeonDatabaseResult"){m("Error: Unfreezes Neon Database failed."),cJ({action:"unfreeze",success:!1});return}(null==e?void 0:e.unfreezeNeonDatabase.success)?(a(),cJ({action:"unfreeze",success:!0})):(m("Error: Unfreezes Neon Database failed."),cJ({action:"unfreeze",success:!1}))}}),aP.D(sy,n)),2),S=C[0],k=C[1].loading,E=(null==w?void 0:null===(r=w.currentUser)||void 0===r?void 0:r.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?w.currentUser.usageBasedBilling.capabilities:null;return(0,f.BX)(y.G,{css:sb.self,children:[(0,f.tZ)(rE.u,{isOpen:h,onRequestClose:function(){return p(!1)},children:(0,f.tZ)(st.Z,{onRequestClose:function(){return p(!1)}})}),(0,f.BX)(y.G,{css:sb.title,children:[(0,f.tZ)(y.G,{css:sb.status}),(0,f.tZ)(g.xv,{css:[x.l0.color.foregroundDimmest],multiline:!1,children:"Database paused"})]}),(0,f.BX)(y.G,{css:sb.main,children:[(0,f.tZ)(tj.Z,{size:32,fill:eM.TV.foregroundDimmest,css:sb.icon}),(0,f.tZ)(g.xv,{variant:"subheadDefault",css:sb.subTitle,multiline:!1,children:"Your Database is paused."}),(0,f.tZ)(sw,{loading:b||k,ubbExplanation:null==E?void 0:E.explanation,hasPaymentMethod:null==E?void 0:E.hasPaymentMethod,handleOnUnpause:function(){S({variables:{input:{replId:i,neonProjectId:o}}})},refetchUbbCapabilitiesQueryData:Z,setShowPaymentMethodForm:function(){return s(!0)},showPaymentMethodForm:c,setShowSupportForm:function(){return p(!0)}})]})]})}var sx=function(e){var t=e.title,n=e.children,r=e.isAccordion,i=e.sectionStyles;return(0,f.tZ)(y.G,{css:[x.l0.colWithGap(8),x.l0.pt(8),{borderTopWidth:1,borderTopStyle:"solid",borderTopColor:x.TV.outlineDefault},i],children:r?(0,f.tZ)(ed.Q,{headerContent:(0,f.tZ)(y.G,{css:[x.l0.rowWithGap(8),x.l0.align.center],children:(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:t})}),children:(0,f.tZ)(y.G,{css:[x.l0.p(12),x.l0.colWithGap(8),x.l0.height("100%")],children:n})}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(g.xv,{multiline:!1,css:[x.l0.fontSize(x.TV.fontSizeSubheadDefault),x.l0.fontWeight.medium],children:t}),n]})})},sC=n(18561);function sS(e){var t=e.title,n=e.doWarnAtom,r=e.inactive,i=(0,t2.Dv)(n);return(0,f.BX)(y.G,{css:[x.l0.rowWithGap(4),x.l0.align.center],children:[(0,f.tZ)(g.xv,{variant:"small",css:x.l0.color.foregroundDimmer,multiline:!1,children:void 0!==r&&r?t+" last run":t}),i?(0,f.tZ)(rn.Z,{color:x.TV.orangeStronger}):null]})}function sk(e){var t=e.title,n=e.totalAtom,r=e.currentAtom,i=e.countAtom,o=e.measure,a=e.limitText,l=e.inactive,c=void 0!==l&&l,s=(0,L.Z)(function(){return(0,t8.cn)(function(e){return sE(e(r),e(n))})},[r,n]),u=(0,L.Z)(function(){return(0,t8.cn)(function(e){var t,l,c,u;return a||(t=e(s),l=e(r),c=e(n),u=i&&e(i),"empty"===t||void 0===l?void 0:"vCPU"===o?sT(100*Math.min(1,l/c))+"% of "+u+" vCPUs":sT(l).toLocaleString()+"/"+sT(c).toLocaleString()+" "+o)})},[a,s,r,n,i,o]),d=(0,L.Z)(function(){return(0,t8.cn)(function(e){var t=e(s);return"At limit"===t||"Close to limit"===t})},[s]);return(0,f.BX)(y.G,{css:[x.l0.colWithGap(4),x.l0.flex.growAndShrink(2),{flexBasis:32}],children:[t?(0,f.tZ)(sS,{title:t,doWarnAtom:d,inactive:c}):null,(0,f.tZ)(s_,{currentAtom:r,totalAtom:n,inactive:c,limitTextAtom:u,mini:!0})]})}function s_(e){var t=e.currentAtom,n=e.totalAtom,r=e.limitTextAtom,i=e.inactive,o=e.mini,a=(0,t2.Dv)(n),l=(0,t2.Dv)(t),c=(0,t2.Dv)(r),s=function(e){switch(e){case"empty":case"fine":default:return;case"At limit":return x.TV.accentNegativeDefault;case"Close to limit":return x.TV.orangeDefault}}(sE(l,a));return(0,f.tZ)(eg.J,{css:o&&x.l0.height(8),total:a,current:l,color:s,disabled:i,tooltip:c})}function sE(e,t){if(void 0===e)return"empty";var n=e/t;return n>=1?"At limit":n>=.9?"Close to limit":"fine"}function sT(e){return Math.round((e+Number.EPSILON)*100)/100}var sR=n(33988),sI=n.n(sR),sD=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],sG=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];function sB(e,t){var n,r=t||{},i=r.signed,o=r.digitsNumber,a=r.isKib,l=r.isKibNotation;if(n=void 0!==i&&i?e<0?"-":"+":"",0===e)return"".concat(n,"0B");var c=void 0===a||a?1024:1e3,s=Math.floor(Math.log(Math.abs(e))/Math.log(c));return"".concat(n).concat(parseFloat(Math.abs(e/Math.pow(c,s)).toFixed(void 0===o?2:o))).concat((void 0!==l&&l?sD:sG)[s])}var sP=n(40102),sA=n(88623),sN=n(88032),sL=n(59520),sU=n(93272),sO={"td,th":{border:"1px solid "+x.TV.outlineDefault}},sM={"td,th":{paddingLeft:8,paddingTop:8,paddingBottom:8,paddingRight:8,whiteSpace:"nowrap"},"td:first-of-type,th:first-of-type":{paddingLeft:8}},sX={outline:"2px solid ".concat(x.TV.accentPrimaryDefault),outlineOffset:"-2px"},sF=(0,ep.iv)({":focus:focus-visible":sX}),sW=(0,ep.iv)(sX),sH=(0,ep.iv)([sM,sO,sF]),sV=(0,ep.iv)([x.l0.fontWeight.medium,sM,sO,sF]),sz=(0,ep.iv)({"tbody > tr:hover":{backgroundColor:x.TV.backgroundHigher,cursor:"pointer"}});function sj(e){var t=e.type,n=e.style,r=e.children,i=(0,sA.LA)().rowGroupProps;return(0,f.tZ)(t,(0,O._)((0,U._)({},i),{style:n,children:r}))}function sq(e){var t=e.item,n=e.state,r=e.children,i=(0,_.useRef)(null),o=(0,sA.Qm)({node:t},n,i).rowProps;return(0,f.tZ)("tr",(0,O._)((0,U._)({css:sV},o),{ref:i,children:r}))}function sY(e){var t,n=e.column,r=e.state,i=(0,_.useRef)(null),o=(0,sA.WY)({node:n},r,i).columnHeaderProps,a=(0,sN.Fx)(),l=a.isFocusVisible,c=a.focusProps;return(0,f.tZ)("th",(0,O._)((0,U._)({},(0,sL.dG)(o,c)),{css:[l&&sW,sF],colSpan:n.colspan,style:{textAlign:(null!==(t=n.colspan)&&void 0!==t?t:1)>1?"center":"left"},ref:i,children:n.rendered}))}function sJ(e){var t=e.item,n=e.children,r=e.state,i=(0,_.useRef)(null),o=(0,sA.U)({node:t},r,i).rowProps,a=(0,sN.Fx)(),l=a.isFocusVisible,c=a.focusProps;return(0,f.tZ)("tr",(0,O._)((0,U._)({css:[l&&sW,sH]},(0,sL.dG)(o,c)),{ref:i,children:n}))}function sK(e){var t=e.cell,n=e.state,r=(0,_.useRef)(null),i=(0,sA.fs)({node:t},n,r).gridCellProps,o=(0,sN.Fx)(),a=o.isFocusVisible,l=o.focusProps;return(0,f.tZ)("td",(0,O._)((0,U._)({},(0,sL.dG)(i,l)),{css:[a&&sW,sF],ref:r,children:t.rendered}))}function s$(e){var t=e.selectionMode,n=e.selectionBehavior,r=(0,sU.oy)((0,O._)((0,U._)({},e),{showSelectionCheckboxes:"multiple"===t&&"replace"!==n})),i=(0,_.useRef)(null),o=r.collection,a=(0,sA.x6)(e,r,i).gridProps;return(0,f.BX)("table",(0,O._)((0,U._)({},a),{ref:i,css:[(null==e?void 0:e.onRowAction)&&sz],style:{borderCollapse:"collapse"},children:[(0,f.tZ)(sj,{type:"thead",children:o.headerRows.map(function(e){return(0,f.tZ)(sq,{item:e,state:r,children:(0,d._)(e.childNodes).map(function(e){return(0,f.tZ)(sY,{column:e,state:r},e.key)})},e.key)})}),(0,f.tZ)(sj,{type:"tbody",children:(0,d._)(o.body.childNodes).map(function(e){return(0,f.tZ)(sJ,{item:e,state:r,children:(0,d._)(e.childNodes).map(function(e){return(0,f.tZ)(sK,{cell:e,state:r},e.key)})},e.key)})})]}))}var sQ=function(e){var t=e.ariaTableProps,n=e.rows,r=e.columns;return(0,f.BX)(s$,(0,O._)((0,U._)({},t),{children:[(0,f.tZ)(sU.xD,{columns:r,children:function(e){return(0,f.tZ)(sU.sg,{children:e.value})}}),(0,f.tZ)(sU.RM,{items:n,children:function(e){return(0,f.tZ)(sU.X2,{children:function(t){return(0,f.tZ)(sU.bL,{children:e[t]})}})}})]}))};function s0(e){var t=e.headerColumns,n=e.bodyData,r=e.ariaLabel,i=e.scrollRef,o=e.onRowAction,a=t.map(function(e,t){return{key:"string"==typeof e?e:"".concat(t),value:e}}),l=n.map(function(e,n){for(var r={id:n},i=0;i<e.length;i++){var o=t[i];r["string"==typeof o?o:"".concat(i)]=e[i]}return r});return(0,f.tZ)(sQ,{ariaTableProps:{selectionMode:"none","aria-label":void 0===r?"Database Table":r,onRowAction:o,scrollRef:i},columns:a,rows:l})}var s1=(0,t8.cn)(["databaseManager"]),s2=(0,t8.cn)(null,function(e,t,n){var r=e(s1);t(s1,(0,d._)(r).concat([n])),cJ({action:"pageNav",databasePage:n})}),s8=(0,t8.cn)(null,function(e,t){var n=e(s1);t(s1,n.slice(0,n.length-1))}),s4=(0,t8.cn)(function(e){var t=e(s1);return t[t.length-1]}),s3=function(){return(0,t2.b9)(s2)},s5=function(){return(0,t2.b9)(s8)},s6=function(e,t){var n,r=(0,C.Z)().psql,i=(0,u._)((0,_.useState)(),2),o=i[0],a=i[1],l=(0,u._)((0,_.useState)(!1),2),c=l[0],s=l[1],d=(0,_.useCallback)((n=(0,ts._)(function(){return(0,tu.Jh)(this,function(n){switch(n.label){case 0:if(!e)return[2];n.label=1;case 1:return n.trys.push([1,,3,4]),s(!0),[4,r.run({query:e,connectionString:t})];case 2:return a(n.sent()),[3,4];case 3:return s(!1),[7];case 4:return[2]}})}),function(){return n.apply(this,arguments)}),[t,r,e]);return(0,_.useEffect)(function(){d()},[t,r,e,d]),{data:o,loading:c,refetch:d}},s9=function(e){var t=e.rows,n=e.columns;return!Array.isArray(t)||t.length<1?null:{headerColumns:null!=n?n:[],bodyData:t.map(function(e){return Object.values(e)})}},s7=function(e){return s6("SELECT n.nspname as \"Schema\",\n  c.relname as \"Name\",\n  CASE c.relkind WHEN 'r' THEN 'table' WHEN 'v' THEN 'view' WHEN 'm' THEN 'materialized view' WHEN 'i' THEN 'index' WHEN 'S' THEN 'sequence' WHEN 's' THEN 'special' WHEN 'f' THEN 'foreign table' WHEN 'p' THEN 'partitioned table' WHEN 'I' THEN 'partitioned index' END as \"Type\",\n  pg_catalog.pg_get_userbyid(c.relowner) as \"Owner\",\n  pg_catalog.pg_size_pretty(pg_catalog.pg_total_relation_size(c.oid)) as \"Size\",\n  pg_catalog.obj_description(c.oid, 'pg_class') as \"Description\"\nFROM pg_catalog.pg_class c\n     LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace\nWHERE c.relkind IN ('r','p','v','m','S','f','')\n      AND n.nspname <> 'pg_catalog'\n      AND n.nspname <> 'information_schema'\n      AND n.nspname !~ '^pg_toast'\n  AND pg_catalog.pg_table_is_visible(c.oid)\nORDER BY 1,2;",e.connectionString)},ue=(0,t8.cn)(void 0),ut=(0,t8.cn)(function(e){var t=e(ue);return null==t?void 0:t.rows.reduce(function(e,t){var n=t.table_name,r=t.column_name;return e[n]||(e[n]=[]),e[n].push(r),e},{})}),un=function(e){var t=s6("SELECT table_name, column_name, data_type FROM information_schema.columns WHERE table_schema = 'public';",e.connectionString).data,n=(0,t2.b9)(ue);(0,_.useEffect)(function(){n(t)},[t,n])},ur=function(e){var t=e.tableName,n=e.connectionString;return s6("SELECT table_name, column_name, data_type FROM information_schema.columns WHERE table_schema = 'public' AND table_name = '".concat(t.replace(/"/g,'""'),"';"),n).data},ui=function(e){var t=e.tableData,n=e.scrollRef,r=t.headerColumns,i=t.bodyData,o=s3(),a=(0,_.useCallback)(function(e){var t=parseInt(String(e),10);if(!isNaN(t)){var n=i[t][r.indexOf("Name")];o("table/".concat(n))}},[o,r,i]);return(0,f.tZ)(s0,{headerColumns:r,bodyData:i,onRowAction:a,scrollRef:n})},uo=function(e){var t=e.psqlQueryResult,n=e.scrollRef,r=t.data;if(t.loading)return(0,f.tZ)(y.G,{css:[x.l0.flex.row,x.l0.justify.center,x.l0.p(32)],children:(0,f.tZ)(Z.Z,{})});if(null==r?void 0:r.error)return(0,f.tZ)(y.G,{css:[x.l0.flex.row,x.l0.justify.center,x.l0.p(32)],children:(0,f.tZ)(g.xv,{css:[x.l0.color.accentNegativeDefault,x.l0.maxWidth("100%")],children:null==r?void 0:r.error})});var i=r?s9(r):null;return i?(0,f.tZ)(ui,{tableData:i,scrollRef:n}):(0,f.tZ)(y.G,{css:[x.l0.flex.row,x.l0.justify.center,x.l0.p(32)],children:(0,f.tZ)(g.xv,{css:[x.l0.color.accentPositiveDefault,x.l0.maxWidth("100%")],children:"No tables found"})})},ua=function(e){var t=e.connectionString,n=s5(),r=(0,_.useRef)(null),i=s7({connectionString:t}),o=i.refetch;return(0,f.BX)(y.G,{css:[x.l0.flex.column,x.l0.height("100%")],children:[(0,f.BX)(y.G,{css:[x.l0.flex.row,x.l0.py(16),x.l0.px(8),x.l0.align.center],children:[(0,f.tZ)(m.hU,{alt:"Go back",size:28,type:"button",onClick:n,children:(0,f.tZ)(sP.Z,{})}),(0,f.tZ)(y.G,{css:[x.l0.flex.growAndShrink(1)],children:(0,f.tZ)(g.xv,{css:[x.l0.fontSize(16),x.l0.ml(8)],multiline:!1,children:"All tables"})}),(0,f.tZ)(m.hU,{alt:"Refresh",size:24,type:"button",onClick:o,children:(0,f.tZ)(n1.Z,{})})]}),(0,f.tZ)(y.G,{css:[x.l0.flex.growAndShrink(1),x.l0.overflow("auto"),x.l0.px(8)],innerRef:r,children:(0,f.tZ)(uo,{psqlQueryResult:i,scrollRef:r})})]})},ul="1px solid "+x.TV.outlineDefault,uc=(0,ep.iv)([x.l0.p(8),x.l0.backgroundColor.backgroundDefault,x.l0.align.center,x.l0.borderRadius(0),{borderLeft:ul,borderRight:ul,borderBottom:ul},{":not([disabled])":{":focus":{boxShadow:"none",outline:"2px solid ".concat(x.TV.accentPrimaryDefault),outlineOffset:"-2px"},":hover":{backgroundColor:x.TV.backgroundHigher}}}]),us=function(e){var t=s7({connectionString:e.connectionString}),n=t.data,r=t.loading,i=(0,u._)((0,_.useState)(!1),2),o=i[0],a=i[1],l=(0,_.useCallback)(function(){a(!0)},[]),c=n?s9(n):null,s=(0,_.useRef)(null);if(!c||r)return null;var d=c.bodyData.length,h=c.headerColumns,p=c.bodyData;return(0,f.tZ)(f.HY,{children:(0,f.BX)(y.G,{css:[x.l0.overflow("auto"),x.l0.display.grid],innerRef:s,children:[(0,f.tZ)(ui,{tableData:{headerColumns:h,bodyData:o?p:p.slice(0,5)},scrollRef:s}),d-5>0&&!o?(0,f.tZ)(W.zx,{text:"".concat(d-5," more"),css:uc,onClick:l}):null]})})},uu="https://docs.replit.com/hosting/databases/postgresql-on-replit",ud="https://docs.replit.com/hosting/about-usage-based-billing#1-postgresql-usage-metrics",uf=function(e){var t=e.dbSize,n=e.totalSize,r=sB(t),i=sB(n),o=(0,L.Z)(function(){return(0,t8.cn)(t)},[t]),a=(0,L.Z)(function(){return(0,t8.cn)(n)},[n]);return(0,f.BX)(f.HY,{children:[(0,f.BX)(g.xv,{css:x.l0.color.foregroundDimmer,multiline:!1,children:[r,"/",i]}),(0,f.tZ)(sk,{totalAtom:a,currentAtom:o,limitText:"".concat(r," / ").concat(i),inactive:!1,measure:"MB"})]})},uh=function(e){var t,n,r=e.connectionString,i=s6("SELECT sum(pg_database_size(datname)) FROM pg_database;",r),o=i.data,a=i.loading,l=s6("SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' ORDER BY table_name;",r),c=l.data,s=l.loading,u=parseInt(null!==(n=null==o?void 0:null===(t=o.rows[0])||void 0===t?void 0:t.sum)&&void 0!==n?n:"0",10),d=null==c?void 0:c.rows.length;return(0,f.BX)(y.G,{css:x.l0.rowWithGap(8),children:[s?null:(0,f.BX)(g.xv,{multiline:!1,children:[d," ",1===d?"table":"tables"]}),a?null:(0,f.tZ)(uf,{dbSize:u,totalSize:10737418240})]})},up=function(e){var t=e.connectionString,n=e.onOpenDatabaseViewerClick,r=e.showUsageLink;return(0,f.BX)(y.G,{css:[x.l0.colWithGap(8)],children:[(0,f.BX)(y.G,{children:[(0,f.tZ)(uh,{connectionString:t}),r?(0,f.tZ)(sI(),{legacyBehavior:!0,href:"/usage#postgres-storage",passHref:!0,children:(0,f.tZ)("a",{css:x.l0.hover(x.l0.color.accentPrimaryStrongest),children:(0,f.tZ)(g.xv,{children:"See all usage"})})}):null]}),(0,f.tZ)(us,{connectionString:t}),(0,f.tZ)(W.zx,{text:"See Database Contents",iconLeft:(0,f.tZ)(sC.Z,{}),onClick:n})]})},um=n(23291),uv=function(e){var t=e.psqlQueryResult,n=e.tableName,r=e.connectionString,i=e.scrollRef,o=t.data,a=t.loading,l=ur({tableName:n,connectionString:r});if(a)return(0,f.tZ)(y.G,{css:[x.l0.flex.row,x.l0.justify.center,x.l0.p(32)],children:(0,f.tZ)(Z.Z,{})});if(null==o?void 0:o.error)return(0,f.tZ)(y.G,{css:[x.l0.flex.row,x.l0.justify.center,x.l0.p(32)],children:(0,f.tZ)(g.xv,{css:[x.l0.color.accentNegativeDefault,x.l0.maxWidth("100%")],children:null==o?void 0:o.error})});var c=o?s9(o):null;if(!c)return(0,f.tZ)(y.G,{css:[x.l0.flex.row,x.l0.justify.center,x.l0.p(32)],children:(0,f.tZ)(g.xv,{css:[x.l0.color.accentPositiveDefault,x.l0.maxWidth("100%")],children:"No rows"})});var s=c.headerColumns,u=c.bodyData;return(0,f.tZ)(s0,{headerColumns:s.map(function(e,t){var n,r=null==l?void 0:null===(n=l.rows)||void 0===n?void 0:n.find(function(t){return t.column_name===e}),i=null==r?void 0:r.data_type,o=i?(0,f.tZ)(um.D,{text:i}):null;return(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8),x.l0.align.center],children:[(0,f.tZ)(g.xv,{multiline:!1,children:e}),o]},t)}),bodyData:u,scrollRef:i})},ug=function(e){var t=e.tableName,n=e.connectionString,r=s5(),i=(0,_.useRef)(null),o=s6('SELECT * FROM "'.concat(t.replace(/"/g,'""'),'" LIMIT ').concat(500),n),a=o.refetch;return(0,f.BX)(y.G,{css:[x.l0.flex.column,x.l0.height("100%")],children:[(0,f.BX)(y.G,{css:[x.l0.flex.row,x.l0.py(16),x.l0.px(8),x.l0.align.center],children:[(0,f.tZ)(m.hU,{alt:"Go back",size:28,type:"button",onClick:r,children:(0,f.tZ)(sP.Z,{})}),(0,f.tZ)(y.G,{css:[x.l0.flex.growAndShrink(1)],children:(0,f.tZ)(g.xv,{css:[x.l0.fontSize(16),x.l0.ml(8)],multiline:!1,children:t})}),(0,f.tZ)(m.hU,{alt:"Refresh",size:24,type:"button",onClick:a,children:(0,f.tZ)(n1.Z,{})})]}),(0,f.tZ)(y.G,{css:[x.l0.flex.growAndShrink(1),x.l0.overflow("auto"),x.l0.px(8)],innerRef:i,children:(0,f.tZ)(uv,{psqlQueryResult:o,tableName:t,connectionString:n,scrollRef:i})})]})};n(26);var uy=function(e){var t=e.size;return(0,f.BX)("svg",{viewBox:"0 0 128 36",preserveAspectRatio:"xMidYMin",height:void 0===t?16:t,fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,f.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.207A6.207 6.207 0 0 1 6.207 0h23.586A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36H6.207A6.207 6.207 0 0 1 0 29.793V6.207Zm6.207-1.241c-.686 0-1.241.555-1.241 1.24v23.587c0 .686.555 1.242 1.24 1.242h10.925c.343 0 .434-.278.434-.621V16.18c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V6.207c0-.686.064-1.241-.621-1.241H6.207Z",fill:"#12FFF7"}),(0,f.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.207A6.207 6.207 0 0 1 6.207 0h23.586A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36H6.207A6.207 6.207 0 0 1 0 29.793V6.207Zm6.207-1.241c-.686 0-1.241.555-1.241 1.24v23.587c0 .686.555 1.242 1.24 1.242h10.925c.343 0 .434-.278.434-.621V16.18c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V6.207c0-.686.064-1.241-.621-1.241H6.207Z",fill:"url(#a)"}),(0,f.tZ)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 6.207A6.207 6.207 0 0 1 6.207 0h23.586A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36H6.207A6.207 6.207 0 0 1 0 29.793V6.207Zm6.207-1.241c-.686 0-1.241.555-1.241 1.24v23.587c0 .686.555 1.242 1.24 1.242h10.925c.343 0 .434-.278.434-.621V16.18c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V6.207c0-.686.064-1.241-.621-1.241H6.207Z",fill:"url(#b)"}),(0,f.tZ)("path",{d:"M29.793 0A6.207 6.207 0 0 1 36 6.207v20.06c0 3.546-4.488 5.085-6.664 2.286l-6.805-8.754v10.615A5.586 5.586 0 0 1 16.945 36a.62.62 0 0 0 .62-.62v-19.2c0-3.547 4.488-5.086 6.665-2.286l6.805 8.753V1.241C31.035.556 30.479 0 29.793 0Z",fill:"#B9FFB3"}),(0,f.tZ)("path",{d:"M60.686 10.6v9.416l-9.13-9.416h-4.752V26h4.334V15.88L61.082 26h3.938V10.6h-4.334ZM73.054 22.568V19.84h9.702v-3.278h-9.702v-2.53h11.77V10.6H68.632V26h16.434v-3.432H73.054ZM96.583 26.506c6.094 0 10.054-2.992 10.054-8.206 0-5.214-3.96-8.206-10.054-8.206S86.551 13.086 86.551 18.3c0 5.214 3.938 8.206 10.032 8.206Zm0-3.652c-3.388 0-5.478-1.65-5.478-4.554 0-2.904 2.112-4.554 5.478-4.554 3.388 0 5.478 1.65 5.478 4.554 0 2.904-2.09 4.554-5.478 4.554ZM123.249 10.6v9.416l-9.13-9.416h-4.752V26h4.334V15.88L123.645 26h3.938V10.6h-4.334Z",fill:"currentColor"}),(0,f.BX)("defs",{children:[(0,f.BX)("linearGradient",{id:"a",x1:"36",y1:"36",x2:"4.345",y2:"0",gradientUnits:"userSpaceOnUse",children:[(0,f.tZ)("stop",{stopColor:"#B9FFB3"}),(0,f.tZ)("stop",{offset:"1",stopColor:"#B9FFB3",stopOpacity:"0"})]}),(0,f.BX)("linearGradient",{id:"b",x1:"36",y1:"36",x2:"14.617",y2:"27.683",gradientUnits:"userSpaceOnUse",children:[(0,f.tZ)("stop",{stopColor:"#1A1A1A",stopOpacity:".9"}),(0,f.tZ)("stop",{offset:"1",stopColor:"#1A1A1A",stopOpacity:"0"})]})]})]})},ub=(0,ep.iv)([x.l0.color.foregroundDimmest,{textDecoration:"underline"}]),uw=function(){return(0,f.tZ)(y.G,{css:[x.l0.colWithGap(8),x.l0.py(8),x.l0.width("100%")],children:(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.justify.spaceBetween],children:[(0,f.tZ)("a",{target:"_blank",href:uu,css:ub,children:"Docs"}),(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8),x.l0.align.center],children:[(0,f.tZ)(g.xv,{css:[x.l0.fontSize(14)],multiline:!1,children:"Powered by"}),(0,f.tZ)(uy,{})]})]})})},uZ=n(4341),ux=n(54001),uC=n(12448),uS=n(54472),uk=n(29457),u_=n(40688),uE=n(50639),uT=n(37054),uR=n(45549),uI=n(50586),uD=n(48170),uG=function(e){var t=e.headerTitle,n=e.onGoBack,r=e.children;return(0,f.BX)(y.G,{css:[x.l0.flex.column,x.l0.height("100%")],children:[(0,f.BX)(y.G,{css:[x.l0.flex.row,x.l0.py(16),x.l0.px(8),x.l0.align.center],children:[(0,f.tZ)(m.hU,{alt:"Go back",size:28,type:"button",onClick:n,children:(0,f.tZ)(sP.Z,{})}),(0,f.tZ)(g.xv,{css:[x.l0.fontSize(16),x.l0.ml(8)],multiline:!1,children:t})]}),(0,f.tZ)(y.G,{css:[x.l0.overflow("auto"),x.l0.height("calc(100% - 60px)")],children:r})]})},uB=(0,t8.cn)(""),uP=(0,t8.cn)(null),uA=(0,t8.cn)(null,function(e,t,n){var r=n.query;r&&t(uB,r);var i=e(uP);i&&i.dispatch({changes:{from:0,to:i.state.doc.length,insert:r}})}),uN=n(85234),uL=n.n(uN),uU=n(64461),uO=n(69852),uM=n(65381),uX=(0,uO.O4)("replDatabasesQueryHistory",[]),uF=function(e,t){return!e.isPinned&&t.isPinned?1:e.isPinned&&!t.isPinned?-1:"number"==typeof e.pinnedTimestamp&&"number"==typeof t.pinnedTimestamp?e.pinnedTimestamp-t.pinnedTimestamp:t.timestamp-e.timestamp},uW=function(e,t){var n=e.findIndex(function(e){return!e.isPinned&&e.data===t.data});-1!==n?e.splice(n,1,t):e.push(t),e.sort(uF);var r=e.filter(function(e){return!e.isPinned}).length;if(r>=5){var i=r-5;e.splice(e.length-i,i)}},uH=function(e){var t=e.id,n=e.data,r=e.isPinned,i=(0,uM.lV)((0,_.useCallback)(function(e,n){var r=e(uX).find(function(e){return e.id===t}),i=(null==r?void 0:r.data)||"";i&&(n(uA,{query:i}),cJ({action:"queryHistoryItemSelected"}))},[t])),o=(0,uM.lV)((0,_.useCallback)(function(e,n){var r=e(uX);n(uX,(0,uU.Uy)(r,function(e){var n=e.find(function(e){return e.id===t});n&&(n.isPinned=!n.isPinned,n.isPinned?n.pinnedTimestamp=Date.now():n.pinnedTimestamp=void 0),e.sort(uF)})),cJ({action:"queryHistoryItemPinned"})},[t]));return(0,f.BX)(y.G,{css:[{borderTop:"1px solid ".concat(x.TV.outlineDefault),":hover":{background:x.TV.backgroundHigher}},x.l0.flex.row,x.l0.p(8),x.l0.color.foregroundDimmer,x.l0.align.center,x.l0.cursor.pointer],onClick:i,children:[(0,f.tZ)(g.xv,{css:[x.l0.flex.growAndShrink(1)],multiline:!1,children:n}),(0,f.tZ)(m.hU,{alt:"Pin query",onClick:o,children:r?(0,f.tZ)(uE.Z,{fill:x.TV.accentPrimaryDefault}):(0,f.tZ)(u_.Z,{})})]})},uV=function(e){var t=e.onExpand,n=(0,t2.Dv)(uX);return(0,f.tZ)(ed.Q,{onClick:t,headerContent:(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.p(2)],children:[(0,f.tZ)(lr.Z,{}),(0,f.tZ)(g.xv,{css:[x.l0.color.foregroundDimmest],multiline:!1,children:"Query History"})]}),children:(0,f.tZ)(y.G,{css:[x.l0.colWithGap(8),x.l0.height("100%")],children:0===n.length?(0,f.tZ)(y.G,{css:[x.l0.p(8)],children:(0,f.tZ)(g.xv,{css:[x.l0.color.foregroundDimmer],multiline:!1,children:"No query history"})}):(0,f.tZ)(y.G,{children:n.map(function(e){return(0,f.tZ)(uH,(0,U._)({},e),e.id)})})})})},uz=new uk.R(function(){return(0,eO.W$)((0,uS.V)((0,f.tZ)("div",{css:[{fontFamily:x.TV.fontFamilyCode},x.l0.color.foregroundDimmest],children:"Type PostgreSQL queries here to use the database."})))}),uj=new cp.j(function(e){return eA.Wl.high((0,uZ.sql)((0,U._)({dialect:uZ.PostgreSQL},e)))}),uq=function(e){var t=e.queryResult,n=e.scrollRef;if(null==t?void 0:t.error)return(0,f.tZ)(y.G,{css:x.l0.px(8),children:(0,f.tZ)(g.xv,{css:[x.l0.color.accentNegativeDefault],children:null==t?void 0:t.error})});if(!(null==t?void 0:t.rows))return null;var r=s9(t);if(!r)return(0,f.tZ)(y.G,{css:x.l0.px(8),children:(0,f.tZ)(g.xv,{css:[x.l0.color.accentPositiveDefault],children:"Query successful, no rows returned"})});var i=r.headerColumns,o=r.bodyData;return(0,f.tZ)(y.G,{css:x.l0.px(8),children:(0,f.tZ)(s0,{headerColumns:i,bodyData:o,scrollRef:n})})},uY=(0,ep.iv)([x.l0.height("100%"),x.l0.position.relative,x.l0.overflow("auto")]),uJ=(0,ep.iv)([x.l0.position.sticky,x.l0.top(0),x.l0.left(0),x.l0.zIndex(1),x.l0.backgroundColor.backgroundDefault]),uK=function(e){var t=e.connectionString,n=e.performPaneOperation,r=(0,u._)((0,t2.KO)(uB),2),i=r[0],o=r[1],a=(0,ch.Z)(),l=a.ref,c=a.view,s=(0,u._)((0,_.useState)(!1),2),d=s[0],h=s[1];(0,_.useEffect)(function(){return function(){var e;o(null!==(e=null==c?void 0:c.state.doc.toString())&&void 0!==e?e:"")}},[o,null==c?void 0:c.state.doc]);var p=(0,t2.b9)(uP);(0,_.useEffect)(function(){p(c)},[p,c]),un({connectionString:t});var m=(0,t2.Dv)(ut),v=uD.q,g=(0,ux.Z)({filePath:v}),b=(0,C.Z)().psql,w=(0,u._)((0,_.useState)(),2),S=w[0],k=w[1],E=(0,u._)((0,_.useState)(!1),2),T=E[0],R=E[1],I=(0,uM.lV)((0,_.useCallback)(function(e,t,n){if(n){var r={id:uL()(),data:n,timestamp:Date.now()},i=e(uX);t(uX,(0,uU.Uy)(i,function(e){uW(e,r)}))}},[])),D=(0,_.useCallback)(function(){function e(){return(e=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(n){switch(n.label){case 0:if(!c)return[2];n.label=1;case 1:return n.trys.push([1,,3,4]),R(!0),I(e=null==c?void 0:c.state.doc.toString()),[4,b.run({query:e,connectionString:t})];case 2:return k(n.sent()),cJ({action:"queryRan"}),[3,4];case 3:return R(!1),[7];case 4:return[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[t,b,I,c]),G=s3(),B=(0,_.useCallback)(function(){G("databaseManager")},[G]),P=(0,_.useCallback)(function(){G("tableSchemas")},[G]),A=(0,_.useRef)(null),N=uj.use({schema:m}),L=(0,tQ.P5)({controlName:"flag-postgresql-pane-inline-ai"}),U=(0,aZ.T3)(),O=(0,uT.Ls)({path:v}),M=(0,uT.jg)({path:v}),X=(0,uT.fD)({path:v}),F=(0,uI.W)({generateCode:O,editCode:M,explainCode:X,onMoreClick:void 0}),H=(0,_.useCallback)(function(){c&&O(c)},[c,O]),V=(0,_.useCallback)(function(e){return n({operation:"open",pane:e,secondary:!0})},[n]),z=(0,_.useCallback)(function(){V({type:"ghostwriterChat"})},[V]),j=(0,uC.W)({onGenerateCode:H,onReplyInChat:z}),q=(0,uR.u)({isMobile:U,generateCode:O,filePath:v,openPane:V});return(0,f.tZ)(uG,{headerTitle:"Database Contents",onGoBack:B,children:(0,f.BX)(y.G,{css:[x.l0.colWithGap(8),uY],innerRef:A,children:[(0,f.BX)(y.G,{css:[x.l0.colWithGap(8),x.l0.px(8),x.l0.pb(8),d?null:uJ],children:[(0,f.BX)(y.G,{css:[{border:"1px solid ".concat(x.TV.outlineDefault)},x.l0.borderRadius(2)],children:[(0,f.tZ)(ej.ZP,{ref:l,filePath:v,css:[cg.Mp,x.l0.backgroundColor.backgroundDefault,x.l0.borderRadius(8),x.l0.overflow("auto"),x.l0.minHeight(100),x.l0.maxHeight(500),{".cm-panel":{zIndex:1}}],initialDoc:i,extensions:[L?[]:uz,N,g,L&&!U?F:[],L?j:[],L?q:[]]}),(0,f.tZ)(uV,{expanded:d,onExpand:function(){h(function(e){return!e})}})]}),(0,f.tZ)(W.zx,{text:"Run Query",iconLeft:T?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(rl.Z,{}),onClick:D,disabled:T})]}),(0,f.tZ)(uq,{queryResult:S,scrollRef:A}),(0,f.tZ)(y.G,{css:[x.l0.colWithGap(8),x.l0.px(8),x.l0.py(8)],children:(0,f.tZ)(W.zx,{css:x.l0.backgroundColor.backgroundDefault,text:"Show All Contents",iconLeft:(0,f.tZ)(sC.Z,{}),onClick:P})})]})})},u$=(0,t8.cn)(null),uQ=(0,t8.cn)(null),u0=function(){var e=(0,t2.b9)(u$),t=(0,t2.b9)(uQ);return(0,_.useCallback)(function(n){if(!n){e(null),t(null);return}e({connectionString:n,databaseId:-1,databaseName:"Admin Override",isFrozen:!1,projectId:"mock-project-id-does-not-exist",__typename:"NeonDatabase"}),t(n)},[t,e])},u1=(0,b.X)({self:[x.l0.colWithGap(0),x.l0.height("100%"),x.l0.p(8)],main:[x.l0.colWithGap(16),x.l0.flex.grow(1),x.l0.flex.shrink(0)],header:[x.l0.rowWithGap(8),x.l0.align.center],status:[x.l0.width(8),x.l0.height(8),x.l0.backgroundColor.accentPositiveStronger,x.l0.borderRadius("full"),{filter:"drop-shadow(0 0 6px ".concat(x.TV.accentPositiveStronger,")")}],title:[x.l0.color.accentPositiveStronger],docs:[c7.Z,x.l0.maxWidth("100%")],footer:[x.l0.pt(16)],remove:[x.l0.py(8)],removeConfirm:[x.l0.p(8),x.l0.colWithGap(8)]}),u2=function(e){var t,n=e.neonDatabases,r=e.onDatabaseDeleted,i=e.onDatabaseUnfreezed,o=e.performPaneOperation,a=n[0],l=(0,ao.Z)().showError,c=(0,eZ.Z)(),s=(0,t2.Dv)(s4),d=s3(),h=(0,_.useCallback)(function(){d("queryEditor")},[d]),p=(0,u._)((t=(0,U._)({},sp,void 0),aP.D(sv,t)),2),m=p[0],v=p[1].loading,b=(0,_.useCallback)(function(){C(!0)},[]),w=(0,_.useCallback)((0,ts._)(function(){var e,t,n;return(0,tu.Jh)(this,function(i){switch(i.label){case 0:return[4,m({variables:{input:{replId:c,databaseId:a.databaseId}}})];case 1:if(t=(e=i.sent()).data,n=e.errors,C(!1),n&&n.length>0)return l("Error when deleting Neon database: ".concat(null==n?void 0:n.join())),cJ({action:"removed",success:!1}),[2];if((null==t?void 0:t.deleteNeonDatabase.__typename)!=="DeleteNeonDatabaseResult")return l("Error: ".concat(null==t?void 0:t.deleteNeonDatabase.message)),cJ({action:"removed",success:!1}),[2];return(null==t?void 0:t.deleteNeonDatabase.success)?(r(),cJ({action:"removed",success:!0})):(l("Error: Delete Neon Database failed."),cJ({action:"removed",success:!1})),[2]}})}),[m,a.databaseId,r,c,l]),Z=(0,u._)((0,_.useState)(!1),2),x=Z[0],C=Z[1],S=(0,_.useCallback)(function(){C(!1)},[]),k=(0,t2.Dv)(uQ),E=c3({connectionString:a.connectionString,databaseName:a.databaseName})[cQ].split(".")[0],T=k||"".concat(a.connectionString,"/").concat(a.databaseName,"?sslmode=require&options=project%3D").concat(E);if("queryEditor"===s)return(0,f.tZ)(uK,{connectionString:T,performPaneOperation:o});if("tableSchemas"===s)return(0,f.tZ)(ua,{connectionString:T});if(s.startsWith("table/")){var R=s.slice(s.indexOf("/")+1);return(0,f.tZ)(ug,{tableName:R,connectionString:T})}return(0,f.BX)(y.G,{css:u1.self,children:[(0,f.tZ)(y.G,{css:u1.main,children:a.isFrozen?(0,f.tZ)(sZ,{replId:c,neonProjectId:a.projectId,onDatabaseUnfreezed:i}):(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,{css:u1.header,children:[(0,f.tZ)(y.G,{css:u1.status}),(0,f.tZ)(g.xv,{css:u1.title,multiline:!1,children:"Database connected"})]}),(0,f.tZ)(sx,{title:"Database Info",children:(0,f.tZ)(up,{connectionString:T,onOpenDatabaseViewerClick:h,showUsageLink:!0})}),(0,f.tZ)(sx,{title:"Using the database",isAccordion:!0,children:(0,f.tZ)(nC.ZP,{css:u1.docs,children:"\nPostgreSQL is a powerful open source relational database system that is widely used in web applications and other software development projects. You can easily create a production-ready PostgreSQL database directly within Replit. For more information on PostgreSQL, visit the [official documentation](https://www.postgresql.org/docs/). Repls use PostgreSQL version 15.\n\nHere is some information to help you get started:\n\n1. Replit databases are backed by [Neon](https://neon.tech/). The [Neon documentation](https://neon.tech/docs/connect/connect-from-any-app#connection-examples) provides guides on how to connect various frameworks, such as Django, to your PostgreSQL database.\n\n1. Environment Variables: We provided environment variables `DATABASE_URL`, `PGDATABASE`, `PGHOST`, `PGHOST`, `PGPORT`, `PGUSER`, `PGPASSWORD`. Provide these values to your framework of choice to connect to your database.\n\n1. Connection pooling: If you need to enable connection pooling for any reason, contact us at support@repl.it.\n\n1. Compute lifecycle: Neon databases go to sleep after 5 minutes of inactivity. You may experience disconnects or reconnects depending on your client.\n"})}),(0,f.tZ)(sx,{title:"Environment variables",isAccordion:!0,children:(0,f.tZ)(c6,{connectionString:T,databaseName:a.databaseName})})]})}),(0,f.tZ)(y.G,{css:u1.footer,children:x||v?(0,f.BX)(H.Tg,{css:u1.removeConfirm,elevated:!0,children:[(0,f.tZ)(g.xv,{children:"Removing this database will remove access to the data for this Repl."}),(0,f.tZ)(rT.E,{icon:(0,f.tZ)(rn.Z,{}),colorway:"warning",text:"This action cannot be undone."}),(0,f.tZ)(W.zx,{text:"Yes, Remove Database",colorway:"negative",disabled:v,iconLeft:(0,f.tZ)(c9.Z,{}),onClick:w}),(0,f.tZ)(W.zx,{text:"Cancel",disabled:v,onClick:S})]}):(0,f.tZ)(W.zx,{css:u1.remove,text:"Remove Database",disabled:v,iconLeft:(0,f.tZ)(c9.Z,{}),onClick:b})}),(0,f.tZ)(uw,{})]})},u8=n(93302),u4=n(4513),u3=n(92977),u5=n(97764);function u6(){var e=(0,ex._)(["\n  query NeonStartPage {\n    currentUser {\n      id\n      userSubscriptionType\n      usageBasedBilling(input: { capabilitiesOnly: true }) {\n        __typename\n        ... on UserUsageBasedBillingSummary {\n          capabilities {\n            canUseUsageBasedBilling\n            explanation\n            hasPaymentMethod\n          }\n        }\n      }\n      usageInterval {\n        ... on UsageInterval {\n          resources {\n            neonComputeTime {\n              allotment\n              usage\n            }\n            neonDataStorage {\n              allotment\n              usage\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return u6=function(){return e},e}var u9={},u7=(0,eC.Ps)(u6()),de=(0,b.X)({self:[x.l0.px(8),x.l0.pt(16)],container:[x.l0.colWithGap(32),x.l0.py(32),x.l0.textAlign.center,u3.Qw.maxWidth],title:[x.l0.colWithGap(4),x.l0.width("100%"),x.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],usage:[x.l0.colWithGap(4),x.l0.width("100%"),x.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],cta:[x.l0.width("100%"),x.l0.maxWidth(320),{marginLeft:"auto",marginRight:"auto"}],ctaContainer:[x.l0.colWithGap(8),x.l0.align.center],ctaStatusBanner:[x.l0.textAlign.left],payment:[x.l0.p(16),x.l0.borderRadius(12),x.l0.textAlign.left,x.l0.shadow(2)],budgetContainer:[x.l0.colWithGap(8),x.l0.border(),x.l0.borderRadius(8),x.l0.p(8)],disabledBanner:[x.l0.py(6),{alignSelf:"center"}],details:[x.l0.colWithGap(12),x.l0.maxWidth(400),{marginLeft:"auto",marginRight:"auto"}],detailsItem:{display:"grid",gridTemplateColumns:"56px auto",gap:20},detailsText:[x.l0.flex.growAndShrink(1),x.l0.textAlign.left]});function dt(e){var t=e.loading,n=e.ubbExplanation,r=e.hasPaymentMethod,i=e.handleOnCreate,o=e.refetchUbbCapabilitiesQueryData,a=e.setShowPaymentMethodForm,l=e.showPaymentMethodForm,c=e.setShowSupportForm,s=(0,aZ.rv)();return n===aB.Fp.NeedsSubscription||n===aB.Fp.NeedsSubscriptionOrPaymentMethod?s?(0,f.tZ)(rT.E,{text:"You need a subscription to create a database. Navigate to Account > Billing to upgrade.",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:de.ctaStatusBanner}):(0,f.BX)(y.G,{css:de.ctaContainer,children:[(0,f.tZ)(so.Z,{context:"workspace_hosting_pane",text:"Upgrade your plan to create a database",css:de.cta,colorway:"primary",variant:"outlined",disabled:l,onPlanCheckoutComplete:o}),(0,f.tZ)(W.zx,{variant:"nofill",colorway:"primary",text:"or add a payment method",css:de.cta,disabled:l,loading:t,iconLeft:(0,f.tZ)(si.Z,{}),onClick:function(){return a()}})]}):n===aB.Fp.NeedsSmsVerification?(0,f.tZ)(se.Z,{context:aB.jv.Neon,onSuccess:o}):n===aB.Fp.NeedsPaymentMethod?s?(0,f.tZ)(rT.E,{text:"You have used all free usage for this month. Check your email for more information or contact support.",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:de.ctaStatusBanner}):(0,f.tZ)(W.zx,{colorway:"primary",text:"Add a payment method",css:de.cta,disabled:l,loading:t,iconLeft:(0,f.tZ)(si.Z,{}),onClick:function(){return a()}}):n===aB.Fp.NeedsUnbanning?(0,f.tZ)(sr.u,{text:"Your account currently has restrictions on creating a database. We're here to help! Please reach out to our support team for assistance.",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:de.ctaStatusBanner,onClick:function(){return c()}}):n===aB.Fp.InsufficientBudget?(0,f.BX)(f.HY,{children:[(0,f.tZ)(rT.E,{text:"You've reached your monthly usage budget. Increase your budget to create a database.",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:de.ctaStatusBanner}),(0,f.tZ)(y.G,{css:de.budgetContainer,children:(0,f.tZ)(sn.L,{onUpdateSuccess:o})})]}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(W.zx,{colorway:"primary",onClick:i,css:de.cta,text:t?"":"Create a database",iconLeft:t?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(f.HY,{}),loading:t}),!1===r?(0,f.tZ)(sr.u,{text:"Add a payment method to avoid downtime",colorway:"warning",icon:(0,f.tZ)(rn.Z,{}),css:de.ctaStatusBanner,onClick:function(){return s?null:a()}}):null]})}var dn=function(e){var t,n,r,i=e.onDatabaseCreated,o=(0,u._)((0,_.useState)(!1),2),a=o[0],l=o[1],c=(0,u._)((0,_.useState)(!1),2),s=c[0],d=c[1],h=(0,eZ.Z)(),p=(0,ao.Z)().showError,m=(t=(0,U._)({},u9,{notifyOnNetworkStatusChange:!0,onError:function(e){p(e.message)}}),eS.a(u7,t)),v=m.loading,b=m.data,w=m.refetch,Z=(0,u._)((n=(0,U._)({},sp,{onError:function(e){p("Error when creating Neon database: ".concat(e.message)),cJ({action:"created",success:!1})},onCompleted:function(e){if((null==e?void 0:e.createNeonDatabase.__typename)==="CreateNeonDatabaseResult"){var t=e.createNeonDatabase;i({__typename:"NeonDatabase",databaseId:t.databaseId,databaseName:t.databaseName,connectionString:t.connectionString,projectId:t.projectId,isFrozen:t.isFrozen}),cJ({action:"created",success:!0})}else{p("Error: ".concat(null==e?void 0:e.createNeonDatabase.message)),cJ({action:"created",success:!1});return}}}),aP.D(sm,n)),2),C=Z[0],S=Z[1].loading,k=(null==b?void 0:null===(r=b.currentUser)||void 0===r?void 0:r.usageBasedBilling.__typename)==="UserUsageBasedBillingSummary"?b.currentUser.usageBasedBilling.capabilities:null,E=(0,_.useMemo)(function(){return function(e){var t=e.data,n=null==t?void 0:t.usageInterval;if(n&&"UsageInterval"===n.__typename){var r=Math.max(0,n.resources.neonComputeTime.allotment-n.resources.neonComputeTime.usage),i=(0,u8.fZ)(r,{resourceUsageType:"ComputeHours"}),o=Math.max(0,n.resources.neonDataStorage.allotment-n.resources.neonDataStorage.usage);return{formattedComputeTimeAmount:i,formattedDataStorageAmount:(0,u8.fZ)(o,{precision:1,resourceUsageType:"GiB"})}}}({data:null==b?void 0:b.currentUser})},[b]);return(0,f.BX)(y.G,{css:de.self,children:[(0,f.tZ)(rE.u,{isOpen:s,onRequestClose:function(){return d(!1)},children:(0,f.tZ)(st.Z,{onRequestClose:function(){return d(!1)}})}),(0,f.BX)(y.G,{css:de.container,children:[(0,f.BX)(y.G,{css:de.title,children:[(0,f.tZ)(g.xv,{variant:"subheadBig",children:"PostgreSQL Database"}),(0,f.tZ)(g.xv,{color:"dimmer",children:"Fully-managed, usage based PostgreSQL database with 10GB of fast read/write storage."}),(0,f.tZ)(g.xv,{css:x.l0.textAlign.center,children:(0,f.tZ)("a",{href:uu,target:"_blank",rel:"noopener",children:"Learn more"})})]}),(0,f.BX)(y.G,{css:x.l0.colWithGap(16),children:[(0,f.tZ)(y.G,{css:[x.l0.rowWithGap(0),x.l0.justify.center],children:(0,f.tZ)(oL.Z,{src:"/public/images/db_illustration.png",width:120,height:120,alt:"FPO visual"})}),null!=E?(0,f.BX)(g.xv,{css:de.usage,color:"dimmer",children:["You have ",E.formattedComputeTimeAmount," left this month and ",E.formattedDataStorageAmount," of storage left in total."]}):null,(0,f.BX)(y.G,{css:x.l0.colWithGap(8),children:[(0,f.tZ)(dt,{loading:v||S,ubbExplanation:null==k?void 0:k.explanation,hasPaymentMethod:null==k?void 0:k.hasPaymentMethod,handleOnCreate:function(){C({variables:{input:{replId:h}}})},refetchUbbCapabilitiesQueryData:w,setShowPaymentMethodForm:function(){return l(!0)},showPaymentMethodForm:a,setShowSupportForm:function(){return d(!0)}}),a?(0,f.tZ)(H.Tg,{elevated:!0,css:de.payment,children:(0,f.tZ)(u5.q,{onSuccess:(0,ts._)(function(){return(0,tu.Jh)(this,function(e){switch(e.label){case 0:return l(!1),[4,w()];case 1:return e.sent(),[2]}})}),context:"workspace_hosting_pane"})}):null]})]}),(0,f.BX)(y.G,{css:de.details,children:[(0,f.BX)(y.G,{css:de.detailsItem,children:[(0,f.tZ)(u4.lt,{}),(0,f.BX)(g.xv,{css:de.detailsText,children:["Get charged for what you use across compute time, storage, written data and data transfer,"," ",(0,f.tZ)("a",{href:ud,target:"_blank",rel:"noopener",children:"see pricing"})]})]}),(0,f.BX)(y.G,{css:de.detailsItem,children:[(0,f.tZ)(u4.fG,{}),(0,f.BX)(g.xv,{css:de.detailsText,children:["Free usage allocations are included in Replit plans, and then billed at a per unit price,"," ",(0,f.tZ)("a",{href:ud,target:"_blank",rel:"noopener",children:"see allocations"})]})]})]})]})]})},dr=function(e){var t,n,r=e.performPaneOperation,i=(0,eZ.Z)(),o=(0,ao.Z)().showError,a=(0,C.Z)().psql,l=(0,u._)((0,_.useState)([]),2),c=l[0],s=l[1],d=(t=(0,U._)({},sp,{variables:{input:{replId:i}},fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,onCompleted:function(e){if("GetNeonDatabasesResult"===e.getNeonDatabases.__typename){s(e.getNeonDatabases.databases);return}o("Error: ".concat(e.getNeonDatabases.message))}}),eS.a(sg,t)),h=d.loading,p=d.refetch,m=c5(),v=(0,_.useCallback)((n=(0,ts._)(function(e){var t;return(0,tu.Jh)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),s([e]),[4,a.ensureNixPsqlPackageInstalled(!0)];case 1:return n.sent(),m({connectionString:e.connectionString,databaseName:e.databaseName}),[3,3];case 2:return t=n.sent(),o("Error: ".concat(t.message)),[3,3];case 3:return[2]}})}),function(e){return n.apply(this,arguments)}),[a,m,o]),g=(0,t2.Dv)(u$);return g?(0,f.tZ)(u2,{neonDatabases:[g],onDatabaseDeleted:p,onDatabaseUnfreezed:p,performPaneOperation:r}):h?(0,f.tZ)(y.G,{css:[x.l0.flex.row,x.l0.justify.center,x.l0.p(32)],children:(0,f.tZ)(Z.Z,{})}):c.length?(0,f.tZ)(u2,{neonDatabases:c,onDatabaseDeleted:p,onDatabaseUnfreezed:p,performPaneOperation:r}):(0,f.tZ)(dn,{onDatabaseCreated:v})},di=h.Dy.Object({type:h.Dy.Literal("neon")}),da={Content:function(e){var t=e.options;return(0,f.tZ)(dr,{performPaneOperation:t.performPaneOperation})},Icon:function(e){var t=e.size;return(0,f.tZ)(cj.Z,{size:t})},getTitle:function(){return"PostgreSQL"},decode:function(e){return p.B4.Decode(di,e)}},dl=n(9610),dc=n(16643),ds=n(20399),du=n(96239),dd=n(13900),df=n(35375),dh=n(1854),dp=n(3409),dm=(0,b.X)({self:[x.l0.p(12),x.l0.colWithGap(16)],devUrl:[x.l0.rowWithGap(4),x.l0.align.center],url:[x.l0.color.accentPositiveStronger,x.l0.fontSize("small"),x.l0.focusRing,{"&:hover":[x.l0.cursor.pointer,x.l0.color.accentPositiveStrongest]}],secondaryUrl:[x.l0.color.foregroundDimmest,x.l0.fontSize("small"),x.l0.focusRing,{"&:hover":[x.l0.cursor.pointer,x.l0.color.accentPrimaryStrongest]}],section:[x.l0.colWithGap(4)],portHeader:[x.l0.rowWithGap(8),x.l0.align.baseline],openPort:[x.l0.color.accentPositiveStronger],localPortIcon:[x.l0.color.foregroundDefault,x.l0.px(4),{flex:"0 0 auto",marginLeft:"auto"}],internalMessage:[x.l0.flex.shrink(1),{marginLeft:"auto",span:x.l0.color.foregroundDimmest}],portStatus:[x.l0.py(0),x.l0.px(4)],newPort:[x.l0.color.foregroundDefault,x.l0.rowWithGap(4),x.l0.align.center,x.l0.my(1),x.l0.borderRadius(16),x.l0.height(20)],externalPortButton:[{"&":[x.l0.height(20),x.l0.borderRadius(16),x.l0.color.foregroundDefault]}],externalPortPopup:[{"&":[x.l0.height(20),x.l0.p(6),x.l0.borderRadius(16),x.l0.color.foregroundDefault],"& > span":[x.l0.fontSize(12)],"& > svg":[x.l0.mr(4)]}],textButton:[x.l0.cursor.pointer,x.l0.reset.button,x.l0.color.accentPrimaryStronger,x.l0.focusRing,x.l0.hover(x.l0.color.accentPrimaryStrongest),{lineHeight:1.2,":not([disabled])":{cursor:"pointer"}}],newPortInput:[x.l0.height(20),x.l0.my(1)],newPortClose:x.l0.mr(4),portActionItem:[x.l0.fontSize(x.TV.fontSizeDefault),x.l0.viewStyle,x.l0.height(32),x.l0.px(16),x.l0.py(8),x.l0.flex.row,x.l0.align.center,x.l0.color.foregroundDefault,x.l0.backgroundColor.backgroundDefault,nn.gU.listItem,{":not([disabled])":{":hover":{backgroundColor:x.TV.backgroundHigher}}}]});function dv(e){var t,n,r,i=e.localPort,o=e.externalPort,a=e.isLocalhost,l=e.onPortChange,c=(0,C.Z)().ports.updateDotReplitPortsMapping,s=(t=(0,C.Z)().ports,n=(0,dc.Z)(t.portsState),r=new Set(null==n?void 0:n.map(function(e){var t;return null!==(t=(0,df.OD)(e.configuration))&&void 0!==t&&t}).filter(Boolean)),Array.from(df.UK).sort(function(e,t){return e-t}).map(function(e){return{isAvailable:!r.has(e),externalPort:e}}));return(0,f.tZ)(y.G,{css:x.l0.flex.row,children:void 0!==o&&0!==o?(0,f.tZ)(W.zx,{css:dm.externalPortButton,iconRight:(0,f.tZ)(rr.Z,{}),text:":".concat(o),size:"small",onClick:function(){i&&(c(i,void 0,a),null==l||l())}}):(0,f.tZ)(ds.ZE,{cssProps:[dm.externalPortPopup],label:"Set external port",onAction:function(e){if(i){var t=s.find(function(t){return String(t.externalPort)===e});t&&t.isAvailable&&(c(i,t.externalPort,a),null==l||l())}},children:s.map(function(e){var t=e.isAvailable,n=e.externalPort;return(0,f.tZ)(ds.ck,{"aria-label":String(n),children:(0,f.BX)(y.G,{css:t?x.l0.color.foregroundDefault:x.l0.color.foregroundDimmest,children:[":",n]})},String(n))})})})}function dg(e){var t=e.portState,n=null;switch(t.configuration.type){case df.DL.MISCONFIGURED:n=(0,f.tZ)(ta.u,{tooltip:"Port misconfigured",delay:"default",children:(0,f.tZ)(rn.Z,{})});break;case df.DL.CONFIG_MISSING:n=(0,f.tZ)(ta.u,{tooltip:"Configuration missing",delay:"default",children:(0,f.tZ)(rn.Z,{})});break;case df.DL.NO_MORE_EXTERNAL_PORTS_AVAILABLE:n=(0,f.tZ)(rn.Z,{});break;case df.DL.FORWARDED:n=(0,f.tZ)(V.Z,{});case df.DL.INTERNAL_ONLY:}return(0,f.tZ)("span",{css:dm.localPortIcon,children:n})}function dy(e){var t=e.portState,n=e.width,r=(0,df.VZ)(t.configuration)?"localhost":"0.0.0.0";return(0,f.BX)(dh.sg,{width:n||130,children:[(0,f.BX)(g.xv,{css:t.isOpen&&dm.openPort,children:[r,":",t.configuration.localPort]}),(0,f.tZ)(dg,{portState:t})]})}function db(e){var t=e.portState,n=e.openWebview,r=e.width;if(t.configuration.type===df.DL.NO_MORE_EXTERNAL_PORTS_AVAILABLE)return(0,f.tZ)(dh.sg,{width:r||160,children:(0,f.tZ)(rT.E,{css:dm.portStatus,icon:(0,f.tZ)(rn.Z,{}),text:"No ports available"})});var i=!!n&&t.isOpen&&t.configuration.type===df.DL.FORWARDED;return(0,f.BX)(dh.sg,{width:r||160,children:[(0,f.tZ)(dv,{localPort:t.configuration.localPort,externalPort:(0,df.OD)(t.configuration),isLocalhost:(0,df.VZ)(t.configuration)}),i?(0,f.tZ)(m.hU,{alt:"Open in Webview",onClick:n,css:x.l0.color.foregroundDefault,children:(0,f.tZ)(du.Z,{})}):null]})}function dw(e){var t,n=e.portState;return n.isOpen?(0,f.BX)(f.HY,{children:[(0,f.tZ)(dh.sg,{width:100,children:(t=n.processInfo.cmdline[0].split("/"))[t.length-1]}),(0,f.tZ)(dh.sg,{width:100,children:n.processInfo.pid})]}):(0,f.tZ)(dh.sg,{width:100})}function dZ(e){var t=e.portState,n=e.onAction,r=e.allowedActions,i=void 0===r?["OPEN_WEBVIEW","EXTERNAL_LINK","REMOVE"]:r,o=[];return i.includes("OPEN_WEBVIEW")&&o.push({label:"Open webview",key:"OPEN_WEBVIEW",icon:(0,f.tZ)(du.Z,{})}),i.includes("EXTERNAL_LINK")&&o.push({label:"Open external link",key:"EXTERNAL_LINK",icon:(0,f.tZ)(rP.Z,{})}),i.includes("REMOVE")&&o.push({label:"Remove port config",key:"REMOVE",icon:(0,f.tZ)(c9.Z,{})}),(0,f.tZ)(dh.sg,{width:26,last:!0,children:(0,f.tZ)(ds.ZE,{cssProps:[x.l0.height(22),x.l0.width(22),x.l0.color.foregroundDefault,{background:"transparent"}],menuCssProps:[{li:[x.l0.p(0)],"li > div":[x.l0.pl(6),x.l0.rowWithGap(4),x.l0.align.center]}],items:o,icon:(0,f.tZ)(dd.Z,{}),onAction:function(e){switch(e){case"OPEN_WEBVIEW":case"EXTERNAL_LINK":case"REMOVE":n({type:e,payload:{portState:t}})}},children:o.map(function(e){return(0,f.tZ)(ds.ck,{children:(0,f.BX)(y.G,{css:dm.portActionItem,children:[e.icon?e.icon:(0,f.tZ)(y.G,{css:[x.l0.width(16)]}),(0,f.tZ)(g.xv,{multiline:!1,children:e.label})]})},e.key)})})})}function dx(e){var t=e.portState,n=e.portAction;return(0,f.BX)(dh.X2,{children:[(0,f.tZ)(dy,{portState:t}),(0,f.tZ)(db,{portState:t,openWebview:function(){n({type:"OPEN_WEBVIEW",payload:{portState:t}})}}),(0,f.tZ)(dw,{portState:t}),(0,f.tZ)(dZ,{portState:t,onAction:n})]},t.configuration.localPort)}(gI=gz||(gz={})).OPEN_WEBVIEW="OPEN_WEBVIEW",gI.EXTERNAL_LINK="EXTERNAL_LINK",gI.REMOVE="REMOVE";var dC=function(e){var t=e.text,n=e.onClick;return(0,f.tZ)("button",{css:dm.textButton,onClick:n,children:t})};function dS(e){var t,n=e.openDotReplit,r=(0,u._)((0,_.useState)(!1),2),i=r[0],o=r[1],a=(0,u._)((0,_.useState)(),2),l=a[0],c=a[1],s=null===(t=(0,C.Z)().ports.portsState.current)||void 0===t?void 0:t.some(function(e){return e.configuration.localPort===l});return i?(0,f.BX)(dh.X2,{children:[(0,f.BX)(dh.sg,{width:130,children:[(0,f.tZ)(m.hU,{css:dm.newPortClose,alt:"Close",onClick:function(){return o(!1)},size:18,children:(0,f.tZ)(rr.Z,{})}),(0,f.tZ)(X.II,{css:dm.newPortInput,value:(null==l?void 0:l.toString())||"",onChange:function(e){return c(e.target.value?parseInt(e.target.value,10):void 0)}})]}),(0,f.tZ)(dh.sg,{children:s?(0,f.tZ)(rT.E,{css:dm.portStatus,colorway:"warning",text:"Local port already exists"}):(0,f.tZ)(dv,{localPort:l,isLocalhost:!1,onPortChange:function(){return o(!1)}})})]}):(0,f.BX)(dh.X2,{children:[(0,f.tZ)(dh.sg,{width:130,children:(0,f.tZ)(W.zx,{css:dm.newPort,iconLeft:(0,f.tZ)(na.Z,{size:12}),text:"New port",size:"small",onClick:function(){return o(!0)}})}),(0,f.tZ)(dh.sg,{children:(0,f.BX)(g.xv,{variant:"small",children:["This port config is saved in the"," ",(0,f.tZ)(dC,{text:".replit file",onClick:n}),"."," "]})})]})}function dk(e){var t,n=e.openDotReplit,r=e.openWebview,i=(0,eZ.Z)(),o=(0,dp.J_)(i),a=(0,ao.Z)().showError,l=(0,C.Z)().ports,c=l.portsState,s=l.removeDotReplitPortsMapping,u=function(e){switch(e.type){case"OPEN_WEBVIEW":r(e.payload.portState.configuration.localPort);break;case"EXTERNAL_LINK":var t=(0,df.OD)(e.payload.portState.configuration);if(!(null==o?void 0:o.presentationUrl)){a("URL not available.");return}var n=(0,dp.hw)(null==o?void 0:o.presentationUrl,t).toString();window.open(n,"_blank");break;case"REMOVE":s(e.payload.portState.configuration.localPort,(0,df.OD)(e.payload.portState.configuration))}};return(0,f.BX)(y.G,{css:dm.self,children:[(null==o?void 0:o.presentationUrl)?(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,{css:dm.section,children:[(0,f.tZ)(g.xv,{children:"Dev URL:"}),(0,f.BX)(y.G,{css:dm.devUrl,children:[(0,f.tZ)(sI(),{legacyBehavior:!0,href:o.presentationUrl,passHref:!0,children:(0,f.tZ)("a",{css:dm.url,target:"_blank",children:o.presentationUrl})}),(0,f.tZ)(tq.qi,{value:o.presentationUrl})]})]}),(0,f.tZ)(nt.R,{})]}):null,(0,f.BX)(y.G,{css:dm.section,children:[(0,f.BX)(y.G,{css:dm.portHeader,children:[(0,f.tZ)(g.xv,{children:"Ports"}),(0,f.tZ)(sI(),{legacyBehavior:!0,href:"https://docs.replit.com/programming-ide/workspace-features/webview",passHref:!0,children:(0,f.tZ)("a",{css:dm.secondaryUrl,target:"_blank",children:"Learn more"})})]}),(0,f.BX)(dh.iA,{children:[(0,f.BX)(dh.X2,{children:[(0,f.tZ)(dh.sg,{header:!0,width:130,children:"Internal Port"}),(0,f.tZ)(dh.sg,{header:!0,width:160,children:"External Port"}),(0,f.tZ)(dh.sg,{header:!0,width:100,children:"Name"}),(0,f.tZ)(dh.sg,{header:!0,width:100,children:"Pid"})]}),c.current&&(null===(t=c.current)||void 0===t?void 0:t.length)>0?c.current.map(function(e){return(0,f.tZ)(dx,{portState:e,portAction:u},e.configuration.localPort)}):null,(0,f.tZ)(dS,{openDotReplit:n})]})]})]})}var d_=n(81810),dE=(0,b.X)({unavailable:[x.l0.p(8)]}),dT=h.Dy.Object({type:h.Dy.Literal("networking")}),dR={Content:function(e){var t,n=e.options.performPaneOperation,r=(0,ao.Z)().showError,i=(0,C.Z)().fs;return(0,tQ.P5)({controlName:d_.c0,logFlagToAnalytics:!0})?(0,f.tZ)(dk,{openDotReplit:(0,ts._)(function(){return(0,tu.Jh)(this,function(e){switch(e.label){case 0:return[4,i.stat(".replit")];case 1:if(!e.sent().exists)return r("Could not find .replit configuration file."),[2];return n({operation:"open",secondary:!0,pane:{type:"codeEditor",data:{path:".replit"}}}),[2]}})}),openWebview:(t=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){return n({operation:"open",pane:{type:"webview",data:e?{portType:"local",port:e}:void 0},secondary:!0}),[2]})}),function(e){return t.apply(this,arguments)})}):(0,f.tZ)(y.G,{css:dE.unavailable,children:(0,f.tZ)(g.xv,{children:"Networking is not available."})})},Icon:function(e){var t=e.size;return(0,f.tZ)(dl.Z,{size:t})},getTitle:function(){return"Networking"},decode:function(e){return p.B4.Decode(dT,e)}},dI=n(4479),dD=n(83447),dG=h.Dy.Object({id:h.Dy.String(),name:h.Dy.String(),contentType:h.Dy.Optional(h.Dy.String()),timeCreated:h.Dy.String(),size:h.Dy.String()}),dB=h.Dy.Array(dG),dP={FILE:"file"},dA=n(34471);function dN(e){return"".concat(e.status," - ").concat(e.statusText)}function dL(){return(dL=(0,ts._)(function(e){var t,n,r,i;return(0,tu.Jh)(this,function(o){switch(o.label){case 0:return t=e.bucketExternalId,[4,fetch("/object-storage/storage/v1/b/".concat(t,"/o"),{method:"GET",credentials:"same-origin"})];case 1:if(!(n=o.sent()).ok)throw Error("Failed to get objects: ".concat(dN(n)));return[4,n.json()];case 2:if(i=null!==(r=o.sent().items)&&void 0!==r?r:[],!p.B4.Check(dB,i))throw(0,dA.ZA)(dB,i);return[2,i]}})})).apply(this,arguments)}function dU(e){return dO.apply(this,arguments)}function dO(){return(dO=(0,ts._)(function(e){var t,n,r,i;return(0,tu.Jh)(this,function(o){switch(o.label){case 0:return t=e.bucketExternalId,n=e.objectName,r=e.formData,[4,fetch("/object-storage/upload/storage/v1/b/".concat(t,"/o?name=").concat(n),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},body:r})];case 1:if(!(i=o.sent()).ok)throw Error("Failed to upload object: ".concat(dN(i)));return[2,i.json()]}})})).apply(this,arguments)}function dM(e){return dX.apply(this,arguments)}function dX(){return(dX=(0,ts._)(function(e){var t,n,r;return(0,tu.Jh)(this,function(i){switch(i.label){case 0:return t=e.bucketExternalId,n=e.objectName,[4,fetch("/object-storage/storage/v1/b/".concat(t,"/o/").concat(n.replaceAll("/","%2F")),{method:"DELETE",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})];case 1:if(!(r=i.sent()).ok)throw Error("Failed to delete object: ".concat(dN(r)));return[2]}})})).apply(this,arguments)}function dF(){return(dF=(0,ts._)(function(e){var t,n,r,i,o,a,l;return(0,tu.Jh)(this,function(c){switch(c.label){case 0:return t=e.sourceBucketExternalId,n=e.destinationBucketExternalId,r=e.sourceObjectName,i=e.destinationObjectName,o=encodeURIComponent(r),a=encodeURIComponent(i),[4,fetch("/object-storage/storage/v1/b/".concat(t,"/o/").concat(o,"/copyTo/b/").concat(n,"/o/").concat(a),{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"}})];case 1:if(!(l=c.sent()).ok)throw Error("Failed to copy object: ".concat(dN(l)));return[2]}})})).apply(this,arguments)}var dW=(0,t8.cn)(new Map),dH=(0,t8.cn)(null,function(e,t,n){var r=n.bucketExternalId,i=n.objects;t(dW,function(e){return(0,uU.Uy)(e,function(e){e.set(r,i)})})}),dV=(0,t8.cn)(null,function(e,t,n){var r=n.bucketExternalId,i=n.name,o=n.contentType,a=n.size,l={id:"optimistic-"+tP()(),name:i,contentType:o,size:a,timeCreated:new Date().toISOString(),optimisticallyInserted:!0};t(dW,function(e){return(0,uU.Uy)(e,function(e){var t;(null!==(t=e.get(r))&&void 0!==t?t:[]).push(l)})})}),dz=(0,t8.cn)(null,function(e,t,n){var r=n.name,i=n.bucketExternalId;t(dW,function(e){return(0,uU.Uy)(e,function(e){var t=e.get(i);if(!t)throw Error("Bucket not found when marking object as pending deletion");var n=t.findIndex(function(e){return e.name===r});if(-1===n)throw Error("Object not found when marking object as pending deletion");t[n].isPendingDeletion=!0})})}),dj=new Intl.Collator;function dq(e){return e.sort(function(e,t){return dj.compare(e.displayName,t.displayName)})}function dY(e){var t,n=e.bucketExternalId;return null!==(t=(0,t2.Dv)(dW).get(n))&&void 0!==t?t:[]}function dJ(){var e=(0,u._)((0,_.useState)(!1),2),t=e[0],n=e[1],r=(0,t2.b9)(dH);function i(){return(i=(0,ts._)(function(e){var t,i,o,a;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:t=e.bucketExternalId,i=e.onError,n(!0),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,function(e){return dL.apply(this,arguments)}({bucketExternalId:t})];case 2:return o=l.sent(),r({bucketExternalId:t,objects:o}),[3,4];case 3:return a=l.sent(),null==i||i(a),[3,4];case 4:return n(!1),[2]}})})).apply(this,arguments)}return{loading:t,fetchObjects:function(e){return i.apply(this,arguments)}}}function dK(){var e=(0,u._)((0,_.useState)(!1),2),t=e[0],n=e[1],r=(0,t2.b9)(dV),i=dJ().fetchObjects;function o(){return(o=(0,ts._)(function(e){var t,o,a,l,c;return(0,tu.Jh)(this,function(s){switch(s.label){case 0:t=e.bucketExternalId,o=e.files,a=e.targetFolder,l=e.onError,n(!0),s.label=1;case 1:var u;return s.trys.push([1,3,,4]),[4,Promise.all(o.map((u=(0,ts._)(function(e){var n,i;return(0,tu.Jh)(this,function(o){switch(o.label){case 0:return n=a+(e.webkitRelativePath||e.dirPath||e.name),r({bucketExternalId:t,name:n,contentType:e.type,size:null==e?void 0:e.size.toString()}),(i=new FormData).append("file",e),[4,dU({bucketExternalId:t,objectName:n,formData:i})];case 1:return o.sent(),[2]}})}),function(e){return u.apply(this,arguments)})))];case 2:return s.sent(),[3,4];case 3:return c=s.sent(),null==l||l(c),[3,4];case 4:return[4,i({bucketExternalId:t})];case 5:return s.sent(),n(!1),[2]}})})).apply(this,arguments)}return{uploadFiles:function(e){return o.apply(this,arguments)},loading:t}}function d$(){var e=(0,ex._)(["\n  fragment ObjectStorageBucket on Bucket {\n    id\n    externalId\n    name\n  }\n"]);return d$=function(){return e},e}function dQ(){var e=(0,ex._)(["\n  query ObjectStorageReplBucketStatus($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        defaultBucket {\n          ... on Bucket {\n            ...ObjectStorageBucket\n          }\n          ... on Error {\n            message\n          }\n          ... on NotFoundError {\n            message\n          }\n          ... on UnauthorizedError {\n            message\n          }\n          ... on UserError {\n            message\n          }\n        }\n      }\n    }\n  }\n  ","\n"]);return dQ=function(){return e},e}var d0={},d1=(0,eC.Ps)(d$()),d2=(0,eC.Ps)(dQ(),d1),d8=n(53326),d4=n(37109),d3=n(81949),d5=n(26018),d6=[{icon:(0,f.tZ)(d3.Z,{}),title:"Javascript",value:"js"},{icon:(0,f.tZ)(d5.Z,{}),title:"Python",value:"py"}],d9={js:{commands:[{label:"Import Object Store Library",code:"import objstore from '@replit/objstore'"},{label:"Get an object",code:"objstore.get('image.png')"},{label:"List the objects in the bucket",code:"objstore.list()"},{label:"Add an object to the bucket",code:"objstore.set(buf, 'image.png')"},{label:"Delete an object from the bucket",code:"objstore.delete('image.png')"}]},py:{commands:[{label:"Import Object Store Library",code:"from replit.storage import Client"},{label:"Get an object",code:"Client().download_as_text('image.png')"},{label:"List the objects in the bucket",code:"Client().list_objects()"},{label:"Add an object to the bucket",code:"Client().upload_from_text('image.png', data)"},{label:"Delete an object from the bucket",code:"Client().delete('image.png')"}]}},d7=(0,b.X)({wrapper:[x.l0.colWithGap(16)],section:[x.l0.colWithGap(6)],selectWrapper:[x.l0.rowWithGap(0)]});function fe(){var e=(0,u._)((0,_.useState)("js"),2),t=e[0],n=e[1];return(0,f.BX)(y.G,{css:d7.wrapper,children:[(0,f.tZ)(y.G,{css:d7.selectWrapper,children:(0,f.tZ)(d4.P,{items:d6,initialSelectedItem:d6[0],onChange:function(e){n(e.value)}})}),d9[t].commands.map(function(e){return(0,f.BX)(y.G,{css:d7.section,children:[(0,f.tZ)(g.xv,{children:e.label}),(0,f.tZ)(nC.ZP,{components:{code:function(e){return(0,f.tZ)(d8.Z,(0,U._)({language:t},e))}},children:"".concat("    ").concat(e.code)})]},e.label)}),(0,f.tZ)(g.xv,{color:"dimmest",children:"Object Storage dependencies were automatically installed in this Repl when you created or associated a bucket."})]})}function ft(){var e=(0,ex._)(["\n  mutation ObjectStoragePaneIntroCreateBucket($input: CreateBucketInput!) {\n    createBucket(input: $input) {\n      ... on Bucket {\n        ...ObjectStorageBucket\n      }\n      ... on Error {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n  ","\n"]);return ft=function(){return e},e}var fn={},fr=(0,eC.Ps)(ft(),d1),fi=[{imageUrl:"/public/images/object-storage/objects-in-bucket.svg",text:"Store immutable files, like photos and documents, in writable buckets (databases for unstructured files).",altText:"An image and a file going into a bucket"},{imageUrl:"/public/images/object-storage/upload-to-cloud.svg",text:"Deploy apps that handle variable sets of files added by your users, like an upload-based photo gallery.",altText:"Images being uploaded to a cloud"},{imageUrl:"/public/images/object-storage/share-same-bucket.svg",text:"Buckets are automatically shared between development and production, so you can easily pass files to your users directly from the Workspace.",altText:"Development icon and deployment icon sharing a bucket"}];function fo(e){var t,n=e.onBucketCreated,r=e.onError,i=(0,eZ.Z)(),o=(0,u._)((t=(0,U._)({},fn,{variables:{input:{replId:i}}}),aP.D(fr,t)),2),a=o[0],l=o[1].loading;return(0,f.tZ)(y.G,{css:fa.wrapper,children:(0,f.BX)(y.G,{css:fa.content,children:[(0,f.tZ)(g.xv,{variant:"subheadBig",children:"Persistent shared file storage"}),fi.map(function(e,t){return(0,f.BX)(y.G,{css:fa.row,children:[(0,f.tZ)(y.G,{children:(0,f.tZ)(oL.Z,{src:e.imageUrl,width:44,height:44,alt:e.altText})}),(0,f.tZ)(g.xv,{css:fa.rowText,children:e.text})]},t)}),(0,f.tZ)(W.zx,{text:l?"Creating bucket...":"Create a bucket",onClick:function(){a({onCompleted:function(e){var t="Bucket"===e.createBucket.__typename?e.createBucket:null;if(!t){r(Error("Failed to create bucket"));return}n(t)},onError:r})},colorway:"primary",iconLeft:l?(0,f.tZ)(Z.Z,{}):void 0,disabled:l})]})})}var fa=(0,b.X)({wrapper:[x.l0.center,x.l0.pt(64),x.l0.px(8)],content:[x.l0.colWithGap(24),x.l0.center,x.l0.maxWidth(400),x.l0.textAlign.center],row:[x.l0.rowWithGap(16)],rowText:[x.l0.flex.growAndShrink(1),x.l0.textAlign.left]}),fl=n(79621),fc=n(53430),fs=n(22487),fu=n(91608),fd=n(91754),ff=n(93646),fh=n(75545),fp=n(50451),fm=n(37199),fv=n(53833),fg=n(66061),fy=n(60471),fb=n(84900),fw=n(32148),fZ=n(6191),fx=function(e){var t=e.folderPath,n=e.onDropNativeFiles,r=(0,u._)((0,fw.L)(function(){return{accept:[dP.FILE,fZ.FILE],drop:function(e){return"files"in e&&n(e.files),{name:t}},collect:function(e){return{isOver:!!e.isOver()}}}}),2);return{isDraggedOver:r[0].isOver,drop:r[1]}},fC=function(e){var t=e.currentFolder,n=e.onDropNativeFiles,r=(0,u._)((0,fw.L)(function(){return{accept:[fZ.FILE],drop:function(e,t){t.didDrop()||e.dirContent.then(function(e){n(e)})},collect:function(e){return{isOverCurrent:e.isOver({shallow:!0})}}}},[t]),2);return{isOverCurrent:r[0].isOverCurrent,drop:r[1]}},fS=n(39783),fk="1px dashed ".concat(x.TV.accentPrimaryDefault);function f_(e){var t=e.bucketExternalId,n=e.onOpenCommandsTab,r=e.onError,i=dY({bucketExternalId:t}),o=(0,u._)((0,_.useState)(""),2),a=o[0],l=o[1],c=dK().uploadFiles,s=(0,_.useRef)(null),d=(0,_.useRef)(null);function h(){s.current&&s.current.click()}function p(){d.current&&d.current.click()}return(0,f.tZ)(fc.Z,{children:(0,f.BX)(y.G,{css:fE.wrapper,children:[i.length?(0,f.tZ)(fD,{objects:i,bucketExternalId:t,currentFolder:a,setCurrentFolder:l,onRequestFileUploadDialog:h,onRequestDirUploadDialog:p,onError:r}):(0,f.tZ)(f$,{onRequestFileUploadDialog:h,onRequestFolderUploadDialog:p,onOpenCommandsTab:n}),(0,f.tZ)(fS.Q,{fileUploadInputRef:s,dirUploadInputRef:d,uploadFiles:function(e){return c({bucketExternalId:t,files:e.files,targetFolder:a,onError:r})}})]})})}var fE=(0,b.X)({wrapper:[x.l0.flex.grow(1)]}),fT=(0,fu.$)(["bodyOutline"]),fR=fT.cssVars,fI=fT.styleTokens;function fD(e){var t=e.objects,n=e.bucketExternalId,r=e.currentFolder,i=e.setCurrentFolder,o=e.onRequestFileUploadDialog,a=e.onRequestDirUploadDialog,l=e.onError,c=function(e){var t=e.objects,n=e.currentFolder,r=[],i={},o=!0,a=!1,l=void 0;try{for(var c,s=t[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;if(u.name.startsWith(n)&&u.name!==n){var f=u.name.slice(n.length);if(!f.includes("/")){r.push((0,O._)((0,U._)({},u),{isFolder:!1,displayName:f}));continue}var h=f.split("/")[0];i.folderName||(i[h]={isFolder:!0,name:n+h+"/",optimisticallyInserted:u.name.endsWith("/")&&u.optimisticallyInserted,displayName:h})}}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}var p=dq(Object.values(i)),m=dq(r);return(0,d._)(p).concat((0,d._)(m))}({currentFolder:r,objects:t}),s=(0,u._)((0,_.useState)(null),2),h=s[0],p=s[1],m=(0,u._)((0,_.useState)(!1),2),v=m[0],g=m[1],b=dJ(),w=b.fetchObjects,x=b.loading,C=function(){var e=(0,u._)((0,_.useState)(!1),2),t=e[0],n=e[1],r=(0,t2.b9)(dV),i=dJ().fetchObjects;function o(){return(o=(0,ts._)(function(e){var t,o,a,l,c,s,u,d;return(0,tu.Jh)(this,function(f){switch(f.label){case 0:if(t=e.bucketExternalId,o=e.folderName,a=e.currentFolder,l=e.onError,o.includes("/"))return null==l||l(Error("Folder name cannot contain a forward slash")),[2];n(!0),r({bucketExternalId:t,name:c=a+o+"/",contentType:"text/plain",size:"0"}),s=new FormData,u=new Blob([""],{type:"text/plain"}),s.append("file",u),f.label=1;case 1:return f.trys.push([1,4,,5]),[4,dU({bucketExternalId:t,objectName:c,formData:s})];case 2:return f.sent(),[4,i({bucketExternalId:t})];case 3:return f.sent(),[3,5];case 4:return d=f.sent(),null==l||l(d),[3,5];case 5:return n(!1),[2]}})})).apply(this,arguments)}return{createFolder:function(e){return o.apply(this,arguments)},loading:t}}().createFolder,S=dK().uploadFiles,k=fC({currentFolder:r,onDropNativeFiles:function(e){S({bucketExternalId:n,files:e,targetFolder:r,onError:l})}}),E=k.isOverCurrent,T=k.drop;return(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,{css:fG.buttonRow,children:[(0,f.BX)(y.G,{css:fG.insertButtonGroup,children:[(0,f.tZ)(W.zx,{onClick:o,text:"Upload files",colorway:"primary",iconLeft:(0,f.tZ)(fh.Z,{})}),(0,f.tZ)(W.zx,{onClick:a,text:"Upload folder",colorway:"primary",iconLeft:(0,f.tZ)(fv.Z,{})}),(0,f.tZ)(W.zx,{onClick:function(){return g(!0)},text:"Create folder",iconLeft:(0,f.tZ)(fm.Z,{})})]}),(0,f.tZ)(W.zx,{onClick:function(){return w({bucketExternalId:n})},text:"Refresh",iconLeft:x?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(n1.Z,{})})]}),(0,f.tZ)(fF,{currentFolder:r,bucketExternalId:n,setCurrentFolder:i,onError:l}),(0,f.tZ)(y.G,{innerRef:T,css:fG.tableWrapper,style:(0,eP._)({},fR.bodyOutline,E?fk:void 0),children:(0,f.BX)("table",{children:[(0,f.tZ)("thead",{children:(0,f.BX)("tr",{children:[(0,f.tZ)("th",{css:fG.tableHeaderMainColumn,children:"Name"}),(0,f.tZ)("th",{css:fG.tableHeader,children:"Added"}),(0,f.tZ)("th",{css:fG.tableHeader,children:"Size"})]})}),(0,f.BX)("tbody",{children:[v?(0,f.tZ)(fq,{onCreateFolder:function(e){g(!1),C({bucketExternalId:n,folderName:e,currentFolder:r,onError:l})},onCanceled:function(){return g(!1)}}):null,c.map(function(e){return e.isFolder?(0,f.tZ)(fN,{item:e,setCurrentFolder:i,onDeleteClick:p,bucketExternalId:n,onError:l},e.name):(0,f.tZ)(fL,{item:e,bucketExternalId:n,onDeleteClick:p,onError:l},e.name)})]})]})}),(0,f.tZ)(fK,{bucketExternalId:n,requestedDeleteItem:h,onRequestClose:function(){return p(null)},onError:l})]})}var fG=(0,b.X)({buttonRow:[x.l0.rowWithGap(12),x.l0.justify.spaceBetween],tableWrapper:[x.l0.flex.growAndShrink(1),x.l0.borderRadius(4),{outline:fI.bodyOutline}],tableHeaderMainColumn:[x.l0.textAlign.left,x.l0.p(4),x.l0.width("50%")],tableHeader:[x.l0.textAlign.left,x.l0.p(4),x.l0.width("25%")],insertButtonGroup:[x.l0.rowWithGap(8)]}),fB=(0,fu.$)(["rowOutline","rowOpacity","rowTextDecoration","rowCursor"]),fP=fB.cssVars,fA=fB.styleTokens;function fN(e){var t,n=e.item,r=e.bucketExternalId,i=e.setCurrentFolder,o=e.onDeleteClick,a=e.onError,l=dK().uploadFiles,c=(0,ao.Z)().showConfirm,s=fx({folderPath:n.name,onDropNativeFiles:function(e){c('Uploading files to "'.concat(n.name,'"')),l({bucketExternalId:r,files:e,targetFolder:n.name,onError:a})}}),u=s.isDraggedOver,d=s.drop;return(0,f.tZ)(fU,{item:n,ref:d,onDeleteClick:function(){return o(n)},icon:(0,f.tZ)(fp.Z,{}),timeCreatedCell:"-",sizeCell:"-",style:(t={},(0,eP._)(t,fP.rowOutline,u?fk:void 0),(0,eP._)(t,fP.rowCursor,"pointer"),t),onClick:function(){return i(n.name)}})}function fL(e){var t,n,r,i,o,a=e.item,l=e.bucketExternalId,c=e.onDeleteClick,s=e.onError,d="/object-storage/storage/v1/b/".concat(l,"/o/").concat(a.name.replace("/","%2F"),"?alt=media"),h=!!(a.optimisticallyInserted||a.isPendingDeletion),p=function(){var e=(0,u._)((0,_.useState)(!1),2),t=e[0],n=e[1],r=(0,t2.b9)(dz),i=(0,t2.b9)(dV),o=dJ().fetchObjects;function a(){return(a=(0,ts._)(function(e){var t,a,l,c,s,u,d;return(0,tu.Jh)(this,function(f){switch(f.label){case 0:t=e.bucketExternalId,a=e.object,l=e.destinationFolder,c=e.onError,s=e.onSuccess,n(!0),u=l+a.name.split("/").pop(),r({bucketExternalId:t,name:a.name}),i({bucketExternalId:t,name:u,contentType:a.contentType,size:a.size}),f.label=1;case 1:return f.trys.push([1,5,,6]),[4,function(e){return dF.apply(this,arguments)}({destinationBucketExternalId:t,sourceBucketExternalId:t,sourceObjectName:a.name,destinationObjectName:u})];case 2:return f.sent(),[4,dM({bucketExternalId:t,objectName:a.name})];case 3:return f.sent(),[4,o({bucketExternalId:t})];case 4:return f.sent(),null==s||s(),[3,6];case 5:return d=f.sent(),null==c||c(d),[3,6];case 6:return n(!1),[2]}})})).apply(this,arguments)}return{loading:t,moveObject:function(e){return a.apply(this,arguments)}}}().moveObject,v=(0,ao.Z)().showConfirm,g=(n=(t={item:a,disableDrag:h,onDropOverFolder:function(e){return p({bucketExternalId:l,object:a,destinationFolder:e,onSuccess:function(){v('Moved "'.concat(a.name,'" to "').concat(e,'"'))},onError:s})}}).item,r=t.disableDrag,i=t.onDropOverFolder,{isDragging:(o=(0,u._)((0,fb.c)(function(){return{type:dP.FILE,canDrag:!r,item:function(){return{name:n.name,type:dP.FILE}},collect:function(e){return{isDragging:!!e.isDragging()}},end:function(e,t){var n=t.getDropResult();n&&n&&i(n.name)}}},[r]),2))[0].isDragging,drag:o[1]}),y=g.isDragging,b=g.drag;return(0,f.tZ)(fU,{item:a,ref:b,onDeleteClick:function(){return c(a)},icon:(0,f.tZ)(fJ,{contentType:a.contentType}),timeCreatedCell:(0,f.tZ)(no.EK,{date:a.timeCreated}),sizeCell:sB(Number(a.size),{isKib:!0,isKibNotation:!0}),style:(0,eP._)({},fP.rowOpacity,y?.5:void 0),additionalActionButtons:(0,f.tZ)(f.HY,{children:(0,f.tZ)(m.hU,{alt:"Download",css:fM.rowActionButton,children:(0,f.tZ)("a",{download:!0,href:d,css:x.l0.color.foregroundDefault,children:(0,f.tZ)(w.Z,{})})})})})}var fU=_.forwardRef(function(e,t){var n=e.item,r=e.onDeleteClick,i=e.icon,o=e.timeCreatedCell,a=e.sizeCell,l=e.style,c=e.onClick,s=e.additionalActionButtons,u=n.isPendingDeletion?fM.strikeThroughText:fM.text,d=n.optimisticallyInserted||n.isPendingDeletion;return(0,f.BX)("tr",{ref:t,tabIndex:0,css:d?fM.pendingRow:fM.row,style:l,onClick:c,children:[(0,f.tZ)("td",{css:fM.tableData,children:(0,f.BX)(y.G,{css:fM.objectIconAndName,children:[i,(0,f.tZ)(g.xv,{multiline:!0,maxLines:1,css:u,children:n.displayName})]})}),(0,f.tZ)("td",{css:fM.tableData,children:(0,f.tZ)(g.xv,{multiline:!0,maxLines:1,css:u,children:o})}),(0,f.tZ)("td",{css:fM.tableData,children:(0,f.tZ)(g.xv,{multiline:!0,maxLines:1,css:u,children:a})}),d?null:(0,f.tZ)("td",{children:(0,f.BX)(y.G,{css:fM.rowActionButtonGroup,id:"action-buttons",children:[s,(0,f.tZ)(m.hU,{onClick:r,alt:"Delete",css:fM.rowActionButton,children:(0,f.tZ)(c9.Z,{color:x.TV.accentNegativeDefault})})]})})]})}),fO=(0,b.X)({row:[x.l0.position.relative,x.l0.borderRadius(4),{outline:fA.rowOutline,outlineOffset:-1,opacity:fA.rowOpacity,cursor:fA.rowCursor,":nth-of-type(even)":{background:"color-mix(in srgb, ".concat(x.TV.backgroundDefault," 60%, ").concat(x.TV.backgroundRoot,")")},":hover":{background:x.TV.backgroundHigher},":hover #action-buttons":{display:"flex"}}],text:[x.l0.flex.shrink(1)]}),fM=(0,b.X)({row:[fO.row],pendingRow:[fO.row,ev.p.foregroundPulse()],tableData:[x.l0.p(4),{":first-of-type":{borderTopLeftRadius:4,borderBottomLeftRadius:4},":last-of-type":{borderTopRightRadius:4,borderBottomRightRadius:4}}],objectIconAndName:[x.l0.rowWithGap(8),x.l0.align.center],text:fO.text,strikeThroughText:[fO.text,{textDecoration:"line-through"}],rowActionButtonGroup:[x.l0.px(4),x.l0.position.absolute,x.l0.right(0),x.l0.top(0),x.l0.bottom(0),x.l0.rowWithGap(4),x.l0.align.center,x.l0.backgroundColor.backgroundHigher,{display:"none",borderTopRightRadius:4,borderBottomRightRadius:4}],rowActionButton:[nn.gU.filled]}),fX=function(e){var t=e.split("/").filter(function(e){return""!==e}),n=t.map(function(e,n){return{folderName:e,path:t.slice(0,n+1).join("/")+"/"}});return[{folderName:"Blobs",path:""}].concat((0,d._)(n))};function fF(e){var t=e.currentFolder,n=e.bucketExternalId,r=e.setCurrentFolder,i=e.onError,o=fX(t);return(0,f.tZ)(y.G,{css:fj.wrapper,children:o.map(function(e,t){var a=e.folderName,l=e.path,c=t===o.length-1;return(0,f.BX)(_.Fragment,{children:[(0,f.tZ)(fz,{folderPath:l,folderName:a,bucketExternalId:n,onClick:function(){return r(l)},isLastBreadcrumb:c,onError:i}),c?null:(0,f.tZ)(g.xv,{color:"dimmest",children:"/"})]},l)})})}var fW=(0,fu.$)(["breadcrumbOutline","breadcrumbTextColor"]),fH=fW.cssVars,fV=fW.styleTokens;function fz(e){var t,n=e.folderPath,r=e.folderName,i=e.bucketExternalId,o=e.onClick,a=e.isLastBreadcrumb,l=e.onError,c=dK().uploadFiles,s=fx({folderPath:n,onDropNativeFiles:function(e){return c({bucketExternalId:i,files:e,targetFolder:n,onError:l})}}),u=s.isDraggedOver,d=s.drop;return(0,f.tZ)(W.zx,{ref:d,text:r,variant:"nofill",onClick:o,iconLeft:(0,f.tZ)(fp.Z,{}),size:"small",disabled:a,style:(t={},(0,eP._)(t,fH.breadcrumbTextColor,a?x.TV.foregroundDefault:void 0),(0,eP._)(t,fH.breadcrumbOutline,u?fk:void 0),t),css:fj.breadcrumb})}var fj=(0,b.X)({wrapper:[x.l0.rowWithGap(2),x.l0.align.center,x.l0.pt(12),x.l0.pb(4)],breadcrumb:[{color:fV.breadcrumbTextColor,outline:fV.breadcrumbOutline}]});function fq(e){var t=e.onCreateFolder,n=e.onCanceled,r=(0,u._)((0,_.useState)(""),2),i=r[0],o=r[1],a=(0,fs.Z)(n,[]);return(0,f.tZ)("tr",{children:(0,f.tZ)("td",{colSpan:3,children:(0,f.BX)(y.G,{innerRef:a,css:fY.row,children:[(0,f.tZ)(y.G,{css:fY.icon,children:(0,f.tZ)(fp.Z,{})}),(0,f.tZ)(X.II,{value:i,autoFocus:!0,onChange:function(e){return o(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&(t(i),o("")),"Escape"===e.key&&n()},autoCapitalize:"off",autoComplete:"off",autoCorrect:"off"})]})})})}var fY=(0,b.X)({row:[x.l0.rowWithGap(8),x.l0.align.center],icon:[x.l0.height(24),x.l0.width(24),x.l0.center]});function fJ(e){var t=e.contentType;return t?t.startsWith("image/")?(0,f.tZ)(fg.Z,{}):t.startsWith("video/")?(0,f.tZ)(fd.Z,{}):t.startsWith("audio/")?(0,f.tZ)(fy.Z,{}):(0,f.tZ)(ff.Z,{}):(0,f.tZ)(ff.Z,{})}function fK(e){var t=e.bucketExternalId,n=e.requestedDeleteItem,r=e.onRequestClose,i=e.onError,o=function(){var e=(0,u._)((0,_.useState)(!1),2),t=e[0],n=e[1],r=(0,t2.b9)(dz),i=dJ().fetchObjects;function o(){return(o=(0,ts._)(function(e){var t,o,a,l;return(0,tu.Jh)(this,function(c){switch(c.label){case 0:t=e.bucketExternalId,o=e.objectName,a=e.onError,n(!0),r({bucketExternalId:t,name:o}),c.label=1;case 1:return c.trys.push([1,4,,5]),[4,dM({bucketExternalId:t,objectName:o})];case 2:return c.sent(),[4,i({bucketExternalId:t})];case 3:return c.sent(),[3,5];case 4:return l=c.sent(),null==a||a(l),[3,5];case 5:return n(!1),[2]}})})).apply(this,arguments)}return{loading:t,deleteObject:function(e){return o.apply(this,arguments)}}}().deleteObject,a=(0,ao.Z)().showError;return(0,f.tZ)(rE.u,{isOpen:!!n,onRequestClose:r,children:n?(0,f.tZ)(fl.Z,{name:n.displayName,description:n.name,entityType:n.isFolder?"folder":"file",hideModal:r,delete:function(){if(null==n?void 0:n.isFolder){a("Deleting folders is not supported yet."),r();return}n&&(o({bucketExternalId:t,objectName:n.name,onError:i}),r())}}):null})}function f$(e){var t=e.onRequestFileUploadDialog,n=e.onRequestFolderUploadDialog,r=e.onOpenCommandsTab;return(0,f.BX)(y.G,{css:fQ.wrapper,children:[(0,f.BX)(y.G,{css:fQ.textWrapper,children:[(0,f.tZ)(g.xv,{variant:"subheadBig",children:"No objects"}),(0,f.BX)(y.G,{css:fQ.text,children:[(0,f.tZ)(g.xv,{children:"Drag and drop or click to upload,"}),(0,f.BX)(y.G,{css:fQ.textRow,children:[(0,f.tZ)(g.xv,{children:"or"}),(0,f.tZ)(W.zx,{variant:"underlinedOnHover",colorway:"primary",onClick:r,text:"upload using commands",css:fQ.textButton})]})]})]}),(0,f.tZ)(W.zx,{onClick:t,text:"Upload files",colorway:"primary",iconLeft:(0,f.tZ)(fh.Z,{})}),(0,f.tZ)(W.zx,{onClick:n,text:"Upload folder",colorway:"primary",iconLeft:(0,f.tZ)(fv.Z,{})})]})}var fQ=(0,b.X)({wrapper:[x.l0.center,x.l0.colWithGap(16),x.l0.flex.grow(1),x.l0.justify.center,x.l0.border({color:x.TV.outlineDefault,style:"dashed",width:1}),x.l0.borderRadius(8)],textWrapper:[x.l0.center,x.l0.colWithGap(4)],text:[x.l0.center],textRow:[x.l0.rowWithGap(4),x.l0.align.center],textButton:[x.l0.color.accentPrimaryStronger]});function f0(){var e=(0,ex._)(["\n  mutation ObjectStorageSettingsDeleteBucket($input: DeleteBucketInput!) {\n    deleteBucket(input: $input) {\n      ... on Bucket {\n        id\n      }\n      ... on Error {\n        message\n      }\n      ... on NotFoundError {\n        message\n      }\n      ... on UnauthorizedError {\n        message\n      }\n      ... on UserError {\n        message\n      }\n    }\n  }\n"]);return f0=function(){return e},e}var f1={},f2=(0,eC.Ps)(f0()),f8=(0,b.X)({wrapper:[x.l0.colWithGap(16)],section:[x.l0.colWithGap(6)]});function f4(e){var t,n=e.bucketId,r=e.onSettingsUpdate,i=e.onError,o=(0,u._)((0,_.useState)(!1),2),a=o[0],l=o[1],c=function(){return l(!1)},s=(0,u._)((t=(0,U._)({},f1,void 0),aP.D(f2,t)),2),d=s[0],h=s[1].loading,p=(0,ao.Z)().showConfirm;return(0,f.BX)(f.HY,{children:[(0,f.tZ)(y.G,{css:f8.wrapper,children:(0,f.BX)(y.G,{css:f8.section,children:[(0,f.tZ)(W.zx,{text:h?"Deleting":"Delete bucket",loading:h,iconLeft:(0,f.tZ)(c9.Z,{color:x.TV.accentNegativeStronger}),css:x.l0.color.accentNegativeStronger,onClick:function(){return l(!0)}}),(0,f.tZ)(g.xv,{color:"dimmest",children:"You cannot undo this action"})]})}),(0,f.tZ)(rE.u,{isOpen:a,onRequestClose:c,children:(0,f.tZ)(fl.Z,{name:"bucket",description:"this bucket and all its contents",entityType:"bucket",hideModal:c,delete:function(){return d({variables:{input:{bucketId:n}},onError:i,onCompleted:function(e){"Bucket"===e.deleteBucket.__typename?(r({type:"deleteBucket",data:{bucketId:n}}),p("Bucket deleted")):i(Error("Failed to delete bucket: "+e.deleteBucket.message))}})}})})]})}var f3=n(37229),f5=[{icon:(0,f.tZ)(dI.Z,{}),title:"Objects",value:"objects"},{icon:(0,f.tZ)(oJ.Z,{}),title:"Commands",value:"commands"},{icon:(0,f.tZ)(n0.Z,{}),title:"Settings",value:"settings"}];function f6(){var e,t,n,r,i=(0,u._)((0,_.useState)(),2),o=i[0],a=i[1],l=(0,u._)((0,_.useState)(0),2),c=l[0],s=l[1],d=dY({bucketExternalId:null!==(r=null==o?void 0:o.externalId)&&void 0!==r?r:""}),h=dJ(),p=h.fetchObjects,m=h.loading,v=(0,C.Z)().dotReplit,g=(0,ao.Z)().showError,b=function(e){var t;g(e.message),tf.$e(function(n){n.setTag("object-storage-pane",!0),t&&n.setExtras(t),tf.Tb(e)})},w=(e={variables:{replId:(0,eZ.Z)()},fetchPolicy:"network-only",ssr:!1,onCompleted:function(e){if("Repl"!==e.repl.__typename){g("Failed to fetch bucket data");return}if(e.repl.defaultBucket){if("Bucket"!==e.repl.defaultBucket.__typename){b(Error(e.repl.defaultBucket.message));return}var t=e.repl.defaultBucket;a(t),p({bucketExternalId:t.externalId,onError:b})}}},t=(0,U._)({},d0,e),eS.a(d2,t)),x=w.loading,S=w.error;return S?(0,f.tZ)(y.G,{css:f9.errorWrapper,children:(0,f.tZ)(rT.E,{text:'Error: "'.concat(S.message,'". The issue has been logged and the Replit team will look into it.'),colorway:"negative"})}):x||m&&!d.length?(0,f.tZ)(y.G,{css:f9.loadingWrapper,children:(0,f.tZ)(Z.Z,{})}):o?(0,f.BX)(dD.mQ,{css:f9.wrapper,selectedIndex:c,onSelectionChange:function(e){return s(e)},children:[(0,f.tZ)(dD.td,{withDividers:!1,css:f9.tabList,children:f5.map(function(e){return(0,f.tZ)(dD.OK,{iconLeft:e.icon,children:e.title},e.value)})}),(0,f.BX)(dD.nP,{css:f9.tabPanels,children:[(0,f.tZ)(dD.x4,{css:f9.objectTabPanel,children:(0,f.tZ)(f_,{bucketExternalId:o.externalId,onOpenCommandsTab:function(){s(f5.findIndex(function(e){return"commands"===e.value}))},onError:b})}),(0,f.tZ)(dD.x4,{children:(0,f.tZ)(fe,{})}),(0,f.tZ)(dD.x4,{children:(0,f.tZ)(f4,{bucketId:o.id,onSettingsUpdate:function(e){"deleteBucket"===e.type&&a(void 0)},onError:b})})]})]}):(0,f.tZ)(fo,{onBucketCreated:(n=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){switch(t.label){case 0:return a(e),[4,v.updateDotReplit([(0,f3.pp)(e.externalId)])];case 1:return t.sent(),[2]}})}),function(e){return n.apply(this,arguments)}),onError:b})}var f9=(0,b.X)({errorWrapper:[x.l0.p(16)],loadingWrapper:[x.l0.center,x.l0.p(24)],wrapper:[x.l0.flex.column,x.l0.flex.grow(1)],tabList:[x.l0.px(12),x.l0.py(4),x.l0.flex.grow(0)],tabPanels:[x.l0.flex.column,x.l0.px(8),x.l0.py(12),x.l0.flex.grow(1)],objectTabPanel:[x.l0.flex.column,x.l0.flex.grow(1)]}),f7=h.Dy.Object({type:h.Dy.Literal("objectStorage")}),he={Content:function(){return(0,f.tZ)(f6,{})},Icon:function(e){var t=e.size;return(0,f.tZ)(dI.Z,{size:t})},getTitle:function(){return"Object Storage"},decode:function(e){return p.B4.Decode(f7,e)}},ht=n(31270),hn=n(59072);(0,t8.cn)({replId:"",packageManagers:{}}),(gD=gj||(gj={})).Initializing="Initializing",gD.Installing="Installing",gD.Uninstalling="Uninstalling",gD.Idle="Idle",(gG=gq||(gq={})).Install="Install",gG.Uninstall="Uninstall";var hr=(0,_.createContext)(null);function hi(){var e=(0,_.useContext)(hr);if(!e)throw Error("Expected store in context");return e}var ho=(0,t8.cn)(null);function ha(){return(0,t2.Dv)(ho,{store:hi()})}(0,t8.cn)(null);var hl=n(46801);function hc(e){var t=ha(),n=(0,C.Z)(),r=(0,u._)((0,_.useState)(null),2),i=r[0],o=r[1];return(0,_.useEffect)(function(){if((null==t?void 0:t.id)&&e.name){var r,i=(0,hl.C)(t.id),a=!1;return(r=(0,ts._)(function(){var r;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:return[4,i.getPackageInfo({id:t.id,name:e.name,services:n})];case 1:if(r=l.sent(),a)return[2];return o(null!=r?r:null),[2]}})}),function(){return r.apply(this,arguments)})(),function(){a=!0}}},[null==t?void 0:t.id,e.name]),i}var hs=n(47030),hu=n(41331),hd=n.n(hu),hf=/(.+)(?:\S+)?<([^>,]+)[>,]/,hh=y.K.span;function hp(e){var t=e.author,n=hf.exec(t);if(n){var r=n[1],i=n[2];return(0,f.BX)(f.HY,{children:["By ",r,(0,f.BX)("a",{href:"mailto:".concat(i),children:["<",i,">"]})]})}return(0,f.BX)(hh,{children:["By ",t]})}var hm=n(81764);function hv(e){var t=e.isInstalled,n=e.isInQueue;return e.isCurrentAction?(0,f.tZ)(Z.Z,{}):n?(0,f.tZ)(hm.Z,{}):t?(0,f.tZ)(c9.Z,{}):(0,f.tZ)(w.Z,{})}var hg=y.K.span,hy=(0,b.X)({metadata:[x.l0.colWithGap(2)],metadataSkeleton:[x.l0.colWithGap(8),x.l0.pt(4)],metadataSkeletonVersion:[ev.p.foregroundPulse(),x.l0.height(16),x.l0.maxWidth(64),x.l0.borderRadius(4)],metadataSkeletonDescription:[ev.p.foregroundPulse(),x.l0.height(16),x.l0.borderRadius(4),x.l0.maxWidth(425)],root:[x.l0.borderRadius(8),x.l0.p(8)],header:[x.l0.flex.row,x.l0.justify.spaceBetween],headerTitle:[x.l0.display.flex,x.l0.rowWithGap(8),x.l0.flex.growAndShrink(1)],headerTitleText:[x.l0.display.inline,x.l0.flex.growAndShrink(1),x.l0.overflow("hidden"),x.l0.truncate],headerTitlePills:[x.l0.display.inlineFlex,x.l0.rowWithGap(4),x.l0.flex.shrink(0)],headerButton:[],content:[x.l0.colWithGap(4)],error:[x.l0.mt(4)],actions:[x.l0.rowWithGap(8),x.l0.mt(8)],consoleButton:[x.l0.width("calc(50% - ".concat(x.TV.space8,")"))],cancelButton:[x.l0.width("calc(50% - ".concat(x.TV.space8,")"))],actionButton:[x.l0.flex.grow(1),x.l0.flex.shrink(0)]});function hb(e){var t=e.title,n=e.content,r=e.isExpanded;return(0,f.BX)(y.G,{css:hy.metadata,children:[t?(0,f.tZ)(g.xv,{color:"dimmer",children:t}):null,n?(0,f.tZ)(g.xv,{maxLines:r?void 0:1,children:n}):null]})}function hw(e){var t=e.title,n=e.content;return(0,f.BX)(y.G,{css:hy.metadataSkeleton,children:[void 0===t||t?(0,f.tZ)(y.G,{css:hy.metadataSkeletonVersion}):null,void 0===n||n?(0,f.tZ)(y.G,{css:hy.metadataSkeletonDescription}):null]})}function hZ(e){var t,n=e.name,r=e.pkg,i=e.isMetadataLoading,o=e.openConsole,a=e.pills,l=ha(),c=(0,hn.te)(null==l?void 0:l.id),s=(0,hn.pN)(null==l?void 0:l.id),d=(0,hn.B2)(),h=(0,hn.cW)(),p=(0,hn.wY)(),v=(0,_.useMemo)(function(){return r.license?hd()(r.license,{upgrade:!1})||(r.license.length<40?r.license:"Unknown License"):"Unknown License"},[r.license]),b=(0,_.useMemo)(function(){return!!(null!==d&&d.pkgs.find(function(e){return e.name===r.name}))},[d]),w=(0,_.useMemo)(function(){return h.find(function(e){return e.pkgs.find(function(e){return e.name===r.name})})},[h]),Z=!!w,x=(0,_.useMemo)(function(){return!!c.find(function(e){return e.name===r.name})},[c]),C=!!(r.homepageURL||r.license||r.author),S=(0,_.useMemo)(function(){return!!s.find(function(e){return e.name===r.name})},[s]),k=(0,u._)((0,_.useState)(!1),2),E=k[0],T=k[1],R=(0,hn.jh)(),I=(0,hn.Wx)(),D=(0,hn.zi)();return(0,f.BX)(H.Tg,{css:hy.root,elevated:!0,children:[(0,f.BX)(y.G,{css:hy.header,children:[(0,f.BX)(g.h4,{css:hy.headerTitle,level:2,variant:"subheadDefault",multiline:!1,children:[(0,f.BX)(hg,{css:hy.headerTitleText,children:[null!=n?n:r.name,r.version?(0,f.BX)(g.xv,{color:"dimmer",children:["@",r.version]}):null]}),a?(0,f.tZ)(y.G,{css:hy.headerTitlePills,children:a}):null]}),C?(0,f.tZ)(m.hU,{css:hy.headerButton,alt:"Show more info",tooltipHidden:!0,onClick:function(){return T(function(e){return!e})},children:(0,f.tZ)(lP.Z,{rotate:E?90:0})}):null]}),(0,f.tZ)(y.G,{css:hy.content,children:void 0!==i&&i?(0,f.tZ)(hw,{title:!1}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(hb,{content:null!==(t=r.description)&&void 0!==t?t:"This package has no description.",isExpanded:E}),r.homepageURL&&E?(0,f.tZ)(hb,{content:(0,f.tZ)("a",{href:r.homepageURL,rel:"noreferrer noopener",target:"_blank",children:r.homepageURL}),isExpanded:E}):null,v&&E?(0,f.tZ)(hb,{content:v,isExpanded:E}):null,r.author&&E?(0,f.tZ)(hb,{content:(0,f.tZ)(hp,{author:r.author}),isExpanded:E}):null]})}),S?(0,f.tZ)(rT.E,{css:hy.error,colorway:"negative",icon:(0,f.tZ)(rn.Z,{}),text:"Couldn't ".concat(x?"uninstall":"install"," package. See Console for details, or try again.")}):null,(0,f.tZ)(y.G,{css:hy.actions,children:S?(0,f.BX)(f.HY,{children:[(0,f.tZ)(W.zx,{css:hy.consoleButton,text:"Console",onClick:function(){o()},disabled:b||Z,colorway:"primary",iconLeft:(0,f.tZ)(hs.Z,{})}),(0,f.tZ)(W.zx,{css:hy.actionButton,text:"Try Again",onClick:function(){(null==l?void 0:l.id)&&(p(l.id,[r]),x?I({id:l.id,pkg:r}):R({id:l.id,pkg:r}))},loading:b||Z,colorway:x?"red":void 0,variant:x?"outlined":void 0,iconLeft:(0,f.tZ)(hv,{isInstalled:x,isInQueue:Z,isCurrentAction:b})})]}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(W.zx,{css:hy.actionButton,text:b?(null==d?void 0:d.kind)===hn.TH.Install?"Installing":"Removing":Z?(null==w?void 0:w.kind)===hn.TH.Install?"Waiting to install":"Waiting to remove":x?"Remove":"Install",onClick:function(){(null==l?void 0:l.id)&&(x?I({id:l.id,pkg:r}):R({id:l.id,pkg:r}))},loading:b||Z,colorway:x?"red":void 0,variant:x?"outlined":void 0,iconLeft:(0,f.tZ)(hv,{isInstalled:x,isInQueue:Z,isCurrentAction:b})}),Z?(0,f.tZ)(W.zx,{css:hy.cancelButton,text:"Cancel",onClick:function(){r.name&&D(r.name)},disabled:b,loading:b}):null]})})]})}function hx(e){var t,n,r=e.pkg,i=e.openConsole,o=hc(r),a=o?(0,O._)((0,U._)({},o),{version:null!==(t=r.spec)&&void 0!==t?t:o.version}):r;return(0,f.tZ)(hZ,{name:null!==(n=null==o?void 0:o.prettyName)&&void 0!==n?n:void 0,pkg:a,isMetadataLoading:null===o,openConsole:i})}function hC(e){return(0,f.tZ)("a",(0,U._)({href:"https://docs.replit.com/programming-ide/installing-packages",target:"_blank",rel:"noreferrer"},e))}var hS=(0,b.X)({root:[x.l0.colWithGap(8),{"@container (min-width: 600px)":[x.l0.colWithGap(0),x.l0.align.start,{display:"grid",gridTemplate:"auto / 1fr 1fr",gap:x.TV.space8}],"@container (min-width: 1200px)":[{display:"grid",gridTemplate:"auto / 1fr 1fr 1fr",gap:x.TV.space8}]}]});function hk(e){return(0,f.tZ)(y.G,(0,O._)((0,U._)({},e),{css:hS.root}))}function h_(e){var t=e.name,n=e.openConsole,r=hc({name:t});return(0,f.tZ)(hZ,{pkg:null!=r?r:{name:t},isMetadataLoading:null===r,openConsole:n,pills:[(0,f.tZ)(um.D,{text:"Suggested",colorway:"primary"},"suggested")]})}var hE=(0,b.X)({packages:[x.l0.pt(8)],separator:[x.l0.backgroundColor.backgroundHigher,x.l0.height(1),x.l0.borderRadius(1),x.l0.mt(6),{border:"none",marginLeft:"auto",marginRight:"auto",width:"95%"}]});function hT(e){var t=e.openConsole,n=ha(),r=(0,hn.te)(null==n?void 0:n.id),i=(0,hn.B2)(),o=(0,hn.cW)(),a=[];switch(null==n?void 0:n.language){default:return null;case"nodejs":a=["express","discord.js","axios","moment","node-fetch","chalk"];break;case"python3":a=["replit","requests","pandas","discord","matplotlib","flask"]}var l=function(e){if(r.find(function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e})||(i&&i.kind===hn.TH.Install?i.pkgs.find(function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e}):null))return!0;var t=!0,n=!1,a=void 0;try{for(var l,c=o[Symbol.iterator]();!(t=(l=c.next()).done);t=!0){var s=l.value;if(s.kind===hn.TH.Install&&s.pkgs.find(function(t){var n;return(null===(n=t.name)||void 0===n?void 0:n.toLowerCase())===e}))return!0}}catch(e){n=!0,a=e}finally{try{t||null==c.return||c.return()}finally{if(n)throw a}}return!1},c=a.filter(function(e){return!l(e)}).map(function(e){return(0,f.tZ)(h_,{name:e,openConsole:t},e)});return c.length>0?(0,f.BX)(f.HY,{children:[(0,f.tZ)("hr",{css:hE.separator}),(0,f.tZ)(hk,{css:hE.packages,children:c})]}):null}var hR=(0,b.X)({root:[x.l0.maxWidth(800),x.l0.width("100%"),{marginLeft:"auto",marginRight:"auto","@container (min-width: 1200px)":[x.l0.maxWidth(1400)]}],header:[x.l0.flex.row,x.l0.justify.spaceBetween,x.l0.py(4)],headerLeft:[x.l0.rowWithGap(4),x.l0.align.center],headerLoadingIcon:[x.l0.px(4)],headerRight:[x.l0.rowWithGap(4)],headerTitle:[{textTransform:"capitalize"}],packages:[x.l0.pt(8)],empty:[x.l0.pt(8),x.l0.colWithGap(8),x.l0.width("100%")],packagesWrapper:[x.l0.colWithGap(8),x.l0.width("100%")]});function hI(e){var t=e.openFile,n=e.openConsole,r=ha(),i=(0,hn.te)(null==r?void 0:r.id),o=(0,hn.$z)(null==r?void 0:r.id),a=(0,hn.cW)(),l=(0,hn.B2)(),c=(0,u._)((0,_.useState)(!0),2),s=c[0],h=c[1];if(null===r)return null;if(!o||o===hn.C0.Uninitialized||o===hn.C0.Initializing)return(0,f.tZ)(y.G,{css:hR.root,children:(0,f.BX)(y.G,{css:hR.header,children:[(0,f.BX)(y.G,{css:hR.headerLeft,children:[(0,f.tZ)(ta.u,{tooltip:"Loading",children:(0,f.tZ)(y.G,{css:hR.headerLoadingIcon,children:(0,f.tZ)(Z.Z,{})})}),(0,f.BX)(g.h4,{css:hR.headerTitle,variant:"subheadDefault",level:2,children:[r.language," Packages"]})]}),(0,f.tZ)(y.G,{css:hR.headerRight,children:r.packagerFiles.length>0?(0,f.tZ)(m.hU,{alt:"Open ".concat(r.packagerFiles[0]),onClick:function(){r&&t(r.packagerFiles[0])},children:(0,f.tZ)(ff.Z,{})}):null})]})});var p=l&&l.id===r.id&&l.kind===hn.TH.Install?l.pkgs:[],v=a.flatMap(function(e){return e.id===r.id&&e.kind===hn.TH.Install?e.pkgs:[]}),b=(0,d._)(p).concat((0,d._)(v),(0,d._)(i));return(0,f.BX)(y.G,{css:hR.root,children:[(0,f.BX)(y.G,{css:hR.header,children:[(0,f.BX)(y.G,{css:hR.headerLeft,children:[b.length>0?(0,f.tZ)(m.hU,{alt:"Show packages",tooltipHidden:!0,onClick:function(){return h(function(e){return!e})},children:(0,f.tZ)(lP.Z,{rotate:s?90:0})}):null,(0,f.BX)(g.h4,{css:hR.headerTitle,variant:"subheadDefault",level:2,children:[r.language," Packages"]})]}),(0,f.tZ)(y.G,{css:hR.headerRight,children:0===b.length?(0,f.tZ)(g.h4,{level:3,children:"No Packages Installed."}):(0,f.BX)(f.HY,{children:[(0,f.BX)(g.h4,{level:3,children:["Installed ",b.length," ",(0,em.Z)("package",b.length)]}),r.packagerFiles.length>0?(0,f.tZ)(m.hU,{alt:"Open ".concat(r.packagerFiles[0]),onClick:function(){r&&t(r.packagerFiles[0])},children:(0,f.tZ)(ff.Z,{})}):null]})})]}),s?(0,f.BX)(y.G,{css:0===b.length?hR.empty:hR.packagesWrapper,children:[0===b.length?(0,f.BX)(g.xv,{children:["You don't have any packages installed."," ",r.packageSearch?(0,f.BX)(f.HY,{children:["Try searching for a package to install, or"," ",(0,f.tZ)(hC,{children:"learn more about packages here"}),"","."]}):(0,f.BX)(g.xv,{children:[(0,f.tZ)(hC,{children:"Learn more about packages here"}),"","."]})]}):null,b.length>0?(0,f.tZ)(f.HY,{children:(0,f.tZ)(hk,{css:hR.packages,children:b.sort(function(e,t){return(null==e?void 0:e.name)?(null==t?void 0:t.name)?e.name.localeCompare(t.name):-1:1}).map(function(e){return(0,f.tZ)(hx,{pkg:e,openConsole:n},e.name)})})}):null,(0,f.tZ)(hT,{openConsole:n})]}):null]})}var hD=n(13225);function hG(){var e=(0,C.Z)(),t=(0,uM.lV)((0,_.useCallback)(function(e){return e(ho)},[ho]),{store:hi()});return(0,_.useCallback)(function(n){var r=t();return(null==r?void 0:r.id)?(0,hl.C)(r.id).search({id:r.id,query:n,services:e}):[]},[])}function hB(e){var t=e.onResults,n=e.onLoading,r=e.className,i=ha(),o=(0,u._)((0,_.useState)(""),2),a=o[0],l=o[1],c=(0,_.useRef)(0),s=function(){c.current++,null==t||t(null),null==n||n(!1)},d=hG();(0,hD.Z)(function(){if(""!==a.trim()){var e,r=++c.current;(e=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(i){switch(i.label){case 0:return null==n||n(!0),[4,d(a)];case 1:if(e=i.sent(),r!==c.current)return[2];return null==t||t(null!=e?e:[]),null==n||n(!1),[2]}})}),function(){return e.apply(this,arguments)})()}},[a],500);var h=(0,_.useRef)(null);return(0,_.useEffect)(function(){h.current&&h.current.focus()},[]),(0,f.tZ)(y.G,{className:r,children:(0,f.tZ)(ni.E,{inputRef:h,value:a,onChange:function(e){""===e.target.value.trim()&&s(),l(e.target.value)},onClear:function(){l(""),s()},placeholder:i?"Search ".concat(i.language," packages"):void 0})})}var hP=(0,b.X)({root:[x.l0.maxWidth(800),x.l0.width("100%"),{marginLeft:"auto",marginRight:"auto","@container (min-width: 1200px)":[x.l0.maxWidth(1400)]}],skeleton:[x.l0.borderRadius(8),x.l0.p(8),ev.p.backgroundPulse(),x.l0.height(128)]});function hA(){return(0,f.tZ)(y.G,{css:hP.root,children:(0,f.tZ)(hk,{children:Array.from({length:3},function(e,t){return(0,f.tZ)(H.Tg,{css:hP.skeleton,elevated:!0},"SearchLoading-".concat(t))})})})}function hN(e){var t,n=e.pkg,r=e.openConsole,i=ha(),o=hc(n),a=o?(0,O._)((0,U._)({},o),{version:null!==(t=n.spec)&&void 0!==t?t:o.version}):n,l=(null==i?void 0:i.id)==="nix"?null==o?void 0:o.prettyName:void 0;return(0,f.tZ)(hZ,{name:l,pkg:a,isMetadataLoading:null===o,openConsole:r})}function hL(e){var t=e.pkg,n=e.openConsole;return(0,f.tZ)(hZ,{pkg:t,openConsole:n})}var hU=(0,b.X)({root:[x.l0.colWithGap(8),x.l0.maxWidth(800),x.l0.width("100%"),{marginLeft:"auto",marginRight:"auto","@container (min-width: 1200px)":[x.l0.maxWidth(1400)]}],results:[x.l0.colWithGap(8)],empty:[x.l0.flex.row,x.l0.justify.center]});function hO(e){var t=e.results,n=e.openConsole,r=ha(),i=(null==r?void 0:r.id)==="nix"?hN:hL;return(0,f.tZ)(y.G,{css:hU.root,children:(0,f.tZ)(y.G,{css:hU.results,children:0===t.length?(0,f.tZ)(g.xv,{color:"dimmer",css:hU.empty,children:"No Packages Found"}):(0,f.tZ)(hk,{children:t.map(function(e){return(0,f.tZ)(i,{pkg:e,openConsole:n},e.name)})})})})}var hM=n(40664),hX=(0,b.X)({root:[x.l0.p(8),x.l0.borderRadius(8),x.l0.colWithGap(16)],header:[x.l0.flex.row,x.l0.align.center,x.l0.justify.spaceBetween],headerLeft:[x.l0.rowWithGap(4),x.l0.align.center],headerRight:[],content:[x.l0.display.block]});function hF(e){var t=e.title,n=e.onClose,r=e.children,i=(0,u._)((0,_.useState)(!0),2),o=i[0],a=i[1];return(0,f.BX)(H.Tg,{elevated:!0,css:hX.root,children:[(0,f.BX)(y.G,{css:hX.header,children:[(0,f.BX)(y.G,{css:hX.headerLeft,children:[(0,f.tZ)(g.h4,{level:2,variant:"subheadDefault",children:t}),(0,f.tZ)(m.hU,{alt:o?"Minimize tip information":"Expand tip information",tooltipHidden:!0,onClick:function(){return a(function(e){return!e})},children:(0,f.tZ)(lP.Z,{rotate:o?90:0})})]}),(0,f.tZ)(y.G,{css:hX.headerRight,children:(0,f.tZ)(m.hU,{alt:"Dismiss tip",tooltipHidden:!0,onClick:n,children:(0,f.tZ)(rr.Z,{})})})]}),o?(0,f.tZ)(y.G,{css:hX.content,children:r}):null]})}var hW=(0,b.X)({root:[x.l0.colWithGap(8),x.l0.pb(24)]});function hH(){var e=(0,hM.Z)("packager","show_packager_about_tooltip"),t=(0,hM.Z)("packager","show_packager_import_tooltip");return((0,_.useEffect)(function(){e.register()},[e]),(0,_.useEffect)(function(){t.register()},[t]),e.shouldDisplay||t.shouldDisplay)?(0,f.BX)(y.G,{css:hW.root,children:[e.shouldDisplay?(0,f.BX)(hF,{title:"What are packages?",onClose:e.dismiss,children:["Packages are collections of code that can extend the functionality of your programs. For example, you could add a package to make adding image carousels easier on websites, or a package to manage currency comparisons."," ",(0,f.tZ)(hC,{children:"Learn more about packages"}),"","."]}):null,t.shouldDisplay?(0,f.tZ)(hF,{title:"TipAuto Import",onClose:t.dismiss,children:"If you know which packages you want to use, you can just import and use them in your files as if they were already installed, and they will be installed automatically the next time you run the Repl."}):null]}):null}var hV=n(16278);function hz(e){var t=e.children,n=e.config,r=(0,t2.b9)(ho,{store:hi()});return(0,_.useEffect)(function(){(null==n?void 0:n.id)&&r(n)},[n]),(0,f.tZ)(f.HY,{children:t})}function hj(e){var t=e.children,n=e.config,r=(0,u._)((0,_.useState)(function(){return(0,t8.MT)()}),1)[0];return(0,f.tZ)(hr.Provider,{value:r,children:n?(0,f.tZ)(hz,{config:n,children:t}):t})}var hq=(0,b.X)({root:[x.l0.pt(16),x.l0.p(8),{containerType:"inline-size"}],loading:[x.l0.center,x.l0.p(8),x.l0.height("100%")],center:[x.l0.width("100%"),x.l0.maxWidth(600),x.l0.colWithGap(4),{marginLeft:"auto",marginRight:"auto","@container (min-width: 400px)":[x.l0.maxWidth(800)],"@container (min-width: 1200px)":[x.l0.maxWidth(1400)]}],title:[],content:[x.l0.pt(8),x.l0.colWithGap(16)],search:[x.l0.rowWithGap(8),x.l0.width("100%")],searchInput:[x.l0.flex.grow(1)],configSelect:[],packages:[x.l0.colWithGap(16)]});function hY(e){var t,n,r,i,o,a=e.openFile,l=e.openConsole,c=(0,hV.I)(),s=c.configs,d=c.loading,h=(0,L.Z)(function(){return s.filter(function(e){return"nix"!==e.id})},[s]),p=(0,u._)((t=(0,hV.I)().configs,n=(0,L.Z)(function(){return t.filter(function(e){return"nix"!==e.id})},[t]),i=(r=(0,u._)((0,_.useState)(null),2))[0],o=r[1],(0,_.useEffect)(function(){n.length>0&&(null==i||!n.find(function(e){return e&&e.id===i.id}))&&o(n[0])},[i,n]),[i,o]),2),m=p[0],v=p[1],b=(0,u._)((0,_.useState)(null),2),w=b[0],x=b[1],C=(0,u._)((0,_.useState)(!1),2),S=C[0],k=C[1],E=null;return(E=null!==w?(0,f.tZ)(hO,{results:w,openConsole:l}):S?(0,f.tZ)(hA,{}):(0,f.tZ)(f.HY,{children:h.map(function(e){return e.id===(null==m?void 0:m.id)?(0,f.tZ)(hI,{openFile:a,openConsole:l},e.id):(0,f.tZ)(hj,{config:e,children:(0,f.tZ)(hI,{openFile:a,openConsole:l})},e.id)})}),d)?(0,f.tZ)(y.G,{css:hq.loading,children:(0,f.tZ)(Z.Z,{})}):(0,f.tZ)(y.G,{css:hq.root,children:(0,f.tZ)(y.G,{css:hq.center,children:0===h.length?(0,f.BX)(y.G,{children:[(0,f.tZ)(g.h4,{level:2,variant:"subheadBig",children:"Sorry, packages are not configured for this Repl."}),(0,f.tZ)(g.xv,{variant:"subheadDefault",children:"We are working on making more features configurable and packages available for more languages, check back again in the future."})]}):(0,f.BX)(f.HY,{children:[(0,f.tZ)(hH,{}),(0,f.tZ)(g.h4,{css:hq.title,level:2,variant:"subheadBig",children:"Packages"}),(0,f.tZ)(y.G,{css:hq.content,children:(0,f.BX)(hj,{config:m,children:[(0,f.BX)(y.G,{css:hq.search,children:[(null==m?void 0:m.packageSearch)?(0,f.tZ)(hB,{css:hq.searchInput,onResults:x,onLoading:k}):(0,f.tZ)(y.G,{css:hq.searchInput}),h.length>1&&(0,f.tZ)(d4.P,{css:hq.configSelect,items:h,selectedItem:m,onChange:function(e){return v(e)},"aria-label":"Select packager configuration"})]}),(0,f.tZ)(y.G,{css:hq.packages,children:E})]})})]})})})}var hJ=h.Dy.Object({type:h.Dy.Literal("packager")}),hK={Content:function(e){var t=e.options;return(0,f.tZ)(hY,{openFile:function(e){return t.performPaneOperation({operation:"open",pane:(0,S.$E)(e),secondary:!0})},openConsole:function(){t.performPaneOperation({operation:"open",pane:{type:"runnerOutput"},secondary:!0})}})},Icon:function(e){var t=e.size;return(0,f.tZ)(ht.Z,{size:t})},getTitle:function(){return"Packages"},decode:function(e){return p.B4.Decode(hJ,e)}},h$=n(52924),hQ=n(32681),h0=n.n(hQ),h1=n(45726),h2=n(11774),h8=(0,b.X)({create:[x.l0.colWithGap(8),x.l0.p(8)],pedit:{width:"100%",height:"100%"},canvas:{width:"100%",height:"100%",outline:"none",position:"absolute",top:0,left:0},upgradeButton:[x.l0.position.absolute,x.l0.top(8),x.l0.left("50%"),{transform:"translateX(-50%)"}]});function h4(e){var t=e.data,n=e.onSave,r=(0,_.useRef)(null),i=(0,_.useRef)(null),o=(0,C.Z)().fs,a=(0,ao.Z)(),l=a.showError,c=a.showConfirm,s=(0,u._)((0,_.useState)(!1),2),d=s[0],h=s[1],p=(0,cR.Z)(function(){var e=r.current;if(!e)return null;e.width=e.offsetWidth,e.height=e.offsetHeight;var t=e.getContext("2d");t&&(t.imageSmoothingEnabled=!1)},{type:"debounce",wait:100});return(0,_.useEffect)(function(){var e=r.current;if(e){e.width=e.offsetWidth,e.height=e.offsetHeight;var o=h0()({canvas:e,data:t}),a=function(){return n(o.save())};return o.on("change",a),o.on("save",a),o.on("export",function(){return h(!0)}),i.current=o,e.focus(),function(){o&&o.cleanUp(),i.current&&(i.current=null)}}},[t,n,r]),(0,f.BX)(f.HY,{children:[(0,f.tZ)("canvas",{css:h8.canvas,ref:function(e){r.current=e,p(e)},tabIndex:0}),(0,f.tZ)(rE.u,{isOpen:d,onRequestClose:function(){return h(!1)},children:(0,f.tZ)(h1.Z,{prompt:"Export",desc:"What name to give to the exported file?",placeholder:"filename",type:"text",onCancel:function(){return h(!1)},onConfirm:function(e){if(!i.current){h(!1);return}var t="".concat(e,".png"),n=i.current.curFrame().toPNG();o.writeFile(t,tG.Z.from(n)).then(function(e){if(e.error){l("Failed to write to file ".concat(t));return}c("Successfully exported to ".concat(t)),h(!1)})}})})]})}function h3(e){var t,n=e.activeFile,r=(0,C.Z)().fs,i=(0,u._)((0,_.useState)(!0),2),o=i[0],a=i[1],l=(0,u._)((0,_.useState)(null),2),c=l[0],s=l[1],d=(0,ao.Z)().showError,h=n.endsWith(".kbmsprite");(0,_.useEffect)(function(){var e=!1;function t(){return(t=(0,ts._)(function(){var t,i,o;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:return[4,r.readFile(n)];case 1:if(t=l.sent(),a(!1),e)return[2];if(t.error)return d("failed to read ".concat(n)),[2];return o=(i=t.content.toString())&&JSON.parse(i),s(h?(0,h2.C)(o):o),[2]}})})).apply(this,arguments)}return!function(){t.apply(this,arguments)}(),function(){e=!0}},[r,n,d,h]);var p=(0,_.useCallback)((t=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){switch(t.label){case 0:if(!h)return[3,2];return[4,(0,h2.u)(e)];case 1:e=t.sent(),t.label=2;case 2:return[4,r.writeFile(n,tG.Z.from(JSON.stringify(e)))];case 3:return t.sent().error&&d("Failed to save ".concat(n,", please try again")),[2]}})}),function(e){return t.apply(this,arguments)}),[r,n,d,h]);return o?(0,f.tZ)(Z.Z,{}):c?(0,f.tZ)(h4,{data:c,onSave:p}):(0,f.tZ)(h5,{onCreate:function(e){return s(e)}})}function h5(e){var t=e.onCreate,n=(0,u._)((0,_.useState)(""),2),r=n[0],i=n[1],o=(0,u._)((0,_.useState)(""),2),a=o[0],l=o[1],c=Number(r),s=Number(a);return(0,f.BX)(y.G,{css:h8.create,children:[(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Create a Pedit file"}),(0,f.tZ)(X.II,{placeholder:"width",value:r,onChange:function(e){return i(e.target.value)}}),(0,f.tZ)(X.II,{placeholder:"height",value:a,onChange:function(e){return l(e.target.value)}}),(0,f.tZ)(W.zx,{text:"Create",disabled:!(c>0&&s>0),onClick:function(){t({width:Math.ceil(c),height:Math.ceil(s)})}})]})}var h6=h.Dy.Object({type:h.Dy.Literal("pedit"),data:h.Dy.Object({path:h.Dy.String()})}),h9={Content:function(e){var t=e.pane,n=e.options.performPaneOperation;return(0,f.tZ)(h7,{path:t.data.path,performPaneOperation:n})},Icon:function(e){var t=e.size;return(0,f.tZ)(h$.Z,{size:t})},getTitle:function(e){return(0,E.UO)(e.data.path)},decode:function(e){return p.B4.Decode(h6,e)}};function h7(e){var t=e.path,n=e.performPaneOperation,r=(0,S.Mp)({path:t,performPaneOperation:n});return(0,k.L5)(function(){if(r)return{commands:r}},[r]),(0,f.BX)(f.HY,{children:[(0,f.tZ)(S.HK,{path:t,performPaneOperation:n}),(0,f.tZ)(S.VY,{children:(0,f.tZ)(h3,{activeFile:t})})]})}var pe=n(79098),pt=n(67711),pn=n(34581),pr=(0,b.X)({badge:[x.l0.backgroundColor.backgroundHighest,x.l0.borderRadius(4),{padding:"0 0.35em"}],container:[x.l0.p(8),x.l0.colWithGap(8)],header:[x.l0.py(4),x.l0.justify.spaceBetween,x.l0.flex.grow(1),x.l0.pr(16),x.l0.height(24)],result:[x.l0.borderRadius(4),x.l0.overflow("hidden")],problems:[x.l0.px(6),x.l0.py(6)],item:[nn.gU.listItem,x.l0.reset.button,x.l0.justify.spaceBetween,x.l0.px(8),x.l0.py(4),x.l0.overflow("hidden"),x.l0.cursor.pointer,x.l0.borderRadius(4),{"&:focus-visible":[x.l0.focusRing],"&:hover, &:focus-visible":[x.l0.backgroundColor.backgroundHighest]}],itemMain:[x.l0.flex.growAndShrink(1)],itemSecondary:[x.l0.color.foregroundDimmest],flex:[x.l0.rowWithGap(8),x.l0.align.center],message:[x.l0.flex.shrink(1),x.l0.overflowX("hidden"),{textOverflow:"ellipsis",whiteSpace:"nowrap"}]});function pi(e){var t=e.isActive,n=e.performPaneOperation,r=(0,u._)((0,_.useState)({}),2),i=r[0],o=r[1],a=(0,pn.nC)(),l=(0,k.dr)(),c=(0,_.useCallback)(function(){var e=!0,t=!1,n=void 0;try{for(var r,i=a()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)!function(){var e,t=r.value;if("codeEditor"===t[1].type){var n=l(t[0]);if(n&&"codeEditor"===n.type){var i=t[1].data.path,a=null===(e=n.fetchProblems)||void 0===e?void 0:e.call(n);i&&a&&o(function(e){return(0,O._)((0,U._)({},e),(0,eP._)({},i,a))})}}}()}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},[l,a]);return(0,_.useEffect)(function(){t&&c()},[t,c]),(0,k.L5)(function(){return{type:"problems",updateProblems:function(e,t){o(function(n){return(0,O._)((0,U._)({},n),(0,eP._)({},e,t))})}}},[o]),(0,f.BX)(y.G,{css:pr.container,children:[Object.values(i).some(function(e){return e.length>0})?null:(0,f.tZ)(g.xv,{children:"No problems detected in this workspace"}),Object.keys(i).map(function(e){return 0===i[e].length?null:(0,f.tZ)(H.Tg,{elevated:!0,css:pr.result,children:(0,f.tZ)(ed.Q,{chevron:"end",defaultExpanded:!0,headerContent:(0,f.BX)(y.G,{css:[pr.flex,pr.header],children:[(0,f.BX)(y.G,{css:pr.flex,children:[(0,f.tZ)(v.Z,{path:e}),(0,f.tZ)(g.xv,{children:e})]}),(0,f.tZ)(y.G,{css:pr.badge,children:i[e].length>99?"99+":i[e].length})]}),children:(0,f.tZ)(y.G,{css:pr.problems,children:i[e].map(function(t,r){var i=t.range.start.line+1,o=t.range.start.character;return(0,f.tZ)(pt.Z,{problem:t,onClick:function(){n({operation:"open",pane:{type:"codeEditor",data:{path:e,line:i,col:o}},secondary:!0})}},"".concat(i,"-").concat(o,"-").concat(r))})})},e)},e)})]})}var po=h.Dy.Object({type:h.Dy.Literal("problems")}),pa={Content:function(e){var t=e.options,n=t.isActive,r=t.performPaneOperation;return(0,f.tZ)(pi,{isActive:n,performPaneOperation:r})},Icon:function(){return(0,f.tZ)(pe.Z,{})},getTitle:function(){return"Problems"},decode:function(e){return p.B4.Decode(po,e)}},pl=n(78564),pc=n(41140),ps=n(95571),pu=n(71984),pd=n(82723),pf=(0,ep.iv)([x.l0.focusRing,x.l0.display.flex,x.l0.center,x.l0.borderRadius(4),x.l0.backgroundColor.backgroundRoot,x.l0.color.foregroundDefault,x.l0.cursor.pointer,x.l0.p(4),(gY={transition:"background-color 0.2s",border:"none"},(0,eP._)(gY,x.wl.hover,[x.l0.backgroundColor.backgroundHigher]),(0,eP._)(gY,":focus",{outline:"none"}),gY)]),ph=function(e){var t=e.onClick;return(0,f.tZ)(ta.u,{tooltip:"Search",placement:"bottom-start",children:(0,f.tZ)("button",{"aria-label":"Search",onClick:t,css:pf,children:(0,f.tZ)(pd.Z,{size:16})})})},pp=n(14675),pm=n(25632),pv=n(37463),pg=n(72143),py=n(31384),pb=n(19562),pw=n(71749),pZ=n(41772),px=n(62507),pC={CURSOR_SAVE:"\x1b[s",CURSOR_RESTORE:"\x1b[u",ERASE_TO_END_OF_SCREEN:"\x1b[0J",COLOR_RESET:"\x1b[0m",COLOR_BRIGHT_BLACK:"\x1b[0;90m"},pS=(0,ep.iv)([x.l0.position.absolute,x.l0.left(8),x.l0.right(0),x.l0.zIndex(5)]);function pk(e){var t=e.lineNumber,n=e.paneHeight,r=e.shell,i=e.sendToShellChannel,o=e.onClose,a=(0,_.useMemo)(function(){return null==r?void 0:r._term},[r]),l=(0,_.useMemo)(function(){var e,t=null==a?void 0:a._core;return null!==(e=null==t?void 0:t._renderService.dimensions.css.cell)&&void 0!==e?e:{width:0,height:0}},[a]),c=(0,_.useRef)(""),s=(0,_.useRef)(!1),d=(0,_.useRef)(null),h=(0,u._)((0,_.useState)(64),2),p=h[0],v=h[1],g=(0,_.useCallback)(function(e){return v(e.height)},[v]),b=(0,px.WR)({onCode:function(e){if(null===e){c.current="";return}c.current!==e&&(s.current&&(r.write(pC.CURSOR_RESTORE),r.write(pC.ERASE_TO_END_OF_SCREEN)),r.write(pC.CURSOR_SAVE),r.write(pC.COLOR_BRIGHT_BLACK),r.write(e.replaceAll("\n","\r\n")),r.write(pC.COLOR_RESET),s.current=!0,c.current=e)}}),w=b.sendMessage,Z=b.stopMessage,x=b.getCode,C=b.loading,S=b.completed,k=b.error,E=b.clearError,T=(0,_.useCallback)(function(){(0,nw.j)(nw.U3.AI_SHELL_INLINE_CLOSED),Z(),s.current&&(r.write(pC.CURSOR_RESTORE),r.write(pC.ERASE_TO_END_OF_SCREEN),r.write(pC.COLOR_RESET)),o()},[r,Z,o]);(0,_.useEffect)(function(){return r.onData(function(){Z(),o()}).dispose},[r,Z,o]);var R=(0,_.useCallback)(function(){var e,t=null===(e=x())||void 0===e?void 0:e.code;if(!s.current||!t){T();return}r.write(pC.CURSOR_RESTORE),r.write(pC.ERASE_TO_END_OF_SCREEN),r.write(pC.COLOR_RESET),i(t),(0,nw.j)(nw.U3.AI_SHELL_INLINE_ACCEPTED),o()},[r,x,o,T,i]),I=(0,pw.U1)({loading:C,onSubmit:function(){P?R():A()},onClose:T}),D=I.value,G=I.setValue,B=I.onKeyDown,P=S&&d.current===D,A=(0,_.useCallback)(function(){d.current=D,w({message:D})},[w,D]),N=l.height*(t+1)+8,L="top";N+p>n&&(L="bottom",N=n-l.height*(t+1)+4);var U=(0,pZ.Un)();return(0,f.tZ)(y.G,{css:pS,style:{top:"top"===L?N:void 0,bottom:"bottom"===L?N:void 0},children:(0,f.BX)(pw.If,{requestMeasure:g,type:"generateCode",isCodeMirrorPocket:!1,error:k,clearError:E,children:[(0,f.tZ)(pw.II,{value:D,onChange:function(e){return G(e.currentTarget.value)},placeholder:"Enter a prompt to generate a shell command",onKeyDown:B,autoFocus:!0}),(0,f.BX)(pw.$_,{children:[(0,f.BX)(f.HY,{children:[(0,f.tZ)(pw.Xs,{type:"generateCode"}),S?(0,f.tZ)(m.hU,{alt:"Rerun the same prompt",onClick:function(){return A()},size:12,colorway:"grey",children:(0,f.tZ)(n1.Z,{})}):null]}),P?(0,f.BX)(f.HY,{children:[(0,f.tZ)(W.zx,{variant:"outlined",size:"small",text:"Reject",onClick:function(){(0,nw.j)(nw.U3.AI_SHELL_INLINE_DISCARDED),T()}}),(0,f.tZ)(W.zx,{size:"small",text:"Accept",colorway:"blurple",onClick:R,dataCy:"ghostwriter-inline-accept-suggestion"})]}):(0,f.tZ)(pw.k4,{connecting:!U,loading:C,disabled:!D,onClick:function(){C?Z():A()}})]})]})})}var p_=n(32911);function pE(e){var t=e.portsOpenedByThisShell,n=e.performPaneOperation,r=e.onClose,i=(0,C.Z)().ports,o=(0,_.useCallback)(function(e){i.updateDotReplitPortsMapping(e,void 0)},[i]),a=(0,_.useCallback)(function(e){i.tryExposingPortAutomatically(e)},[i]);return(0,f.tZ)(p_.ms,{configurations:t.map(function(e){return e.configuration}),openWebview:function(){n({operation:"open",secondary:!0,pane:{type:"webview",data:t.length>0?{portType:"local",port:t[0].configuration.localPort}:void 0}})},openNetworkingTool:function(){n({operation:"open",secondary:!0,pane:{type:"networking"}})},onClose:function(){null==r||r()},onDontExposePort:function(){1===t.length&&o(t[0].configuration.localPort)},onDoExposePort:function(){1===t.length&&a(t[0].configuration.localPort)}})}var pT=n(53320),pR=n(77589),pI=n(9669),pD=n(26851),pG=n(80502),pB="\x1b[200~",pP="\x1b[201~",pA=n(83663),pN=(0,ep.iv)([x.l0.height("100%"),x.l0.overflow("hidden"),{"& .xterm":[x.l0.pl(8),x.l0.pt(8),x.l0.pb(4),x.l0.height("100%")]}]),pL=(0,b.X)({container:[x.l0.height("100%"),{"&:focus-within .controls":{opacity:1}}],xterm:pN,xtermWithBorderRadius:[pN,{"& .xterm-viewport":[x.l0.borderRadius(0,0,8,8)]}]});function pU(e){var t,n,r=e.shell,i=e.shellMetadata,o=e.sendToShellChannel,a=e.shellRef,l=e.className,c=e.openSearchAndReplace,s=e.openAIWithMessage,d=e.performPaneOperation,h=e.isGeneratePromptVisible,p=e.currentPromptLineNumber,m=e.onOpenGeneratePrompt,v=e.onCloseGeneratePrompt,g=(0,pm.Gn)("accessibleTerminal").preferences.accessibleTerminal,b=(0,tQ.P5)({controlName:"flag-ai-in-the-shell",logFlagToAnalytics:!1}),w=(0,u._)((0,_.useState)(!1),2),Z=w[0],C=w[1],S=(0,u._)((0,_.useState)(""),2),k=S[0],E=S[1],T=(0,pv.dF)(null!==(t=null==i?void 0:i.cgroup)&&void 0!==t?t:void 0);r&&Z&&(n=(0,f.tZ)(pp.R,{searchValue:k,setSearchValue:E,findPrevious:r.findPrevious,findNext:r.findNext,exit:function(){return C(!1)}})),!r||Z||b||(n=(0,f.tZ)(ph,{onClick:function(){return C(!0)}}));var R=(0,aZ.T3)(),I=(0,py.av)().onContextMenu,D=(0,pb.j)({xterm:r,isOutputsTerminal:!1,openAIWithMessage:s,openShellSearch:function(e){C(!0),E(e)},openSearchAndReplace:c,openGeneratePrompt:m});(0,_.useEffect)(function(){null==r||r.fit()},[r,T]);var G=(0,u._)((0,_.useState)(0),2),B=G[0],P=G[1],A=(0,cR.Z)(function(e){P(e.height)},{type:"throttle",wait:200});return(0,f.BX)(y.G,{className:l,innerRef:A,css:pL.container,onKeyDown:function(e){"f"===e.key&&(0,ps.jh)(e)&&(C(!0),e.preventDefault())},children:[!g&&(0,f.tZ)(pg.T,{children:'Enable "Accessible Terminal" in Workspace Settings to use a screen reader with the shell.'}),(0,f.BX)(y.G,{css:[x.l0.coverContainer,x.l0.flex.column],onClick:function(){h&&(v(),null==r||r.focus())},children:[(0,f.tZ)(y.G,{css:[R?pL.xterm:pL.xtermWithBorderRadius,x.l0.flex.growAndShrink(1),b&&h?{pointerEvents:"none",filter:"opacity(0.75)"}:null],innerRef:a,onContextMenu:function(e){return I(e,{command:D})}}),(0,f.tZ)(pE,{portsOpenedByThisShell:T,performPaneOperation:d,onClose:function(){null==r||r.focus(),null==r||r.fit()}})]}),b&&r&&h?(0,f.tZ)(pk,{lineNumber:p,paneHeight:B,shell:r,sendToShellChannel:o,onClose:function(){v(),r.focus()}}):null,r?(0,f.BX)(y.G,{className:"controls",css:[x.l0.position.absolute,x.l0.flex.row,x.l0.top(8),x.l0.right(8),x.l0.height(30),x.l0.align.center,{opacity:0,zIndex:4}],children:[n,b?null:(0,f.tZ)(pu.Z,{onClick:r.clear})]}):null,r?null:(0,f.tZ)("code",{css:[x.l0.color.foregroundDimmest,x.l0.coverContainer,x.l0.p(8),x.l0.font.code],children:"Loading..."})]})}var pO=n(27173),pM=n(90719),pX=n(31417),pF=n(67405),pW=n(66349),pH=n(5621),pV=n(91620).lW,pz=(0,ep.iv)([x.l0.position.relative,x.l0.height("100%")]);function pj(e){var t,n=e.paneId,r=e.performPaneOperation,i=e.initialPwd,o=e.isActive;!function(){if(!(0,tQ.P5)({controlName:"flag-pid2",logFlagToAnalytics:!1}))throw Error("`flag-pid2` flag is necessary for `flag-pid2-shell`");if(!(0,tQ.P5)({controlName:"use-eval-server",logFlagToAnalytics:!1}))throw Error("`use-eval-server` flag is necessary for `flag-pid2-shell`")}();var a=(0,C.Z)().fs,l=(0,pW.Z)(),c=(0,pF.h)(),s=(0,_.useRef)(null),d=(0,u._)((0,_.useState)("loading"),2),h=d[0],p=d[1],m=(0,u._)((0,_.useState)(void 0),2),v=m[0],g=m[1],b=(0,u._)((0,_.useState)(0),2),w=b[0],Z=b[1],x=(0,u._)((0,_.useState)(!1),2),S=x[0],E=x[1],T=(0,_.useCallback)(function(){r({operation:"remove",pane:{id:n}})},[r,n]),R=(0,_.useCallback)(function(e){r({operation:"open",secondary:!0,pane:{type:(0,P.Dp)(e),data:e}})},[r]),I=(0,_.useCallback)(function(e,t){r({operation:"open",secondary:!0,pane:{type:"webview",data:{portType:"local",path:e,port:t}}})},[r]),D=(0,_.useCallback)(function(e){r({operation:"open",secondary:!0,pane:{type:"searchReplace",data:{initialQuery:e}}})},[r]),G=(0,px.bD)({onSession:function(e){r({operation:"open",secondary:!0,pane:{type:"ghostwriterChat",data:{sessionId:e}}})}}).sendMessage,B=(0,u._)((0,pM.Ni)(),1)[0],A=(0,_.useCallback)((t=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){return e.text&&G({kind:"message",message:e.text,intent:pO.$h.EXPLAIN,model:"advanced"===B?pO.BY.ADVANCED:pO.BY.BASIC}),[2]})}),function(e){return t.apply(this,arguments)}),[B,G]),N=(0,pA.bW)({onOpenGeneratePrompt:function(){return E(!0)},onUpdateCurrentPromptLineNumber:Z}),L=(0,u._)((0,pG.Z)({openFile:R,listFiles:a.listFiles,openWebview:I,onInBandOSCMessages:(0,eP._)({},pA.Xd,N)}),2),U=L[0],O=L[1],M=(0,_.useId)(),X="scope-shell-".concat(M);return(0,ix.ow)(X,o),(0,iZ.Il)(function(){return[pA.CH.id,{run:function(){E(!0)},scope:X,bubble:!1}]},[E]),(0,k.Wk)(function(){return U},[U]),(0,_.useEffect)(function(){function e(){return(e=(0,ts._)(function(){var e,t,n,r,o,a,d,f,h,m,v,y;return(0,tu.Jh)(this,function(b){switch(b.label){case 0:if(!U||!c||!l||null!==s.current)return[2];return[4,c.shellExec.spawn.stream({cmd:"bash",env:{TERM:"xterm-256color",PS1:"\\[\\033[01;34m\\]\\w\\[\\033[00m\\]\\$ ",IS_PID2_SHELL:"true"},cwd:null!=i?i:"/home/runner/".concat(l.slug),size:U.getSize()})];case 1:t=(e=u._.apply(void 0,[b.sent(),3]))[0],n=e[1],r=e[2],s.current={input:t,close:r},o=!1,a=!1,b.label=2;case 2:b.trys.push([2,7,8,13]),f=(0,pX._)(n),b.label=3;case 3:return[4,f.next()];case 4:if(!(o=!(h=b.sent()).done))return[3,6];if(!(m=h.value).ok)throw Error("pid2 non-ok msg: ".concat(m.payload.message));switch(v=m.payload.$kind){case"output":U.write(m.payload.output);break;case"state":p(m.payload.state);break;case"exit":T();break;case"metadata":g({cgroup:m.payload.cgroup});break;default:(0,t7.Z)(v)}b.label=5;case 5:return o=!1,[3,3];case 6:return[3,13];case 7:return y=b.sent(),a=!0,d=y,[3,13];case 8:if(b.trys.push([8,,11,12]),!(o&&null!=f.return))return[3,10];return[4,f.return()];case 9:b.sent(),b.label=10;case 10:return[3,12];case 11:if(a)throw d;return[7];case 12:return[7];case 13:return[2]}})})).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){var e;null===(e=s.current)||void 0===e||e.close(),s.current=null}},[c,U,l,i,T]),(0,_.useEffect)(function(){if(U){var e=U.onData(function(e){var t,n=new Uint8Array(pV.from(e));null===(t=s.current)||void 0===t||t.input.push({$kind:"stdin",stdin:n})}),t=U.onResize(function(e){var t,n=e.cols,r=e.rows;null===(t=s.current)||void 0===t||t.input.push({$kind:"resize",cols:n,rows:r})});return function(){e.dispose(),t.dispose()}}},[U]),(0,f.BX)(y.G,{css:pz,children:["loading"===h?(0,f.tZ)(pH.Z,{}):null,(0,f.tZ)(pU,{shell:U,shellMetadata:v,shellRef:O,performPaneOperation:r,currentPromptLineNumber:w,isGeneratePromptVisible:S,sendToShellChannel:function(e){var t,n=new Uint8Array(pV.from(e));null===(t=s.current)||void 0===t||t.input.push({$kind:"stdin",stdin:n})},openSearchAndReplace:D,openAIWithMessage:A,onOpenGeneratePrompt:function(){return E(!0)},onCloseGeneratePrompt:function(){return E(!1)}})]})}var pq=h.Dy.Object({type:h.Dy.Literal("shell"),data:h.Dy.Optional(h.Dy.Object({initialPwd:h.Dy.Optional(h.Dy.String())}))}),pY={Content:function(e){var t,n,r=e.pane,i=e.options;return(0,tQ.P5)({controlName:"flag-pid2-shell",logFlagToAnalytics:!1})?(0,f.tZ)(pj,{paneId:i.paneId,isActive:i.isActive,initialPwd:null===(n=r.data)||void 0===n?void 0:n.initialPwd,performPaneOperation:i.performPaneOperation}):(0,f.tZ)(pJ,{isActive:i.isActive,initialPwd:null===(t=r.data)||void 0===t?void 0:t.initialPwd,performPaneOperation:i.performPaneOperation})},Icon:function(e){var t=e.size;return(0,f.tZ)(pc.Z,{size:t})},getTitle:function(){return"Shell"},decode:function(e){return p.B4.Decode(pq,e)}};function pJ(e){var t,n,r,i,o,a,l,c,s,d,h,p,m,v,g,y,b,w,Z,x,S,E,T,R,I,D,G,B,A,N,L,U=e.isActive,O=e.initialPwd,M=e.performPaneOperation,X=(0,C.Z)(),F=X.container,W=X.fs,H=(0,u._)((0,_.useState)(!1),2),V=H[0],z=H[1],j=(0,u._)((0,_.useState)(void 0),2),q=j[0],Y=j[1],J=(0,_.useCallback)(function(e){M({operation:"open",secondary:!0,pane:{type:(0,P.Dp)(e),data:e}})},[M]),K=(0,_.useCallback)(function(e){M({operation:"open",secondary:!0,pane:{type:"searchReplace",data:{initialQuery:e}}})},[M]),$=(0,px.bD)({onSession:function(e){M({operation:"open",secondary:!0,pane:{type:"ghostwriterChat",data:{sessionId:e}}})}}).sendMessage,Q=(0,u._)((0,pM.Ni)(),1)[0],ee=(0,_.useCallback)((t=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){return e.text&&$({kind:"message",message:e.text,intent:pO.$h.EXPLAIN,model:"advanced"===Q?pO.BY.ADVANCED:pO.BY.BASIC}),[2]})}),function(e){return t.apply(this,arguments)}),[Q,$]),et=(0,_.useCallback)(function(e,t){M({operation:"open",secondary:!0,pane:{type:"webview",data:{portType:"local",path:e,port:t}}})},[M]),en=(0,u._)((0,_.useState)(0),2),er=en[0],ei=en[1],eo=(0,u._)((0,_.useState)(!1),2),ea=eo[0],el=eo[1],ec=(0,u._)((r=(n={container:F,initialPwd:O,onOutput:(0,_.useCallback)(function(){z(!0)},[z]),onShellMetadata:Y,openFile:J,listFiles:W.listFiles,openWebview:et,onOpenGeneratePrompt:function(){el(!0)},onUpdateCurrentPromptLineNumber:function(e){ei(e)}}).onShellKey,i=n.onOutput,o=n.onShellMetadata,a=n.container,l=n.initialPwd,c=n.openFile,s=n.listFiles,d=n.openWebview,h=n.onOpenGeneratePrompt,p=n.onUpdateCurrentPromptLineNumber,m=(0,pA.bW)({onOpenGeneratePrompt:h,onUpdateCurrentPromptLineNumber:p}),g=(v=(0,u._)((0,pG.Z)({openFile:c,listFiles:s,openWebview:d,onInBandOSCMessages:(0,eP._)({},pA.Xd,m)}),2))[0],y=v[1],w=(b=(0,u._)((0,_.useState)(null),2))[0],Z=b[1],x=(0,eY.Z)(o),(0,_.useEffect)(function(){return a.openChannel({service:"shell"},function(e){var t=e.channel;return Z(t),t.onCommand(function(e){if(e.shellMetadata){var t;null===(t=x.current)||void 0===t||t.call(x,e.shellMetadata)}}),function(){Z(null)}})},[a,x]),S=(0,pD.K)({channelId:null==w?void 0:w.id}),E=(0,_.useRef)(!1),T="",R="",I="",B=(G={sendInput:D=(0,_.useCallback)(function(e){if(!w||!g)return!1;var t=a.client();if(!w||"open"!==w.status||t.getConnectionState()!==pT.em.CONNECTED)return!1;var n=e.startsWith(pB)&&e.endsWith(pP)?e.slice(pB.length,e.length-pP.length):e;return w.send({input:n}),!0},[g,w,a]),paste:function(e){return!!g&&(g.paste(e),!0)}}).sendInput,A=G.paste,N=(0,aC.useRouter)(),L=(0,aZ.Vg)(N),(0,_.useEffect)(function(){if(L){var e=function(e,t){B(t)?(0,pR.gU)(e):(0,pR.pl)(e)},t=function(e){"unknown"===e||(0,t7.Z)(e)},n=function(n){(0,pR.gN)(n,function(n){var r=n.type;switch(r){case pI.cF.SHELL_INSERT_INPUT:e(n.id,n.input);break;case pI.cF.SHELL_COMMAND:t(n.command);break;case pI.cF.SHELL_PASTE_TEXT:A(n.text)?(0,pR.gU)(n.id):(0,pR.pl)(n.id);break;default:(0,t7.Z)(r)}})};return window.addEventListener("message",n),function(){window.removeEventListener("message",n)}}},[L,B,A]),(0,_.useEffect)(function(){if(w&&g){var e=g.onKey(function(e){var t=e.key,n=e.domEvent;if("\r"===t){var i=R;R.endsWith(T)&&T.length>0&&(i=R.slice(0,-T.length)),S("user:shell:output:clean",{output:i,command:I}),S("user:shell:exec",{command:T}),S("user:shell:output",{output:R}),I=T,T="",R=""}else T+=t;r&&r(n)}),t=a.client(),n=g.onData(function(e){D(e)});w.onCommand(function(e){e.hint?g.write("\x1b[0m\x1b[33m".concat(e.hint.text,"\x1b[0m\r\n")):e.output&&(g.write(e.output),null==i||i(e.output),R+=e.output)});var o=function(){w&&"open"===w.status&&t.getConnectionState()===pT.em.CONNECTED&&w.send({resizeTerm:g.getSize()})};if(l&&!E.current){var c=l.replace(/"/g,'\\"');w.send({input:'cd "'.concat(c,'"\n')}),E.current=!0}var s=g.onResize(o);return o(),function(){e.dispose(),n.dispose(),s.dispose()}}},[w,g,r,i,o,a,D,l]),[g,y,D]),3),es=ec[0],eu=ec[1],ed=ec[2],ef=(0,_.useMemo)(function(){return[{type:"action",label:"Clear shell",icon:(0,f.tZ)(c9.Z,{}),run:function(){return null==es?void 0:es.clear()}}]},[es]);(0,k.Wk)(function(){return es},[es]),(0,k.L5)(function(){if(es&&V)return{actions:ef,type:"shell",exec:function(e){ed(e+"\n")}}},[es,ed,V,ef]);var eh=(0,_.useId)(),ep="scope-shell-".concat(eh);return(0,ix.ow)(ep,U),(0,iZ.Il)(function(){return[pA.CH.id,{run:function(){el(!0)},scope:ep,bubble:!1}]},[el]),(0,f.tZ)(pU,{shell:es,shellMetadata:q,sendToShellChannel:ed,shellRef:eu,performPaneOperation:M,openSearchAndReplace:K,openAIWithMessage:ee,currentPromptLineNumber:er,isGeneratePromptVisible:ea,onOpenGeneratePrompt:function(){el(!0)},onCloseGeneratePrompt:function(){return el(!1)}})}var pK=n(33081),p$=(0,b.X)({root:[x.l0.pt(16),x.l0.p(8)],center:[x.l0.width("100%"),x.l0.maxWidth(600),x.l0.colWithGap(4),{marginLeft:"auto",marginRight:"auto","@container (min-width: 400px)":[x.l0.maxWidth(800)],"@container (min-width: 1200px)":[x.l0.maxWidth(1400)]}],title:[],content:[x.l0.pt(8),x.l0.colWithGap(16)],search:[x.l0.rowWithGap(8),x.l0.width("100%")],searchInput:[x.l0.flex.grow(1)],packages:[x.l0.colWithGap(16)]}),pQ=function(){};function p0(e){var t=e.openConsole,n=(0,hV.I)().configs,r=(0,L.Z)(function(){return n.find(function(e){return"nix"===e.id})},[n]),i=(0,u._)((0,_.useState)(null),2),o=i[0],a=i[1],l=(0,u._)((0,_.useState)(!1),2),c=l[0],s=l[1],d=null;return d=null!==o?(0,f.tZ)(hO,{results:o,openConsole:t}):c?(0,f.tZ)(hA,{}):(null==r?void 0:r.id)?(0,f.tZ)(hI,{openFile:pQ,openConsole:t},r.id):null,(0,f.tZ)(hj,{config:r,children:(0,f.tZ)(y.G,{css:p$.root,children:(0,f.BX)(y.G,{css:p$.center,children:[(0,f.tZ)(g.h4,{css:p$.title,level:2,variant:"subheadBig",children:"System Dependencies"}),(0,f.BX)(y.G,{css:p$.content,children:[(null==r?void 0:r.packageSearch)?(0,f.tZ)(y.G,{css:p$.search,children:(0,f.tZ)(hB,{css:p$.searchInput,onResults:a,onLoading:s})}):null,(0,f.tZ)(y.G,{css:p$.packages,children:d})]})]})})})}var p1=h.Dy.Object({type:h.Dy.Literal("systemDependencies")}),p2={Content:function(e){var t=e.options;return(0,f.tZ)(p0,{openConsole:function(){t.performPaneOperation({operation:"open",pane:{type:"runnerOutput"},secondary:!0})}})},Icon:function(e){var t=e.size;return(0,f.tZ)(pK.Z,{size:t})},getTitle:function(){return"System Dependencies"},decode:function(e){return p.B4.Decode(p1,e)}},p8=n(31105),p4=h.Dy.Object({type:h.Dy.Literal("unitTests")}),p3={Content:function(e){var t=e.options,n=(0,pn.nC)(),r=(0,k.dr)();function i(){var e=n().find(function(e){var t=(0,u._)(e,2);return"runnerOutput"===(t[0],t[1].type)});if(e)return e[0]}return(0,f.tZ)(y.G,{css:[x.l0.p(8),P.F3],children:(0,f.tZ)(p8.Z,{getRunnerOutput:function(){var e=i();if(e||t.performPaneOperation({operation:"open",secondary:!0,pane:{type:"runnerOutput"}}),e=i()){var n=r(e);if((null==n?void 0:n.type)==="runnerOutput")return n}}})})},Icon:function(e){var t=e.size;return(0,f.tZ)(rl.Z,{size:t})},getTitle:function(){return"Unit Tests"},decode:function(e){return p.B4.Decode(p4,e)}},p5=n(76999),p6=n.n(p5),p9=n(58130),p7=n(47001),me=n(86612),mt=n(31811);function mn(){var e=(0,ex._)(["\n  query WorkspaceVncOutput($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        slug\n        owner {\n          ... on Team {\n            id\n            username\n          }\n          ... on User {\n            id\n            username\n          }\n        }\n      }\n    }\n  }\n"]);return mn=function(){return e},e}var mr={},mi=(0,eC.Ps)(mn());(gB=gJ||(gJ={})).Connecting="Connecting",gB.Connected="Connected",gB.Disconnected="Disconnected",gB.Errored="Errored";var mo="VNC_PASSWORD";function ma(e){var t,r,i,o,a,l,c,s,d,h,p,m=e.fs,v=e.container,g=(0,u._)((0,_.useState)(null),2),y=g[0],b=g[1],w=(0,u._)((0,_.useState)(void 0),2),x=w[0],C=w[1],S=(0,u._)((0,_.useState)(!1),2),k=S[0],E=S[1],T=(0,u._)((0,_.useState)("Connecting"),2),R=T[0],I=T[1],D=(0,u._)((0,_.useState)(null),2),G=D[0],B=D[1],P=(0,u._)((0,_.useState)(!1),2),A=P[0],N=P[1],L=(0,u._)((0,_.useState)(!1),2),O=L[0],M=L[1],X=(0,u._)((0,_.useState)(null),2),F=X[0],W=X[1],H=(0,_.useRef)(0),V=(0,_.useRef)(!1),z=(0,tQ.P5)({controlName:"flag-vnc-error-status",logFlagToAnalytics:!1}),j=(0,tQ.P5)({controlName:"flag-vnc-dash-url",logFlagToAnalytics:!1}),q=(0,aC.useRouter)().pathname,Y=(p=null==(h=(null==(d=(r={skip:({skip:!(j&&("/replEnvironmentDesktop"===q||"/replEnvironmentMobile"===q)&&!(0,mt.Z)())}).skip,variables:{replId:(0,eZ.Z)()}},i=(0,U._)({},mr,r),eS.a(mi,i)).data)?void 0:d.repl.__typename)==="Repl"?d.repl:null)?void 0:null===(t=h.owner)||void 0===t?void 0:t.username,h&&p&&!(h.slug.length+p.length+2>63)?(a=(o={username:p,replSlug:h.slug}).replSlug,l=o.username,c=(0,mt.Z)()?p9.js:p9.ck,s=(0,p9.mZ)(c),"".concat(s,"//").concat(a,"--").concat(l,".").concat(c)):null),J=(0,me.Z)(v);J&&(Y=J.replace("http","ws")),(0,nw.j)(nw.U3.VNC_OPENED),(0,_.useEffect)(function(){return V.current=!0,function(){V.current=!1}},[]),(0,_.useEffect)(function(){if(Y){if(v.getConnectionState()===p7.em.CONNECTED){if(!Y)return;W(Y);return}return v.onConnectionStateChanged(function(e){e===p7.em.CONNECTED&&Y&&W(Y)})}},[v,Y]),(0,_.useEffect)(function(){if(!Y){if(v.getConnectionState()===p7.em.CONNECTED){v.getVncUrl().then(function(e){return W(e)});return}return v.onConnectionStateChanged(function(e){e===p7.em.CONNECTED&&v.getVncUrl().then(function(e){return W(e)})})}},[v,Y]);var K=(0,u._)((0,_.useState)(null),2),$=K[0],Q=K[1],ee=(0,_.useRef)(function(){return null});(0,_.useEffect)(function(){ee.current()},[$]);var et=(0,cR.Z)(function(e){return Q(e.width&&e.height?{width:e.width,height:e.height}:null)},{type:"throttle",wait:100}),en=(0,_.useRef)(function(e){});(0,_.useEffect)(function(){en.current(O)},[O]),(0,_.useEffect)(function(){if(!y){var e=!1;return n.e(994).then(n.bind(n,30994)).then(function(t){e||b(t)}),function(){e=!0}}},[y]),(0,_.useEffect)(function(){z||"Disconnected"!==R||setTimeout(function(){I("Connecting")},Math.random()*(Math.pow(2,H.current)-1)*1e3)},[R,z]),(0,_.useEffect)(function(){if(z&&"Disconnected"===R){var e=setTimeout(function(){I("Connecting")},Math.random()*(Math.pow(2,H.current)-1)*1e3);return function(){clearTimeout(e)}}},[R,z]);var er=(0,eZ.Z)();(0,_.useEffect)(function(){if(F&&G&&y&&"Connecting"===R){H.current++;var e=y.default,t=v.getConnectionMetadata(),n={credentials:{username:null==t?void 0:t.token,password:x||""}};(0,nw.j)(nw.U3.VNC_CONNECTED);var r=new e(G,F,n);r.scaleViewport=!0,r.resizeSession=!0;var i=function(){H.current=0,I("Connected")},o=function(e){var t=e.detail.capabilities.audio;N(void 0!==window.MediaSource&&!!t)},a=function(e){if(ee.current=function(){return null},en.current=function(e){},r.removeEventListener("securityfailure",l),r.removeEventListener("disconnect",a),r.removeEventListener("capabilities",o),r.removeEventListener("connect",i),z&&!e.detail.clean){var t=v.getConnectionMetadata(),n=t?(0,p9.he)(t.token):null;(0,nw.j)(nw.U3.VNC_ERRORED,{vncUrl:F,replId:er,cluster:null==n?void 0:n.cluster}),I("Errored");return}I("Disconnected")},l=function(){var e,t=function(){E(!0)};(e=(0,ts._)(function(){var e,n,r;return(0,tu.Jh)(this,function(i){switch(i.label){case 0:return[4,m.readFile(".env")];case 1:if((e=i.sent()).error||(n=e.content.toString("utf8"),!(mo in(r=cY.Z.parse(n)))))return t(),[2];return C(r[mo]),[2]}})}),function(){return e.apply(this,arguments)})().catch(function(e){return tf.Tb(e)})};return r.addEventListener("connect",i),r.addEventListener("capabilities",o),r.addEventListener("disconnect",a),r.addEventListener("securityfailure",l),ee.current=function(){return r._windowResize()},N(!1),M(!1),en.current=function(t){t?((0,nw.j)(nw.U3.VNC_AUDIO_ENABLED),r.enableAudio(2,window.MediaSource.isTypeSupported("audio/webm;codecs=opus")?e.audioCodecs.OpusWebM:e.audioCodecs.MP3,32768)):r.disableAudio()},function(){V.current||(ee.current=function(){return null},en.current=function(e){},r.removeEventListener("securityfailure",l),r.removeEventListener("disconnect",a),r.removeEventListener("capabilities",o),r.removeEventListener("connect",i),r.disconnect())}}},[y,G,v,F,m,x,R,z,er]);var ei="vnc-output-".concat(R.toLowerCase());return(0,f.BX)("div",{className:"jsx-612fb0831fb3a82c vnc",children:[A?(0,f.BX)("label",{className:"jsx-612fb0831fb3a82c vnc-audio",children:["\uD83C\uDFA7"," ",(0,f.tZ)("input",{type:"checkbox",checked:O,onChange:function(e){return M(e.target.checked)},className:"jsx-612fb0831fb3a82c"})]}):null,(0,f.tZ)("div",{ref:function(e){et(e),B(e)},"data-cy":ei,className:"jsx-612fb0831fb3a82c vnc-target"}),"Connecting"===R||"Disconnected"===R?(0,f.tZ)("div",{className:"jsx-612fb0831fb3a82c vnc-overlay",children:(0,f.tZ)(Z.Z,{size:32})}):null,"Errored"===R?(0,f.tZ)(mc,{vncUrl:F,onRetry:function(){return I("Connecting")}}):null,(0,f.tZ)(rE.u,{isOpen:k,onRequestClose:function(){return E(!1)},children:(0,f.tZ)(h1.Z,{prompt:"Password",desc:"The output is password protected, please input it",placeholder:"password",type:"text",onCancel:function(){return E(!1)},onConfirm:function(e){C(e),E(!1)}})}),(0,f.tZ)(p6(),{id:"612fb0831fb3a82c",children:".vnc.jsx-612fb0831fb3a82c{position:relative}.vnc.jsx-612fb0831fb3a82c,.vnc-target.jsx-612fb0831fb3a82c{height:100%;width:100%}.vnc-audio.jsx-612fb0831fb3a82c{position:absolute;bottom:0;right:0;padding:.2em}.vnc-overlay.jsx-612fb0831fb3a82c{top:0;position:absolute;height:100%;width:100%;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;background:rgba(0,0,0,.85);color:var(--white)}"})]})}var ml=(0,b.X)({root:[x.l0.coverContainer,x.l0.center,x.l0.p(16)],inner:[x.l0.colWithGap(8),x.l0.width(250)],diagnosisContent:[x.l0.py(8)]});function mc(e){var t=e.vncUrl,n=e.onRetry,r=null;return t&&(r=(0,f.tZ)(ed.Q,{headerContent:"Diagnosis",children:(0,f.tZ)(y.G,{css:ml.diagnosisContent,children:(0,f.tZ)(nC.ZP,{children:"If you see a browser error, it's possible that your ISP have security settings blocking the URL. Please contact your ISP and ask them to unblock the URL above. Here are the support links for common ISPs:\n- [Xfinity](https://www.xfinity.com/support/articles/report-blocked-website)\n- [Spectrum.net](https://www.spectrum.net/support/forms/unblock_site)\n"})})})),(0,f.tZ)(y.G,{css:ml.root,children:(0,f.BX)(y.G,{css:ml.inner,children:[(0,f.tZ)(rT.E,{colorway:"warning",text:"There was an error connecting to the server"}),r,(0,f.tZ)(W.zx,{iconLeft:(0,f.tZ)(n1.Z,{}),text:"Try again",onClick:n})]})})}var ms=h.Dy.Object({type:h.Dy.Literal("vnc")}),mu={Content:function(){return(0,f.tZ)(md,{})},Icon:function(e){var t=e.size;return(0,f.tZ)(du.Z,{size:t})},getTitle:function(){return"Output"},decode:function(e){return p.B4.Decode(ms,e)}};function md(){var e=(0,C.Z)(),t=e.fs,n=e.container;return(0,f.tZ)(y.G,{css:[x.l0.flex.growAndShrink(1)],children:(0,f.tZ)(ma,{fs:t,container:n})})}var mf=n(62393),mh=n(87279),mp=n(12621),mm=n(4498),mv=n(87659),mg=n(97631);function my(){var e=(0,ex._)(["\n  query AdminPanelGitView {\n    currentUser {\n      id\n      gitHubInfo {\n        accessToken\n        installations {\n          id\n          type\n          avatarUrl\n          name\n        }\n        userInfo {\n          name\n          email\n          avatarUrl\n        }\n      }\n    }\n  }\n"]);return my=function(){return e},e}var mb={},mw=(0,eC.Ps)(my());function mZ(e){var t=e.event,n=t.input,r=t.output,i=t.error,o=t.start,a=t.end,l=t.cached,c=(0,u._)((0,_.useState)(!0),2),s=c[0],d=c[1],h=(0,_.useCallback)(function(){return d(function(e){return!e})},[]),p="bash"===n[0]&&"-c"===n[1]?n.slice(2).join(" "):n.join(" "),m=r.trimEnd();return(0,f.BX)(y.G,{css:[(0,mv.ec)(i?"negative":"positive"),l?{opacity:.75}:void 0,x.l0.borderRadius(8)],children:[(0,f.BX)(y.G,{onClick:h,onKeyDown:function(e){("Enter"===e.key||" "===e.key)&&h()},tabIndex:0,css:[x.l0.rowWithGap(4),x.l0.justify.spaceBetween,x.l0.py(4),x.l0.px(8),x.l0.font.code,x.l0.cursor.pointer],children:[(0,f.BX)("span",{css:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:["$ ",p]}),(0,f.BX)("span",{css:[x.l0.color.foregroundDimmer,x.l0.flex.shrink(0)],children:[i?(0,f.tZ)("span",{css:[x.l0.mr(16)],children:i}):null,l?(0,f.tZ)("span",{children:"CACHED"}):(0,f.BX)("span",{children:[a-o," ms"]})]})]}),s?null:(0,f.tZ)(y.G,{css:[x.l0.px(2),x.l0.pb(2),x.l0.borderRadius(0,0,8,8)],children:(0,f.tZ)(H.Tg,{elevated:!0,css:[x.l0.p(8),x.l0.borderRadius(8)],children:(0,f.tZ)(mm.Z,{code:m})})})]})}var mx=n(24463),mC=n(88994),mS=n(61155);function mk(e){var t=e.t,n=e.children;return(0,f.BX)("span",{css:{display:"flex",alignItems:"flex-start",columnGap:"0.5rem"},children:[(0,f.BX)(g.xv,{css:{minWidth:"8em"},multiline:!1,children:[t,":"," "]}),(0,f.tZ)("span",{children:n})]})}var m_=n(98463),mE=n(87271),mT=_.memo(function(e){var t,n=e.log,r=e.filters,i=e.timeRef,o=e.setTimeRef,a=r.highlightOnly&&(0,mE.cF)(n,r),l=null!==(t=n.cmd.channel)&&void 0!==t?t:0,c=(0,_.useMemo)(function(){var e=(0,U._)({},n.cmd);return delete e.channel,e},[n]),s=JSON.stringify(c,null,2),d=i?n.timestamp-i:n.timestamp,h=(0,u._)((0,mS.Z)(!0),2),p=h[0],m=h[1];return(0,f.BX)(y.G,{css:[x.l0.my(4),x.l0.mx(4)],children:[(0,f.tZ)(y.G,{role:"button",onClick:m,onKeyDown:m,tabIndex:0,css:[a?x.l0.backgroundColor.accentPositiveDimmer:null,x.l0.flex.row,x.l0.rowWithGap(4),{"&:hover":{cursor:"pointer",".link":{textDecoration:"underline"}}}],children:(0,f.BX)(y.G,{css:[x.l0.flex.grow(1),x.l0.rowWithGap(4),{maxWidth:"100%"}],children:[(0,f.tZ)(g.xv,{className:"icon",multiline:!1,children:"in"===n.dir?(0,f.tZ)(y.G,{css:x.l0.color.greenStrongest,children:""}):"out"===n.dir?(0,f.tZ)(y.G,{css:x.l0.color.redStrongest,children:""}):(0,f.tZ)(y.G,{css:x.l0.color.magentaStrongest,children:""})}),(0,f.tZ)(g.xv,{className:"link",multiline:!1,children:(0,f.BX)("code",{children:["#",l," - ",n.channel.service,n.channel.name?"::".concat(n.channel.name):""]})}),(0,f.tZ)(g.xv,{css:[x.l0.flex.growAndShrink(1),{opacity:.5}],multiline:!1,children:(0,f.tZ)("code",{style:{overflow:"hidden",textOverflow:"ellipsis"},children:s})}),null!=d&&(0,f.tZ)(y.G,{onClick:function(){o(n.timestamp)},css:{opacity:.5},children:(0,f.tZ)(g.xv,{css:[x.l0.fontSize(13),{cursor:"pointer"}],multiline:!1,children:n.timestamp===i?"(reference)":(0,f.BX)(f.HY,{children:[d.toFixed(0)," ms"]})})})]})}),!p&&(0,f.tZ)(f.HY,{children:void 0!==c&&(0,f.tZ)(m_.g,{name:"cmd",src:c})})]})}),mR=(0,_.memo)(function(e){var t=e.logs,n=e.filters,r=e.timeRef,i=e.setTimeRef,o=(0,_.useRef)(null),a=(0,ne.MG)({count:t.length,getScrollElement:function(){return o.current},estimateSize:function(){return 28},overscan:10});return(0,f.BX)("div",{ref:o,className:"log-list",children:[(0,f.tZ)("div",{style:{height:"".concat(a.getTotalSize(),"px"),width:"100%",position:"relative"},children:a.getVirtualItems().map(function(e){return(0,f.tZ)("div",{"data-index":e.index,ref:a.measureElement,style:{position:"absolute",top:0,left:0,width:"100%",transform:"translateY(".concat(e.start,"px)")},children:(0,f.tZ)(mT,{log:t[e.index],filters:n,timeRef:r,setTimeRef:i})},e.key)})}),(0,f.tZ)("div",{className:"bottom-anchor"})]})}),mI=function(e){var t=e.filters,n=e.updateFilters;return(0,f.BX)(y.G,{css:x.l0.colWithGap(4),children:[(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Regex (regex,flags):"}),(0,f.tZ)(X.II,{id:"regex",onChange:function(e){var t=null;if(e.currentTarget.value){var r=(0,u._)(e.currentTarget.value.split(","),2),i=r[0],o=r[1];try{t=new RegExp(i,o)}catch(e){}}n({regexp:t})},placeholder:"\\w+,gi"}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Channel (comma separated ids, clear to reset)"}),(0,f.tZ)(X.II,{id:"channels",onChange:function(e){n({channels:e.currentTarget.value.split(",").map(function(e){return e.trim()}).map(Number).filter(function(e){return!isNaN(e)})})},placeholder:"1,2,3"}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Directions:"}),(0,f.tZ)(ax.E,{css:x.l0.rowWithGap(16),name:"direction",value:t.direction,onChange:function(e){var t=e.target.value;n({direction:"in"===t||"out"===t||""===t?t:""})},children:[{val:"",text:"Both"},{val:"in",text:"In"},{val:"out",text:"Out"}].map(function(e){return(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8)],children:[(0,f.tZ)(ax.Y,{id:e.val,value:e.val}),(0,f.tZ)("label",{htmlFor:e.val,children:e.text})]},e.val)})}),(0,f.tZ)(g.xv,{variant:"subheadDefault",multiline:!1,children:"Filter style:"}),(0,f.tZ)(ax.E,{css:x.l0.rowWithGap(16),name:"filter-style",value:t.highlightOnly?"highlight":"filter",onChange:function(e){return n({highlightOnly:"highlight"===e.target.value})},children:[{val:"highlight",text:"Highlight"},{val:"filter",text:"Filter"}].map(function(e){return(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8)],children:[(0,f.tZ)(ax.Y,{id:e.val,value:e.val}),(0,f.tZ)("label",{htmlFor:e.val,children:e.text})]},e.val)})})]})},mD=n(17867),mG=n(11516),mB=n(16835),mP=n(50831),mA=n(29358),mN=n(97703),mL=n(96298);function mU(){var e=(0,ex._)(["\n  fragment AdminPanelRepl on Repl {\n    id\n    title\n    description\n    isProject\n    isPrivate\n    timeCreated\n    timeUpdated\n    slug\n    url\n    language\n    user {\n      id\n    }\n    config {\n      isServer\n      isVnc\n    }\n    isRenamed\n    isProjectFork\n    folderId\n    isOwner\n    origin {\n      id\n    }\n    source {\n      release {\n        id\n        repl {\n          id\n          url\n          templateLabel\n        }\n      }\n    }\n  }\n"]);return mU=function(){return e},e}function mO(){var e=(0,ex._)(["\n  query AdminPanelReplView($replId: String!) {\n    repl(id: $replId) {\n      ...AdminPanelRepl\n    }\n  }\n  ","\n"]);return mO=function(){return e},e}var mM={},mX=(0,eC.Ps)(mU()),mF=(0,eC.Ps)(mO(),mX),mW=n(49500),mH=n(47726),mV=n(2689);function mz(e){var t=e.sessionId,n=(0,u._)((0,_.useState)(!1),2),r=n[0],i=n[1],o=(0,u._)((0,_.useState)(""),2),a=o[0],l=o[1],c=(0,u._)((0,_.useState)(!1),2),s=c[0],d=c[1],h=(0,ao.Z)().showConfirm,p=(0,aG.U)();return null==t?(0,f.tZ)(y.G,{children:(0,f.tZ)(g.xv,{multiline:!1,children:"Something went wrong... no RUM session found... Try refreshing the page"})}):(0,f.BX)(y.G,{css:[x.l0.colWithGap(8)],children:[(0,f.BX)(g.xv,{variant:"small",multiline:!1,children:["RUM Session ID: ",t]}),(0,f.tZ)(g.xv,{variant:"headerDefault",multiline:!1,children:"Submit an Issue"}),(0,f.BX)(y.G,{css:[x.l0.colWithGap(16)],children:[(0,f.tZ)(X.B,{id:p("message"),placeholder:"What can we do better?",value:a,onChange:function(e){return l(e.target.value)},disabled:r}),(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8)],children:[(0,f.tZ)(oU.X,{id:p("issueInRecording"),checked:s,onChange:function(e){return d(e.target.checked)}}),(0,f.tZ)("label",{htmlFor:p("issueInRecording"),children:(0,f.tZ)(g.xv,{multiline:!1,children:"Issue is demoed in recording"})})]}),(0,f.tZ)(W.zx,{onClick:function(){var e=uL()();i(!0),(0,mV.fc)({name:"replitOnReplit:issue",context:{message:a,issueInRecording:s,customEventId:e}}),h("Issue submitted! Have a cookie \uD83C\uDF6A",5e3),setTimeout(function(){i(!1),l(""),d(!1)},5e3)},text:"Submit",disabled:r||0===a.trim().length,colorway:"primary"})]})]})}var mj=n(1406),mq={"Session state":function(){var e=(0,pZ.Yz)();return(0,f.tZ)(mN.Z,{json:e})},"File context":function(){var e=(0,pZ.Tt)(),t=(0,A.Bx)(),n=(0,u._)((0,pM.Ni)(),1)[0],r=(0,pZ.Bk)(),i=(0,C.Z)(),o=i.fs,a=i.dotReplit,l=(0,mj.G)(o,a),c=(0,u._)((0,_.useState)(null),2),s=c[0],d=c[1];return(0,_.useEffect)(function(){var i=!1;function o(){return(o=(0,ts._)(function(){var o;return(0,tu.Jh)(this,function(a){switch(a.label){case 0:return[4,l({model:"advanced"===n&&r()?pO.BY.ADVANCED:pO.BY.BASIC,filePreferences:e,recentFiles:t})];case 1:if(o=a.sent(),i)return[2];return d(o),[2]}})})).apply(this,arguments)}return function(){o.apply(this,arguments)}(),function(){i=!0}},[t,e,n,r,l]),(0,f.tZ)(mN.Z,{json:s})}};(gP=gK||(gK={})).Repl="repl",gP.Logs="logs",gP.LSP="lsp",gP.AI="ai",gP.GhostwriterChat="aiChat",gP.AST="ast",gP.Git="git",gP.History2="history2",gP.Metadata="metadata",gP.Override="override",gP.DDRum="rum";var mY=(g$={},(0,eP._)(g$,"repl",function(){var e,t,n,r,i,o,a,l,c,s=(0,eZ.Z)(),u=(e=(0,U._)({},mM,{variables:{replId:s}}),eS.a(mF,e)).data,d=(0,pF.h)(),h=(null==u?void 0:u.repl.__typename)==="Repl"?JSON.parse(JSON.stringify(u.repl)):void 0;return h&&(delete h.__typename,null===(t=h.user)||void 0===t||delete t.__typename,null===(n=h.origin)||void 0===n||delete n.__typename,delete h.config.__typename,null===(r=h.source)||void 0===r||delete r.__typename,null===(o=h.source)||void 0===o||null===(i=o.release)||void 0===i||delete i.__typename,null===(c=h.source)||void 0===c||null===(l=c.release)||void 0===l||null===(a=l.repl)||void 0===a||delete a.__typename),(0,f.BX)(y.G,{css:[x.l0.colWithGap(16),x.l0.p(4)],children:[(0,f.tZ)(mL.Z,{replId:s}),(0,f.tZ)("div",{className:"jsx-3187c500f6b377b0",children:h?(0,f.tZ)(mN.Z,{json:h}):null}),(0,f.tZ)(W.zx,{text:"Assign pid2 client to window for testing",onClick:function(){mW.log("window.pid2: ",d),window.pid2=d}}),(0,f.tZ)(p6(),{id:"3187c500f6b377b0",children:"pre.jsx-3187c500f6b377b0{white-space:pre-wrap;word-wrap:break-word}"})]})}),(0,eP._)(g$,"logs",function(e){var t=e.isHidden,n=(0,u._)((0,mS.Z)(!1),2),r=n[0],i=n[1],o=(0,u._)((0,_.useState)(null),2),a=o[0],l=o[1],c=(0,t2.Dv)(mE.Sj),s=(0,u._)((0,t2.KO)(mE.a0),2),d=s[0],h=s[1],p=(0,u._)((0,t2.KO)(mE.ot),2),v=p[0],g=p[1],b=(0,t2.b9)(mE.UB);return t?null:(0,f.BX)(y.G,{css:[x.l0.colWithGap(8)],children:[(0,f.BX)(y.G,{css:[x.l0.colWithGap(8),x.l0.position.sticky,x.l0.top(0),x.l0.px(4),x.l0.pb(8),{"z-index":3},x.l0.backgroundColor.backgroundDefault],children:[(0,f.tZ)(W.zx,{colorway:d?void 0:"positive",onClick:function(){h(function(e){return!e})},text:d?"Stop logging goval":"Start logging goval"}),(0,f.BX)(y.G,{css:[x.l0.rowWithGap(4),x.l0.justify.spaceBetween],children:[(0,f.tZ)(W.zx,{onClick:i,text:r?"Hide filters":"Show filters"}),a?(0,f.tZ)(W.zx,{onClick:function(){return l(null)},text:"Reset Time Ref"}):null,(0,f.tZ)(m.hU,{alt:"Download as JSON",onClick:function(){var e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(c)),t=document.createElement("a");t.setAttribute("href",e);var n=new Date().toISOString();t.setAttribute("download","logs-".concat(n.slice(0,n.indexOf(".")).replaceAll("-","").replaceAll(":",""),".json")),t.click()},size:32,children:(0,f.tZ)(w.Z,{})}),(0,f.tZ)(W.zx,{colorway:"negative",onClick:function(){return b()},text:"Clear logs"})]}),r?(0,f.tZ)(mI,{filters:v,updateFilters:function(e){g((0,U._)({},v,e))}}):null]}),(0,f.tZ)(mR,{logs:c,filters:v,timeRef:a,setTimeRef:l})]})}),(0,eP._)(g$,"lsp",m_.L),(0,eP._)(g$,"ai",mp.ho),(0,eP._)(g$,"aiChat",function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isHidden;return e?null:(0,f.tZ)(y.G,{children:(0,f.BX)(dD.mQ,{children:[(0,f.tZ)(dD.td,{"aria-label":"Tabs",children:Object.keys(mq).map(function(e){return(0,f.tZ)(dD.OK,{children:e},e)})}),(0,f.tZ)(dD.nP,{children:Object.entries(mq).map(function(e){var t=(0,u._)(e,2),n=t[0],r=t[1];return(0,f.tZ)(dD.x4,{children:(0,f.tZ)(r,{})},n)})})]})})}),(0,eP._)(g$,"ast",cv.Z),(0,eP._)(g$,"git",function(){var e,t=(0,u._)((0,_.useState)([]),2),n=t[0],r=t[1],i=(e=(0,U._)({},mb,void 0),eS.a(mw,e)).data,o=(0,dc.Z)(mg.e);return(0,_.useEffect)(function(){o&&r(function(e){return e.length&&e[0].key===o.key?e:[o].concat((0,d._)(e)).slice(0,100)})},[o]),(0,f.BX)(y.G,{css:[x.l0.p(8)],children:[(0,f.BX)(H.Tg,{elevated:!0,css:[x.l0.borderRadius(8),x.l0.p(8),x.l0.mb(8)],children:[(0,f.tZ)("span",{children:"Git Service Connection Info"}),(0,f.tZ)("pre",{children:(null==i?void 0:i.currentUser)?JSON.stringify(i,function(e,t){return"accessToken"===e?"censored":t},2):"No gitHubInfo"})]}),(0,f.tZ)(y.G,{css:[x.l0.colWithGap(4)],children:n.length?n.map(function(e){return(0,f.tZ)(mZ,{event:e},e.key)}):"No events yet..."})]})}),(0,eP._)(g$,"history2",function(){var e=(0,aG.U)()("toggleIsShowingChanges"),t=(0,dc.Z)(ll.BI)(),n=(0,dc.Z)(ll.Jp)(),r=(0,u._)((0,mS.Z)(!1),2),i=r[0],o=r[1];if(!t)return null;var a=t.filePath,l=t.changes,c=t.users,s=t.version,d=t.playing,h=t.count,p=l[s];if(!p)return(0,f.BX)(y.G,{children:[(0,f.BX)("div",{children:["Change at ",s," not found. Here's the state"]}),(0,f.tZ)("pre",{children:JSON.stringify(t,null,2)})]});var m=null==c?void 0:c[p.userId],v=p.timestamp,g=i&&n?function(e,t){try{return(0,mC.ed)(e,t).op}catch(e){return e}}(p.changes,n.state.doc.sliceString(0)):null;return(0,f.BX)(y.G,{css:[x.l0.colWithGap(16),x.l0.p(4)],children:[(0,f.BX)(y.G,{css:[x.l0.colWithGap(4)],children:[(0,f.tZ)(mk,{t:"File",children:(0,f.tZ)("pre",{children:a})}),(0,f.BX)(mk,{t:"Version",children:[s," / ",h-1]}),(0,f.tZ)(mk,{t:"Playing",children:(0,f.tZ)(mx.Z,{children:d?"true":"false"})}),(0,f.tZ)(mk,{t:"Date",children:(0,f.tZ)(no.EK,{date:v})})]}),m?(0,f.BX)(y.G,{children:[(0,f.tZ)(mk,{t:"Author",children:m.username}),(0,f.BX)(y.G,{css:[x.l0.pl(8),x.l0.colWithGap(4)],children:[(0,f.tZ)(mk,{t:"ID",children:m.id}),(0,f.tZ)(mk,{t:"Name",children:m.username}),(0,f.tZ)(mk,{t:"Image",children:(0,f.tZ)("a",{href:m.image,children:m.image})})]})]}):null,(0,f.BX)(y.G,{css:[x.l0.rowWithGap(8),{alignItems:"center"}],children:[(0,f.tZ)(la.Z,{id:e,isOn:i,onChange:o}),(0,f.tZ)("label",{htmlFor:e,children:"Changes"})]}),p?null:"No changes",i&&p?(0,f.tZ)(f.HY,{children:(0,f.BX)(y.G,{children:[(0,f.tZ)(mk,{t:"Changeset",children:(0,f.tZ)("pre",{children:JSON.stringify(p,null,2)})}),n?(0,f.tZ)(f.HY,{children:(0,f.BX)(y.G,{css:[x.l0.mt(4)],children:[(0,f.tZ)(mk,{t:"OT",children:(0,f.tZ)("pre",{children:JSON.stringify(g,null,2)})}),(0,f.tZ)("p",{children:(0,f.BX)("small",{children:["Note that the OT value is translated ",(0,f.tZ)("em",{children:"back"})," to an operational transformation from the CodeMirror changeset."]})})]})}):null]})}):null]})}),(0,eP._)(g$,"metadata",function(){var e=(0,C.Z)().container;(0,mD.Z)(e);var t=e.getConnectionMetadata();if(!t)return(0,f.tZ)("div",{children:"no token yet, wait for connection"});var n=t.token,r=new URL(t.conmanURL).host,i='./conman-repl -t "'.concat(n,'" -u ').concat(r);return(0,f.BX)("div",{className:"jsx-2e9ac5ab034fc317 token-viewer",children:[(0,f.BX)(y.G,{css:x.l0.rowWithGap(2),children:[(0,f.BX)(g.xv,{css:x.l0.flex.shrink(1),multiline:!1,children:["conman Repl command: ",(0,f.tZ)(mx.Z,{children:i})]}),(0,f.tZ)(m.hU,{alt:"Copy to clipboard",onClick:function(){return(0,F.Z)(i)},children:(0,f.tZ)(cq.Z,{})})]}),(0,f.BX)("div",{className:"jsx-2e9ac5ab034fc317",children:["metadata:",(0,f.tZ)("pre",{className:"jsx-2e9ac5ab034fc317",children:JSON.stringify(t,null,2)})]}),(0,f.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,f.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,f.BX)("div",{className:"jsx-2e9ac5ab034fc317",children:["parsed token:",(0,f.tZ)("pre",{className:"jsx-2e9ac5ab034fc317",children:JSON.stringify((0,p9.he)(t.token),null,2)})]}),(0,f.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,f.tZ)("br",{className:"jsx-2e9ac5ab034fc317"}),(0,f.tZ)(p6(),{id:"2e9ac5ab034fc317",children:".token-viewer.jsx-2e9ac5ab034fc317{height:100%;overflow:auto;padding:10px}pre.jsx-2e9ac5ab034fc317{white-space:pre-wrap;word-wrap:break-word}"})]})}),(0,eP._)(g$,"override",function(){var e,t,n=(0,u._)((0,_.useState)(mG.Z.get("gurl","string")||""),2),r=n[0],i=n[1],o=(0,u._)((0,_.useState)(mG.Z.get("pid2Version","string")||""),2),a=o[0],l=o[1],c=(0,u._)((0,_.useState)(""),2),s=c[0],d=c[1],h=u0(),p=""===r?"null":JSON.stringify((0,mB.t)(r),null,2);return(0,f.BX)(y.G,{css:[x.l0.pt(16),x.l0.px(12),x.l0.colWithGap(12)],children:[(0,f.BX)(y.G,{css:[x.l0.colWithGap(12)],children:[(0,f.tZ)(mA.ZP,{label:"Custom pid2 version",placeholder:"pid2 hash (e.g. 76ce274246bb7a07f908076d3a74a0171c3267fb)",value:a,onChange:function(e){return l(e.currentTarget.value)}}),(0,f.BX)("p",{children:[(0,f.tZ)("code",{children:"pid2"})," version:"," ",(0,f.tZ)("code",{children:null!==(t=null!==(e=mG.Z.get("pid2Version","string"))&&void 0!==e?e:"e35892e039b5273c31c4eda656ff3b41702e61ae")&&void 0!==t?t:"dev"})]}),(0,f.BX)(y.G,{css:[x.l0.rowWithGap(12)],children:[(0,f.tZ)(mP.Z,{color:"yellow",onClick:function(){mG.Z.set("pid2Version",a),window.location.reload()},children:"Set pid2Version and reload"}),(0,f.tZ)(mP.Z,{color:"orange",onClick:function(){mG.Z.remove("pid2Version"),window.location.reload()},children:"Unset pid2Version and reload"})]})]}),(0,f.tZ)("hr",{css:[x.l0.my(16),{borderColor:x.TV.outlineDefault}]}),(0,f.BX)(y.G,{css:[x.l0.colWithGap(12)],children:[(0,f.tZ)(mA.ZP,{label:"Custom gurl",placeholder:"ws://localhost:".concat(4560),value:r,onChange:function(e){return i(e.currentTarget.value)}}),(0,f.BX)("pre",{children:["metadata override preview:",p]}),(0,f.BX)(y.G,{css:[x.l0.rowWithGap(12)],children:[(0,f.tZ)(mP.Z,{color:"positive",onClick:function(){mG.Z.set("gurl",r),window.location.reload()},children:"Set gurl and reload"}),(0,f.tZ)(mP.Z,{color:"yellow",onClick:function(){mG.Z.set("gurl","wss://eval.canary.replit.com"),window.location.reload()},children:"Switch to canary & reload"}),(0,f.tZ)(mP.Z,{color:"orange",onClick:function(){mG.Z.remove("gurl"),window.location.reload()},children:"Unset gurl and reload"}),(0,f.tZ)(mP.Z,{color:"red",onClick:function(){mG.Z.set("gurl","ws://localhost:4560"),window.location.reload()},children:"Switch to localhost & reload"})]}),(0,f.tZ)("div",{children:mG.Z.get("gurl","string")?"currently in localStorage: ".concat(mG.Z.get("gurl","string")):'No gurl set in local storage, using default gurl for this user, check "Token" tab for details'}),(0,f.tZ)("p",{children:"Gurl order of precedence:"}),(0,f.BX)("ol",{style:{margin:12},children:[(0,f.tZ)("li",{children:"gurl in localStorage (set above)"}),(0,f.BX)("li",{children:["If in development webapp and a theres a response from",(0,f.tZ)("code",{children:"https://localhost:4563"})," or",(0,f.BX)("code",{children:["http://localhost:",4560]}),", then it will use that."]}),(0,f.BX)("li",{children:["default is ",(0,f.tZ)("code",{children:"wss://eval.<usercluster>.replit.com"})]})]})]}),(0,f.tZ)("hr",{css:[x.l0.my(16),{borderColor:x.TV.outlineDefault}]}),(0,f.BX)(y.G,{css:[x.l0.colWithGap(12)],children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Override Database"}),(0,f.tZ)(mA.ZP,{type:"text",value:s,onChange:function(e){d(e.target.value)}}),(0,f.tZ)(y.G,{css:[x.l0.rowWithGap(8)],children:(0,f.tZ)(mP.Z,{color:"positive",onClick:function(){h(s)},children:"Override Postgres connection string"})})]})]})}),(0,eP._)(g$,"rum",function(){var e,t=null===(e=mH.v.getInternalContext())||void 0===e?void 0:e.session_id,n=mH.v.getInitConfiguration(),r=null!=n&&100===n.sampleRate,i=(0,u._)((0,_.useState)(null!=t),2),o=i[0],a=i[1];return(0,f.tZ)(y.G,{css:[x.l0.colWithGap(16),x.l0.p(4)],children:r?(0,f.BX)(f.HY,{children:[(0,f.tZ)(W.zx,{onClick:o?function(){mH.v.stopSessionReplayRecording(),document.cookie="_dd_s=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",window.location.href=window.location.href.split("?")[0]}:function(){(0,mV.Oo)({name:"replitOnReplit"}),setTimeout(function(){a(!0)},1e3)},text:o?"\uD83D\uDD34 Recording... Click to stop and reload page":"Start Recording",colorway:o?void 0:"primary",css:(0,U._)({},o&&ev.p.backgroundPulse(x.TV.redDimmest,x.TV.redDimmer))}),o?(0,f.tZ)(mz,{sessionId:t}):null]}):(0,f.tZ)(W.zx,{onClick:function(){window.location.href=window.location.href.split("?")[0].split("#")[0]+"?rum=1"},text:"Click to reload and start recording",colorway:"primary"})})}),g$),mJ=Object.values(gK);function mK(e){var t=e.paneOptions,n=(0,u._)((0,_.useState)("repl"),2),r=n[0],i=n[1],o=mJ.map(function(e){return(0,f.tZ)(W.zx,{colorway:e===r?"primary":void 0,onClick:function(){return i(e)},text:e},e)});return(0,f.BX)(H.Tg,{background:"default",css:[x.l0.colWithGap(8),x.l0.p(4),x.l0.height("100%")],children:[(0,f.tZ)(y.G,{css:{flexWrap:"wrap",flexDirection:"row",gap:"4px"},children:o}),(0,f.tZ)(y.G,{css:[x.l0.flex.growAndShrink(1),x.l0.overflow("auto")],children:Object.entries(mY).map(function(e){var n=(0,u._)(e,2),i=n[0],o=n[1];return(0,f.tZ)(y.G,{css:i!==r&&x.l0.display.none,children:"override"===i&&"override"!==r?null:(0,f.tZ)(o,{isHidden:t.isHidden||r!==i})},i)})})]})}var m$=h.Dy.Object({type:h.Dy.Literal("adminPanel")}),mQ={Content:function(e){var t=e.options;return(0,f.tZ)(mK,{paneOptions:t})},Icon:function(e){var t=e.size;return(0,f.tZ)(mh.Z,{color:"red",size:t})},getTitle:function(){return"Debug"},decode:function(e){return p.B4.Decode(m$,e)}},m0=n(73030),m1=n(62624),m2=n(78272);function m8(e){var t=e.text,n=(0,eL._)(e,["text"]),r=(0,_.useRef)(null),i=(0,_.useRef)(t);return(0,_.useEffect)(function(){if(i.current!==t){var e=t.length;!function n(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;requestAnimationFrame(function(){var o=r.current;o&&(o.textContent=t.slice(0,i),i!==e&&n(i+1))})}()}},[t]),(0,_.useEffect)(function(){i.current=t},[t]),(0,f.tZ)(g.xv,(0,O._)((0,U._)({},n),{ref:r,children:t}))}var m4=n(25754),m3=n(51288),m5=n(71498),m6=(0,fu.$)(["fontSize","padding","border"]),m9=m6.cssVars,m7=m6.styleTokens,ve=(0,b.X)({root:[x.l0.rowWithGap(4),x.l0.center,x.l0.flex.growAndShrink(1)],input:[{backgroundColor:"transparent",border:m7.border,fontSize:m7.fontSize,padding:m7.padding},x.l0.flex.growAndShrink(1)]});function vt(e){var t,n,r=(0,u._)((0,_.useState)(e.initialValue),2),i=r[0],o=r[1],a=(0,eY.Z)(e.onCancel),l=(0,fs.Z)(function(){return a.current()},[]),c=(0,_.useRef)(null);(0,_.useEffect)(function(){var e;null===(e=c.current)||void 0===e||e.select()},[]);var s=e.compact?(t={},(0,eP._)(t,m9.border,"0 none"),(0,eP._)(t,m9.fontSize,x.TV.fontSizeSmall),(0,eP._)(t,m9.padding,"0 ".concat(x.TV.space2)),t):(n={},(0,eP._)(n,m9.padding,"".concat(x.TV.space8)),(0,eP._)(n,m9.fontSize,x.TV.fontSizeDefault),n);return(0,f.tZ)(y.G,{style:s,innerRef:l,css:ve.root,tag:"form",onSubmit:function(t){t.preventDefault(),i&&e.onSubmit(i)},children:(0,f.tZ)(X.II,{placeholder:"Name this chat",ref:c,css:ve.input,value:i,onChange:function(e){return o(e.currentTarget.value)},onKeyDown:function(t){"Escape"===t.key&&e.onCancel()}})})}var vn=(0,fu.$)(["sessionBackground","actionsButtonDisplay"]),vr=vn.cssVars,vi=vn.styleTokens,vo=(0,b.X)({loading:[x.l0.coverContainer,x.l0.center],tabList:[x.l0.rowWithGap(4),x.l0.p(8),x.l0.align.center,x.l0.justify.spaceBetween],tabListLeft:[x.l0.viewStyle,x.l0.rowWithGap(2)],tabListRight:{justifySelf:"end"},tab:[x.l0.viewStyle,nn.gU.nofill,x.l0.px(8),x.l0.height(30),x.l0.justify.center,x.l0.borderRadius(4),{"&[data-selected]":{backgroundColor:nn.vb.interactiveBackgroundActive}}],sessions:[x.l0.overflowY("auto"),x.l0.flex.growAndShrink(1),x.l0.px(8)],editTimestamp:[x.l0.px(4)],session:[x.l0.p(4),x.l0.border({direction:"bottom"}),nn.gU.listItem,x.l0.borderRadius(4),(gQ={backgroundColor:vi.sessionBackground},(0,eP._)(gQ,x.BC.canHover,(0,eP._)({},vr.actionsButtonDisplay,"none")),(0,eP._)(gQ,"&:hover",(0,eP._)({},vr.actionsButtonDisplay,"block")),gQ)],emptyState:[x.l0.center,x.l0.p(16)],header:[x.l0.rowWithGap(4),x.l0.height(24)],title:[x.l0.flex.growAndShrink(1)],actionsButton:[{opacity:.5,display:vi.actionsButtonDisplay,"&:hover":{opacity:1}}]});function va(e){var t=e.onClick;return(0,f.BX)(y.G,{style:(0,eP._)({},vr.sessionBackground,x.TV.accentPrimaryDimmest),css:vo.session,onClick:t,children:[(0,f.tZ)(y.G,{css:vo.header,children:(0,f.tZ)(y.G,{css:vo.title,children:(0,f.tZ)(g.xv,{multiline:!1,children:"New Chat"})})}),(0,f.tZ)(g.xv,{multiline:!1,color:"dimmest",variant:"small",children:"just now"})]})}function vl(e){var t,n=e.selected,r=e.onClick,i=e.onRename,o=e.onToggleArchived,a=e.session,l=(0,u._)((0,_.useState)(!1),2),c=l[0],s=l[1],d=(0,m3.av)(),h=d.menuProps,p=d.triggerProps,v=d.open;return c?(0,f.BX)(y.G,{children:[(0,f.tZ)(vt,{initialValue:null!==(t=a.title)&&void 0!==t?t:"",onCancel:function(){return s(!1)},onSubmit:function(e){i(e),s(!1)}}),(0,f.tZ)(y.G,{css:vo.editTimestamp,children:(0,f.tZ)(no.EK,{textColor:"dimmest",textVariant:"small",date:a.created})})]}):(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,(0,O._)((0,U._)({style:n?(0,eP._)({},vr.sessionBackground,x.TV.accentPrimaryDimmest):void 0,css:vo.session,onClick:r},p),{children:[(0,f.BX)(y.G,{css:vo.header,children:[(0,f.tZ)(y.G,{css:vo.title,children:(0,f.tZ)(m8,{multiline:!1,text:a.title||"Untitled"})}),(0,f.tZ)(m.hU,{css:vo.actionsButton,alt:"Actions",tooltipHidden:!0,onClick:function(e){var t=e.target.getBoundingClientRect();v({x:t.x,y:t.y})},children:(0,f.tZ)(m5.Z,{})})]}),(0,f.tZ)(no.EK,{textColor:"dimmest",textVariant:"small",date:a.created})]})),(0,f.BX)(m3.xV,(0,O._)((0,U._)({},h),{children:[(0,f.tZ)(m3.Zo,{onClick:function(){return s(!0)},children:"Rename"}),(0,f.tZ)(m3.Zo,{onClick:o,children:a.archived?"Unarchive":"Archive"})]}))]})}function vc(){return(0,f.tZ)(y.G,{css:vo.emptyState,children:(0,f.tZ)(g.xv,{color:"dimmest",children:"No chats"})})}function vs(e){var t=e.currentSessionId,n=e.archivedOnly,r=(0,pZ.mL)({archivedOnly:n}),i=r.sessions,o=r.loading;return o&&!i.length?(0,f.tZ)(y.G,{css:vo.loading,children:(0,f.tZ)(Z.Z,{})}):(0,f.BX)(y.G,{css:vo.sessions,children:[!o&&0===i.length&&e.archivedOnly?(0,f.tZ)(vc,{}):null,e.archivedOnly||0!==i.length?null:(0,f.tZ)(va,{onClick:function(){return e.onNewSessionClick()}}),i.map(function(n){return(0,f.tZ)(vl,{session:n,selected:n.id===t,onClick:function(){return e.onSessionClick(n.id)},onToggleArchived:function(){return e.updateSession(n.id,{archived:!n.archived})},onRename:function(t){return e.updateSession(n.id,{title:t})}},n.id)})]})}var vu=[{title:"Chats",archivedOnly:!1},{title:"Archived",archivedOnly:!0}];function vd(e){var t=(0,u._)((0,_.useState)(vu[0].title),2),n=t[0],r=t[1];return(0,f.BX)(m4.mQ,{selectedKey:n,onSelectionChange:r,children:[(0,f.BX)(y.G,{css:vo.tabList,children:[(0,f.tZ)(m4.td,{"aria-label":"Chats",css:vo.tabListLeft,children:vu.map(function(e){var t=e.title;return(0,f.tZ)(m4.OK,{id:t,css:vo.tab,children:(0,f.tZ)(g.xv,{color:"dimmer",children:t})},t)})}),(0,f.tZ)(y.G,{css:vo.tabListRight,children:(0,f.tZ)(m.hU,{alt:"New chat",onClick:function(){n!==vu[0].title&&r(vu[0].title),e.onNewSessionClick()},children:(0,f.tZ)(na.Z,{})})})]}),vu.map(function(t){var n=t.title,r=t.archivedOnly;return(0,f.tZ)(m4.x4,{id:n,children:(0,f.tZ)(vs,(0,O._)((0,U._)({},e),{archivedOnly:r,updateSession:e.updateSession}))},n)})]})}var vf=n(82897),vh=n(45086),vp=n(29128),vm=n(39511),vv=n(475),vg=n(7612),vy=eA.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:0}}),vb=new cp.j(function(e){return vy.of(e)}),vw={marker:"cm-empty-state-dom"},vZ=eO.tk.theme((0,eP._)({},".".concat(vw.marker),{backgroundColor:x.TV.redDefault,opacity:"0.2"})),vx=eA.QQ.define({create:function(e){return e.doc.length},update:function(e,t){return t.state.doc.length}}),vC=function(e){return Math.max(e.doc.length-e.facet(vy),0)},vS=eA.QQ.define({create:vC,update:function(e,t){return(0,vg.a)(t,"doc",vy)?vC(t.state):e},provide:function(e){return[vx,vZ,(0,eO.EY)({above:!1,update:function(t){return(0,vg.a)(t,e)},markers:function(t){var n=t.state.field(e);if(0===n)return[];var r=t.state.doc.length;return eO.dc.forRange(t,vw.marker,eA.jT.range(r-n,r))}})]}}),vk=(0,b.X)({charLimit:[x.l0.color.redDefault]});function v_(e){var t=e.view,n=(0,vh.IK)(t,vS);return n?(0,f.tZ)(g.xv,{variant:"small",css:vk.charLimit,children:n}):null}var vE=n(73367),vT=n(69119),vR=n(1415),vI=n(43151),vD=n(57),vG=n(34335),vB=n(25202),vP=n(76673),vA=n(79217),vN=n(17225),vL=(0,b.X)({popover:[x.l0.borderRadius(4),x.l0.border({color:x.TV.outlineDefault}),x.l0.overflow("hidden"),x.l0.maxWidth(260)]}),vU=(0,b.X)({root:[nn.gU.listItem,x.l0.p(4),x.l0.colWithGap(2)],content:[x.l0.rowWithGap(8),x.l0.align.center],left:[x.l0.flex.growAndShrink(1),x.l0.rowWithGap(4),x.l0.align.center,{fontSize:x.TV.fontSizeSmall}],warning:[{color:x.TV.accentNegativeDefault}],dir:[{opacity:.6},x.l0.flex.shrink(100)]});function vO(e){var t=e.path,n=e.highlighted,r=e.ranges,i=e.status,o=n?{backgroundColor:nn.vb.interactiveBackgroundActive}:void 0,a=i?({included:(0,f.tZ)(rl.Z,{}),overflowing:(0,f.tZ)(rn.Z,{}),truncated:(0,f.tZ)(rn.Z,{}),unsupported:(0,f.tZ)(rn.Z,{})})[i]:null,l=(0,vN.Q1)({path:t,ranges:null!=r?r:[]}),c=l.directory,s=l.filename;return(0,f.BX)(y.G,{css:vU.root,style:o,children:[(0,f.BX)(y.G,{css:vU.content,style:o,children:[(0,f.BX)(y.G,{css:vU.left,style:o,children:[(0,f.tZ)(v.Z,{path:t,size:16}),(0,f.tZ)(vT.x,{text:s.text,highlight:s.ranges,dimmed:!n}),c?(0,f.tZ)(y.G,{color:"dimmest",css:vU.dir,children:(0,f.tZ)(vT.x,{text:c.text+"/",highlight:c.ranges,dimmed:!n})}):null]}),a]}),"overflowing"===i||"truncated"===i?(0,f.tZ)(g.xv,{css:vU.warning,variant:"small",children:"Exceeds file memory"}):null,"unsupported"===i?(0,f.tZ)(g.xv,{css:vU.warning,variant:"small",children:"File not supported"}):null]})}var vM=(0,fu.$)(["iconColor","placeholderColor","itemTransform","inputBorderRadius","inputBorder"]),vX=vM.cssVars,vF=vM.styleTokens,vW=(0,b.X)({root:[x.l0.width(240),x.l0.maxHeight(200)],inputRow:[x.l0.position.relative,(g1={},(0,eP._)(g1,vX.iconColor,x.TV.foregroundDimmest),(0,eP._)(g1,vX.placeholderColor,x.TV.foregroundDimmer),(0,eP._)(g1,":focus-within, :hover",(g0={},(0,eP._)(g0,vX.iconColor,x.TV.foregroundDimmer),(0,eP._)(g0,vX.placeholderColor,x.TV.foregroundDimmest),g0)),g1)],searchIcon:[x.l0.pl(6),x.l0.coverContainer,x.l0.align.start,x.l0.justify.center,{color:vF.iconColor,pointerEvents:"none"}],input:[nn.gU.nofill,x.l0.p(4),x.l0.pl(24),{borderRadius:vF.inputBorderRadius,fontSize:x.TV.fontSizeSmall,margin:"-1px -1px 0",cursor:"text","::placeholder":{color:vF.placeholderColor},"@media (hover: hover)":{":not([disabled]):focus":{outline:"0 none"}}}],header:[x.l0.rowWithGap(2),x.l0.px(4),x.l0.height(24),x.l0.align.center],unselectButton:[x.l0.reset.button,nn.gU.nofill,x.l0.p(2),{fontSize:x.TV.fontSizeSmall}],menu:[x.l0.flex.growAndShrink(1),{overflow:"auto"}],item:[{transform:vF.itemTransform,position:"absolute",top:0,left:0,width:"100%"}]});function vH(e,t){return t.status&&!e.status?1:e.status&&!t.status?-1:"included"===t.status&&"included"!==e.status?1:"included"===e.status&&"included"!==t.status?-1:0}function vV(e){var t,n,r,i,o,a,l,c=e.fileContextInclusions,s=e.placement,d=void 0===s?"bottom":s,h=e.findFiles,p=e.overscan,m=e.onChange,v=(0,_.useRef)(null),b=(0,u._)((0,_.useState)(""),2),w=b[0],C=b[1],S=(r=(n=(0,u._)((0,_.useState)({loading:!0,error:null,items:null}),2))[0],i=n[1],(o=(0,_.useRef)(null)).current||(o.current=(0,vB.Z)((t=(0,ts._)(function(e){var t;return(0,tu.Jh)(this,function(n){switch(n.label){case 0:return[4,h(e)];case 1:return t=n.sent(),(0,_.startTransition)(function(){i(null!==t.error?{error:t.error,loading:!1,items:null}:{items:t.files,total:t.total,error:null,loading:!1})}),[2]}})}),function(e){return t.apply(this,arguments)}),{wait:40})),a=(0,_.useCallback)(function(e){var t;return null===(t=o.current)||void 0===t?void 0:t.call(o,e).catch(function(){})},[]),(0,_.useEffect)(function(){return a(""),function(){try{var e;null===(e=o.current)||void 0===e||e.cancel()}catch(e){}}},[a]),{files:r.items,loading:r.loading,error:r.error,total:r.total,update:a}),k=S.files,E=S.total,T=S.loading,R=S.error,I=S.update,D=(0,_.useRef)(null),G=(0,eY.Z)(w),B=(0,_.useMemo)(function(){var e=new Map(c.map(function(e){return[e.path,e.inclusionStatus]})),t=null==k?void 0:k.map(function(t){var n=t.path;return{path:n,ranges:t.ranges,status:e.get(n)}});if(!t)return null;if(D.current)return(0,vP.Z)(t,{existing:D.current,getKey:function(e){return e.path}});if(G.current)return t;var n=t.sort(vH);return D.current=n,n},[k,c,G]),P=(0,_.useMemo)(function(){var e;return null!==(e=null==B?void 0:B.filter(function(e){return e.status}))&&void 0!==e?e:[]},[B]),A=(0,vD.Kb)({inputValue:w,items:null!=B?B:[],isOpen:!0,defaultHighlightedIndex:0,stateReducer:function(e,t){var n=t.changes;switch(t.type){case vD.Kb.stateChangeTypes.InputKeyDownEnter:case vD.Kb.stateChangeTypes.ItemClick:return(0,uU.Uy)(n,function(t){t.highlightedIndex=e.highlightedIndex});default:return n}},onHighlightedIndexChange:function(e){void 0!==e.highlightedIndex&&-1!==e.highlightedIndex&&L.getVirtualItems()[e.highlightedIndex]&&L.scrollToIndex(e.highlightedIndex)},onStateChange:function(e){switch(e.type){case vD.Kb.stateChangeTypes.InputKeyDownEnter:case vD.Kb.stateChangeTypes.ItemClick:if(!e.selectedItem)break;var t,n,r,i=P.includes(e.selectedItem)?"exclude":"include";m({path:e.selectedItem.path,preference:i}),null===(r=v.current)||void 0===r||r.select();break;case vD.Kb.stateChangeTypes.InputChange:C(null!==(t=e.inputValue)&&void 0!==t?t:""),I(null!==(n=e.inputValue)&&void 0!==n?n:"")}}}),N=(0,_.useRef)(null),L=(0,ne.MG)({count:null!==(l=null==B?void 0:B.length)&&void 0!==l?l:0,getScrollElement:function(){return N.current},estimateSize:function(){return 32},getItemKey:function(e){var t,n;return null!==(n=null==B?void 0:null===(t=B[e])||void 0===t?void 0:t.path)&&void 0!==n?n:""},overscan:void 0===p?4:p}),M=(0,f.BX)(y.G,{css:vW.inputRow,children:[(0,f.tZ)(y.G,{css:vW.searchIcon,children:T?(0,f.tZ)(Z.Z,{size:12}):(0,f.tZ)(pd.Z,{size:12})}),(0,f.tZ)("input",(0,U._)({autoFocus:!0,placeholder:"Search files",css:vW.input},A.getInputProps({ref:v})))]}),X="top"===d?"0 0 ".concat(x.TV.space4," ").concat(x.TV.space4):"".concat(x.TV.space4," ").concat(x.TV.space4," 0 0");return!T||(null==B?void 0:B.length)||(X=x.TV.space4),(0,f.BX)(y.G,{css:vW.root,style:(0,eP._)({},vX.inputBorderRadius,X),children:["bottom"===d?M:null,R?(0,f.tZ)(rT.E,{icon:(0,f.tZ)(rn.Z,{}),text:R}):null,void 0!==E?(0,f.BX)(y.G,{css:vW.header,style:"bottom"===d?{borderTop:"1px solid "+x.TV.outlineDimmer}:void 0,children:[(0,f.BX)(g.xv,{variant:"small",color:"dimmest",children:[c.length,"/",E]}),c.length?(0,f.tZ)(y.G,{tag:"button",css:vW.unselectButton,onClick:function(){return function(){var e=!0,t=!1,n=void 0;try{for(var r,i=c[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var o=r.value.path;m({path:o,preference:"exclude"})}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}()},children:"Unselect"}):null]}):null,(0,f.tZ)("div",(0,O._)((0,U._)({style:"top"===d?{borderBottom:"1px solid "+x.TV.outlineDimmer}:void 0,css:vW.menu},A.getMenuProps({ref:N})),{children:(0,f.tZ)("div",{style:{height:"".concat(L.getTotalSize(),"px"),width:"100%",position:"relative"},children:L.getVirtualItems().map(function(e){var t=e.index,n=e.key,r=e.start,i=null==B?void 0:B[t];return i?(0,f.tZ)(y.G,(0,O._)((0,U._)({"data-index":t,css:vW.item,style:(0,eP._)({},vX.itemTransform,"translateY(".concat(r,"px)"))},A.getItemProps({item:i,index:t,refKey:"innerRef",ref:L.measureElement})),{"aria-selected":void 0!==i.status,children:(0,f.tZ)(vO,{highlighted:t===A.highlightedIndex,path:i.path,ranges:i.ranges,status:i.status})}),n):null})})})),"top"===d?M:null]})}var vz=(0,b.X)({button:[x.l0.reset.button,x.l0.align.center,x.l0.cursor.pointer,x.l0.px(4),x.l0.py(2),x.l0.rowWithGap(4),nn.gU.nofill,x.l0.color.foregroundDimmest,{"&:hover":x.l0.color.foregroundDefault}]});function vj(e){var t,n=(0,u._)((0,_.useState)(!1),2),r=n[0],i=n[1],o=(0,u._)((0,_.useState)(null),2),a=o[0],l=o[1],c=(0,u._)((0,_.useState)(null),2),s=c[0],d=c[1];(0,_.useEffect)(function(){var e=function(e){var t,n;t=e.target,n=[s,a],t instanceof Node&&n.some(function(e){return null==e?void 0:e.contains(t)})||i(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[s,a]),(0,_.useEffect)(function(){var e=function(e){"Escape"===e.key&&i(!1)};if(r)return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[r]);var h=(0,vG.D)(a,s,{modifiers:[{name:"offset",options:{offset:[0,4]}},{name:"preventOverflow",options:{padding:16}}],placement:"bottom-start"}),p=e.fileContextInclusions,m=e.findFiles,v="Context",b=p.filter(function(e){return"included"===e.inclusionStatus});b.length&&(v=1===b.length?(0,E.UO)(b[0].path):b.length+" files");var w=(0,_.useId)();return(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,{tag:"button",css:vz.button,innerRef:l,onClick:function(){return i(function(e){return!e})},onKeyDown:function(e){"ArrowDown"===e.key&&i(!0)},"aria-label":"Select files","aria-haspopup":!0,"aria-expanded":r,"aria-controls":w,children:[(0,f.tZ)(vI.Z,{}),(0,f.tZ)(g.xv,{variant:"small",children:v}),(0,f.tZ)(vA.Z,{rotate:r?180:0,size:12})]}),r?(0,f.tZ)(vR.h,{children:(0,f.tZ)(sN.MT,{restoreFocus:!0,children:(0,f.tZ)(H.Tg,(0,O._)((0,U._)({id:w,elevated:!0,style:h.styles.popper,innerRef:d,css:vL.popover},h.attributes.popper),{children:(0,f.tZ)(vV,{overscan:e.overscan,onChange:e.onChange,findFiles:m,fileContextInclusions:p,placement:(null===(t=h.state)||void 0===t?void 0:t.placement.startsWith("top"))?"top":"bottom"})}))})}):null]})}var vq=n(59510),vY=n.n(vq),vJ=eA.r$.define({combine:function(e){var t;return null!==(t=e[0])&&void 0!==t?t:[]},compare:vY()}),vK=new cp.j(function(e){return vJ.of(e)}),v$={render:function(e){var t=e.file,n=t.path,r=t.match,i=(0,uS.V)((0,f.tZ)(y.G,{css:vU.root,style:{width:"100%"},className:"option",children:(0,f.BX)(y.G,{css:vU.content,children:[(0,f.BX)(y.G,{css:vU.left,children:[(0,f.tZ)(v.Z,{path:n,size:16}),(0,f.tZ)(vT.x,{text:r.filename.text,highlight:r.filename.ranges,dimmed:!0}),r.directory?(0,f.tZ)(y.G,{color:"dimmest",css:vU.dir,children:(0,f.tZ)(vT.x,{text:r.directory.text+"/",highlight:r.directory.ranges,dimmed:!0})}):null]}),"included"===t.inclusionStatus?(0,f.tZ)(rl.Z,{}):null]})}));return i.style.display="flex",i.style.width="100%",i},position:81},vQ=eO.tk.theme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:eM.TV.fontFamilyDefault,fontSize:eM.TV.fontSizeSmall},"& > ul > li":{padding:"0px",display:"flex",alignItems:"center"},"& > ul > li[aria-selected] .option":{backgroundColor:eM.TV.backgroundHighest}},".cm-completionLabel":{width:0}}),v0=new cp.j(function(e){if(!e)return[];function t(){return(t=(0,ts._)(function(t){var n,r,i,o,a;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:if(!e||!t.matchBefore(/@(\S*)/g)||null===(n=t.matchBefore(/\w*/)))return[2,null];return[4,e(n.text)];case 1:return i=null!==(r=l.sent().files)&&void 0!==r?r:[],o=new Map(t.state.facet(vJ).map(function(e){return[e.path,e.inclusionStatus]})),a=i.map(function(e){var t=e.path,n=e.ranges;return{label:t,displayLabel:" ",file:{path:t,inclusionStatus:o.get(t),match:(0,vN.Q1)({path:t,ranges:null!=n?n:[]})}}}),[2,{from:n.from,filter:!1,options:a}]}})})).apply(this,arguments)}return[vQ,(0,vE.ys)({defaultKeymap:!1,icons:!1,aboveCursor:!0,addToOptions:[v$],override:[function(e){return t.apply(this,arguments)}],maxRenderedOptions:100})]}),v1=new cp.j(function(e){return eO.tk.updateListener.of(function(t){var n=!0,r=!1,i=void 0;try{for(var o,a=t.transactions[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var l=o.value.annotation(vE.Jv);l&&e(l.label)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}})}),v2=n(16689),v8=n.n(v2),v4=(0,b.X)({root:[x.l0.display.inlineFlex],button:[x.l0.reset.button,x.l0.display.inlineFlex,x.l0.px(2),nn.gU.outlined,x.l0.borderRadius(4),x.l0.rowWithGap(2),x.l0.align.center],warning:{color:x.TV.redDefault}}),v3=new uS.J(function(e){var t=(0,E.UO)(e.path),n=(0,E.Il)(e.path);return(0,f.tZ)(ta.u,{isDisabled:!n&&!e.warning,tooltip:(0,f.BX)(y.G,{children:[e.warning?(0,f.tZ)(g.xv,{variant:"small",css:v4.warning,children:e.warning}):null,n?(0,f.BX)(g.xv,{variant:"small",color:"dimmest",children:[n,"/"]}):null]}),children:function(n,r){return(0,f.tZ)(y.G,(0,O._)((0,U._)({css:v4.root,innerRef:r},n),{children:(0,f.BX)(y.G,{tag:"button",css:v4.button,onClick:function(){return e.onClick()},children:[(0,f.tZ)(v.Z,{size:12,path:e.path}),(0,f.tZ)(g.xv,{variant:"small",children:t}),e.warning?(0,f.tZ)(rn.Z,{size:12}):null]})}))}})}),v5=function(e){"use strict";(0,lm._)(n,e);var t=(0,lg._)(n);function n(e,r){var i;return(0,lp._)(this,n),(i=t.call(this)).file=e,i.onClick=r,i}var r=n.prototype;return r.eq=function(e){return this.file.path===e.file.path&&this.file.inclusionStatus===e.file.inclusionStatus},r.toDOM=function(){var e=this.file,t=e.path,n=e.inclusionStatus,r=null;switch(n){case"included":break;case"unsupported":r="File not supported";break;case"truncated":case"overflowing":r="Exceedes memory limit"}var i=v3.create({path:t,onClick:this.onClick,warning:r});return i.style.display="inline",i},n}(eO.l9),v6=function(e,t){return new eO.Y1({regexp:RegExp("".concat(e.map(function(e){var t=e.path;return"@".concat(v8()(t))}).join("|")),"g"),decoration:function(n,r){var i,o=n[0].substring(1,null===(i=n[0])||void 0===i?void 0:i.length),a=e.find(function(e){return e.path===o});return a?eO.p.replace({widget:new v5(a,function(){return t(o)}),inclusive:!0}):null}})},v9=new cp.j(function(e){return e?eO.lg.fromClass(function(){"use strict";function t(n){(0,lp._)(this,t);var r=n.state.facet(vJ);this.match=r.length&&e?v6(r,e):null,this.placeholders=this.match?this.match.createDeco(n):eO.p.none}return t.prototype.update=function(t){var n=t.state.facet(vJ);if(0===n.length){this.match=null,this.placeholders=eO.p.none;return}if((0,vg.a)(t,vJ)){this.match=v6(n,e),this.placeholders=this.match.createDeco(t.view);return}if((0,vg.a)(t,"doc")){if(!this.match){this.match=v6(n,e),this.placeholders=this.match.createDeco(t.view);return}this.placeholders=this.match.updateDeco(t,this.placeholders)}},t}(),{decorations:function(e){return e.placeholders},provide:function(e){return eO.tk.atomicRanges.of(function(t){var n;return(null===(n=t.plugin(e))||void 0===n?void 0:n.placeholders)||eO.p.none})}}):[]}),v7=n(40497),ge={layer:"cm-placeholder-layer",dom:"cm-placeholder-dom"},gt=eO.tk.theme((g2={},(0,eP._)(g2,".".concat(ge.layer),{width:"100%",height:"100%",pointerEvents:"none"}),(0,eP._)(g2,".".concat(ge.dom),{position:"absolute",width:"100%",pointerEvents:"none",fontFamily:eM.TV.fontFamilyDefault,color:eM.TV.foregroundDimmest}),g2)),gn=function(e){return 0===e.doc.toString().trim().length};eA.r$.define({combine:function(){return!0}});var gr=eA.Py.define(),gi=eA.QQ.define({create:gn,update:function(e,t){return gn(t.state)}}),go=[gi,gt,(0,eO.EY)((gA=Date.now(),{above:!1,class:ge.layer,update:function(e){var t=!1;return(0,v7.j)(e,gr,function(){t=!0,gA=Date.now()}),t||(0,vg.a)(e,gi)},markers:function(e){if(!e.state.field(gi))return[];var t,n,r,i,o=e.coordsAtPos(0);if(!o)return[];var a=e.dom.getBoundingClientRect(),l=o.left-a.left;return[(n=(t={top:o.top-a.top,left:l,height:o.bottom-o.top,animateTimestamp:gA}).top,r=t.left,i=t.height,{draw:function(){var e="Type message...",t=document.createElement("div");t.className=ge.dom,t.style.width="100%",t.style.paddingTop=n+"px",t.style.paddingLeft=r+"px",t.style.height=i+"px";var o=e.length;return function n(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;requestAnimationFrame(function(){t.textContent=e.slice(0,r),r<o&&n(r+1)})}(),t},animateTimestamp:t.animateTimestamp,eq:function(e){return this.animateTimestamp===e.animateTimestamp}})]}}))],ga=eO.tk.theme((g8={"& .cm-content":{fontFamily:x.TV.fontFamilyDefault}},(0,eP._)(g8,"& .".concat(vp.ll),{display:"none"}),(0,eP._)(g8,"& .cm-indent-markers",{display:"none"}),g8)),gl=(0,b.X)({footer:[x.l0.rowWithGap(8),x.l0.align.center],left:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.flex.growAndShrink(1),{cursor:"text"}],right:[x.l0.rowWithGap(8),x.l0.align.center],codemirror:[x.l0.maxHeight(300),x.l0.overflow("auto"),{"& .cm-content":x.l0.pt(8)}],send:[x.l0.borderRadius()],sendDisabled:[(0,mv.ec)("grey")],sendEnabled:[(0,mv.ec)("blurple")]});function gc(e){var t,n,r,i,o=(0,ch.Z)(),a=o.ref,l=o.view;n=(t={view:l,setPromptEditor:e.inputRef}).view,r=t.setPromptEditor,i=(0,eY.Z)(r),(0,_.useEffect)(function(){if(n){var e=i.current;return e({setValue:function(e){n.state.doc.toString()!==e&&n.dispatch({changes:{from:0,to:n.state.doc.length,insert:e}})},focus:function(){n.focus(),n.dispatch({selection:{anchor:n.state.doc.length}})},animatePlaceholder:function(){n.dispatch({effects:gr.of(!0)})}}),function(){e(null)}}},[n,i]);var c=(0,vh.IK)(l,gi),s=vb.use(e.maxLength),d=(0,eY.Z)(e.onSubmit),h=gs.use((0,_.useCallback)(function(e){return d.current(e)},[d]),!!e.connecting),p=v0.use(e.findFiles),v=v9.use(e.openFile),g=vK.use(e.fileContextInclusions),b=e.updateFileContext,w=v1.use((0,_.useCallback)(function(e){return null==b?void 0:b({path:e,preference:"include"})},[b]));if(e.hideInput)return null;var x=(!l||!0===c)&&!e.loading,C=(0,u._)(e.children,3),S=C[0],k=C[1],E=C[2];return(0,f.BX)(f.HY,{children:[(0,f.tZ)(ej.ZP,{ref:a,language:"markdown",css:gl.codemirror,hideGutter:!0,autocomplete:!1,fontSize:14,keyboardHandler:null,extensions:[ga,h,go,vS,s,g,v,p,w]}),(0,f.BX)(y.G,{css:gl.footer,children:[(0,f.BX)(y.G,{css:gl.left,onClick:function(e){e.target===e.currentTarget&&(null==l||l.focus())},children:[S,k]}),(0,f.BX)(y.G,{css:gl.right,children:[(0,f.tZ)(v_,{view:l}),E,(0,f.tZ)(H.Tg,{elevated:!0,css:gl.send,children:e.connecting?(0,f.tZ)(m.hU,{disabled:!0,alt:"Connecting....",children:(0,f.tZ)(Z.Z,{})}):(0,f.tZ)(m.hU,{css:x?gl.sendDisabled:gl.sendEnabled,disabled:x,alt:e.loading?"Stop":"Send",onClick:function(){if(e.loading){e.onStop();return}if(l){var t=l.state.doc.toString();t&&(e.onSubmit(t),l.dispatch({changes:{from:0,to:l.state.doc.length}}))}},children:e.loading?(0,f.tZ)(vv.Z,{}):(0,f.tZ)(vm.Z,{})})})]})]})]})}var gs=new cp.j(function(e,t){return eO.tk.domEventHandlers({keydown:function(n,r){!((0,vE.SI)(r.state).length>0)&&"Enter"===n.key&&!n.shiftKey&&(n.preventDefault(),!(t||r.state.field(gi))&&(e(r.state.doc.toString()),r.dispatch({changes:{from:0,to:r.state.doc.length}})))}})}),gu=n(19408),gd=n(12880),gf=n(83807),gh=new Map([["NONE",{title:"Ask AI",description:"Detect actions based on the prompt",icon:(0,f.tZ)(gf.Z,{})}],["GENERATE",{title:"Generate",description:"Write starter code/tests",icon:(0,f.tZ)(gd.Z,{})}],["TRANSFORM",{title:"Modify",description:"Refactor existing features",icon:(0,f.tZ)(gd.Z,{})}],["EXPLAIN",{title:"Explain",description:"Ask a question about your code",icon:(0,f.tZ)(gu.Z,{})}],["REPLIT_DOCS",{title:"Ask replit.com",description:"Ask about how to do things on Replit",icon:(0,f.tZ)(gu.Z,{})}]]),gp=(0,b.X)({label:x.l0.visuallyHidden,heading:[x.l0.px(8),x.l0.py(4)],item:[x.l0.viewStyle,x.l0.px(8),x.l0.py(4),x.l0.cursor.pointer,nn.gU.listItem,x.l0.rowWithGap(8),{'&[data-selected="true"]':{backgroundColor:nn.vb.interactiveBackground},"&:last-of-type":{borderBottomRightRadius:4,borderBottomLeftRadius:4}}],surface:[x.l0.borderRadius(4),x.l0.border({color:x.TV.outlineDefault}),x.l0.overflow("hidden"),x.l0.maxWidth(260)],itemHeader:[x.l0.rowWithGap(4),x.l0.align.center],itemContent:[x.l0.flex.growAndShrink(1)]});function gm(e){var t=e.intent,n=e.selected,r=gh.get(t);if(!r)throw Error("Expected data");return(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,{css:gp.itemContent,children:[(0,f.BX)(y.G,{css:gp.itemHeader,children:[(0,_.cloneElement)(r.icon,{size:16,color:x.TV.blurpleDefault}),(0,f.tZ)(g.xv,{variant:"small",children:r.title})]}),(0,f.tZ)(g.xv,{variant:"small",color:"dimmest",children:r.description})]}),n?(0,f.tZ)(rl.Z,{color:x.TV.foregroundDimmer}):null]})}function gv(e){var t,n,r=null!==(t=gh.get(e.selectedItem))&&void 0!==t?t:gh.get("NONE");if(!r)throw Error("Expected selectedIntent");return(0,f.BX)(m4.Ph,{selectedKey:e.selectedItem,onSelectionChange:function(t){gh.has(t)&&e.onChange(t)},children:[(0,f.tZ)(m4.__,{css:gp.label,children:"Model type"}),(0,f.BX)(vf.UN,{children:[null!==(n=r.icon)&&void 0!==n?n:null,r.title]}),(0,f.tZ)(m4.J2,{children:(0,f.BX)(H.Tg,{css:gp.surface,elevated:!0,children:[(0,f.tZ)(y.G,{css:gp.heading,children:(0,f.tZ)(g.xv,{variant:"small",color:"dimmest",children:"Select a mode"})}),(0,f.tZ)(m4.wb,{"aria-label":"Intent",items:e.items.map(function(e){return{id:e}}),selectionMode:"single",children:function(t){var n;return(0,f.tZ)(m4.m9,{css:gp.item,textValue:null===(n=gh.get(t.id))||void 0===n?void 0:n.title,children:(0,f.tZ)(gm,{intent:t.id,selected:t.id===e.selectedItem})})}})]})})]})}var gg=new Map([["NONE",pO.$h.MESSAGE_ACTION_UNKNOWN],["GENERATE",pO.$h.GENERATE],["TRANSFORM",pO.$h.TRANSFORM],["EXPLAIN",pO.$h.EXPLAIN],["REPLIT_DOCS",pO.$h.REPLIT_DOCS]]),gy=new Map,gb=!0,gw=!1,gZ=void 0;try{for(var gx,gC,gS,gk,g_,gE,gT,gR,gI,gD,gG,gB,gP,gA,gN,gL,gU,gO,gM,gX,gF,gW,gH,gV,gz,gj,gq,gY,gJ,gK,g$,gQ,g0,g1,g2,g8,g4,g3=gg[Symbol.iterator]();!(gb=(g4=g3.next()).done);gb=!0){var g5=(0,u._)(g4.value,2),g6=g5[0],g9=g5[1];gy.set(g9,g6)}}catch(e){gw=!0,gZ=e}finally{try{gb||null==g3.return||g3.return()}finally{if(gw)throw gZ}}var g7=n(45434),ye=n(19615),yt=n(22580),yn=(0,b.X)({root:[x.l0.rowWithGap(2),x.l0.align.center]}),yr=(0,_.memo)(function(e){var t=e.eventIds,n=e.index,r=e.onClick,i=t.length;return i<2?null:(0,f.BX)(y.G,{css:yn.root,children:[(0,f.tZ)(m.hU,{onClick:function(){r(t[n>0?n-1:i-1])},alt:"Previous",tooltipHidden:!0,children:(0,f.tZ)(sP.Z,{})}),(0,f.BX)(g.xv,{variant:"small",color:"dimmest",children:[n+1,"/",i]}),(0,f.tZ)(m.hU,{onClick:function(){r(t[n<i-1?n+1:0])},alt:"Next",tooltipHidden:!0,children:(0,f.tZ)(V.Z,{})})]})}),yi=n(57679);function yo(){var e=(0,ex._)(["\n  fragment AiChatMessageUser on User {\n    id\n    username\n    image\n    url\n  }\n"]);return yo=function(){return e},e}function ya(){var e=(0,ex._)(["\n  query AiChatMessageUserData($id: Int!) {\n    user(id: $id) {\n      ...AiChatMessageUser\n    }\n  }\n  ","\n"]);return ya=function(){return e},e}var yl={},yc=(0,eC.Ps)(yo()),ys=(0,eC.Ps)(ya(),yc),yu=n(8017),yd=(0,b.X)({root:[x.l0.borderRadius(4),x.l0.border({color:x.TV.outlineDimmest})],header:[x.l0.rowWithGap(4),x.l0.border({color:x.TV.outlineDimmest,direction:"bottom"})],button:[{borderRadius:0,borderTopLeftRadius:4}]});function yf(e){var t=e.codeReference,n=e.onClick;return(0,f.BX)(H.Tg,{css:yd.root,children:[(0,f.tZ)(y.G,{css:yd.header,children:(0,f.tZ)(W.zx,{css:yd.button,size:"small",variant:"nofill",iconLeft:(0,f.tZ)(v.Z,{size:12,path:t.filePath}),iconRight:(0,f.tZ)(yu.Z,{}),text:"".concat(t.filePath," ").concat(t.range.lineFrom,":").concat(t.range.lineTo),onClick:n})}),(0,f.tZ)(mm.Z,{lineNumbers:!0,lineNumbersStart:t.range.lineFrom,language:t.language,code:t.code,filePath:t.filePath})]})}var yh=n(35105),yp=n(25111),ym=(0,d._)(yh.HC.keys()),yv=(0,d._)(yh.M8.keys()),yg=(0,d._)(yh.NK.keys());function yy(e){var t=(0,u._)((0,_.useState)(e.typeUsed),2),n=t[0],r=t[1],i=(0,u._)((0,_.useState)(e.modelUsed),2),o=i[0],a=i[1];return(0,f.BX)(yp.l0,{css:yw.form,onSubmit:function(t){t.preventDefault(),e.onRerun({model:o,type:n})},children:[(0,f.BX)(y.G,{css:yw.section,children:[(0,f.tZ)(y.G,{css:yw.header,children:(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:"Intent"})}),(0,f.tZ)(m4.Ee,{onChange:function(e){return r(Number(e))},children:ym.map(function(t){return(0,f.tZ)(m4.Y8,{value:t.toString(),children:(0,f.BX)(y.G,{css:yw.radioItemRow,children:[(0,f.BX)(y.G,{css:yw.radioItemText,children:[(0,f.tZ)(yh.Pr,{type:t,text:{variant:"small"}}),t===e.typeUsed?(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:"(Used)"}):null]}),n===t?(0,f.tZ)(rl.Z,{color:x.TV.accentPrimaryStronger}):null]})},t.toString())})})]}),(0,f.BX)(y.G,{css:yw.section,children:[(0,f.tZ)(y.G,{css:yw.header,children:(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:"Model"})}),(0,f.tZ)(m4.Ee,{onChange:function(e){return a(Number(e))},children:yg.map(function(t){return(0,f.tZ)(m4.Y8,{value:t.toString(),children:(0,f.BX)(y.G,{css:yw.radioItemRow,children:[(0,f.BX)(y.G,{css:yw.radioItemText,children:[(0,f.tZ)(yh.gg,{model:t,text:{variant:"small"}}),t===e.modelUsed?(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:"(Used)"}):null]}),o===t?(0,f.tZ)(rl.Z,{color:x.TV.accentPrimaryStronger}):null]})},t.toString())})})]}),(0,f.tZ)(y.G,{css:yw.formFooter,children:(0,f.tZ)(W.zx,{colorway:"primary",type:"submit",iconLeft:(0,f.tZ)(n1.Z,{}),text:"Rerun"})})]})}function yb(e){var t=(0,u._)((0,_.useState)(e.intentUsed),2),n=t[0],r=t[1],i=(0,u._)((0,_.useState)(e.modelUsed),2),o=i[0],a=i[1];return(0,f.BX)(yp.l0,{css:yw.form,onSubmit:function(t){t.preventDefault(),e.onRerun({model:o,intent:n})},children:[(0,f.BX)(y.G,{css:yw.section,children:[(0,f.tZ)(y.G,{css:yw.header,children:(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:"Intent"})}),(0,f.tZ)(m4.Ee,{onChange:function(e){return r(Number(e))},children:yv.map(function(t){return(0,f.tZ)(m4.Y8,{value:t.toString(),children:(0,f.BX)(y.G,{css:yw.radioItemRow,children:[(0,f.BX)(y.G,{css:yw.radioItemText,children:[(0,f.tZ)(yh.Dz,{intent:t,text:{variant:"small"}}),t===e.intentUsed?(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:"(Used)"}):null]}),n===t?(0,f.tZ)(rl.Z,{color:x.TV.accentPrimaryStronger}):null]})},t.toString())})})]}),(0,f.BX)(y.G,{css:yw.section,children:[(0,f.tZ)(y.G,{css:yw.header,children:(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:"Model"})}),(0,f.tZ)(m4.Ee,{onChange:function(e){return a(Number(e))},children:yg.map(function(t){return(0,f.tZ)(m4.Y8,{value:t.toString(),children:(0,f.BX)(y.G,{css:yw.radioItemRow,children:[(0,f.BX)(y.G,{css:yw.radioItemText,children:[(0,f.tZ)(yh.gg,{model:t,text:{variant:"small"}}),t===e.modelUsed?(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:"(Used)"}):null]}),o===t?(0,f.tZ)(rl.Z,{color:x.TV.accentPrimaryStronger}):null]})},t.toString())})})]}),(0,f.tZ)(y.G,{css:yw.formFooter,children:(0,f.tZ)(W.zx,{colorway:"primary",type:"submit",iconLeft:(0,f.tZ)(n1.Z,{}),text:"Rerun"})})]})}var yw=(0,b.X)({form:[x.l0.width(200)],formFooter:[x.l0.px(8),x.l0.py(8)],header:[x.l0.py(4),x.l0.px(8)],radioItemText:[x.l0.rowWithGap(4)],section:{'& [role="radiogroup"]':{"& > label":[x.l0.p(8),x.l0.py(4),nn.gU.listItem,x.l0.display.block],'& > [data-focused="true"]':{backgroundColor:nn.vb.interactiveBackgroundActive,borderColor:x.TV.accentPrimaryDefault}}},radioItemRow:[x.l0.rowWithGap(4),x.l0.align.center,x.l0.justify.spaceBetween]}),yZ=(0,_.createContext)(null),yx=yZ.Provider;function yC(e){var t,n,r=(0,u._)((0,_.useState)(!1),2),i=r[0],o=r[1],a=(0,_.useContext)(yZ),l=(0,pZ.Un)();return(0,f.BX)(nr.xo,{label:l?"Rerun":"Connecting...",isOpen:i,onOpenChange:o,children:[function(e){var t=e.ref,n=(0,eL._)(e,["ref"]);return(0,f.tZ)(W.zx,(0,O._)((0,U._)({},n),{size:"small",variant:"outlined",ref:t,text:"Rerun",iconLeft:(0,f.tZ)(n1.Z,{}),iconRight:(0,f.tZ)(e0.Z,{size:12,rotate:i?180:0}),disabled:!l}))},"intentUsed"in e?(0,f.tZ)(yb,{onRerun:(t=(0,ts._)(function(t){var n,r,i;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:if(o(!1),n=e.onRerun,r={intent:t.intent,model:t.model},!a)return[3,2];return[4,a()];case 1:return i=l.sent(),[3,3];case 2:i=void 0,l.label=3;case 3:return n.apply(e,[(r.fileContext=i,r)]),[2]}})}),function(e){return t.apply(this,arguments)}),modelUsed:e.modelUsed,intentUsed:e.intentUsed}):(0,f.tZ)(yy,{onRerun:(n=(0,ts._)(function(t){var n,r,i;return(0,tu.Jh)(this,function(l){switch(l.label){case 0:if(o(!1),n=e.onRerun,r={type:t.type,model:t.model},!a)return[3,2];return[4,a()];case 1:return i=l.sent(),[3,3];case 2:i=void 0,l.label=3;case 3:return n.apply(e,[(r.fileContext=i,r)]),[2]}})}),function(e){return n.apply(this,arguments)}),modelUsed:e.modelUsed,typeUsed:e.typeUsed})]})}var yS=(0,b.X)({message:[x.l0.colWithGap(8)],header:[x.l0.rowWithGap(8),x.l0.align.center],footer:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.justify.spaceBetween],footerRight:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.justify.end,x.l0.flex.growAndShrink(1)]});function yk(e){if(!e)return!1;var t=e.contents.contents;return!("messageEventContents"===t.$kind&&t.messageEventContents.intent===pO.$h.DEBUG)}var y_=(0,_.memo)(function(e){var t=(0,pZ.Ti)(e.id),n=(0,pZ.Mi)(e.id,yE),r=(0,pZ.Mi)(e.id,yk),i=(0,_.useMemo)(function(){if(r)return function(t){return(0,f.tZ)(yi._,(0,O._)((0,U._)({},t),{openFile:e.openFile}))}},[r,e.openFile]);return!t&&n&&n.state!==pO.he.COMPLETE?(0,f.tZ)(Z.Z,{}):(0,f.tZ)(yt.J,{text:t||"",codeComponent:i})});function yE(e){if(!e)return null;var t=e.contents.contents,n={type:pO.BY.MODEL_TYPE_UNKNOWN,overrideModelName:""},r=null;(null==t?void 0:t.$kind)==="messageEventContents"?(r={value:t.messageEventContents.intent,kind:"message"},n=t.messageEventContents.usedModelSelector):(null==t?void 0:t.$kind)==="inlineActionEventContents"&&(r={value:t.inlineActionEventContents.messageType,kind:"inline"},n=t.inlineActionEventContents.usedModelSelector);var i=e.error&&e.error.type!==pO.lZ.EVENT_ERROR_TYPE_UNKNOWN?e.error.type:null;return{id:e.id,created:e.created,sender:{type:e.sender.type,id:e.sender.id},parentEventId:e.parentEventId,state:e.state,codeReference:function(e){switch(null==e?void 0:e.contents.contents.$kind){case"messageEventContents":if(e.contents.contents.messageEventContents.intent===pO.$h.DEBUG)break;return e.contents.contents.messageEventContents.codeReference;case"inlineActionEventContents":return e.contents.contents.inlineActionEventContents.codeReference;default:return null}}(e),intent:r,error:i,usedModelSelector:n}}var yT=(0,_.memo)(function(e){var t,n,r,i,o,a,l=(0,pZ.oV)(),c=(0,pZ.$q)(e.id),s=(0,pZ.Mi)(e.id,yE);if(!s)return null;var u=s.sender;function d(t){if(!s)throw Error("Expected event");l(s.id,t),c&&e.setActiveChild({parentEventId:c.parentEventId,eventId:null})}return u.type===pO.FW.USER?(0,f.BX)(y.G,{css:yS.message,children:[(0,f.BX)(y.G,{css:yS.header,children:[(0,f.tZ)(yD,{id:Number(u.id)}),(0,f.tZ)(no.EK,{textVariant:"small",textColor:"dimmest",date:s.created})]}),(0,f.tZ)(y_,{id:e.id,openFile:e.openFile}),(null===(a=s.codeReference)||void 0===a?void 0:a.code)?(0,f.tZ)(yf,{codeReference:s.codeReference,onClick:function(){var t,n,r=null===(t=s.codeReference)||void 0===t?void 0:t.filePath;e.openFile&&r&&e.openFile({path:r,line:null===(n=s.codeReference)||void 0===n?void 0:n.range.lineTo})}}):null]}):(0,f.BX)(y.G,{css:yS.message,children:[(0,f.BX)(y.G,{css:yS.header,children:[(0,f.tZ)(ye.R,{size:24,showUsername:!0}),(0,f.tZ)(no.EK,{textVariant:"small",textColor:"dimmest",date:s.created}),(null===(t=s.intent)||void 0===t?void 0:t.kind)==="message"?(0,f.tZ)(yh.Dz,{intent:s.intent.value,icon:{color:x.TV.foregroundDimmest,size:12},text:{color:"dimmest",variant:"small"}}):null,(null===(n=s.intent)||void 0===n?void 0:n.kind)==="inline"?(0,f.tZ)(yh.Pr,{type:s.intent.value,icon:{color:x.TV.foregroundDimmest,size:12},text:{color:"dimmest",variant:"small"}}):null,(0,f.tZ)(yh.gg,{model:s.usedModelSelector.type===pO.BY.OVERRIDE?s.usedModelSelector.overrideModelName:s.usedModelSelector.type,icon:{color:x.TV.foregroundDimmest,size:12},text:{color:"dimmest",variant:"small"}})]}),(0,f.tZ)(y_,{id:e.id,openFile:e.openFile}),s.state===pO.he.COMPLETE?(0,f.tZ)(f.HY,{children:(0,f.BX)(y.G,{css:yS.footer,children:[(0,f.tZ)(y.G,{children:s.error?(0,f.tZ)(yR,{type:s.error}):null}),(0,f.BX)(y.G,{css:yS.footerRight,children:[c?(0,f.tZ)(yr,{eventIds:c.eventIds,index:c.index,onClick:function(t){return e.setActiveChild({parentEventId:c.parentEventId,eventId:t})}}):null,(null===(r=s.intent)||void 0===r?void 0:r.kind)==="message"?(0,f.tZ)(yC,{modelUsed:s.usedModelSelector.type,intentUsed:null===(i=s.intent)||void 0===i?void 0:i.value,onRerun:d}):null,(null===(o=s.intent)||void 0===o?void 0:o.kind)==="inline"?(0,f.tZ)(yC,{modelUsed:s.usedModelSelector.type,typeUsed:s.intent.value,onRerun:d}):null]})]})}):null]})});function yR(e){switch(e.type){case pO.lZ.MANUALLY_ABORTED:return(0,f.tZ)(rT.E,{icon:(0,f.tZ)(lh.Z,{}),text:"Message was stopped"});case pO.lZ.USAGE_LIMIT:return(0,f.tZ)(rT.E,{icon:(0,f.tZ)(rn.Z,{}),colorway:"orange",text:"Usage limit reached"});default:return(0,f.tZ)(rT.E,{icon:(0,f.tZ)(rn.Z,{}),colorway:"red",text:"Something went wrong"})}}var yI=(0,b.X)({root:[x.l0.rowWithGap(8),x.l0.align.center]});function yD(e){var t,n,r,i,o,a=(t={variables:{id:e.id}},n=(0,U._)({},yl,t),eS.a(ys,n)).data,l=null==a?void 0:a.user;return(0,f.BX)(y.G,{css:yI.root,children:[(0,f.tZ)(ns.q,{size:24,username:null!==(r=null==l?void 0:l.username)&&void 0!==r?r:"",src:null!==(i=null==l?void 0:l.image)&&void 0!==i?i:""}),(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:null!==(o=null==l?void 0:l.username)&&void 0!==o?o:""})]})}var yG=n(31950),yB=(0,fu.$)(["transform","opacity"]),yP=yB.cssVars,yA=yB.styleTokens,yN=(0,b.X)({root:[x.l0.position.relative,{height:0}],container:[x.l0.position.absolute,x.l0.bottom(0),x.l0.left("50%"),{transitionProperty:["opacity","transform"],transitionTimingFunction:cI.H.timingFunction,transitionDuration:cI.H.duration,opacity:yA.opacity,transform:yA.transform}],button:[x.l0.reset.button,nn.gU.filledAndOutlined,x.l0.p(4),x.l0.rowWithGap(4),x.l0.align.center,x.l0.borderRadius(16),x.l0.shadow(1)]}),yL={hidden:(o={},(0,eP._)(o,yP.opacity,"0"),(0,eP._)(o,yP.transform,"translate(-50%, ".concat(x.TV.space4,")")),o),visible:(a={},(0,eP._)(a,yP.opacity,"1"),(0,eP._)(a,yP.transform,"translate(-50%, calc(-1 * ".concat(x.TV.space4,"))")),a)};function yU(e){var t=e.visible,n=e.onClick,r=(0,_.useRef)(null);return(0,yG.j)(r,t,function(e){return e?yL.visible:yL.hidden}),(0,f.tZ)(y.G,{innerRef:r,css:yN.root,children:(0,f.tZ)(y.G,{css:yN.container,children:(0,f.BX)(H.Tg,{css:yN.button,elevated:!0,tag:"button",onClick:n,children:[(0,f.tZ)(iX.Z,{size:12}),(0,f.tZ)(g.xv,{variant:"small",children:"Scroll to latest"})]})})})}var yO=n(59173),yM=n(27592),yX=(0,b.X)({events:[x.l0.colWithGap(0),x.l0.overflowY("auto"),x.l0.flex.growAndShrink(1),x.l0.width("100%"),x.l0.py(8)],event:[x.l0.px(16),x.l0.py(8)],loading:[x.l0.center,x.l0.height("100%")]});function yF(e){var t,n,r,i,o,a,l,c,s,d,h,p,m=(0,pZ.kP)(e.sessionId),v=(0,pZ.hI)(null!==(p=null==m?void 0:m.id)&&void 0!==p?p:null,e.parentToActiveChild),g=v.events,b=v.loading,w=v.getEvents,x=(n=(t={sessionId:(null==m?void 0:m.id)||null,loading:b}).sessionId,r=t.loading,i=(0,u._)((0,_.useState)(function(){return(0,yO.u)(!1)}),1)[0],a=(o=(0,u._)((0,_.useState)(null),2))[0],l=o[1],s=(c=(0,u._)((0,_.useState)(null),2))[0],d=c[1],(0,_.useEffect)(function(){if(a&&s)return(0,yM.j)(a,function(){return i.set(!1),function(){i.set(!0)}},{root:s,rootMargin:"100px"})},[i,a,s]),h=(0,_.useRef)(new Map),(0,_.useEffect)(function(){if(s&&a&&n&&!r){var e=h.current.get(n);void 0===e?(0,cA.Z)(a,{behavior:"instant"}):s.scrollTop=e}},[s,a,n,r]),{showButton:i,anchorRef:l,scrollRef:d,onClick:function(){a&&(0,cA.Z)(a)},onScroll:(0,_.useCallback)(function(e){if(n){var t=e.currentTarget.scrollTop;0!==t&&h.current.set(n,t)}},[n])}),C=g.length,S=C>0?g[C-1]:null;return(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,{css:yX.events,innerRef:x.scrollRef,onScroll:x.onScroll,onWheel:function(t){t.deltaY<0&&e.shouldAutoscrollRef.current&&(e.shouldAutoscrollRef.current=!1)},children:[b&&0===C?(0,f.tZ)(y.G,{css:yX.loading,children:(0,f.tZ)(Z.Z,{size:32})}):null,g.map(function(t){return(0,f.tZ)(y.G,{css:yX.event,children:(0,f.tZ)(yT,{id:t,getEvents:w,setActiveChild:e.setActiveChild,openFile:e.openFile})},t)}),(0,f.tZ)(y.G,{innerRef:x.anchorRef}),S?(0,f.tZ)(yW,{enabledRef:e.shouldAutoscrollRef,lastEventId:S}):null]}),(0,f.tZ)(yU,{visible:x.showButton,onClick:x.onClick})]})}function yW(e){var t=e.lastEventId,n=e.enabledRef,r=(0,_.useRef)(null),i=(0,pZ.SH)(t);return(0,_.useEffect)(function(){var e=function(){o&&cancelAnimationFrame(o)},t=function(){n.current&&(e(),o=requestAnimationFrame(function(){r.current&&(0,cA.Z)(r.current)}))},o=null;t();var a=i.subscribe(t);return function(){a(),e()}},[i,n,t]),(0,f.tZ)("div",{ref:r})}var yH=n(45087),yV=n(69640);function yz(e){var t,n=(0,u._)((0,_.useState)(!1),2),r=n[0],i=n[1];return r?(0,f.tZ)(vt,{compact:!0,initialValue:null!==(t=e.session.title)&&void 0!==t?t:"",onCancel:function(){return i(!1)},onSubmit:function(t){i(!1),e.onRename(t)}}):(0,f.tZ)(yq,{session:e.session,onRename:function(){return i(!0)},onToggleArchived:e.onToggleArchived})}var yj=(0,b.X)({root:[x.l0.flex.growAndShrink(1),{maxWidth:"100%"}],button:[x.l0.px(4),x.l0.reset.button,x.l0.rowWithGap(4),x.l0.align.center,x.l0.flex.growAndShrink(1),nn.gU.nofill,{fontWeight:x.TV.fontWeightMedium,svg:[x.l0.color.foregroundDimmest],"&:hover svg":[x.l0.color.foregroundDimmer]}],popover:[x.l0.borderRadius(4),x.l0.shadow(1),x.l0.border()],item:[nn.gU.listItem,x.l0.minWidth(140),x.l0.px(4),x.l0.py(2)]});function yq(e){var t=["Rename",e.session.archived?"Unarchive":"Archive"],n=(0,vD.L7)({items:t,onSelectedItemChange:function(t){switch(t.selectedItem){case"Rename":e.onRename();break;case"Archive":case"Unarchive":e.onToggleArchived()}}}),r=(0,u._)((0,_.useState)(null),2),i=r[0],o=r[1],a=(0,u._)((0,_.useState)(null),2),l=a[0],c=a[1],s=(0,vG.D)(i,l,{modifiers:[{name:"offset",options:{offset:[0,8]}},{name:"preventOverflow",options:{padding:16}}],placement:"bottom"});return(0,f.tZ)(f.HY,{children:(0,f.BX)(y.G,{css:yj.root,children:[(0,f.BX)(y.G,(0,O._)((0,U._)({tag:"button",css:yj.button},n.getToggleButtonProps({refKey:"innerRef",ref:o})),{children:[(0,f.tZ)(m8,{variant:"small",color:e.session.title?"default":"dimmest",multiline:!1,text:e.session.title||"New chat"}),(0,f.tZ)(vA.Z,{rotate:n.isOpen?180:0,size:12})]})),(0,f.tZ)(y.G,(0,O._)((0,U._)({},n.getMenuProps({refKey:"innerRef"})),{children:n.isOpen?(0,f.tZ)(vR.h,{children:(0,f.tZ)(H.Tg,(0,O._)((0,U._)({elevated:!0,style:s.styles.popper,innerRef:c,css:yj.popover},s.attributes.popper),{children:t.map(function(e,t){var r=n.highlightedIndex===t?{backgroundColor:nn.vb.interactiveBackground}:void 0;return(0,f.tZ)(y.G,(0,O._)((0,U._)({css:yj.item,style:r},n.getItemProps({refKey:"innerRef",item:e,index:t})),{children:(0,f.tZ)(g.xv,{variant:"small",children:e})}),e)})}))}):null}))]})})}var yY=(0,b.X)({root:[x.l0.rowWithGap(4)],items:[x.l0.border({direction:"bottom"}),x.l0.maxWidth(280)],divider:[x.l0.border({direction:"bottom",color:x.TV.outlineDimmest})]});function yJ(e){var t=e.basic,n=e.advanced,r=e.isPro,i=e.onUpgrade,o="basic"===e.currentModel?t:n,a=o.usage/o.limit>.95,l=(0,u._)((0,_.useState)(!1),2),c=l[0],s=l[1];return(0,f.BX)(y.G,{css:yY.root,children:[a?(0,f.tZ)(vf.cF,{used:o.usage,total:o.limit,inline:!0}):null,(0,f.BX)(nr.xo,{label:"usage",isOpen:c,onOpenChange:s,children:[(0,f.tZ)(m.hU,{alt:"Usage",children:(0,f.tZ)(yH.Z,{})}),(0,f.BX)(y.G,{css:yY.items,children:[(0,f.tZ)(vf.cv,{quota:{used:t.usage,total:t.limit},selected:!1,hasAccessToAdvancedModel:r}),(0,f.tZ)(y.G,{css:yY.divider}),(0,f.tZ)(vf.LX,{hasAccessToAdvancedModel:r,selected:!1,quota:{used:n.usage,total:n.limit},onUpgrade:i})]})]})]})}var yK=(0,b.X)({root:[x.l0.height(36),x.l0.rowWithGap(4),x.l0.px(2),x.l0.justify.spaceBetween,x.l0.align.center,x.l0.border({color:x.TV.outlineDimmest,direction:"bottom"})],center:[x.l0.flex.growAndShrink(1),x.l0.align.center],right:[x.l0.rowWithGap(0)]});function y$(e){var t=(0,u._)(e.children,2),n=t[0],r=t[1];return(0,f.BX)(y.G,{css:yK.root,children:[(0,f.tZ)(m.hU,{alt:"All Chats",onClick:function(){return e.onSidebarButtonClick()},children:(0,f.tZ)(yV.Z,{})}),(0,f.tZ)(y.G,{css:yK.center,children:n}),(0,f.BX)(y.G,{css:yK.right,children:[r,(0,f.tZ)(m.hU,{alt:"New Chat",onClick:function(){return e.onAddButtonClick()},children:(0,f.tZ)(na.Z,{})})]})]})}var yQ=n(73164),y0=function(e){return"color-mix(in srgb, ".concat(eM.TV.blurpleDefault," ").concat(100*e,"%, transparent)")},y1=x.nC.min(440),y2=(0,ep.F4)({"0%":{opacity:0},"100%":{opacity:1}}),y8=(0,fu.$)(["animationDelay"]),y4=y8.styleTokens,y3=y8.cssVars,y5=(0,b.X)({root:[x.l0.reset.button,nn.gU.filled,x.l0.borderRadius(4),x.l0.align.center,x.l0.p(6),x.l0.color.blurpleDefault,x.l0.cursor.pointer,x.l0.align.start,(l={},(0,eP._)(l,y1,[x.l0.rowWithGap(4),x.l0.align.center]),(0,eP._)(l,nn.dj.interactiveBackground,y0(.1)),(0,eP._)(l,nn.dj.interactiveBackgroundActive,y0(.2)),(0,eP._)(l,"opacity",0),(0,eP._)(l,"animationName",y2),(0,eP._)(l,"animationDuration","800ms"),(0,eP._)(l,"animationFillMode","forwards"),(0,eP._)(l,"animationTimingFunction","ease-out"),(0,eP._)(l,"animationDelay",y4.animationDelay),l)],iconText:x.l0.rowWithGap(4)});function y6(e){return(0,f.BX)(y.G,{css:y5.root,onClick:e.onClick,style:(0,eP._)({},y3.animationDelay,20*e.index+"ms"),children:[(0,f.BX)(y.G,{css:y5.iconText,children:[(0,_.cloneElement)(e.icon,{size:16,color:eM.TV.blurpleDefault}),(0,f.tZ)(g.xv,{variant:"small",children:e.text})]}),(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:e.description})]})}var y9=(0,b.X)({root:[x.l0.flex.growAndShrink(1),x.l0.position.relative,x.l0.overflow("auto"),x.l0.display.block],content:[x.l0.py(32),x.l0.px(32),x.l0.center,x.l0.colWithGap(12),x.l0.minHeight("100%")],header:[x.l0.colWithGap(8),x.l0.align.center,x.l0.maxWidth(370),x.l0.textAlign.center],buttons:[x.l0.colWithGap(8),(0,eP._)({},y1,[x.l0.align.center])]});function y7(e){var t,n,r,i,o=e.onPromptClick,a=(r=(n=(0,u._)((0,pn.AA)(),1)[0])?yQ.$R.from(n):null,i=null!=n?n:"index.js",[{icon:(0,f.tZ)(gd.Z,{}),title:"Generate",description:"Create a personal assistant chatbot",action:"GENERATE"},{icon:(0,f.tZ)(mh.Z,{}),title:"Debug",description:n?"Find bugs in ".concat(n):"Fix the price updating logic",action:"DEBUG"},{icon:(0,f.tZ)(gu.Z,{}),title:"Explain",description:"How does ".concat(i," work?"),action:"EXPLAIN",promptToFill:n?"How can I improve the code in "+n:"How can I improve the code in "},{icon:(0,f.tZ)(gu.Z,{}),title:"Ask replit.com",description:"How do I deploy a ".concat(null!==(t=null==r?void 0:r.name)&&void 0!==t?t:"python"," project?"),action:"REPLIT_DOCS"}]);return o?(0,f.tZ)(y.G,{css:y9.root,children:(0,f.BX)(y.G,{css:y9.content,children:[(0,f.BX)(y.G,{css:y9.header,children:[(0,f.tZ)(ye.R,{advanced:!0,showUsername:!1}),(0,f.tZ)(g.xv,{variant:"subheadBig",children:"Replit AI"}),(0,f.tZ)(g.xv,{color:"dimmest",children:"Use Replit AI to set up new projects, answer questions about your code, and assist your thinking."})]}),(0,f.tZ)(y.G,{css:y9.buttons,children:a.map(function(e,t){return(0,f.tZ)(y6,{index:t,icon:e.icon,text:e.title,description:e.description,onClick:function(){var t,n=null!==(t=e.promptToFill)&&void 0!==t?t:e.description;(0,nw.j)(nw.U3.GHOSTWRITER_CHAT_EXAMPLE_CLICKED,{title:e.title}),o({intent:e.action,value:n})}},e.action)})})]})}):null}var be=n(87001);n(4736);var bt=(0,b.X)({surface:[x.l0.flex.growAndShrink(0),x.l0.borderRadius(8),x.l0.m(8),x.l0.position.relative,{marginTop:"auto"}],messageBoxContainer:[x.l0.p(8)],quotaLimitContainer:[x.l0.p(8),x.l0.colWithGap(8),x.l0.position.relative,{marginTop:"auto"}]});function bn(e){var t=e.text,n=e.type,r=(0,u._)((0,_.useState)(!1),2),i=r[0],o=r[1],a=(0,u._)((0,pM.Ni)(),2)[1];return(0,f.BX)(y.G,{css:bt.quotaLimitContainer,children:[(0,f.tZ)(rT.E,{icon:(0,f.tZ)(rn.Z,{}),colorway:"red",text:t}),"basic"===n?(0,f.tZ)(W.zx,{onClick:function(){return o(!0)},colorway:"blurple",text:"Upgrade to Replit ".concat(be.we)}):(0,f.tZ)(W.zx,{onClick:function(){return a("basic")},colorway:"blurple",text:"Switch back to basic model"}),(0,f.tZ)(m2.Z,{isOpen:i,onClose:function(){return o(!1)},type:"purchase",analyticsContext:{upgrade:{context:"ai_model_selector",surface:"ghostwriter_power_up_dialog"}}})]})}var br=n(56412),bi=n(78094),bo=(0,t8.cn)(!1),ba=n(96748),bl=(0,fu.$)(["sidebarTransform","mainPaddingLeft"]),bc=bl.cssVars,bs=bl.styleTokens,bu=(0,b.X)({content:[x.l0.position.relative,x.l0.flex.growAndShrink(1),x.l0.height("100%"),x.l0.container("content"),x.l0.colorMixBg(x.TV.blurpleDefault,"transparent",.05)],header:[{zIndex:1}],sidebar:[x.l0.border({direction:"right",color:x.TV.outlineDimmest}),x.l0.position.absolute,x.l0.top(0),x.l0.left(0),x.l0.height("100%"),x.l0.width("100%"),x.l0.maxWidth(200),(0,eP._)({zIndex:1,transform:bs.sidebarTransform,transitionProperty:"transform",transitionDuration:cI.H.duration},x.nC.min(420,"content"),[x.l0.width(200),{transitionDuration:"0s"}])],main:[x.l0.position.relative,x.l0.flex.growAndShrink(1),x.l0.justify.end,(0,eP._)({},x.nC.min(420,"content"),{paddingLeft:bs.mainPaddingLeft})],chatInputWrapper:[x.l0.px(8),x.l0.pb(8),{justifySelf:"end"}],chatInput:[x.l0.backgroundColor.backgroundDefault,x.l0.borderRadius(4),x.l0.pb(8),x.l0.pl(4),x.l0.pr(8),{border:"1px solid ".concat(x.TV.outlineDimmest),"&:focus-within, &:hover":{border:"1px solid ".concat(x.TV.outlineDimmer)},"&:active":{border:"1px solid ".concat(x.TV.accentPrimaryDefault)}}]}),bd=["NONE","GENERATE","TRANSFORM","EXPLAIN","REPLIT_DOCS"];function bf(e){var t,n,r,i,o,a,l,c,s,h,p,m,v,g,b,w,Z,C,S,k=(0,m1.Z)(),E=(0,u._)((0,_.useState)(!1),2),T=E[0],R=E[1],I=(0,u._)((0,_.useState)("NONE"),2),D=I[0],G=I[1],B=(0,u._)((0,pM.Ni)(),2),P=B[0],A=B[1],N=(0,pZ.p)(),L=(0,pZ.Bk)(),U=e.workspace,O=(null==U?void 0:U.getFileContext)?function(){var t,n;return U.getFileContext({model:"advanced"===P&&L()?pO.BY.ADVANCED:pO.BY.BASIC,filePreferences:N(),recentFiles:null!==(n=null===(t=e.recentFilesObservable)||void 0===t?void 0:t.current)&&void 0!==n?n:[]})}:void 0,M=(0,px.bD)({initialSessionId:e.initialSessionId,getFileContext:O}),X=M.sendMessage,F=M.stopMessage,W=M.loading,V=M.setSessionId,z=M.sessionId,j=M.setActiveChild,q=M.parentToActiveChild,Y=(0,eY.Z)(e.sessionRef);(0,_.useEffect)(function(){var e;null===(e=Y.current)||void 0===e||e.call(Y,{sessionId:z,setSessionId:V})},[z,Y,V]);var J=(0,pZ.Un)(),K=(0,pm.Gn)("chatEngine").preferences,$=(0,pZ.ZR)().hasAccessToAdvancedModel,Q=(0,pZ.kP)(z),ee=(0,pZ.xe)(),et=(0,ba.v)(),en=(0,g7.yL)(et).messageCharacters,er=(r=(n=(0,u._)((0,_.useState)(!1),2))[0],i=n[1],o=(0,_.useRef)(0),a=(0,cR.Z)(function(e){return o.current=e.width}),l=(0,_.useRef)(null),c=(0,_.useRef)(null),t={},(0,eP._)(t,bc.sidebarTransform,"translateX(".concat(r?"0":"-100%",")")),(0,eP._)(t,bc.mainPaddingLeft,(r?200:0)+"px"),s=(0,_.useCallback)(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).ifNecessary;if(!e){i(!1);return}o.current<420&&i(!1)},[]),(0,_.useEffect)(function(){var e=function(e){var t;!(!c.current||e.target instanceof HTMLElement&&c.current.contains(e.target))&&e.target instanceof HTMLElement&&(null===(t=l.current)||void 0===t?void 0:t.contains(e.target))&&s({ifNecessary:!0})};if(r)return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[r,s]),h=(0,_.useCallback)(function(){return i(function(e){return!e})},[]),{rootRef:(0,ib.l)(l,a),sidebarRef:c,toggle:h,close:s,style:t}),ei=(0,u._)((0,_.useState)(null),2),eo=ei[0],ea=ei[1],el=(0,aC.useRouter)(),ec=!!el.query.hideChatInput;function es(e){er.close({ifNecessary:!0}),V(e),k||null==eo||eo.focus()}m=(p={enableBridge:(0,aZ.Vg)(el),sendChatMessage:function(e){X({kind:"message",message:e,model:"advanced"===P?pO.BY.ADVANCED:pO.BY.BASIC,intent:pO.$h.NONE})},abortResponse:function(){F()}}).enableBridge,v=p.sendChatMessage,g=p.abortResponse,b=(0,bi.$X)(bo),w=(0,eY.Z)(v),Z=(0,eY.Z)(g),(0,_.useEffect)(function(){if(m){var e=function(e){return(0,pR.I6)(e,function(e){var t=e.type;switch(b(!1),t){case pI.cF.GHOSTWRITER_CHAT_SEND:w.current(e.chatMessage),(0,pR.gU)(e.id);break;case pI.cF.GHOSTWRITER_CHAT_ABORT_RESPONSE:Z.current(),(0,pR.gU)(e.id);break;default:(0,t7.Z)(t)}})};return window.addEventListener("message",e),function(){return window.removeEventListener("message",e)}}},[Z,m,w,b]),(0,_.useCallback)(function(){var e={messageType:pI.cF.GHOSTWRITER_CHAT_FOCUS_INPUT};(0,pR.bG)(e,tP()())},[]);var eu=(0,pZ.Tt)(),ed=(0,pZ._i)(),ef=(0,pZ.Ud)(),eh=(0,u._)((0,_.useState)([]),2),ep=eh[0],em=eh[1],ev=(0,eY.Z)(null===(C=e.workspace)||void 0===C?void 0:C.getFileContext),eg=e.recentFilesObservable;(0,_.useEffect)(function(){var e=function(e){return t.apply(this,arguments)};if(eg)return e(eg.current),eg.subscribe((0,vB.Z)(e,{wait:2e3}));function t(){return(t=(0,ts._)(function(e){var t,n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:return[4,null===(t=ev.current)||void 0===t?void 0:t.call(ev,{model:"advanced"===P&&L()?pO.BY.ADVANCED:pO.BY.BASIC,filePreferences:eu,recentFiles:e})];case 1:if(!(n=r.sent()))return[2];return em(function(e){var t=e.filePreferences,n=e.fileContextState,r=new Map(n.fileContext.map(function(e){return[e.filePath,"included"]})),i=!0,o=!1,a=void 0;try{for(var l,c=t[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var s=(0,u._)(l.value,2),f=s[0],h=s[1];if("exclude"===h){r.delete(f);continue}if(n.unsupportedPreferredFiles.has(f)){r.set(f,"unsupported");continue}r.set(f,"included"===r.get(f)?"included":"overflowing")}}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return(0,d._)(r.entries()).map(function(e){var t=(0,u._)(e,2);return{path:t[0],inclusionStatus:t[1]}})}({fileContextState:n,filePreferences:eu})),[2]}})})).apply(this,arguments)}},[eg,eu,P,ev,L]);var ey=(0,_.useRef)(null);function eb(){es(null),null==eo||eo.animatePlaceholder(),(0,lR.A)(ey,"border-color",x.TV.accentPrimaryDefault),setTimeout(function(){requestAnimationFrame(function(){var e;null===(e=ey.current)||void 0===e||e.style.removeProperty("border-color")})},60)}var ew=ee?function(e,t){var n=e.basicModelLimits,r=e.advancedModelLimits;switch(t){case pO.BY.BASIC:if(n.usage<n.limit)break;return{resetTime:n.resetTime};case pO.BY.ADVANCED:if(r.usage<r.limit||0===r.limit)break;return{resetTime:r.resetTime}}return null}(ee,"advanced"===P?pO.BY.ADVANCED:pO.BY.BASIC):null,eZ=(0,_.useRef)(!1);return(0,f.BX)(f.HY,{children:[(0,f.BX)(y.G,{innerRef:er.rootRef,css:bu.content,style:er.style,children:[(0,f.tZ)(H.Tg,{css:bu.header,children:(0,f.BX)(y$,{onAddButtonClick:eb,onSidebarButtonClick:function(){return er.toggle()},children:[Q?(0,f.tZ)(yz,{session:Q,onRename:function(e){ef(Q.id,{title:e})},onToggleArchived:function(){ef(Q.id,{archived:!Q.archived})}},Q.id):null,ee?(0,f.tZ)(yJ,{basic:ee.basicModelLimits,advanced:ee.basicModelLimits,isPro:$,currentModel:P,onUpgrade:function(){return R(!0)}}):null]})}),(0,f.BX)(y.G,{css:bu.main,children:[(0,f.tZ)(H.Tg,{css:bu.sidebar,innerRef:er.sidebarRef,children:(0,f.tZ)(vd,{currentSessionId:z,onSessionClick:es,onNewSessionClick:eb,updateSession:ef})}),z?(0,f.tZ)(yx,{value:null!=O?O:null,children:(0,f.tZ)(yi.s,{value:null!==(S=null==U?void 0:U.codeInsertObservable)&&void 0!==S?S:(0,yO.u)(null),children:(0,f.tZ)(yF,{sessionId:z,parentToActiveChild:q,setActiveChild:j,openFile:null==U?void 0:U.openFile,shouldAutoscrollRef:eZ})})}):(0,f.tZ)(y7,{onPromptClick:eo?function(e){var t;G(e.intent),null==eo||null===(t=eo.setValue)||void 0===t||t.call(eo,e.value),k||null==eo||eo.focus()}:void 0}),(0,f.BX)(y.G,{css:bu.chatInputWrapper,children:[ew?(0,f.tZ)(bn,{type:P,text:"advanced"===P?"Quota reached. Refreshes ".concat((0,br.Z)(new Date(ew.resetTime),"do MMM, hh:mm a")):"100% quota reached. Upgrade to get unlimited quota."}):null,ec?null:(0,f.tZ)(y.G,{css:bu.chatInput,innerRef:ey,children:(0,f.BX)(gc,{connecting:!J,inputRef:function(t){var n;ea(t),null===(n=e.inputRef)||void 0===n||n.call(e,t)},findFiles:null==U?void 0:U.findFiles,fileContextInclusions:ep,updateFileContext:function(e){return ed(e.path,e.preference)},openFile:null==U?void 0:U.openFile,maxLength:en,loading:W,onStop:F,onSubmit:function(e){var t;J&&(eZ.current=!0,X({kind:"message",message:e,model:"advanced"===P?pO.BY.ADVANCED:pO.BY.BASIC,intent:null!==(t=gg.get(D))&&void 0!==t?t:pO.$h.MESSAGE_ACTION_UNKNOWN}))},children:[(0,f.tZ)(gv,{items:bd,selectedItem:D,onChange:G}),U?(0,f.tZ)(vj,{onChange:function(e){return ed(e.path,e.preference)},findFiles:U.findFiles,fileContextInclusions:ep}):null,ee?(0,f.tZ)(vf.q2,{userLimits:ee,selectedItem:P,hasAccessToAdvancedModel:$,onChange:function(e){if(!$&&"advanced"===e){R(!0);return}A(e)},advancedChatEngineOverride:K.chatEngine}):null]})})]})]})]}),(0,f.tZ)(m2.Z,{isOpen:T,onClose:function(){return R(!1)},type:"purchase",analyticsContext:{upgrade:{context:"ai_model_selector",surface:"ghostwriter_power_up_dialog"}}})]})}var bh=n(21488),bp=n(24796),bm=n(85172),bv=h.Dy.Object({type:h.Dy.Literal("ghostwriterChat"),data:h.Dy.Optional(h.Dy.Object({sessionId:h.Dy.Optional(h.Dy.String())}))}),bg=(0,b.X)({root:[x.l0.center,x.l0.flex.growAndShrink(1),x.l0.p(16)]});function by(){return(0,f.tZ)(y.G,{css:bg.root,children:(0,f.tZ)(g.xv,{children:"AI is disabled for this team"})})}var bb={Content:function(e){var t,n,r,i,o,a,l,c,s,d,h,p,m=e.pane.data,v=e.options,g=(0,tQ.P5)({controlName:"flag-killswitch-ghostwriter-chat",logFlagToAnalytics:!1}),y=v.performPaneOperation,b=(0,_.useCallback)(function(e){y({operation:"open",pane:"string"==typeof e?(0,S.$E)(e):{type:(0,P.Dp)(e),data:e},secondary:!0})},[y]),w=(0,C.Z)(),Z=w.fs,x=w.dotReplit,E=(t=(0,A.AA)(),n=(0,bh.T)(),(0,_.useCallback)((r=(0,ts._)(function(e){var r,i,o,a,l;return(0,tu.Jh)(this,function(c){switch(c.label){case 0:return[4,Z.listFiles()];case 1:if((r=c.sent()).error||!r.files)return[2,{error:null!==(i=r.error)&&void 0!==i?i:"Something went wrong",files:null}];if(o=r.files.filter(function(e){return!n(e)}),!e)return[3,3];return[4,(0,vN.Rz)(e,o)];case 2:return l=c.sent(),[3,4];case 3:l=(0,vP.Z)(o,{existing:t(),getKey:function(e){return e}}).map(function(e){return{path:e}}),c.label=4;case 4:return a=l,[2,{total:o.length,files:a,error:null}]}})}),function(e){return r.apply(this,arguments)}),[Z,n,t])),T=(0,mj.G)(Z,x),R=(0,A._3)(),I=(i=(0,u._)((0,_.useState)(function(){return(0,yO.u)(null)}),1)[0],o=(0,k.qs)(),(0,_.useEffect)(function(){var e=function(e){return i.set((null==e?void 0:e.insertGhostwriterChatCode)&&e.revertGhostwriterChatCode?{insert:e.insertGhostwriterChatCode,revert:e.revertGhostwriterChatCode}:null)};return e(o.current),o.subscribe(e)},[o,i]),i),D=(0,_.useMemo)(function(){return{openFile:b,findFiles:E,getFileContext:T,codeInsertObservable:I}},[b,E,T,I]),G=(0,u._)((0,_.useState)(null),2),B=G[0],N=G[1],L=(0,u._)((0,_.useState)(null),2),U=L[0],O=L[1];return(l=(a={sessionId:null==U?void 0:U.sessionId,setSessionId:null==U?void 0:U.setSessionId,data:m,performPaneOperation:y}).sessionId,c=a.setSessionId,s=a.data,d=a.performPaneOperation,(0,_.useEffect)(function(){l&&d({operation:"replace",pane:{type:"ghostwriterChat",data:{sessionId:l}}})},[l,d]),h=null==s?void 0:s.sessionId,p=(0,eY.Z)(l),(0,_.useEffect)(function(){c&&h&&h!==p.current&&c(h)},[h,p,c]),(0,k.Wk)(function(){return B},[B]),(0,bm.v)().isTeamWithAiDisabled)?(0,f.tZ)(by,{}):g?(0,f.tZ)(bp.Z,{textVariant:"headerDefault",showImage:!0}):(0,f.tZ)(bf,{sessionRef:O,inputRef:N,initialSessionId:null==m?void 0:m.sessionId,recentFilesObservable:R,workspace:D})},Icon:function(e){var t=e.size;return(0,f.tZ)(m0.Z,{size:t})},getTitle:function(){return"AI"},decode:function(e){return p.B4.Decode(bv,e)}},bw=n(89788),bZ=n(18059),bx=n(24801),bC=n(2454),bS=n(35034),bk=n(15006),b_=n(71064),bE=n(9617);function bT(){var e=(0,ex._)(["\n  query SshConfigurator($replId: String!) {\n    repl(id: $replId) {\n      ... on Repl {\n        id\n        replcoSSHUrl: hostedUrl(dotty: true)\n        owner {\n          __typename\n          ... on Team {\n            id\n            isTeamsPro: subscriptionIsType(subscriptionType: PRO)\n          }\n          ... on User {\n            id\n            username\n          }\n        }\n      }\n      ... on ReplRedirect {\n        replUrl\n      }\n      ... on SubscriptionExpiredError {\n        replId\n      }\n    }\n    currentUser {\n      id\n      userSubscriptionType\n    }\n  }\n"]);return bT=function(){return e},e}var bR={},bI=(0,eC.Ps)(bT()),bD=["ssh-dsa","ssh-ecdsa","ssh-ed25519","ssh-rsa"];function bG(e){var t=e.code,n=e.multiline;return(0,f.BX)(H.Tg,{tag:"pre",elevated:!0,css:[x.l0.borderRadius(8),x.l0.p(8),x.l0.rowWithGap(8)],children:[(0,f.tZ)(g.xv,{multiline:n,css:[x.l0.overflow("auto"),x.l0.font.code,x.l0.flex.growAndShrink(1),{"::-webkit-scrollbar":[x.l0.display.none]}],maxLines:n?void 0:1,children:t}),(0,f.tZ)(m.hU,{onClick:function(){return(0,F.Z)(t)},alt:"Copy",children:(0,f.tZ)(z.Z,{})})]})}function bB(e,t){if(!e)return"Please add a key for this secret";if(!e.trim())return"The key must include a non-space character";if(t.includes(e))return"You already have this key";var n=e.split(" ");return 3!==n.length?"This seems to be an invalid key.":bD.includes(n[0])?null:"Key type is not valid."}function bP(e){return(0,f.BX)(y.G,{css:[x.l0.colWithGap(4)],children:[(0,f.tZ)("label",{htmlFor:e.id,children:(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",multiline:!1,children:e.label})}),e.children,e.error?(0,f.BX)(y.G,{css:[x.l0.rowWithGap(2),x.l0.align.center],children:[(0,f.tZ)(bk.Z,{}),(0,f.tZ)(g.xv,{variant:"small",css:x.l0.color.accentNegativeStrongest,multiline:!1,children:e.error})]}):null]})}function bA(e){var t,n=e.authorizedKey,r=e.otherKeys,i=e.onUpdateKey,o=e.onSave,a=(0,u._)((0,_.useState)(),2),l=a[0],c=a[1],s=(0,_.useRef)(null),d=function(){var e=bB(n.key,r);if(e){c(e),s.current&&s.current.focus();return}o()};(0,_.useEffect)(function(){!l||bB(n.key,r)||c(null)},[n.key,l,r]);var h=(t=function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),d())},function(e){e.stopPropagation(),t(e)}),p=(0,bZ.Cl)(),m=(0,iy.d)(),v=(0,aG.U)()("key");return(0,f.BX)(H.Tg,{elevated:!0,css:[x.l0.p(16),x.l0.borderRadius(8),x.l0.colWithGap(16)],children:[r&&0!==r.length?null:(0,f.tZ)(g.xv,{children:"Before you can SSH to your Repl, you need to add an SSH key."}),(0,f.tZ)(bP,{id:v,label:"Key (in OpenSSH Public Key format)",error:l,children:(0,f.tZ)(X.II,{id:v,ref:s,name:"key",value:n.key,spellCheck:!1,onChange:function(e){i(e.currentTarget.value)},onKeyDown:h})}),p||m?(0,f.tZ)(y.G,{css:[x.l0.colWithGap(8)],children:(0,f.BX)(g.xv,{children:["Need a hand? The"," ",(0,f.tZ)("a",{href:"https://docs.replit.com/power-ups/ssh",target:"_blank",children:"SSH documentation"})," ","provides information about generating SSH keys."]})}):(0,f.BX)(y.G,{css:[x.l0.colWithGap(8)],children:[(0,f.tZ)(g.xv,{children:"Need a hand? Generate a key:"}),(0,f.tZ)(bG,{code:'[ -s ~/.ssh/replit.pub ] || ssh-keygen -t ed25519 -f ~/.ssh/replit -q -N "" && cat ~/.ssh/replit.pub',multiline:!1}),(0,f.tZ)(g.xv,{children:"Paste the result in the form above."})]}),(0,f.tZ)(y.G,{css:[x.l0.rowWithGap(8),x.l0.justify.spaceBetween],children:(0,f.tZ)(y.G,{css:x.l0.rowWithGap(8),children:(0,f.tZ)(W.zx,{colorway:"primary",onClick:d,text:"Add SSH Key"})})})]})}function bN(e){var t=e.onAdd,n=e.otherKeys,r=(0,u._)((0,_.useState)({key:""}),2),i=r[0],o=r[1];return(0,f.tZ)(bA,{authorizedKey:i,otherKeys:n,onUpdateKey:function(e){o(function(t){return t?(0,O._)((0,U._)({},t),{key:e}):t})},onSave:function(){o({key:""}),i.key&&t(i)}})}function bL(e){var t=e.authorizedKey,n=e.onDelete;return(0,f.BX)(y.G,{css:[nn.gU.filled,x.l0.p(8),x.l0.rowWithGap(8),x.l0.align.center,x.l0.justify.spaceBetween,x.l0.borderRadius(8)],children:[(0,f.tZ)(b_.Z,{size:24}),(0,f.BX)(g.xv,{css:[x.l0.flex.growAndShrink(1)],maxLines:1,multiline:!1,children:[t.keytype," ",t.key.substring(0,8),"...",t.key.substring(t.key.length-8)," ",t.comment]}),(0,f.tZ)(m.hU,{onClick:function(){return n(t)},alt:"Delete",size:28,children:(0,f.tZ)(bS.Z,{})})]})}function bU(e){var t=e.authorizedKeys,n=e.onAdd,r=e.onDelete;return(0,f.BX)(y.G,{css:x.l0.colWithGap(16),children:[(0,f.tZ)(bE.Z,{level:4,children:"Manage SSH Keys"}),Object.values(t).map(function(e){return(0,f.tZ)(bL,{authorizedKey:e,onDelete:r},e.key)}),(0,f.tZ)(bN,{onAdd:n,otherKeys:Object.keys(t)})]})}function bO(e){if(!e.length)return null;var t=e.split(" ");return t.length<3?null:{keytype:t[0],key:t[1],comment:t[2]}}function bM(e){var t=e.sshHostname,n=e.sshUser,r=e.sshPort,i="ssh -i ~/.ssh/replit -p ".concat(r," ").concat(n,"@").concat(t);return(0,f.BX)(y.G,{css:x.l0.colWithGap(16),children:[(0,f.tZ)(bE.Z,{level:5,children:"1. Quick-Connect SSH Command"}),(0,f.tZ)(g.xv,{children:"You can connect to this Repl directly using the command below without any further configuration on your machine"}),(0,f.tZ)(bG,{code:i,multiline:!1})]})}function bX(e){var t=e.initialAlias,n=e.sshHostname,r=e.sshUser,i=e.sshPort,o=(0,bZ.Cl)(),a=(0,u._)((0,_.useState)(t),2),l=a[0],c=a[1],s=l||t,d="Host ".concat(s,"\n  Hostname ").concat(n,"\n  Port ").concat(i,"\n  User ").concat(r,"\n  IdentityFile ~/.ssh/replit");return(0,f.BX)(y.G,{css:x.l0.colWithGap(16),children:[(0,f.tZ)(bE.Z,{level:5,children:"2. SSH Configuration File"}),(0,f.BX)(g.xv,{children:["By adding a host entry to your SSH configuration file (typically"," ",(0,f.BX)(g.xv,{css:[x.l0.font.code,x.l0.display.inline,x.l0.align.baseline],children:[o?"%HOMEPATH%":"~","/.ssh/config"]}),"), you can simplify the connection process and give this Repl an alias."]}),(0,f.BX)(y.G,{css:x.l0.colWithGap(4),children:[(0,f.tZ)(g.xv,{children:"Host"}),(0,f.tZ)(g.xv,{variant:"small",color:"dimmer",children:"Enter an alias for this Repl's SSH connection. This can be anything but it can only contain letters, numbers, dots, hyphens, and underscores are allowed, it also has to be unique on your machine."}),(0,f.tZ)(X.II,{css:[x.l0.flex.grow(1),0===l.length?{borderColor:"".concat(x.TV.accentNegativeDefault," !important"),borderStyle:"solid !important",borderWidth:"1px !important",outlineColor:"".concat(x.TV.accentNegativeDefault," !important")}:null],value:l,spellCheck:!1,onChange:function(e){e.currentTarget.value.match(/^[a-zA-Z0-9.\-_]*$/)&&c(e.currentTarget.value)}})]}),(0,f.BX)(y.G,{css:x.l0.colWithGap(4),children:[(0,f.tZ)(g.xv,{children:"Configuration file"}),(0,f.tZ)(bG,{code:d,multiline:!0})]}),(0,f.BX)(y.G,{css:x.l0.colWithGap(4),children:[(0,f.tZ)(g.xv,{children:"Then connect using the following command"}),(0,f.tZ)(bG,{code:"ssh ".concat(s),multiline:!1})]})]})}function bF(e){var t=e.sshHostname,n=e.sshUser,r=e.sshPort;return(0,f.BX)(y.G,{css:x.l0.colWithGap(16),children:[(0,f.tZ)(bE.Z,{level:5,children:"3. SSH Client Configuration"}),(0,f.tZ)(g.xv,{children:"There are many SSH clients available. Some even come with a graphical interface such as PuTTY (on Windows) or Termius (on Mac). You can configure your SSH key and the following values:"}),(0,f.BX)(y.G,{children:[(0,f.BX)(y.G,{css:x.l0.colWithGap(2),children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Hostname"}),(0,f.tZ)(bG,{code:t,multiline:!1})]}),(0,f.BX)(y.G,{css:x.l0.colWithGap(2),children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Username"}),(0,f.tZ)(bG,{code:n,multiline:!1})]}),(0,f.BX)(y.G,{css:x.l0.colWithGap(2),children:[(0,f.tZ)(g.xv,{multiline:!1,children:"Port"}),(0,f.tZ)(bG,{code:r,multiline:!1})]})]})]})}function bW(e){var t=e.sshHostname,n=e.sshUser,r=e.sshPort,i=(0,C.Z)().container,o=(0,u._)((0,_.useState)("/home/runner"),2),a=o[0],l=o[1];return(0,_.useEffect)(function(){i.exec("pwd").then(function(e){var t;e.output&&l((null===(t=e.output)||void 0===t?void 0:t.replace("\n",""))||"")})},[i]),(0,f.BX)(y.G,{css:[x.l0.colWithGap(8)],children:[(0,f.tZ)(bE.Z,{level:5,children:"VSCode"}),(0,f.tZ)(g.xv,{children:"Make sure you add the following entry to your SSH config:"}),(0,f.tZ)(bG,{code:"Host *.replit.dev \n  Port ".concat(r,"\n  IdentityFile ~/.ssh/replit"),multiline:!0}),(0,f.tZ)(rB.Z,{text:"Open in VSCode",href:function(){var e="vscode://vscode-remote/ssh-remote+".concat(n,"@").concat(t,":").concat(r).concat(a);try{return window.encodeURI(e)}catch(e){}return e}(),colorway:"primary",iconLeft:(0,f.tZ)(oJ.Z,{})})]})}function bH(e){var t=e.replId,n=function(e){var t=e.replId,n=e.replcoHostname,r=(0,C.Z)().container,i=(0,me.Z)(r);if(i){var o=new URL(i).host,a=o.indexOf(":"),l="22";return -1!==a&&(o=o.substring(0,a),l="2022"),{sshUser:t,sshHostname:o,sshPort:l}}return{sshUser:t,sshHostname:n,sshPort:"22"}}({replId:t,replcoHostname:e.replcoHostname}),r=n.sshHostname,i=n.sshUser,o=n.sshPort,a=(0,tQ.P5)({controlName:"flag-vscode-ssh"});return(0,f.BX)(y.G,{css:x.l0.colWithGap(32),children:[(0,f.BX)(y.G,{css:x.l0.colWithGap(8),children:[(0,f.tZ)(bE.Z,{level:4,children:"Connecting to this Repl"}),(0,f.tZ)(g.xv,{children:"Now that you have setup an SSH key. There are three ways you can connect to this Repl."})]}),a?(0,f.tZ)(bW,{sshHostname:r,sshUser:i,sshPort:o}):null,(0,f.tZ)(bM,{sshHostname:r,sshUser:i,sshPort:o}),(0,f.tZ)(bX,{initialAlias:t,sshHostname:r,sshUser:i,sshPort:o}),(0,f.tZ)(bF,{sshHostname:r,sshUser:i,sshPort:o})]})}function bV(){return(bV=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){switch(t.label){case 0:return[4,e.createDir(".config")];case 1:return t.sent(),[4,e.createDir(".config/ssh")];case 2:return t.sent(),[2]}})})).apply(this,arguments)}function bz(e){var t,n,r,i=e.replId,o=e.replcoHostname,a=(0,C.Z)().fs,l=(0,u._)((0,_.useState)(null),2),c=l[0],s=l[1];(0,_.useEffect)(function(){function e(){return(e=(0,ts._)(function(){var e,t;return(0,tu.Jh)(this,function(n){switch(n.label){case 0:return[4,function(e){return bV.apply(this,arguments)}(a)];case 1:return n.sent(),[4,a.readFile(".config/ssh/.authorized_keys")];case 2:if((e=n.sent()).error===cN.Df.NotFound)return s({}),[2];if(e.error)throw Error("Error getting .authorized_keys");return t={},e.content.toString().split("\n").forEach(function(e){if(!e.startsWith("#")){var n=bO(e);null!==n&&(t[n.key]=n)}}),s(t),[2]}})})).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[a,s]);var d=(t=(0,ts._)(function(e){var t,n;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:if(!c)throw Error("trying to write authorized keys before loading");return s(t=function(e,t){var n=(0,U._)({},e);if("add"===t.type){var r=bO(t.key);r&&(n[r.key]=r)}else delete n[t.key];return n}(c,e)),n="# generated file, use the SSH tool instead of editing\n"+Object.values(t).map(function(e){return"".concat(e.keytype," ").concat(e.key," ").concat(e.comment)}).join("\n"),[4,a.writeFile(".config/ssh/.authorized_keys",tG.Z.from(n))];case 1:return r.sent(),[2]}})}),function(e){return t.apply(this,arguments)}),h=(n=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){switch(t.label){case 0:return[4,d((0,U._)({type:"add"},e))];case 1:return t.sent(),(0,nw.j)(nw.U3.SSH_CONFIGURATOR_USED,{action:"added"}),[2]}})}),function(e){return n.apply(this,arguments)}),p=(r=(0,ts._)(function(e){return(0,tu.Jh)(this,function(t){switch(t.label){case 0:return[4,d({type:"delete",key:e.key})];case 1:return t.sent(),(0,nw.j)(nw.U3.SSH_CONFIGURATOR_USED,{action:"deleted"}),[2]}})}),function(e){return r.apply(this,arguments)});return c?(0,f.BX)(y.G,{css:x.l0.colWithGap(16),children:[(0,f.BX)(g.xv,{variant:"small",color:"dimmer",children:["Add authorized keys to configure SSH access to this Repl."," ",(0,f.tZ)("a",{href:"https://docs.replit.com/power-ups/ssh",target:"_blank",children:"Learn more here"}),"."]}),(0,f.BX)(y.G,{css:x.l0.colWithGap(32),children:[(0,f.tZ)(bU,{authorizedKeys:c,onAdd:h,onDelete:p}),Object.keys(c).length>0?(0,f.tZ)(bH,{replId:i,replcoHostname:o}):null]})]}):(0,f.tZ)(y.G,{css:[x.l0.center,x.l0.coverContainer],children:(0,f.tZ)(Z.Z,{size:24})})}function bj(e){var t=e.onPurchaseComplete,n=(0,u._)((0,_.useState)(!1),2),r=n[0],i=n[1];return(0,f.BX)(y.G,{css:[x.l0.colWithGap(16)],children:[(0,f.BX)(g.h4,{level:3,variant:"subheadDefault",children:["SSH is only available to Replit ",be.we," Members."]}),(0,f.BX)(g.xv,{children:["With SSH, you can access your Repl's shell remotely. SSH enables workflows like easy file transfer or using your favorite local IDE to edit your code on Replit."," ",(0,f.tZ)("a",{href:"https://docs.replit.com/power-ups/ssh",target:"_blank",children:"Learn more here"})]}),(0,f.tZ)(W.zx,{onClick:function(){return i(!0)},text:"Join Replit ".concat(be.we),iconLeft:(0,f.tZ)(bC.Z,{}),colorway:"blurple"}),(0,f.tZ)(m2.Z,{isOpen:r,onClose:function(){return i(!1)},type:"purchase",onPurchaseComplete:t,analyticsContext:{upgrade:{context:"cycles_page"}}})]})}var bq=(0,b.X)({header:[x.l0.colWithGap(4)]});function bY(e){return(0,f.BX)(y.G,{css:bq.header,children:[(0,f.tZ)(g.h4,{variant:"subheadDefault",level:2,children:"Use Replit with another editor"}),(0,f.tZ)(g.xv,{color:"dimmer",children:"SSH allows you to connect to a Repl from another machine or IDE."})]})}function bJ(){var e,t,n=(0,eZ.Z)(),r=(0,tQ.P5)({controlName:"flag-ssh-pane-redesign"}),i=(e=(0,U._)({},bR,{variables:{replId:n}}),eS.a(bI,e)),o=i.data,a=i.loading,l=i.refetch;if(!o||a)return(0,f.tZ)(y.G,{css:[x.l0.center,x.l0.coverContainer],children:(0,f.tZ)(Z.Z,{size:24})});if("ReplRedirect"===o.repl.__typename)throw Error("Got repl redirect for replId query");if("SubscriptionExpiredError"===o.repl.__typename)return(0,f.tZ)(y.G,{children:(0,f.tZ)(g.xv,{children:"This Repl is private and your subscription expried. Please reload for further action."})});if(!o.currentUser)return(0,f.tZ)(y.G,{children:(0,f.tZ)(g.xv,{children:"You must be logged in to use SSH."})});var c=(0,bx.jX)(o.currentUser.userSubscriptionType),s=(null===(t=o.repl.owner)||void 0===t?void 0:t.__typename)==="Team"&&o.repl.owner.isTeamsPro;if(!(c||s))return(0,f.tZ)(bj,{onPurchaseComplete:function(){l()}});var u={replId:o.repl.id,replcoHostname:new URL(o.repl.replcoSSHUrl).hostname};return r?(0,f.tZ)(bY,(0,U._)({},u)):(0,f.tZ)(bz,(0,U._)({},u))}function bK(e){var t=e.children;return(0,f.tZ)(y.G,{css:[x.l0.height("100%"),x.l0.overflowY("auto"),P.F3],children:(0,f.BX)(y.G,{css:[x.l0.p(8),x.l0.colWithGap(8),x.l0.flex.grow(1)],children:[(0,f.tZ)(y.G,{css:[x.l0.rowWithGap(8)],children:(0,f.tZ)(bE.Z,{truncate:!0,level:4,children:"SSH Configuration"})}),(0,f.tZ)(y.G,{css:[x.l0.flex.grow(1),x.l0.py(8),x.l0.position.relative],children:t})]})})}var b$=h.Dy.Object({type:h.Dy.Literal("sshConfigurator")}),bQ={Content:function(){return(0,f.tZ)(b0,{})},Icon:function(e){var t=e.size;return(0,f.tZ)(bw.Z,{size:t})},getTitle:function(){return"SSH"},decode:function(e){return p.B4.Decode(b$,e)}};function b0(){return(0,f.tZ)(bK,{children:(0,f.tZ)(bJ,{})})}var b1=(0,b.X)({header:[x.l0.flex.row,x.l0.justify.spaceBetween,x.l0.height(36)]});function b2(e){var t=e.name,n=e.onAddClick,r=e.children;return(0,f.BX)(y.G,{children:[(0,f.BX)(y.G,{css:b1.header,children:[(0,f.tZ)(g.h4,{variant:"subheadDefault",level:2,children:(0,em.Z)(t)}),(0,f.tZ)(m.hU,{alt:"Add ".concat(t.toLowerCase()),onClick:n,children:(0,f.tZ)(na.Z,{})})]}),(0,f.tZ)(y.G,{children:r})]})}(r=c||(c={})).Overview="Overview",r.PackageInfo="PackageInfo",r.Search="Search",(i=s||(s={})).Runtime="Runtime",i.Packager="Packager",i.Formatter="Formatter",i.LanguageServer="LanguageServer";var b8=(0,b.X)({root:[x.l0.colWithGap(8)],package:[x.l0.p(4),x.l0.rowWithGap(8),x.l0.align.center,x.l0.border({color:"transparent"})],emptyState:[x.l0.p(4)],packager:[x.l0.backgroundColor.backgroundHigher,x.l0.borderRadius(4)],packagerHeader:[x.l0.px(4)]});function b4(e){var t=e.text;return(0,f.tZ)(y.G,{css:b8.emptyState,children:(0,f.tZ)(g.xv,{color:"dimmer",children:t})})}function b3(e){var t=e.pkg,n=e.onClick;return(0,f.BX)(y.G,{css:b8.package,onClick:n,children:[(0,f.tZ)(ht.Z,{}),(0,f.tZ)(g.xv,{children:t.name}),(0,f.tZ)(g.xv,{color:"dimmer",children:t.spec})]})}function b5(e){var t,n=e.pkg,r=e.openConsole,i=e.setViewState,o=ha(),a=hc(n),l=a?(0,O._)((0,U._)({},a),{version:null!==(t=n.spec)&&void 0!==t?t:a.version}):n,s=(null==o?void 0:o.id)==="nix"?null==a?void 0:a.prettyName:void 0;return(0,f.BX)(y.G,{children:[(0,f.tZ)(m.hU,{alt:"Back",onClick:function(){i({view:c.Overview})},children:(0,f.tZ)(sP.Z,{})}),(0,f.tZ)(hZ,{pkg:l,name:s,isMetadataLoading:null==a,openConsole:r})]})}function b6(e){var t=e.setViewState,n=ha(),r=(0,hn.te)(null==n?void 0:n.id);return n?(0,f.BX)(y.G,{css:b8.packager,children:[(0,f.tZ)(y.G,{css:b8.packagerHeader,onClick:function(){t({view:c.Search,initialContext:n})},children:(0,f.tZ)(g.xv,{children:n.name})}),r.length>0?r.map(function(e){return(0,f.tZ)(b3,{pkg:e,onClick:function(){return t({view:c.PackageInfo,pkg:e,config:n})}},e.name)}):(0,f.tZ)(b4,{text:"Add ".concat(n.title," packages...")})]}):null}function b9(e){var t=(0,hV.I)().configs;return(0,f.tZ)(y.G,{css:b8.root,children:t.map(function(t){return(0,f.tZ)(hj,{config:t,children:(0,f.tZ)(b6,(0,U._)({},e))},t.id)})})}var b7=n(8123),we=(0,b.X)({item:[x.l0.borderRadius(4),x.l0.height(32),x.l0.flex.row,x.l0.align.center,x.l0.p(8)]});function wt(e){var t=e.title;return(0,f.tZ)(H.Tg,{elevated:!0,css:we.item,children:(0,f.tZ)(g.xv,{children:t})})}var wn=(0,b.X)({runtimes:[x.l0.colWithGap(8)]});function wr(){var e=(0,b7._)().configs,t=e?e.runs:[];return(0,f.tZ)(y.G,{css:wn.runtimes,children:t.map(function(e){return(0,f.tZ)(wt,{title:e.name},e.id)})})}var wi=(0,b.X)({formatters:[x.l0.colWithGap(8)]});function wo(){var e=(0,b7._)().configs,t=e?e.formatters:[];return(0,f.tZ)(y.G,{css:wi.formatters,children:t.map(function(e){return(0,f.tZ)(wt,{title:e.name},e.id)})})}var wa=(0,b.X)({languageServers:[x.l0.colWithGap(8)]});function wl(){var e=(0,b7._)().configs,t=e?e.languageServers:[];return(0,f.tZ)(y.G,{css:wa.languageServers,children:t.map(function(e){return(0,f.tZ)(wt,{title:e.name},e.id)})})}var wc=(0,b.X)({packagerResults:[x.l0.colWithGap(8)]});function ws(e){var t=e.query,n=ha(),r=(0,u._)((0,_.useState)([]),2),i=r[0],o=r[1],a=(0,_.useRef)(0),l=hG(),c=(null==n?void 0:n.id)==="nix"?hN:hL;return(0,hD.Z)(function(){if(""===t.trim()){o([]);return}var e,n=++a.current;(e=(0,ts._)(function(){var e;return(0,tu.Jh)(this,function(r){switch(r.label){case 0:return[4,l(t)];case 1:if(e=r.sent(),n!==a.current)return[2];return o(e),[2]}})}),function(){return e.apply(this,arguments)})()},[t],500),(0,f.tZ)(y.G,{css:wc.packagerResults,children:i.map(function(e){return(0,f.tZ)(c,{pkg:e,openConsole:function(){}},e.name)})})}function wu(e){var t=e.query,n=(0,C.Z)().toolchain,r=(0,u._)((0,_.useState)(null),2),i=r[0],o=r[1],a=(0,u._)((0,_.useState)([]),2),l=a[0],c=a[1];return(0,_.useEffect)(function(){n.getRegistry().then(function(e){o(e)})},[n,o]),(0,hD.Z)(function(){var e;if(!t){c([]);return}c((null==i?void 0:null===(e=i.modules)||void 0===e?void 0:e.filter(function(e){return e.name.toLowerCase().includes(t.toLowerCase())}))||null)},[t,i],500),(0,f.tZ)(y.G,{children:null==l?void 0:l.map(function(e){return(0,f.tZ)(y.G,{children:(0,f.tZ)(g.xv,{children:e.name})},e.id)})})}function wd(e){return"string"==typeof e}function wf(e){var t=e.setViewState,n=e.initialContext,r=(0,u._)((0,_.useState)(""),2),i=r[0],o=r[1],a=(0,u._)((0,_.useState)(n),1)[0];return(0,f.BX)(y.G,{children:[(0,f.BX)(y.G,{children:[(0,f.tZ)(m.hU,{alt:"Back",onClick:function(){t({view:c.Overview})},children:(0,f.tZ)(sP.Z,{})}),(0,f.tZ)(ni.E,{value:i,onChange:function(e){o(e.target.value)},placeholder:function(e){if(!wd(e))return"Search ".concat(e.name.toLowerCase()," packages");switch(e){case s.Formatter:return"Filter formatters";case s.LanguageServer:return"Filter language servers";case s.Packager:return"Filter packagers";case s.Runtime:return"Filter runtimes";default:(0,t7.Z)(e)}}(a)})]}),(0,f.tZ)(y.G,{children:wd(a)?(0,f.tZ)(wu,{query:i}):(0,f.tZ)(hj,{config:a,children:(0,f.tZ)(ws,{query:i})})})]})}var wh=(0,b.X)({root:[x.l0.p(12),x.l0.colWithGap(8)]});function wp(e){var t=e.openConsole,n=(0,u._)((0,_.useState)({view:c.Overview}),2),r=n[0],i=n[1];return r.view===c.PackageInfo?(0,f.tZ)(hj,{config:r.config,children:(0,f.tZ)(b5,{pkg:r.pkg,openConsole:t,setViewState:i})}):r.view===c.Search?(0,f.tZ)(wf,{initialContext:r.initialContext,setViewState:i}):(0,f.BX)(y.G,{css:wh.root,children:[(0,f.tZ)(b2,{name:"Runtime",onAddClick:function(){i({view:c.Search,initialContext:s.Runtime})},children:(0,f.tZ)(wr,{})}),(0,f.tZ)(b2,{name:"Packager",onAddClick:function(){i({view:c.Search,initialContext:s.Packager})},children:(0,f.tZ)(b9,{setViewState:i})}),(0,f.tZ)(b2,{name:"Formatter",onAddClick:function(){i({view:c.Search,initialContext:s.Formatter})},children:(0,f.tZ)(wo,{})}),(0,f.tZ)(b2,{name:"Language server",onAddClick:function(){i({view:c.Search,initialContext:s.LanguageServer})},children:(0,f.tZ)(wl,{})})]})}var wm=h.Dy.Object({type:h.Dy.Literal("dependencies")}),wv={Content:function(e){var t=e.options;return(0,f.tZ)(wp,{openFile:function(e){return t.performPaneOperation({operation:"open",pane:(0,S.$E)(e),secondary:!0})},openConsole:function(){t.performPaneOperation({operation:"open",pane:{type:"runnerOutput"},secondary:!0})}})},Icon:function(e){var t=e.size;return(0,f.tZ)(pK.Z,{size:t})},getTitle:function(){return"Dependencies"},decode:function(e){return p.B4.Decode(wm,e)}};function wg(){var e=(0,ex._)(["\n  fragment PullRequestSummaryPullRequest on PullRequest {\n    id\n    title\n    body\n    number\n    url\n  }\n"]);return wg=function(){return e},e}var wy=(0,eC.Ps)(wg());function wb(){var e=(0,ex._)(["\n  query CodeReviewPullRequests($input: PullRequestsInput!) {\n    pullRequests(input: $input) {\n      __typename\n      ... on PullRequestsResult {\n        pullRequests {\n          id\n          ...PullRequestSummaryPullRequest\n        }\n      }\n      ... on Error {\n        message\n      }\n    }\n  }\n  ","\n"]);return wb=function(){return e},e}var ww={},wZ=(0,eC.Ps)(wb(),wy),wx=/github.com(?::|\/)(.*)\/(.*)/,wC=(0,b.X)({self:[x.l0.colWithGap(24)],headerRow:[x.l0.colWithGap(8)],loadingWrapper:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.p(32)],bodyAccordionWrapper:[{marginLeft:"-4px",marginRight:"-4px"}],bodyContentWrapper:[x.l0.py(16),x.l0.px(8),x.l0.mt(8),x.l0.borderRadius(4)],body:[{"& h1":{fontSize:"1.5em"},"& h2":{fontSize:"1.25em"},"& h3":{fontSize:"1em"},"& h4":{fontSize:"0.875em"},"& h5":{fontSize:"0.85em"},"& h6":{fontSize:"0.85em"}}]});function wS(e){var t=e.pullRequest;return(0,f.BX)(y.G,{css:wC.self,children:[(0,f.tZ)(y.G,{css:wC.headerRow,children:(0,f.BX)(g.h4,{variant:"headerDefault",level:3,children:[t.title," ",(0,f.BX)("a",{target:"_blank",href:t.url,children:["#",t.number]})]})}),(0,f.tZ)(y.G,{css:wC.bodyAccordionWrapper,children:(0,f.tZ)(ed.Q,{headerContent:(0,f.tZ)(g.h4,{variant:"subheadBig",level:3,children:"Description"}),defaultExpanded:!0,children:(0,f.tZ)(H.Tg,{css:wC.bodyContentWrapper,elevated:!0,children:(0,f.tZ)(nC.ZP,{css:wC.body,children:t.body})})})})]})}var wk=(0,b.X)({self:[x.l0.height("100%"),x.l0.width("100%"),x.l0.colWithGap(16),x.l0.px(16),x.l0.py(8)],loadingWrapper:[x.l0.rowWithGap(8),x.l0.align.center,x.l0.p(32)]}),w_=function(){return(0,f.tZ)(y.G,{css:wk.loadingWrapper,children:(0,f.tZ)(Z.Z,{})})};function wE(e){var t=e.children;return(0,f.BX)(H.Tg,{css:wk.self,children:[(0,f.tZ)(g.h4,{variant:"headerDefault",level:3,children:"Code Review"}),t]})}function wT(e){var t,n,r=(t={variables:{input:{replId:e.replId,repo:e.repo,repoOwner:e.repoOwner,branch:e.branch}},fetchPolicy:"network-only",ssr:!1},n=(0,U._)({},ww,t),eS.a(wZ,n)),i=r.loading,o=r.data,a=r.error,l=(null==o?void 0:o.pullRequests.__typename)==="PullRequestsResult"?o.pullRequests.pullRequests:[];return i?(0,f.tZ)(wE,{children:(0,f.tZ)(w_,{})}):(null==o?void 0:o.pullRequests.__typename)!=="PullRequestsResult"||a?(0,f.tZ)(wE,{children:(0,f.tZ)(g.xv,{children:"This Repl is not supported currently."})}):0===l.length?(0,f.tZ)(wE,{children:(0,f.tZ)(g.xv,{children:"No open PRs."})}):(0,f.tZ)(H.Tg,{css:wk.self,children:(0,f.tZ)(wS,{pullRequest:l[0]})})}function wR(){var e,t,n=(0,pW.Z)(),r=null==(t=(0,td.Z)((e=(0,ts._)(function(e){var t,n,r,i,o,a,l;return(0,tu.Jh)(this,function(c){switch(c.label){case 0:return[4,e.isInitialized()];case 1:if((t=c.sent()).error)return[2,{error:t.error}];if(!t.initialized)return[2,{error:ri.aq.NOT_INITIALIZED}];return[4,e.status()];case 2:if((n=c.sent()).error)return[2,{error:n.error}];return[4,e.getRemotes()];case 3:if((r=c.sent()).error)return[2,{error:r.error}];if(!(i=n.branch)||!(o=r.remotes.get("origin"))||((a=o.fetch).replace(/.git$/,""),null==(l=wx.exec(a))||l.length<3))return[2,{error:ri.aq.UNKNOWN}];return[2,{repoOwner:l[1],repo:l[2],branch:i,error:null}]}})}),function(t){return e.apply(this,arguments)}),[]))?{loading:!0,error:null,data:null}:t.error?{loading:!1,error:"Something went wrong",data:null}:(t.error,{loading:!1,error:null,data:(0,eL._)(t,["error"])});return!n||r.loading?(0,f.tZ)(wE,{children:(0,f.tZ)(w_,{})}):null!==r.error?(0,f.tZ)(wE,{children:(0,f.tZ)(g.xv,{children:"This Repl is not supported currently."})}):(0,f.tZ)(wT,(0,U._)({replId:n.id},r.data))}var wI=h.Dy.Object({type:h.Dy.Literal("codeReview")}),wD={Content:function(){return(0,f.tZ)(wR,{})},Icon:function(e){var t=e.size;return(0,f.tZ)(rc.Z,{size:t})},getTitle:function(){return"Code Review"},decode:function(e){return p.B4.Decode(wI,e)}};function wG(){return{codeEditor:G.D,webview:mf.Rm,media:cV,binary:I,pedit:h9,vnc:mu,unitTests:p3,adminPanel:mQ,runnerOutput:pl.G,shell:pY,packager:hK,dependencies:wv,systemDependencies:p2,envEditor:tJ,draw:tV,git:ln,diff:tC,history:ck,database:eB,neon:da,markdown:cF,sshConfigurator:bQ,ghostwriterChat:bb,problems:pa,networking:dR,objectStorage:he,codeReview:wD}}},35614:function(e,t,n){n.d(t,{T:function(){return o},u:function(){return a}});var r=n(68956),i=(0,n(19713).cn)(null);function o(){return(0,r.$X)(i)}function a(){return(0,r.Hg)(i)}},76568:function(e,t,n){n.d(t,{L5:function(){return b},Wk:function(){return D},Xq:function(){return A},Y6:function(){return w},bS:function(){return G},c4:function(){return E},dr:function(){return Z},qs:function(){return C},u1:function(){return _}});var r=n(27387),i=n(66626),o=n(63257),a=n(96583),l=n(7444),c=n(50199),s=n(62624),u=n(64461),d=n(19713),f=n(69852),h=n(50959),p=n(34581),m=n(68956),v=n(67696),g=(0,d.cn)({}),y=(0,d.cn)(null,function(e,t,n){t(g,function(e){return(0,u.Uy)(e,function(e){null===n.actions?delete e[n.paneId]:e[n.paneId]=n.actions})})});function b(e,t){var n=P(),r=(0,m.$X)(y),i=(0,l.Z)(e);(0,h.useEffect)(function(){var e;return r({paneId:n,actions:null!==(e=i.current())&&void 0!==e?e:null}),function(){r({paneId:n,actions:null})}},[r,n,i].concat((0,o._)(t)))}function w(e){var t=(0,c.Z)(function(){return(0,f.kv)(g,function(t){return e?t[e]:{}})},[e]);return(0,m.Hg)(t)}function Z(){var e=(0,m.XD)(g);return(0,h.useCallback)(function(t){var n;return null!==(n=e()[t])&&void 0!==n?n:null},[e])}var x=(0,d.cn)(function(e){var t=e(v._s);if(!t||!t.isVisible)return null;var n=!0,r=!1,o=void 0;try{for(var a,l=e(p.A1)[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c,s=(0,i._)(a.value,2),u=s[0],d=s[1];if("codeEditor"===d.type&&d.data.path===t.path){var f=null!==(c=e(g)[u])&&void 0!==c?c:null;return(null==f?void 0:f.type)==="codeEditor"?f:null}}}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}return null});function C(){return(0,m.yL)(x)}var S=(0,d.cn)(new Map),k=(0,d.cn)(null,function(e,t,n,r){t(S,function(e){var t=new Map(e);return null===r?t.delete(n):r&&t.set(n,r),t})});function _(){return(0,m.$X)(k)}function E(){var e,t,n=(e=(0,m.rF)(),(0,h.useCallback)(function(t){return e((0,f.kv)(g,function(e){return e[t]}))},[e]));return(0,h.useCallback)((t=(0,r._)(function(e){return(0,a.Jh)(this,function(t){return[2,new Promise(function(t){var r=n(e);if(r.current){t(r.current);return}var i=r.subscribe(function(e){e&&(t(e),i())})})]})}),function(e){return t.apply(this,arguments)}),[n])}var T=(0,d.cn)(new Map),R=(0,d.cn)(null,function(e,t,n){t(T,function(e){return(0,u.Uy)(e,function(e){null===n.focus?e.delete(n.paneId):e.set(n.paneId,n.focus)})})});function I(e){var t=document.activeElement;return!!e&&!!t&&e!==t&&e.contains(t)}function D(e,t){var n=(0,l.Z)(e),r=P(),a=(0,s.Z)(),c=(0,h.useRef)(!a),u=(0,m.$X)(R),d=(0,m.XD)(p.J1),f=(0,m.XD)(S),v=(0,i._)((0,h.useState)(null),2),g=v[0],y=v[1];return(0,h.useEffect)(function(){n.current&&y(n.current())},t?(0,o._)(t):[]),(0,h.useEffect)(function(){var e=function(e){d()===r&&e.target!==f().get(r)&&(c.current=!1)};return document.body.addEventListener("focus",e,!0),function(){document.body.removeEventListener("focus",e,!0)}},[d,f,r]),(0,h.useEffect)(function(){if(g){var e=function(){g.focus()};return c.current&&d()===r&&!I(f().get(r))&&e(),u({paneId:r,focus:e}),function(){u({paneId:r,focus:null})}}},[g,u,r,d,f,a]),y}function G(){var e=(0,m.XD)(T),t=(0,m.XD)(S);return(0,c.Z)(function(){return function(n){var r=e().get(n),i=t().get(n);if(!I(i)){if(r){r();return}null==i||i.focus()}}},[e,t])}var B=(0,h.createContext)(null);function P(){var e=(0,h.useContext)(B);if(!e)throw Error("Expected pane id in context");return e}var A=B.Provider},34581:function(e,t,n){n.d(t,{A1:function(){return C},AA:function(){return A},J1:function(){return p},Np:function(){return I},WU:function(){return m},Xo:function(){return B},fg:function(){return N},gv:function(){return G},jY:function(){return P},mz:function(){return U},nC:function(){return D}});var r=n(66626),i=n(63257),o=n(3947),a=n(59510),l=n.n(a),c=n(64461),s=n(19713),u=n(50959),d=n(50199),f=n(68956),h=n(15592),p=(0,s.cn)(null);function m(){return(0,f.XD)(p)}var v=(0,s.cn)(new Map),g=(0,s.cn)([]),y=(0,s.cn)(null,function(e,t,n){t(v,function(e){return(0,c.Uy)(e,function(e){var t=e.get(n.paneId),r=Date.now();if(!t){e.set(n.paneId,{panes:[n.pane],lastActiveAt:r});return}var i=t.panes[t.panes.length-1];t.lastActiveAt=r,l()(n.pane,i)||t.panes.push(n.pane)})}),t(p,n.paneId)}),b=(0,s.cn)(null,function(e,t,n){var r=e(p),i=e(v).get(n);i&&t(g,function(e){return(0,c.Uy)(e,function(e){e.push(i.panes)})}),t(v,function(e){return(0,c.Uy)(e,function(e){e.delete(n)})}),r===n&&t(p,null)}),w=(0,s.cn)(null,function(e,t,n){t(v,function(e){return(0,c.Uy)(e,function(e){var t=e.get(n);t&&(t.lastActiveAt=Date.now())})}),t(p,n)}),Z=(0,s.cn)(null,function(e,t){t(p,null)}),x=(0,s.cn)(function(e){return(0,i._)(e(v).values()).sort(function(e,t){return t.lastActiveAt-e.lastActiveAt}).map(function(e){return e.panes})}),C=(0,s.cn)(function(e){var t=e(v),n=[];return t.forEach(function(e,t){var r=e.panes[e.panes.length-1];r&&n.push([t,r,e.lastActiveAt])}),n.sort(function(e,t){return e[2]-t[2]})}),S=(0,s.cn)(function(e){var t=[],n=!0,i=!1,a=void 0;try{for(var l,c=e(C)[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=(0,r._)(l.value,2),u=(s[0],s[1]),d=(0,o.Ur)(u)?u.data.path:null;d&&t.push(d)}}catch(e){i=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(i)throw a}}return t}),k=(0,s.cn)(function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var a,l=e(x)[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value;c.length<=1||t.push.apply(t,(0,i._)(c.slice(0,-1)))}}catch(e){r=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw o}}var s=!0,u=!1,d=void 0;try{for(var f,h=e(g)[Symbol.iterator]();!(s=(f=h.next()).done);s=!0){var p=f.value;t.push.apply(t,(0,i._)(p))}}catch(e){u=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(u)throw d}}return t}),_=(0,s.cn)(null,function(e,t){var n=e(g).flat().pop();return t(g,function(e){return(0,c.Uy)(e,function(e){var t=e.pop();t&&t.pop()})}),n}),E=(0,s.cn)(function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,l=e(k)[Symbol.iterator]();!(n=(a=l.next()).done);n=!0){var c=a.value,s=(0,o.Ur)(c)?c.data.path:null;s&&t.push(s)}}catch(e){r=!0,i=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return t}),T=(0,s.cn)(function(e){return(0,i._)(e(S)).concat((0,i._)(e(E)))}),R=(0,s.cn)(function(e){var t,n=e(p);if(!n)return null;var r=e(v).get(n);return r&&null!==(t=r.panes[r.panes.length-1])&&void 0!==t?t:null});function I(e,t){var n=(0,f.$X)(y),r=(0,f.$X)(b);(0,u.useEffect)(function(){n({paneId:e,pane:t})},[n,e,t]),(0,u.useEffect)(function(){return function(){r(e)}},[r,e])}function D(){return(0,f.XD)(C)}function G(){return(0,f.$X)(_)}function B(){return(0,f.$X)(w)}function P(){return(0,f.$X)(Z)}function A(){return(0,f.Hg)(T)}function N(){var e=(0,f.yL)(S);return(0,d.Z)(function(){return function(t){return new Promise(function(n,r){var i=e.subscribe(function(e){e.includes(t)||(i(),n())})})}},[e])}(0,s.cn)(function(e){var t=e(R);return t&&(0,o.Ur)(t)&&t.data.path||null});var L=(0,s.cn)(function(e){return(0,h.w)(e(S))});function U(){return(0,f.Hg)(L)}},95684:function(e,t,n){n.d(t,{mK:function(){return s},qm:function(){return l},xx:function(){return c}});var r=n(19713),i=n(50959),o=n(68956),a=(0,r.cn)(!1);function l(){return(0,o.Hg)(a)}function c(){var e=(0,o.$X)(a);return(0,i.useCallback)(function(){return e(!0)},[e])}function s(e){var t=(0,o.$X)(a),n=(0,i.useRef)(!1);(0,i.useEffect)(function(){n.current||(n.current=!0,t(e))},[t,e])}},39327:function(e,t,n){n.d(t,{a9:function(){return a},kM:function(){return l}});var r=n(19713),i=n(68956),o=(0,r.cn)(null);function a(){return(0,i.$X)(o)}function l(){return(0,i.Hg)(o)}},80502:function(e,t,n){n.d(t,{Z:function(){return L}});var r,i=n(27387),o=n(66626),a=n(63257),l=n(96583),c=n(43182),s=n(25632),u=n(89106),d=n(56337),f=n(7444),h=n(10041),p=n(40473),m=n(63009),v=n(27308),g=n(96003),y=n(50959),b=n(26508),w=n(30826),Z=n.n(w)()(function(){if("undefined"!=typeof AudioContext){var e=(r||(r=new AudioContext),r),t=e.createBufferSource();e.decodeAudioData(function(e){for(var t=window.atob(e),n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=t.charCodeAt(i);return r.buffer}("SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjMyLjEwNAAAAAAAAAAAAAAA//tQxAADB8AhSmxhIIEVCSiJrDCQBTcu3UrAIwUdkRgQbFAZC1CQEwTJ9mjRvBA4UOLD8nKVOWfh+UlK3z/177OXrfOdKl7pyn3Xf//WreyTRUoAWgBgkOAGbZHBgG1OF6zM82DWbZaUmMBptgQhGjsyYqc9ae9XFz280948NMBWInljyzsNRFLPWdnZGWrddDsjK1unuSrVN9jJsK8KuQtQCtMBjCEtImISdNKJOopIpBFpNSMbIHCSRpRR5iakjTiyzLhchUUBwCgyKiweBv/7UsQbg8isVNoMPMjAAAA0gAAABEVFGmgqK////9bP/6XCykxBTUUzLjEwMKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"),function(n){t.buffer=n,t.connect(e.destination),t.start(0)})}},500,{leading:!0,trailing:!0}),x="replit-icons-font",C=n(2689),S="BESbswy";function k(e){return _.apply(this,arguments)}function _(){return(_=(0,i._)(function(e){return(0,l.Jh)(this,function(t){switch(t.label){case 0:if(!document.fonts)return[3,2];return[4,function(e,t){return T.apply(this,arguments)}(document.fonts,e)];case 1:case 3:return t.sent(),[2];case 2:return[4,Promise.all([R("serif",e),R("sans-serif",e),R("monospace",e)])]}})})).apply(this,arguments)}function E(e){var t=e.family,n=e.style,r=e.weight;return"".concat(void 0===n?"normal":n," ").concat(void 0===r?"normal":r," 100px ").concat(t)}function T(){return(T=(0,i._)(function(e,t){var n,r,i,o,a,c;return(0,l.Jh)(this,function(l){return n=t.fontInfo,i=void 0===(r=t.characters)?S:r,a=void 0===(o=t.timeout)?3e3:o,c=E(n),[2,new Promise(function(t,r){var o=!1,l=C.kg.timeStart({family:n.family,style:n.style,weight:n.weight}),s=setTimeout(function(){o=!0,l("xterm font loading timed out"),t()},a);e.load(c,i).then(function(){o||(clearTimeout(s),t())}).catch(function(e){o||(clearTimeout(s),r(e))})})]})})).apply(this,arguments)}function R(e,t){return I.apply(this,arguments)}function I(){return(I=(0,i._)(function(e,t){var n,r,i,o,a,c,s,u,d;return(0,l.Jh)(this,function(l){return(n=t.fontInfo,i=void 0===(r=t.characters)?S:r,a=void 0===(o=t.timeout)?3e3:o,c=E(n),(s=document.createElement("span")).innerText=i,s.style.font="normal normal 100px ".concat(e),s.style.position="absolute",s.style.left="-9999px",s.style.top="-9999px",document.body.appendChild(s),u=s.offsetWidth,s.style.font=c,(d=function(){return u!==s.offsetWidth})())?[2]:[2,new Promise(function(e,t){var r=setInterval(function(){d()&&(clearInterval(r),clearTimeout(i),document.body.removeChild(s),e())},50),i=setTimeout(function(){if(clearInterval(r),document.body.removeChild(s),d()){e();return}t(Error("Font loading timed out "+n.family))},a)})]})})).apply(this,arguments)}function D(e){c.Tb(e)}var G='"ReplitHack"',B=String.fromCharCode(61095);function P(){return(P=(0,i._)(function(){return(0,l.Jh)(this,function(e){switch(e.label){case 0:return!function(){if(!document.getElementById(x)){var e=document.createElement("style");e.id=x,e.type="text/css",e.appendChild(document.createTextNode("\n@font-face {\n  font-family: 'replit-icons';\n  font-style: normal;\n  font-weight: normal;\n  font-stretch: normal;\n  src: url(".concat("/public/fonts/replit-icons.woff",") format('woff'),\n    url(").concat("/public/fonts/replit-icons.ttf",") format('truetype');\n}"))),document.head.appendChild(e)}}(),[4,Promise.all([k({fontInfo:{family:"replit-icons"},characters:B}).catch(D),k({fontInfo:{family:G,weight:"400"}}).catch(D),k({fontInfo:{family:G,weight:"400",style:"italic"}}).catch(D),k({fontInfo:{family:G,weight:"700"}}).catch(D),k({fontInfo:{family:G,weight:"700",style:"italic"}}).catch(D)])];case 1:return e.sent(),[2]}})})).apply(this,arguments)}var A=n(58200),N=n(49500);function L(e){var t,r,w,x,C=(0,o._)((0,y.useState)(null),2),S=C[0],k=C[1],_=(0,o._)((0,y.useState)(null),2),E=_[0],T=_[1],R=(0,A.f)(),I=(0,s.Gn)("fontSize","accessibleTerminal","shellBellAudio").preferences,D=I.fontSize,B=I.accessibleTerminal,L=I.shellBellAudio,U=(0,m.uV)(),O=(0,d.Z)(),M=null==e?void 0:e.openFile,X=(0,f.Z)(null==e?void 0:e.openWebview),F=null==e?void 0:e.listFiles,W=(0,y.useMemo)(function(){return M&&F?{openFile:M,listFiles:F}:null},[M,F]),H=(0,f.Z)(null==e?void 0:e.onInBandOSCMessages),V={screenReaderMode:B,fileLinking:W,terminalTheme:R,fontSize:D,scrollback:null==e?void 0:e.scrollback},z=(0,f.Z)(V),j=(0,b.Z)(function(){(null==e?void 0:e.autoFit)!==!1&&(null==E||E.fit())},{type:"debounce",wait:200}),q=(0,y.useRef)(null),Y=(0,f.Z)(null==e?void 0:e.size),J=(0,g.Sy)();return(0,y.useLayoutEffect)(function(){if(S){var e=[];return(function(){return t.apply(this,arguments)})().catch(function(e){if(e.message&&e.message.toLowerCase().includes("loading chunk")){c.$e(function(t){t.setExtra("message",e.message),t.setExtra("stack",e.stack),c.Tb(Error("Loading chunk failed"))});return}U({error:e,origin:"Xterm: init"})}),function(){e.forEach(function(e){return e()})}}function t(){return(t=(0,i._)(function(){var t,r,i,s,d,f,m,y,b,w,Z,x,C,k,_,E,R,I,D,B,A,L,U,M,F;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return[4,Promise.all([Promise.all([(0,p.Z)(function(){return n.e(6796).then(n.t.bind(n,17643,23))}),(0,p.Z)(function(){return n.e(2838).then(n.t.bind(n,82838,23))}),(0,p.Z)(function(){return n.e(8318).then(n.t.bind(n,68318,23))}),(0,p.Z)(function(){return n.e(1895).then(n.t.bind(n,81895,23))}),(0,p.Z)(function(){return n.e(343).then(n.t.bind(n,40343,23))}),(0,p.Z)(function(){return n.e(5374).then(n.bind(n,35374))}),(0,p.Z)(function(){return n.e(8350).then(n.t.bind(n,48350,23))}),(0,p.Z)(function(){return n.e(1906).then(n.t.bind(n,21906,23))})]),function(){return P.apply(this,arguments)}()])];case 1:var W;if(m=o._.apply(void 0,[l.sent(),1]),b=(y=(0,o._)(m[0],8))[0].Terminal,w=y[1].FitAddon,Z=y[2].SearchAddon,x=y[3].WebLinksAddon,C=y[4].Unicode11Addon,k=y[5].FileLinkAddon,_=y[6].CanvasAddon,E=y[7].WebglAddon,!S)return[2];return I={allowProposedApi:!0,cursorBlink:!1,scrollback:null!==(R=z.current.scrollback)&&void 0!==R?R:1e3,tabStopWidth:4,fontFamily:"".concat(G,', replit-icons, Monaco, "Ubuntu Mono", Consolas, monospace'),fontSize:z.current.fontSize,lineHeight:1,fontWeight:400,fontWeightBold:700,drawBoldTextInBrightColors:!1,minimumContrastRatio:4.5,theme:z.current.terminalTheme,screenReaderMode:z.current.screenReaderMode,logger:{trace:function(e,n){return(t=N).trace.apply(t,["xterm: "+e].concat((0,a._)(n)))},debug:function(e,t){return(r=N).debug.apply(r,["xterm: "+e].concat((0,a._)(t)))},info:function(e,t){return(i=N).info.apply(i,["xterm: "+e].concat((0,a._)(t)))},warn:function(e,t){return(s=N).warn.apply(s,["xterm: "+e].concat((0,a._)(t)))},error:function(e,t){"string"==typeof e&&e.includes("Parsing error")||N.error("xterm: "+e,t)}}},(null===(d=Y.current)||void 0===d?void 0:d.cols)!==void 0&&(I.cols=Y.current.cols),(null===(f=Y.current)||void 0===f?void 0:f.rows)!==void 0&&(I.rows=Y.current.rows),D=new b(I),z.current.fileLinking?(q.current=new k(z.current.fileLinking.openFile,z.current.fileLinking.listFiles),D.loadAddon(q.current)):q.current=null,B=new w,D.loadAddon(B),A=new x((W=function(e){O?u.X.openExternalUrl(e):window.open(e,"_blank")},function(e,t){var n;try{n=new URL(t)}catch(e){return}if(("0.0.0.0"===n.hostname||"localhost"===n.hostname)&&void 0!==X.current){X.current(n.pathname,parseInt(n.port,10));return}W(t)})),D.loadAddon(A),L=new Z,D.loadAddon(L),U=new C,D.loadAddon(U),D.unicode.activeVersion="11",D.open(S),e.push(function(){try{D.dispose()}catch(e){}}),function(){try{if(!(!function(){if(!/^((?!chrome|android).)*safari/i.test(window.navigator.userAgent))return!1;var e=window.navigator.userAgent.match(/Version\/(\d+)/);return null===e||e.length<2||16>parseInt(e[1],10)}()&&document.createElement("canvas").getContext("webgl2"))){var e=new _;D.loadAddon(e);return}var t=new E;D.loadAddon(t),t.onContextLoss(function(){t.dispose(),D.loadAddon(new _)})}catch(e){var n=new _;D.loadAddon(n)}}(),M=!1,F=null,D.attachCustomKeyEventHandler(function(e){var t=(0,v.IX)(e);if(t){var n=t;F&&(n=(0,v.cZ)(F,t));var r=J(n);switch(r.kind){case g.Xp.NoMatch:F=null;break;case g.Xp.WaitingForChord:return F=r.key,!1;case g.Xp.MatchFound:return F=null,!1}}return(!window.navigator.clipboard||"c"!==e.key.toLowerCase()||!e.ctrlKey||!e.shiftKey||("keyup"===e.type&&D.hasSelection()&&(0,h.Z)(D.getSelection()).catch(function(e){c.$e(function(t){t.setTag("xterm-clipboard",!0),t.setExtra("type","copy"),c.Tb(e)})}),e.preventDefault(),e.stopPropagation(),!1))&&("shift"===e.key.toLowerCase()||"ctrl"===e.key.toLowerCase()||"alt"===e.key.toLowerCase()||"meta"===e.key.toLowerCase()||("tab"!==e.key.toLowerCase()||!M)&&(M="escape"===e.key.toLowerCase(),!0))}),H.current&&Object.entries(H.current).forEach(function(e){var t=(0,o._)(e,2),n=t[0],r=t[1];D.parser.registerOscHandler(Number(n),function(e){return r(D,e),!0})}),T({onKey:D.onKey.bind(D),onData:D.onData.bind(D),onResize:D.onResize.bind(D),write:D.write.bind(D),fit:function(){var e=S.getBoundingClientRect(),t=e.width,n=e.height;t>0&&n>0&&B.fit()},focus:function(){return D.focus()},clear:function(){return D.clear()},findPrevious:function(e,t){return L.findPrevious(e,t)},findNext:function(e,t){return L.findNext(e,t)},getSize:function(){return{cols:D.cols,rows:D.rows}},paste:function(e){return D.paste(e)},_term:D}),j(S),[2]}})})).apply(this,arguments)}},[S,j,z,U,Y,J,O,X,H]),t=null==E?void 0:E._term,r=V.screenReaderMode,w=V.fileLinking,x=V.terminalTheme,(0,y.useEffect)(function(){t&&x&&(t.options.theme=x)},[t,x]),(0,y.useEffect)(function(){t&&(t.options.screenReaderMode=r)},[t,r]),(0,y.useEffect)(function(){if(t){if(!w){q.current&&q.current.deactivate();return}if(!q.current){var e=!1;return n.e(5374).then(n.bind(n,35374)).then(function(n){var r=n.FileLinkAddon;e||(q.current=new r(w.openFile,w.listFiles),t.loadAddon(q.current))}),function(){e=!0}}q.current.update(w.openFile,w.listFiles),q.current.reactivate()}},[t,w,q]),(0,y.useEffect)(function(){var e=null==E?void 0:E._term;e&&D&&e.options.fontSize!==D&&(e.options.fontSize=D,e.refresh(0,e.rows-1),E.fit())},[D,E]),(0,y.useEffect)(function(){if(L){var e=null==E?void 0:E._term;if(e)return e.onBell(Z).dispose}},[L,E]),[E,k]}},58200:function(e,t,n){n.d(t,{f:function(){return a}});var r=n(70671),i=n(49932),o=n(50959);function a(){var e=(0,r.F)().values;return(0,o.useMemo)(function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.Sj.values;return{foreground:e.global.foregroundDefault,background:e.global.backgroundDefault,cursor:e.global.foregroundDefault,cursorAccent:e.global.backgroundHigher,selectionBackground:e.global.foregroundDefault,black:e.global.backgroundRoot,red:e.global.redStronger,green:e.global.accentPositiveDefault,yellow:e.global.yellowDefault,blue:e.global.blueStronger,magenta:e.global.magentaDefault,cyan:e.global.tealDefault,white:e.global.foregroundDefault,brightBlack:e.global.outlineDimmest,brightRed:e.global.redStrongest,brightGreen:e.global.accentPositiveStronger,brightYellow:e.global.yellowStronger,brightBlue:e.global.blueStrongest,brightMagenta:e.global.magentaStronger,brightCyan:e.global.tealStronger,brightWhite:e.global.foregroundDefault}}(e)},[e])}},42371:function(e,t,n){n.d(t,{f:function(){return r}});var r={production:"wss://production-ai-chat.replit.com/ws",staging:"wss://staging-ai-chat.replit.com/ws",development:"ws://127.0.0.1:8000/ws"}},75452:function(e,t,n){n.d(t,{OO:function(){return r},Uw:function(){return i},vw:function(){return o}});var r="replit-repltuned-v1-5-3b",i={"replit-repltuned-v1-5-3b":{},"replit-v1-5-3b":{}},o=new Set(Object.keys(i))},12639:function(e,t,n){n.d(t,{v:function(){return i}}),n(99149);var r=n(74044);n(34471),r.Dy.Object({replId:r.Dy.String({format:"uuid"})});var i=r.Dy.Object({token:r.Dy.String()})},15592:function(e,t,n){n.d(t,{w:function(){return o}});var r=n(66626),i=n(19659);function o(e){if(0===e.length)return new Map;if(1===e.length)return new Map([[e[0],null]]);var t=new Map,n=!0,o=!1,a=void 0;try{for(var l,c=e[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var s=l.value,u=(0,i.UO)(s),d=t.get(u);d||(d=[],t.set(u,d)),d.push(s)}}catch(e){o=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw a}}var f=new Map,h=!0,p=!1,m=void 0;try{for(var v,g=t[Symbol.iterator]();!(h=(v=g.next()).done);h=!0)!function(){var e=(0,r._)(v.value,2)[1];if(1===e.length)return f.set(e[0],null);var t=new Map,n=new Set,i=0,o=!0,a=!1,l=void 0;try{for(var c,s=e[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var u=c.value;if(-1===u.indexOf("/")){f.set(u,null),n.add(u);continue}var d=function(e){for(var t=e.split("/").slice(0,-1),n=[],r=0;r<t.length;r++){var i=t.slice(r).join("/")+"/";0!==r&&(i="/"+i),n.push(i)}return n.reverse()}(u);t.set(u,d),d.length>i&&(i=d.length)}}catch(e){a=!0,l=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw l}}for(var h=0;h<=i;h++){var p=function(e){var i=[],o=new Map,a=!0,l=!1,c=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var d=(0,r._)(s.value,2),h=d[0],p=d[1];if(!n.has(h)){var m=p[e];m||(m=p[p.length-1]),i.push(m),o.set(m,h)}}}catch(e){l=!0,c=e}finally{try{a||null==u.return||u.return()}finally{if(l)throw c}}if(0===i.length)return"break";var v=!0,g=!1,y=void 0;try{for(var b,w=i[Symbol.iterator]();!(v=(b=w.next()).done);v=!0)!function(){var e=b.value,t=o.get(e);if(void 0===t)throw Error("Unpopulated segment map");1===i.filter(function(t){return t===e}).length&&(n.add(t),f.set(t,e))}()}catch(e){g=!0,y=e}finally{try{v||null==w.return||w.return()}finally{if(g)throw y}}}(h);if("break"===p)break}if(n.size!==e.length){var m=!0,g=!1,y=void 0;try{for(var b,w=e[Symbol.iterator]();!(m=(b=w.next()).done);m=!0){var Z=b.value;if(!n.has(Z)){var x=Z.split("/").slice(0,-1).join("/");f.set(Z,x)}}}catch(e){g=!0,y=e}finally{try{m||null==w.return||w.return()}finally{if(g)throw y}}}}()}catch(e){p=!0,m=e}finally{try{h||null==g.return||g.return()}finally{if(p)throw m}}return f}},50682:function(e,t,n){n.d(t,{J9:function(){return v},LK:function(){return g}});var r,i,o,a,l=n(27387),c=n(96583),s=n(45005),u=n.n(s),d=n(4859),f=n.n(d),h=n(43182),p="https://api.github.com",m=(r=(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,u()("".concat(p,"/repos/").concat(t,"/contents"),{method:"GET",headers:n?{Authorization:"Bearer ".concat(n)}:{}})];case 1:if(404!==(r=i.sent()).status)return[3,3];return[4,r.json()];case 2:if("This repository is empty."===i.sent().message)return[2,{error:"This repository is empty."}];throw new d.AbortError(r.statusText);case 3:if(!r.ok)return[2,{error:"This repository could not be accessed, try again later"}];return[4,r.json().then(function(e){return e.map(function(e){return{path:e.path,type:e.type}})})];case 4:return[2,i.sent()]}})}),function(e){return r.apply(this,arguments)}),v=(i=(0,l._)(function(e){var t,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,f()(function(){return m({repoNameWithOwner:t,accessToken:n})},{retries:5,minTimeout:500,onFailedAttempt:function(e){e.retriesLeft||h.$e(function(e){e.setTag("github-import",!0),h.Tb(Error("Could not fetch repository files."))})}})];case 1:return[2,r.sent()]}})}),function(e){return i.apply(this,arguments)}),g=(o=(0,l._)(function(e){var t,n,r,i;return(0,c.Jh)(this,function(o){switch(o.label){case 0:return t=e.repoNameWithOwner,n=e.filePath,r=e.accessToken,[4,u()("".concat(p,"/repos/").concat(t,"/contents/").concat(n),{method:"GET",headers:r?{Authorization:"Bearer ".concat(r)}:{}})];case 1:if(!(i=o.sent()).ok)return[2,{error:"This file could not be accessed, try again later"}];return[4,i.json()];case 2:return[2,o.sent()]}})}),function(e){return o.apply(this,arguments)}),y=(a=(0,l._)(function(e){var t,n,r;return(0,c.Jh)(this,function(i){switch(i.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,u()("".concat(p,"/repos/").concat(t,"/languages"),{method:"GET",headers:n?{Authorization:"Bearer ".concat(n)}:{}})];case 1:if(404===(r=i.sent()).status)throw new d.AbortError(r.statusText);if(!r.ok)return[3,3];return[4,r.json()];case 2:return[2,i.sent()];case 3:return[2,{error:"Error fetching repository languages."}]}})}),function(e){return a.apply(this,arguments)});(0,l._)(function(e){var t,n;return(0,c.Jh)(this,function(r){switch(r.label){case 0:return t=e.repoNameWithOwner,n=e.accessToken,[4,f()(function(){return y({repoNameWithOwner:t,accessToken:n})},{retries:5,minTimeout:500,onFailedAttempt:function(e){e.retriesLeft||h.$e(function(e){e.setTag("github-import",!0),h.Tb(Error("Could not fetch repository language."))})}})];case 1:return[2,r.sent()]}})})},70078:function(e,t,n){function r(e){return 15113696===e}function i(e){return 777914===e||r(e)||3944703===e||29762144===e}n.d(t,{v4:function(){return r},xm:function(){return i}})},94376:function(e,t,n){n.d(t,{I:function(){return i},z:function(){return r}});var r=100,i=250},95597:function(e,t,n){n.d(t,{F5:function(){return d},Hk:function(){return s},Kd:function(){return u},N$:function(){return c},Ob:function(){return l},Vl:function(){return a},Vt:function(){return r},ig:function(){return i},lF:function(){return o}});var r=/^([A-Za-z0-9_]{1,15})\/?$/,i=/^([%A-Za-z0-9]+|-)*\/?$/,o=/^([A-Za-z\d](?:[A-Za-z\d]|-){0,38})\/?$/,a=/^https:\/\/(www\.)?youtube\.com(\/(c|channel|user|@(\w)+))*(\/([A-Za-z0-9_-]+))*(\/?)$/,l=/^(.{2,32}#[0-9]{4})$|^([a-zA-Z0-9_.]{2,32})$/,c="https://twitter.com/",s="https://www.linkedin.com/in/",u="https://github.com/",d=/\/$/},44471:function(e,t,n){n.d(t,{Eg:function(){return m},UF:function(){return u},mD:function(){return l},r0:function(){return d},v:function(){return p},xi:function(){return h}});var r=n(41733),i=n(30509),o=n(63257),a=n(39426);function l(e){return e.split(".").pop()}function c(e,t){return e.some(function(e){return e.path===t})}function s(e,t){var n=e.findIndex(function(e){return l(e.path)===l(t)});if(-1===n)return e;var a=(0,i._)((0,r._)({},e[n]),{path:t});return(0,o._)(e.slice(0,n)).concat([a],(0,o._)(e.slice(n+1)))}function u(e){var t=[];return e.forEach(function(e){var n=l(e.path),r=a.ZP.allSupportedByPopularity().find(function(e){return e.ext===n});r&&!t.includes(r.key)&&t.push(r.key)}),t}function d(e){var t=e.files,n=e.language,r=a.ZP.getMainFileName(null!=n?n:"python");if(!r)return t;var i=t;return c(t,r)||(i=s(i,r)),"html"!==n||c(t,"style.css")||(i=s(i,"style.css")),"html"!==n||c(t,"script.js")||(i=s(i,"script.js")),i}var f=["GoogleCloudPlatform","googleapis"];function h(e){return f.includes(e)}var p="b3294059-2b61-4b20-abde-f06b61a9a1b3",m="gcloud:v1-20230815-e6e4431"},1660:function(e,t,n){n.d(t,{Z:function(){return u}});var r,i,o=n(27387),a=n(98924),l=n(96583);(r=i||(i={})).CHANNEL_OPENED="CHANNEL_OPENED",r.OUTPUT_RECEIVED="OUTPUT_RECEIVED",r.STDERR_RECEIVED="STDERR_RECEIVED",r.STATE_CHANGED="STATE_CHANGED";var c=n(83493),s=n(20435);function u(e){var t,n=e.container,r=(0,c.ZP)(),u=null,d=!1;function f(){return(f=(0,o._)(function(){return(0,l.Jh)(this,function(e){if(d)throw Error("closed");return u?[2,u]:[2,new Promise(function(e){r.once(i.CHANNEL_OPENED,function(t){e(t)})})]})})).apply(this,arguments)}var h="",p="",m=n.openChannel({service:"exec"},function(e){var t=e.channel,n=!1;return t.onCommand(function(e){if(null!=e.output)h+=e.output,r.emit(i.OUTPUT_RECEIVED,e.output);else if(null!=e.stderr)p+=e.stderr,r.emit(i.STDERR_RECEIVED,e.stderr);else if(null!=e.state){if(!n){n=!0;return}r.emit(i.STATE_CHANGED,{state:e.state,outputBuffer:h,stderrBuffer:p}),e.state===s.api.State.Stopped&&(h="",p="")}}),u=t,r.emit(i.CHANNEL_OPENED,t),function(){u=null}});return{request:(t=(0,o._)(function(e){var t,n,r,i,o,c,u,d,h;return(0,l.Jh)(this,function(l){switch(l.label){case 0:return t=e.env,n=e.args,i=void 0===(r=e.lifecycle)?s.api.Exec.Lifecycle.BLOCKING:r,c=void 0!==(o=e.splitStderr)&&o,u=(0,a._)(e,["env","args","lifecycle","splitStderr"]),[4,function(){return f.apply(this,arguments)}()];case 1:return h=(d=l.sent()).request({exec:{env:t,args:n,lifecycle:i,splitStderr:c}}),i===s.api.Exec.Lifecycle.STDIN&&"stdin"in u&&(d.send({input:u.stdin}),d.send({inputClose:{}})),[2,h]}})}),function(e){return t.apply(this,arguments)}),onOutput:function(e){return r.on(i.OUTPUT_RECEIVED,e),function(){r.off(i.OUTPUT_RECEIVED,e)}},onStderr:function(e){return r.on(i.STDERR_RECEIVED,e),function(){r.off(i.STDERR_RECEIVED,e)}},onStateChanged:function(e){return r.on(i.STATE_CHANGED,e),function(){r.off(i.STATE_CHANGED,e)}},getStatus:function(){return u?u.status:"closed"},dispose:function(){d=!0,m(),u=null}}}},23015:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(27387),i=n(96583),o=n(59173),a=n(59808);function l(e){var t=e.container,n=e.dotReplit,l=(0,o.u)(null),c=(0,o.u)(null),s=(0,o.u)(null);function u(){return s.current?Promise.resolve(s.current):new Promise(function(e){var t=s.subscribe(function(n){n&&(t(),e(n))})})}return t.openChannel({service:"toolchain"},function(e){var t=e.channel;s.set(t);var n=t.onCommand(function(e){e.toolchainChanged?l.current=e.toolchainChanged.configs:e.nixModulesChanged&&(c.current=e.nixModulesChanged.modules)});return t.request({toolchainGetRequest:{}}).then(function(e){var t;l.current=(null===(t=e.toolchainGetResponse)||void 0===t?void 0:t.configs)||null}),t.request({nixModulesGetRequest:{}}).then(function(e){var t;c.current=(null===(t=e.nixModulesGetResponse)||void 0===t?void 0:t.modules)||null}),function(){n()}}),{configs:l,modules:c,getConfigs:function(){return l.current?Promise.resolve(l.current):new Promise(function(e){var t=l.subscribe(function(n){if(t(),null===n)throw Error("Returned toolchain config should not be null");e(n)})})},getRegistry:function(){return(0,r._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return[4,u()];case 1:return[4,e.sent().request({nixModulesGetRegistryRequest:{}})];case 2:return[2,e.sent().nixModulesGetRegistryResponse||null]}})})()},addModule:function(e){return(0,r._)(function(){var t,r,o;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return r=[],[4,n.getConfig()];case 1:if((o=i.sent()).error&&o.error!==a.Yt.NotFound)throw Error("Failed to read .replit"+o.error);if(-1!==(r=(null===(t=o.config)||void 0===t?void 0:t.modules)||[]).indexOf(e))return[3,3];return r.push(e),[4,n.updateDotReplit([{op:"add",path:"modules",value:JSON.stringify(r)}])];case 2:i.sent(),i.label=3;case 3:return[2]}})})()},removeModule:function(e){return(0,r._)(function(){var t,r,o,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return r=[],[4,n.getConfig()];case 1:if((o=i.sent()).error&&o.error!==a.Yt.NotFound)throw Error("Failed to read .replit"+o.error);if((l=(r=(null===(t=o.config)||void 0===t?void 0:t.modules)||[]).filter(function(t){if(e===t)return!1;var n=t.match(/^(.+)\.nix$/);return(n&&n[1])!==e})).length===r.length)return[2];return[4,n.updateDotReplit([{op:"add",path:"modules",value:JSON.stringify(l)}])];case 2:return i.sent(),[2]}})})()},upgradeModule:function(e,t){return(0,r._)(function(){var r,o,l;return(0,i.Jh)(this,function(i){switch(i.label){case 0:return[4,n.getConfig()];case 1:if((o=i.sent()).error&&o.error!==a.Yt.NotFound)throw Error("Failed to read .replit"+o.error);return l=((null===(r=o.config)||void 0===r?void 0:r.modules)||[]).map(function(n){return e===n?t:n}),[4,n.updateDotReplit([{op:"add",path:"modules",value:JSON.stringify(l)}])];case 2:return i.sent(),[2]}})})()},buildModules:function(){return(0,r._)(function(){var e,t;return(0,i.Jh)(this,function(n){switch(n.label){case 0:return e=this,[4,u()];case 1:return t=n.sent(),[2,new Promise(function(n){var r=e.configs.subscribe(function(e){e&&(r(),n(void 0))});t.send({nixModulesBuildRequest:{}})})]}})}).apply(this)}}}}}]);
//# sourceMappingURL=1327-40bb3a73ec25aaeb.js.map